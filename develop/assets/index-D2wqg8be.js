import{r as Yn,j as vi,c as $o,u as xs,a as f5,C as Py,R as Os,b as yo,B as Ru,d as ti,e as Oy,l as p5,f as m5,w as g5,x as v5}from"./index-C86Un_Yn.js";const Ny=(n=>Yn.forwardRef((e,t)=>vi.jsx("div",{...e,ref:t,className:$o(e.className,n)}))),tm=Yn.forwardRef(({className:n,bsPrefix:e,as:t="div",...r},a)=>(e=xs(e,"card-body"),vi.jsx(t,{ref:a,className:$o(n,e),...r})));tm.displayName="CardBody";const Dy=Yn.forwardRef(({className:n,bsPrefix:e,as:t="div",...r},a)=>(e=xs(e,"card-footer"),vi.jsx(t,{ref:a,className:$o(n,e),...r})));Dy.displayName="CardFooter";const Iy=Yn.forwardRef(({bsPrefix:n,className:e,as:t="div",...r},a)=>{const l=xs(n,"card-header"),x=Yn.useMemo(()=>({cardHeaderBsPrefix:l}),[l]);return vi.jsx(f5.Provider,{value:x,children:vi.jsx(t,{ref:a,...r,className:$o(e,l)})})});Iy.displayName="CardHeader";const zy=Yn.forwardRef(({bsPrefix:n,className:e,variant:t,as:r="img",...a},l)=>{const x=xs(n,"card-img");return vi.jsx(r,{ref:l,className:$o(t?`${x}-${t}`:x,e),...a})});zy.displayName="CardImg";const Fy=Yn.forwardRef(({className:n,bsPrefix:e,as:t="div",...r},a)=>(e=xs(e,"card-img-overlay"),vi.jsx(t,{ref:a,className:$o(n,e),...r})));Fy.displayName="CardImgOverlay";const Uy=Yn.forwardRef(({className:n,bsPrefix:e,as:t="a",...r},a)=>(e=xs(e,"card-link"),vi.jsx(t,{ref:a,className:$o(n,e),...r})));Uy.displayName="CardLink";const y5=Ny("h6"),By=Yn.forwardRef(({className:n,bsPrefix:e,as:t=y5,...r},a)=>(e=xs(e,"card-subtitle"),vi.jsx(t,{ref:a,className:$o(n,e),...r})));By.displayName="CardSubtitle";const Hy=Yn.forwardRef(({className:n,bsPrefix:e,as:t="p",...r},a)=>(e=xs(e,"card-text"),vi.jsx(t,{ref:a,className:$o(n,e),...r})));Hy.displayName="CardText";const x5=Ny("h5"),Vy=Yn.forwardRef(({className:n,bsPrefix:e,as:t=x5,...r},a)=>(e=xs(e,"card-title"),vi.jsx(t,{ref:a,className:$o(n,e),...r})));Vy.displayName="CardTitle";const Gy=Yn.forwardRef(({bsPrefix:n,className:e,bg:t,text:r,border:a,body:l=!1,children:x,as:_="div",...O},z)=>{const q=xs(n,"card");return vi.jsx(_,{ref:z,...O,className:$o(e,q,t&&`bg-${t}`,r&&`text-${r}`,a&&`border-${a}`),children:l?vi.jsx(tm,{children:x}):x})});Gy.displayName="Card";const Ho=Object.assign(Gy,{Img:zy,Title:Vy,Subtitle:By,Body:tm,Link:Uy,Text:Hy,Header:Iy,Footer:Dy,ImgOverlay:Fy});var _5=Object.defineProperty,b5=(n,e,t)=>e in n?_5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Aa=(n,e,t)=>b5(n,typeof e!="symbol"?e+"":e,t),ku=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function rm(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var jy={exports:{}},cu={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _g;function w5(){if(_g)return cu;_g=1;var n=Oy,e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function x(_,O,z){var q,oe={},ue=null,_e=null;z!==void 0&&(ue=""+z),O.key!==void 0&&(ue=""+O.key),O.ref!==void 0&&(_e=O.ref);for(q in O)r.call(O,q)&&!l.hasOwnProperty(q)&&(oe[q]=O[q]);if(_&&_.defaultProps)for(q in O=_.defaultProps,O)oe[q]===void 0&&(oe[q]=O[q]);return{$$typeof:e,type:_,key:ue,ref:_e,props:oe,_owner:a.current}}return cu.Fragment=t,cu.jsx=x,cu.jsxs=x,cu}jy.exports=w5();var mn=jy.exports;const nm=Yn.createContext({}),M5=n=>{const[e,t,r]=n,[a,l]=Yn.useState(e),[x,_]=Yn.useState(t),[O,z]=Yn.useState(r),[q,oe]=Yn.useState([0,0,1]),[ue,_e]=Yn.useState(!0),[be,Pe]=Yn.useState(.3),[Se,Ee]=Yn.useState(2.5),[Xe,qe]=Yn.useState(!0),[$e,ft]=Yn.useState(.25),[gt,pt]=Yn.useState(.5);return{nx:a,setNx:l,ny:x,setNy:_,nz:O,setNz:z,cameraDirection:q,setCameraDirection:oe,showCell:ue,setShowCell:_e,amplitude:be,setAmplitude:Pe,vectorLength:Se,setVectorLength:Ee,showVectors:Xe,setShowVectors:qe,speed:$e,setSpeed:ft,atomScale:gt,setAtomScale:pt}};var Wy={exports:{}};(function(n){(function(e,t){n.exports?n.exports=t():e.moduleName=t()})(typeof self<"u"?self:ku,()=>{var e=(()=>{var t=(W,V)=>()=>(V||W((V={exports:{}}).exports,V),V.exports),r=t(W=>{W.version="3.1.2"}),a=t((W,V)=>{(function(d,i,s){i[d]=i[d]||s(),typeof V<"u"&&V.exports&&(V.exports=i[d])})("Promise",typeof window<"u"?window:W,function(){var d,i,s,f=Object.prototype.toString,u=typeof setImmediate<"u"?function(C){return setImmediate(C)}:setTimeout;try{Object.defineProperty({},"x",{}),d=function(C,m,y,A){return Object.defineProperty(C,m,{value:y,writable:!0,configurable:A!==!1})}}catch{d=function(C,m,y){return C[m]=y,C}}s=(function(){var C,m,y;function A(R,N){this.fn=R,this.self=N,this.next=void 0}return{add:function(R,N){y=new A(R,N),m?m.next=y:C=y,m=y,y=void 0},drain:function(){var R=C;for(C=m=i=void 0;R;)R.fn.call(R.self),R=R.next}}})();function h(C,m){s.add(C,m),i||(i=u(s.drain))}function p(C){var m,y=typeof C;return C!=null&&(y=="object"||y=="function")&&(m=C.then),typeof m=="function"?m:!1}function v(){for(var C=0;C<this.chain.length;C++)o(this,this.state===1?this.chain[C].success:this.chain[C].failure,this.chain[C]);this.chain.length=0}function o(C,m,y){var A,R;try{m===!1?y.reject(C.msg):(m===!0?A=C.msg:A=m.call(void 0,C.msg),A===y.promise?y.reject(TypeError("Promise-chain cycle")):(R=p(A))?R.call(A,y.resolve,y.reject):y.resolve(A))}catch(N){y.reject(N)}}function w(C){var m,y=this;if(!y.triggered){y.triggered=!0,y.def&&(y=y.def);try{(m=p(C))?h(function(){var A=new L(y);try{m.call(C,function(){w.apply(A,arguments)},function(){g.apply(A,arguments)})}catch(R){g.call(A,R)}}):(y.msg=C,y.state=1,y.chain.length>0&&h(v,y))}catch(A){g.call(new L(y),A)}}}function g(C){var m=this;m.triggered||(m.triggered=!0,m.def&&(m=m.def),m.msg=C,m.state=2,m.chain.length>0&&h(v,m))}function b(C,m,y,A){for(var R=0;R<m.length;R++)(function(N){C.resolve(m[N]).then(function(te){y(N,te)},A)})(R)}function L(C){this.def=C,this.triggered=!1}function S(C){this.promise=C,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function M(C){if(typeof C!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var m=new S(this);this.then=function(y,A){var R={success:typeof y=="function"?y:!0,failure:typeof A=="function"?A:!1};return R.promise=new this.constructor(function(N,te){if(typeof N!="function"||typeof te!="function")throw TypeError("Not a function");R.resolve=N,R.reject=te}),m.chain.push(R),m.state!==0&&h(v,m),R.promise},this.catch=function(y){return this.then(void 0,y)};try{C.call(void 0,function(y){w.call(m,y)},function(y){g.call(m,y)})}catch(y){g.call(m,y)}}var T=d({},"constructor",M,!1);return M.prototype=T,d(T,"__NPO__",0,!1),d(M,"resolve",function(C){var m=this;return C&&typeof C=="object"&&C.__NPO__===1?C:new m(function(y,A){if(typeof y!="function"||typeof A!="function")throw TypeError("Not a function");y(C)})}),d(M,"reject",function(C){return new this(function(m,y){if(typeof m!="function"||typeof y!="function")throw TypeError("Not a function");y(C)})}),d(M,"all",function(C){var m=this;return f.call(C)!="[object Array]"?m.reject(TypeError("Not an array")):C.length===0?m.resolve([]):new m(function(y,A){if(typeof y!="function"||typeof A!="function")throw TypeError("Not a function");var R=C.length,N=Array(R),te=0;b(m,C,function(H,U){N[H]=U,++te===R&&y(N)},A)})}),d(M,"race",function(C){var m=this;return f.call(C)!="[object Array]"?m.reject(TypeError("Not an array")):new m(function(y,A){if(typeof y!="function"||typeof A!="function")throw TypeError("Not a function");b(m,C,function(R,N){y(N)},A)})}),M})}),l=t((W,V)=>{(function(){var d={version:"3.8.2"},i=[].slice,s=function(c){return i.call(c)},f=self.document;function u(c){return c&&(c.ownerDocument||c.document||c).documentElement}function h(c){return c&&(c.ownerDocument&&c.ownerDocument.defaultView||c.document&&c||c.defaultView)}if(f)try{s(f.documentElement.childNodes)[0].nodeType}catch{s=function(c){for(var E=c.length,I=new Array(E);E--;)I[E]=c[E];return I}}if(Date.now||(Date.now=function(){return+new Date}),f)try{f.createElement("DIV").style.setProperty("opacity",0,"")}catch{var p=this.Element.prototype,v=p.setAttribute,o=p.setAttributeNS,w=this.CSSStyleDeclaration.prototype,g=w.setProperty;p.setAttribute=function(c,E){v.call(this,c,E+"")},p.setAttributeNS=function(c,E,I){o.call(this,c,E,I+"")},w.setProperty=function(c,E,I){g.call(this,c,E+"",I)}}d.ascending=b;function b(c,E){return c<E?-1:c>E?1:c>=E?0:NaN}d.descending=function(c,E){return E<c?-1:E>c?1:E>=c?0:NaN},d.min=function(c,E){var I=-1,$=c.length,ce,fe;if(arguments.length===1){for(;++I<$;)if((fe=c[I])!=null&&fe>=fe){ce=fe;break}for(;++I<$;)(fe=c[I])!=null&&ce>fe&&(ce=fe)}else{for(;++I<$;)if((fe=E.call(c,c[I],I))!=null&&fe>=fe){ce=fe;break}for(;++I<$;)(fe=E.call(c,c[I],I))!=null&&ce>fe&&(ce=fe)}return ce},d.max=function(c,E){var I=-1,$=c.length,ce,fe;if(arguments.length===1){for(;++I<$;)if((fe=c[I])!=null&&fe>=fe){ce=fe;break}for(;++I<$;)(fe=c[I])!=null&&fe>ce&&(ce=fe)}else{for(;++I<$;)if((fe=E.call(c,c[I],I))!=null&&fe>=fe){ce=fe;break}for(;++I<$;)(fe=E.call(c,c[I],I))!=null&&fe>ce&&(ce=fe)}return ce},d.extent=function(c,E){var I=-1,$=c.length,ce,fe,Ne;if(arguments.length===1){for(;++I<$;)if((fe=c[I])!=null&&fe>=fe){ce=Ne=fe;break}for(;++I<$;)(fe=c[I])!=null&&(ce>fe&&(ce=fe),Ne<fe&&(Ne=fe))}else{for(;++I<$;)if((fe=E.call(c,c[I],I))!=null&&fe>=fe){ce=Ne=fe;break}for(;++I<$;)(fe=E.call(c,c[I],I))!=null&&(ce>fe&&(ce=fe),Ne<fe&&(Ne=fe))}return[ce,Ne]};function L(c){return c===null?NaN:+c}function S(c){return!isNaN(c)}d.sum=function(c,E){var I=0,$=c.length,ce,fe=-1;if(arguments.length===1)for(;++fe<$;)S(ce=+c[fe])&&(I+=ce);else for(;++fe<$;)S(ce=+E.call(c,c[fe],fe))&&(I+=ce);return I},d.mean=function(c,E){var I=0,$=c.length,ce,fe=-1,Ne=$;if(arguments.length===1)for(;++fe<$;)S(ce=L(c[fe]))?I+=ce:--Ne;else for(;++fe<$;)S(ce=L(E.call(c,c[fe],fe)))?I+=ce:--Ne;if(Ne)return I/Ne},d.quantile=function(c,E){var I=(c.length-1)*E+1,$=Math.floor(I),ce=+c[$-1],fe=I-$;return fe?ce+fe*(c[$]-ce):ce},d.median=function(c,E){var I=[],$=c.length,ce,fe=-1;if(arguments.length===1)for(;++fe<$;)S(ce=L(c[fe]))&&I.push(ce);else for(;++fe<$;)S(ce=L(E.call(c,c[fe],fe)))&&I.push(ce);if(I.length)return d.quantile(I.sort(b),.5)},d.variance=function(c,E){var I=c.length,$=0,ce,fe,Ne=0,Le=-1,Be=0;if(arguments.length===1)for(;++Le<I;)S(ce=L(c[Le]))&&(fe=ce-$,$+=fe/++Be,Ne+=fe*(ce-$));else for(;++Le<I;)S(ce=L(E.call(c,c[Le],Le)))&&(fe=ce-$,$+=fe/++Be,Ne+=fe*(ce-$));if(Be>1)return Ne/(Be-1)},d.deviation=function(){var c=d.variance.apply(this,arguments);return c&&Math.sqrt(c)};function M(c){return{left:function(E,I,$,ce){for(arguments.length<3&&($=0),arguments.length<4&&(ce=E.length);$<ce;){var fe=$+ce>>>1;c(E[fe],I)<0?$=fe+1:ce=fe}return $},right:function(E,I,$,ce){for(arguments.length<3&&($=0),arguments.length<4&&(ce=E.length);$<ce;){var fe=$+ce>>>1;c(E[fe],I)>0?ce=fe:$=fe+1}return $}}}var T=M(b);d.bisectLeft=T.left,d.bisect=d.bisectRight=T.right,d.bisector=function(c){return M(c.length===1?function(E,I){return b(c(E),I)}:c)},d.shuffle=function(c,E,I){($=arguments.length)<3&&(I=c.length,$<2&&(E=0));for(var $=I-E,ce,fe;$;)fe=Math.random()*$--|0,ce=c[$+E],c[$+E]=c[fe+E],c[fe+E]=ce;return c},d.permute=function(c,E){for(var I=E.length,$=new Array(I);I--;)$[I]=c[E[I]];return $},d.pairs=function(c){for(var E=0,I=c.length-1,$,ce=c[0],fe=new Array(I<0?0:I);E<I;)fe[E]=[$=ce,ce=c[++E]];return fe},d.transpose=function(c){if(!(fe=c.length))return[];for(var E=-1,I=d.min(c,C),$=new Array(I);++E<I;)for(var ce=-1,fe,Ne=$[E]=new Array(fe);++ce<fe;)Ne[ce]=c[ce][E];return $};function C(c){return c.length}d.zip=function(){return d.transpose(arguments)},d.keys=function(c){var E=[];for(var I in c)E.push(I);return E},d.values=function(c){var E=[];for(var I in c)E.push(c[I]);return E},d.entries=function(c){var E=[];for(var I in c)E.push({key:I,value:c[I]});return E},d.merge=function(c){for(var E=c.length,I,$=-1,ce=0,fe,Ne;++$<E;)ce+=c[$].length;for(fe=new Array(ce);--E>=0;)for(Ne=c[E],I=Ne.length;--I>=0;)fe[--ce]=Ne[I];return fe};var m=Math.abs;d.range=function(c,E,I){if(arguments.length<3&&(I=1,arguments.length<2&&(E=c,c=0)),(E-c)/I===1/0)throw new Error("infinite range");var $=[],ce=y(m(I)),fe=-1,Ne;if(c*=ce,E*=ce,I*=ce,I<0)for(;(Ne=c+I*++fe)>E;)$.push(Ne/ce);else for(;(Ne=c+I*++fe)<E;)$.push(Ne/ce);return $};function y(c){for(var E=1;c*E%1;)E*=10;return E}function A(c,E){for(var I in E)Object.defineProperty(c.prototype,I,{value:E[I],enumerable:!1})}d.map=function(c,E){var I=new R;if(c instanceof R)c.forEach(function(Le,Be){I.set(Le,Be)});else if(Array.isArray(c)){var $=-1,ce=c.length,fe;if(arguments.length===1)for(;++$<ce;)I.set($,c[$]);else for(;++$<ce;)I.set(E.call(c,fe=c[$],$),fe)}else for(var Ne in c)I.set(Ne,c[Ne]);return I};function R(){this._=Object.create(null)}var N="__proto__",te="\0";A(R,{has:P,get:function(c){return this._[H(c)]},set:function(c,E){return this._[H(c)]=E},remove:re,keys:G,values:function(){var c=[];for(var E in this._)c.push(this._[E]);return c},entries:function(){var c=[];for(var E in this._)c.push({key:U(E),value:this._[E]});return c},size:Z,empty:Y,forEach:function(c){for(var E in this._)c.call(this,U(E),this._[E])}});function H(c){return(c+="")===N||c[0]===te?te+c:c}function U(c){return(c+="")[0]===te?c.slice(1):c}function P(c){return H(c)in this._}function re(c){return(c=H(c))in this._&&delete this._[c]}function G(){var c=[];for(var E in this._)c.push(U(E));return c}function Z(){var c=0;for(var E in this._)++c;return c}function Y(){for(var c in this._)return!1;return!0}d.nest=function(){var c={},E=[],I=[],$,ce;function fe(Le,Be,Qe){if(Qe>=E.length)return ce?ce.call(c,Be):$?Be.sort($):Be;for(var Ke=-1,wt=Be.length,Ct=E[Qe++],jt,er,Et,Bt=new R,Vt;++Ke<wt;)(Vt=Bt.get(jt=Ct(er=Be[Ke])))?Vt.push(er):Bt.set(jt,[er]);return Le?(er=Le(),Et=function(Kt,$t){er.set(Kt,fe(Le,$t,Qe))}):(er={},Et=function(Kt,$t){er[Kt]=fe(Le,$t,Qe)}),Bt.forEach(Et),er}function Ne(Le,Be){if(Be>=E.length)return Le;var Qe=[],Ke=I[Be++];return Le.forEach(function(wt,Ct){Qe.push({key:wt,values:Ne(Ct,Be)})}),Ke?Qe.sort(function(wt,Ct){return Ke(wt.key,Ct.key)}):Qe}return c.map=function(Le,Be){return fe(Be,Le,0)},c.entries=function(Le){return Ne(fe(d.map,Le,0),0)},c.key=function(Le){return E.push(Le),c},c.sortKeys=function(Le){return I[E.length-1]=Le,c},c.sortValues=function(Le){return $=Le,c},c.rollup=function(Le){return ce=Le,c},c},d.set=function(c){var E=new X;if(c)for(var I=0,$=c.length;I<$;++I)E.add(c[I]);return E};function X(){this._=Object.create(null)}A(X,{has:P,add:function(c){return this._[H(c+="")]=!0,c},remove:re,values:G,size:Z,empty:Y,forEach:function(c){for(var E in this._)c.call(this,U(E))}}),d.behavior={};function ne(c){return c}d.rebind=function(c,E){for(var I=1,$=arguments.length,ce;++I<$;)c[ce=arguments[I]]=ae(c,E,E[ce]);return c};function ae(c,E,I){return function(){var $=I.apply(E,arguments);return $===E?c:$}}function B(c,E){if(E in c)return E;E=E.charAt(0).toUpperCase()+E.slice(1);for(var I=0,$=ie.length;I<$;++I){var ce=ie[I]+E;if(ce in c)return ce}}var ie=["webkit","ms","moz","Moz","o","O"];function se(){}d.dispatch=function(){for(var c=new ye,E=-1,I=arguments.length;++E<I;)c[arguments[E]]=me(c);return c};function ye(){}ye.prototype.on=function(c,E){var I=c.indexOf("."),$="";if(I>=0&&($=c.slice(I+1),c=c.slice(0,I)),c)return arguments.length<2?this[c].on($):this[c].on($,E);if(arguments.length===2){if(E==null)for(c in this)this.hasOwnProperty(c)&&this[c].on($,null);return this}};function me(c){var E=[],I=new R;function $(){for(var ce=E,fe=-1,Ne=ce.length,Le;++fe<Ne;)(Le=ce[fe].on)&&Le.apply(this,arguments);return c}return $.on=function(ce,fe){var Ne=I.get(ce),Le;return arguments.length<2?Ne&&Ne.on:(Ne&&(Ne.on=null,E=E.slice(0,Le=E.indexOf(Ne)).concat(E.slice(Le+1)),I.remove(ce)),fe&&E.push(I.set(ce,{on:fe})),c)},$}d.event=null;function xe(){d.event.preventDefault()}function Re(){for(var c=d.event,E;E=c.sourceEvent;)c=E;return c}function ke(c){for(var E=new ye,I=0,$=arguments.length;++I<$;)E[arguments[I]]=me(E);return E.of=function(ce,fe){return function(Ne){try{var Le=Ne.sourceEvent=d.event;Ne.target=c,d.event=Ne,E[Ne.type].apply(ce,fe)}finally{d.event=Le}}},E}d.requote=function(c){return c.replace(Ie,"\\$&")};var Ie=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,Q={}.__proto__?function(c,E){c.__proto__=E}:function(c,E){for(var I in E)c[I]=E[I]};function ee(c){return Q(c,j),c}var D=function(c,E){return E.querySelector(c)},le=function(c,E){return E.querySelectorAll(c)},ge=function(c,E){var I=c.matches||c[B(c,"matchesSelector")];return ge=function($,ce){return I.call($,ce)},ge(c,E)};typeof Sizzle=="function"&&(D=function(c,E){return Sizzle(c,E)[0]||null},le=Sizzle,ge=Sizzle.matchesSelector),d.selection=function(){return d.select(f.documentElement)};var j=d.selection.prototype=[];j.select=function(c){var E=[],I,$,ce,fe;c=k(c);for(var Ne=-1,Le=this.length;++Ne<Le;){E.push(I=[]),I.parentNode=(ce=this[Ne]).parentNode;for(var Be=-1,Qe=ce.length;++Be<Qe;)(fe=ce[Be])?(I.push($=c.call(fe,fe.__data__,Be,Ne)),$&&"__data__"in fe&&($.__data__=fe.__data__)):I.push(null)}return ee(E)};function k(c){return typeof c=="function"?c:function(){return D(c,this)}}j.selectAll=function(c){var E=[],I,$;c=F(c);for(var ce=-1,fe=this.length;++ce<fe;)for(var Ne=this[ce],Le=-1,Be=Ne.length;++Le<Be;)($=Ne[Le])&&(E.push(I=s(c.call($,$.__data__,Le,ce))),I.parentNode=$);return ee(E)};function F(c){return typeof c=="function"?c:function(){return le(c,this)}}var J="http://www.w3.org/1999/xhtml",K={svg:"http://www.w3.org/2000/svg",xhtml:J,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d.ns={prefix:K,qualify:function(c){var E=c.indexOf(":"),I=c;return E>=0&&(I=c.slice(0,E))!=="xmlns"&&(c=c.slice(E+1)),K.hasOwnProperty(I)?{space:K[I],local:c}:c}},j.attr=function(c,E){if(arguments.length<2){if(typeof c=="string"){var I=this.node();return c=d.ns.qualify(c),c.local?I.getAttributeNS(c.space,c.local):I.getAttribute(c)}for(E in c)this.each(ve(E,c[E]));return this}return this.each(ve(c,E))};function ve(c,E){c=d.ns.qualify(c);function I(){this.removeAttribute(c)}function $(){this.removeAttributeNS(c.space,c.local)}function ce(){this.setAttribute(c,E)}function fe(){this.setAttributeNS(c.space,c.local,E)}function Ne(){var Be=E.apply(this,arguments);Be==null?this.removeAttribute(c):this.setAttribute(c,Be)}function Le(){var Be=E.apply(this,arguments);Be==null?this.removeAttributeNS(c.space,c.local):this.setAttributeNS(c.space,c.local,Be)}return E==null?c.local?$:I:typeof E=="function"?c.local?Le:Ne:c.local?fe:ce}function Te(c){return c.trim().replace(/\s+/g," ")}j.classed=function(c,E){if(arguments.length<2){if(typeof c=="string"){var I=this.node(),$=(c=Fe(c)).length,ce=-1;if(E=I.classList){for(;++ce<$;)if(!E.contains(c[ce]))return!1}else for(E=I.getAttribute("class");++ce<$;)if(!Ae(c[ce]).test(E))return!1;return!0}for(E in c)this.each(Ge(E,c[E]));return this}return this.each(Ge(c,E))};function Ae(c){return new RegExp("(?:^|\\s+)"+d.requote(c)+"(?:\\s+|$)","g")}function Fe(c){return(c+"").trim().split(/^|\s+/)}function Ge(c,E){c=Fe(c).map(rt);var I=c.length;function $(){for(var fe=-1;++fe<I;)c[fe](this,E)}function ce(){for(var fe=-1,Ne=E.apply(this,arguments);++fe<I;)c[fe](this,Ne)}return typeof E=="function"?ce:$}function rt(c){var E=Ae(c);return function(I,$){if(ce=I.classList)return $?ce.add(c):ce.remove(c);var ce=I.getAttribute("class")||"";$?(E.lastIndex=0,E.test(ce)||I.setAttribute("class",Te(ce+" "+c))):I.setAttribute("class",Te(ce.replace(E," ")))}}j.style=function(c,E,I){var $=arguments.length;if($<3){if(typeof c!="string"){$<2&&(E="");for(I in c)this.each(bt(I,c[I],E));return this}if($<2){var ce=this.node();return h(ce).getComputedStyle(ce,null).getPropertyValue(c)}I=""}return this.each(bt(c,E,I))};function bt(c,E,I){function $(){this.style.removeProperty(c)}function ce(){this.style.setProperty(c,E,I)}function fe(){var Ne=E.apply(this,arguments);Ne==null?this.style.removeProperty(c):this.style.setProperty(c,Ne,I)}return E==null?$:typeof E=="function"?fe:ce}j.property=function(c,E){if(arguments.length<2){if(typeof c=="string")return this.node()[c];for(E in c)this.each(ht(E,c[E]));return this}return this.each(ht(c,E))};function ht(c,E){function I(){delete this[c]}function $(){this[c]=E}function ce(){var fe=E.apply(this,arguments);fe==null?delete this[c]:this[c]=fe}return E==null?I:typeof E=="function"?ce:$}j.text=function(c){return arguments.length?this.each(typeof c=="function"?function(){var E=c.apply(this,arguments);this.textContent=E??""}:c==null?function(){this.textContent=""}:function(){this.textContent=c}):this.node().textContent},j.html=function(c){return arguments.length?this.each(typeof c=="function"?function(){var E=c.apply(this,arguments);this.innerHTML=E??""}:c==null?function(){this.innerHTML=""}:function(){this.innerHTML=c}):this.node().innerHTML},j.append=function(c){return c=ct(c),this.select(function(){return this.appendChild(c.apply(this,arguments))})};function ct(c){function E(){var $=this.ownerDocument,ce=this.namespaceURI;return ce===J&&$.documentElement.namespaceURI===J?$.createElement(c):$.createElementNS(ce,c)}function I(){return this.ownerDocument.createElementNS(c.space,c.local)}return typeof c=="function"?c:(c=d.ns.qualify(c)).local?I:E}j.insert=function(c,E){return c=ct(c),E=k(E),this.select(function(){return this.insertBefore(c.apply(this,arguments),E.apply(this,arguments)||null)})},j.remove=function(){return this.each(Oe)};function Oe(){var c=this.parentNode;c&&c.removeChild(this)}j.data=function(c,E){var I=-1,$=this.length,ce,fe;if(!arguments.length){for(c=new Array($=(ce=this[0]).length);++I<$;)(fe=ce[I])&&(c[I]=fe.__data__);return c}function Ne(Ke,wt){var Ct,jt=Ke.length,er=wt.length,Et=Math.min(jt,er),Bt=new Array(er),Vt=new Array(er),Kt=new Array(jt),$t,Gt;if(E){var Lr=new R,Xr=new Array(jt),tn;for(Ct=-1;++Ct<jt;)($t=Ke[Ct])&&(Lr.has(tn=E.call($t,$t.__data__,Ct))?Kt[Ct]=$t:Lr.set(tn,$t),Xr[Ct]=tn);for(Ct=-1;++Ct<er;)($t=Lr.get(tn=E.call(wt,Gt=wt[Ct],Ct)))?$t!==!0&&(Bt[Ct]=$t,$t.__data__=Gt):Vt[Ct]=ze(Gt),Lr.set(tn,!0);for(Ct=-1;++Ct<jt;)Ct in Xr&&Lr.get(Xr[Ct])!==!0&&(Kt[Ct]=Ke[Ct])}else{for(Ct=-1;++Ct<Et;)$t=Ke[Ct],Gt=wt[Ct],$t?($t.__data__=Gt,Bt[Ct]=$t):Vt[Ct]=ze(Gt);for(;Ct<er;++Ct)Vt[Ct]=ze(wt[Ct]);for(;Ct<jt;++Ct)Kt[Ct]=Ke[Ct]}Vt.update=Bt,Vt.parentNode=Bt.parentNode=Kt.parentNode=Ke.parentNode,Le.push(Vt),Be.push(Bt),Qe.push(Kt)}var Le=vt([]),Be=ee([]),Qe=ee([]);if(typeof c=="function")for(;++I<$;)Ne(ce=this[I],c.call(ce,ce.parentNode.__data__,I));else for(;++I<$;)Ne(ce=this[I],c);return Be.enter=function(){return Le},Be.exit=function(){return Qe},Be};function ze(c){return{__data__:c}}j.datum=function(c){return arguments.length?this.property("__data__",c):this.property("__data__")},j.filter=function(c){var E=[],I,$,ce;typeof c!="function"&&(c=we(c));for(var fe=0,Ne=this.length;fe<Ne;fe++){E.push(I=[]),I.parentNode=($=this[fe]).parentNode;for(var Le=0,Be=$.length;Le<Be;Le++)(ce=$[Le])&&c.call(ce,ce.__data__,Le,fe)&&I.push(ce)}return ee(E)};function we(c){return function(){return ge(this,c)}}j.order=function(){for(var c=-1,E=this.length;++c<E;)for(var I=this[c],$=I.length-1,ce=I[$],fe;--$>=0;)(fe=I[$])&&(ce&&ce!==fe.nextSibling&&ce.parentNode.insertBefore(fe,ce),ce=fe);return this},j.sort=function(c){c=je.apply(this,arguments);for(var E=-1,I=this.length;++E<I;)this[E].sort(c);return this.order()};function je(c){return arguments.length||(c=b),function(E,I){return E&&I?c(E.__data__,I.__data__):!E-!I}}j.each=function(c){return ot(this,function(E,I,$){c.call(E,E.__data__,I,$)})};function ot(c,E){for(var I=0,$=c.length;I<$;I++)for(var ce=c[I],fe=0,Ne=ce.length,Le;fe<Ne;fe++)(Le=ce[fe])&&E(Le,fe,I);return c}j.call=function(c){var E=s(arguments);return c.apply(E[0]=this,E),this},j.empty=function(){return!this.node()},j.node=function(){for(var c=0,E=this.length;c<E;c++)for(var I=this[c],$=0,ce=I.length;$<ce;$++){var fe=I[$];if(fe)return fe}return null},j.size=function(){var c=0;return ot(this,function(){++c}),c};function vt(c){return Q(c,Lt),c}var Lt=[];d.selection.enter=vt,d.selection.enter.prototype=Lt,Lt.append=j.append,Lt.empty=j.empty,Lt.node=j.node,Lt.call=j.call,Lt.size=j.size,Lt.select=function(c){for(var E=[],I,$,ce,fe,Ne,Le=-1,Be=this.length;++Le<Be;){ce=(fe=this[Le]).update,E.push(I=[]),I.parentNode=fe.parentNode;for(var Qe=-1,Ke=fe.length;++Qe<Ke;)(Ne=fe[Qe])?(I.push(ce[Qe]=$=c.call(fe.parentNode,Ne.__data__,Qe,Le)),$.__data__=Ne.__data__):I.push(null)}return ee(E)},Lt.insert=function(c,E){return arguments.length<2&&(E=Tt(this)),j.insert.call(this,c,E)};function Tt(c){var E,I;return function($,ce,fe){var Ne=c[fe].update,Le=Ne.length,Be;for(fe!=I&&(I=fe,E=0),ce>=E&&(E=ce+1);!(Be=Ne[E])&&++E<Le;);return Be}}d.select=function(c){var E;return typeof c=="string"?(E=[D(c,f)],E.parentNode=f.documentElement):(E=[c],E.parentNode=u(c)),ee([E])},d.selectAll=function(c){var E;return typeof c=="string"?(E=s(le(c,f)),E.parentNode=f.documentElement):(E=s(c),E.parentNode=null),ee([E])},j.on=function(c,E,I){var $=arguments.length;if($<3){if(typeof c!="string"){$<2&&(E=!1);for(I in c)this.each(kt(I,c[I],E));return this}if($<2)return($=this.node()["__on"+c])&&$._;I=!1}return this.each(kt(c,E,I))};function kt(c,E,I){var $="__on"+c,ce=c.indexOf("."),fe=Pt;ce>0&&(c=c.slice(0,ce));var Ne=Nt.get(c);Ne&&(c=Ne,fe=Wt);function Le(){var Ke=this[$];Ke&&(this.removeEventListener(c,Ke,Ke.$),delete this[$])}function Be(){var Ke=fe(E,s(arguments));Le.call(this),this.addEventListener(c,this[$]=Ke,Ke.$=I),Ke._=E}function Qe(){var Ke=new RegExp("^__on([^.]+)"+d.requote(c)+"$"),wt;for(var Ct in this)if(wt=Ct.match(Ke)){var jt=this[Ct];this.removeEventListener(wt[1],jt,jt.$),delete this[Ct]}}return ce?E?Be:Le:E?se:Qe}var Nt=d.map({mouseenter:"mouseover",mouseleave:"mouseout"});f&&Nt.forEach(function(c){"on"+c in f&&Nt.remove(c)});function Pt(c,E){return function(I){var $=d.event;d.event=I,E[0]=this.__data__;try{c.apply(this,E)}finally{d.event=$}}}function Wt(c,E){var I=Pt(c,E);return function($){var ce=this,fe=$.relatedTarget;(!fe||fe!==ce&&!(fe.compareDocumentPosition(ce)&8))&&I.call(ce,$)}}var St,Qt=0;function rr(c){var E=".dragsuppress-"+ ++Qt,I="click"+E,$=d.select(h(c)).on("touchmove"+E,xe).on("dragstart"+E,xe).on("selectstart"+E,xe);if(St==null&&(St="onselectstart"in c?!1:B(c.style,"userSelect")),St){var ce=u(c).style,fe=ce[St];ce[St]="none"}return function(Ne){if($.on(E,null),St&&(ce[St]=fe),Ne){var Le=function(){$.on(I,null)};$.on(I,function(){xe(),Le()},!0),setTimeout(Le,0)}}}d.mouse=function(c){return sr(c,Re())};var Jt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function sr(c,E){E.changedTouches&&(E=E.changedTouches[0]);var I=c.ownerSVGElement||c;if(I.createSVGPoint){var $=I.createSVGPoint();if(Jt<0){var ce=h(c);if(ce.scrollX||ce.scrollY){I=d.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var fe=I[0][0].getScreenCTM();Jt=!(fe.f||fe.e),I.remove()}}return Jt?($.x=E.pageX,$.y=E.pageY):($.x=E.clientX,$.y=E.clientY),$=$.matrixTransform(c.getScreenCTM().inverse()),[$.x,$.y]}var Ne=c.getBoundingClientRect();return[E.clientX-Ne.left-c.clientLeft,E.clientY-Ne.top-c.clientTop]}d.touch=function(c,E,I){if(arguments.length<3&&(I=E,E=Re().changedTouches),E){for(var $=0,ce=E.length,fe;$<ce;++$)if((fe=E[$]).identifier===I)return sr(c,fe)}},d.behavior.drag=function(){var c=ke(ce,"drag","dragstart","dragend"),E=null,I=fe(se,d.mouse,h,"mousemove","mouseup"),$=fe(De,d.touch,ne,"touchmove","touchend");function ce(){this.on("mousedown.drag",I).on("touchstart.drag",$)}function fe(Ne,Le,Be,Qe,Ke){return function(){var wt=this,Ct=d.event.target.correspondingElement||d.event.target,jt=wt.parentNode,er=c.of(wt,arguments),Et=0,Bt=Ne(),Vt=".drag"+(Bt==null?"":"-"+Bt),Kt,$t=d.select(Be(Ct)).on(Qe+Vt,Xr).on(Ke+Vt,tn),Gt=rr(Ct),Lr=Le(jt,Bt);E?(Kt=E.apply(wt,arguments),Kt=[Kt.x-Lr[0],Kt.y-Lr[1]]):Kt=[0,0],er({type:"dragstart"});function Xr(){var Kr=Le(jt,Bt),un,dn;Kr&&(un=Kr[0]-Lr[0],dn=Kr[1]-Lr[1],Et|=un|dn,Lr=Kr,er({type:"drag",x:Kr[0]+Kt[0],y:Kr[1]+Kt[1],dx:un,dy:dn}))}function tn(){Le(jt,Bt)&&($t.on(Qe+Vt,null).on(Ke+Vt,null),Gt(Et),er({type:"dragend"}))}}}return ce.origin=function(Ne){return arguments.length?(E=Ne,ce):E},d.rebind(ce,c,"on")};function De(){return d.event.changedTouches[0].identifier}d.touches=function(c,E){return arguments.length<2&&(E=Re().touches),E?s(E).map(function(I){var $=sr(c,I);return $.identifier=I.identifier,$}):[]};var Je=1e-6,de=Je*Je,Me=Math.PI,Ce=2*Me,Ue=Ce-Je,He=Me/2,et=Me/180,at=180/Me;function xt(c,E,I){return(E[0]-c[0])*(I[1]-c[1])-(E[1]-c[1])*(I[0]-c[0])}function mt(c){return c>1?He:c<-1?-He:Math.asin(c)}function yt(c){return((c=Math.exp(c))-1/c)/2}function It(c){return((c=Math.exp(c))+1/c)/2}function zt(c){return((c=Math.exp(2*c))-1)/(c+1)}var Ut=Math.SQRT2,or=2,xr=4;d.interpolateZoom=function(c,E){var I=c[0],$=c[1],ce=c[2],fe=E[0],Ne=E[1],Le=E[2],Be=fe-I,Qe=Ne-$,Ke=Be*Be+Qe*Qe,wt,Ct;if(Ke<de)Ct=Math.log(Le/ce)/Ut,wt=function(Kt){return[I+Kt*Be,$+Kt*Qe,ce*Math.exp(Ut*Kt*Ct)]};else{var jt=Math.sqrt(Ke),er=(Le*Le-ce*ce+xr*Ke)/(2*ce*or*jt),Et=(Le*Le-ce*ce-xr*Ke)/(2*Le*or*jt),Bt=Math.log(Math.sqrt(er*er+1)-er),Vt=Math.log(Math.sqrt(Et*Et+1)-Et);Ct=(Vt-Bt)/Ut,wt=function(Kt){var $t=Kt*Ct,Gt=It(Bt),Lr=ce/(or*jt)*(Gt*zt(Ut*$t+Bt)-yt(Bt));return[I+Lr*Be,$+Lr*Qe,ce*Gt/It(Ut*$t+Bt)]}}return wt.duration=Ct*1e3,wt},d.behavior.zoom=function(){var c={x:0,y:0,k:1},E,I,$,ce=[960,500],fe=zr,Ne=250,Le=0,Be="mousedown.zoom",Qe="mousemove.zoom",Ke="mouseup.zoom",wt,Ct="touchstart.zoom",jt,er=ke($t,"zoomstart","zoom","zoomend"),Et,Bt,Vt,Kt;Gr||(Gr="onwheel"in f?(Br=function(){return-d.event.deltaY*(d.event.deltaMode?120:1)},"wheel"):"onmousewheel"in f?(Br=function(){return d.event.wheelDelta},"mousewheel"):(Br=function(){return-d.event.detail},"MozMousePixelScroll"));function $t(Yr){Yr.on(Be,Bn).on(Gr+".zoom",Ti).on("dblclick.zoom",Ba).on(Ct,Ca)}$t.event=function(Yr){Yr.each(function(){var Qn=er.of(this,arguments),ia=c;bl?d.select(this).transition().each("start.zoom",function(){c=this.__chart__||{x:0,y:0,k:1},dn(Qn)}).tween("zoom:zoom",function(){var Ea=ce[0],mi=ce[1],Pi=I?I[0]:Ea/2,Yi=I?I[1]:mi/2,io=d.interpolateZoom([(Pi-c.x)/c.k,(Yi-c.y)/c.k,Ea/c.k],[(Pi-ia.x)/ia.k,(Yi-ia.y)/ia.k,Ea/ia.k]);return function(mo){var oo=io(mo),wo=Ea/oo[2];this.__chart__=c={x:Pi-oo[0]*wo,y:Yi-oo[1]*wo,k:wo},Zn(Qn)}}).each("interrupt.zoom",function(){yn(Qn)}).each("end.zoom",function(){yn(Qn)}):(this.__chart__=c,dn(Qn),Zn(Qn),yn(Qn))})},$t.translate=function(Yr){return arguments.length?(c={x:+Yr[0],y:+Yr[1],k:c.k},un(),$t):[c.x,c.y]},$t.scale=function(Yr){return arguments.length?(c={x:c.x,y:c.y,k:null},Xr(+Yr),un(),$t):c.k},$t.scaleExtent=function(Yr){return arguments.length?(fe=Yr==null?zr:[+Yr[0],+Yr[1]],$t):fe},$t.center=function(Yr){return arguments.length?($=Yr&&[+Yr[0],+Yr[1]],$t):$},$t.size=function(Yr){return arguments.length?(ce=Yr&&[+Yr[0],+Yr[1]],$t):ce},$t.duration=function(Yr){return arguments.length?(Ne=+Yr,$t):Ne},$t.x=function(Yr){return arguments.length?(Bt=Yr,Et=Yr.copy(),c={x:0,y:0,k:1},$t):Bt},$t.y=function(Yr){return arguments.length?(Kt=Yr,Vt=Yr.copy(),c={x:0,y:0,k:1},$t):Kt};function Gt(Yr){return[(Yr[0]-c.x)/c.k,(Yr[1]-c.y)/c.k]}function Lr(Yr){return[Yr[0]*c.k+c.x,Yr[1]*c.k+c.y]}function Xr(Yr){c.k=Math.max(fe[0],Math.min(fe[1],Yr))}function tn(Yr,Qn){Qn=Lr(Qn),c.x+=Yr[0]-Qn[0],c.y+=Yr[1]-Qn[1]}function Kr(Yr,Qn,ia,Ea){Yr.__chart__={x:c.x,y:c.y,k:c.k},Xr(Math.pow(2,Ea)),tn(I=Qn,ia),Yr=d.select(Yr),Ne>0&&(Yr=Yr.transition().duration(Ne)),Yr.call($t.event)}function un(){Bt&&Bt.domain(Et.range().map(function(Yr){return(Yr-c.x)/c.k}).map(Et.invert)),Kt&&Kt.domain(Vt.range().map(function(Yr){return(Yr-c.y)/c.k}).map(Vt.invert))}function dn(Yr){Le++||Yr({type:"zoomstart"})}function Zn(Yr){un(),Yr({type:"zoom",scale:c.k,translate:[c.x,c.y]})}function yn(Yr){--Le||(Yr({type:"zoomend"}),I=null)}function Bn(){var Yr=this,Qn=er.of(Yr,arguments),ia=0,Ea=d.select(h(Yr)).on(Qe,Yi).on(Ke,io),mi=Gt(d.mouse(Yr)),Pi=rr(Yr);Cd.call(Yr),dn(Qn);function Yi(){ia=1,tn(d.mouse(Yr),mi),Zn(Qn)}function io(){Ea.on(Qe,null).on(Ke,null),Pi(ia),yn(Qn)}}function Ca(){var Yr=this,Qn=er.of(Yr,arguments),ia={},Ea=0,mi,Pi=".zoom-"+d.event.changedTouches[0].identifier,Yi="touchmove"+Pi,io="touchend"+Pi,mo=[],oo=d.select(Yr),wo=rr(Yr);Mo(),dn(Qn),oo.on(Be,null).on(Ct,Mo);function eo(){var Wo=d.touches(Yr);return mi=c.k,Wo.forEach(function(qi){qi.identifier in ia&&(ia[qi.identifier]=Gt(qi))}),Wo}function Mo(){var Wo=d.event.target;d.select(Wo).on(Yi,wl).on(io,h5),mo.push(Wo);for(var qi=d.event.changedTouches,Io=0,cs=qi.length;Io<cs;++Io)ia[qi[Io].identifier]=null;var zo=eo(),ic=Date.now();if(zo.length===1){if(ic-jt<500){var Ml=zo[0];Kr(Yr,Ml,ia[Ml.identifier],Math.floor(Math.log(c.k)/Math.LN2)+1),xe()}jt=ic}else if(zo.length>1){var Ml=zo[0],Ws=zo[1],Rd=Ml[0]-Ws[0],xg=Ml[1]-Ws[1];Ea=Rd*Rd+xg*xg}}function wl(){var Wo=d.touches(Yr),qi,Io,cs,zo;Cd.call(Yr);for(var ic=0,Ml=Wo.length;ic<Ml;++ic,zo=null)if(cs=Wo[ic],zo=ia[cs.identifier]){if(Io)break;qi=cs,Io=zo}if(zo){var Ws=(Ws=cs[0]-qi[0])*Ws+(Ws=cs[1]-qi[1])*Ws,Rd=Ea&&Math.sqrt(Ws/Ea);qi=[(qi[0]+cs[0])/2,(qi[1]+cs[1])/2],Io=[(Io[0]+zo[0])/2,(Io[1]+zo[1])/2],Xr(Rd*mi)}jt=null,tn(qi,Io),Zn(Qn)}function h5(){if(d.event.touches.length){for(var Wo=d.event.changedTouches,qi=0,Io=Wo.length;qi<Io;++qi)delete ia[Wo[qi].identifier];for(var cs in ia)return void eo()}d.selectAll(mo).on(Pi,null),oo.on(Be,Bn).on(Ct,Ca),wo(),yn(Qn)}}function Ti(){var Yr=er.of(this,arguments);wt?clearTimeout(wt):(Cd.call(this),E=Gt(I=$||d.mouse(this)),dn(Yr)),wt=setTimeout(function(){wt=null,yn(Yr)},50),xe(),Xr(Math.pow(2,Br()*.002)*c.k),tn(I,E),Zn(Yr)}function Ba(){var Yr=d.mouse(this),Qn=Math.log(c.k)/Math.LN2;Kr(this,Yr,Gt(Yr),d.event.shiftKey?Math.ceil(Qn)-1:Math.floor(Qn)+1)}return d.rebind($t,er,"on")};var zr=[0,1/0],Br,Gr;d.color=wr;function wr(){}wr.prototype.toString=function(){return this.rgb()+""},d.hsl=lr;function lr(c,E,I){return this instanceof lr?(this.h=+c,this.s=+E,void(this.l=+I)):arguments.length<2?c instanceof lr?new lr(c.h,c.s,c.l):tt(""+c,lt,lr):new lr(c,E,I)}var Dr=lr.prototype=new wr;Dr.brighter=function(c){return c=Math.pow(.7,arguments.length?c:1),new lr(this.h,this.s,this.l/c)},Dr.darker=function(c){return c=Math.pow(.7,arguments.length?c:1),new lr(this.h,this.s,c*this.l)},Dr.rgb=function(){return Hr(this.h,this.s,this.l)};function Hr(c,E,I){var $,ce;c=isNaN(c)?0:(c%=360)<0?c+360:c,E=isNaN(E)||E<0?0:E>1?1:E,I=I<0?0:I>1?1:I,ce=I<=.5?I*(1+E):I+E-I*E,$=2*I-ce;function fe(Le){return Le>360?Le-=360:Le<0&&(Le+=360),Le<60?$+(ce-$)*Le/60:Le<180?ce:Le<240?$+(ce-$)*(240-Le)/60:$}function Ne(Le){return Math.round(fe(Le)*255)}return new Mr(Ne(c+120),Ne(c),Ne(c-120))}d.hcl=Rr;function Rr(c,E,I){return this instanceof Rr?(this.h=+c,this.c=+E,void(this.l=+I)):arguments.length<2?c instanceof Rr?new Rr(c.h,c.c,c.l):c instanceof _r?Gn(c.l,c.a,c.b):Gn((c=We((c=d.rgb(c)).r,c.g,c.b)).l,c.a,c.b):new Rr(c,E,I)}var Ar=Rr.prototype=new wr;Ar.brighter=function(c){return new Rr(this.h,this.c,Math.min(100,this.l+rn*(arguments.length?c:1)))},Ar.darker=function(c){return new Rr(this.h,this.c,Math.max(0,this.l-rn*(arguments.length?c:1)))},Ar.rgb=function(){return Er(this.h,this.c,this.l).rgb()};function Er(c,E,I){return isNaN(c)&&(c=0),isNaN(E)&&(E=0),new _r(I,Math.cos(c*=et)*E,Math.sin(c)*E)}d.lab=_r;function _r(c,E,I){return this instanceof _r?(this.l=+c,this.a=+E,void(this.b=+I)):arguments.length<2?c instanceof _r?new _r(c.l,c.a,c.b):c instanceof Rr?Er(c.h,c.c,c.l):We((c=Mr(c)).r,c.g,c.b):new _r(c,E,I)}var rn=18,gn=.95047,Ur=1,vn=1.08883,Cn=_r.prototype=new wr;Cn.brighter=function(c){return new _r(Math.min(100,this.l+rn*(arguments.length?c:1)),this.a,this.b)},Cn.darker=function(c){return new _r(Math.max(0,this.l-rn*(arguments.length?c:1)),this.a,this.b)},Cn.rgb=function(){return Vn(this.l,this.a,this.b)};function Vn(c,E,I){var $=(c+16)/116,ce=$+E/500,fe=$-I/200;return ce=sn(ce)*gn,$=sn($)*Ur,fe=sn(fe)*vn,new Mr(Tn(3.2404542*ce-1.5371385*$-.4985314*fe),Tn(-.969266*ce+1.8760108*$+.041556*fe),Tn(.0556434*ce-.2040259*$+1.0572252*fe))}function Gn(c,E,I){return c>0?new Rr(Math.atan2(I,E)*at,Math.sqrt(E*E+I*I),c):new Rr(NaN,NaN,c)}function sn(c){return c>.206893034?c*c*c:(c-4/29)/7.787037}function Fn(c){return c>.008856?Math.pow(c,1/3):7.787037*c+4/29}function Tn(c){return Math.round(255*(c<=.00304?12.92*c:1.055*Math.pow(c,1/2.4)-.055))}d.rgb=Mr;function Mr(c,E,I){return this instanceof Mr?(this.r=~~c,this.g=~~E,void(this.b=~~I)):arguments.length<2?c instanceof Mr?new Mr(c.r,c.g,c.b):tt(""+c,Mr,Hr):new Mr(c,E,I)}function oa(c){return new Mr(c>>16,c>>8&255,c&255)}function pe(c){return oa(c)+""}var he=Mr.prototype=new wr;he.brighter=function(c){c=Math.pow(.7,arguments.length?c:1);var E=this.r,I=this.g,$=this.b,ce=30;return!E&&!I&&!$?new Mr(ce,ce,ce):(E&&E<ce&&(E=ce),I&&I<ce&&(I=ce),$&&$<ce&&($=ce),new Mr(Math.min(255,E/c),Math.min(255,I/c),Math.min(255,$/c)))},he.darker=function(c){return c=Math.pow(.7,arguments.length?c:1),new Mr(c*this.r,c*this.g,c*this.b)},he.hsl=function(){return lt(this.r,this.g,this.b)},he.toString=function(){return"#"+Ye(this.r)+Ye(this.g)+Ye(this.b)};function Ye(c){return c<16?"0"+Math.max(0,c).toString(16):Math.min(255,c).toString(16)}function tt(c,E,I){var $=0,ce=0,fe=0,Ne,Le,Be;if(Ne=/([a-z]+)\((.*)\)/.exec(c=c.toLowerCase()),Ne)switch(Le=Ne[2].split(","),Ne[1]){case"hsl":return I(parseFloat(Le[0]),parseFloat(Le[1])/100,parseFloat(Le[2])/100);case"rgb":return E(dt(Le[0]),dt(Le[1]),dt(Le[2]))}return(Be=it.get(c))?E(Be.r,Be.g,Be.b):(c!=null&&c.charAt(0)==="#"&&!isNaN(Be=parseInt(c.slice(1),16))&&(c.length===4?($=(Be&3840)>>4,$=$>>4|$,ce=Be&240,ce=ce>>4|ce,fe=Be&15,fe=fe<<4|fe):c.length===7&&($=(Be&16711680)>>16,ce=(Be&65280)>>8,fe=Be&255)),E($,ce,fe))}function lt(c,E,I){var $=Math.min(c/=255,E/=255,I/=255),ce=Math.max(c,E,I),fe=ce-$,Ne,Le,Be=(ce+$)/2;return fe?(Le=Be<.5?fe/(ce+$):fe/(2-ce-$),c==ce?Ne=(E-I)/fe+(E<I?6:0):E==ce?Ne=(I-c)/fe+2:Ne=(c-E)/fe+4,Ne*=60):(Ne=NaN,Le=Be>0&&Be<1?0:Ne),new lr(Ne,Le,Be)}function We(c,E,I){c=Ze(c),E=Ze(E),I=Ze(I);var $=Fn((.4124564*c+.3575761*E+.1804375*I)/gn),ce=Fn((.2126729*c+.7151522*E+.072175*I)/Ur),fe=Fn((.0193339*c+.119192*E+.9503041*I)/vn);return _r(116*ce-16,500*($-ce),200*(ce-fe))}function Ze(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function dt(c){var E=parseFloat(c);return c.charAt(c.length-1)==="%"?Math.round(E*2.55):E}var it=d.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});it.forEach(function(c,E){it.set(c,oa(E))});function At(c){return typeof c=="function"?c:function(){return c}}d.functor=At,d.xhr=Rt(ne);function Rt(c){return function(E,I,$){return arguments.length===2&&typeof I=="function"&&($=I,I=null),Yt(E,I,c,$)}}function Yt(c,E,I,$){var ce={},fe=d.dispatch("beforesend","progress","load","error"),Ne={},Le=new XMLHttpRequest,Be=null;self.XDomainRequest&&!("withCredentials"in Le)&&/^(http(s)?:)?\/\//.test(c)&&(Le=new XDomainRequest),"onload"in Le?Le.onload=Le.onerror=Qe:Le.onreadystatechange=function(){Le.readyState>3&&Qe()};function Qe(){var Ke=Le.status,wt;if(!Ke&&fr(Le)||Ke>=200&&Ke<300||Ke===304){try{wt=I.call(ce,Le)}catch(Ct){fe.error.call(ce,Ct);return}fe.load.call(ce,wt)}else fe.error.call(ce,Le)}return Le.onprogress=function(Ke){var wt=d.event;d.event=Ke;try{fe.progress.call(ce,Le)}finally{d.event=wt}},ce.header=function(Ke,wt){return Ke=(Ke+"").toLowerCase(),arguments.length<2?Ne[Ke]:(wt==null?delete Ne[Ke]:Ne[Ke]=wt+"",ce)},ce.mimeType=function(Ke){return arguments.length?(E=Ke==null?null:Ke+"",ce):E},ce.responseType=function(Ke){return arguments.length?(Be=Ke,ce):Be},ce.response=function(Ke){return I=Ke,ce},["get","post"].forEach(function(Ke){ce[Ke]=function(){return ce.send.apply(ce,[Ke].concat(s(arguments)))}}),ce.send=function(Ke,wt,Ct){if(arguments.length===2&&typeof wt=="function"&&(Ct=wt,wt=null),Le.open(Ke,c,!0),E!=null&&!("accept"in Ne)&&(Ne.accept=E+",*/*"),Le.setRequestHeader)for(var jt in Ne)Le.setRequestHeader(jt,Ne[jt]);return E!=null&&Le.overrideMimeType&&Le.overrideMimeType(E),Be!=null&&(Le.responseType=Be),Ct!=null&&ce.on("error",Ct).on("load",function(er){Ct(null,er)}),fe.beforesend.call(ce,Le),Le.send(wt??null),ce},ce.abort=function(){return Le.abort(),ce},d.rebind(ce,fe,"on"),$==null?ce:ce.get(pr($))}function pr(c){return c.length===1?function(E,I){c(E==null?I:null)}:c}function fr(c){var E=c.responseType;return E&&E!=="text"?c.response:c.responseText}d.dsv=function(c,E){var I=new RegExp('["'+c+`
]`),$=c.charCodeAt(0);function ce(Qe,Ke,wt){arguments.length<3&&(wt=Ke,Ke=null);var Ct=Yt(Qe,E,Ke==null?fe:Ne(Ke),wt);return Ct.row=function(jt){return arguments.length?Ct.response((Ke=jt)==null?fe:Ne(jt)):Ke},Ct}function fe(Qe){return ce.parse(Qe.responseText)}function Ne(Qe){return function(Ke){return ce.parse(Ke.responseText,Qe)}}ce.parse=function(Qe,Ke){var wt;return ce.parseRows(Qe,function(Ct,jt){if(wt)return wt(Ct,jt-1);var er=function(Et){for(var Bt={},Vt=Ct.length,Kt=0;Kt<Vt;++Kt)Bt[Ct[Kt]]=Et[Kt];return Bt};wt=Ke?function(Et,Bt){return Ke(er(Et),Bt)}:er})},ce.parseRows=function(Qe,Ke){var wt={},Ct={},jt=[],er=Qe.length,Et=0,Bt=0,Vt,Kt;function $t(){if(Et>=er)return Ct;if(Kt)return Kt=!1,wt;var Lr=Et;if(Qe.charCodeAt(Lr)===34){for(var Xr=Lr;Xr++<er;)if(Qe.charCodeAt(Xr)===34){if(Qe.charCodeAt(Xr+1)!==34)break;++Xr}Et=Xr+2;var tn=Qe.charCodeAt(Xr+1);return tn===13?(Kt=!0,Qe.charCodeAt(Xr+2)===10&&++Et):tn===10&&(Kt=!0),Qe.slice(Lr+1,Xr).replace(/""/g,'"')}for(;Et<er;){var tn=Qe.charCodeAt(Et++),Kr=1;if(tn===10)Kt=!0;else if(tn===13)Kt=!0,Qe.charCodeAt(Et)===10&&(++Et,++Kr);else if(tn!==$)continue;return Qe.slice(Lr,Et-Kr)}return Qe.slice(Lr)}for(;(Vt=$t())!==Ct;){for(var Gt=[];Vt!==wt&&Vt!==Ct;)Gt.push(Vt),Vt=$t();Ke&&(Gt=Ke(Gt,Bt++))==null||jt.push(Gt)}return jt},ce.format=function(Qe){if(Array.isArray(Qe[0]))return ce.formatRows(Qe);var Ke=new X,wt=[];return Qe.forEach(function(Ct){for(var jt in Ct)Ke.has(jt)||wt.push(Ke.add(jt))}),[wt.map(Be).join(c)].concat(Qe.map(function(Ct){return wt.map(function(jt){return Be(Ct[jt])}).join(c)})).join(`
`)},ce.formatRows=function(Qe){return Qe.map(Le).join(`
`)};function Le(Qe){return Qe.map(Be).join(c)}function Be(Qe){return I.test(Qe)?'"'+Qe.replace(/\"/g,'""')+'"':Qe}return ce},d.csv=d.dsv(",","text/csv"),d.tsv=d.dsv("	","text/tab-separated-values");var Sr,hr,Cr,Fr,Un=this[B(this,"requestAnimationFrame")]||function(c){setTimeout(c,17)};d.timer=function(){on.apply(this,arguments)};function on(c,E,I){var $=arguments.length;$<2&&(E=0),$<3&&(I=Date.now());var ce=I+E,fe={c,t:ce,n:null};return hr?hr.n=fe:Sr=fe,hr=fe,Cr||(Fr=clearTimeout(Fr),Cr=1,Un(la)),fe}function la(){var c=bn(),E=ha()-c;E>24?(isFinite(E)&&(clearTimeout(Fr),Fr=setTimeout(la,E)),Cr=0):(Cr=1,Un(la))}d.timer.flush=function(){bn(),ha()};function bn(){for(var c=Date.now(),E=Sr;E;)c>=E.t&&E.c(c-E.t)&&(E.c=null),E=E.n;return c}function ha(){for(var c,E=Sr,I=1/0;E;)E.c?(E.t<I&&(I=E.t),E=(c=E).n):E=c?c.n=E.n:Sr=E.n;return hr=c,I}d.round=function(c,E){return E?Math.round(c*(E=Math.pow(10,E)))/E:Math.round(c)},d.geom={};function sa(c){return c[0]}function Fa(c){return c[1]}d.geom.hull=function(c){var E=sa,I=Fa;if(arguments.length)return $(c);function $(ce){if(ce.length<3)return[];var fe=At(E),Ne=At(I),Le,Be=ce.length,Qe=[],Ke=[];for(Le=0;Le<Be;Le++)Qe.push([+fe.call(this,ce[Le],Le),+Ne.call(this,ce[Le],Le),Le]);for(Qe.sort(An),Le=0;Le<Be;Le++)Ke.push([Qe[Le][0],-Qe[Le][1]]);var wt=ka(Qe),Ct=ka(Ke),jt=Ct[0]===wt[0],er=Ct[Ct.length-1]===wt[wt.length-1],Et=[];for(Le=wt.length-1;Le>=0;--Le)Et.push(ce[Qe[wt[Le]][2]]);for(Le=+jt;Le<Ct.length-er;++Le)Et.push(ce[Qe[Ct[Le]][2]]);return Et}return $.x=function(ce){return arguments.length?(E=ce,$):E},$.y=function(ce){return arguments.length?(I=ce,$):I},$};function ka(c){for(var E=c.length,I=[0,1],$=2,ce=2;ce<E;ce++){for(;$>1&&xt(c[I[$-2]],c[I[$-1]],c[ce])<=0;)--$;I[$++]=ce}return I.slice(0,$)}function An(c,E){return c[0]-E[0]||c[1]-E[1]}d.geom.polygon=function(c){return Q(c,Va),c};var Va=d.geom.polygon.prototype=[];Va.area=function(){for(var c=-1,E=this.length,I,$=this[E-1],ce=0;++c<E;)I=$,$=this[c],ce+=I[1]*$[0]-I[0]*$[1];return ce*.5},Va.centroid=function(c){var E=-1,I=this.length,$=0,ce=0,fe,Ne=this[I-1],Le;for(arguments.length||(c=-1/(6*this.area()));++E<I;)fe=Ne,Ne=this[E],Le=fe[0]*Ne[1]-Ne[0]*fe[1],$+=(fe[0]+Ne[0])*Le,ce+=(fe[1]+Ne[1])*Le;return[$*c,ce*c]},Va.clip=function(c){for(var E,I=Oa(c),$=-1,ce=this.length-Oa(this),fe,Ne,Le=this[ce-1],Be,Qe,Ke;++$<ce;){for(E=c.slice(),c.length=0,Be=this[$],Qe=E[(Ne=E.length-I)-1],fe=-1;++fe<Ne;)Ke=E[fe],Pa(Ke,Le,Be)?(Pa(Qe,Le,Be)||c.push(In(Qe,Ke,Le,Be)),c.push(Ke)):Pa(Qe,Le,Be)&&c.push(In(Qe,Ke,Le,Be)),Qe=Ke;I&&c.push(c[0]),Le=Be}return c};function Pa(c,E,I){return(I[0]-E[0])*(c[1]-E[1])<(I[1]-E[1])*(c[0]-E[0])}function In(c,E,I,$){var ce=c[0],fe=I[0],Ne=E[0]-ce,Le=$[0]-fe,Be=c[1],Qe=I[1],Ke=E[1]-Be,wt=$[1]-Qe,Ct=(Le*(Be-Qe)-wt*(ce-fe))/(wt*Ne-Le*Ke);return[ce+Ct*Ne,Be+Ct*Ke]}function Oa(c){var E=c[0],I=c[c.length-1];return!(E[0]-I[0]||E[1]-I[1])}var Ua,Na,ii,Ii=[],ea,_a,ca=[];function ba(){ci(this),this.edge=this.site=this.circle=null}function Wa(c){var E=Ii.pop()||new ba;return E.site=c,E}function oi(c){wi(c),ii.remove(c),Ii.push(c),ci(c)}function _i(c){var E=c.circle,I=E.x,$=E.cy,ce={x:I,y:$},fe=c.P,Ne=c.N,Le=[c];oi(c);for(var Be=fe;Be.circle&&m(I-Be.circle.x)<Je&&m($-Be.circle.cy)<Je;)fe=Be.P,Le.unshift(Be),oi(Be),Be=fe;Le.unshift(Be),wi(Be);for(var Qe=Ne;Qe.circle&&m(I-Qe.circle.x)<Je&&m($-Qe.circle.cy)<Je;)Ne=Qe.N,Le.push(Qe),oi(Qe),Qe=Ne;Le.push(Qe),wi(Qe);var Ke=Le.length,wt;for(wt=1;wt<Ke;++wt)Qe=Le[wt],Be=Le[wt-1],Za(Qe.edge,Be.site,Qe.site,ce);Be=Le[0],Qe=Le[Ke-1],Qe.edge=Co(Be.site,Qe.site,null,ce),Ri(Be),Ri(Qe)}function si(c){for(var E=c.x,I=c.y,$,ce,fe,Ne,Le=ii._;Le;)if(fe=Li(Le,I)-E,fe>Je)Le=Le.L;else if(Ne=E-li(Le,I),Ne>Je){if(!Le.R){$=Le;break}Le=Le.R}else{fe>-Je?($=Le.P,ce=Le):Ne>-Je?($=Le,ce=Le.N):$=ce=Le;break}var Be=Wa(c);if(ii.insert($,Be),!(!$&&!ce)){if($===ce){wi($),ce=Wa($.site),ii.insert(Be,ce),Be.edge=ce.edge=Co($.site,Be.site),Ri($),Ri(ce);return}if(!ce){Be.edge=Co($.site,Be.site);return}wi($),wi(ce);var Qe=$.site,Ke=Qe.x,wt=Qe.y,Ct=c.x-Ke,jt=c.y-wt,er=ce.site,Et=er.x-Ke,Bt=er.y-wt,Vt=2*(Ct*Bt-jt*Et),Kt=Ct*Ct+jt*jt,$t=Et*Et+Bt*Bt,Gt={x:(Bt*Kt-jt*$t)/Vt+Ke,y:(Ct*$t-Et*Kt)/Vt+wt};Za(ce.edge,Qe,er,Gt),Be.edge=Co(Qe,c,null,Gt),ce.edge=Co(c,er,null,Gt),Ri($),Ri(ce)}}function Li(c,E){var I=c.site,$=I.x,ce=I.y,fe=ce-E;if(!fe)return $;var Ne=c.P;if(!Ne)return-1/0;I=Ne.site;var Le=I.x,Be=I.y,Qe=Be-E;if(!Qe)return Le;var Ke=Le-$,wt=1/fe-1/Qe,Ct=Ke/Qe;return wt?(-Ct+Math.sqrt(Ct*Ct-2*wt*(Ke*Ke/(-2*Qe)-Be+Qe/2+ce-fe/2)))/wt+$:($+Le)/2}function li(c,E){var I=c.N;if(I)return Li(I,E);var $=c.site;return $.y===E?$.x:1/0}function ua(c){this.site=c,this.edges=[]}ua.prototype.prepare=function(){for(var c=this.edges,E=c.length,I;E--;)I=c[E].edge,(!I.b||!I.a)&&c.splice(E,1);return c.sort(bi),c.length};function ao(c){for(var E=c[0][0],I=c[1][0],$=c[0][1],ce=c[1][1],fe,Ne,Le,Be,Qe=Na,Ke=Qe.length,wt,Ct,jt,er,Et,Bt;Ke--;)if(wt=Qe[Ke],!(!wt||!wt.prepare()))for(jt=wt.edges,er=jt.length,Ct=0;Ct<er;)Bt=jt[Ct].end(),Le=Bt.x,Be=Bt.y,Et=jt[++Ct%er].start(),fe=Et.x,Ne=Et.y,(m(Le-fe)>Je||m(Be-Ne)>Je)&&(jt.splice(Ct,0,new pi(wa(wt.site,Bt,m(Le-E)<Je&&ce-Be>Je?{x:E,y:m(fe-E)<Je?Ne:ce}:m(Be-ce)<Je&&I-Le>Je?{x:m(Ne-ce)<Je?fe:I,y:ce}:m(Le-I)<Je&&Be-$>Je?{x:I,y:m(fe-I)<Je?Ne:$}:m(Be-$)<Je&&Le-E>Je?{x:m(Ne-$)<Je?fe:E,y:$}:null),wt.site,null)),++er)}function bi(c,E){return E.angle-c.angle}function Ui(){ci(this),this.x=this.y=this.arc=this.site=this.cy=null}function Ri(c){var E=c.P,I=c.N;if(!(!E||!I)){var $=E.site,ce=c.site,fe=I.site;if($!==fe){var Ne=ce.x,Le=ce.y,Be=$.x-Ne,Qe=$.y-Le,Ke=fe.x-Ne,wt=fe.y-Le,Ct=2*(Be*wt-Qe*Ke);if(!(Ct>=-de)){var jt=Be*Be+Qe*Qe,er=Ke*Ke+wt*wt,Et=(wt*jt-Qe*er)/Ct,Bt=(Be*er-Ke*jt)/Ct,wt=Bt+Le,Vt=ca.pop()||new Ui;Vt.arc=c,Vt.site=ce,Vt.x=Et+Ne,Vt.y=wt+Math.sqrt(Et*Et+Bt*Bt),Vt.cy=wt,c.circle=Vt;for(var Kt=null,$t=_a._;$t;)if(Vt.y<$t.y||Vt.y===$t.y&&Vt.x<=$t.x)if($t.L)$t=$t.L;else{Kt=$t.P;break}else if($t.R)$t=$t.R;else{Kt=$t;break}_a.insert(Kt,Vt),Kt||(ea=Vt)}}}}function wi(c){var E=c.circle;E&&(E.P||(ea=E.N),_a.remove(E),ca.push(E),ci(E),c.circle=null)}function bo(c,E,I,$){return function(ce){var fe=ce.a,Ne=ce.b,Le=fe.x,Be=fe.y,Qe=Ne.x,Ke=Ne.y,wt=0,Ct=1,jt=Qe-Le,er=Ke-Be,Et;if(Et=c-Le,!(!jt&&Et>0)){if(Et/=jt,jt<0){if(Et<wt)return;Et<Ct&&(Ct=Et)}else if(jt>0){if(Et>Ct)return;Et>wt&&(wt=Et)}if(Et=I-Le,!(!jt&&Et<0)){if(Et/=jt,jt<0){if(Et>Ct)return;Et>wt&&(wt=Et)}else if(jt>0){if(Et<wt)return;Et<Ct&&(Ct=Et)}if(Et=E-Be,!(!er&&Et>0)){if(Et/=er,er<0){if(Et<wt)return;Et<Ct&&(Ct=Et)}else if(er>0){if(Et>Ct)return;Et>wt&&(wt=Et)}if(Et=$-Be,!(!er&&Et<0)){if(Et/=er,er<0){if(Et>Ct)return;Et>wt&&(wt=Et)}else if(er>0){if(Et<wt)return;Et<Ct&&(Ct=Et)}return wt>0&&(ce.a={x:Le+wt*jt,y:Be+wt*er}),Ct<1&&(ce.b={x:Le+Ct*jt,y:Be+Ct*er}),ce}}}}}}function $i(c){for(var E=Ua,I=bo(c[0][0],c[0][1],c[1][0],c[1][1]),$=E.length,ce;$--;)ce=E[$],(!Mi(ce,c)||!I(ce)||m(ce.a.x-ce.b.x)<Je&&m(ce.a.y-ce.b.y)<Je)&&(ce.a=ce.b=null,E.splice($,1))}function Mi(c,E){var I=c.b;if(I)return!0;var $=c.a,ce=E[0][0],fe=E[1][0],Ne=E[0][1],Le=E[1][1],Be=c.l,Qe=c.r,Ke=Be.x,wt=Be.y,Ct=Qe.x,jt=Qe.y,er=(Ke+Ct)/2,Et=(wt+jt)/2,Bt,Vt;if(jt===wt){if(er<ce||er>=fe)return;if(Ke>Ct){if(!$)$={x:er,y:Ne};else if($.y>=Le)return;I={x:er,y:Le}}else{if(!$)$={x:er,y:Le};else if($.y<Ne)return;I={x:er,y:Ne}}}else if(Bt=(Ke-Ct)/(jt-wt),Vt=Et-Bt*er,Bt<-1||Bt>1)if(Ke>Ct){if(!$)$={x:(Ne-Vt)/Bt,y:Ne};else if($.y>=Le)return;I={x:(Le-Vt)/Bt,y:Le}}else{if(!$)$={x:(Le-Vt)/Bt,y:Le};else if($.y<Ne)return;I={x:(Ne-Vt)/Bt,y:Ne}}else if(wt<jt){if(!$)$={x:ce,y:Bt*ce+Vt};else if($.x>=fe)return;I={x:fe,y:Bt*fe+Vt}}else{if(!$)$={x:fe,y:Bt*fe+Vt};else if($.x<ce)return;I={x:ce,y:Bt*ce+Vt}}return c.a=$,c.b=I,!0}function po(c,E){this.l=c,this.r=E,this.a=this.b=null}function Co(c,E,I,$){var ce=new po(c,E);return Ua.push(ce),I&&Za(ce,c,E,I),$&&Za(ce,E,c,$),Na[c.i].edges.push(new pi(ce,c,E)),Na[E.i].edges.push(new pi(ce,E,c)),ce}function wa(c,E,I){var $=new po(c,null);return $.a=E,$.b=I,Ua.push($),$}function Za(c,E,I,$){!c.a&&!c.b?(c.a=$,c.l=E,c.r=I):c.l===I?c.b=$:c.a=$}function pi(c,E,I){var $=c.a,ce=c.b;this.edge=c,this.site=E,this.angle=I?Math.atan2(I.y-E.y,I.x-E.x):c.l===E?Math.atan2(ce.x-$.x,$.y-ce.y):Math.atan2($.x-ce.x,ce.y-$.y)}pi.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};function Bi(){this._=null}function ci(c){c.U=c.C=c.L=c.R=c.P=c.N=null}Bi.prototype={insert:function(c,E){var I,$,ce;if(c){if(E.P=c,E.N=c.N,c.N&&(c.N.P=E),c.N=E,c.R){for(c=c.R;c.L;)c=c.L;c.L=E}else c.R=E;I=c}else this._?(c=Vs(this._),E.P=null,E.N=c,c.P=c.L=E,I=c):(E.P=E.N=null,this._=E,I=null);for(E.L=E.R=null,E.U=I,E.C=!0,c=E;I&&I.C;)$=I.U,I===$.L?(ce=$.R,ce&&ce.C?(I.C=ce.C=!1,$.C=!0,c=$):(c===I.R&&(Da(this,I),c=I,I=c.U),I.C=!1,$.C=!0,Hi(this,$))):(ce=$.L,ce&&ce.C?(I.C=ce.C=!1,$.C=!0,c=$):(c===I.L&&(Hi(this,I),c=I,I=c.U),I.C=!1,$.C=!0,Da(this,$))),I=c.U;this._.C=!1},remove:function(c){c.N&&(c.N.P=c.P),c.P&&(c.P.N=c.N),c.N=c.P=null;var E=c.U,I,$=c.L,ce=c.R,fe,Ne;if($?ce?fe=Vs(ce):fe=$:fe=ce,E?E.L===c?E.L=fe:E.R=fe:this._=fe,$&&ce?(Ne=fe.C,fe.C=c.C,fe.L=$,$.U=fe,fe!==ce?(E=fe.U,fe.U=c.U,c=fe.R,E.L=c,fe.R=ce,ce.U=fe):(fe.U=E,E=fe,c=fe.R)):(Ne=c.C,c=fe),c&&(c.U=E),!Ne){if(c&&c.C){c.C=!1;return}do{if(c===this._)break;if(c===E.L){if(I=E.R,I.C&&(I.C=!1,E.C=!0,Da(this,E),I=E.R),I.L&&I.L.C||I.R&&I.R.C){(!I.R||!I.R.C)&&(I.L.C=!1,I.C=!0,Hi(this,I),I=E.R),I.C=E.C,E.C=I.R.C=!1,Da(this,E),c=this._;break}}else if(I=E.L,I.C&&(I.C=!1,E.C=!0,Hi(this,E),I=E.L),I.L&&I.L.C||I.R&&I.R.C){(!I.L||!I.L.C)&&(I.R.C=!1,I.C=!0,Da(this,I),I=E.L),I.C=E.C,E.C=I.L.C=!1,Hi(this,E),c=this._;break}I.C=!0,c=E,E=E.U}while(!c.C);c&&(c.C=!1)}}};function Da(c,E){var I=E,$=E.R,ce=I.U;ce?ce.L===I?ce.L=$:ce.R=$:c._=$,$.U=ce,I.U=$,I.R=$.L,I.R&&(I.R.U=I),$.L=I}function Hi(c,E){var I=E,$=E.L,ce=I.U;ce?ce.L===I?ce.L=$:ce.R=$:c._=$,$.U=ce,I.U=$,I.L=$.R,I.L&&(I.L.U=I),$.R=I}function Vs(c){for(;c.L;)c=c.L;return c}function os(c,E){var I=c.sort(au).pop(),$,ce,fe;for(Ua=[],Na=new Array(c.length),ii=new Bi,_a=new Bi;;)if(fe=ea,I&&(!fe||I.y<fe.y||I.y===fe.y&&I.x<fe.x))(I.x!==$||I.y!==ce)&&(Na[I.i]=new ua(I),si(I),$=I.x,ce=I.y),I=c.pop();else if(fe)_i(fe.arc);else break;E&&($i(E),ao(E));var Ne={cells:Na,edges:Ua};return ii=_a=Ua=Na=null,Ne}function au(c,E){return E.y-c.y||E.x-c.x}d.geom.voronoi=function(c){var E=sa,I=Fa,$=E,ce=I,fe=ss;if(c)return Ne(c);function Ne(Be){var Qe=new Array(Be.length),Ke=fe[0][0],wt=fe[0][1],Ct=fe[1][0],jt=fe[1][1];return os(Le(Be),fe).cells.forEach(function(er,Et){var Bt=er.edges,Vt=er.site,Kt=Qe[Et]=Bt.length?Bt.map(function($t){var Gt=$t.start();return[Gt.x,Gt.y]}):Vt.x>=Ke&&Vt.x<=Ct&&Vt.y>=wt&&Vt.y<=jt?[[Ke,jt],[Ct,jt],[Ct,wt],[Ke,wt]]:[];Kt.point=Be[Et]}),Qe}function Le(Be){return Be.map(function(Qe,Ke){return{x:Math.round($(Qe,Ke)/Je)*Je,y:Math.round(ce(Qe,Ke)/Je)*Je,i:Ke}})}return Ne.links=function(Be){return os(Le(Be)).edges.filter(function(Qe){return Qe.l&&Qe.r}).map(function(Qe){return{source:Be[Qe.l.i],target:Be[Qe.r.i]}})},Ne.triangles=function(Be){var Qe=[];return os(Le(Be)).cells.forEach(function(Ke,wt){for(var Ct=Ke.site,jt=Ke.edges.sort(bi),er=-1,Et=jt.length,Bt,Vt,Kt=jt[Et-1].edge,$t=Kt.l===Ct?Kt.r:Kt.l;++er<Et;)Bt=Kt,Vt=$t,Kt=jt[er].edge,$t=Kt.l===Ct?Kt.r:Kt.l,wt<Vt.i&&wt<$t.i&&md(Ct,Vt,$t)<0&&Qe.push([Be[wt],Be[Vt.i],Be[$t.i]])}),Qe},Ne.x=function(Be){return arguments.length?($=At(E=Be),Ne):E},Ne.y=function(Be){return arguments.length?(ce=At(I=Be),Ne):I},Ne.clipExtent=function(Be){return arguments.length?(fe=Be??ss,Ne):fe===ss?null:fe},Ne.size=function(Be){return arguments.length?Ne.clipExtent(Be&&[[0,0],Be]):fe===ss?null:fe&&fe[1]},Ne};var ss=[[-1e6,-1e6],[1e6,1e6]];function md(c,E,I){return(c.x-I.x)*(E.y-c.y)-(c.x-E.x)*(I.y-c.y)}d.geom.delaunay=function(c){return d.geom.voronoi().triangles(c)},d.geom.quadtree=function(c,E,I,$,ce){var fe=sa,Ne=Fa,Le;if(Le=arguments.length)return fe=gd,Ne=vd,Le===3&&(ce=I,$=E,I=E=0),Be(c);function Be(Qe){var Ke,wt=At(fe),Ct=At(Ne),jt,er,Et,Bt,Vt,Kt,$t,Gt;if(E!=null)Vt=E,Kt=I,$t=$,Gt=ce;else if($t=Gt=-(Vt=Kt=1/0),jt=[],er=[],Bt=Qe.length,Le)for(Et=0;Et<Bt;++Et)Ke=Qe[Et],Ke.x<Vt&&(Vt=Ke.x),Ke.y<Kt&&(Kt=Ke.y),Ke.x>$t&&($t=Ke.x),Ke.y>Gt&&(Gt=Ke.y),jt.push(Ke.x),er.push(Ke.y);else for(Et=0;Et<Bt;++Et){var Lr=+wt(Ke=Qe[Et],Et),Xr=+Ct(Ke,Et);Lr<Vt&&(Vt=Lr),Xr<Kt&&(Kt=Xr),Lr>$t&&($t=Lr),Xr>Gt&&(Gt=Xr),jt.push(Lr),er.push(Xr)}var tn=$t-Vt,Kr=Gt-Kt;tn>Kr?Gt=Kt+tn:$t=Vt+Kr;function un(yn,Bn,Ca,Ti,Ba,Yr,Qn,ia){if(!(isNaN(Ca)||isNaN(Ti)))if(yn.leaf){var Ea=yn.x,mi=yn.y;if(Ea!=null)if(m(Ea-Ca)+m(mi-Ti)<.01)dn(yn,Bn,Ca,Ti,Ba,Yr,Qn,ia);else{var Pi=yn.point;yn.x=yn.y=yn.point=null,dn(yn,Pi,Ea,mi,Ba,Yr,Qn,ia),dn(yn,Bn,Ca,Ti,Ba,Yr,Qn,ia)}else yn.x=Ca,yn.y=Ti,yn.point=Bn}else dn(yn,Bn,Ca,Ti,Ba,Yr,Qn,ia)}function dn(yn,Bn,Ca,Ti,Ba,Yr,Qn,ia){var Ea=(Ba+Qn)*.5,mi=(Yr+ia)*.5,Pi=Ca>=Ea,Yi=Ti>=mi,io=Yi<<1|Pi;yn.leaf=!1,yn=yn.nodes[io]||(yn.nodes[io]=iu()),Pi?Ba=Ea:Qn=Ea,Yi?Yr=mi:ia=mi,un(yn,Bn,Ca,Ti,Ba,Yr,Qn,ia)}var Zn=iu();if(Zn.add=function(yn){un(Zn,yn,+wt(yn,++Et),+Ct(yn,Et),Vt,Kt,$t,Gt)},Zn.visit=function(yn){Gs(yn,Zn,Vt,Kt,$t,Gt)},Zn.find=function(yn){return kb(Zn,yn[0],yn[1],Vt,Kt,$t,Gt)},Et=-1,E==null){for(;++Et<Bt;)un(Zn,Qe[Et],jt[Et],er[Et],Vt,Kt,$t,Gt);--Et}else Qe.forEach(Zn.add);return jt=er=Qe=Ke=null,Zn}return Be.x=function(Qe){return arguments.length?(fe=Qe,Be):fe},Be.y=function(Qe){return arguments.length?(Ne=Qe,Be):Ne},Be.extent=function(Qe){return arguments.length?(Qe==null?E=I=$=ce=null:(E=+Qe[0][0],I=+Qe[0][1],$=+Qe[1][0],ce=+Qe[1][1]),Be):E==null?null:[[E,I],[$,ce]]},Be.size=function(Qe){return arguments.length?(Qe==null?E=I=$=ce=null:(E=I=0,$=+Qe[0],ce=+Qe[1]),Be):E==null?null:[$-E,ce-I]},Be};function gd(c){return c.x}function vd(c){return c.y}function iu(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Gs(c,E,I,$,ce,fe){if(!c(E,I,$,ce,fe)){var Ne=(I+ce)*.5,Le=($+fe)*.5,Be=E.nodes;Be[0]&&Gs(c,Be[0],I,$,Ne,Le),Be[1]&&Gs(c,Be[1],Ne,$,ce,Le),Be[2]&&Gs(c,Be[2],I,Le,Ne,fe),Be[3]&&Gs(c,Be[3],Ne,Le,ce,fe)}}function kb(c,E,I,$,ce,fe,Ne){var Le=1/0,Be;return(function Qe(Ke,wt,Ct,jt,er){if(!(wt>fe||Ct>Ne||jt<$||er<ce)){if(Et=Ke.point){var Et,Bt=E-Ke.x,Vt=I-Ke.y,Kt=Bt*Bt+Vt*Vt;if(Kt<Le){var $t=Math.sqrt(Le=Kt);$=E-$t,ce=I-$t,fe=E+$t,Ne=I+$t,Be=Et}}for(var Gt=Ke.nodes,Lr=(wt+jt)*.5,Xr=(Ct+er)*.5,tn=E>=Lr,Kr=I>=Xr,un=Kr<<1|tn,dn=un+4;un<dn;++un)if(Ke=Gt[un&3])switch(un&3){case 0:Qe(Ke,wt,Ct,Lr,Xr);break;case 1:Qe(Ke,Lr,Ct,jt,Xr);break;case 2:Qe(Ke,wt,Xr,Lr,er);break;case 3:Qe(Ke,Lr,Xr,jt,er);break}}})(c,$,ce,fe,Ne),Be}d.interpolateRgb=Sf;function Sf(c,E){c=d.rgb(c),E=d.rgb(E);var I=c.r,$=c.g,ce=c.b,fe=E.r-I,Ne=E.g-$,Le=E.b-ce;return function(Be){return"#"+Ye(Math.round(I+fe*Be))+Ye(Math.round($+Ne*Be))+Ye(Math.round(ce+Le*Be))}}d.interpolateObject=_1;function _1(c,E){var I={},$={},ce;for(ce in c)ce in E?I[ce]=_l(c[ce],E[ce]):$[ce]=c[ce];for(ce in E)ce in c||($[ce]=E[ce]);return function(fe){for(ce in I)$[ce]=I[ce](fe);return $}}d.interpolateNumber=Ms;function Ms(c,E){return c=+c,E=+E,function(I){return c*(1-I)+E*I}}d.interpolateString=b1;function b1(c,E){var I=Cf.lastIndex=Ef.lastIndex=0,$,ce,fe,Ne=-1,Le=[],Be=[];for(c=c+"",E=E+"";($=Cf.exec(c))&&(ce=Ef.exec(E));)(fe=ce.index)>I&&(fe=E.slice(I,fe),Le[Ne]?Le[Ne]+=fe:Le[++Ne]=fe),($=$[0])===(ce=ce[0])?Le[Ne]?Le[Ne]+=ce:Le[++Ne]=ce:(Le[++Ne]=null,Be.push({i:Ne,x:Ms($,ce)})),I=Ef.lastIndex;return I<E.length&&(fe=E.slice(I),Le[Ne]?Le[Ne]+=fe:Le[++Ne]=fe),Le.length<2?Be[0]?(E=Be[0].x,function(Qe){return E(Qe)+""}):function(){return E}:(E=Be.length,function(Qe){for(var Ke=0,wt;Ke<E;++Ke)Le[(wt=Be[Ke]).i]=wt.x(Qe);return Le.join("")})}var Cf=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ef=new RegExp(Cf.source,"g");d.interpolate=_l;function _l(c,E){for(var I=d.interpolators.length,$;--I>=0&&!($=d.interpolators[I](c,E)););return $}d.interpolators=[function(c,E){var I=typeof E;return(I==="string"?it.has(E.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(E)?Sf:b1:E instanceof wr?Sf:Array.isArray(E)?yd:I==="object"&&isNaN(E)?_1:Ms)(c,E)}],d.interpolateArray=yd;function yd(c,E){var I=[],$=[],ce=c.length,fe=E.length,Ne=Math.min(c.length,E.length),Le;for(Le=0;Le<Ne;++Le)I.push(_l(c[Le],E[Le]));for(;Le<ce;++Le)$[Le]=c[Le];for(;Le<fe;++Le)$[Le]=E[Le];return function(Be){for(Le=0;Le<Ne;++Le)$[Le]=I[Le](Be);return $}}var w1=function(){return ne},Pb=d.map({linear:w1,poly:Fb,quad:function(){return Db},cubic:function(){return Ib},sin:function(){return Ub},exp:function(){return Bb},circle:function(){return Hb},elastic:Vb,back:Gb,bounce:function(){return jb}}),Ob=d.map({in:ne,out:M1,"in-out":T1,"out-in":function(c){return T1(M1(c))}});d.ease=function(c){var E=c.indexOf("-"),I=E>=0?c.slice(0,E):c,$=E>=0?c.slice(E+1):"in";return I=Pb.get(I)||w1,$=Ob.get($)||ne,Nb($(I.apply(null,i.call(arguments,1))))};function Nb(c){return function(E){return E<=0?0:E>=1?1:c(E)}}function M1(c){return function(E){return 1-c(1-E)}}function T1(c){return function(E){return .5*(E<.5?c(2*E):2-c(2-2*E))}}function Db(c){return c*c}function Ib(c){return c*c*c}function zb(c){if(c<=0)return 0;if(c>=1)return 1;var E=c*c,I=E*c;return 4*(c<.5?I:3*(c-E)+I-.75)}function Fb(c){return function(E){return Math.pow(E,c)}}function Ub(c){return 1-Math.cos(c*He)}function Bb(c){return Math.pow(2,10*(c-1))}function Hb(c){return 1-Math.sqrt(1-c*c)}function Vb(c,E){var I;return arguments.length<2&&(E=.45),arguments.length?I=E/Ce*Math.asin(1/c):(c=1,I=E/4),function($){return 1+c*Math.pow(2,-10*$)*Math.sin(($-I)*Ce/E)}}function Gb(c){return c||(c=1.70158),function(E){return E*E*((c+1)*E-c)}}function jb(c){return c<1/2.75?7.5625*c*c:c<2/2.75?7.5625*(c-=1.5/2.75)*c+.75:c<2.5/2.75?7.5625*(c-=2.25/2.75)*c+.9375:7.5625*(c-=2.625/2.75)*c+.984375}d.interpolateHcl=Wb;function Wb(c,E){c=d.hcl(c),E=d.hcl(E);var I=c.h,$=c.c,ce=c.l,fe=E.h-I,Ne=E.c-$,Le=E.l-ce;return isNaN(Ne)&&(Ne=0,$=isNaN($)?E.c:$),isNaN(fe)?(fe=0,I=isNaN(I)?E.h:I):fe>180?fe-=360:fe<-180&&(fe+=360),function(Be){return Er(I+fe*Be,$+Ne*Be,ce+Le*Be)+""}}d.interpolateHsl=Yb;function Yb(c,E){c=d.hsl(c),E=d.hsl(E);var I=c.h,$=c.s,ce=c.l,fe=E.h-I,Ne=E.s-$,Le=E.l-ce;return isNaN(Ne)&&(Ne=0,$=isNaN($)?E.s:$),isNaN(fe)?(fe=0,I=isNaN(I)?E.h:I):fe>180?fe-=360:fe<-180&&(fe+=360),function(Be){return Hr(I+fe*Be,$+Ne*Be,ce+Le*Be)+""}}d.interpolateLab=qb;function qb(c,E){c=d.lab(c),E=d.lab(E);var I=c.l,$=c.a,ce=c.b,fe=E.l-I,Ne=E.a-$,Le=E.b-ce;return function(Be){return Vn(I+fe*Be,$+Ne*Be,ce+Le*Be)+""}}d.interpolateRound=A1;function A1(c,E){return E-=c,function(I){return Math.round(c+E*I)}}d.transform=function(c){var E=f.createElementNS(d.ns.prefix.svg,"g");return(d.transform=function(I){if(I!=null){E.setAttribute("transform",I);var $=E.transform.baseVal.consolidate()}return new S1($?$.matrix:Xb)})(c)};function S1(c){var E=[c.a,c.b],I=[c.c,c.d],$=E1(E),ce=C1(E,I),fe=E1(Jb(I,E,-ce))||0;E[0]*I[1]<I[0]*E[1]&&(E[0]*=-1,E[1]*=-1,$*=-1,ce*=-1),this.rotate=($?Math.atan2(E[1],E[0]):Math.atan2(-I[0],I[1]))*at,this.translate=[c.e,c.f],this.scale=[$,fe],this.skew=fe?Math.atan2(ce,fe)*at:0}S1.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function C1(c,E){return c[0]*E[0]+c[1]*E[1]}function E1(c){var E=Math.sqrt(C1(c,c));return E&&(c[0]/=E,c[1]/=E),E}function Jb(c,E,I){return c[0]+=I*E[0],c[1]+=I*E[1],c}var Xb={a:1,b:0,c:0,d:1,e:0,f:0};d.interpolateTransform=L1;function ac(c){return c.length?c.pop()+",":""}function Zb(c,E,I,$){if(c[0]!==E[0]||c[1]!==E[1]){var ce=I.push("translate(",null,",",null,")");$.push({i:ce-4,x:Ms(c[0],E[0])},{i:ce-2,x:Ms(c[1],E[1])})}else(E[0]||E[1])&&I.push("translate("+E+")")}function Qb(c,E,I,$){c!==E?(c-E>180?E+=360:E-c>180&&(c+=360),$.push({i:I.push(ac(I)+"rotate(",null,")")-2,x:Ms(c,E)})):E&&I.push(ac(I)+"rotate("+E+")")}function Kb(c,E,I,$){c!==E?$.push({i:I.push(ac(I)+"skewX(",null,")")-2,x:Ms(c,E)}):E&&I.push(ac(I)+"skewX("+E+")")}function $b(c,E,I,$){if(c[0]!==E[0]||c[1]!==E[1]){var ce=I.push(ac(I)+"scale(",null,",",null,")");$.push({i:ce-4,x:Ms(c[0],E[0])},{i:ce-2,x:Ms(c[1],E[1])})}else(E[0]!==1||E[1]!==1)&&I.push(ac(I)+"scale("+E+")")}function L1(c,E){var I=[],$=[];return c=d.transform(c),E=d.transform(E),Zb(c.translate,E.translate,I,$),Qb(c.rotate,E.rotate,I,$),Kb(c.skew,E.skew,I,$),$b(c.scale,E.scale,I,$),c=E=null,function(ce){for(var fe=-1,Ne=$.length,Le;++fe<Ne;)I[(Le=$[fe]).i]=Le.x(ce);return I.join("")}}function e3(c,E){return E=(E-=c=+c)||1/E,function(I){return(I-c)/E}}function t3(c,E){return E=(E-=c=+c)||1/E,function(I){return Math.max(0,Math.min(1,(I-c)/E))}}d.layout={},d.layout.bundle=function(){return function(c){for(var E=[],I=-1,$=c.length;++I<$;)E.push(r3(c[I]));return E}};function r3(c){for(var E=c.source,I=c.target,$=n3(E,I),ce=[E];E!==$;)E=E.parent,ce.push(E);for(var fe=ce.length;I!==$;)ce.splice(fe,0,I),I=I.parent;return ce}function R1(c){for(var E=[],I=c.parent;I!=null;)E.push(c),c=I,I=I.parent;return E.push(c),E}function n3(c,E){if(c===E)return c;for(var I=R1(c),$=R1(E),ce=I.pop(),fe=$.pop(),Ne=null;ce===fe;)Ne=ce,ce=I.pop(),fe=$.pop();return Ne}d.layout.chord=function(){var c={},E,I,$,ce,fe=0,Ne,Le,Be;function Qe(){var wt={},Ct=[],jt=d.range(ce),er=[],Et,Bt,Vt,Kt,$t;for(E=[],I=[],Et=0,Kt=-1;++Kt<ce;){for(Bt=0,$t=-1;++$t<ce;)Bt+=$[Kt][$t];Ct.push(Bt),er.push(d.range(ce)),Et+=Bt}for(Ne&&jt.sort(function(Zn,yn){return Ne(Ct[Zn],Ct[yn])}),Le&&er.forEach(function(Zn,yn){Zn.sort(function(Bn,Ca){return Le($[yn][Bn],$[yn][Ca])})}),Et=(Ce-fe*ce)/Et,Bt=0,Kt=-1;++Kt<ce;){for(Vt=Bt,$t=-1;++$t<ce;){var Gt=jt[Kt],Lr=er[Gt][$t],Xr=$[Gt][Lr],tn=Bt,Kr=Bt+=Xr*Et;wt[Gt+"-"+Lr]={index:Gt,subindex:Lr,startAngle:tn,endAngle:Kr,value:Xr}}I[Gt]={index:Gt,startAngle:Vt,endAngle:Bt,value:Ct[Gt]},Bt+=fe}for(Kt=-1;++Kt<ce;)for($t=Kt-1;++$t<ce;){var un=wt[Kt+"-"+$t],dn=wt[$t+"-"+Kt];(un.value||dn.value)&&E.push(un.value<dn.value?{source:dn,target:un}:{source:un,target:dn})}Be&&Ke()}function Ke(){E.sort(function(wt,Ct){return Be((wt.source.value+wt.target.value)/2,(Ct.source.value+Ct.target.value)/2)})}return c.matrix=function(wt){return arguments.length?(ce=($=wt)&&$.length,E=I=null,c):$},c.padding=function(wt){return arguments.length?(fe=wt,E=I=null,c):fe},c.sortGroups=function(wt){return arguments.length?(Ne=wt,E=I=null,c):Ne},c.sortSubgroups=function(wt){return arguments.length?(Le=wt,E=null,c):Le},c.sortChords=function(wt){return arguments.length?(Be=wt,E&&Ke(),c):Be},c.chords=function(){return E||Qe(),E},c.groups=function(){return I||Qe(),I},c},d.layout.force=function(){var c={},E=d.dispatch("start","tick","end"),I,$=[1,1],ce,fe,Ne=.9,Le=l3,Be=c3,Qe=-30,Ke=u3,wt=.1,Ct=.64,jt=[],er=[],Et,Bt,Vt;function Kt(Gt){return function(Lr,Xr,tn,Kr){if(Lr.point!==Gt){var un=Lr.cx-Gt.x,dn=Lr.cy-Gt.y,Zn=Kr-Xr,yn=un*un+dn*dn;if(Zn*Zn/Ct<yn){if(yn<Ke){var Bn=Lr.charge/yn;Gt.px-=un*Bn,Gt.py-=dn*Bn}return!0}if(Lr.point&&yn&&yn<Ke){var Bn=Lr.pointCharge/yn;Gt.px-=un*Bn,Gt.py-=dn*Bn}}return!Lr.charge}}c.tick=function(){if((fe*=.99)<.005)return I=null,E.end({type:"end",alpha:fe=0}),!0;var Gt=jt.length,Lr=er.length,Xr,tn,Kr,un,dn,Zn,yn,Bn,Ca;for(tn=0;tn<Lr;++tn)Kr=er[tn],un=Kr.source,dn=Kr.target,Bn=dn.x-un.x,Ca=dn.y-un.y,(Zn=Bn*Bn+Ca*Ca)&&(Zn=fe*Bt[tn]*((Zn=Math.sqrt(Zn))-Et[tn])/Zn,Bn*=Zn,Ca*=Zn,dn.x-=Bn*(yn=un.weight+dn.weight?un.weight/(un.weight+dn.weight):.5),dn.y-=Ca*yn,un.x+=Bn*(yn=1-yn),un.y+=Ca*yn);if((yn=fe*wt)&&(Bn=$[0]/2,Ca=$[1]/2,tn=-1,yn))for(;++tn<Gt;)Kr=jt[tn],Kr.x+=(Bn-Kr.x)*yn,Kr.y+=(Ca-Kr.y)*yn;if(Qe)for(k1(Xr=d.geom.quadtree(jt),fe,Vt),tn=-1;++tn<Gt;)(Kr=jt[tn]).fixed||Xr.visit(Kt(Kr));for(tn=-1;++tn<Gt;)Kr=jt[tn],Kr.fixed?(Kr.x=Kr.px,Kr.y=Kr.py):(Kr.x-=(Kr.px-(Kr.px=Kr.x))*Ne,Kr.y-=(Kr.py-(Kr.py=Kr.y))*Ne);E.tick({type:"tick",alpha:fe})},c.nodes=function(Gt){return arguments.length?(jt=Gt,c):jt},c.links=function(Gt){return arguments.length?(er=Gt,c):er},c.size=function(Gt){return arguments.length?($=Gt,c):$},c.linkDistance=function(Gt){return arguments.length?(Le=typeof Gt=="function"?Gt:+Gt,c):Le},c.distance=c.linkDistance,c.linkStrength=function(Gt){return arguments.length?(Be=typeof Gt=="function"?Gt:+Gt,c):Be},c.friction=function(Gt){return arguments.length?(Ne=+Gt,c):Ne},c.charge=function(Gt){return arguments.length?(Qe=typeof Gt=="function"?Gt:+Gt,c):Qe},c.chargeDistance=function(Gt){return arguments.length?(Ke=Gt*Gt,c):Math.sqrt(Ke)},c.gravity=function(Gt){return arguments.length?(wt=+Gt,c):wt},c.theta=function(Gt){return arguments.length?(Ct=Gt*Gt,c):Math.sqrt(Ct)},c.alpha=function(Gt){return arguments.length?(Gt=+Gt,fe?Gt>0?fe=Gt:(I.c=null,I.t=NaN,I=null,E.end({type:"end",alpha:fe=0})):Gt>0&&(E.start({type:"start",alpha:fe=Gt}),I=on(c.tick)),c):fe},c.start=function(){var Gt,Lr=jt.length,Xr=er.length,tn=$[0],Kr=$[1],un,dn;for(Gt=0;Gt<Lr;++Gt)(dn=jt[Gt]).index=Gt,dn.weight=0;for(Gt=0;Gt<Xr;++Gt)dn=er[Gt],typeof dn.source=="number"&&(dn.source=jt[dn.source]),typeof dn.target=="number"&&(dn.target=jt[dn.target]),++dn.source.weight,++dn.target.weight;for(Gt=0;Gt<Lr;++Gt)dn=jt[Gt],isNaN(dn.x)&&(dn.x=Zn("x",tn)),isNaN(dn.y)&&(dn.y=Zn("y",Kr)),isNaN(dn.px)&&(dn.px=dn.x),isNaN(dn.py)&&(dn.py=dn.y);if(Et=[],typeof Le=="function")for(Gt=0;Gt<Xr;++Gt)Et[Gt]=+Le.call(this,er[Gt],Gt);else for(Gt=0;Gt<Xr;++Gt)Et[Gt]=Le;if(Bt=[],typeof Be=="function")for(Gt=0;Gt<Xr;++Gt)Bt[Gt]=+Be.call(this,er[Gt],Gt);else for(Gt=0;Gt<Xr;++Gt)Bt[Gt]=Be;if(Vt=[],typeof Qe=="function")for(Gt=0;Gt<Lr;++Gt)Vt[Gt]=+Qe.call(this,jt[Gt],Gt);else for(Gt=0;Gt<Lr;++Gt)Vt[Gt]=Qe;function Zn(yn,Bn){if(!un){for(un=new Array(Lr),Ba=0;Ba<Lr;++Ba)un[Ba]=[];for(Ba=0;Ba<Xr;++Ba){var Ca=er[Ba];un[Ca.source.index].push(Ca.target),un[Ca.target.index].push(Ca.source)}}for(var Ti=un[Gt],Ba=-1,Yr=Ti.length,Qn;++Ba<Yr;)if(!isNaN(Qn=Ti[Ba][yn]))return Qn;return Math.random()*Bn}return c.resume()},c.resume=function(){return c.alpha(.1)},c.stop=function(){return c.alpha(0)},c.drag=function(){if(ce||(ce=d.behavior.drag().origin(ne).on("dragstart.force",a3).on("drag.force",$t).on("dragend.force",i3)),!arguments.length)return ce;this.on("mouseover.force",o3).on("mouseout.force",s3).call(ce)};function $t(Gt){Gt.px=d.event.x,Gt.py=d.event.y,c.resume()}return d.rebind(c,E,"on")};function a3(c){c.fixed|=2}function i3(c){c.fixed&=-7}function o3(c){c.fixed|=4,c.px=c.x,c.py=c.y}function s3(c){c.fixed&=-5}function k1(c,E,I){var $=0,ce=0;if(c.charge=0,!c.leaf)for(var fe=c.nodes,Ne=fe.length,Le=-1,Be;++Le<Ne;)Be=fe[Le],Be!=null&&(k1(Be,E,I),c.charge+=Be.charge,$+=Be.charge*Be.cx,ce+=Be.charge*Be.cy);if(c.point){c.leaf||(c.point.x+=Math.random()-.5,c.point.y+=Math.random()-.5);var Qe=E*I[c.point.index];c.charge+=c.pointCharge=Qe,$+=Qe*c.point.x,ce+=Qe*c.point.y}c.cx=$/c.charge,c.cy=ce/c.charge}var l3=20,c3=1,u3=1/0;d.layout.hierarchy=function(){var c=f3,E=d3,I=h3;function $(ce){var fe=[ce],Ne=[],Le;for(ce.depth=0;(Le=fe.pop())!=null;)if(Ne.push(Le),(Qe=E.call($,Le,Le.depth))&&(Be=Qe.length)){for(var Be,Qe,Ke;--Be>=0;)fe.push(Ke=Qe[Be]),Ke.parent=Le,Ke.depth=Le.depth+1;I&&(Le.value=0),Le.children=Qe}else I&&(Le.value=+I.call($,Le,Le.depth)||0),delete Le.children;return ls(ce,function(wt){var Ct,jt;c&&(Ct=wt.children)&&Ct.sort(c),I&&(jt=wt.parent)&&(jt.value+=wt.value)}),Ne}return $.sort=function(ce){return arguments.length?(c=ce,$):c},$.children=function(ce){return arguments.length?(E=ce,$):E},$.value=function(ce){return arguments.length?(I=ce,$):I},$.revalue=function(ce){return I&&(su(ce,function(fe){fe.children&&(fe.value=0)}),ls(ce,function(fe){var Ne;fe.children||(fe.value=+I.call($,fe,fe.depth)||0),(Ne=fe.parent)&&(Ne.value+=fe.value)})),ce},$};function ou(c,E){return d.rebind(c,E,"sort","children","value"),c.nodes=c,c.links=p3,c}function su(c,E){for(var I=[c];(c=I.pop())!=null;)if(E(c),(ce=c.children)&&($=ce.length))for(var $,ce;--$>=0;)I.push(ce[$])}function ls(c,E){for(var I=[c],$=[];(c=I.pop())!=null;)if($.push(c),(Ne=c.children)&&(fe=Ne.length))for(var ce=-1,fe,Ne;++ce<fe;)I.push(Ne[ce]);for(;(c=$.pop())!=null;)E(c)}function d3(c){return c.children}function h3(c){return c.value}function f3(c,E){return E.value-c.value}function p3(c){return d.merge(c.map(function(E){return(E.children||[]).map(function(I){return{source:E,target:I}})}))}d.layout.partition=function(){var c=d.layout.hierarchy(),E=[1,1];function I(fe,Ne,Le,Be){var Qe=fe.children;if(fe.x=Ne,fe.y=fe.depth*Be,fe.dx=Le,fe.dy=Be,Qe&&(wt=Qe.length)){var Ke=-1,wt,Ct,jt;for(Le=fe.value?Le/fe.value:0;++Ke<wt;)I(Ct=Qe[Ke],Ne,jt=Ct.value*Le,Be),Ne+=jt}}function $(fe){var Ne=fe.children,Le=0;if(Ne&&(Qe=Ne.length))for(var Be=-1,Qe;++Be<Qe;)Le=Math.max(Le,$(Ne[Be]));return 1+Le}function ce(fe,Ne){var Le=c.call(this,fe,Ne);return I(Le[0],0,E[0],E[1]/$(Le[0])),Le}return ce.size=function(fe){return arguments.length?(E=fe,ce):E},ou(ce,c)},d.layout.pie=function(){var c=Number,E=P1,I=0,$=Ce,ce=0;function fe(Ne){var Le=Ne.length,Be=Ne.map(function(Kt,$t){return+c.call(fe,Kt,$t)}),Qe=+(typeof I=="function"?I.apply(this,arguments):I),Ke=(typeof $=="function"?$.apply(this,arguments):$)-Qe,wt=Math.min(Math.abs(Ke)/Le,+(typeof ce=="function"?ce.apply(this,arguments):ce)),Ct=wt*(Ke<0?-1:1),jt=d.sum(Be),er=jt?(Ke-Le*Ct)/jt:0,Et=d.range(Le),Bt=[],Vt;return E!=null&&Et.sort(E===P1?function(Kt,$t){return Be[$t]-Be[Kt]}:function(Kt,$t){return E(Ne[Kt],Ne[$t])}),Et.forEach(function(Kt){Bt[Kt]={data:Ne[Kt],value:Vt=Be[Kt],startAngle:Qe,endAngle:Qe+=Vt*er+Ct,padAngle:wt}}),Bt}return fe.value=function(Ne){return arguments.length?(c=Ne,fe):c},fe.sort=function(Ne){return arguments.length?(E=Ne,fe):E},fe.startAngle=function(Ne){return arguments.length?(I=Ne,fe):I},fe.endAngle=function(Ne){return arguments.length?($=Ne,fe):$},fe.padAngle=function(Ne){return arguments.length?(ce=Ne,fe):ce},fe};var P1={};d.layout.stack=function(){var c=ne,E=Lf,I=Rf,$=v3,ce=m3,fe=g3;function Ne(Le,Be){if(!(er=Le.length))return Le;var Qe=Le.map(function(Kt,$t){return c.call(Ne,Kt,$t)}),Ke=Qe.map(function(Kt){return Kt.map(function($t,Gt){return[ce.call(Ne,$t,Gt),fe.call(Ne,$t,Gt)]})}),wt=E.call(Ne,Ke,Be);Qe=d.permute(Qe,wt),Ke=d.permute(Ke,wt);var Ct=I.call(Ne,Ke,Be),jt=Qe[0].length,er,Et,Bt,Vt;for(Bt=0;Bt<jt;++Bt)for($.call(Ne,Qe[0][Bt],Vt=Ct[Bt],Ke[0][Bt][1]),Et=1;Et<er;++Et)$.call(Ne,Qe[Et][Bt],Vt+=Ke[Et-1][Bt][1],Ke[Et][Bt][1]);return Le}return Ne.values=function(Le){return arguments.length?(c=Le,Ne):c},Ne.order=function(Le){return arguments.length?(E=typeof Le=="function"?Le:y3.get(Le)||Lf,Ne):E},Ne.offset=function(Le){return arguments.length?(I=typeof Le=="function"?Le:x3.get(Le)||Rf,Ne):I},Ne.x=function(Le){return arguments.length?(ce=Le,Ne):ce},Ne.y=function(Le){return arguments.length?(fe=Le,Ne):fe},Ne.out=function(Le){return arguments.length?($=Le,Ne):$},Ne};function m3(c){return c.x}function g3(c){return c.y}function v3(c,E,I){c.y0=E,c.y=I}var y3=d.map({"inside-out":function(c){var E=c.length,I,$,ce=c.map(_3),fe=c.map(b3),Ne=d.range(E).sort(function(wt,Ct){return ce[wt]-ce[Ct]}),Le=0,Be=0,Qe=[],Ke=[];for(I=0;I<E;++I)$=Ne[I],Le<Be?(Le+=fe[$],Qe.push($)):(Be+=fe[$],Ke.push($));return Ke.reverse().concat(Qe)},reverse:function(c){return d.range(c.length).reverse()},default:Lf}),x3=d.map({silhouette:function(c){var E=c.length,I=c[0].length,$=[],ce=0,fe,Ne,Le,Be=[];for(Ne=0;Ne<I;++Ne){for(fe=0,Le=0;fe<E;fe++)Le+=c[fe][Ne][1];Le>ce&&(ce=Le),$.push(Le)}for(Ne=0;Ne<I;++Ne)Be[Ne]=(ce-$[Ne])/2;return Be},wiggle:function(c){var E=c.length,I=c[0],$=I.length,ce,fe,Ne,Le,Be,Qe,Ke,wt,Ct,jt=[];for(jt[0]=wt=Ct=0,fe=1;fe<$;++fe){for(ce=0,Le=0;ce<E;++ce)Le+=c[ce][fe][1];for(ce=0,Be=0,Ke=I[fe][0]-I[fe-1][0];ce<E;++ce){for(Ne=0,Qe=(c[ce][fe][1]-c[ce][fe-1][1])/(2*Ke);Ne<ce;++Ne)Qe+=(c[Ne][fe][1]-c[Ne][fe-1][1])/Ke;Be+=Qe*c[ce][fe][1]}jt[fe]=wt-=Le?Be/Le*Ke:0,wt<Ct&&(Ct=wt)}for(fe=0;fe<$;++fe)jt[fe]-=Ct;return jt},expand:function(c){var E=c.length,I=c[0].length,$=1/E,ce,fe,Ne,Le=[];for(fe=0;fe<I;++fe){for(ce=0,Ne=0;ce<E;ce++)Ne+=c[ce][fe][1];if(Ne)for(ce=0;ce<E;ce++)c[ce][fe][1]/=Ne;else for(ce=0;ce<E;ce++)c[ce][fe][1]=$}for(fe=0;fe<I;++fe)Le[fe]=0;return Le},zero:Rf});function Lf(c){return d.range(c.length)}function Rf(c){for(var E=-1,I=c[0].length,$=[];++E<I;)$[E]=0;return $}function _3(c){for(var E=1,I=0,$=c[0][1],ce,fe=c.length;E<fe;++E)(ce=c[E][1])>$&&(I=E,$=ce);return I}function b3(c){return c.reduce(w3,0)}function w3(c,E){return c+E[1]}d.layout.histogram=function(){var c=!0,E=Number,I=T3,$=M3;function ce(fe,Ne){for(var Le=[],Be=fe.map(E,this),Qe=I.call(this,Be,Ne),Ke=$.call(this,Qe,Be,Ne),wt,Ne=-1,Ct=Be.length,jt=Ke.length-1,er=c?1:1/Ct,Et;++Ne<jt;)wt=Le[Ne]=[],wt.dx=Ke[Ne+1]-(wt.x=Ke[Ne]),wt.y=0;if(jt>0)for(Ne=-1;++Ne<Ct;)Et=Be[Ne],Et>=Qe[0]&&Et<=Qe[1]&&(wt=Le[d.bisect(Ke,Et,1,jt)-1],wt.y+=er,wt.push(fe[Ne]));return Le}return ce.value=function(fe){return arguments.length?(E=fe,ce):E},ce.range=function(fe){return arguments.length?(I=At(fe),ce):I},ce.bins=function(fe){return arguments.length?($=typeof fe=="number"?function(Ne){return O1(Ne,fe)}:At(fe),ce):$},ce.frequency=function(fe){return arguments.length?(c=!!fe,ce):c},ce};function M3(c,E){return O1(c,Math.ceil(Math.log(E.length)/Math.LN2+1))}function O1(c,E){for(var I=-1,$=+c[0],ce=(c[1]-$)/E,fe=[];++I<=E;)fe[I]=ce*I+$;return fe}function T3(c){return[d.min(c),d.max(c)]}d.layout.pack=function(){var c=d.layout.hierarchy().sort(A3),E=0,I=[1,1],$;function ce(fe,Ne){var Le=c.call(this,fe,Ne),Be=Le[0],Qe=I[0],Ke=I[1],wt=$==null?Math.sqrt:typeof $=="function"?$:function(){return $};if(Be.x=Be.y=0,ls(Be,function(jt){jt.r=+wt(jt.value)}),ls(Be,I1),E){var Ct=E*($?1:Math.max(2*Be.r/Qe,2*Be.r/Ke))/2;ls(Be,function(jt){jt.r+=Ct}),ls(Be,I1),ls(Be,function(jt){jt.r-=Ct})}return z1(Be,Qe/2,Ke/2,$?1:1/Math.max(2*Be.r/Qe,2*Be.r/Ke)),Le}return ce.size=function(fe){return arguments.length?(I=fe,ce):I},ce.radius=function(fe){return arguments.length?($=fe==null||typeof fe=="function"?fe:+fe,ce):$},ce.padding=function(fe){return arguments.length?(E=+fe,ce):E},ou(ce,c)};function A3(c,E){return c.value-E.value}function kf(c,E){var I=c._pack_next;c._pack_next=E,E._pack_prev=c,E._pack_next=I,I._pack_prev=E}function N1(c,E){c._pack_next=E,E._pack_prev=c}function D1(c,E){var I=E.x-c.x,$=E.y-c.y,ce=c.r+E.r;return .999*ce*ce>I*I+$*$}function I1(c){if(!(E=c.children)||!(Ct=E.length))return;var E,I=1/0,$=-1/0,ce=1/0,fe=-1/0,Ne,Le,Be,Qe,Ke,wt,Ct;function jt(Gt){I=Math.min(Gt.x-Gt.r,I),$=Math.max(Gt.x+Gt.r,$),ce=Math.min(Gt.y-Gt.r,ce),fe=Math.max(Gt.y+Gt.r,fe)}if(E.forEach(S3),Ne=E[0],Ne.x=-Ne.r,Ne.y=0,jt(Ne),Ct>1&&(Le=E[1],Le.x=Le.r,Le.y=0,jt(Le),Ct>2))for(Be=E[2],F1(Ne,Le,Be),jt(Be),kf(Ne,Be),Ne._pack_prev=Be,kf(Be,Le),Le=Ne._pack_next,Qe=3;Qe<Ct;Qe++){F1(Ne,Le,Be=E[Qe]);var er=0,Et=1,Bt=1;for(Ke=Le._pack_next;Ke!==Le;Ke=Ke._pack_next,Et++)if(D1(Ke,Be)){er=1;break}if(er==1)for(wt=Ne._pack_prev;wt!==Ke._pack_prev&&!D1(wt,Be);wt=wt._pack_prev,Bt++);er?(Et<Bt||Et==Bt&&Le.r<Ne.r?N1(Ne,Le=Ke):N1(Ne=wt,Le),Qe--):(kf(Ne,Be),Le=Be,jt(Be))}var Vt=(I+$)/2,Kt=(ce+fe)/2,$t=0;for(Qe=0;Qe<Ct;Qe++)Be=E[Qe],Be.x-=Vt,Be.y-=Kt,$t=Math.max($t,Be.r+Math.sqrt(Be.x*Be.x+Be.y*Be.y));c.r=$t,E.forEach(C3)}function S3(c){c._pack_next=c._pack_prev=c}function C3(c){delete c._pack_next,delete c._pack_prev}function z1(c,E,I,$){var ce=c.children;if(c.x=E+=$*c.x,c.y=I+=$*c.y,c.r*=$,ce)for(var fe=-1,Ne=ce.length;++fe<Ne;)z1(ce[fe],E,I,$)}function F1(c,E,I){var $=c.r+I.r,ce=E.x-c.x,fe=E.y-c.y;if($&&(ce||fe)){var Ne=E.r+I.r,Le=ce*ce+fe*fe;Ne*=Ne,$*=$;var Be=.5+($-Ne)/(2*Le),Qe=Math.sqrt(Math.max(0,2*Ne*($+Le)-($-=Le)*$-Ne*Ne))/(2*Le);I.x=c.x+Be*ce+Qe*fe,I.y=c.y+Be*fe-Qe*ce}else I.x=c.x+$,I.y=c.y}d.layout.tree=function(){var c=d.layout.hierarchy().sort(null).value(null),E=U1,I=[1,1],$=null;function ce(Ke,wt){var Ct=c.call(this,Ke,wt),jt=Ct[0],er=fe(jt);if(ls(er,Ne),er.parent.m=-er.z,su(er,Le),$)su(jt,Qe);else{var Et=jt,Bt=jt,Vt=jt;su(jt,function(Lr){Lr.x<Et.x&&(Et=Lr),Lr.x>Bt.x&&(Bt=Lr),Lr.depth>Vt.depth&&(Vt=Lr)});var Kt=E(Et,Bt)/2-Et.x,$t=I[0]/(Bt.x+E(Bt,Et)/2+Kt),Gt=I[1]/(Vt.depth||1);su(jt,function(Lr){Lr.x=(Lr.x+Kt)*$t,Lr.y=Lr.depth*Gt})}return Ct}function fe(Ke){for(var wt={A:null,children:[Ke]},Ct=[wt],jt;(jt=Ct.pop())!=null;)for(var er=jt.children,Et,Bt=0,Vt=er.length;Bt<Vt;++Bt)Ct.push((er[Bt]=Et={_:er[Bt],parent:jt,children:(Et=er[Bt].children)&&Et.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:Bt}).a=Et);return wt.children[0]}function Ne(Ke){var wt=Ke.children,Ct=Ke.parent.children,jt=Ke.i?Ct[Ke.i-1]:null;if(wt.length){L3(Ke);var er=(wt[0].z+wt[wt.length-1].z)/2;jt?(Ke.z=jt.z+E(Ke._,jt._),Ke.m=Ke.z-er):Ke.z=er}else jt&&(Ke.z=jt.z+E(Ke._,jt._));Ke.parent.A=Be(Ke,jt,Ke.parent.A||Ct[0])}function Le(Ke){Ke._.x=Ke.z+Ke.parent.m,Ke.m+=Ke.parent.m}function Be(Ke,wt,Ct){if(wt){for(var jt=Ke,er=Ke,Et=wt,Bt=jt.parent.children[0],Vt=jt.m,Kt=er.m,$t=Et.m,Gt=Bt.m,Lr;Et=Of(Et),jt=Pf(jt),Et&&jt;)Bt=Pf(Bt),er=Of(er),er.a=Ke,Lr=Et.z+$t-jt.z-Vt+E(Et._,jt._),Lr>0&&(E3(R3(Et,Ke,Ct),Ke,Lr),Vt+=Lr,Kt+=Lr),$t+=Et.m,Vt+=jt.m,Gt+=Bt.m,Kt+=er.m;Et&&!Of(er)&&(er.t=Et,er.m+=$t-Kt),jt&&!Pf(Bt)&&(Bt.t=jt,Bt.m+=Vt-Gt,Ct=Ke)}return Ct}function Qe(Ke){Ke.x*=I[0],Ke.y=Ke.depth*I[1]}return ce.separation=function(Ke){return arguments.length?(E=Ke,ce):E},ce.size=function(Ke){return arguments.length?($=(I=Ke)==null?Qe:null,ce):$?null:I},ce.nodeSize=function(Ke){return arguments.length?($=(I=Ke)==null?null:Qe,ce):$?I:null},ou(ce,c)};function U1(c,E){return c.parent==E.parent?1:2}function Pf(c){var E=c.children;return E.length?E[0]:c.t}function Of(c){var E=c.children,I;return(I=E.length)?E[I-1]:c.t}function E3(c,E,I){var $=I/(E.i-c.i);E.c-=$,E.s+=I,c.c+=$,E.z+=I,E.m+=I}function L3(c){for(var E=0,I=0,$=c.children,ce=$.length,fe;--ce>=0;)fe=$[ce],fe.z+=E,fe.m+=E,E+=fe.s+(I+=fe.c)}function R3(c,E,I){return c.a.parent===E.parent?c.a:I}d.layout.cluster=function(){var c=d.layout.hierarchy().sort(null).value(null),E=U1,I=[1,1],$=!1;function ce(fe,Ne){var Le=c.call(this,fe,Ne),Be=Le[0],Qe,Ke=0;ls(Be,function(Et){var Bt=Et.children;Bt&&Bt.length?(Et.x=P3(Bt),Et.y=k3(Bt)):(Et.x=Qe?Ke+=E(Et,Qe):0,Et.y=0,Qe=Et)});var wt=B1(Be),Ct=H1(Be),jt=wt.x-E(wt,Ct)/2,er=Ct.x+E(Ct,wt)/2;return ls(Be,$?function(Et){Et.x=(Et.x-Be.x)*I[0],Et.y=(Be.y-Et.y)*I[1]}:function(Et){Et.x=(Et.x-jt)/(er-jt)*I[0],Et.y=(1-(Be.y?Et.y/Be.y:1))*I[1]}),Le}return ce.separation=function(fe){return arguments.length?(E=fe,ce):E},ce.size=function(fe){return arguments.length?($=(I=fe)==null,ce):$?null:I},ce.nodeSize=function(fe){return arguments.length?($=(I=fe)!=null,ce):$?I:null},ou(ce,c)};function k3(c){return 1+d.max(c,function(E){return E.y})}function P3(c){return c.reduce(function(E,I){return E+I.x},0)/c.length}function B1(c){var E=c.children;return E&&E.length?B1(E[0]):c}function H1(c){var E=c.children,I;return E&&(I=E.length)?H1(E[I-1]):c}d.layout.treemap=function(){var c=d.layout.hierarchy(),E=Math.round,I=[1,1],$=null,ce=Nf,fe=!1,Ne,Le="squarify",Be=.5*(1+Math.sqrt(5));function Qe(Et,Bt){for(var Vt=-1,Kt=Et.length,$t,Gt;++Vt<Kt;)Gt=($t=Et[Vt]).value*(Bt<0?0:Bt),$t.area=isNaN(Gt)||Gt<=0?0:Gt}function Ke(Et){var Bt=Et.children;if(Bt&&Bt.length){var Vt=ce(Et),Kt=[],$t=Bt.slice(),Gt,Lr=1/0,Xr,tn=Le==="slice"?Vt.dx:Le==="dice"?Vt.dy:Le==="slice-dice"?Et.depth&1?Vt.dy:Vt.dx:Math.min(Vt.dx,Vt.dy),Kr;for(Qe($t,Vt.dx*Vt.dy/Et.value),Kt.area=0;(Kr=$t.length)>0;)Kt.push(Gt=$t[Kr-1]),Kt.area+=Gt.area,Le!=="squarify"||(Xr=Ct(Kt,tn))<=Lr?($t.pop(),Lr=Xr):(Kt.area-=Kt.pop().area,jt(Kt,tn,Vt,!1),tn=Math.min(Vt.dx,Vt.dy),Kt.length=Kt.area=0,Lr=1/0);Kt.length&&(jt(Kt,tn,Vt,!0),Kt.length=Kt.area=0),Bt.forEach(Ke)}}function wt(Et){var Bt=Et.children;if(Bt&&Bt.length){var Vt=ce(Et),Kt=Bt.slice(),$t,Gt=[];for(Qe(Kt,Vt.dx*Vt.dy/Et.value),Gt.area=0;$t=Kt.pop();)Gt.push($t),Gt.area+=$t.area,$t.z!=null&&(jt(Gt,$t.z?Vt.dx:Vt.dy,Vt,!Kt.length),Gt.length=Gt.area=0);Bt.forEach(wt)}}function Ct(Et,Bt){for(var Vt=Et.area,Kt,$t=0,Gt=1/0,Lr=-1,Xr=Et.length;++Lr<Xr;)(Kt=Et[Lr].area)&&(Kt<Gt&&(Gt=Kt),Kt>$t&&($t=Kt));return Vt*=Vt,Bt*=Bt,Vt?Math.max(Bt*$t*Be/Vt,Vt/(Bt*Gt*Be)):1/0}function jt(Et,Bt,Vt,Kt){var $t=-1,Gt=Et.length,Lr=Vt.x,Xr=Vt.y,tn=Bt?E(Et.area/Bt):0,Kr;if(Bt==Vt.dx){for((Kt||tn>Vt.dy)&&(tn=Vt.dy);++$t<Gt;)Kr=Et[$t],Kr.x=Lr,Kr.y=Xr,Kr.dy=tn,Lr+=Kr.dx=Math.min(Vt.x+Vt.dx-Lr,tn?E(Kr.area/tn):0);Kr.z=!0,Kr.dx+=Vt.x+Vt.dx-Lr,Vt.y+=tn,Vt.dy-=tn}else{for((Kt||tn>Vt.dx)&&(tn=Vt.dx);++$t<Gt;)Kr=Et[$t],Kr.x=Lr,Kr.y=Xr,Kr.dx=tn,Xr+=Kr.dy=Math.min(Vt.y+Vt.dy-Xr,tn?E(Kr.area/tn):0);Kr.z=!1,Kr.dy+=Vt.y+Vt.dy-Xr,Vt.x+=tn,Vt.dx-=tn}}function er(Et){var Bt=Ne||c(Et),Vt=Bt[0];return Vt.x=Vt.y=0,Vt.value?(Vt.dx=I[0],Vt.dy=I[1]):Vt.dx=Vt.dy=0,Ne&&c.revalue(Vt),Qe([Vt],Vt.dx*Vt.dy/Vt.value),(Ne?wt:Ke)(Vt),fe&&(Ne=Bt),Bt}return er.size=function(Et){return arguments.length?(I=Et,er):I},er.padding=function(Et){if(!arguments.length)return $;function Bt($t){var Gt=Et.call(er,$t,$t.depth);return Gt==null?Nf($t):V1($t,typeof Gt=="number"?[Gt,Gt,Gt,Gt]:Gt)}function Vt($t){return V1($t,Et)}var Kt;return ce=($=Et)==null?Nf:(Kt=typeof Et)=="function"?Bt:(Kt==="number"&&(Et=[Et,Et,Et,Et]),Vt),er},er.round=function(Et){return arguments.length?(E=Et?Math.round:Number,er):E!=Number},er.sticky=function(Et){return arguments.length?(fe=Et,Ne=null,er):fe},er.ratio=function(Et){return arguments.length?(Be=Et,er):Be},er.mode=function(Et){return arguments.length?(Le=Et+"",er):Le},ou(er,c)};function Nf(c){return{x:c.x,y:c.y,dx:c.dx,dy:c.dy}}function V1(c,E){var I=c.x+E[3],$=c.y+E[0],ce=c.dx-E[1]-E[3],fe=c.dy-E[0]-E[2];return ce<0&&(I+=ce/2,ce=0),fe<0&&($+=fe/2,fe=0),{x:I,y:$,dx:ce,dy:fe}}d.random={normal:function(c,E){var I=arguments.length;return I<2&&(E=1),I<1&&(c=0),function(){var $,ce,fe;do $=Math.random()*2-1,ce=Math.random()*2-1,fe=$*$+ce*ce;while(!fe||fe>1);return c+E*$*Math.sqrt(-2*Math.log(fe)/fe)}},logNormal:function(){var c=d.random.normal.apply(d,arguments);return function(){return Math.exp(c())}},bates:function(c){var E=d.random.irwinHall(c);return function(){return E()/c}},irwinHall:function(c){return function(){for(var E=0,I=0;I<c;I++)E+=Math.random();return E}}},d.scale={};function xd(c){var E=c[0],I=c[c.length-1];return E<I?[E,I]:[I,E]}function _d(c){return c.rangeExtent?c.rangeExtent():xd(c.range())}function O3(c,E,I,$){var ce=I(c[0],c[1]),fe=$(E[0],E[1]);return function(Ne){return fe(ce(Ne))}}function Df(c,E){var I=0,$=c.length-1,ce=c[I],fe=c[$],Ne;return fe<ce&&(Ne=I,I=$,$=Ne,Ne=ce,ce=fe,fe=Ne),c[I]=E.floor(ce),c[$]=E.ceil(fe),c}function G1(c){return c?{floor:function(E){return Math.floor(E/c)*c},ceil:function(E){return Math.ceil(E/c)*c}}:N3}var N3={floor:ne,ceil:ne};function D3(c,E,I,$){var ce=[],fe=[],Ne=0,Le=Math.min(c.length,E.length)-1;for(c[Le]<c[0]&&(c=c.slice().reverse(),E=E.slice().reverse());++Ne<=Le;)ce.push(I(c[Ne-1],c[Ne])),fe.push($(E[Ne-1],E[Ne]));return function(Be){var Qe=d.bisect(c,Be,1,Le)-1;return fe[Qe](ce[Qe](Be))}}d.scale.linear=function(){return j1([0,1],[0,1],_l,!1)};function j1(c,E,I,$){var ce,fe;function Ne(){var Be=Math.min(c.length,E.length)>2?D3:O3,Qe=$?t3:e3;return ce=Be(c,E,Qe,I),fe=Be(E,c,Qe,_l),Le}function Le(Be){return ce(Be)}return Le.invert=function(Be){return fe(Be)},Le.domain=function(Be){return arguments.length?(c=Be.map(Number),Ne()):c},Le.range=function(Be){return arguments.length?(E=Be,Ne()):E},Le.rangeRound=function(Be){return Le.range(Be).interpolate(A1)},Le.clamp=function(Be){return arguments.length?($=Be,Ne()):$},Le.interpolate=function(Be){return arguments.length?(I=Be,Ne()):I},Le.ticks=function(Be){return zf(c,Be)},Le.tickFormat=function(Be,Qe){return d3_scale_linearTickFormat(c,Be,Qe)},Le.nice=function(Be){return Y1(c,Be),Ne()},Le.copy=function(){return j1(c,E,I,$)},Ne()}function W1(c,E){return d.rebind(c,E,"range","rangeRound","interpolate","clamp")}function Y1(c,E){return Df(c,G1(If(c,E)[2])),Df(c,G1(If(c,E)[2])),c}function If(c,E){E==null&&(E=10);var I=xd(c),$=I[1]-I[0],ce=Math.pow(10,Math.floor(Math.log($/E)/Math.LN10)),fe=E/$*ce;return fe<=.15?ce*=10:fe<=.35?ce*=5:fe<=.75&&(ce*=2),I[0]=Math.ceil(I[0]/ce)*ce,I[1]=Math.floor(I[1]/ce)*ce+ce*.5,I[2]=ce,I}function zf(c,E){return d.range.apply(d,If(c,E))}d.scale.log=function(){return q1(d.scale.linear().domain([0,1]),10,!0,[1,10])};function q1(c,E,I,$){function ce(Le){return(I?Math.log(Le<0?0:Le):-Math.log(Le>0?0:-Le))/Math.log(E)}function fe(Le){return I?Math.pow(E,Le):-Math.pow(E,-Le)}function Ne(Le){return c(ce(Le))}return Ne.invert=function(Le){return fe(c.invert(Le))},Ne.domain=function(Le){return arguments.length?(I=Le[0]>=0,c.domain(($=Le.map(Number)).map(ce)),Ne):$},Ne.base=function(Le){return arguments.length?(E=+Le,c.domain($.map(ce)),Ne):E},Ne.nice=function(){var Le=Df($.map(ce),I?Math:I3);return c.domain(Le),$=Le.map(fe),Ne},Ne.ticks=function(){var Le=xd($),Be=[],Qe=Le[0],Ke=Le[1],wt=Math.floor(ce(Qe)),Ct=Math.ceil(ce(Ke)),jt=E%1?2:E;if(isFinite(Ct-wt)){if(I){for(;wt<Ct;wt++)for(var er=1;er<jt;er++)Be.push(fe(wt)*er);Be.push(fe(wt))}else for(Be.push(fe(wt));wt++<Ct;)for(var er=jt-1;er>0;er--)Be.push(fe(wt)*er);for(wt=0;Be[wt]<Qe;wt++);for(Ct=Be.length;Be[Ct-1]>Ke;Ct--);Be=Be.slice(wt,Ct)}return Be},Ne.copy=function(){return q1(c.copy(),E,I,$)},W1(Ne,c)}var I3={floor:function(c){return-Math.ceil(-c)},ceil:function(c){return-Math.floor(-c)}};d.scale.pow=function(){return J1(d.scale.linear(),1,[0,1])};function J1(c,E,I){var $=bd(E),ce=bd(1/E);function fe(Ne){return c($(Ne))}return fe.invert=function(Ne){return ce(c.invert(Ne))},fe.domain=function(Ne){return arguments.length?(c.domain((I=Ne.map(Number)).map($)),fe):I},fe.ticks=function(Ne){return zf(I,Ne)},fe.tickFormat=function(Ne,Le){return d3_scale_linearTickFormat(I,Ne,Le)},fe.nice=function(Ne){return fe.domain(Y1(I,Ne))},fe.exponent=function(Ne){return arguments.length?($=bd(E=Ne),ce=bd(1/E),c.domain(I.map($)),fe):E},fe.copy=function(){return J1(c.copy(),E,I)},W1(fe,c)}function bd(c){return function(E){return E<0?-Math.pow(-E,c):Math.pow(E,c)}}d.scale.sqrt=function(){return d.scale.pow().exponent(.5)},d.scale.ordinal=function(){return X1([],{t:"range",a:[[]]})};function X1(c,E){var I,$,ce;function fe(Le){return $[((I.get(Le)||(E.t==="range"?I.set(Le,c.push(Le)):NaN))-1)%$.length]}function Ne(Le,Be){return d.range(c.length).map(function(Qe){return Le+Be*Qe})}return fe.domain=function(Le){if(!arguments.length)return c;c=[],I=new R;for(var Be=-1,Qe=Le.length,Ke;++Be<Qe;)I.has(Ke=Le[Be])||I.set(Ke,c.push(Ke));return fe[E.t].apply(fe,E.a)},fe.range=function(Le){return arguments.length?($=Le,ce=0,E={t:"range",a:arguments},fe):$},fe.rangePoints=function(Le,Be){arguments.length<2&&(Be=0);var Qe=Le[0],Ke=Le[1],wt=c.length<2?(Qe=(Qe+Ke)/2,0):(Ke-Qe)/(c.length-1+Be);return $=Ne(Qe+wt*Be/2,wt),ce=0,E={t:"rangePoints",a:arguments},fe},fe.rangeRoundPoints=function(Le,Be){arguments.length<2&&(Be=0);var Qe=Le[0],Ke=Le[1],wt=c.length<2?(Qe=Ke=Math.round((Qe+Ke)/2),0):(Ke-Qe)/(c.length-1+Be)|0;return $=Ne(Qe+Math.round(wt*Be/2+(Ke-Qe-(c.length-1+Be)*wt)/2),wt),ce=0,E={t:"rangeRoundPoints",a:arguments},fe},fe.rangeBands=function(Le,Be,Qe){arguments.length<2&&(Be=0),arguments.length<3&&(Qe=Be);var Ke=Le[1]<Le[0],wt=Le[Ke-0],Ct=Le[1-Ke],jt=(Ct-wt)/(c.length-Be+2*Qe);return $=Ne(wt+jt*Qe,jt),Ke&&$.reverse(),ce=jt*(1-Be),E={t:"rangeBands",a:arguments},fe},fe.rangeRoundBands=function(Le,Be,Qe){arguments.length<2&&(Be=0),arguments.length<3&&(Qe=Be);var Ke=Le[1]<Le[0],wt=Le[Ke-0],Ct=Le[1-Ke],jt=Math.floor((Ct-wt)/(c.length-Be+2*Qe));return $=Ne(wt+Math.round((Ct-wt-(c.length-Be)*jt)/2),jt),Ke&&$.reverse(),ce=Math.round(jt*(1-Be)),E={t:"rangeRoundBands",a:arguments},fe},fe.rangeBand=function(){return ce},fe.rangeExtent=function(){return xd(E.a[0])},fe.copy=function(){return X1(c,E)},fe.domain(c)}d.scale.category10=function(){return d.scale.ordinal().range(z3)},d.scale.category20=function(){return d.scale.ordinal().range(F3)},d.scale.category20b=function(){return d.scale.ordinal().range(U3)},d.scale.category20c=function(){return d.scale.ordinal().range(B3)};var z3=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(pe),F3=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(pe),U3=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(pe),B3=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(pe);d.scale.quantile=function(){return Z1([],[])};function Z1(c,E){var I;function $(){var fe=0,Ne=E.length;for(I=[];++fe<Ne;)I[fe-1]=d.quantile(c,fe/Ne);return ce}function ce(fe){if(!isNaN(fe=+fe))return E[d.bisect(I,fe)]}return ce.domain=function(fe){return arguments.length?(c=fe.map(L).filter(S).sort(b),$()):c},ce.range=function(fe){return arguments.length?(E=fe,$()):E},ce.quantiles=function(){return I},ce.invertExtent=function(fe){return fe=E.indexOf(fe),fe<0?[NaN,NaN]:[fe>0?I[fe-1]:c[0],fe<I.length?I[fe]:c[c.length-1]]},ce.copy=function(){return Z1(c,E)},$()}d.scale.quantize=function(){return Q1(0,1,[0,1])};function Q1(c,E,I){var $,ce;function fe(Le){return I[Math.max(0,Math.min(ce,Math.floor($*(Le-c))))]}function Ne(){return $=I.length/(E-c),ce=I.length-1,fe}return fe.domain=function(Le){return arguments.length?(c=+Le[0],E=+Le[Le.length-1],Ne()):[c,E]},fe.range=function(Le){return arguments.length?(I=Le,Ne()):I},fe.invertExtent=function(Le){return Le=I.indexOf(Le),Le=Le<0?NaN:Le/$+c,[Le,Le+1/$]},fe.copy=function(){return Q1(c,E,I)},Ne()}d.scale.threshold=function(){return K1([.5],[0,1])};function K1(c,E){function I($){if($<=$)return E[d.bisect(c,$)]}return I.domain=function($){return arguments.length?(c=$,I):c},I.range=function($){return arguments.length?(E=$,I):E},I.invertExtent=function($){return $=E.indexOf($),[c[$-1],c[$]]},I.copy=function(){return K1(c,E)},I}d.scale.identity=function(){return $1([0,1])};function $1(c){function E(I){return+I}return E.invert=E,E.domain=E.range=function(I){return arguments.length?(c=I.map(E),E):c},E.ticks=function(I){return zf(c,I)},E.tickFormat=function(I,$){return d3_scale_linearTickFormat(c,I,$)},E.copy=function(){return $1(c)},E}d.svg={};function H3(){return 0}d.svg.arc=function(){var c=V3,E=G3,I=H3,$=wd,ce=eg,fe=tg,Ne=j3;function Le(){var Qe=Math.max(0,+c.apply(this,arguments)),Ke=Math.max(0,+E.apply(this,arguments)),wt=ce.apply(this,arguments)-He,Ct=fe.apply(this,arguments)-He,jt=Math.abs(Ct-wt),er=wt>Ct?0:1;if(Ke<Qe&&(Et=Ke,Ke=Qe,Qe=Et),jt>=Ue)return Be(Ke,er)+(Qe?Be(Qe,1-er):"")+"Z";var Et,Bt,Vt,Kt,$t=0,Gt=0,Lr,Xr,tn,Kr,un,dn,Zn,yn,Bn=[];if((Kt=(+Ne.apply(this,arguments)||0)/2)&&(Vt=$===wd?Math.sqrt(Qe*Qe+Ke*Ke):+$.apply(this,arguments),er||(Gt*=-1),Ke&&(Gt=mt(Vt/Ke*Math.sin(Kt))),Qe&&($t=mt(Vt/Qe*Math.sin(Kt)))),Ke){Lr=Ke*Math.cos(wt+Gt),Xr=Ke*Math.sin(wt+Gt),tn=Ke*Math.cos(Ct-Gt),Kr=Ke*Math.sin(Ct-Gt);var Ca=Math.abs(Ct-wt-2*Gt)<=Me?0:1;if(Gt&&Md(Lr,Xr,tn,Kr)===er^Ca){var Ti=(wt+Ct)/2;Lr=Ke*Math.cos(Ti),Xr=Ke*Math.sin(Ti),tn=Kr=null}}else Lr=Xr=0;if(Qe){un=Qe*Math.cos(Ct-$t),dn=Qe*Math.sin(Ct-$t),Zn=Qe*Math.cos(wt+$t),yn=Qe*Math.sin(wt+$t);var Ba=Math.abs(wt-Ct+2*$t)<=Me?0:1;if($t&&Md(un,dn,Zn,yn)===1-er^Ba){var Yr=(wt+Ct)/2;un=Qe*Math.cos(Yr),dn=Qe*Math.sin(Yr),Zn=yn=null}}else un=dn=0;if(jt>Je&&(Et=Math.min(Math.abs(Ke-Qe)/2,+I.apply(this,arguments)))>.001){Bt=Qe<Ke^er?0:1;var Qn=Et,ia=Et;if(jt<Me){var Ea=Zn==null?[un,dn]:tn==null?[Lr,Xr]:In([Lr,Xr],[Zn,yn],[tn,Kr],[un,dn]),mi=Lr-Ea[0],Pi=Xr-Ea[1],Yi=tn-Ea[0],io=Kr-Ea[1],mo=1/Math.sin(Math.acos((mi*Yi+Pi*io)/(Math.sqrt(mi*mi+Pi*Pi)*Math.sqrt(Yi*Yi+io*io)))/2),oo=Math.sqrt(Ea[0]*Ea[0]+Ea[1]*Ea[1]);ia=Math.min(Et,(Qe-oo)/(mo-1)),Qn=Math.min(Et,(Ke-oo)/(mo+1))}if(tn!=null){var wo=Td(Zn==null?[un,dn]:[Zn,yn],[Lr,Xr],Ke,Qn,er),eo=Td([tn,Kr],[un,dn],Ke,Qn,er);Et===Qn?Bn.push("M",wo[0],"A",Qn,",",Qn," 0 0,",Bt," ",wo[1],"A",Ke,",",Ke," 0 ",1-er^Md(wo[1][0],wo[1][1],eo[1][0],eo[1][1]),",",er," ",eo[1],"A",Qn,",",Qn," 0 0,",Bt," ",eo[0]):Bn.push("M",wo[0],"A",Qn,",",Qn," 0 1,",Bt," ",eo[0])}else Bn.push("M",Lr,",",Xr);if(Zn!=null){var Mo=Td([Lr,Xr],[Zn,yn],Qe,-ia,er),wl=Td([un,dn],tn==null?[Lr,Xr]:[tn,Kr],Qe,-ia,er);Et===ia?Bn.push("L",wl[0],"A",ia,",",ia," 0 0,",Bt," ",wl[1],"A",Qe,",",Qe," 0 ",er^Md(wl[1][0],wl[1][1],Mo[1][0],Mo[1][1]),",",1-er," ",Mo[1],"A",ia,",",ia," 0 0,",Bt," ",Mo[0]):Bn.push("L",wl[0],"A",ia,",",ia," 0 0,",Bt," ",Mo[0])}else Bn.push("L",un,",",dn)}else Bn.push("M",Lr,",",Xr),tn!=null&&Bn.push("A",Ke,",",Ke," 0 ",Ca,",",er," ",tn,",",Kr),Bn.push("L",un,",",dn),Zn!=null&&Bn.push("A",Qe,",",Qe," 0 ",Ba,",",1-er," ",Zn,",",yn);return Bn.push("Z"),Bn.join("")}function Be(Qe,Ke){return"M0,"+Qe+"A"+Qe+","+Qe+" 0 1,"+Ke+" 0,"+-Qe+"A"+Qe+","+Qe+" 0 1,"+Ke+" 0,"+Qe}return Le.innerRadius=function(Qe){return arguments.length?(c=At(Qe),Le):c},Le.outerRadius=function(Qe){return arguments.length?(E=At(Qe),Le):E},Le.cornerRadius=function(Qe){return arguments.length?(I=At(Qe),Le):I},Le.padRadius=function(Qe){return arguments.length?($=Qe==wd?wd:At(Qe),Le):$},Le.startAngle=function(Qe){return arguments.length?(ce=At(Qe),Le):ce},Le.endAngle=function(Qe){return arguments.length?(fe=At(Qe),Le):fe},Le.padAngle=function(Qe){return arguments.length?(Ne=At(Qe),Le):Ne},Le.centroid=function(){var Qe=(+c.apply(this,arguments)+ +E.apply(this,arguments))/2,Ke=(+ce.apply(this,arguments)+ +fe.apply(this,arguments))/2-He;return[Math.cos(Ke)*Qe,Math.sin(Ke)*Qe]},Le};var wd="auto";function V3(c){return c.innerRadius}function G3(c){return c.outerRadius}function eg(c){return c.startAngle}function tg(c){return c.endAngle}function j3(c){return c&&c.padAngle}function Md(c,E,I,$){return(c-I)*E-(E-$)*c>0?0:1}function Td(c,E,I,$,ce){var fe=c[0]-E[0],Ne=c[1]-E[1],Le=(ce?$:-$)/Math.sqrt(fe*fe+Ne*Ne),Be=Le*Ne,Qe=-Le*fe,Ke=c[0]+Be,wt=c[1]+Qe,Ct=E[0]+Be,jt=E[1]+Qe,er=(Ke+Ct)/2,Et=(wt+jt)/2,Bt=Ct-Ke,Vt=jt-wt,Kt=Bt*Bt+Vt*Vt,$t=I-$,Gt=Ke*jt-Ct*wt,Lr=(Vt<0?-1:1)*Math.sqrt(Math.max(0,$t*$t*Kt-Gt*Gt)),Xr=(Gt*Vt-Bt*Lr)/Kt,tn=(-Gt*Bt-Vt*Lr)/Kt,Kr=(Gt*Vt+Bt*Lr)/Kt,un=(-Gt*Bt+Vt*Lr)/Kt,dn=Xr-er,Zn=tn-Et,yn=Kr-er,Bn=un-Et;return dn*dn+Zn*Zn>yn*yn+Bn*Bn&&(Xr=Kr,tn=un),[[Xr-Be,tn-Qe],[Xr*I/$t,tn*I/$t]]}function rg(){return!0}function ng(c){var E=sa,I=Fa,$=rg,ce=jo,fe=ce.key,Ne=.7;function Le(Be){var Qe=[],Ke=[],wt=-1,Ct=Be.length,jt,er=At(E),Et=At(I);function Bt(){Qe.push("M",ce(c(Ke),Ne))}for(;++wt<Ct;)$.call(this,jt=Be[wt],wt)?Ke.push([+er.call(this,jt,wt),+Et.call(this,jt,wt)]):Ke.length&&(Bt(),Ke=[]);return Ke.length&&Bt(),Qe.length?Qe.join(""):null}return Le.x=function(Be){return arguments.length?(E=Be,Le):E},Le.y=function(Be){return arguments.length?(I=Be,Le):I},Le.defined=function(Be){return arguments.length?($=Be,Le):$},Le.interpolate=function(Be){return arguments.length?(typeof Be=="function"?fe=ce=Be:fe=(ce=Ff.get(Be)||jo).key,Le):fe},Le.tension=function(Be){return arguments.length?(Ne=Be,Le):Ne},Le}d.svg.line=function(){return ng(ne)};var Ff=d.map({linear:jo,"linear-closed":ag,step:W3,"step-before":Uf,"step-after":Bf,basis:ig,"basis-open":X3,"basis-closed":Z3,bundle:Q3,cardinal:J3,"cardinal-open":Y3,"cardinal-closed":q3,monotone:e5});Ff.forEach(function(c,E){E.key=c,E.closed=/-closed$/.test(c)});function jo(c){return c.length>1?c.join("L"):c+"Z"}function ag(c){return c.join("L")+"Z"}function W3(c){for(var E=0,I=c.length,$=c[0],ce=[$[0],",",$[1]];++E<I;)ce.push("H",($[0]+($=c[E])[0])/2,"V",$[1]);return I>1&&ce.push("H",$[0]),ce.join("")}function Uf(c){for(var E=0,I=c.length,$=c[0],ce=[$[0],",",$[1]];++E<I;)ce.push("V",($=c[E])[1],"H",$[0]);return ce.join("")}function Bf(c){for(var E=0,I=c.length,$=c[0],ce=[$[0],",",$[1]];++E<I;)ce.push("H",($=c[E])[0],"V",$[1]);return ce.join("")}function Y3(c,E){return c.length<4?jo(c):c[1]+Ad(c.slice(1,-1),Hf(c,E))}function q3(c,E){return c.length<3?ag(c):c[0]+Ad((c.push(c[0]),c),Hf([c[c.length-2]].concat(c,[c[1]]),E))}function J3(c,E){return c.length<3?jo(c):c[0]+Ad(c,Hf(c,E))}function Ad(c,E){if(E.length<1||c.length!=E.length&&c.length!=E.length+2)return jo(c);var I=c.length!=E.length,$="",ce=c[0],fe=c[1],Ne=E[0],Le=Ne,Be=1;if(I&&($+="Q"+(fe[0]-Ne[0]*2/3)+","+(fe[1]-Ne[1]*2/3)+","+fe[0]+","+fe[1],ce=c[1],Be=2),E.length>1){Le=E[1],fe=c[Be],Be++,$+="C"+(ce[0]+Ne[0])+","+(ce[1]+Ne[1])+","+(fe[0]-Le[0])+","+(fe[1]-Le[1])+","+fe[0]+","+fe[1];for(var Qe=2;Qe<E.length;Qe++,Be++)fe=c[Be],Le=E[Qe],$+="S"+(fe[0]-Le[0])+","+(fe[1]-Le[1])+","+fe[0]+","+fe[1]}if(I){var Ke=c[Be];$+="Q"+(fe[0]+Le[0]*2/3)+","+(fe[1]+Le[1]*2/3)+","+Ke[0]+","+Ke[1]}return $}function Hf(c,E){for(var I=[],$=(1-E)/2,ce,fe=c[0],Ne=c[1],Le=1,Be=c.length;++Le<Be;)ce=fe,fe=Ne,Ne=c[Le],I.push([$*(Ne[0]-ce[0]),$*(Ne[1]-ce[1])]);return I}function ig(c){if(c.length<3)return jo(c);var E=1,I=c.length,$=c[0],ce=$[0],fe=$[1],Ne=[ce,ce,ce,($=c[1])[0]],Le=[fe,fe,fe,$[1]],Be=[ce,",",fe,"L",Do(js,Ne),",",Do(js,Le)];for(c.push(c[I-1]);++E<=I;)$=c[E],Ne.shift(),Ne.push($[0]),Le.shift(),Le.push($[1]),Vf(Be,Ne,Le);return c.pop(),Be.push("L",$),Be.join("")}function X3(c){if(c.length<4)return jo(c);for(var E=[],I=-1,$=c.length,ce,fe=[0],Ne=[0];++I<3;)ce=c[I],fe.push(ce[0]),Ne.push(ce[1]);for(E.push(Do(js,fe)+","+Do(js,Ne)),--I;++I<$;)ce=c[I],fe.shift(),fe.push(ce[0]),Ne.shift(),Ne.push(ce[1]),Vf(E,fe,Ne);return E.join("")}function Z3(c){for(var E,I=-1,$=c.length,ce=$+4,fe,Ne=[],Le=[];++I<4;)fe=c[I%$],Ne.push(fe[0]),Le.push(fe[1]);for(E=[Do(js,Ne),",",Do(js,Le)],--I;++I<ce;)fe=c[I%$],Ne.shift(),Ne.push(fe[0]),Le.shift(),Le.push(fe[1]),Vf(E,Ne,Le);return E.join("")}function Q3(c,E){var I=c.length-1;if(I)for(var $=c[0][0],ce=c[0][1],fe=c[I][0]-$,Ne=c[I][1]-ce,Le=-1,Be,Qe;++Le<=I;)Be=c[Le],Qe=Le/I,Be[0]=E*Be[0]+(1-E)*($+Qe*fe),Be[1]=E*Be[1]+(1-E)*(ce+Qe*Ne);return ig(c)}function Do(c,E){return c[0]*E[0]+c[1]*E[1]+c[2]*E[2]+c[3]*E[3]}var og=[0,2/3,1/3,0],sg=[0,1/3,2/3,0],js=[0,1/6,2/3,1/6];function Vf(c,E,I){c.push("C",Do(og,E),",",Do(og,I),",",Do(sg,E),",",Do(sg,I),",",Do(js,E),",",Do(js,I))}function Gf(c,E){return(E[1]-c[1])/(E[0]-c[0])}function K3(c){for(var E=0,I=c.length-1,$=[],ce=c[0],fe=c[1],Ne=$[0]=Gf(ce,fe);++E<I;)$[E]=(Ne+(Ne=Gf(ce=fe,fe=c[E+1])))/2;return $[E]=Ne,$}function $3(c){for(var E=[],I,$,ce,fe,Ne=K3(c),Le=-1,Be=c.length-1;++Le<Be;)I=Gf(c[Le],c[Le+1]),m(I)<Je?Ne[Le]=Ne[Le+1]=0:($=Ne[Le]/I,ce=Ne[Le+1]/I,fe=$*$+ce*ce,fe>9&&(fe=I*3/Math.sqrt(fe),Ne[Le]=fe*$,Ne[Le+1]=fe*ce));for(Le=-1;++Le<=Be;)fe=(c[Math.min(Be,Le+1)][0]-c[Math.max(0,Le-1)][0])/(6*(1+Ne[Le]*Ne[Le])),E.push([fe||0,Ne[Le]*fe||0]);return E}function e5(c){return c.length<3?jo(c):c[0]+Ad(c,$3(c))}d.svg.line.radial=function(){var c=ng(lg);return c.radius=c.x,delete c.x,c.angle=c.y,delete c.y,c};function lg(c){for(var E,I=-1,$=c.length,ce,fe;++I<$;)E=c[I],ce=E[0],fe=E[1]-He,E[0]=ce*Math.cos(fe),E[1]=ce*Math.sin(fe);return c}function cg(c){var E=sa,I=sa,$=0,ce=Fa,fe=rg,Ne=jo,Le=Ne.key,Be=Ne,Qe="L",Ke=.7;function wt(Ct){var jt=[],er=[],Et=[],Bt=-1,Vt=Ct.length,Kt,$t=At(E),Gt=At($),Lr=E===I?function(){return tn}:At(I),Xr=$===ce?function(){return Kr}:At(ce),tn,Kr;function un(){jt.push("M",Ne(c(Et),Ke),Qe,Be(c(er.reverse()),Ke),"Z")}for(;++Bt<Vt;)fe.call(this,Kt=Ct[Bt],Bt)?(er.push([tn=+$t.call(this,Kt,Bt),Kr=+Gt.call(this,Kt,Bt)]),Et.push([+Lr.call(this,Kt,Bt),+Xr.call(this,Kt,Bt)])):er.length&&(un(),er=[],Et=[]);return er.length&&un(),jt.length?jt.join(""):null}return wt.x=function(Ct){return arguments.length?(E=I=Ct,wt):I},wt.x0=function(Ct){return arguments.length?(E=Ct,wt):E},wt.x1=function(Ct){return arguments.length?(I=Ct,wt):I},wt.y=function(Ct){return arguments.length?($=ce=Ct,wt):ce},wt.y0=function(Ct){return arguments.length?($=Ct,wt):$},wt.y1=function(Ct){return arguments.length?(ce=Ct,wt):ce},wt.defined=function(Ct){return arguments.length?(fe=Ct,wt):fe},wt.interpolate=function(Ct){return arguments.length?(typeof Ct=="function"?Le=Ne=Ct:Le=(Ne=Ff.get(Ct)||jo).key,Be=Ne.reverse||Ne,Qe=Ne.closed?"M":"L",wt):Le},wt.tension=function(Ct){return arguments.length?(Ke=Ct,wt):Ke},wt}Uf.reverse=Bf,Bf.reverse=Uf,d.svg.area=function(){return cg(ne)},d.svg.area.radial=function(){var c=cg(lg);return c.radius=c.x,delete c.x,c.innerRadius=c.x0,delete c.x0,c.outerRadius=c.x1,delete c.x1,c.angle=c.y,delete c.y,c.startAngle=c.y0,delete c.y0,c.endAngle=c.y1,delete c.y1,c};function ug(c){return c.source}function dg(c){return c.target}d.svg.chord=function(){var c=ug,E=dg,I=t5,$=eg,ce=tg;function fe(Ke,wt){var Ct=Ne(this,c,Ke,wt),jt=Ne(this,E,Ke,wt);return"M"+Ct.p0+Be(Ct.r,Ct.p1,Ct.a1-Ct.a0)+(Le(Ct,jt)?Qe(Ct.r,Ct.p1,Ct.r,Ct.p0):Qe(Ct.r,Ct.p1,jt.r,jt.p0)+Be(jt.r,jt.p1,jt.a1-jt.a0)+Qe(jt.r,jt.p1,Ct.r,Ct.p0))+"Z"}function Ne(Ke,wt,Ct,jt){var er=wt.call(Ke,Ct,jt),Et=I.call(Ke,er,jt),Bt=$.call(Ke,er,jt)-He,Vt=ce.call(Ke,er,jt)-He;return{r:Et,a0:Bt,a1:Vt,p0:[Et*Math.cos(Bt),Et*Math.sin(Bt)],p1:[Et*Math.cos(Vt),Et*Math.sin(Vt)]}}function Le(Ke,wt){return Ke.a0==wt.a0&&Ke.a1==wt.a1}function Be(Ke,wt,Ct){return"A"+Ke+","+Ke+" 0 "+ +(Ct>Me)+",1 "+wt}function Qe(Ke,wt,Ct,jt){return"Q 0,0 "+jt}return fe.radius=function(Ke){return arguments.length?(I=At(Ke),fe):I},fe.source=function(Ke){return arguments.length?(c=At(Ke),fe):c},fe.target=function(Ke){return arguments.length?(E=At(Ke),fe):E},fe.startAngle=function(Ke){return arguments.length?($=At(Ke),fe):$},fe.endAngle=function(Ke){return arguments.length?(ce=At(Ke),fe):ce},fe};function t5(c){return c.radius}d.svg.diagonal=function(){var c=ug,E=dg,I=hg;function $(ce,fe){var Ne=c.call(this,ce,fe),Le=E.call(this,ce,fe),Be=(Ne.y+Le.y)/2,Qe=[Ne,{x:Ne.x,y:Be},{x:Le.x,y:Be},Le];return Qe=Qe.map(I),"M"+Qe[0]+"C"+Qe[1]+" "+Qe[2]+" "+Qe[3]}return $.source=function(ce){return arguments.length?(c=At(ce),$):c},$.target=function(ce){return arguments.length?(E=At(ce),$):E},$.projection=function(ce){return arguments.length?(I=ce,$):I},$};function hg(c){return[c.x,c.y]}d.svg.diagonal.radial=function(){var c=d.svg.diagonal(),E=hg,I=c.projection;return c.projection=function($){return arguments.length?I(r5(E=$)):E},c};function r5(c){return function(){var E=c.apply(this,arguments),I=E[0],$=E[1]-He;return[I*Math.cos($),I*Math.sin($)]}}d.svg.symbol=function(){var c=a5,E=n5;function I($,ce){return(pg.get(c.call(this,$,ce))||fg)(E.call(this,$,ce))}return I.type=function($){return arguments.length?(c=At($),I):c},I.size=function($){return arguments.length?(E=At($),I):E},I};function n5(){return 64}function a5(){return"circle"}function fg(c){var E=Math.sqrt(c/Me);return"M0,"+E+"A"+E+","+E+" 0 1,1 0,"+-E+"A"+E+","+E+" 0 1,1 0,"+E+"Z"}var pg=d.map({circle:fg,cross:function(c){var E=Math.sqrt(c/5)/2;return"M"+-3*E+","+-E+"H"+-E+"V"+-3*E+"H"+E+"V"+-E+"H"+3*E+"V"+E+"H"+E+"V"+3*E+"H"+-E+"V"+E+"H"+-3*E+"Z"},diamond:function(c){var E=Math.sqrt(c/(2*mg)),I=E*mg;return"M0,"+-E+"L"+I+",0 0,"+E+" "+-I+",0Z"},square:function(c){var E=Math.sqrt(c)/2;return"M"+-E+","+-E+"L"+E+","+-E+" "+E+","+E+" "+-E+","+E+"Z"},"triangle-down":function(c){var E=Math.sqrt(c/Sd),I=E*Sd/2;return"M0,"+I+"L"+E+","+-I+" "+-E+","+-I+"Z"},"triangle-up":function(c){var E=Math.sqrt(c/Sd),I=E*Sd/2;return"M0,"+-I+"L"+E+","+I+" "+-E+","+I+"Z"}});d.svg.symbolTypes=pg.keys();var Sd=Math.sqrt(3),mg=Math.tan(30*et);j.transition=function(c){for(var E=bl||++vg,I=Wf(c),$=[],ce,fe,Ne=Ed||{time:Date.now(),ease:zb,delay:0,duration:250},Le=-1,Be=this.length;++Le<Be;){$.push(ce=[]);for(var Qe=this[Le],Ke=-1,wt=Qe.length;++Ke<wt;)(fe=Qe[Ke])&&Ld(fe,Ke,I,E,Ne),ce.push(fe)}return lu($,I,E)},j.interrupt=function(c){return this.each(c==null?Cd:gg(Wf(c)))};var Cd=gg(Wf());function gg(c){return function(){var E,I,$;(E=this[c])&&($=E[I=E.active])&&($.timer.c=null,$.timer.t=NaN,--E.count?delete E[I]:delete this[c],E.active+=.5,$.event&&$.event.interrupt.call(this,this.__data__,$.index))}}function lu(c,E,I){return Q(c,ki),c.namespace=E,c.id=I,c}var ki=[],vg=0,bl,Ed;ki.call=j.call,ki.empty=j.empty,ki.node=j.node,ki.size=j.size,d.transition=function(c,E){return c&&c.transition?bl?c.transition(E):c:d.selection().transition(c)},d.transition.prototype=ki,ki.select=function(c){var E=this.id,I=this.namespace,$=[],ce,fe,Ne;c=k(c);for(var Le=-1,Be=this.length;++Le<Be;){$.push(ce=[]);for(var Qe=this[Le],Ke=-1,wt=Qe.length;++Ke<wt;)(Ne=Qe[Ke])&&(fe=c.call(Ne,Ne.__data__,Ke,Le))?("__data__"in Ne&&(fe.__data__=Ne.__data__),Ld(fe,Ke,I,E,Ne[I][E]),ce.push(fe)):ce.push(null)}return lu($,I,E)},ki.selectAll=function(c){var E=this.id,I=this.namespace,$=[],ce,fe,Ne,Le,Be;c=F(c);for(var Qe=-1,Ke=this.length;++Qe<Ke;)for(var wt=this[Qe],Ct=-1,jt=wt.length;++Ct<jt;)if(Ne=wt[Ct]){Be=Ne[I][E],fe=c.call(Ne,Ne.__data__,Ct,Qe),$.push(ce=[]);for(var er=-1,Et=fe.length;++er<Et;)(Le=fe[er])&&Ld(Le,er,I,E,Be),ce.push(Le)}return lu($,I,E)},ki.filter=function(c){var E=[],I,$,ce;typeof c!="function"&&(c=we(c));for(var fe=0,Ne=this.length;fe<Ne;fe++){E.push(I=[]);for(var $=this[fe],Le=0,Be=$.length;Le<Be;Le++)(ce=$[Le])&&c.call(ce,ce.__data__,Le,fe)&&I.push(ce)}return lu(E,this.namespace,this.id)},ki.tween=function(c,E){var I=this.id,$=this.namespace;return arguments.length<2?this.node()[$][I].tween.get(c):ot(this,E==null?function(ce){ce[$][I].tween.remove(c)}:function(ce){ce[$][I].tween.set(c,E)})};function jf(c,E,I,$){var ce=c.id,fe=c.namespace;return ot(c,typeof I=="function"?function(Ne,Le,Be){Ne[fe][ce].tween.set(E,$(I.call(Ne,Ne.__data__,Le,Be)))}:(I=$(I),function(Ne){Ne[fe][ce].tween.set(E,I)}))}ki.attr=function(c,E){if(arguments.length<2){for(E in c)this.attr(E,c[E]);return this}var I=c=="transform"?L1:_l,$=d.ns.qualify(c);function ce(){this.removeAttribute($)}function fe(){this.removeAttributeNS($.space,$.local)}function Ne(Be){return Be==null?ce:(Be+="",function(){var Qe=this.getAttribute($),Ke;return Qe!==Be&&(Ke=I(Qe,Be),function(wt){this.setAttribute($,Ke(wt))})})}function Le(Be){return Be==null?fe:(Be+="",function(){var Qe=this.getAttributeNS($.space,$.local),Ke;return Qe!==Be&&(Ke=I(Qe,Be),function(wt){this.setAttributeNS($.space,$.local,Ke(wt))})})}return jf(this,"attr."+c,E,$.local?Le:Ne)},ki.attrTween=function(c,E){var I=d.ns.qualify(c);function $(fe,Ne){var Le=E.call(this,fe,Ne,this.getAttribute(I));return Le&&function(Be){this.setAttribute(I,Le(Be))}}function ce(fe,Ne){var Le=E.call(this,fe,Ne,this.getAttributeNS(I.space,I.local));return Le&&function(Be){this.setAttributeNS(I.space,I.local,Le(Be))}}return this.tween("attr."+c,I.local?ce:$)},ki.style=function(c,E,I){var $=arguments.length;if($<3){if(typeof c!="string"){$<2&&(E="");for(I in c)this.style(I,c[I],E);return this}I=""}function ce(){this.style.removeProperty(c)}function fe(Ne){return Ne==null?ce:(Ne+="",function(){var Le=h(this).getComputedStyle(this,null).getPropertyValue(c),Be;return Le!==Ne&&(Be=_l(Le,Ne),function(Qe){this.style.setProperty(c,Be(Qe),I)})})}return jf(this,"style."+c,E,fe)},ki.styleTween=function(c,E,I){arguments.length<3&&(I="");function $(ce,fe){var Ne=E.call(this,ce,fe,h(this).getComputedStyle(this,null).getPropertyValue(c));return Ne&&function(Le){this.style.setProperty(c,Ne(Le),I)}}return this.tween("style."+c,$)},ki.text=function(c){return jf(this,"text",c,i5)};function i5(c){return c==null&&(c=""),function(){this.textContent=c}}ki.remove=function(){var c=this.namespace;return this.each("end.transition",function(){var E;this[c].count<2&&(E=this.parentNode)&&E.removeChild(this)})},ki.ease=function(c){var E=this.id,I=this.namespace;return arguments.length<1?this.node()[I][E].ease:(typeof c!="function"&&(c=d.ease.apply(d,arguments)),ot(this,function($){$[I][E].ease=c}))},ki.delay=function(c){var E=this.id,I=this.namespace;return arguments.length<1?this.node()[I][E].delay:ot(this,typeof c=="function"?function($,ce,fe){$[I][E].delay=+c.call($,$.__data__,ce,fe)}:(c=+c,function($){$[I][E].delay=c}))},ki.duration=function(c){var E=this.id,I=this.namespace;return arguments.length<1?this.node()[I][E].duration:ot(this,typeof c=="function"?function($,ce,fe){$[I][E].duration=Math.max(1,c.call($,$.__data__,ce,fe))}:(c=Math.max(1,c),function($){$[I][E].duration=c}))},ki.each=function(c,E){var I=this.id,$=this.namespace;if(arguments.length<2){var ce=Ed,fe=bl;try{bl=I,ot(this,function(Ne,Le,Be){Ed=Ne[$][I],c.call(Ne,Ne.__data__,Le,Be)})}finally{Ed=ce,bl=fe}}else ot(this,function(Ne){var Le=Ne[$][I];(Le.event||(Le.event=d.dispatch("start","end","interrupt"))).on(c,E)});return this},ki.transition=function(){for(var c=this.id,E=++vg,I=this.namespace,$=[],ce,fe,Ne,Le,Be=0,Qe=this.length;Be<Qe;Be++){$.push(ce=[]);for(var fe=this[Be],Ke=0,wt=fe.length;Ke<wt;Ke++)(Ne=fe[Ke])&&(Le=Ne[I][c],Ld(Ne,Ke,I,E,{time:Le.time,ease:Le.ease,delay:Le.delay+Le.duration,duration:Le.duration})),ce.push(Ne)}return lu($,I,E)};function Wf(c){return c==null?"__transition__":"__transition_"+c+"__"}function Ld(c,E,I,$,ce){var fe=c[I]||(c[I]={active:0,count:0}),Ne=fe[$],Le,Be,Qe,Ke,wt;function Ct(Et){var Bt=Ne.delay;if(Be.t=Bt+Le,Bt<=Et)return jt(Et-Bt);Be.c=jt}function jt(Et){var Bt=fe.active,Vt=fe[Bt];Vt&&(Vt.timer.c=null,Vt.timer.t=NaN,--fe.count,delete fe[Bt],Vt.event&&Vt.event.interrupt.call(c,c.__data__,Vt.index));for(var Kt in fe)if(+Kt<$){var $t=fe[Kt];$t.timer.c=null,$t.timer.t=NaN,--fe.count,delete fe[Kt]}Be.c=er,on(function(){return Be.c&&er(Et||1)&&(Be.c=null,Be.t=NaN),1},0,Le),fe.active=$,Ne.event&&Ne.event.start.call(c,c.__data__,E),wt=[],Ne.tween.forEach(function(Gt,Lr){(Lr=Lr.call(c,c.__data__,E))&&wt.push(Lr)}),Ke=Ne.ease,Qe=Ne.duration}function er(Et){for(var Bt=Et/Qe,Vt=Ke(Bt),Kt=wt.length;Kt>0;)wt[--Kt].call(c,Vt);if(Bt>=1)return Ne.event&&Ne.event.end.call(c,c.__data__,E),--fe.count?delete fe[$]:delete c[I],1}Ne||(Le=ce.time,Be=on(Ct,0,Le),Ne=fe[$]={tween:new R,time:Le,timer:Be,delay:ce.delay,duration:ce.duration,ease:ce.ease,index:E},ce=null,++fe.count)}d.svg.axis=function(){var c=d.scale.linear(),E=yg,I=6,$=6,ce=3,fe=[10],Ne=null,Le;function Be(Qe){Qe.each(function(){var Ke=d.select(this),wt=this.__chart__||c,Ct=this.__chart__=c.copy(),jt=Ne??(Ct.ticks?Ct.ticks.apply(Ct,fe):Ct.domain()),er=Le??(Ct.tickFormat?Ct.tickFormat.apply(Ct,fe):ne),Et=Ke.selectAll(".tick").data(jt,Ct),Bt=Et.enter().insert("g",".domain").attr("class","tick").style("opacity",Je),Vt=d.transition(Et.exit()).style("opacity",Je).remove(),Kt=d.transition(Et.order()).style("opacity",1),$t=Math.max(I,0)+ce,Gt,Lr=_d(Ct),Xr=Ke.selectAll(".domain").data([0]),tn=(Xr.enter().append("path").attr("class","domain"),d.transition(Xr));Bt.append("line"),Bt.append("text");var Kr=Bt.select("line"),un=Kt.select("line"),dn=Et.select("text").text(er),Zn=Bt.select("text"),yn=Kt.select("text"),Bn=E==="top"||E==="left"?-1:1,Ca,Ti,Ba,Yr;if(E==="bottom"||E==="top"?(Gt=s5,Ca="x",Ba="y",Ti="x2",Yr="y2",dn.attr("dy",Bn<0?"0em":".71em").style("text-anchor","middle"),tn.attr("d","M"+Lr[0]+","+Bn*$+"V0H"+Lr[1]+"V"+Bn*$)):(Gt=l5,Ca="y",Ba="x",Ti="y2",Yr="x2",dn.attr("dy",".32em").style("text-anchor",Bn<0?"end":"start"),tn.attr("d","M"+Bn*$+","+Lr[0]+"H0V"+Lr[1]+"H"+Bn*$)),Kr.attr(Yr,Bn*I),Zn.attr(Ba,Bn*$t),un.attr(Ti,0).attr(Yr,Bn*I),yn.attr(Ca,0).attr(Ba,Bn*$t),Ct.rangeBand){var Qn=Ct,ia=Qn.rangeBand()/2;wt=Ct=function(Ea){return Qn(Ea)+ia}}else wt.rangeBand?wt=Ct:Vt.call(Gt,Ct,wt);Bt.call(Gt,wt,Ct),Kt.call(Gt,Ct,Ct)})}return Be.scale=function(Qe){return arguments.length?(c=Qe,Be):c},Be.orient=function(Qe){return arguments.length?(E=Qe in o5?Qe+"":yg,Be):E},Be.ticks=function(){return arguments.length?(fe=s(arguments),Be):fe},Be.tickValues=function(Qe){return arguments.length?(Ne=Qe,Be):Ne},Be.tickFormat=function(Qe){return arguments.length?(Le=Qe,Be):Le},Be.tickSize=function(Qe){var Ke=arguments.length;return Ke?(I=+Qe,$=+arguments[Ke-1],Be):I},Be.innerTickSize=function(Qe){return arguments.length?(I=+Qe,Be):I},Be.outerTickSize=function(Qe){return arguments.length?($=+Qe,Be):$},Be.tickPadding=function(Qe){return arguments.length?(ce=+Qe,Be):ce},Be.tickSubdivide=function(){return arguments.length&&Be},Be};var yg="bottom",o5={top:1,right:1,bottom:1,left:1};function s5(c,E,I){c.attr("transform",function($){var ce=E($);return"translate("+(isFinite(ce)?ce:I($))+",0)"})}function l5(c,E,I){c.attr("transform",function($){var ce=E($);return"translate(0,"+(isFinite(ce)?ce:I($))+")"})}d.svg.brush=function(){var c=ke(Ke,"brushstart","brush","brushend"),E=null,I=null,$=[0,0],ce=[0,0],fe,Ne,Le=!0,Be=!0,Qe=Yf[0];function Ke(Et){Et.each(function(){var Bt=d.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",er).on("touchstart.brush",er),Vt=Bt.selectAll(".background").data([0]);Vt.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),Bt.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var Kt=Bt.selectAll(".resize").data(Qe,ne);Kt.exit().remove(),Kt.enter().append("g").attr("class",function(Xr){return"resize "+Xr}).style("cursor",function(Xr){return c5[Xr]}).append("rect").attr("x",function(Xr){return/[ew]$/.test(Xr)?-3:null}).attr("y",function(Xr){return/^[ns]/.test(Xr)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),Kt.style("display",Ke.empty()?"none":null);var $t=d.transition(Bt),Gt=d.transition(Vt),Lr;E&&(Lr=_d(E),Gt.attr("x",Lr[0]).attr("width",Lr[1]-Lr[0]),Ct($t)),I&&(Lr=_d(I),Gt.attr("y",Lr[0]).attr("height",Lr[1]-Lr[0]),jt($t)),wt($t)})}Ke.event=function(Et){Et.each(function(){var Bt=c.of(this,arguments),Vt={x:$,y:ce,i:fe,j:Ne},Kt=this.__chart__||Vt;this.__chart__=Vt,bl?d.select(this).transition().each("start.brush",function(){fe=Kt.i,Ne=Kt.j,$=Kt.x,ce=Kt.y,Bt({type:"brushstart"})}).tween("brush:brush",function(){var $t=yd($,Vt.x),Gt=yd(ce,Vt.y);return fe=Ne=null,function(Lr){$=Vt.x=$t(Lr),ce=Vt.y=Gt(Lr),Bt({type:"brush",mode:"resize"})}}).each("end.brush",function(){fe=Vt.i,Ne=Vt.j,Bt({type:"brush",mode:"resize"}),Bt({type:"brushend"})}):(Bt({type:"brushstart"}),Bt({type:"brush",mode:"resize"}),Bt({type:"brushend"}))})};function wt(Et){Et.selectAll(".resize").attr("transform",function(Bt){return"translate("+$[+/e$/.test(Bt)]+","+ce[+/^s/.test(Bt)]+")"})}function Ct(Et){Et.select(".extent").attr("x",$[0]),Et.selectAll(".extent,.n>rect,.s>rect").attr("width",$[1]-$[0])}function jt(Et){Et.select(".extent").attr("y",ce[0]),Et.selectAll(".extent,.e>rect,.w>rect").attr("height",ce[1]-ce[0])}function er(){var Et=this,Bt=d.select(d.event.target),Vt=c.of(Et,arguments),Kt=d.select(Et),$t=Bt.datum(),Gt=!/^(n|s)$/.test($t)&&E,Lr=!/^(e|w)$/.test($t)&&I,Xr=Bt.classed("extent"),tn=rr(Et),Kr,un=d.mouse(Et),dn,Zn=d.select(h(Et)).on("keydown.brush",Ca).on("keyup.brush",Ti);if(d.event.changedTouches?Zn.on("touchmove.brush",Ba).on("touchend.brush",Qn):Zn.on("mousemove.brush",Ba).on("mouseup.brush",Qn),Kt.interrupt().selectAll("*").interrupt(),Xr)un[0]=$[0]-un[0],un[1]=ce[0]-un[1];else if($t){var yn=+/w$/.test($t),Bn=+/^n/.test($t);dn=[$[1-yn]-un[0],ce[1-Bn]-un[1]],un[0]=$[yn],un[1]=ce[Bn]}else d.event.altKey&&(Kr=un.slice());Kt.style("pointer-events","none").selectAll(".resize").style("display",null),d.select("body").style("cursor",Bt.style("cursor")),Vt({type:"brushstart"}),Ba();function Ca(){d.event.keyCode==32&&(Xr||(Kr=null,un[0]-=$[1],un[1]-=ce[1],Xr=2),xe())}function Ti(){d.event.keyCode==32&&Xr==2&&(un[0]+=$[1],un[1]+=ce[1],Xr=0,xe())}function Ba(){var ia=d.mouse(Et),Ea=!1;dn&&(ia[0]+=dn[0],ia[1]+=dn[1]),Xr||(d.event.altKey?(Kr||(Kr=[($[0]+$[1])/2,(ce[0]+ce[1])/2]),un[0]=$[+(ia[0]<Kr[0])],un[1]=ce[+(ia[1]<Kr[1])]):Kr=null),Gt&&Yr(ia,E,0)&&(Ct(Kt),Ea=!0),Lr&&Yr(ia,I,1)&&(jt(Kt),Ea=!0),Ea&&(wt(Kt),Vt({type:"brush",mode:Xr?"move":"resize"}))}function Yr(ia,Ea,mi){var Pi=_d(Ea),Yi=Pi[0],io=Pi[1],mo=un[mi],oo=mi?ce:$,wo=oo[1]-oo[0],eo,Mo;if(Xr&&(Yi-=mo,io-=wo+mo),eo=(mi?Be:Le)?Math.max(Yi,Math.min(io,ia[mi])):ia[mi],Xr?Mo=(eo+=mo)+wo:(Kr&&(mo=Math.max(Yi,Math.min(io,2*Kr[mi]-eo))),mo<eo?(Mo=eo,eo=mo):Mo=mo),oo[0]!=eo||oo[1]!=Mo)return mi?Ne=null:fe=null,oo[0]=eo,oo[1]=Mo,!0}function Qn(){Ba(),Kt.style("pointer-events","all").selectAll(".resize").style("display",Ke.empty()?"none":null),d.select("body").style("cursor",null),Zn.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),tn(),Vt({type:"brushend"})}}return Ke.x=function(Et){return arguments.length?(E=Et,Qe=Yf[!E<<1|!I],Ke):E},Ke.y=function(Et){return arguments.length?(I=Et,Qe=Yf[!E<<1|!I],Ke):I},Ke.clamp=function(Et){return arguments.length?(E&&I?(Le=!!Et[0],Be=!!Et[1]):E?Le=!!Et:I&&(Be=!!Et),Ke):E&&I?[Le,Be]:E?Le:I?Be:null},Ke.extent=function(Et){var Bt,Vt,Kt,$t,Gt;return arguments.length?(E&&(Bt=Et[0],Vt=Et[1],I&&(Bt=Bt[0],Vt=Vt[0]),fe=[Bt,Vt],E.invert&&(Bt=E(Bt),Vt=E(Vt)),Vt<Bt&&(Gt=Bt,Bt=Vt,Vt=Gt),(Bt!=$[0]||Vt!=$[1])&&($=[Bt,Vt])),I&&(Kt=Et[0],$t=Et[1],E&&(Kt=Kt[1],$t=$t[1]),Ne=[Kt,$t],I.invert&&(Kt=I(Kt),$t=I($t)),$t<Kt&&(Gt=Kt,Kt=$t,$t=Gt),(Kt!=ce[0]||$t!=ce[1])&&(ce=[Kt,$t])),Ke):(E&&(fe?(Bt=fe[0],Vt=fe[1]):(Bt=$[0],Vt=$[1],E.invert&&(Bt=E.invert(Bt),Vt=E.invert(Vt)),Vt<Bt&&(Gt=Bt,Bt=Vt,Vt=Gt))),I&&(Ne?(Kt=Ne[0],$t=Ne[1]):(Kt=ce[0],$t=ce[1],I.invert&&(Kt=I.invert(Kt),$t=I.invert($t)),$t<Kt&&(Gt=Kt,Kt=$t,$t=Gt))),E&&I?[[Bt,Kt],[Vt,$t]]:E?[Bt,Vt]:I&&[Kt,$t])},Ke.clear=function(){return Ke.empty()||($=[0,0],ce=[0,0],fe=Ne=null),Ke},Ke.empty=function(){return!!E&&$[0]==$[1]||!!I&&ce[0]==ce[1]},d.rebind(Ke,c,"on")};var c5={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Yf=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];d.text=Rt(function(c){return c.responseText}),d.json=function(c,E){return Yt(c,"application/json",u5,E)};function u5(c){return JSON.parse(c.responseText)}d.html=function(c,E){return Yt(c,"text/html",d5,E)};function d5(c){var E=f.createRange();return E.selectNode(f.body),E.createContextualFragment(c.responseText)}d.xml=Rt(function(c){return c.responseXML}),typeof V=="object"&&V.exports?V.exports=d:this.d3=d}).apply(self)}),x=t((W,V)=>{(function(d,i){typeof W=="object"&&typeof V<"u"?i(W):(d=d||self,i(d.d3=d.d3||{}))})(W,function(d){var i=new Date,s=new Date;function f(we,je,ot,vt){function Lt(Tt){return we(Tt=arguments.length===0?new Date:new Date(+Tt)),Tt}return Lt.floor=function(Tt){return we(Tt=new Date(+Tt)),Tt},Lt.ceil=function(Tt){return we(Tt=new Date(Tt-1)),je(Tt,1),we(Tt),Tt},Lt.round=function(Tt){var kt=Lt(Tt),Nt=Lt.ceil(Tt);return Tt-kt<Nt-Tt?kt:Nt},Lt.offset=function(Tt,kt){return je(Tt=new Date(+Tt),kt==null?1:Math.floor(kt)),Tt},Lt.range=function(Tt,kt,Nt){var Pt=[],Wt;if(Tt=Lt.ceil(Tt),Nt=Nt==null?1:Math.floor(Nt),!(Tt<kt)||!(Nt>0))return Pt;do Pt.push(Wt=new Date(+Tt)),je(Tt,Nt),we(Tt);while(Wt<Tt&&Tt<kt);return Pt},Lt.filter=function(Tt){return f(function(kt){if(kt>=kt)for(;we(kt),!Tt(kt);)kt.setTime(kt-1)},function(kt,Nt){if(kt>=kt)if(Nt<0)for(;++Nt<=0;)for(;je(kt,-1),!Tt(kt););else for(;--Nt>=0;)for(;je(kt,1),!Tt(kt););})},ot&&(Lt.count=function(Tt,kt){return i.setTime(+Tt),s.setTime(+kt),we(i),we(s),Math.floor(ot(i,s))},Lt.every=function(Tt){return Tt=Math.floor(Tt),!isFinite(Tt)||!(Tt>0)?null:Tt>1?Lt.filter(vt?function(kt){return vt(kt)%Tt===0}:function(kt){return Lt.count(0,kt)%Tt===0}):Lt}),Lt}var u=f(function(){},function(we,je){we.setTime(+we+je)},function(we,je){return je-we});u.every=function(we){return we=Math.floor(we),!isFinite(we)||!(we>0)?null:we>1?f(function(je){je.setTime(Math.floor(je/we)*we)},function(je,ot){je.setTime(+je+ot*we)},function(je,ot){return(ot-je)/we}):u};var h=u.range,p=1e3,v=6e4,o=36e5,w=864e5,g=6048e5,b=f(function(we){we.setTime(we-we.getMilliseconds())},function(we,je){we.setTime(+we+je*p)},function(we,je){return(je-we)/p},function(we){return we.getUTCSeconds()}),L=b.range,S=f(function(we){we.setTime(we-we.getMilliseconds()-we.getSeconds()*p)},function(we,je){we.setTime(+we+je*v)},function(we,je){return(je-we)/v},function(we){return we.getMinutes()}),M=S.range,T=f(function(we){we.setTime(we-we.getMilliseconds()-we.getSeconds()*p-we.getMinutes()*v)},function(we,je){we.setTime(+we+je*o)},function(we,je){return(je-we)/o},function(we){return we.getHours()}),C=T.range,m=f(function(we){we.setHours(0,0,0,0)},function(we,je){we.setDate(we.getDate()+je)},function(we,je){return(je-we-(je.getTimezoneOffset()-we.getTimezoneOffset())*v)/w},function(we){return we.getDate()-1}),y=m.range;function A(we){return f(function(je){je.setDate(je.getDate()-(je.getDay()+7-we)%7),je.setHours(0,0,0,0)},function(je,ot){je.setDate(je.getDate()+ot*7)},function(je,ot){return(ot-je-(ot.getTimezoneOffset()-je.getTimezoneOffset())*v)/g})}var R=A(0),N=A(1),te=A(2),H=A(3),U=A(4),P=A(5),re=A(6),G=R.range,Z=N.range,Y=te.range,X=H.range,ne=U.range,ae=P.range,B=re.range,ie=f(function(we){we.setDate(1),we.setHours(0,0,0,0)},function(we,je){we.setMonth(we.getMonth()+je)},function(we,je){return je.getMonth()-we.getMonth()+(je.getFullYear()-we.getFullYear())*12},function(we){return we.getMonth()}),se=ie.range,ye=f(function(we){we.setMonth(0,1),we.setHours(0,0,0,0)},function(we,je){we.setFullYear(we.getFullYear()+je)},function(we,je){return je.getFullYear()-we.getFullYear()},function(we){return we.getFullYear()});ye.every=function(we){return!isFinite(we=Math.floor(we))||!(we>0)?null:f(function(je){je.setFullYear(Math.floor(je.getFullYear()/we)*we),je.setMonth(0,1),je.setHours(0,0,0,0)},function(je,ot){je.setFullYear(je.getFullYear()+ot*we)})};var me=ye.range,xe=f(function(we){we.setUTCSeconds(0,0)},function(we,je){we.setTime(+we+je*v)},function(we,je){return(je-we)/v},function(we){return we.getUTCMinutes()}),Re=xe.range,ke=f(function(we){we.setUTCMinutes(0,0,0)},function(we,je){we.setTime(+we+je*o)},function(we,je){return(je-we)/o},function(we){return we.getUTCHours()}),Ie=ke.range,Q=f(function(we){we.setUTCHours(0,0,0,0)},function(we,je){we.setUTCDate(we.getUTCDate()+je)},function(we,je){return(je-we)/w},function(we){return we.getUTCDate()-1}),ee=Q.range;function D(we){return f(function(je){je.setUTCDate(je.getUTCDate()-(je.getUTCDay()+7-we)%7),je.setUTCHours(0,0,0,0)},function(je,ot){je.setUTCDate(je.getUTCDate()+ot*7)},function(je,ot){return(ot-je)/g})}var le=D(0),ge=D(1),j=D(2),k=D(3),F=D(4),J=D(5),K=D(6),ve=le.range,Te=ge.range,Ae=j.range,Fe=k.range,Ge=F.range,rt=J.range,bt=K.range,ht=f(function(we){we.setUTCDate(1),we.setUTCHours(0,0,0,0)},function(we,je){we.setUTCMonth(we.getUTCMonth()+je)},function(we,je){return je.getUTCMonth()-we.getUTCMonth()+(je.getUTCFullYear()-we.getUTCFullYear())*12},function(we){return we.getUTCMonth()}),ct=ht.range,Oe=f(function(we){we.setUTCMonth(0,1),we.setUTCHours(0,0,0,0)},function(we,je){we.setUTCFullYear(we.getUTCFullYear()+je)},function(we,je){return je.getUTCFullYear()-we.getUTCFullYear()},function(we){return we.getUTCFullYear()});Oe.every=function(we){return!isFinite(we=Math.floor(we))||!(we>0)?null:f(function(je){je.setUTCFullYear(Math.floor(je.getUTCFullYear()/we)*we),je.setUTCMonth(0,1),je.setUTCHours(0,0,0,0)},function(je,ot){je.setUTCFullYear(je.getUTCFullYear()+ot*we)})};var ze=Oe.range;d.timeDay=m,d.timeDays=y,d.timeFriday=P,d.timeFridays=ae,d.timeHour=T,d.timeHours=C,d.timeInterval=f,d.timeMillisecond=u,d.timeMilliseconds=h,d.timeMinute=S,d.timeMinutes=M,d.timeMonday=N,d.timeMondays=Z,d.timeMonth=ie,d.timeMonths=se,d.timeSaturday=re,d.timeSaturdays=B,d.timeSecond=b,d.timeSeconds=L,d.timeSunday=R,d.timeSundays=G,d.timeThursday=U,d.timeThursdays=ne,d.timeTuesday=te,d.timeTuesdays=Y,d.timeWednesday=H,d.timeWednesdays=X,d.timeWeek=R,d.timeWeeks=G,d.timeYear=ye,d.timeYears=me,d.utcDay=Q,d.utcDays=ee,d.utcFriday=J,d.utcFridays=rt,d.utcHour=ke,d.utcHours=Ie,d.utcMillisecond=u,d.utcMilliseconds=h,d.utcMinute=xe,d.utcMinutes=Re,d.utcMonday=ge,d.utcMondays=Te,d.utcMonth=ht,d.utcMonths=ct,d.utcSaturday=K,d.utcSaturdays=bt,d.utcSecond=b,d.utcSeconds=L,d.utcSunday=le,d.utcSundays=ve,d.utcThursday=F,d.utcThursdays=Ge,d.utcTuesday=j,d.utcTuesdays=Ae,d.utcWednesday=k,d.utcWednesdays=Fe,d.utcWeek=le,d.utcWeeks=ve,d.utcYear=Oe,d.utcYears=ze,Object.defineProperty(d,"__esModule",{value:!0})})}),_=t((W,V)=>{(function(d,i){typeof W=="object"&&typeof V<"u"?i(W,x()):(d=d||self,i(d.d3=d.d3||{},d.d3))})(W,function(d,i){function s(De){if(0<=De.y&&De.y<100){var Je=new Date(-1,De.m,De.d,De.H,De.M,De.S,De.L);return Je.setFullYear(De.y),Je}return new Date(De.y,De.m,De.d,De.H,De.M,De.S,De.L)}function f(De){if(0<=De.y&&De.y<100){var Je=new Date(Date.UTC(-1,De.m,De.d,De.H,De.M,De.S,De.L));return Je.setUTCFullYear(De.y),Je}return new Date(Date.UTC(De.y,De.m,De.d,De.H,De.M,De.S,De.L))}function u(De,Je,de){return{y:De,m:Je,d:de,H:0,M:0,S:0,L:0}}function h(De){var Je=De.dateTime,de=De.date,Me=De.time,Ce=De.periods,Ue=De.days,He=De.shortDays,et=De.months,at=De.shortMonths,xt=L(Ce),mt=S(Ce),yt=L(Ue),It=S(Ue),zt=L(He),Ut=S(He),or=L(et),xr=S(et),zr=L(at),Br=S(at),Gr={a:Vn,A:Gn,b:sn,B:Fn,c:null,d:ie,e:ie,f:Re,H:se,I:ye,j:me,L:xe,m:ke,M:Ie,p:Tn,q:Mr,Q:kt,s:Nt,S:Q,u:ee,U:D,V:le,w:ge,W:j,x:null,X:null,y:k,Y:F,Z:J,"%":Tt},wr={a:oa,A:pe,b:he,B:Ye,c:null,d:K,e:K,f:Ge,H:ve,I:Te,j:Ae,L:Fe,m:rt,M:bt,p:tt,q:lt,Q:kt,s:Nt,S:ht,u:ct,U:Oe,V:ze,w:we,W:je,x:null,X:null,y:ot,Y:vt,Z:Lt,"%":Tt},lr={a:Er,A:_r,b:rn,B:gn,c:Ur,d:U,e:U,f:X,H:re,I:re,j:P,L:Y,m:H,M:G,p:Ar,q:te,Q:ae,s:B,S:Z,u:T,U:C,V:m,w:M,W:y,x:vn,X:Cn,y:R,Y:A,Z:N,"%":ne};Gr.x=Dr(de,Gr),Gr.X=Dr(Me,Gr),Gr.c=Dr(Je,Gr),wr.x=Dr(de,wr),wr.X=Dr(Me,wr),wr.c=Dr(Je,wr);function Dr(We,Ze){return function(dt){var it=[],At=-1,Rt=0,Yt=We.length,pr,fr,Sr;for(dt instanceof Date||(dt=new Date(+dt));++At<Yt;)We.charCodeAt(At)===37&&(it.push(We.slice(Rt,At)),(fr=p[pr=We.charAt(++At)])!=null?pr=We.charAt(++At):fr=pr==="e"?" ":"0",(Sr=Ze[pr])&&(pr=Sr(dt,fr)),it.push(pr),Rt=At+1);return it.push(We.slice(Rt,At)),it.join("")}}function Hr(We,Ze){return function(dt){var it=u(1900,void 0,1),At=Rr(it,We,dt+="",0),Rt,Yt;if(At!=dt.length)return null;if("Q"in it)return new Date(it.Q);if("s"in it)return new Date(it.s*1e3+("L"in it?it.L:0));if(Ze&&!("Z"in it)&&(it.Z=0),"p"in it&&(it.H=it.H%12+it.p*12),it.m===void 0&&(it.m="q"in it?it.q:0),"V"in it){if(it.V<1||it.V>53)return null;"w"in it||(it.w=1),"Z"in it?(Rt=f(u(it.y,0,1)),Yt=Rt.getUTCDay(),Rt=Yt>4||Yt===0?i.utcMonday.ceil(Rt):i.utcMonday(Rt),Rt=i.utcDay.offset(Rt,(it.V-1)*7),it.y=Rt.getUTCFullYear(),it.m=Rt.getUTCMonth(),it.d=Rt.getUTCDate()+(it.w+6)%7):(Rt=s(u(it.y,0,1)),Yt=Rt.getDay(),Rt=Yt>4||Yt===0?i.timeMonday.ceil(Rt):i.timeMonday(Rt),Rt=i.timeDay.offset(Rt,(it.V-1)*7),it.y=Rt.getFullYear(),it.m=Rt.getMonth(),it.d=Rt.getDate()+(it.w+6)%7)}else("W"in it||"U"in it)&&("w"in it||(it.w="u"in it?it.u%7:"W"in it?1:0),Yt="Z"in it?f(u(it.y,0,1)).getUTCDay():s(u(it.y,0,1)).getDay(),it.m=0,it.d="W"in it?(it.w+6)%7+it.W*7-(Yt+5)%7:it.w+it.U*7-(Yt+6)%7);return"Z"in it?(it.H+=it.Z/100|0,it.M+=it.Z%100,f(it)):s(it)}}function Rr(We,Ze,dt,it){for(var At=0,Rt=Ze.length,Yt=dt.length,pr,fr;At<Rt;){if(it>=Yt)return-1;if(pr=Ze.charCodeAt(At++),pr===37){if(pr=Ze.charAt(At++),fr=lr[pr in p?Ze.charAt(At++):pr],!fr||(it=fr(We,dt,it))<0)return-1}else if(pr!=dt.charCodeAt(it++))return-1}return it}function Ar(We,Ze,dt){var it=xt.exec(Ze.slice(dt));return it?(We.p=mt[it[0].toLowerCase()],dt+it[0].length):-1}function Er(We,Ze,dt){var it=zt.exec(Ze.slice(dt));return it?(We.w=Ut[it[0].toLowerCase()],dt+it[0].length):-1}function _r(We,Ze,dt){var it=yt.exec(Ze.slice(dt));return it?(We.w=It[it[0].toLowerCase()],dt+it[0].length):-1}function rn(We,Ze,dt){var it=zr.exec(Ze.slice(dt));return it?(We.m=Br[it[0].toLowerCase()],dt+it[0].length):-1}function gn(We,Ze,dt){var it=or.exec(Ze.slice(dt));return it?(We.m=xr[it[0].toLowerCase()],dt+it[0].length):-1}function Ur(We,Ze,dt){return Rr(We,Je,Ze,dt)}function vn(We,Ze,dt){return Rr(We,de,Ze,dt)}function Cn(We,Ze,dt){return Rr(We,Me,Ze,dt)}function Vn(We){return He[We.getDay()]}function Gn(We){return Ue[We.getDay()]}function sn(We){return at[We.getMonth()]}function Fn(We){return et[We.getMonth()]}function Tn(We){return Ce[+(We.getHours()>=12)]}function Mr(We){return 1+~~(We.getMonth()/3)}function oa(We){return He[We.getUTCDay()]}function pe(We){return Ue[We.getUTCDay()]}function he(We){return at[We.getUTCMonth()]}function Ye(We){return et[We.getUTCMonth()]}function tt(We){return Ce[+(We.getUTCHours()>=12)]}function lt(We){return 1+~~(We.getUTCMonth()/3)}return{format:function(We){var Ze=Dr(We+="",Gr);return Ze.toString=function(){return We},Ze},parse:function(We){var Ze=Hr(We+="",!1);return Ze.toString=function(){return We},Ze},utcFormat:function(We){var Ze=Dr(We+="",wr);return Ze.toString=function(){return We},Ze},utcParse:function(We){var Ze=Hr(We+="",!0);return Ze.toString=function(){return We},Ze}}}var p={"-":"",_:" ",0:"0"},v=/^\s*\d+/,o=/^%/,w=/[\\^$*+?|[\]().{}]/g;function g(De,Je,de){var Me=De<0?"-":"",Ce=(Me?-De:De)+"",Ue=Ce.length;return Me+(Ue<de?new Array(de-Ue+1).join(Je)+Ce:Ce)}function b(De){return De.replace(w,"\\$&")}function L(De){return new RegExp("^(?:"+De.map(b).join("|")+")","i")}function S(De){for(var Je={},de=-1,Me=De.length;++de<Me;)Je[De[de].toLowerCase()]=de;return Je}function M(De,Je,de){var Me=v.exec(Je.slice(de,de+1));return Me?(De.w=+Me[0],de+Me[0].length):-1}function T(De,Je,de){var Me=v.exec(Je.slice(de,de+1));return Me?(De.u=+Me[0],de+Me[0].length):-1}function C(De,Je,de){var Me=v.exec(Je.slice(de,de+2));return Me?(De.U=+Me[0],de+Me[0].length):-1}function m(De,Je,de){var Me=v.exec(Je.slice(de,de+2));return Me?(De.V=+Me[0],de+Me[0].length):-1}function y(De,Je,de){var Me=v.exec(Je.slice(de,de+2));return Me?(De.W=+Me[0],de+Me[0].length):-1}function A(De,Je,de){var Me=v.exec(Je.slice(de,de+4));return Me?(De.y=+Me[0],de+Me[0].length):-1}function R(De,Je,de){var Me=v.exec(Je.slice(de,de+2));return Me?(De.y=+Me[0]+(+Me[0]>68?1900:2e3),de+Me[0].length):-1}function N(De,Je,de){var Me=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(Je.slice(de,de+6));return Me?(De.Z=Me[1]?0:-(Me[2]+(Me[3]||"00")),de+Me[0].length):-1}function te(De,Je,de){var Me=v.exec(Je.slice(de,de+1));return Me?(De.q=Me[0]*3-3,de+Me[0].length):-1}function H(De,Je,de){var Me=v.exec(Je.slice(de,de+2));return Me?(De.m=Me[0]-1,de+Me[0].length):-1}function U(De,Je,de){var Me=v.exec(Je.slice(de,de+2));return Me?(De.d=+Me[0],de+Me[0].length):-1}function P(De,Je,de){var Me=v.exec(Je.slice(de,de+3));return Me?(De.m=0,De.d=+Me[0],de+Me[0].length):-1}function re(De,Je,de){var Me=v.exec(Je.slice(de,de+2));return Me?(De.H=+Me[0],de+Me[0].length):-1}function G(De,Je,de){var Me=v.exec(Je.slice(de,de+2));return Me?(De.M=+Me[0],de+Me[0].length):-1}function Z(De,Je,de){var Me=v.exec(Je.slice(de,de+2));return Me?(De.S=+Me[0],de+Me[0].length):-1}function Y(De,Je,de){var Me=v.exec(Je.slice(de,de+3));return Me?(De.L=+Me[0],de+Me[0].length):-1}function X(De,Je,de){var Me=v.exec(Je.slice(de,de+6));return Me?(De.L=Math.floor(Me[0]/1e3),de+Me[0].length):-1}function ne(De,Je,de){var Me=o.exec(Je.slice(de,de+1));return Me?de+Me[0].length:-1}function ae(De,Je,de){var Me=v.exec(Je.slice(de));return Me?(De.Q=+Me[0],de+Me[0].length):-1}function B(De,Je,de){var Me=v.exec(Je.slice(de));return Me?(De.s=+Me[0],de+Me[0].length):-1}function ie(De,Je){return g(De.getDate(),Je,2)}function se(De,Je){return g(De.getHours(),Je,2)}function ye(De,Je){return g(De.getHours()%12||12,Je,2)}function me(De,Je){return g(1+i.timeDay.count(i.timeYear(De),De),Je,3)}function xe(De,Je){return g(De.getMilliseconds(),Je,3)}function Re(De,Je){return xe(De,Je)+"000"}function ke(De,Je){return g(De.getMonth()+1,Je,2)}function Ie(De,Je){return g(De.getMinutes(),Je,2)}function Q(De,Je){return g(De.getSeconds(),Je,2)}function ee(De){var Je=De.getDay();return Je===0?7:Je}function D(De,Je){return g(i.timeSunday.count(i.timeYear(De)-1,De),Je,2)}function le(De,Je){var de=De.getDay();return De=de>=4||de===0?i.timeThursday(De):i.timeThursday.ceil(De),g(i.timeThursday.count(i.timeYear(De),De)+(i.timeYear(De).getDay()===4),Je,2)}function ge(De){return De.getDay()}function j(De,Je){return g(i.timeMonday.count(i.timeYear(De)-1,De),Je,2)}function k(De,Je){return g(De.getFullYear()%100,Je,2)}function F(De,Je){return g(De.getFullYear()%1e4,Je,4)}function J(De){var Je=De.getTimezoneOffset();return(Je>0?"-":(Je*=-1,"+"))+g(Je/60|0,"0",2)+g(Je%60,"0",2)}function K(De,Je){return g(De.getUTCDate(),Je,2)}function ve(De,Je){return g(De.getUTCHours(),Je,2)}function Te(De,Je){return g(De.getUTCHours()%12||12,Je,2)}function Ae(De,Je){return g(1+i.utcDay.count(i.utcYear(De),De),Je,3)}function Fe(De,Je){return g(De.getUTCMilliseconds(),Je,3)}function Ge(De,Je){return Fe(De,Je)+"000"}function rt(De,Je){return g(De.getUTCMonth()+1,Je,2)}function bt(De,Je){return g(De.getUTCMinutes(),Je,2)}function ht(De,Je){return g(De.getUTCSeconds(),Je,2)}function ct(De){var Je=De.getUTCDay();return Je===0?7:Je}function Oe(De,Je){return g(i.utcSunday.count(i.utcYear(De)-1,De),Je,2)}function ze(De,Je){var de=De.getUTCDay();return De=de>=4||de===0?i.utcThursday(De):i.utcThursday.ceil(De),g(i.utcThursday.count(i.utcYear(De),De)+(i.utcYear(De).getUTCDay()===4),Je,2)}function we(De){return De.getUTCDay()}function je(De,Je){return g(i.utcMonday.count(i.utcYear(De)-1,De),Je,2)}function ot(De,Je){return g(De.getUTCFullYear()%100,Je,2)}function vt(De,Je){return g(De.getUTCFullYear()%1e4,Je,4)}function Lt(){return"+0000"}function Tt(){return"%"}function kt(De){return+De}function Nt(De){return Math.floor(+De/1e3)}var Pt;Wt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Wt(De){return Pt=h(De),d.timeFormat=Pt.format,d.timeParse=Pt.parse,d.utcFormat=Pt.utcFormat,d.utcParse=Pt.utcParse,Pt}var St="%Y-%m-%dT%H:%M:%S.%LZ";function Qt(De){return De.toISOString()}var rr=Date.prototype.toISOString?Qt:d.utcFormat(St);function Jt(De){var Je=new Date(De);return isNaN(Je)?null:Je}var sr=+new Date("2000-01-01T00:00:00.000Z")?Jt:d.utcParse(St);d.isoFormat=rr,d.isoParse=sr,d.timeFormatDefaultLocale=Wt,d.timeFormatLocale=h,Object.defineProperty(d,"__esModule",{value:!0})})}),O=t((W,V)=>{(function(d,i){typeof W=="object"&&typeof V<"u"?i(W):(d=typeof globalThis<"u"?globalThis:d||self,i(d.d3=d.d3||{}))})(W,function(d){function i(H){return Math.abs(H=Math.round(H))>=1e21?H.toLocaleString("en").replace(/,/g,""):H.toString(10)}function s(H,U){if((P=(H=U?H.toExponential(U-1):H.toExponential()).indexOf("e"))<0)return null;var P,re=H.slice(0,P);return[re.length>1?re[0]+re.slice(2):re,+H.slice(P+1)]}function f(H){return H=s(Math.abs(H)),H?H[1]:NaN}function u(H,U){return function(P,re){for(var G=P.length,Z=[],Y=0,X=H[0],ne=0;G>0&&X>0&&(ne+X+1>re&&(X=Math.max(1,re-ne)),Z.push(P.substring(G-=X,G+X)),!((ne+=X+1)>re));)X=H[Y=(Y+1)%H.length];return Z.reverse().join(U)}}function h(H){return function(U){return U.replace(/[0-9]/g,function(P){return H[+P]})}}var p=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function v(H){if(!(U=p.exec(H)))throw new Error("invalid format: "+H);var U;return new o({fill:U[1],align:U[2],sign:U[3],symbol:U[4],zero:U[5],width:U[6],comma:U[7],precision:U[8]&&U[8].slice(1),trim:U[9],type:U[10]})}v.prototype=o.prototype;function o(H){this.fill=H.fill===void 0?" ":H.fill+"",this.align=H.align===void 0?">":H.align+"",this.sign=H.sign===void 0?"-":H.sign+"",this.symbol=H.symbol===void 0?"":H.symbol+"",this.zero=!!H.zero,this.width=H.width===void 0?void 0:+H.width,this.comma=!!H.comma,this.precision=H.precision===void 0?void 0:+H.precision,this.trim=!!H.trim,this.type=H.type===void 0?"":H.type+""}o.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function w(H){e:for(var U=H.length,P=1,re=-1,G;P<U;++P)switch(H[P]){case".":re=G=P;break;case"0":re===0&&(re=P),G=P;break;default:if(!+H[P])break e;re>0&&(re=0);break}return re>0?H.slice(0,re)+H.slice(G+1):H}var g;function b(H,U){var P=s(H,U);if(!P)return H+"";var re=P[0],G=P[1],Z=G-(g=Math.max(-8,Math.min(8,Math.floor(G/3)))*3)+1,Y=re.length;return Z===Y?re:Z>Y?re+new Array(Z-Y+1).join("0"):Z>0?re.slice(0,Z)+"."+re.slice(Z):"0."+new Array(1-Z).join("0")+s(H,Math.max(0,U+Z-1))[0]}function L(H,U){var P=s(H,U);if(!P)return H+"";var re=P[0],G=P[1];return G<0?"0."+new Array(-G).join("0")+re:re.length>G+1?re.slice(0,G+1)+"."+re.slice(G+1):re+new Array(G-re.length+2).join("0")}var S={"%":function(H,U){return(H*100).toFixed(U)},b:function(H){return Math.round(H).toString(2)},c:function(H){return H+""},d:i,e:function(H,U){return H.toExponential(U)},f:function(H,U){return H.toFixed(U)},g:function(H,U){return H.toPrecision(U)},o:function(H){return Math.round(H).toString(8)},p:function(H,U){return L(H*100,U)},r:L,s:b,X:function(H){return Math.round(H).toString(16).toUpperCase()},x:function(H){return Math.round(H).toString(16)}};function M(H){return H}var T=Array.prototype.map,C=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function m(H){var U=H.grouping===void 0||H.thousands===void 0?M:u(T.call(H.grouping,Number),H.thousands+""),P=H.currency===void 0?"":H.currency[0]+"",re=H.currency===void 0?"":H.currency[1]+"",G=H.decimal===void 0?".":H.decimal+"",Z=H.numerals===void 0?M:h(T.call(H.numerals,String)),Y=H.percent===void 0?"%":H.percent+"",X=H.minus===void 0?"-":H.minus+"",ne=H.nan===void 0?"NaN":H.nan+"";function ae(ie){ie=v(ie);var se=ie.fill,ye=ie.align,me=ie.sign,xe=ie.symbol,Re=ie.zero,ke=ie.width,Ie=ie.comma,Q=ie.precision,ee=ie.trim,D=ie.type;D==="n"?(Ie=!0,D="g"):S[D]||(Q===void 0&&(Q=12),ee=!0,D="g"),(Re||se==="0"&&ye==="=")&&(Re=!0,se="0",ye="=");var le=xe==="$"?P:xe==="#"&&/[boxX]/.test(D)?"0"+D.toLowerCase():"",ge=xe==="$"?re:/[%p]/.test(D)?Y:"",j=S[D],k=/[defgprs%]/.test(D);Q=Q===void 0?6:/[gprs]/.test(D)?Math.max(1,Math.min(21,Q)):Math.max(0,Math.min(20,Q));function F(J){var K=le,ve=ge,Te,Ae,Fe;if(D==="c")ve=j(J)+ve,J="";else{J=+J;var Ge=J<0||1/J<0;if(J=isNaN(J)?ne:j(Math.abs(J),Q),ee&&(J=w(J)),Ge&&+J==0&&me!=="+"&&(Ge=!1),K=(Ge?me==="("?me:X:me==="-"||me==="("?"":me)+K,ve=(D==="s"?C[8+g/3]:"")+ve+(Ge&&me==="("?")":""),k){for(Te=-1,Ae=J.length;++Te<Ae;)if(Fe=J.charCodeAt(Te),48>Fe||Fe>57){ve=(Fe===46?G+J.slice(Te+1):J.slice(Te))+ve,J=J.slice(0,Te);break}}}Ie&&!Re&&(J=U(J,1/0));var rt=K.length+J.length+ve.length,bt=rt<ke?new Array(ke-rt+1).join(se):"";switch(Ie&&Re&&(J=U(bt+J,bt.length?ke-ve.length:1/0),bt=""),ye){case"<":J=K+J+ve+bt;break;case"=":J=K+bt+J+ve;break;case"^":J=bt.slice(0,rt=bt.length>>1)+K+J+ve+bt.slice(rt);break;default:J=bt+K+J+ve;break}return Z(J)}return F.toString=function(){return ie+""},F}function B(ie,se){var ye=ae((ie=v(ie),ie.type="f",ie)),me=Math.max(-8,Math.min(8,Math.floor(f(se)/3)))*3,xe=Math.pow(10,-me),Re=C[8+me/3];return function(ke){return ye(xe*ke)+Re}}return{format:ae,formatPrefix:B}}var y;A({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function A(H){return y=m(H),d.format=y.format,d.formatPrefix=y.formatPrefix,y}function R(H){return Math.max(0,-f(Math.abs(H)))}function N(H,U){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(f(U)/3)))*3-f(Math.abs(H)))}function te(H,U){return H=Math.abs(H),U=Math.abs(U)-H,Math.max(0,f(U)-f(H))+1}d.FormatSpecifier=o,d.formatDefaultLocale=A,d.formatLocale=m,d.formatSpecifier=v,d.precisionFixed=R,d.precisionPrefix=N,d.precisionRound=te,Object.defineProperty(d,"__esModule",{value:!0})})}),z=t((W,V)=>{V.exports=function(d){for(var i=d.length,s,f=0;f<i;f++)if(s=d.charCodeAt(f),(s<9||s>13)&&s!==32&&s!==133&&s!==160&&s!==5760&&s!==6158&&(s<8192||s>8205)&&s!==8232&&s!==8233&&s!==8239&&s!==8287&&s!==8288&&s!==12288&&s!==65279)return!1;return!0}}),q=t((W,V)=>{var d=z();V.exports=function(i){var s=typeof i;if(s==="string"){var f=i;if(i=+i,i===0&&d(f))return!1}else if(s!=="number")return!1;return i-i<1}}),oe=t((W,V)=>{V.exports={BADNUM:void 0,FP_SAFE:Number.MAX_VALUE*1e-4,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,ONEMILLI:1,ONEMICROSEC:.001,EPOCHJD:24405875e-1,ALMOST_EQUAL:1-1e-6,LOG_CLIP:10,MINUS_SIGN:""}}),ue=t((W,V)=>{(function(d,i){typeof W=="object"&&typeof V<"u"?i(W):(d=typeof globalThis<"u"?globalThis:d||self,i(d["base64-arraybuffer"]={}))})(W,function(d){for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=typeof Uint8Array>"u"?[]:new Uint8Array(256),f=0;f<i.length;f++)s[i.charCodeAt(f)]=f;var u=function(p){var v=new Uint8Array(p),o,w=v.length,g="";for(o=0;o<w;o+=3)g+=i[v[o]>>2],g+=i[(v[o]&3)<<4|v[o+1]>>4],g+=i[(v[o+1]&15)<<2|v[o+2]>>6],g+=i[v[o+2]&63];return w%3===2?g=g.substring(0,g.length-1)+"=":w%3===1&&(g=g.substring(0,g.length-2)+"=="),g},h=function(p){var v=p.length*.75,o=p.length,w,g=0,b,L,S,M;p[p.length-1]==="="&&(v--,p[p.length-2]==="="&&v--);var T=new ArrayBuffer(v),C=new Uint8Array(T);for(w=0;w<o;w+=4)b=s[p.charCodeAt(w)],L=s[p.charCodeAt(w+1)],S=s[p.charCodeAt(w+2)],M=s[p.charCodeAt(w+3)],C[g++]=b<<2|L>>4,C[g++]=(L&15)<<4|S>>2,C[g++]=(S&3)<<6|M&63;return T};d.decode=h,d.encode=u,Object.defineProperty(d,"__esModule",{value:!0})})}),_e=t((W,V)=>{V.exports=function(d){return window&&window.process&&window.process.versions?Object.prototype.toString.call(d)==="[object Object]":Object.prototype.toString.call(d)==="[object Object]"&&Object.getPrototypeOf(d).hasOwnProperty("hasOwnProperty")}}),be=t(W=>{var V=ue().decode,d=_e(),i=Array.isArray,s=ArrayBuffer,f=DataView;function u(b){return s.isView(b)&&!(b instanceof f)}W.isTypedArray=u;function h(b){return i(b)||u(b)}W.isArrayOrTypedArray=h;function p(b){return!h(b[0])}W.isArray1D=p,W.ensureArray=function(b,L){return i(b)||(b=[]),b.length=L,b};var v={u1c:typeof Uint8ClampedArray>"u"?void 0:Uint8ClampedArray,i1:typeof Int8Array>"u"?void 0:Int8Array,u1:typeof Uint8Array>"u"?void 0:Uint8Array,i2:typeof Int16Array>"u"?void 0:Int16Array,u2:typeof Uint16Array>"u"?void 0:Uint16Array,i4:typeof Int32Array>"u"?void 0:Int32Array,u4:typeof Uint32Array>"u"?void 0:Uint32Array,f4:typeof Float32Array>"u"?void 0:Float32Array,f8:typeof Float64Array>"u"?void 0:Float64Array};v.uint8c=v.u1c,v.uint8=v.u1,v.int8=v.i1,v.uint16=v.u2,v.int16=v.i2,v.uint32=v.u4,v.int32=v.i4,v.float32=v.f4,v.float64=v.f8;function o(b){return b.constructor===ArrayBuffer}W.isArrayBuffer=o,W.decodeTypedArraySpec=function(b){var L=[],S=w(b),M=S.dtype,T=v[M];if(!T)throw new Error('Error in dtype: "'+M+'"');var C=T.BYTES_PER_ELEMENT,m=S.bdata;o(m)||(m=V(m));var y=S.shape===void 0?[m.byteLength/C]:(""+S.shape).split(",");y.reverse();var A=y.length,R,N,te=+y[0],H=C*te,U=0;if(A===1)L=new T(m);else if(A===2)for(R=+y[1],N=0;N<R;N++)L[N]=new T(m,U,te),U+=H;else if(A===3){R=+y[1];for(var P=+y[2],re=0;re<P;re++)for(L[re]=[],N=0;N<R;N++)L[re][N]=new T(m,U,te),U+=H}else throw new Error("ndim: "+A+'is not supported with the shape:"'+S.shape+'"');return L.bdata=S.bdata,L.dtype=S.dtype,L.shape=y.reverse().join(","),b._inputArray=L,L},W.isTypedArraySpec=function(b){return d(b)&&b.hasOwnProperty("dtype")&&typeof b.dtype=="string"&&b.hasOwnProperty("bdata")&&(typeof b.bdata=="string"||o(b.bdata))&&(b.shape===void 0||b.hasOwnProperty("shape")&&(typeof b.shape=="string"||typeof b.shape=="number"))};function w(b){return{bdata:b.bdata,dtype:b.dtype,shape:b.shape}}W.concat=function(){var b=[],L=!0,S=0,M,T,C,m,y,A,R,N;for(C=0;C<arguments.length;C++)m=arguments[C],A=m.length,A&&(T?b.push(m):(T=m,y=A),i(m)?M=!1:(L=!1,S?M!==m.constructor&&(M=!1):M=m.constructor),S+=A);if(!S)return[];if(!b.length)return T;if(L)return T.concat.apply(T,b);if(M){for(R=new M(S),R.set(T),C=0;C<b.length;C++)m=b[C],R.set(m,y),y+=m.length;return R}for(R=new Array(S),N=0;N<T.length;N++)R[N]=T[N];for(C=0;C<b.length;C++){for(m=b[C],N=0;N<m.length;N++)R[y+N]=m[N];y+=N}return R},W.maxRowLength=function(b){return g(b,Math.max,0)},W.minRowLength=function(b){return g(b,Math.min,1/0)};function g(b,L,S){if(h(b))if(h(b[0])){for(var M=S,T=0;T<b.length;T++)M=L(M,b[T].length);return M}else return b.length;return 0}}),Pe=t((W,V)=>{var d=q(),i=be().isArrayOrTypedArray;V.exports=function(g,b){if(d(b))b=String(b);else if(typeof b!="string"||b.substr(b.length-4)==="[-1]")throw"bad property string";var L=b.split("."),S,M,T,C;for(C=0;C<L.length;C++)if(String(L[C]).slice(0,2)==="__")throw"bad property string";for(C=0;C<L.length;){if(S=String(L[C]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/),S){if(S[1])L[C]=S[1];else if(C===0)L.splice(0,1);else throw"bad property string";for(M=S[2].substr(1,S[2].length-2).split("]["),T=0;T<M.length;T++)C++,L.splice(C,0,Number(M[T]))}C++}return typeof g!="object"?w(g,b,L):{set:h(g,L,b),get:s(g,L),astr:b,parts:L,obj:g}};function s(g,b){return function(L){var S=g,M,T,C,m,y;for(m=0;m<b.length-1;m++){if(M=b[m],M===-1){for(T=!0,C=[],y=0;y<S.length;y++)C[y]=s(S[y],b.slice(m+1))(L),C[y]!==C[0]&&(T=!1);return T?C[0]:C}if(typeof M=="number"&&!i(S)||(S=S[M],typeof S!="object"||S===null))return}if(!(typeof S!="object"||S===null)&&(C=S[b[m]],!(!L&&C===null)))return C}}var f=/(^|\.)args\[/;function u(g,b){return g===void 0||g===null&&!b.match(f)}function h(g,b,L){return function(S){var M=g,T="",C=u(S,L),m,y;for(y=0;y<b.length-1;y++){if(m=b[y],typeof m=="number"&&!i(M))throw"array index but container is not an array";if(m===-1){if(C=!v(M,b.slice(y+1),S,L),C)break;return}if(!o(M,m,b[y+1],C))break;if(M=M[m],typeof M!="object"||M===null)throw"container is not an object";T=p(T,m)}if(C){if(y===b.length-1&&(delete M[b[y]],Array.isArray(M)&&+b[y]===M.length-1))for(;M.length&&M[M.length-1]===void 0;)M.pop()}else M[b[y]]=S}}function p(g,b){var L=b;return d(b)?L="["+b+"]":g&&(L="."+b),g+L}function v(g,b,L,S){var M=i(L),T=!0,C=L,m=S.replace("-1",0),y=M?!1:u(L,m),A=b[0],R;for(R=0;R<g.length;R++)m=S.replace("-1",R),M&&(C=L[R%L.length],y=u(C,m)),y&&(T=!1),o(g,R,A,y)&&h(g[R],b,S.replace("-1",R))(C);return T}function o(g,b,L,S){if(g[b]===void 0){if(S)return!1;typeof L=="number"?g[b]=[]:g[b]={}}return!0}function w(g,b,L){return{set:function(){throw"bad container"},get:function(){},astr:b,parts:L,obj:g}}}),Se=t((W,V)=>{var d=Pe(),i=/^\w*$/,s=0,f=1,u=2,h=3,p=4;V.exports=function(v,o,w,g){w=w||"name",g=g||"value";var b,L,S,M={};o&&o.length?(S=d(v,o),L=S.get()):L=v,o=o||"";var T={};if(L)for(b=0;b<L.length;b++)T[L[b][w]]=b;var C=i.test(g),m={set:function(y,A){var R=A===null?p:s;if(!L){if(!S||R===p)return;L=[],S.set(L)}var N=T[y];if(N===void 0){if(R===p)return;R=R|h,N=L.length,T[y]=N}else A!==(C?L[N][g]:d(L[N],g).get())&&(R=R|u);var te=L[N]=L[N]||{};return te[w]=y,C?te[g]=A:d(te,g).set(A),A!==null&&(R=R&~p),M[N]=M[N]|R,m},get:function(y){if(L){var A=T[y];if(A!==void 0)return C?L[A][g]:d(L[A],g).get()}},rename:function(y,A){var R=T[y];return R===void 0||(M[R]=M[R]|f,T[A]=R,delete T[y],L[R][w]=A),m},remove:function(y){var A=T[y];if(A===void 0)return m;var R=L[A];if(Object.keys(R).length>2)return M[A]=M[A]|u,m.set(y,null);if(C){for(b=A;b<L.length;b++)M[b]=M[b]|h;for(b=A;b<L.length;b++)T[L[b][w]]--;L.splice(A,1),delete T[y]}else d(R,g).set(null),M[A]=M[A]|u|p;return m},constructUpdate:function(){for(var y,A,R={},N=Object.keys(M),te=0;te<N.length;te++)A=N[te],y=o+"["+A+"]",L[A]?(M[A]&f&&(R[y+"."+w]=L[A][w]),M[A]&u&&(C?R[y+"."+g]=M[A]&p?null:L[A][g]:R[y+"."+g]=M[A]&p?null:d(L[A],g).get())):R[y]=null;return R}};return m}}),Ee=t((W,V)=>{var d=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,i=/^[^\.\[\]]+$/;V.exports=function(s,f){for(;f;){var u=s.match(d);if(u)s=u[1];else if(s.match(i))s="";else throw new Error("bad relativeAttr call:"+[s,f]);if(f.charAt(0)==="^")f=f.slice(1);else break}return s&&f.charAt(0)!=="["?s+"."+f:s+f}}),Xe=t((W,V)=>{var d=q();V.exports=function(i,s){if(i>0)return Math.log(i)/Math.LN10;var f=Math.log(Math.min(s[0],s[1]))/Math.LN10;return d(f)||(f=Math.log(Math.max(s[0],s[1]))/Math.LN10-6),f}}),qe=t((W,V)=>{var d=be().isArrayOrTypedArray,i=_e();V.exports=function s(f,u){for(var h in u){var p=u[h],v=f[h];if(v!==p)if(h.charAt(0)==="_"||typeof p=="function"){if(h in f)continue;f[h]=p}else if(d(p)&&d(v)&&i(p[0])){if(h==="customdata"||h==="ids")continue;for(var o=Math.min(p.length,v.length),w=0;w<o;w++)v[w]!==p[w]&&i(p[w])&&i(v[w])&&s(v[w],p[w])}else i(p)&&i(v)&&(s(v,p),Object.keys(v).length||delete f[h])}}}),$e=t((W,V)=>{function d(s,f){var u=s%f;return u<0?u+f:u}function i(s,f){return Math.abs(s)>f/2?s-Math.round(s/f)*f:s}V.exports={mod:d,modHalf:i}}),ft=t((W,V)=>{(function(d){var i=/^\s+/,s=/\s+$/,f=0,u=d.round,h=d.min,p=d.max,v=d.random;function o(k,F){if(k=k||"",F=F||{},k instanceof o)return k;if(!(this instanceof o))return new o(k,F);var J=w(k);this._originalInput=k,this._r=J.r,this._g=J.g,this._b=J.b,this._a=J.a,this._roundA=u(100*this._a)/100,this._format=F.format||J.format,this._gradientType=F.gradientType,this._r<1&&(this._r=u(this._r)),this._g<1&&(this._g=u(this._g)),this._b<1&&(this._b=u(this._b)),this._ok=J.ok,this._tc_id=f++}o.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var k=this.toRgb();return(k.r*299+k.g*587+k.b*114)/1e3},getLuminance:function(){var k=this.toRgb(),F,J,K,ve,Te,Ae;return F=k.r/255,J=k.g/255,K=k.b/255,F<=.03928?ve=F/12.92:ve=d.pow((F+.055)/1.055,2.4),J<=.03928?Te=J/12.92:Te=d.pow((J+.055)/1.055,2.4),K<=.03928?Ae=K/12.92:Ae=d.pow((K+.055)/1.055,2.4),.2126*ve+.7152*Te+.0722*Ae},setAlpha:function(k){return this._a=ie(k),this._roundA=u(100*this._a)/100,this},toHsv:function(){var k=S(this._r,this._g,this._b);return{h:k.h*360,s:k.s,v:k.v,a:this._a}},toHsvString:function(){var k=S(this._r,this._g,this._b),F=u(k.h*360),J=u(k.s*100),K=u(k.v*100);return this._a==1?"hsv("+F+", "+J+"%, "+K+"%)":"hsva("+F+", "+J+"%, "+K+"%, "+this._roundA+")"},toHsl:function(){var k=b(this._r,this._g,this._b);return{h:k.h*360,s:k.s,l:k.l,a:this._a}},toHslString:function(){var k=b(this._r,this._g,this._b),F=u(k.h*360),J=u(k.s*100),K=u(k.l*100);return this._a==1?"hsl("+F+", "+J+"%, "+K+"%)":"hsla("+F+", "+J+"%, "+K+"%, "+this._roundA+")"},toHex:function(k){return T(this._r,this._g,this._b,k)},toHexString:function(k){return"#"+this.toHex(k)},toHex8:function(k){return C(this._r,this._g,this._b,this._a,k)},toHex8String:function(k){return"#"+this.toHex8(k)},toRgb:function(){return{r:u(this._r),g:u(this._g),b:u(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+u(this._r)+", "+u(this._g)+", "+u(this._b)+")":"rgba("+u(this._r)+", "+u(this._g)+", "+u(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:u(se(this._r,255)*100)+"%",g:u(se(this._g,255)*100)+"%",b:u(se(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+u(se(this._r,255)*100)+"%, "+u(se(this._g,255)*100)+"%, "+u(se(this._b,255)*100)+"%)":"rgba("+u(se(this._r,255)*100)+"%, "+u(se(this._g,255)*100)+"%, "+u(se(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:ae[T(this._r,this._g,this._b,!0)]||!1},toFilter:function(k){var F="#"+m(this._r,this._g,this._b,this._a),J=F,K=this._gradientType?"GradientType = 1, ":"";if(k){var ve=o(k);J="#"+m(ve._r,ve._g,ve._b,ve._a)}return"progid:DXImageTransform.Microsoft.gradient("+K+"startColorstr="+F+",endColorstr="+J+")"},toString:function(k){var F=!!k;k=k||this._format;var J=!1,K=this._a<1&&this._a>=0,ve=!F&&K&&(k==="hex"||k==="hex6"||k==="hex3"||k==="hex4"||k==="hex8"||k==="name");return ve?k==="name"&&this._a===0?this.toName():this.toRgbString():(k==="rgb"&&(J=this.toRgbString()),k==="prgb"&&(J=this.toPercentageRgbString()),(k==="hex"||k==="hex6")&&(J=this.toHexString()),k==="hex3"&&(J=this.toHexString(!0)),k==="hex4"&&(J=this.toHex8String(!0)),k==="hex8"&&(J=this.toHex8String()),k==="name"&&(J=this.toName()),k==="hsl"&&(J=this.toHslString()),k==="hsv"&&(J=this.toHsvString()),J||this.toHexString())},clone:function(){return o(this.toString())},_applyModification:function(k,F){var J=k.apply(null,[this].concat([].slice.call(F)));return this._r=J._r,this._g=J._g,this._b=J._b,this.setAlpha(J._a),this},lighten:function(){return this._applyModification(N,arguments)},brighten:function(){return this._applyModification(te,arguments)},darken:function(){return this._applyModification(H,arguments)},desaturate:function(){return this._applyModification(y,arguments)},saturate:function(){return this._applyModification(A,arguments)},greyscale:function(){return this._applyModification(R,arguments)},spin:function(){return this._applyModification(U,arguments)},_applyCombination:function(k,F){return k.apply(null,[this].concat([].slice.call(F)))},analogous:function(){return this._applyCombination(Y,arguments)},complement:function(){return this._applyCombination(P,arguments)},monochromatic:function(){return this._applyCombination(X,arguments)},splitcomplement:function(){return this._applyCombination(Z,arguments)},triad:function(){return this._applyCombination(re,arguments)},tetrad:function(){return this._applyCombination(G,arguments)}},o.fromRatio=function(k,F){if(typeof k=="object"){var J={};for(var K in k)k.hasOwnProperty(K)&&(K==="a"?J[K]=k[K]:J[K]=Ie(k[K]));k=J}return o(k,F)};function w(k){var F={r:0,g:0,b:0},J=1,K=null,ve=null,Te=null,Ae=!1,Fe=!1;return typeof k=="string"&&(k=ge(k)),typeof k=="object"&&(le(k.r)&&le(k.g)&&le(k.b)?(F=g(k.r,k.g,k.b),Ae=!0,Fe=String(k.r).substr(-1)==="%"?"prgb":"rgb"):le(k.h)&&le(k.s)&&le(k.v)?(K=Ie(k.s),ve=Ie(k.v),F=M(k.h,K,ve),Ae=!0,Fe="hsv"):le(k.h)&&le(k.s)&&le(k.l)&&(K=Ie(k.s),Te=Ie(k.l),F=L(k.h,K,Te),Ae=!0,Fe="hsl"),k.hasOwnProperty("a")&&(J=k.a)),J=ie(J),{ok:Ae,format:k.format||Fe,r:h(255,p(F.r,0)),g:h(255,p(F.g,0)),b:h(255,p(F.b,0)),a:J}}function g(k,F,J){return{r:se(k,255)*255,g:se(F,255)*255,b:se(J,255)*255}}function b(k,F,J){k=se(k,255),F=se(F,255),J=se(J,255);var K=p(k,F,J),ve=h(k,F,J),Te,Ae,Fe=(K+ve)/2;if(K==ve)Te=Ae=0;else{var Ge=K-ve;switch(Ae=Fe>.5?Ge/(2-K-ve):Ge/(K+ve),K){case k:Te=(F-J)/Ge+(F<J?6:0);break;case F:Te=(J-k)/Ge+2;break;case J:Te=(k-F)/Ge+4;break}Te/=6}return{h:Te,s:Ae,l:Fe}}function L(k,F,J){var K,ve,Te;k=se(k,360),F=se(F,100),J=se(J,100);function Ae(rt,bt,ht){return ht<0&&(ht+=1),ht>1&&(ht-=1),ht<1/6?rt+(bt-rt)*6*ht:ht<1/2?bt:ht<2/3?rt+(bt-rt)*(2/3-ht)*6:rt}if(F===0)K=ve=Te=J;else{var Fe=J<.5?J*(1+F):J+F-J*F,Ge=2*J-Fe;K=Ae(Ge,Fe,k+1/3),ve=Ae(Ge,Fe,k),Te=Ae(Ge,Fe,k-1/3)}return{r:K*255,g:ve*255,b:Te*255}}function S(k,F,J){k=se(k,255),F=se(F,255),J=se(J,255);var K=p(k,F,J),ve=h(k,F,J),Te,Ae,Fe=K,Ge=K-ve;if(Ae=K===0?0:Ge/K,K==ve)Te=0;else{switch(K){case k:Te=(F-J)/Ge+(F<J?6:0);break;case F:Te=(J-k)/Ge+2;break;case J:Te=(k-F)/Ge+4;break}Te/=6}return{h:Te,s:Ae,v:Fe}}function M(k,F,J){k=se(k,360)*6,F=se(F,100),J=se(J,100);var K=d.floor(k),ve=k-K,Te=J*(1-F),Ae=J*(1-ve*F),Fe=J*(1-(1-ve)*F),Ge=K%6,rt=[J,Ae,Te,Te,Fe,J][Ge],bt=[Fe,J,J,Ae,Te,Te][Ge],ht=[Te,Te,Fe,J,J,Ae][Ge];return{r:rt*255,g:bt*255,b:ht*255}}function T(k,F,J,K){var ve=[ke(u(k).toString(16)),ke(u(F).toString(16)),ke(u(J).toString(16))];return K&&ve[0].charAt(0)==ve[0].charAt(1)&&ve[1].charAt(0)==ve[1].charAt(1)&&ve[2].charAt(0)==ve[2].charAt(1)?ve[0].charAt(0)+ve[1].charAt(0)+ve[2].charAt(0):ve.join("")}function C(k,F,J,K,ve){var Te=[ke(u(k).toString(16)),ke(u(F).toString(16)),ke(u(J).toString(16)),ke(Q(K))];return ve&&Te[0].charAt(0)==Te[0].charAt(1)&&Te[1].charAt(0)==Te[1].charAt(1)&&Te[2].charAt(0)==Te[2].charAt(1)&&Te[3].charAt(0)==Te[3].charAt(1)?Te[0].charAt(0)+Te[1].charAt(0)+Te[2].charAt(0)+Te[3].charAt(0):Te.join("")}function m(k,F,J,K){var ve=[ke(Q(K)),ke(u(k).toString(16)),ke(u(F).toString(16)),ke(u(J).toString(16))];return ve.join("")}o.equals=function(k,F){return!k||!F?!1:o(k).toRgbString()==o(F).toRgbString()},o.random=function(){return o.fromRatio({r:v(),g:v(),b:v()})};function y(k,F){F=F===0?0:F||10;var J=o(k).toHsl();return J.s-=F/100,J.s=ye(J.s),o(J)}function A(k,F){F=F===0?0:F||10;var J=o(k).toHsl();return J.s+=F/100,J.s=ye(J.s),o(J)}function R(k){return o(k).desaturate(100)}function N(k,F){F=F===0?0:F||10;var J=o(k).toHsl();return J.l+=F/100,J.l=ye(J.l),o(J)}function te(k,F){F=F===0?0:F||10;var J=o(k).toRgb();return J.r=p(0,h(255,J.r-u(255*-(F/100)))),J.g=p(0,h(255,J.g-u(255*-(F/100)))),J.b=p(0,h(255,J.b-u(255*-(F/100)))),o(J)}function H(k,F){F=F===0?0:F||10;var J=o(k).toHsl();return J.l-=F/100,J.l=ye(J.l),o(J)}function U(k,F){var J=o(k).toHsl(),K=(J.h+F)%360;return J.h=K<0?360+K:K,o(J)}function P(k){var F=o(k).toHsl();return F.h=(F.h+180)%360,o(F)}function re(k){var F=o(k).toHsl(),J=F.h;return[o(k),o({h:(J+120)%360,s:F.s,l:F.l}),o({h:(J+240)%360,s:F.s,l:F.l})]}function G(k){var F=o(k).toHsl(),J=F.h;return[o(k),o({h:(J+90)%360,s:F.s,l:F.l}),o({h:(J+180)%360,s:F.s,l:F.l}),o({h:(J+270)%360,s:F.s,l:F.l})]}function Z(k){var F=o(k).toHsl(),J=F.h;return[o(k),o({h:(J+72)%360,s:F.s,l:F.l}),o({h:(J+216)%360,s:F.s,l:F.l})]}function Y(k,F,J){F=F||6,J=J||30;var K=o(k).toHsl(),ve=360/J,Te=[o(k)];for(K.h=(K.h-(ve*F>>1)+720)%360;--F;)K.h=(K.h+ve)%360,Te.push(o(K));return Te}function X(k,F){F=F||6;for(var J=o(k).toHsv(),K=J.h,ve=J.s,Te=J.v,Ae=[],Fe=1/F;F--;)Ae.push(o({h:K,s:ve,v:Te})),Te=(Te+Fe)%1;return Ae}o.mix=function(k,F,J){J=J===0?0:J||50;var K=o(k).toRgb(),ve=o(F).toRgb(),Te=J/100,Ae={r:(ve.r-K.r)*Te+K.r,g:(ve.g-K.g)*Te+K.g,b:(ve.b-K.b)*Te+K.b,a:(ve.a-K.a)*Te+K.a};return o(Ae)},o.readability=function(k,F){var J=o(k),K=o(F);return(d.max(J.getLuminance(),K.getLuminance())+.05)/(d.min(J.getLuminance(),K.getLuminance())+.05)},o.isReadable=function(k,F,J){var K=o.readability(k,F),ve,Te;switch(Te=!1,ve=j(J),ve.level+ve.size){case"AAsmall":case"AAAlarge":Te=K>=4.5;break;case"AAlarge":Te=K>=3;break;case"AAAsmall":Te=K>=7;break}return Te},o.mostReadable=function(k,F,J){var K=null,ve=0,Te,Ae,Fe,Ge;J=J||{},Ae=J.includeFallbackColors,Fe=J.level,Ge=J.size;for(var rt=0;rt<F.length;rt++)Te=o.readability(k,F[rt]),Te>ve&&(ve=Te,K=o(F[rt]));return o.isReadable(k,K,{level:Fe,size:Ge})||!Ae?K:(J.includeFallbackColors=!1,o.mostReadable(k,["#fff","#000"],J))};var ne=o.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},ae=o.hexNames=B(ne);function B(k){var F={};for(var J in k)k.hasOwnProperty(J)&&(F[k[J]]=J);return F}function ie(k){return k=parseFloat(k),(isNaN(k)||k<0||k>1)&&(k=1),k}function se(k,F){xe(k)&&(k="100%");var J=Re(k);return k=h(F,p(0,parseFloat(k))),J&&(k=parseInt(k*F,10)/100),d.abs(k-F)<1e-6?1:k%F/parseFloat(F)}function ye(k){return h(1,p(0,k))}function me(k){return parseInt(k,16)}function xe(k){return typeof k=="string"&&k.indexOf(".")!=-1&&parseFloat(k)===1}function Re(k){return typeof k=="string"&&k.indexOf("%")!=-1}function ke(k){return k.length==1?"0"+k:""+k}function Ie(k){return k<=1&&(k=k*100+"%"),k}function Q(k){return d.round(parseFloat(k)*255).toString(16)}function ee(k){return me(k)/255}var D=(function(){var k="[-\\+]?\\d+%?",F="[-\\+]?\\d*\\.\\d+%?",J="(?:"+F+")|(?:"+k+")",K="[\\s|\\(]+("+J+")[,|\\s]+("+J+")[,|\\s]+("+J+")\\s*\\)?",ve="[\\s|\\(]+("+J+")[,|\\s]+("+J+")[,|\\s]+("+J+")[,|\\s]+("+J+")\\s*\\)?";return{CSS_UNIT:new RegExp(J),rgb:new RegExp("rgb"+K),rgba:new RegExp("rgba"+ve),hsl:new RegExp("hsl"+K),hsla:new RegExp("hsla"+ve),hsv:new RegExp("hsv"+K),hsva:new RegExp("hsva"+ve),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function le(k){return!!D.CSS_UNIT.exec(k)}function ge(k){k=k.replace(i,"").replace(s,"").toLowerCase();var F=!1;if(ne[k])k=ne[k],F=!0;else if(k=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var J;return(J=D.rgb.exec(k))?{r:J[1],g:J[2],b:J[3]}:(J=D.rgba.exec(k))?{r:J[1],g:J[2],b:J[3],a:J[4]}:(J=D.hsl.exec(k))?{h:J[1],s:J[2],l:J[3]}:(J=D.hsla.exec(k))?{h:J[1],s:J[2],l:J[3],a:J[4]}:(J=D.hsv.exec(k))?{h:J[1],s:J[2],v:J[3]}:(J=D.hsva.exec(k))?{h:J[1],s:J[2],v:J[3],a:J[4]}:(J=D.hex8.exec(k))?{r:me(J[1]),g:me(J[2]),b:me(J[3]),a:ee(J[4]),format:F?"name":"hex8"}:(J=D.hex6.exec(k))?{r:me(J[1]),g:me(J[2]),b:me(J[3]),format:F?"name":"hex"}:(J=D.hex4.exec(k))?{r:me(J[1]+""+J[1]),g:me(J[2]+""+J[2]),b:me(J[3]+""+J[3]),a:ee(J[4]+""+J[4]),format:F?"name":"hex8"}:(J=D.hex3.exec(k))?{r:me(J[1]+""+J[1]),g:me(J[2]+""+J[2]),b:me(J[3]+""+J[3]),format:F?"name":"hex"}:!1}function j(k){var F,J;return k=k||{level:"AA",size:"small"},F=(k.level||"AA").toUpperCase(),J=(k.size||"small").toLowerCase(),F!=="AA"&&F!=="AAA"&&(F="AA"),J!=="small"&&J!=="large"&&(J="small"),{level:F,size:J}}typeof V<"u"&&V.exports?V.exports=o:window.tinycolor=o})(Math)}),gt=t(W=>{var V=_e(),d=Array.isArray;function i(f,u){var h,p;for(h=0;h<f.length;h++){if(p=f[h],p!==null&&typeof p=="object")return!1;p!==void 0&&(u[h]=p)}return!0}W.extendFlat=function(){return s(arguments,!1,!1,!1)},W.extendDeep=function(){return s(arguments,!0,!1,!1)},W.extendDeepAll=function(){return s(arguments,!0,!0,!1)},W.extendDeepNoArrays=function(){return s(arguments,!0,!1,!0)};function s(f,u,h,p){var v=f[0],o=f.length,w,g,b,L,S,M,T;if(o===2&&d(v)&&d(f[1])&&v.length===0){if(T=i(f[1],v),T)return v;v.splice(0,v.length)}for(var C=1;C<o;C++){w=f[C];for(g in w)b=v[g],L=w[g],p&&d(L)?v[g]=L:u&&L&&(V(L)||(S=d(L)))?(S?(S=!1,M=b&&d(b)?b:[]):M=b&&V(b)?b:{},v[g]=s([M,L],u,h,p)):(typeof L<"u"||h)&&(v[g]=L)}return v}}),pt=t((W,V)=>{V.exports=function(d){var i=d.variantValues,s=d.editType,f=d.colorEditType;f===void 0&&(f=s);var u={editType:s,valType:"integer",min:1,max:1e3,extras:["normal","bold"],dflt:"normal"};d.noNumericWeightValues&&(u.valType="enumerated",u.values=u.extras,u.extras=void 0,u.min=void 0,u.max=void 0);var h={family:{valType:"string",noBlank:!0,strict:!0,editType:s},size:{valType:"number",min:1,editType:s},color:{valType:"color",editType:f},weight:u,style:{editType:s,valType:"enumerated",values:["normal","italic"],dflt:"normal"},variant:d.noFontVariant?void 0:{editType:s,valType:"enumerated",values:i||["normal","small-caps","all-small-caps","all-petite-caps","petite-caps","unicase"],dflt:"normal"},textcase:d.noFontTextcase?void 0:{editType:s,valType:"enumerated",values:["normal","word caps","upper","lower"],dflt:"normal"},lineposition:d.noFontLineposition?void 0:{editType:s,valType:"flaglist",flags:["under","over","through"],extras:["none"],dflt:"none"},shadow:d.noFontShadow?void 0:{editType:s,valType:"string",dflt:d.autoShadowDflt?"auto":"none"},editType:s};return d.autoSize&&(h.size.dflt="auto"),d.autoColor&&(h.color.dflt="auto"),d.arrayOk&&(h.family.arrayOk=!0,h.weight.arrayOk=!0,h.style.arrayOk=!0,d.noFontVariant||(h.variant.arrayOk=!0),d.noFontTextcase||(h.textcase.arrayOk=!0),d.noFontLineposition||(h.lineposition.arrayOk=!0),d.noFontShadow||(h.shadow.arrayOk=!0),h.size.arrayOk=!0,h.color.arrayOk=!0),h}}),Ht=t((W,V)=>{V.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}}),ur=t((W,V)=>{var d=Ht(),i=pt(),s=i({editType:"none"});s.family.dflt=d.HOVERFONT,s.size.dflt=d.HOVERFONTSIZE,V.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoversubplots:{valType:"enumerated",values:["single","overlaying","axis"],dflt:"overlaying",editType:"none"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:s,grouptitlefont:i({editType:"none"}),align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},showarrow:{valType:"boolean",dflt:!0,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}}),Ve=t((W,V)=>{var d=pt(),i=ur().hoverlabel,s=gt().extendFlat;V.exports={hoverlabel:{bgcolor:s({},i.bgcolor,{arrayOk:!0}),bordercolor:s({},i.bordercolor,{arrayOk:!0}),font:d({arrayOk:!0,editType:"none"}),align:s({},i.align,{arrayOk:!0}),namelength:s({},i.namelength,{arrayOk:!0}),showarrow:s({},i.showarrow),editType:"none"}}}),nt=t((W,V)=>{var d=pt(),i=Ve();V.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legend:{valType:"subplotid",dflt:"legend",editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:d({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},legendwidth:{valType:"number",min:0,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:i.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},uirevision:{valType:"any",editType:"none"}}}),nr=t((W,V)=>{var d=ft(),i={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},s=i.RdBu;function f(p,v){if(v||(v=s),!p)return v;function o(){try{p=i[p]||JSON.parse(p)}catch{p=v}}return typeof p=="string"&&(o(),typeof p=="string"&&o()),u(p)?p:v}function u(p){var v=0;if(!Array.isArray(p)||p.length<2||!p[0]||!p[p.length-1]||+p[0][0]!=0||+p[p.length-1][0]!=1)return!1;for(var o=0;o<p.length;o++){var w=p[o];if(w.length!==2||+w[0]<v||!d(w[1]).isValid())return!1;v=+w[0]}return!0}function h(p){return i[p]!==void 0?!0:u(p)}V.exports={scales:i,defaultScale:s,get:f,isValid:h}}),Zt=t(W=>{W.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],W.defaultLine="#444",W.lightLine="#eee",W.background="#fff",W.borderLine="#BEC8D9",W.lightFraction=1e3/11}),Xt=t((W,V)=>{var d=ft(),i=q(),s=be().isTypedArray,f=V.exports={},u=Zt();f.defaults=u.defaults;var h=f.defaultLine=u.defaultLine;f.lightLine=u.lightLine;var p=f.background=u.background;f.tinyRGB=function(o){var w=o.toRgb();return"rgb("+Math.round(w.r)+", "+Math.round(w.g)+", "+Math.round(w.b)+")"},f.rgb=function(o){return f.tinyRGB(d(o))},f.opacity=function(o){return o?d(o).getAlpha():0},f.addOpacity=function(o,w){var g=d(o).toRgb();return"rgba("+Math.round(g.r)+", "+Math.round(g.g)+", "+Math.round(g.b)+", "+w+")"},f.combine=function(o,w){var g=d(o).toRgb();if(g.a===1)return d(o).toRgbString();var b=d(w||p).toRgb(),L=b.a===1?b:{r:255*(1-b.a)+b.r*b.a,g:255*(1-b.a)+b.g*b.a,b:255*(1-b.a)+b.b*b.a},S={r:L.r*(1-g.a)+g.r*g.a,g:L.g*(1-g.a)+g.g*g.a,b:L.b*(1-g.a)+g.b*g.a};return d(S).toRgbString()},f.interpolate=function(o,w,g){var b=d(o).toRgb(),L=d(w).toRgb(),S={r:g*b.r+(1-g)*L.r,g:g*b.g+(1-g)*L.g,b:g*b.b+(1-g)*L.b};return d(S).toRgbString()},f.contrast=function(o,w,g){var b=d(o);b.getAlpha()!==1&&(b=d(f.combine(o,p)));var L=b.isDark()?w?b.lighten(w):p:g?b.darken(g):h;return L.toString()},f.stroke=function(o,w){var g=d(w);o.style({stroke:f.tinyRGB(g),"stroke-opacity":g.getAlpha()})},f.fill=function(o,w){var g=d(w);o.style({fill:f.tinyRGB(g),"fill-opacity":g.getAlpha()})},f.clean=function(o){if(!(!o||typeof o!="object")){var w=Object.keys(o),g,b,L,S;for(g=0;g<w.length;g++)if(L=w[g],S=o[L],L.substr(L.length-5)==="color")if(Array.isArray(S))for(b=0;b<S.length;b++)S[b]=v(S[b]);else o[L]=v(S);else if(L.substr(L.length-10)==="colorscale"&&Array.isArray(S))for(b=0;b<S.length;b++)Array.isArray(S[b])&&(S[b][1]=v(S[b][1]));else if(Array.isArray(S)){var M=S[0];if(!Array.isArray(M)&&M&&typeof M=="object")for(b=0;b<S.length;b++)f.clean(S[b])}else S&&typeof S=="object"&&!s(S)&&f.clean(S)}};function v(o){if(i(o)||typeof o!="string")return o;var w=o.trim();if(w.substr(0,3)!=="rgb")return o;var g=w.match(/^rgba?\s*\(([^()]*)\)$/);if(!g)return o;var b=g[1].trim().split(/\s*[\s,]\s*/),L=w.charAt(3)==="a"&&b.length===4;if(!L&&b.length!==3)return o;for(var S=0;S<b.length;S++){if(!b[S].length||(b[S]=Number(b[S]),!(b[S]>=0)))return o;if(S===3)b[S]>1&&(b[S]=1);else if(b[S]>=1)return o}var M=Math.round(b[0]*255)+", "+Math.round(b[1]*255)+", "+Math.round(b[2]*255);return L?"rgba("+M+", "+b[3]+")":"rgb("+M+")"}}),Pr=t((W,V)=>{V.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}}),cr=t(W=>{W.counter=function(V,d,i,s){var f=(d||"")+(i?"":"$"),u=s===!1?"":"^";return V==="xy"?new RegExp(u+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+f):new RegExp(u+V+"([2-9]|[1-9][0-9]+)?"+f)}}),Qr=t(W=>{var V=q(),d=ft(),i=gt().extendFlat,s=nt(),f=nr(),u=Xt(),h=Pr().DESELECTDIM,p=Pe(),v=cr().counter,o=$e().modHalf,w=be().isArrayOrTypedArray,g=be().isTypedArraySpec,b=be().decodeTypedArraySpec;W.valObjectMeta={data_array:{coerceFunction:function(S,M,T){M.set(w(S)?S:g(S)?b(S):T)}},enumerated:{coerceFunction:function(S,M,T,C){C.coerceNumber&&(S=+S),C.values.indexOf(S)===-1?M.set(T):M.set(S)},validateFunction:function(S,M){M.coerceNumber&&(S=+S);for(var T=M.values,C=0;C<T.length;C++){var m=String(T[C]);if(m.charAt(0)==="/"&&m.charAt(m.length-1)==="/"){var y=new RegExp(m.substr(1,m.length-2));if(y.test(S))return!0}else if(S===T[C])return!0}return!1}},boolean:{coerceFunction:function(S,M,T){S===!0||S===!1?M.set(S):M.set(T)}},number:{coerceFunction:function(S,M,T,C){g(S)&&(S=b(S)),!V(S)||C.min!==void 0&&S<C.min||C.max!==void 0&&S>C.max?M.set(T):M.set(+S)}},integer:{coerceFunction:function(S,M,T,C){if((C.extras||[]).indexOf(S)!==-1){M.set(S);return}g(S)&&(S=b(S)),S%1||!V(S)||C.min!==void 0&&S<C.min||C.max!==void 0&&S>C.max?M.set(T):M.set(+S)}},string:{coerceFunction:function(S,M,T,C){if(typeof S!="string"){var m=typeof S=="number";C.strict===!0||!m?M.set(T):M.set(String(S))}else C.noBlank&&!S?M.set(T):M.set(S)}},color:{coerceFunction:function(S,M,T){g(S)&&(S=b(S)),d(S).isValid()?M.set(S):M.set(T)}},colorlist:{coerceFunction:function(S,M,T){function C(m){return d(m).isValid()}!Array.isArray(S)||!S.length?M.set(T):S.every(C)?M.set(S):M.set(T)}},colorscale:{coerceFunction:function(S,M,T){M.set(f.get(S,T))}},angle:{coerceFunction:function(S,M,T){g(S)&&(S=b(S)),S==="auto"?M.set("auto"):V(S)?M.set(o(+S,360)):M.set(T)}},subplotid:{coerceFunction:function(S,M,T,C){var m=C.regex||v(T);if(typeof S=="string"&&m.test(S)){M.set(S);return}M.set(T)},validateFunction:function(S,M){var T=M.dflt;return S===T?!0:typeof S!="string"?!1:!!v(T).test(S)}},flaglist:{coerceFunction:function(S,M,T,C){if((C.extras||[]).indexOf(S)!==-1){M.set(S);return}if(typeof S!="string"){M.set(T);return}for(var m=S.split("+"),y=0;y<m.length;){var A=m[y];C.flags.indexOf(A)===-1||m.indexOf(A)<y?m.splice(y,1):y++}m.length?M.set(m.join("+")):M.set(T)}},any:{coerceFunction:function(S,M,T){S===void 0?M.set(T):M.set(g(S)?b(S):S)}},info_array:{coerceFunction:function(S,M,T,C){function m(ne,ae,B){var ie,se={set:function(ye){ie=ye}};return B===void 0&&(B=ae.dflt),W.valObjectMeta[ae.valType].coerceFunction(ne,se,B,ae),ie}if(g(S)&&(S=b(S)),!w(S)){M.set(T);return}var y=C.dimensions===2||C.dimensions==="1-2"&&Array.isArray(S)&&w(S[0]),A=C.items,R=[],N=Array.isArray(A),te=N&&y&&w(A[0]),H=y&&N&&!te,U=N&&!H?A.length:S.length,P,re,G,Z,Y,X;if(T=Array.isArray(T)?T:[],y)for(P=0;P<U;P++)for(R[P]=[],G=w(S[P])?S[P]:[],H?Y=A.length:N?Y=A[P].length:Y=G.length,re=0;re<Y;re++)H?Z=A[re]:N?Z=A[P][re]:Z=A,X=m(G[re],Z,(T[P]||[])[re]),X!==void 0&&(R[P][re]=X);else for(P=0;P<U;P++)X=m(S[P],N?A[P]:A,T[P]),X!==void 0&&(R[P]=X);M.set(R)},validateFunction:function(S,M){if(!w(S))return!1;var T=M.items,C=Array.isArray(T),m=M.dimensions===2;if(!M.freeLength&&S.length!==T.length)return!1;for(var y=0;y<S.length;y++)if(m){if(!w(S[y])||!M.freeLength&&S[y].length!==T[y].length)return!1;for(var A=0;A<S[y].length;A++)if(!L(S[y][A],C?T[y][A]:T))return!1}else if(!L(S[y],C?T[y]:T))return!1;return!0}}},W.coerce=function(S,M,T,C,m){var y=p(T,C).get(),A=p(S,C),R=p(M,C),N=A.get(),te=M._template;if(N===void 0&&te&&(N=p(te,C).get(),te=0),m===void 0&&(m=y.dflt),y.arrayOk){if(w(N))return R.set(N),N;if(g(N))return N=b(N),R.set(N),N}var H=W.valObjectMeta[y.valType].coerceFunction;H(N,R,m,y);var U=R.get();return te&&U===m&&!L(N,y)&&(N=p(te,C).get(),H(N,R,m,y),U=R.get()),U},W.coerce2=function(S,M,T,C,m){var y=p(S,C),A=W.coerce(S,M,T,C,m),R=y.get();return R!=null?A:!1},W.coerceFont=function(S,M,T,C){C||(C={}),T=i({},T),T=i(T,C.overrideDflt||{});var m={family:S(M+".family",T.family),size:S(M+".size",T.size),color:S(M+".color",T.color),weight:S(M+".weight",T.weight),style:S(M+".style",T.style)};if(C.noFontVariant||(m.variant=S(M+".variant",T.variant)),C.noFontLineposition||(m.lineposition=S(M+".lineposition",T.lineposition)),C.noFontTextcase||(m.textcase=S(M+".textcase",T.textcase)),!C.noFontShadow){var y=T.shadow;y==="none"&&C.autoShadowDflt&&(y="auto"),m.shadow=S(M+".shadow",y)}return m},W.coercePattern=function(S,M,T,C){var m=S(M+".shape"),y;if(m||(y=S(M+".path")),m||y){m&&S(M+".solidity"),S(M+".size");var A=S(M+".fillmode"),R=A==="overlay";if(!C){var N=S(M+".bgcolor",R?T:void 0);S(M+".fgcolor",R?u.contrast(N):T)}S(M+".fgopacity",R?.5:1)}},W.coerceHoverinfo=function(S,M,T){var C=M._module.attributes,m=C.hoverinfo?C:s,y=m.hoverinfo,A;if(T._dataLength===1){var R=y.dflt==="all"?y.flags.slice():y.dflt.split("+");R.splice(R.indexOf("name"),1),A=R.join("+")}return W.coerce(S,M,m,"hoverinfo",A)},W.coerceSelectionMarkerOpacity=function(S,M){if(S.marker){var T=S.marker.opacity;if(T!==void 0){var C,m;!w(T)&&!S.selected&&!S.unselected&&(C=T,m=h*T),M("selected.marker.opacity",C),M("unselected.marker.opacity",m)}}};function L(S,M){var T=W.valObjectMeta[M.valType];if(M.arrayOk&&w(S))return!0;if(T.validateFunction)return T.validateFunction(S,M);var C={},m=C,y={set:function(A){m=A}};return T.coerceFunction(S,y,C,M),m!==C}W.validate=L}),Tr=t((W,V)=>{var d={staticPlot:{valType:"boolean",dflt:!1},typesetMath:{valType:"boolean",dflt:!0},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},editSelection:{valType:"boolean",dflt:!0},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox","map"],extras:[!0,!1],dflt:"gl3d+geo+map"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/un/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},i={};function s(f,u){for(var h in f){var p=f[h];p.valType?u[h]=p.dflt:(u[h]||(u[h]={}),s(p,u[h]))}}s(d,i),V.exports={configAttributes:d,dfltConfig:i}}),ln=t((W,V)=>{var d=l(),i=q(),s=[];V.exports=function(f,u){if(s.indexOf(f)!==-1)return;s.push(f);var h=1e3;i(u)?h=u:u==="long"&&(h=3e3);var p=d.select("body").selectAll(".plotly-notifier").data([0]);p.enter().append("div").classed("plotly-notifier",!0);var v=p.selectAll(".notifier-note").data(s);function o(w){w.duration(700).style("opacity",0).each("end",function(g){var b=s.indexOf(g);b!==-1&&s.splice(b,1),d.select(this).remove()})}v.enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(w){var g=d.select(this);g.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){g.transition().call(o)});for(var b=g.append("p"),L=w.split(/<br\s*\/?>/g),S=0;S<L.length;S++)S&&b.append("br"),b.append("span").text(L[S]);u==="stick"?g.transition().duration(350).style("opacity",1):g.transition().duration(700).style("opacity",1).transition().delay(h).call(o)})}}),Sn=t((W,V)=>{var d=Tr().dfltConfig,i=ln(),s=V.exports={};s.log=function(){var f;if(d.logging>1){var u=["LOG:"];for(f=0;f<arguments.length;f++)u.push(arguments[f]);console.trace.apply(console,u)}if(d.notifyOnLogging>1){var h=[];for(f=0;f<arguments.length;f++)h.push(arguments[f]);i(h.join("<br>"),"long")}},s.warn=function(){var f;if(d.logging>0){var u=["WARN:"];for(f=0;f<arguments.length;f++)u.push(arguments[f]);console.trace.apply(console,u)}if(d.notifyOnLogging>0){var h=[];for(f=0;f<arguments.length;f++)h.push(arguments[f]);i(h.join("<br>"),"stick")}},s.error=function(){var f;if(d.logging>0){var u=["ERROR:"];for(f=0;f<arguments.length;f++)u.push(arguments[f]);console.error.apply(console,u)}if(d.notifyOnLogging>0){var h=[];for(f=0;f<arguments.length;f++)h.push(arguments[f]);i(h.join("<br>"),"stick")}}}),Wn=t((W,V)=>{V.exports=function(){}}),Ma=t((W,V)=>{V.exports=function(d,i){if(i instanceof RegExp){for(var s=i.toString(),f=0;f<d.length;f++)if(d[f]instanceof RegExp&&d[f].toString()===s)return d;d.push(i)}else(i||i===0)&&d.indexOf(i)===-1&&d.push(i);return d}}),zn=t((W,V)=>{V.exports=d;function d(){var i=new Float32Array(16);return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}}),Or=t((W,V)=>{V.exports=d;function d(i){var s=new Float32Array(16);return s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[3],s[4]=i[4],s[5]=i[5],s[6]=i[6],s[7]=i[7],s[8]=i[8],s[9]=i[9],s[10]=i[10],s[11]=i[11],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15],s}}),$r=t((W,V)=>{V.exports=d;function d(i,s){return i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i[4]=s[4],i[5]=s[5],i[6]=s[6],i[7]=s[7],i[8]=s[8],i[9]=s[9],i[10]=s[10],i[11]=s[11],i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15],i}}),En=t((W,V)=>{V.exports=d;function d(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}}),Ln=t((W,V)=>{V.exports=d;function d(i,s){if(i===s){var f=s[1],u=s[2],h=s[3],p=s[6],v=s[7],o=s[11];i[1]=s[4],i[2]=s[8],i[3]=s[12],i[4]=f,i[6]=s[9],i[7]=s[13],i[8]=u,i[9]=p,i[11]=s[14],i[12]=h,i[13]=v,i[14]=o}else i[0]=s[0],i[1]=s[4],i[2]=s[8],i[3]=s[12],i[4]=s[1],i[5]=s[5],i[6]=s[9],i[7]=s[13],i[8]=s[2],i[9]=s[6],i[10]=s[10],i[11]=s[14],i[12]=s[3],i[13]=s[7],i[14]=s[11],i[15]=s[15];return i}}),ta=t((W,V)=>{V.exports=d;function d(i,s){var f=s[0],u=s[1],h=s[2],p=s[3],v=s[4],o=s[5],w=s[6],g=s[7],b=s[8],L=s[9],S=s[10],M=s[11],T=s[12],C=s[13],m=s[14],y=s[15],A=f*o-u*v,R=f*w-h*v,N=f*g-p*v,te=u*w-h*o,H=u*g-p*o,U=h*g-p*w,P=b*C-L*T,re=b*m-S*T,G=b*y-M*T,Z=L*m-S*C,Y=L*y-M*C,X=S*y-M*m,ne=A*X-R*Y+N*Z+te*G-H*re+U*P;return ne?(ne=1/ne,i[0]=(o*X-w*Y+g*Z)*ne,i[1]=(h*Y-u*X-p*Z)*ne,i[2]=(C*U-m*H+y*te)*ne,i[3]=(S*H-L*U-M*te)*ne,i[4]=(w*G-v*X-g*re)*ne,i[5]=(f*X-h*G+p*re)*ne,i[6]=(m*N-T*U-y*R)*ne,i[7]=(b*U-S*N+M*R)*ne,i[8]=(v*Y-o*G+g*P)*ne,i[9]=(u*G-f*Y-p*P)*ne,i[10]=(T*H-C*N+y*A)*ne,i[11]=(L*N-b*H-M*A)*ne,i[12]=(o*re-v*Z-w*P)*ne,i[13]=(f*Z-u*re+h*P)*ne,i[14]=(C*R-T*te-m*A)*ne,i[15]=(b*te-L*R+S*A)*ne,i):null}}),Jn=t((W,V)=>{V.exports=d;function d(i,s){var f=s[0],u=s[1],h=s[2],p=s[3],v=s[4],o=s[5],w=s[6],g=s[7],b=s[8],L=s[9],S=s[10],M=s[11],T=s[12],C=s[13],m=s[14],y=s[15];return i[0]=o*(S*y-M*m)-L*(w*y-g*m)+C*(w*M-g*S),i[1]=-(u*(S*y-M*m)-L*(h*y-p*m)+C*(h*M-p*S)),i[2]=u*(w*y-g*m)-o*(h*y-p*m)+C*(h*g-p*w),i[3]=-(u*(w*M-g*S)-o*(h*M-p*S)+L*(h*g-p*w)),i[4]=-(v*(S*y-M*m)-b*(w*y-g*m)+T*(w*M-g*S)),i[5]=f*(S*y-M*m)-b*(h*y-p*m)+T*(h*M-p*S),i[6]=-(f*(w*y-g*m)-v*(h*y-p*m)+T*(h*g-p*w)),i[7]=f*(w*M-g*S)-v*(h*M-p*S)+b*(h*g-p*w),i[8]=v*(L*y-M*C)-b*(o*y-g*C)+T*(o*M-g*L),i[9]=-(f*(L*y-M*C)-b*(u*y-p*C)+T*(u*M-p*L)),i[10]=f*(o*y-g*C)-v*(u*y-p*C)+T*(u*g-p*o),i[11]=-(f*(o*M-g*L)-v*(u*M-p*L)+b*(u*g-p*o)),i[12]=-(v*(L*m-S*C)-b*(o*m-w*C)+T*(o*S-w*L)),i[13]=f*(L*m-S*C)-b*(u*m-h*C)+T*(u*S-h*L),i[14]=-(f*(o*m-w*C)-v*(u*m-h*C)+T*(u*w-h*o)),i[15]=f*(o*S-w*L)-v*(u*S-h*L)+b*(u*w-h*o),i}}),da=t((W,V)=>{V.exports=d;function d(i){var s=i[0],f=i[1],u=i[2],h=i[3],p=i[4],v=i[5],o=i[6],w=i[7],g=i[8],b=i[9],L=i[10],S=i[11],M=i[12],T=i[13],C=i[14],m=i[15],y=s*v-f*p,A=s*o-u*p,R=s*w-h*p,N=f*o-u*v,te=f*w-h*v,H=u*w-h*o,U=g*T-b*M,P=g*C-L*M,re=g*m-S*M,G=b*C-L*T,Z=b*m-S*T,Y=L*m-S*C;return y*Y-A*Z+R*G+N*re-te*P+H*U}}),La=t((W,V)=>{V.exports=d;function d(i,s,f){var u=s[0],h=s[1],p=s[2],v=s[3],o=s[4],w=s[5],g=s[6],b=s[7],L=s[8],S=s[9],M=s[10],T=s[11],C=s[12],m=s[13],y=s[14],A=s[15],R=f[0],N=f[1],te=f[2],H=f[3];return i[0]=R*u+N*o+te*L+H*C,i[1]=R*h+N*w+te*S+H*m,i[2]=R*p+N*g+te*M+H*y,i[3]=R*v+N*b+te*T+H*A,R=f[4],N=f[5],te=f[6],H=f[7],i[4]=R*u+N*o+te*L+H*C,i[5]=R*h+N*w+te*S+H*m,i[6]=R*p+N*g+te*M+H*y,i[7]=R*v+N*b+te*T+H*A,R=f[8],N=f[9],te=f[10],H=f[11],i[8]=R*u+N*o+te*L+H*C,i[9]=R*h+N*w+te*S+H*m,i[10]=R*p+N*g+te*M+H*y,i[11]=R*v+N*b+te*T+H*A,R=f[12],N=f[13],te=f[14],H=f[15],i[12]=R*u+N*o+te*L+H*C,i[13]=R*h+N*w+te*S+H*m,i[14]=R*p+N*g+te*M+H*y,i[15]=R*v+N*b+te*T+H*A,i}}),ga=t((W,V)=>{V.exports=d;function d(i,s,f){var u=f[0],h=f[1],p=f[2],v,o,w,g,b,L,S,M,T,C,m,y;return s===i?(i[12]=s[0]*u+s[4]*h+s[8]*p+s[12],i[13]=s[1]*u+s[5]*h+s[9]*p+s[13],i[14]=s[2]*u+s[6]*h+s[10]*p+s[14],i[15]=s[3]*u+s[7]*h+s[11]*p+s[15]):(v=s[0],o=s[1],w=s[2],g=s[3],b=s[4],L=s[5],S=s[6],M=s[7],T=s[8],C=s[9],m=s[10],y=s[11],i[0]=v,i[1]=o,i[2]=w,i[3]=g,i[4]=b,i[5]=L,i[6]=S,i[7]=M,i[8]=T,i[9]=C,i[10]=m,i[11]=y,i[12]=v*u+b*h+T*p+s[12],i[13]=o*u+L*h+C*p+s[13],i[14]=w*u+S*h+m*p+s[14],i[15]=g*u+M*h+y*p+s[15]),i}}),tr=t((W,V)=>{V.exports=d;function d(i,s,f){var u=f[0],h=f[1],p=f[2];return i[0]=s[0]*u,i[1]=s[1]*u,i[2]=s[2]*u,i[3]=s[3]*u,i[4]=s[4]*h,i[5]=s[5]*h,i[6]=s[6]*h,i[7]=s[7]*h,i[8]=s[8]*p,i[9]=s[9]*p,i[10]=s[10]*p,i[11]=s[11]*p,i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15],i}}),Ni=t((W,V)=>{V.exports=d;function d(i,s,f,u){var h=u[0],p=u[1],v=u[2],o=Math.sqrt(h*h+p*p+v*v),w,g,b,L,S,M,T,C,m,y,A,R,N,te,H,U,P,re,G,Z,Y,X,ne,ae;return Math.abs(o)<1e-6?null:(o=1/o,h*=o,p*=o,v*=o,w=Math.sin(f),g=Math.cos(f),b=1-g,L=s[0],S=s[1],M=s[2],T=s[3],C=s[4],m=s[5],y=s[6],A=s[7],R=s[8],N=s[9],te=s[10],H=s[11],U=h*h*b+g,P=p*h*b+v*w,re=v*h*b-p*w,G=h*p*b-v*w,Z=p*p*b+g,Y=v*p*b+h*w,X=h*v*b+p*w,ne=p*v*b-h*w,ae=v*v*b+g,i[0]=L*U+C*P+R*re,i[1]=S*U+m*P+N*re,i[2]=M*U+y*P+te*re,i[3]=T*U+A*P+H*re,i[4]=L*G+C*Z+R*Y,i[5]=S*G+m*Z+N*Y,i[6]=M*G+y*Z+te*Y,i[7]=T*G+A*Z+H*Y,i[8]=L*X+C*ne+R*ae,i[9]=S*X+m*ne+N*ae,i[10]=M*X+y*ne+te*ae,i[11]=T*X+A*ne+H*ae,s!==i&&(i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15]),i)}}),fa=t((W,V)=>{V.exports=d;function d(i,s,f){var u=Math.sin(f),h=Math.cos(f),p=s[4],v=s[5],o=s[6],w=s[7],g=s[8],b=s[9],L=s[10],S=s[11];return s!==i&&(i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15]),i[4]=p*h+g*u,i[5]=v*h+b*u,i[6]=o*h+L*u,i[7]=w*h+S*u,i[8]=g*h-p*u,i[9]=b*h-v*u,i[10]=L*h-o*u,i[11]=S*h-w*u,i}}),ya=t((W,V)=>{V.exports=d;function d(i,s,f){var u=Math.sin(f),h=Math.cos(f),p=s[0],v=s[1],o=s[2],w=s[3],g=s[8],b=s[9],L=s[10],S=s[11];return s!==i&&(i[4]=s[4],i[5]=s[5],i[6]=s[6],i[7]=s[7],i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15]),i[0]=p*h-g*u,i[1]=v*h-b*u,i[2]=o*h-L*u,i[3]=w*h-S*u,i[8]=p*u+g*h,i[9]=v*u+b*h,i[10]=o*u+L*h,i[11]=w*u+S*h,i}}),ra=t((W,V)=>{V.exports=d;function d(i,s,f){var u=Math.sin(f),h=Math.cos(f),p=s[0],v=s[1],o=s[2],w=s[3],g=s[4],b=s[5],L=s[6],S=s[7];return s!==i&&(i[8]=s[8],i[9]=s[9],i[10]=s[10],i[11]=s[11],i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15]),i[0]=p*h+g*u,i[1]=v*h+b*u,i[2]=o*h+L*u,i[3]=w*h+S*u,i[4]=g*h-p*u,i[5]=b*h-v*u,i[6]=L*h-o*u,i[7]=S*h-w*u,i}}),Ga=t((W,V)=>{V.exports=d;function d(i,s,f){var u,h,p,v=f[0],o=f[1],w=f[2],g=Math.sqrt(v*v+o*o+w*w);return Math.abs(g)<1e-6?null:(g=1/g,v*=g,o*=g,w*=g,u=Math.sin(s),h=Math.cos(s),p=1-h,i[0]=v*v*p+h,i[1]=o*v*p+w*u,i[2]=w*v*p-o*u,i[3]=0,i[4]=v*o*p-w*u,i[5]=o*o*p+h,i[6]=w*o*p+v*u,i[7]=0,i[8]=v*w*p+o*u,i[9]=o*w*p-v*u,i[10]=w*w*p+h,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)}}),na=t((W,V)=>{V.exports=d;function d(i,s,f){var u=s[0],h=s[1],p=s[2],v=s[3],o=u+u,w=h+h,g=p+p,b=u*o,L=u*w,S=u*g,M=h*w,T=h*g,C=p*g,m=v*o,y=v*w,A=v*g;return i[0]=1-(M+C),i[1]=L+A,i[2]=S-y,i[3]=0,i[4]=L-A,i[5]=1-(b+C),i[6]=T+m,i[7]=0,i[8]=S+y,i[9]=T-m,i[10]=1-(b+M),i[11]=0,i[12]=f[0],i[13]=f[1],i[14]=f[2],i[15]=1,i}}),Dt=t((W,V)=>{V.exports=d;function d(i,s){return i[0]=s[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=s[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=s[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}}),ut=t((W,V)=>{V.exports=d;function d(i,s){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=s[0],i[13]=s[1],i[14]=s[2],i[15]=1,i}}),dr=t((W,V)=>{V.exports=d;function d(i,s){var f=Math.sin(s),u=Math.cos(s);return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=u,i[6]=f,i[7]=0,i[8]=0,i[9]=-f,i[10]=u,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}}),kr=t((W,V)=>{V.exports=d;function d(i,s){var f=Math.sin(s),u=Math.cos(s);return i[0]=u,i[1]=0,i[2]=-f,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=f,i[9]=0,i[10]=u,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}}),qr=t((W,V)=>{V.exports=d;function d(i,s){var f=Math.sin(s),u=Math.cos(s);return i[0]=u,i[1]=f,i[2]=0,i[3]=0,i[4]=-f,i[5]=u,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}}),Ir=t((W,V)=>{V.exports=d;function d(i,s){var f=s[0],u=s[1],h=s[2],p=s[3],v=f+f,o=u+u,w=h+h,g=f*v,b=u*v,L=u*o,S=h*v,M=h*o,T=h*w,C=p*v,m=p*o,y=p*w;return i[0]=1-L-T,i[1]=b+y,i[2]=S-m,i[3]=0,i[4]=b-y,i[5]=1-g-T,i[6]=M+C,i[7]=0,i[8]=S+m,i[9]=M-C,i[10]=1-g-L,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}}),Nn=t((W,V)=>{V.exports=d;function d(i,s,f,u,h,p,v){var o=1/(f-s),w=1/(h-u),g=1/(p-v);return i[0]=p*2*o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=p*2*w,i[6]=0,i[7]=0,i[8]=(f+s)*o,i[9]=(h+u)*w,i[10]=(v+p)*g,i[11]=-1,i[12]=0,i[13]=0,i[14]=v*p*2*g,i[15]=0,i}}),hn=t((W,V)=>{V.exports=d;function d(i,s,f,u,h){var p=1/Math.tan(s/2),v=1/(u-h);return i[0]=p/f,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=p,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=(h+u)*v,i[11]=-1,i[12]=0,i[13]=0,i[14]=2*h*u*v,i[15]=0,i}}),wn=t((W,V)=>{V.exports=d;function d(i,s,f,u){var h=Math.tan(s.upDegrees*Math.PI/180),p=Math.tan(s.downDegrees*Math.PI/180),v=Math.tan(s.leftDegrees*Math.PI/180),o=Math.tan(s.rightDegrees*Math.PI/180),w=2/(v+o),g=2/(h+p);return i[0]=w,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=g,i[6]=0,i[7]=0,i[8]=-((v-o)*w*.5),i[9]=(h-p)*g*.5,i[10]=u/(f-u),i[11]=-1,i[12]=0,i[13]=0,i[14]=u*f/(f-u),i[15]=0,i}}),pa=t((W,V)=>{V.exports=d;function d(i,s,f,u,h,p,v){var o=1/(s-f),w=1/(u-h),g=1/(p-v);return i[0]=-2*o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*w,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*g,i[11]=0,i[12]=(s+f)*o,i[13]=(h+u)*w,i[14]=(v+p)*g,i[15]=1,i}}),en=t((W,V)=>{var d=En();V.exports=i;function i(s,f,u,h){var p,v,o,w,g,b,L,S,M,T,C=f[0],m=f[1],y=f[2],A=h[0],R=h[1],N=h[2],te=u[0],H=u[1],U=u[2];return Math.abs(C-te)<1e-6&&Math.abs(m-H)<1e-6&&Math.abs(y-U)<1e-6?d(s):(L=C-te,S=m-H,M=y-U,T=1/Math.sqrt(L*L+S*S+M*M),L*=T,S*=T,M*=T,p=R*M-N*S,v=N*L-A*M,o=A*S-R*L,T=Math.sqrt(p*p+v*v+o*o),T?(T=1/T,p*=T,v*=T,o*=T):(p=0,v=0,o=0),w=S*o-M*v,g=M*p-L*o,b=L*v-S*p,T=Math.sqrt(w*w+g*g+b*b),T?(T=1/T,w*=T,g*=T,b*=T):(w=0,g=0,b=0),s[0]=p,s[1]=w,s[2]=L,s[3]=0,s[4]=v,s[5]=g,s[6]=S,s[7]=0,s[8]=o,s[9]=b,s[10]=M,s[11]=0,s[12]=-(p*C+v*m+o*y),s[13]=-(w*C+g*m+b*y),s[14]=-(L*C+S*m+M*y),s[15]=1,s)}}),Rn=t((W,V)=>{V.exports=d;function d(i){return"mat4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+", "+i[9]+", "+i[10]+", "+i[11]+", "+i[12]+", "+i[13]+", "+i[14]+", "+i[15]+")"}}),Kn=t((W,V)=>{V.exports={create:zn(),clone:Or(),copy:$r(),identity:En(),transpose:Ln(),invert:ta(),adjoint:Jn(),determinant:da(),multiply:La(),translate:ga(),scale:tr(),rotate:Ni(),rotateX:fa(),rotateY:ya(),rotateZ:ra(),fromRotation:Ga(),fromRotationTranslation:na(),fromScaling:Dt(),fromTranslation:ut(),fromXRotation:dr(),fromYRotation:kr(),fromZRotation:qr(),fromQuat:Ir(),frustum:Nn(),perspective:hn(),perspectiveFromFieldOfView:wn(),ortho:pa(),lookAt:en(),str:Rn()}}),$n=t(W=>{var V=Kn();W.init2dArray=function(d,i){for(var s=new Array(d),f=0;f<d;f++)s[f]=new Array(i);return s},W.transposeRagged=function(d){var i=0,s=d.length,f,u;for(f=0;f<s;f++)i=Math.max(i,d[f].length);var h=new Array(i);for(f=0;f<i;f++)for(h[f]=new Array(s),u=0;u<s;u++)h[f][u]=d[u][f];return h},W.dot=function(d,i){if(!(d.length&&i.length)||d.length!==i.length)return null;var s=d.length,f,u;if(d[0].length)for(f=new Array(s),u=0;u<s;u++)f[u]=W.dot(d[u],i);else if(i[0].length){var h=W.transposeRagged(i);for(f=new Array(h.length),u=0;u<h.length;u++)f[u]=W.dot(d,h[u])}else for(f=0,u=0;u<s;u++)f+=d[u]*i[u];return f},W.translationMatrix=function(d,i){return[[1,0,d],[0,1,i],[0,0,1]]},W.rotationMatrix=function(d){var i=d*Math.PI/180;return[[Math.cos(i),-Math.sin(i),0],[Math.sin(i),Math.cos(i),0],[0,0,1]]},W.rotationXYMatrix=function(d,i,s){return W.dot(W.dot(W.translationMatrix(i,s),W.rotationMatrix(d)),W.translationMatrix(-i,-s))},W.apply3DTransform=function(d){return function(){var i=arguments,s=arguments.length===1?i[0]:[i[0],i[1],i[2]||0];return W.dot(d,[s[0],s[1],s[2],1]).slice(0,3)}},W.apply2DTransform=function(d){return function(){var i=arguments;i.length===3&&(i=i[0]);var s=arguments.length===1?i[0]:[i[0],i[1]];return W.dot(d,[s[0],s[1],1]).slice(0,2)}},W.apply2DTransform2=function(d){var i=W.apply2DTransform(d);return function(s){return i(s.slice(0,2)).concat(i(s.slice(2,4)))}},W.convertCssMatrix=function(d){if(d){var i=d.length;if(i===16)return d;if(i===6)return[d[0],d[1],0,0,d[2],d[3],0,0,0,0,1,0,d[4],d[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},W.inverseTransformMatrix=function(d){var i=[];return V.invert(i,d),[[i[0],i[1],i[2],i[3]],[i[4],i[5],i[6],i[7]],[i[8],i[9],i[10],i[11]],[i[12],i[13],i[14],i[15]]]}}),Mn=t((W,V)=>{var d=l(),i=Sn(),s=$n(),f=Kn();function u(C){var m;if(typeof C=="string"){if(m=document.getElementById(C),m===null)throw new Error("No DOM element with id '"+C+"' exists on the page.");return m}else if(C==null)throw new Error("DOM element provided is null or undefined");return C}function h(C){var m=d.select(C);return m.node()instanceof HTMLElement&&m.size()&&m.classed("js-plotly-plot")}function p(C){var m=C&&C.parentNode;m&&m.removeChild(C)}function v(C,m){o("global",C,m)}function o(C,m,y){var A="plotly.js-style-"+C,R=document.getElementById(A);if(!(R&&R.matches(".no-inline-styles"))){R||(R=document.createElement("style"),R.setAttribute("id",A),R.appendChild(document.createTextNode("")),document.head.appendChild(R));var N=R.sheet;N?N.insertRule?N.insertRule(m+"{"+y+"}",0):N.addRule?N.addRule(m,y,0):i.warn("addStyleRule failed"):i.warn("Cannot addRelatedStyleRule, probably due to strict CSP...")}}function w(C){var m="plotly.js-style-"+C,y=document.getElementById(m);y&&p(y)}function g(C,m,y,A,R,N){var te=A.split(":"),H=R.split(":"),U="data-btn-style-event-added";N||(N=document),N.querySelectorAll(C).forEach(function(P){P.getAttribute(U)||(P.addEventListener("mouseenter",function(){var re=this.querySelector(y);re&&(re.style[te[0]]=te[1])}),P.addEventListener("mouseleave",function(){var re=this.querySelector(y);re&&(m&&this.matches(m)?re.style[te[0]]=te[1]:re.style[H[0]]=H[1])}),P.setAttribute(U,!0))})}function b(C){var m=S(C),y=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return m.forEach(function(A){var R=L(A);if(R){var N=s.convertCssMatrix(R);y=f.multiply(y,y,N)}}),y}function L(C){var m=window.getComputedStyle(C,null),y=m.getPropertyValue("-webkit-transform")||m.getPropertyValue("-moz-transform")||m.getPropertyValue("-ms-transform")||m.getPropertyValue("-o-transform")||m.getPropertyValue("transform");return y==="none"?null:y.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(A){return+A})}function S(C){for(var m=[];M(C);)m.push(C),C=C.parentNode,typeof ShadowRoot=="function"&&C instanceof ShadowRoot&&(C=C.host);return m}function M(C){return C&&(C instanceof Element||C instanceof HTMLElement)}function T(C,m){return C&&m&&C.top===m.top&&C.left===m.left&&C.right===m.right&&C.bottom===m.bottom}V.exports={getGraphDiv:u,isPlotDiv:h,removeElement:p,addStyleRule:v,addRelatedStyleRule:o,deleteRelatedStyleRule:w,setStyleOnHover:g,getFullTransformMatrix:b,getElementTransformMatrix:L,getElementAndAncestors:S,equalDomRects:T}}),Xn=t((W,V)=>{V.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}}),Ft=t((W,V)=>{var d=gt().extendFlat,i=_e(),s={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},f={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},u=s.flags.slice().concat(["fullReplot"]),h=f.flags.slice().concat("layoutReplot");V.exports={traces:s,layout:f,traceFlags:function(){return p(u)},layoutFlags:function(){return p(h)},update:function(w,g){var b=g.editType;if(b&&b!=="none")for(var L=b.split("+"),S=0;S<L.length;S++)w[L[S]]=!0},overrideAll:v};function p(w){for(var g={},b=0;b<w.length;b++)g[w[b]]=!1;return g}function v(w,g,b){var L=d({},w);for(var S in L){var M=L[S];i(M)&&(L[S]=o(M,g,b,S))}return b==="from-root"&&(L.editType=g),L}function o(w,g,b,L){if(w.valType){var S=d({},w);if(S.editType=g,Array.isArray(w.items)){S.items=new Array(w.items.length);for(var M=0;M<w.items.length;M++)S.items[M]=o(w.items[M],g)}return S}else return v(w,g,L.charAt(0)==="_"?"nested":"from-root")}}),Wr=t(W=>{W.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},W.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},path:{valType:"string",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}}),qt=t((W,V)=>{V.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}}),jr=t(W=>{var V=qt(),d=V.FORMAT_LINK,i=V.DATE_FORMAT_LINK;function s(u){var h=u&&u.supportOther;return["Variables are inserted using %{variable},",'for example "y: %{y}"'+(h?" as well as %{xother}, {%_xother}, {%_xother_}, {%xother_}. When showing info for several points, *xother* will be added to those with different x positions from the first point. An underscore before or after *(x|y)other* will add a space on that side, only when this field is shown.":"."),`Numbers are formatted using d3-format's syntax %{variable:d3-format}, for example "Price: %{y:$.2f}".`,d,"for details on the formatting syntax.",`Dates are formatted using d3-time-format's syntax %{variable|d3-time-format}, for example "Day: %{2019-01-01|%A}".`,i,"for details on the date formatting syntax."].join(" ")}W.templateFormatStringDescription=s;function f(u){var h=u.description?" "+u.description:"",p=u.keys||[];if(p.length>0){for(var v=[],o=0;o<p.length;o++)v[o]="`"+p[o]+"`";h=h+"Finally, the template string has access to ",p.length===1?h=h+"variable "+v[0]:h=h+"variables "+v.slice(0,-1).join(", ")+" and "+v.slice(-1)+"."}return h}W.hovertemplateAttrs=function(u,h){u=u||{},h=h||{},f(h);var p={valType:"string",dflt:"",editType:u.editType||"none"};return u.arrayOk!==!1&&(p.arrayOk=!0),p},W.texttemplateAttrs=function(u,h){u=u||{},h=h||{},f(h);var p={valType:"string",dflt:"",editType:u.editType||"calc"};return u.arrayOk!==!1&&(p.arrayOk=!0),p},W.shapeTexttemplateAttrs=function(u,h){u=u||{},h=h||{},u.newshape,f(h);var p={valType:"string",dflt:"",editType:u.editType||"arraydraw"};return p}}),mr=t((W,V)=>{function d(y,A){return A?A.d2l(y):y}function i(y,A){return A?A.l2d(y):y}function s(y){return y.x0}function f(y){return y.x1}function u(y){return y.y0}function h(y){return y.y1}function p(y){return y.x0shift||0}function v(y){return y.x1shift||0}function o(y){return y.y0shift||0}function w(y){return y.y1shift||0}function g(y,A){return d(y.x1,A)+v(y)-d(y.x0,A)-p(y)}function b(y,A,R){return d(y.y1,R)+w(y)-d(y.y0,R)-o(y)}function L(y,A){return Math.abs(g(y,A))}function S(y,A,R){return Math.abs(b(y,A,R))}function M(y,A,R){return y.type!=="line"?void 0:Math.sqrt(Math.pow(g(y,A),2)+Math.pow(b(y,A,R),2))}function T(y,A){return i((d(y.x1,A)+v(y)+d(y.x0,A)+p(y))/2,A)}function C(y,A,R){return i((d(y.y1,R)+w(y)+d(y.y0,R)+o(y))/2,R)}function m(y,A,R){return y.type!=="line"?void 0:b(y,A,R)/g(y,A)}V.exports={x0:s,x1:f,y0:u,y1:h,slope:m,dx:g,dy:b,width:L,height:S,length:M,xcenter:T,ycenter:C}}),Nr=t((W,V)=>{var d=Ft().overrideAll,i=nt(),s=pt(),f=Wr().dash,u=gt().extendFlat,h=jr().shapeTexttemplateAttrs,p=mr();V.exports=d({newshape:{visible:u({},i.visible,{}),showlegend:{valType:"boolean",dflt:!1},legend:u({},i.legend,{}),legendgroup:u({},i.legendgroup,{}),legendgrouptitle:{text:u({},i.legendgrouptitle.text,{}),font:s({})},legendrank:u({},i.legendrank,{}),legendwidth:u({},i.legendwidth,{}),line:{color:{valType:"color"},width:{valType:"number",min:0,dflt:4},dash:u({},f,{dflt:"solid"})},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd"},opacity:{valType:"number",min:0,max:1,dflt:1},layer:{valType:"enumerated",values:["below","above","between"],dflt:"above"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal"},name:u({},i.name,{}),label:{text:{valType:"string",dflt:""},texttemplate:h({newshape:!0},{keys:Object.keys(p)}),font:s({}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right","start","middle","end"]},textangle:{valType:"angle",dflt:"auto"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto"},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},padding:{valType:"number",dflt:3,min:0}}},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)"},opacity:{valType:"number",min:0,max:1,dflt:.5}}},"none","from-root")}),cn=t((W,V)=>{var d=Wr().dash,i=gt().extendFlat;V.exports={newselection:{mode:{valType:"enumerated",values:["immediate","gradual"],dflt:"immediate",editType:"none"},line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:1,dflt:1,editType:"none"},dash:i({},d,{dflt:"dot",editType:"none"}),editType:"none"},editType:"none"},activeselection:{fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}}),nn=t((W,V)=>{V.exports=function(d){var i=d.editType;return{t:{valType:"number",dflt:0,editType:i},r:{valType:"number",dflt:0,editType:i},b:{valType:"number",dflt:0,editType:i},l:{valType:"number",dflt:0,editType:i},editType:i}}}),Sa=t((W,V)=>{var d=pt(),i=Xn(),s=Zt(),f=Nr(),u=cn(),h=nn(),p=gt().extendFlat,v=d({editType:"calc"});v.family.dflt='"Open Sans", verdana, arial, sans-serif',v.size.dflt=12,v.color.dflt=s.defaultLine,V.exports={font:v,title:{text:{valType:"string",editType:"layoutstyle"},font:d({editType:"layoutstyle"}),subtitle:{text:{valType:"string",editType:"layoutstyle"},font:d({editType:"layoutstyle"}),editType:"layoutstyle"},xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:p(h({editType:"layoutstyle"}),{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},minreducedwidth:{valType:"number",min:2,dflt:64,editType:"plot"},minreducedheight:{valType:"number",min:2,dflt:64,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:s.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:s.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:s.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:f.newshape,activeshape:f.activeshape,newselection:u.newselection,activeselection:u.activeselection,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:p({},i.transition,{editType:"none"})}}),Ia=t(()=>{(function(){if(!document.getElementById("ce8d464691048653ffe3a57c6c18ab566e8366f186677868cf724621a857b4fe")){var W=document.createElement("style");W.id="ce8d464691048653ffe3a57c6c18ab566e8366f186677868cf724621a857b4fe",W.textContent=`.maplibregl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgb(0 0 0/0)}.maplibregl-canvas{left:0;position:absolute;top:0}.maplibregl-map:fullscreen{height:100%;width:100%}.maplibregl-ctrl-group button.maplibregl-ctrl-compass{touch-action:none}.maplibregl-canvas-container.maplibregl-interactive,.maplibregl-ctrl-group button.maplibregl-ctrl-compass{cursor:grab;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-canvas-container.maplibregl-interactive.maplibregl-track-pointer{cursor:pointer}.maplibregl-canvas-container.maplibregl-interactive:active,.maplibregl-ctrl-group button.maplibregl-ctrl-compass:active{cursor:grabbing}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-canvas-container.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:pinch-zoom}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:none}.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures,.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-ctrl-bottom-left,.maplibregl-ctrl-bottom-right,.maplibregl-ctrl-top-left,.maplibregl-ctrl-top-right{pointer-events:none;position:absolute;z-index:2}.maplibregl-ctrl-top-left{left:0;top:0}.maplibregl-ctrl-top-right{right:0;top:0}.maplibregl-ctrl-bottom-left{bottom:0;left:0}.maplibregl-ctrl-bottom-right{bottom:0;right:0}.maplibregl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.maplibregl-ctrl-top-left .maplibregl-ctrl{float:left;margin:10px 0 0 10px}.maplibregl-ctrl-top-right .maplibregl-ctrl{float:right;margin:10px 10px 0 0}.maplibregl-ctrl-bottom-left .maplibregl-ctrl{float:left;margin:0 0 10px 10px}.maplibregl-ctrl-bottom-right .maplibregl-ctrl{float:right;margin:0 10px 10px 0}.maplibregl-ctrl-group{background:#fff;border-radius:4px}.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (forced-colors:active){.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.maplibregl-ctrl-group button{background-color:transparent;border:0;box-sizing:border-box;cursor:pointer;display:block;height:29px;outline:none;padding:0;width:29px}.maplibregl-ctrl-group button+button{border-top:1px solid #ddd}.maplibregl-ctrl button .maplibregl-ctrl-icon{background-position:50%;background-repeat:no-repeat;display:block;height:100%;width:100%}@media (forced-colors:active){.maplibregl-ctrl-icon{background-color:transparent}.maplibregl-ctrl-group button+button{border-top:1px solid ButtonText}}.maplibregl-ctrl button::-moz-focus-inner{border:0;padding:0}.maplibregl-ctrl-attrib-button:focus,.maplibregl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl button:disabled{cursor:not-allowed}.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon{opacity:.25}.maplibregl-ctrl button:not(:disabled):hover{background-color:rgb(0 0 0/5%)}.maplibregl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.maplibregl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.maplibregl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.maplibregl-ctrl-group button:focus:only-child{border-radius:inherit}.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5'/%3E%3C/svg%3E")}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5'/%3E%3C/svg%3E")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5'/%3E%3C/svg%3E")}}.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z'/%3E%3C/svg%3E")}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z'/%3E%3C/svg%3E")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z'/%3E%3C/svg%3E")}}.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8z'/%3E%3C/svg%3E")}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8z'/%3E%3C/svg%3E")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8z'/%3E%3C/svg%3E")}}.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%23333' viewBox='0 0 22 22'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%2333b5e5' viewBox='0 0 22 22'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23aaa' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon{animation:maplibregl-spin 2s linear infinite}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23999' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23666' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1z'/%3E%3C/svg%3E")}}@keyframes maplibregl-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}a.maplibregl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z'/%3E%3Cpath d='M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z' style='fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001'/%3E%3Cg style='stroke-width:1.12603545'%3E%3Cpath d='M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668' style='color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3' style='clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z' style='clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3C/g%3E%3C/svg%3E");background-repeat:no-repeat;cursor:pointer;display:block;height:23px;margin:0 0 -4px -4px;overflow:hidden;width:88px}a.maplibregl-ctrl-logo.maplibregl-compact{width:14px}@media (forced-colors:active){a.maplibregl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z'/%3E%3Cpath d='M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z' style='fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001'/%3E%3Cg style='stroke-width:1.12603545'%3E%3Cpath d='M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668' style='color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3' style='clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z' style='clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3C/g%3E%3C/svg%3E")}}@media (forced-colors:active) and (prefers-color-scheme:light){a.maplibregl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z'/%3E%3Cpath d='M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z' style='fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001'/%3E%3Cg style='stroke-width:1.12603545'%3E%3Cpath d='M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668' style='color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3' style='clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z' style='clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3C/g%3E%3C/svg%3E")}}.maplibregl-ctrl.maplibregl-ctrl-attrib{background-color:hsla(0,0%,100%,.5);margin:0;padding:0 5px}@media screen{.maplibregl-ctrl-attrib.maplibregl-compact{background-color:#fff;border-radius:12px;box-sizing:content-box;color:#000;margin:10px;min-height:20px;padding:2px 24px 2px 0;position:relative}.maplibregl-ctrl-attrib.maplibregl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact-show,.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact-show{border-radius:12px;padding:2px 8px 2px 28px}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-inner{display:none}.maplibregl-ctrl-attrib-button{background-color:hsla(0,0%,100%,.5);background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E");border:0;border-radius:12px;box-sizing:border-box;cursor:pointer;display:none;height:24px;outline:none;position:absolute;right:0;top:0;width:24px}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;list-style:none}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button::-webkit-details-marker{display:none}.maplibregl-ctrl-bottom-left .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-top-left .maplibregl-ctrl-attrib-button{left:0}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-inner{display:block}.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-button{background-color:rgb(0 0 0/5%)}.maplibregl-ctrl-bottom-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;right:0}.maplibregl-ctrl-top-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{right:0;top:0}.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{left:0;top:0}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;left:0}}@media screen and (forced-colors:active){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='%23fff' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E")}}@media screen and (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E")}}.maplibregl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.maplibregl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.maplibregl-attrib-empty{display:none}.maplibregl-ctrl-scale{background-color:hsla(0,0%,100%,.75);border:2px solid #333;border-top:#333;box-sizing:border-box;color:#333;font-size:10px;padding:0 5px}.maplibregl-popup{display:flex;left:0;pointer-events:none;position:absolute;top:0;will-change:transform}.maplibregl-popup-anchor-top,.maplibregl-popup-anchor-top-left,.maplibregl-popup-anchor-top-right{flex-direction:column}.maplibregl-popup-anchor-bottom,.maplibregl-popup-anchor-bottom-left,.maplibregl-popup-anchor-bottom-right{flex-direction:column-reverse}.maplibregl-popup-anchor-left{flex-direction:row}.maplibregl-popup-anchor-right{flex-direction:row-reverse}.maplibregl-popup-tip{border:10px solid transparent;height:0;width:0;z-index:1}.maplibregl-popup-anchor-top .maplibregl-popup-tip{align-self:center;border-bottom-color:#fff;border-top:none}.maplibregl-popup-anchor-top-left .maplibregl-popup-tip{align-self:flex-start;border-bottom-color:#fff;border-left:none;border-top:none}.maplibregl-popup-anchor-top-right .maplibregl-popup-tip{align-self:flex-end;border-bottom-color:#fff;border-right:none;border-top:none}.maplibregl-popup-anchor-bottom .maplibregl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.maplibregl-popup-anchor-left .maplibregl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.maplibregl-popup-anchor-right .maplibregl-popup-tip{align-self:center;border-left-color:#fff;border-right:none}.maplibregl-popup-close-button{background-color:transparent;border:0;border-radius:0 3px 0 0;cursor:pointer;position:absolute;right:0;top:0}.maplibregl-popup-close-button:hover{background-color:rgb(0 0 0/5%)}.maplibregl-popup-content{background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:15px 10px;pointer-events:auto;position:relative}.maplibregl-popup-anchor-top-left .maplibregl-popup-content{border-top-left-radius:0}.maplibregl-popup-anchor-top-right .maplibregl-popup-content{border-top-right-radius:0}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-content{border-bottom-left-radius:0}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-content{border-bottom-right-radius:0}.maplibregl-popup-track-pointer{display:none}.maplibregl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-map:hover .maplibregl-popup-track-pointer{display:flex}.maplibregl-map:active .maplibregl-popup-track-pointer{display:none}.maplibregl-marker{left:0;position:absolute;top:0;transition:opacity .2s;will-change:transform}.maplibregl-user-location-dot,.maplibregl-user-location-dot:before{background-color:#1da1f2;border-radius:50%;height:15px;width:15px}.maplibregl-user-location-dot:before{animation:maplibregl-user-location-dot-pulse 2s infinite;content:"";position:absolute}.maplibregl-user-location-dot:after{border:2px solid #fff;border-radius:50%;box-shadow:0 0 3px rgba(0,0,0,.35);box-sizing:border-box;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px}@keyframes maplibregl-user-location-dot-pulse{0%{opacity:1;transform:scale(1)}70%{opacity:0;transform:scale(3)}to{opacity:0;transform:scale(1)}}.maplibregl-user-location-dot-stale{background-color:#aaa}.maplibregl-user-location-dot-stale:after{display:none}.maplibregl-user-location-accuracy-circle{background-color:#1da1f233;border-radius:100%;height:1px;width:1px}.maplibregl-crosshair,.maplibregl-crosshair .maplibregl-interactive,.maplibregl-crosshair .maplibregl-interactive:active{cursor:crosshair}.maplibregl-boxzoom{background:#fff;border:2px dotted #202020;height:0;left:0;opacity:.5;position:absolute;top:0;width:0}.maplibregl-cooperative-gesture-screen{align-items:center;background:rgba(0,0,0,.4);color:#fff;display:flex;font-size:1.4em;inset:0;justify-content:center;line-height:1.2;opacity:0;padding:1rem;pointer-events:none;position:absolute;transition:opacity 1s ease 1s;z-index:99999}.maplibregl-cooperative-gesture-screen.maplibregl-show{opacity:1;transition:opacity .05s}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:none}@media (hover:none),(width <= 480px){.maplibregl-cooperative-gesture-screen .maplibregl-desktop-message{display:none}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:block}}.maplibregl-pseudo-fullscreen{height:100%!important;left:0!important;position:fixed!important;top:0!important;width:100%!important;z-index:99999}`,document.head.appendChild(W)}})()}),an=t(W=>{var V=Sn(),d=Wn(),i=Ma(),s=_e(),f=Mn().addStyleRule,u=gt(),h=nt(),p=Sa(),v=u.extendFlat,o=u.extendDeepAll;W.modules={},W.allCategories={},W.allTypes=[],W.subplotsRegistry={},W.componentsRegistry={},W.layoutArrayContainers=[],W.layoutArrayRegexes=[],W.traceLayoutAttributes={},W.localeRegistry={},W.apiMethodRegistry={},W.collectableSubplotTypes=null,W.register=function(y){if(W.collectableSubplotTypes=null,y)y&&!Array.isArray(y)&&(y=[y]);else throw new Error("No argument passed to Plotly.register.");for(var A=0;A<y.length;A++){var R=y[A];if(!R)throw new Error("Invalid module was attempted to be registered!");switch(R.moduleType){case"trace":w(R);break;case"transform":L(R);break;case"component":b(R);break;case"locale":S(R);break;case"apiMethod":var N=R.name;W.apiMethodRegistry[N]=R.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},W.getModule=function(y){var A=W.modules[m(y)];return A?A._module:!1},W.traceIs=function(y,A){if(y=m(y),y==="various")return!1;var R=W.modules[y];return R||(y&&V.log("Unrecognized trace type "+y+"."),R=W.modules[h.type.dflt]),!!R.categories[A]},W.getComponentMethod=function(y,A){var R=W.componentsRegistry[y];return R&&R[A]||d},W.call=function(){var y=arguments[0],A=[].slice.call(arguments,1);return W.apiMethodRegistry[y].apply(null,A)};function w(y){var A=y.name,R=y.categories,N=y.meta;if(W.modules[A]){V.log("Type "+A+" already registered");return}W.subplotsRegistry[y.basePlotModule.name]||g(y.basePlotModule);for(var te={},H=0;H<R.length;H++)te[R[H]]=!0,W.allCategories[R[H]]=!0;W.modules[A]={_module:y,categories:te},N&&Object.keys(N).length&&(W.modules[A].meta=N),W.allTypes.push(A);for(var U in W.componentsRegistry)T(U,A);y.layoutAttributes&&v(W.traceLayoutAttributes,y.layoutAttributes);var P=y.basePlotModule,re=P.name;if(re==="mapbox"){var G=P.constants.styleRules;for(var Z in G)f(".js-plotly-plot .plotly .mapboxgl-"+Z,G[Z])}re==="map"&&Ia(),(re==="geo"||re==="mapbox"||re==="map")&&window.PlotlyGeoAssets===void 0&&(window.PlotlyGeoAssets={topojson:{}})}function g(y){var A=y.name;if(W.subplotsRegistry[A]){V.log("Plot type "+A+" already registered.");return}M(y),W.subplotsRegistry[A]=y;for(var R in W.componentsRegistry)C(R,y.name)}function b(y){if(typeof y.name!="string")throw new Error("Component module *name* must be a string.");var A=y.name;W.componentsRegistry[A]=y,y.layoutAttributes&&(y.layoutAttributes._isLinkedToArray&&i(W.layoutArrayContainers,A),M(y));for(var R in W.modules)T(A,R);for(var N in W.subplotsRegistry)C(A,N);y.schema&&y.schema.layout&&o(p,y.schema.layout)}function L(y){if(typeof y.name!="string")throw new Error("Transform module *name* must be a string.");var A="Transform module "+y.name,R=typeof y.transform=="function",N=typeof y.calcTransform=="function";if(!R&&!N)throw new Error(A+" is missing a *transform* or *calcTransform* method.");R&&N&&V.log([A+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),s(y.attributes)||V.log(A+" registered without an *attributes* object."),typeof y.supplyDefaults!="function"&&V.log(A+" registered without a *supplyDefaults* method.")}function S(y){var A=y.name,R=A.split("-")[0],N=y.dictionary,te=y.format,H=N&&Object.keys(N).length,U=te&&Object.keys(te).length,P=W.localeRegistry,re=P[A];if(re||(P[A]=re={}),R!==A){var G=P[R];G||(P[R]=G={}),H&&G.dictionary===re.dictionary&&(G.dictionary=N),U&&G.format===re.format&&(G.format=te)}H&&(re.dictionary=N),U&&(re.format=te)}function M(y){if(y.layoutAttributes){var A=y.layoutAttributes._arrayAttrRegexps;if(A)for(var R=0;R<A.length;R++)i(W.layoutArrayRegexes,A[R])}}function T(y,A){var R=W.componentsRegistry[y].schema;if(!(!R||!R.traces)){var N=R.traces[A];N&&o(W.modules[A]._module.attributes,N)}}function C(y,A){var R=W.componentsRegistry[y].schema;if(!(!R||!R.subplots)){var N=W.subplotsRegistry[A],te=N.layoutAttributes,H=N.attr==="subplot"?N.name:N.attr;Array.isArray(H)&&(H=H[0]);var U=R.subplots[H];te&&U&&o(te,U)}}function m(y){return typeof y=="object"&&(y=y.type),y}}),xa=t(W=>{var V=_().timeFormat,d=q(),i=Sn(),s=$e().mod,f=oe(),u=f.BADNUM,h=f.ONEDAY,p=f.ONEHOUR,v=f.ONEMIN,o=f.ONESEC,w=f.EPOCHJD,g=an(),b=_().utcFormat,L=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,S=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,M=new Date().getFullYear()-70;function T(ne){return ne&&g.componentsRegistry.calendars&&typeof ne=="string"&&ne!=="gregorian"}W.dateTick0=function(ne,ae){var B=C(ne,!!ae);if(ae<2)return B;var ie=W.dateTime2ms(B,ne);return ie+=h*(ae-1),W.ms2DateTime(ie,0,ne)};function C(ne,ae){return T(ne)?ae?g.getComponentMethod("calendars","CANONICAL_SUNDAY")[ne]:g.getComponentMethod("calendars","CANONICAL_TICK")[ne]:ae?"2000-01-02":"2000-01-01"}W.dfltRange=function(ne){return T(ne)?g.getComponentMethod("calendars","DFLTRANGE")[ne]:["2000-01-01","2001-01-01"]},W.isJSDate=function(ne){return typeof ne=="object"&&ne!==null&&typeof ne.getTime=="function"};var m,y;W.dateTime2ms=function(ne,ae){if(W.isJSDate(ne)){var B=ne.getTimezoneOffset()*v,ie=(ne.getUTCMinutes()-ne.getMinutes())*v+(ne.getUTCSeconds()-ne.getSeconds())*o+(ne.getUTCMilliseconds()-ne.getMilliseconds());if(ie){var se=3*v;B=B-se/2+s(ie-B+se/2,se)}return ne=Number(ne)-B,ne>=m&&ne<=y?ne:u}if(typeof ne!="string"&&typeof ne!="number")return u;ne=String(ne);var ye=T(ae),me=ne.charAt(0);ye&&(me==="G"||me==="g")&&(ne=ne.substr(1),ae="");var xe=ye&&ae.substr(0,7)==="chinese",Re=ne.match(xe?S:L);if(!Re)return u;var ke=Re[1],Ie=Re[3]||"1",Q=Number(Re[5]||1),ee=Number(Re[7]||0),D=Number(Re[9]||0),le=Number(Re[11]||0);if(ye){if(ke.length===2)return u;ke=Number(ke);var ge;try{var j=g.getComponentMethod("calendars","getCal")(ae);if(xe){var k=Ie.charAt(Ie.length-1)==="i";Ie=parseInt(Ie,10),ge=j.newDate(ke,j.toMonthIndex(ke,Ie,k),Q)}else ge=j.newDate(ke,Number(Ie),Q)}catch{return u}return ge?(ge.toJD()-w)*h+ee*p+D*v+le*o:u}ke.length===2?ke=(Number(ke)+2e3-M)%100+M:ke=Number(ke),Ie-=1;var F=new Date(Date.UTC(2e3,Ie,Q,ee,D));return F.setUTCFullYear(ke),F.getUTCMonth()!==Ie||F.getUTCDate()!==Q?u:F.getTime()+le*o},m=W.MIN_MS=W.dateTime2ms("-9999"),y=W.MAX_MS=W.dateTime2ms("9999-12-31 23:59:59.9999"),W.isDateTime=function(ne,ae){return W.dateTime2ms(ne,ae)!==u};function A(ne,ae){return String(ne+Math.pow(10,ae)).substr(1)}var R=90*h,N=3*p,te=5*v;W.ms2DateTime=function(ne,ae,B){if(typeof ne!="number"||!(ne>=m&&ne<=y))return u;ae||(ae=0);var ie=Math.floor(s(ne+.05,1)*10),se=Math.round(ne-ie/10),ye,me,xe,Re,ke,Ie;if(T(B)){var Q=Math.floor(se/h)+w,ee=Math.floor(s(ne,h));try{ye=g.getComponentMethod("calendars","getCal")(B).fromJD(Q).formatDate("yyyy-mm-dd")}catch{ye=b("G%Y-%m-%d")(new Date(se))}if(ye.charAt(0)==="-")for(;ye.length<11;)ye="-0"+ye.substr(1);else for(;ye.length<10;)ye="0"+ye;me=ae<R?Math.floor(ee/p):0,xe=ae<R?Math.floor(ee%p/v):0,Re=ae<N?Math.floor(ee%v/o):0,ke=ae<te?ee%o*10+ie:0}else Ie=new Date(se),ye=b("%Y-%m-%d")(Ie),me=ae<R?Ie.getUTCHours():0,xe=ae<R?Ie.getUTCMinutes():0,Re=ae<N?Ie.getUTCSeconds():0,ke=ae<te?Ie.getUTCMilliseconds()*10+ie:0;return H(ye,me,xe,Re,ke)},W.ms2DateTimeLocal=function(ne){if(!(ne>=m+h&&ne<=y-h))return u;var ae=Math.floor(s(ne+.05,1)*10),B=new Date(Math.round(ne-ae/10)),ie=V("%Y-%m-%d")(B),se=B.getHours(),ye=B.getMinutes(),me=B.getSeconds(),xe=B.getUTCMilliseconds()*10+ae;return H(ie,se,ye,me,xe)};function H(ne,ae,B,ie,se){if((ae||B||ie||se)&&(ne+=" "+A(ae,2)+":"+A(B,2),(ie||se)&&(ne+=":"+A(ie,2),se))){for(var ye=4;se%10===0;)ye-=1,se/=10;ne+="."+A(se,ye)}return ne}W.cleanDate=function(ne,ae,B){if(ne===u)return ae;if(W.isJSDate(ne)||typeof ne=="number"&&isFinite(ne)){if(T(B))return i.error("JS Dates and milliseconds are incompatible with world calendars",ne),ae;if(ne=W.ms2DateTimeLocal(+ne),!ne&&ae!==void 0)return ae}else if(!W.isDateTime(ne,B))return i.error("unrecognized date",ne),ae;return ne};var U=/%\d?f/g,P=/%h/g,re={1:"1",2:"1",3:"2",4:"2"};function G(ne,ae,B,ie){ne=ne.replace(U,function(ye){var me=Math.min(+ye.charAt(1)||6,6),xe=(ae/1e3%1+2).toFixed(me).substr(2).replace(/0+$/,"")||"0";return xe});var se=new Date(Math.floor(ae+.05));if(ne=ne.replace(P,function(){return re[B("%q")(se)]}),T(ie))try{ne=g.getComponentMethod("calendars","worldCalFmt")(ne,ae,ie)}catch{return"Invalid"}return B(ne)(se)}var Z=[59,59.9,59.99,59.999,59.9999];function Y(ne,ae){var B=s(ne+.05,h),ie=A(Math.floor(B/p),2)+":"+A(s(Math.floor(B/v),60),2);if(ae!=="M"){d(ae)||(ae=0);var se=Math.min(s(ne/o,60),Z[ae]),ye=(100+se).toFixed(ae).substr(1);ae>0&&(ye=ye.replace(/0+$/,"").replace(/[\.]$/,"")),ie+=":"+ye}return ie}W.formatDate=function(ne,ae,B,ie,se,ye){if(se=T(se)&&se,!ae)if(B==="y")ae=ye.year;else if(B==="m")ae=ye.month;else if(B==="d")ae=ye.dayMonth+`
`+ye.year;else return Y(ne,B)+`
`+G(ye.dayMonthYear,ne,ie,se);return G(ae,ne,ie,se)};var X=3*h;W.incrementMonth=function(ne,ae,B){B=T(B)&&B;var ie=s(ne,h);if(ne=Math.round(ne-ie),B)try{var se=Math.round(ne/h)+w,ye=g.getComponentMethod("calendars","getCal")(B),me=ye.fromJD(se);return ae%12?ye.add(me,ae,"m"):ye.add(me,ae/12,"y"),(me.toJD()-w)*h+ie}catch{i.error("invalid ms "+ne+" in calendar "+B)}var xe=new Date(ne+X);return xe.setUTCMonth(xe.getUTCMonth()+ae)+ie-X},W.findExactDates=function(ne,ae){for(var B=0,ie=0,se=0,ye=0,me,xe,Re=T(ae)&&g.getComponentMethod("calendars","getCal")(ae),ke=0;ke<ne.length;ke++){if(xe=ne[ke],!d(xe)){ye++;continue}if(!(xe%h))if(Re)try{me=Re.fromJD(xe/h+w),me.day()===1?me.month()===1?B++:ie++:se++}catch{}else me=new Date(xe),me.getUTCDate()===1?me.getUTCMonth()===0?B++:ie++:se++}ie+=B,se+=ie;var Ie=ne.length-ye;return{exactYears:B/Ie,exactMonths:ie/Ie,exactDays:se/Ie}}}),hi=t((W,V)=>{V.exports=function(d){return d}}),Ka=t(W=>{var V=q(),d=Sn(),i=hi(),s=oe().BADNUM,f=1e-9;W.findBin=function(o,w,g){if(V(w.start))return g?Math.ceil((o-w.start)/w.size-f)-1:Math.floor((o-w.start)/w.size+f);var b=0,L=w.length,S=0,M=L>1?(w[L-1]-w[0])/(L-1):1,T,C;for(M>=0?C=g?u:h:C=g?v:p,o+=M*f*(g?-1:1)*(M>=0?1:-1);b<L&&S++<100;)T=Math.floor((b+L)/2),C(w[T],o)?b=T+1:L=T;return S>90&&d.log("Long binary search..."),b-1};function u(o,w){return o<w}function h(o,w){return o<=w}function p(o,w){return o>w}function v(o,w){return o>=w}W.sorterAsc=function(o,w){return o-w},W.sorterDes=function(o,w){return w-o},W.distinctVals=function(o){var w=o.slice();w.sort(W.sorterAsc);var g;for(g=w.length-1;g>-1&&w[g]===s;g--);for(var b=w[g]-w[0]||1,L=b/(g||1)/1e4,S=[],M,T=0;T<=g;T++){var C=w[T],m=C-M;M===void 0?(S.push(C),M=C):m>L&&(b=Math.min(b,m),S.push(C),M=C)}return{vals:S,minDiff:b}},W.roundUp=function(o,w,g){for(var b=0,L=w.length-1,S,M=0,T=g?0:1,C=g?1:0,m=g?Math.ceil:Math.floor;b<L&&M++<100;)S=m((b+L)/2),w[S]<=o?b=S+T:L=S-C;return w[b]},W.sort=function(o,w){for(var g=0,b=0,L=1;L<o.length;L++){var S=w(o[L],o[L-1]);if(S<0?g=1:S>0&&(b=1),g&&b)return o.sort(w)}return b?o:o.reverse()},W.findIndexOfMin=function(o,w){w=w||i;for(var g=1/0,b,L=0;L<o.length;L++){var S=w(o[L]);S<g&&(g=S,b=L)}return b}}),Oo=t((W,V)=>{V.exports=function(d){return Object.keys(d).sort()}}),ql=t(W=>{var V=q(),d=be().isArrayOrTypedArray;W.aggNums=function(i,s,f,u){var h,p;if((!u||u>f.length)&&(u=f.length),V(s)||(s=!1),d(f[0])){for(p=new Array(u),h=0;h<u;h++)p[h]=W.aggNums(i,s,f[h]);f=p}for(h=0;h<u;h++)V(s)?V(f[h])&&(s=i(+s,+f[h])):s=f[h];return s},W.len=function(i){return W.aggNums(function(s){return s+1},0,i)},W.mean=function(i,s){return s||(s=W.len(i)),W.aggNums(function(f,u){return f+u},0,i)/s},W.geometricMean=function(i,s){return s||(s=W.len(i)),Math.pow(W.aggNums(function(f,u){return f*u},1,i),1/s)},W.midRange=function(i){if(!(i===void 0||i.length===0))return(W.aggNums(Math.max,null,i)+W.aggNums(Math.min,null,i))/2},W.variance=function(i,s,f){return s||(s=W.len(i)),V(f)||(f=W.mean(i,s)),W.aggNums(function(u,h){return u+Math.pow(h-f,2)},0,i)/s},W.stdev=function(i,s,f){return Math.sqrt(W.variance(i,s,f))},W.median=function(i){var s=i.slice().sort();return W.interp(s,.5)},W.interp=function(i,s){if(!V(s))throw"n should be a finite number";if(s=s*i.length-.5,s<0)return i[0];if(s>i.length-1)return i[i.length-1];var f=s%1;return f*i[Math.ceil(s)]+(1-f)*i[Math.floor(s)]}}),Go=t((W,V)=>{var d=$e(),i=d.mod,s=d.modHalf,f=Math.PI,u=2*f;function h(C){return C/180*f}function p(C){return C/f*180}function v(C){return Math.abs(C[1]-C[0])>u-1e-14}function o(C,m){return s(m-C,u)}function w(C,m){return Math.abs(o(C,m))}function g(C,m){if(v(m))return!0;var y,A;m[0]<m[1]?(y=m[0],A=m[1]):(y=m[1],A=m[0]),y=i(y,u),A=i(A,u),y>A&&(A+=u);var R=i(C,u),N=R+u;return R>=y&&R<=A||N>=y&&N<=A}function b(C,m,y,A){if(!g(m,A))return!1;var R,N;return y[0]<y[1]?(R=y[0],N=y[1]):(R=y[1],N=y[0]),C>=R&&C<=N}function L(C,m,y,A,R,N,te){R=R||0,N=N||0;var H=v([y,A]),U,P,re,G,Z;H?(U=0,P=f,re=u):y<A?(U=y,re=A):(U=A,re=y),C<m?(G=C,Z=m):(G=m,Z=C);function Y(B,ie){return[B*Math.cos(ie)+R,N-B*Math.sin(ie)]}var X=Math.abs(re-U)<=f?0:1;function ne(B,ie,se){return"A"+[B,B]+" "+[0,X,se]+" "+Y(B,ie)}var ae;return H?G===null?ae="M"+Y(Z,U)+ne(Z,P,0)+ne(Z,re,0)+"Z":ae="M"+Y(G,U)+ne(G,P,0)+ne(G,re,0)+"ZM"+Y(Z,U)+ne(Z,P,1)+ne(Z,re,1)+"Z":G===null?(ae="M"+Y(Z,U)+ne(Z,re,0),te&&(ae+="L0,0Z")):ae="M"+Y(G,U)+"L"+Y(Z,U)+ne(Z,re,0)+"L"+Y(G,re)+ne(G,U,1)+"Z",ae}function S(C,m,y,A,R){return L(null,C,m,y,A,R,0)}function M(C,m,y,A,R){return L(null,C,m,y,A,R,1)}function T(C,m,y,A,R,N){return L(C,m,y,A,R,N,1)}V.exports={deg2rad:h,rad2deg:p,angleDelta:o,angleDist:w,isFullCircle:v,isAngleInsideSector:g,isPtInsideSector:b,pathArc:S,pathSector:M,pathAnnulus:T}}),pl=t(W=>{W.isLeftAnchor=function(V){return V.xanchor==="left"||V.xanchor==="auto"&&V.x<=1/3},W.isCenterAnchor=function(V){return V.xanchor==="center"||V.xanchor==="auto"&&V.x>1/3&&V.x<2/3},W.isRightAnchor=function(V){return V.xanchor==="right"||V.xanchor==="auto"&&V.x>=2/3},W.isTopAnchor=function(V){return V.yanchor==="top"||V.yanchor==="auto"&&V.y>=2/3},W.isMiddleAnchor=function(V){return V.yanchor==="middle"||V.yanchor==="auto"&&V.y>1/3&&V.y<2/3},W.isBottomAnchor=function(V){return V.yanchor==="bottom"||V.yanchor==="auto"&&V.y<=1/3}}),Jl=t(W=>{var V=$e().mod;W.segmentsIntersect=d;function d(h,p,v,o,w,g,b,L){var S=v-h,M=w-h,T=b-w,C=o-p,m=g-p,y=L-g,A=S*y-T*C;if(A===0)return null;var R=(M*y-T*m)/A,N=(M*C-S*m)/A;return N<0||N>1||R<0||R>1?null:{x:h+S*R,y:p+C*R}}W.segmentDistance=function(h,p,v,o,w,g,b,L){if(d(h,p,v,o,w,g,b,L))return 0;var S=v-h,M=o-p,T=b-w,C=L-g,m=S*S+M*M,y=T*T+C*C,A=Math.min(i(S,M,m,w-h,g-p),i(S,M,m,b-h,L-p),i(T,C,y,h-w,p-g),i(T,C,y,v-w,o-g));return Math.sqrt(A)};function i(h,p,v,o,w){var g=o*h+w*p;if(g<0)return o*o+w*w;if(g>v){var b=o-h,L=w-p;return b*b+L*L}else{var S=o*p-w*h;return S*S/v}}var s,f,u;W.getTextLocation=function(h,p,v,o){if((h!==f||o!==u)&&(s={},f=h,u=o),s[v])return s[v];var w=h.getPointAtLength(V(v-o/2,p)),g=h.getPointAtLength(V(v+o/2,p)),b=Math.atan((g.y-w.y)/(g.x-w.x)),L=h.getPointAtLength(V(v,p)),S=(L.x*4+w.x+g.x)/6,M=(L.y*4+w.y+g.y)/6,T={x:S,y:M,theta:b};return s[v]=T,T},W.clearLocationCache=function(){f=null},W.getVisibleSegment=function(h,p,v){var o=p.left,w=p.right,g=p.top,b=p.bottom,L=0,S=h.getTotalLength(),M=S,T,C;function m(A){var R=h.getPointAtLength(A);A===0?T=R:A===S&&(C=R);var N=R.x<o?o-R.x:R.x>w?R.x-w:0,te=R.y<g?g-R.y:R.y>b?R.y-b:0;return Math.sqrt(N*N+te*te)}for(var y=m(L);y;){if(L+=y+v,L>M)return;y=m(L)}for(y=m(M);y;){if(M-=y+v,L>M)return;y=m(M)}return{min:L,max:M,len:M-L,total:S,isClosed:L===0&&M===S&&Math.abs(T.x-C.x)<.1&&Math.abs(T.y-C.y)<.1}},W.findPointOnPath=function(h,p,v,o){o=o||{};for(var w=o.pathLength||h.getTotalLength(),g=o.tolerance||.001,b=o.iterationLimit||30,L=h.getPointAtLength(0)[v]>h.getPointAtLength(w)[v]?-1:1,S=0,M=0,T=w,C,m,y;S<b;){if(C=(M+T)/2,m=h.getPointAtLength(C),y=m[v]-p,Math.abs(y)<g)return m;L*y>0?T=C:M=C,S++}return m}}),Ao=t(W=>{var V={};W.throttle=function(i,s,f){var u=V[i],h=Date.now();if(!u){for(var p in V)V[p].ts<h-6e4&&delete V[p];u=V[i]={ts:0,timer:null}}d(u);function v(){f(),u.ts=Date.now(),u.onDone&&(u.onDone(),u.onDone=null)}if(h>u.ts+s){v();return}u.timer=setTimeout(function(){v(),u.timer=null},s)},W.done=function(i){var s=V[i];return!s||!s.timer?Promise.resolve():new Promise(function(f){var u=s.onDone;s.onDone=function(){u&&u(),f(),s.onDone=null}})},W.clear=function(i){if(i)d(V[i]),delete V[i];else for(var s in V)W.clear(s)};function d(i){i&&i.timer!==null&&(clearTimeout(i.timer),i.timer=null)}}),Fs=t((W,V)=>{V.exports=function(d){d._responsiveChartHandler&&(window.removeEventListener("resize",d._responsiveChartHandler),delete d._responsiveChartHandler)}}),Xl=t((W,V)=>{V.exports=f,V.exports.isMobile=f,V.exports.default=f;var d=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser.*mobile|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,i=/CrOS/,s=/android|ipad|playbook|silk/i;function f(u){u||(u={});let h=u.ua;if(!h&&typeof navigator<"u"&&(h=navigator.userAgent),h&&h.headers&&typeof h.headers["user-agent"]=="string"&&(h=h.headers["user-agent"]),typeof h!="string")return!1;let p=d.test(h)&&!i.test(h)||!!u.tablet&&s.test(h);return!p&&u.tablet&&u.featureDetect&&navigator&&navigator.maxTouchPoints>1&&h.indexOf("Macintosh")!==-1&&h.indexOf("Safari")!==-1&&(p=!0),p}}),Us=t((W,V)=>{var d=q(),i=Xl();V.exports=function(f){var u;if(f&&f.hasOwnProperty("userAgent")?u=f.userAgent:u=s(),typeof u!="string")return!0;var h=i({ua:{headers:{"user-agent":u}},tablet:!0,featureDetect:!1});if(!h)for(var p=u.split(" "),v=1;v<p.length;v++){var o=p[v];if(o.indexOf("Safari")!==-1)for(var w=v-1;w>-1;w--){var g=p[w];if(g.substr(0,8)==="Version/"){var b=g.substr(8).split(".")[0];if(d(b)&&(b=+b),b>=13)return!0}}}return h};function s(){var f;return typeof navigator<"u"&&(f=navigator.userAgent),f&&f.headers&&typeof f.headers["user-agent"]=="string"&&(f=f.headers["user-agent"]),f}}),Zl=t((W,V)=>{var d=l();V.exports=function(i,s,f){var u=i.selectAll("g."+f.replace(/\s/g,".")).data(s,function(p){return p[0].trace.uid});u.exit().remove(),u.enter().append("g").attr("class",f),u.order();var h=i.classed("rangeplot")?"nodeRangePlot3":"node3";return u.each(function(p){p[0][h]=d.select(this)}),u}}),Ql=t((W,V)=>{var d=an();V.exports=function(i,s){for(var f=i._context.locale,u=0;u<2;u++){for(var h=i._context.locales,p=0;p<2;p++){var v=(h[f]||{}).dictionary;if(v){var o=v[s];if(o)return o}h=d.localeRegistry}var w=f.split("-")[0];if(w===f)break;f=w}return s}}),rs=t((W,V)=>{V.exports=function(d){for(var i={},s=[],f=0,u=0;u<d.length;u++){var h=d[u];i[h]!==1&&(i[h]=1,s[f++]=h)}return s}}),Jc=t((W,V)=>{V.exports=function(f){for(var u=s(f)?i:d,h=[],p=0;p<f.length;p++){var v=f[p];u(v)&&h.push(v)}return h};function d(f){return f.visible===!0}function i(f){var u=f[0].trace;return u.visible===!0&&u._length!==0}function s(f){return Array.isArray(f)&&Array.isArray(f[0])&&f[0][0]&&f[0][0].trace}}),Xc=t((W,V)=>{V.exports=function(d,i){if(!i)return d;var s=1/Math.abs(i),f=s>1?(s*d+s*i)/s:d+i,u=String(f).length;if(u>16){var h=String(i).length,p=String(d).length;if(u>=p+h){var v=parseFloat(f).toPrecision(12);v.indexOf("e+")===-1&&(f=+v)}}return f}}),_t=t((W,V)=>{var d=q(),i=oe().BADNUM,s=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;V.exports=function(f){return typeof f=="string"&&(f=f.replace(s,"")),d(f)?Number(f):i}}),Mt=t((W,V)=>{var d=l(),i=_().utcFormat,s=O().format,f=q(),u=oe(),h=u.FP_SAFE,p=-h,v=u.BADNUM,o=V.exports={};o.adjustFormat=function(j){return!j||/^\d[.]\df/.test(j)||/[.]\d%/.test(j)?j:j==="0.f"?"~f":/^\d%/.test(j)?"~%":/^\ds/.test(j)?"~s":!/^[~,.0$]/.test(j)&&/[&fps]/.test(j)?"~"+j:j};var w={};o.warnBadFormat=function(j){var k=String(j);w[k]||(w[k]=1,o.warn('encountered bad format: "'+k+'"'))},o.noFormat=function(j){return String(j)},o.numberFormat=function(j){var k;try{k=s(o.adjustFormat(j))}catch{return o.warnBadFormat(j),o.noFormat}return k},o.nestedProperty=Pe(),o.keyedContainer=Se(),o.relativeAttr=Ee(),o.isPlainObject=_e(),o.toLogRange=Xe(),o.relinkPrivateKeys=qe();var g=be();o.isArrayBuffer=g.isArrayBuffer,o.isTypedArray=g.isTypedArray,o.isArrayOrTypedArray=g.isArrayOrTypedArray,o.isArray1D=g.isArray1D,o.ensureArray=g.ensureArray,o.concat=g.concat,o.maxRowLength=g.maxRowLength,o.minRowLength=g.minRowLength;var b=$e();o.mod=b.mod,o.modHalf=b.modHalf;var L=Qr();o.valObjectMeta=L.valObjectMeta,o.coerce=L.coerce,o.coerce2=L.coerce2,o.coerceFont=L.coerceFont,o.coercePattern=L.coercePattern,o.coerceHoverinfo=L.coerceHoverinfo,o.coerceSelectionMarkerOpacity=L.coerceSelectionMarkerOpacity,o.validate=L.validate;var S=xa();o.dateTime2ms=S.dateTime2ms,o.isDateTime=S.isDateTime,o.ms2DateTime=S.ms2DateTime,o.ms2DateTimeLocal=S.ms2DateTimeLocal,o.cleanDate=S.cleanDate,o.isJSDate=S.isJSDate,o.formatDate=S.formatDate,o.incrementMonth=S.incrementMonth,o.dateTick0=S.dateTick0,o.dfltRange=S.dfltRange,o.findExactDates=S.findExactDates,o.MIN_MS=S.MIN_MS,o.MAX_MS=S.MAX_MS;var M=Ka();o.findBin=M.findBin,o.sorterAsc=M.sorterAsc,o.sorterDes=M.sorterDes,o.distinctVals=M.distinctVals,o.roundUp=M.roundUp,o.sort=M.sort,o.findIndexOfMin=M.findIndexOfMin,o.sortObjectKeys=Oo();var T=ql();o.aggNums=T.aggNums,o.len=T.len,o.mean=T.mean,o.geometricMean=T.geometricMean,o.median=T.median,o.midRange=T.midRange,o.variance=T.variance,o.stdev=T.stdev,o.interp=T.interp;var C=$n();o.init2dArray=C.init2dArray,o.transposeRagged=C.transposeRagged,o.dot=C.dot,o.translationMatrix=C.translationMatrix,o.rotationMatrix=C.rotationMatrix,o.rotationXYMatrix=C.rotationXYMatrix,o.apply3DTransform=C.apply3DTransform,o.apply2DTransform=C.apply2DTransform,o.apply2DTransform2=C.apply2DTransform2,o.convertCssMatrix=C.convertCssMatrix,o.inverseTransformMatrix=C.inverseTransformMatrix;var m=Go();o.deg2rad=m.deg2rad,o.rad2deg=m.rad2deg,o.angleDelta=m.angleDelta,o.angleDist=m.angleDist,o.isFullCircle=m.isFullCircle,o.isAngleInsideSector=m.isAngleInsideSector,o.isPtInsideSector=m.isPtInsideSector,o.pathArc=m.pathArc,o.pathSector=m.pathSector,o.pathAnnulus=m.pathAnnulus;var y=pl();o.isLeftAnchor=y.isLeftAnchor,o.isCenterAnchor=y.isCenterAnchor,o.isRightAnchor=y.isRightAnchor,o.isTopAnchor=y.isTopAnchor,o.isMiddleAnchor=y.isMiddleAnchor,o.isBottomAnchor=y.isBottomAnchor;var A=Jl();o.segmentsIntersect=A.segmentsIntersect,o.segmentDistance=A.segmentDistance,o.getTextLocation=A.getTextLocation,o.clearLocationCache=A.clearLocationCache,o.getVisibleSegment=A.getVisibleSegment,o.findPointOnPath=A.findPointOnPath;var R=gt();o.extendFlat=R.extendFlat,o.extendDeep=R.extendDeep,o.extendDeepAll=R.extendDeepAll,o.extendDeepNoArrays=R.extendDeepNoArrays;var N=Sn();o.log=N.log,o.warn=N.warn,o.error=N.error;var te=cr();o.counterRegex=te.counter;var H=Ao();o.throttle=H.throttle,o.throttleDone=H.done,o.clearThrottle=H.clear;var U=Mn();o.getGraphDiv=U.getGraphDiv,o.isPlotDiv=U.isPlotDiv,o.removeElement=U.removeElement,o.addStyleRule=U.addStyleRule,o.addRelatedStyleRule=U.addRelatedStyleRule,o.deleteRelatedStyleRule=U.deleteRelatedStyleRule,o.setStyleOnHover=U.setStyleOnHover,o.getFullTransformMatrix=U.getFullTransformMatrix,o.getElementTransformMatrix=U.getElementTransformMatrix,o.getElementAndAncestors=U.getElementAndAncestors,o.equalDomRects=U.equalDomRects,o.clearResponsive=Fs(),o.preserveDrawingBuffer=Us(),o.makeTraceGroups=Zl(),o._=Ql(),o.notifier=ln(),o.filterUnique=rs(),o.filterVisible=Jc(),o.pushUnique=Ma(),o.increment=Xc(),o.cleanNumber=_t(),o.ensureNumber=function(j){return f(j)?(j=Number(j),j>h||j<p?v:j):v},o.isIndex=function(j,k){return k!==void 0&&j>=k?!1:f(j)&&j>=0&&j%1===0},o.noop=Wn(),o.identity=hi(),o.repeat=function(j,k){for(var F=new Array(k),J=0;J<k;J++)F[J]=j;return F},o.swapAttrs=function(j,k,F,J){F||(F="x"),J||(J="y");for(var K=0;K<k.length;K++){var ve=k[K],Te=o.nestedProperty(j,ve.replace("?",F)),Ae=o.nestedProperty(j,ve.replace("?",J)),Fe=Te.get();Te.set(Ae.get()),Ae.set(Fe)}},o.raiseToTop=function(j){j.parentNode.appendChild(j)},o.cancelTransition=function(j){return j.transition().duration(0)},o.constrain=function(j,k,F){return k>F?Math.max(F,Math.min(k,j)):Math.max(k,Math.min(F,j))},o.bBoxIntersect=function(j,k,F){return F=F||0,j.left<=k.right+F&&k.left<=j.right+F&&j.top<=k.bottom+F&&k.top<=j.bottom+F},o.simpleMap=function(j,k,F,J,K){for(var ve=j.length,Te=new Array(ve),Ae=0;Ae<ve;Ae++)Te[Ae]=k(j[Ae],F,J,K);return Te},o.randstr=function j(k,F,J,K){if(J||(J=16),F===void 0&&(F=24),F<=0)return"0";var ve=Math.log(Math.pow(2,F))/Math.log(J),Te="",Ae,Fe,Ge;for(Ae=2;ve===1/0;Ae*=2)ve=Math.log(Math.pow(2,F/Ae))/Math.log(J)*Ae;var rt=ve-Math.floor(ve);for(Ae=0;Ae<Math.floor(ve);Ae++)Ge=Math.floor(Math.random()*J).toString(J),Te=Ge+Te;rt&&(Fe=Math.pow(J,rt),Ge=Math.floor(Math.random()*Fe).toString(J),Te=Ge+Te);var bt=parseInt(Te,J);return k&&k[Te]||bt!==1/0&&bt>=Math.pow(2,F)?K>10?(o.warn("randstr failed uniqueness"),Te):j(k,F,J,(K||0)+1):Te},o.OptionControl=function(j,k){j||(j={}),k||(k="opt");var F={};return F.optionList=[],F._newoption=function(J){J[k]=j,F[J.name]=J,F.optionList.push(J)},F["_"+k]=j,F},o.smooth=function(j,k){if(k=Math.round(k)||0,k<2)return j;var F=j.length,J=2*F,K=2*k-1,ve=new Array(K),Te=new Array(F),Ae,Fe,Ge,rt;for(Ae=0;Ae<K;Ae++)ve[Ae]=(1-Math.cos(Math.PI*(Ae+1)/k))/(2*k);for(Ae=0;Ae<F;Ae++){for(rt=0,Fe=0;Fe<K;Fe++)Ge=Ae+Fe+1-k,Ge<-F?Ge-=J*Math.round(Ge/J):Ge>=J&&(Ge-=J*Math.floor(Ge/J)),Ge<0?Ge=-1-Ge:Ge>=F&&(Ge=J-1-Ge),rt+=j[Ge]*ve[Fe];Te[Ae]=rt}return Te},o.syncOrAsync=function(j,k,F){var J,K;function ve(){return o.syncOrAsync(j,k,F)}for(;j.length;)if(K=j.splice(0,1)[0],J=K(k),J&&J.then)return J.then(ve);return F&&F(k)},o.stripTrailingSlash=function(j){return j.substr(-1)==="/"?j.substr(0,j.length-1):j},o.noneOrAll=function(j,k,F){if(j){var J=!1,K=!0,ve,Te;for(ve=0;ve<F.length;ve++)Te=j[F[ve]],Te!=null?J=!0:K=!1;if(J&&!K)for(ve=0;ve<F.length;ve++)j[F[ve]]=k[F[ve]]}},o.mergeArray=function(j,k,F,J){var K=typeof J=="function";if(o.isArrayOrTypedArray(j))for(var ve=Math.min(j.length,k.length),Te=0;Te<ve;Te++){var Ae=j[Te];k[Te][F]=K?J(Ae):Ae}},o.mergeArrayCastPositive=function(j,k,F){return o.mergeArray(j,k,F,function(J){var K=+J;return isFinite(K)&&K>0?K:0})},o.fillArray=function(j,k,F,J){if(J=J||o.identity,o.isArrayOrTypedArray(j))for(var K=0;K<k.length;K++)k[K][F]=J(j[K])},o.castOption=function(j,k,F,J){J=J||o.identity;var K=o.nestedProperty(j,F).get();return o.isArrayOrTypedArray(K)?Array.isArray(k)&&o.isArrayOrTypedArray(K[k[0]])?J(K[k[0]][k[1]]):J(K[k]):K},o.extractOption=function(j,k,F,J){if(F in j)return j[F];var K=o.nestedProperty(k,J).get();if(!Array.isArray(K))return K};function P(j){var k={};for(var F in j)for(var J=j[F],K=0;K<J.length;K++)k[J[K]]=+F;return k}o.tagSelected=function(j,k,F){var J=k.selectedpoints,K=k._indexToPoints,ve;K&&(ve=P(K));function Te(bt){return bt!==void 0&&bt<j.length}for(var Ae=0;Ae<J.length;Ae++){var Fe=J[Ae];if(o.isIndex(Fe)||o.isArrayOrTypedArray(Fe)&&o.isIndex(Fe[0])&&o.isIndex(Fe[1])){var Ge=ve?ve[Fe]:Fe,rt=F?F[Ge]:Ge;Te(rt)&&(j[rt].selected=1)}}},o.selIndices2selPoints=function(j){var k=j.selectedpoints,F=j._indexToPoints;if(F){for(var J=P(F),K=[],ve=0;ve<k.length;ve++){var Te=k[ve];if(o.isIndex(Te)){var Ae=J[Te];o.isIndex(Ae)&&K.push(Ae)}}return K}else return k},o.getTargetArray=function(j,k){var F=k.target;if(typeof F=="string"&&F){var J=o.nestedProperty(j,F).get();return o.isArrayOrTypedArray(J)?J:!1}else if(o.isArrayOrTypedArray(F))return F;return!1};function re(j,k,F){var J={};typeof k!="object"&&(k={});var K=F==="pieLike"?-1:3,ve=Object.keys(j),Te,Ae,Fe;for(Te=0;Te<ve.length;Te++)Ae=ve[Te],Fe=j[Ae],!(Ae.charAt(0)==="_"||typeof Fe=="function")&&(Ae==="module"?J[Ae]=Fe:Array.isArray(Fe)?Ae==="colorscale"||K===-1?J[Ae]=Fe.slice():J[Ae]=Fe.slice(0,K):o.isTypedArray(Fe)?K===-1?J[Ae]=Fe.subarray():J[Ae]=Fe.subarray(0,K):Fe&&typeof Fe=="object"?J[Ae]=re(j[Ae],k[Ae],F):J[Ae]=Fe);for(ve=Object.keys(k),Te=0;Te<ve.length;Te++)Ae=ve[Te],Fe=k[Ae],(typeof Fe!="object"||!(Ae in J)||typeof J[Ae]!="object")&&(J[Ae]=Fe);return J}o.minExtend=re,o.titleCase=function(j){return j.charAt(0).toUpperCase()+j.substr(1)},o.containsAny=function(j,k){for(var F=0;F<k.length;F++)if(j.indexOf(k[F])!==-1)return!0;return!1};var G=/Version\/[\d\.]+.*Safari/;o.isSafari=function(){return G.test(window.navigator.userAgent)};var Z=/iPad|iPhone|iPod/;o.isIOS=function(){return Z.test(window.navigator.userAgent)};var Y=/Macintosh.+AppleWebKit.+Gecko\)$/;o.isMacWKWebView=()=>Y.test(window.navigator.userAgent);var X=/Firefox\/(\d+)\.\d+/;o.getFirefoxVersion=function(){var j=X.exec(window.navigator.userAgent);if(j&&j.length===2){var k=parseInt(j[1]);if(!isNaN(k))return k}return null},o.isD3Selection=function(j){return j instanceof d.selection},o.ensureSingle=function(j,k,F,J){var K=j.select(k+(F?"."+F:""));if(K.size())return K;var ve=j.append(k);return F&&ve.classed(F,!0),J&&ve.call(J),ve},o.ensureSingleById=function(j,k,F,J){var K=j.select(k+"#"+F);if(K.size())return K;var ve=j.append(k).attr("id",F);return J&&ve.call(J),ve},o.objectFromPath=function(j,k){for(var F=j.split("."),J,K=J={},ve=0;ve<F.length;ve++){var Te=F[ve],Ae=null,Fe=F[ve].match(/(.*)\[([0-9]+)\]/);Fe?(Te=Fe[1],Ae=Fe[2],J=J[Te]=[],ve===F.length-1?J[Ae]=k:J[Ae]={},J=J[Ae]):(ve===F.length-1?J[Te]=k:J[Te]={},J=J[Te])}return K};var ne=/^([^\[\.]+)\.(.+)?/,ae=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;function B(j){return j.slice(0,2)==="__"}o.expandObjectPaths=function(j){var k,F,J,K,ve,Te,Ae;if(typeof j=="object"&&!Array.isArray(j)){for(F in j)if(j.hasOwnProperty(F))if(k=F.match(ne)){if(K=j[F],J=k[1],B(J))continue;delete j[F],j[J]=o.extendDeepNoArrays(j[J]||{},o.objectFromPath(F,o.expandObjectPaths(K))[J])}else if(k=F.match(ae)){if(K=j[F],J=k[1],B(J))continue;if(ve=parseInt(k[2]),delete j[F],j[J]=j[J]||[],k[3]===".")Ae=k[4],Te=j[J][ve]=j[J][ve]||{},o.extendDeepNoArrays(Te,o.objectFromPath(Ae,o.expandObjectPaths(K)));else{if(B(J))continue;j[J][ve]=o.expandObjectPaths(K)}}else{if(B(F))continue;j[F]=o.expandObjectPaths(j[F])}}return j},o.numSeparate=function(j,k,F){if(F||(F=!1),typeof k!="string"||k.length===0)throw new Error("Separator string required for formatting!");typeof j=="number"&&(j=String(j));var J=/(\d+)(\d{3})/,K=k.charAt(0),ve=k.charAt(1),Te=j.split("."),Ae=Te[0],Fe=Te.length>1?K+Te[1]:"";if(ve&&(Te.length>1||Ae.length>4||F))for(;J.test(Ae);)Ae=Ae.replace(J,"$1"+ve+"$2");return Ae+Fe},o.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var ie=/^\w*$/;o.templateString=function(j,k){var F={};return j.replace(o.TEMPLATE_STRING_REGEX,function(J,K){var ve;return ie.test(K)?ve=k[K]:(F[K]=F[K]||o.nestedProperty(k,K).get,ve=F[K](!0)),ve!==void 0?ve:""})};var se={max:10,count:0,name:"hovertemplate"};o.hovertemplateString=function(){return Ie.apply(se,arguments)};var ye={max:10,count:0,name:"texttemplate"};o.texttemplateString=function(){return Ie.apply(ye,arguments)};var me=/^(\S+)([\*\/])(-?\d+(\.\d+)?)$/;function xe(j){var k=j.match(me);return k?{key:k[1],op:k[2],number:Number(k[3])}:{key:j,op:null,number:null}}var Re={max:10,count:0,name:"texttemplate",parseMultDiv:!0};o.texttemplateStringForShapes=function(){return Ie.apply(Re,arguments)};var ke=/^[:|\|]/;function Ie(j,k,F){var J=this,K=arguments;return k||(k={}),j.replace(o.TEMPLATE_STRING_REGEX,function(ve,Te,Ae){var Fe=Te==="xother"||Te==="yother",Ge=Te==="_xother"||Te==="_yother",rt=Te==="_xother_"||Te==="_yother_",bt=Te==="xother_"||Te==="yother_",ht=Fe||Ge||bt||rt,ct=Te;(Ge||rt)&&(ct=ct.substring(1)),(bt||rt)&&(ct=ct.substring(0,ct.length-1));var Oe=null,ze=null;if(J.parseMultDiv){var we=xe(ct);ct=we.key,Oe=we.op,ze=we.number}var je;if(ht){if(je=k[ct],je===void 0)return""}else{var ot,vt;for(vt=3;vt<K.length;vt++)if(ot=K[vt],!!ot){if(ot.hasOwnProperty(ct)){je=ot[ct];break}if(ie.test(ct)||(je=o.nestedProperty(ot,ct).get(!0)),je!==void 0)break}}if(je!==void 0&&(Oe==="*"&&(je*=ze),Oe==="/"&&(je/=ze)),je===void 0&&J)return J.count<J.max&&(o.warn("Variable '"+ct+"' in "+J.name+" could not be found!"),je=ve),J.count===J.max&&o.warn("Too many "+J.name+" warnings - additional warnings will be suppressed"),J.count++,ve;if(Ae){var Lt;if(Ae[0]===":"&&(Lt=F?F.numberFormat:o.numberFormat,je!==""&&(je=Lt(Ae.replace(ke,""))(je))),Ae[0]==="|"){Lt=F?F.timeFormat:i;var Tt=o.dateTime2ms(je);je=o.formatDate(Tt,Ae.replace(ke,""),!1,Lt)}}else{var kt=ct+"Label";k.hasOwnProperty(kt)&&(je=k[kt])}return ht&&(je="("+je+")",(Ge||rt)&&(je=" "+je),(bt||rt)&&(je=je+" ")),je})}var Q=48,ee=57;o.subplotSort=function(j,k){for(var F=Math.min(j.length,k.length)+1,J=0,K=0,ve=0;ve<F;ve++){var Te=j.charCodeAt(ve)||0,Ae=k.charCodeAt(ve)||0,Fe=Te>=Q&&Te<=ee,Ge=Ae>=Q&&Ae<=ee;if(Fe&&(J=10*J+Te-Q),Ge&&(K=10*K+Ae-Q),!Fe||!Ge){if(J!==K)return J-K;if(Te!==Ae)return Te-Ae}}return K-J};var D=2e9;o.seedPseudoRandom=function(){D=2e9},o.pseudoRandom=function(){var j=D;return D=(69069*D+1)%4294967296,Math.abs(D-j)<429496729?o.pseudoRandom():D/4294967296},o.fillText=function(j,k,F){var J=Array.isArray(F)?function(Te){F.push(Te)}:function(Te){F.text=Te},K=o.extractOption(j,k,"htx","hovertext");if(o.isValidTextValue(K))return J(K);var ve=o.extractOption(j,k,"tx","text");if(o.isValidTextValue(ve))return J(ve)},o.isValidTextValue=function(j){return j||j===0},o.formatPercent=function(j,k){k=k||0;for(var F=(Math.round(100*j*Math.pow(10,k))*Math.pow(.1,k)).toFixed(k)+"%",J=0;J<k;J++)F.indexOf(".")!==-1&&(F=F.replace("0%","%"),F=F.replace(".%","%"));return F},o.isHidden=function(j){var k=window.getComputedStyle(j).display;return!k||k==="none"},o.strTranslate=function(j,k){return j||k?"translate("+j+","+k+")":""},o.strRotate=function(j){return j?"rotate("+j+")":""},o.strScale=function(j){return j!==1?"scale("+j+")":""},o.getTextTransform=function(j){var k=j.noCenter,F=j.textX,J=j.textY,K=j.targetX,ve=j.targetY,Te=j.anchorX||0,Ae=j.anchorY||0,Fe=j.rotate,Ge=j.scale;return Ge?Ge>1&&(Ge=1):Ge=0,o.strTranslate(K-Ge*(F+Te),ve-Ge*(J+Ae))+o.strScale(Ge)+(Fe?"rotate("+Fe+(k?"":" "+F+" "+J)+")":"")},o.setTransormAndDisplay=function(j,k){j.attr("transform",o.getTextTransform(k)),j.style("display",k.scale?null:"none")},o.ensureUniformFontSize=function(j,k){var F=o.extendFlat({},k);return F.size=Math.max(k.size,j._fullLayout.uniformtext.minsize||0),F},o.join2=function(j,k,F){var J=j.length;return J>1?j.slice(0,-1).join(k)+F+j[J-1]:j.join(k)},o.bigFont=function(j){return Math.round(1.2*j)};var le=o.getFirefoxVersion(),ge=le!==null&&le<86;o.getPositionFromD3Event=function(){return ge?[d.event.layerX,d.event.layerY]:[d.event.offsetX,d.event.offsetY]}}),gr=t(()=>{var W=Mt(),V={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X:focus-within .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-group a":"display:grid;place-content:center;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;border:none;background:rgba(0,0,0,0);","X .modebar-btn svg":"position:relative;","X .modebar-btn:focus-visible":"outline:1px solid #000;outline-offset:1px;border-radius:3px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:rgba(0,0,0,0);border:6px solid rgba(0,0,0,0);z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid rgba(0,0,0,0);border-left-color:#69738a;margin-top:8px;margin-right:-30px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(i in V)d=i.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier"),W.addStyleRule(d,V[i]);var d,i}),vr=t((W,V)=>{V.exports=!0}),ir=t((W,V)=>{var d=vr(),i;typeof window.matchMedia=="function"?i=!window.matchMedia("(hover: none)").matches:i=d,V.exports=i}),Zr=t((W,V)=>{var d=typeof Reflect=="object"?Reflect:null,i=d&&typeof d.apply=="function"?d.apply:function(R,N,te){return Function.prototype.apply.call(R,N,te)},s;d&&typeof d.ownKeys=="function"?s=d.ownKeys:Object.getOwnPropertySymbols?s=function(R){return Object.getOwnPropertyNames(R).concat(Object.getOwnPropertySymbols(R))}:s=function(R){return Object.getOwnPropertyNames(R)};function f(R){console&&console.warn&&console.warn(R)}var u=Number.isNaN||function(R){return R!==R};function h(){h.init.call(this)}V.exports=h,V.exports.once=m,h.EventEmitter=h,h.prototype._events=void 0,h.prototype._eventsCount=0,h.prototype._maxListeners=void 0;var p=10;function v(R){if(typeof R!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof R)}Object.defineProperty(h,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function(R){if(typeof R!="number"||R<0||u(R))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+R+".");p=R}}),h.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},h.prototype.setMaxListeners=function(R){if(typeof R!="number"||R<0||u(R))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+R+".");return this._maxListeners=R,this};function o(R){return R._maxListeners===void 0?h.defaultMaxListeners:R._maxListeners}h.prototype.getMaxListeners=function(){return o(this)},h.prototype.emit=function(R){for(var N=[],te=1;te<arguments.length;te++)N.push(arguments[te]);var H=R==="error",U=this._events;if(U!==void 0)H=H&&U.error===void 0;else if(!H)return!1;if(H){var P;if(N.length>0&&(P=N[0]),P instanceof Error)throw P;var re=new Error("Unhandled error."+(P?" ("+P.message+")":""));throw re.context=P,re}var G=U[R];if(G===void 0)return!1;if(typeof G=="function")i(G,this,N);else for(var Z=G.length,Y=M(G,Z),te=0;te<Z;++te)i(Y[te],this,N);return!0};function w(R,N,te,H){var U,P,re;if(v(te),P=R._events,P===void 0?(P=R._events=Object.create(null),R._eventsCount=0):(P.newListener!==void 0&&(R.emit("newListener",N,te.listener?te.listener:te),P=R._events),re=P[N]),re===void 0)re=P[N]=te,++R._eventsCount;else if(typeof re=="function"?re=P[N]=H?[te,re]:[re,te]:H?re.unshift(te):re.push(te),U=o(R),U>0&&re.length>U&&!re.warned){re.warned=!0;var G=new Error("Possible EventEmitter memory leak detected. "+re.length+" "+String(N)+" listeners added. Use emitter.setMaxListeners() to increase limit");G.name="MaxListenersExceededWarning",G.emitter=R,G.type=N,G.count=re.length,f(G)}return R}h.prototype.addListener=function(R,N){return w(this,R,N,!1)},h.prototype.on=h.prototype.addListener,h.prototype.prependListener=function(R,N){return w(this,R,N,!0)};function g(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function b(R,N,te){var H={fired:!1,wrapFn:void 0,target:R,type:N,listener:te},U=g.bind(H);return U.listener=te,H.wrapFn=U,U}h.prototype.once=function(R,N){return v(N),this.on(R,b(this,R,N)),this},h.prototype.prependOnceListener=function(R,N){return v(N),this.prependListener(R,b(this,R,N)),this},h.prototype.removeListener=function(R,N){var te,H,U,P,re;if(v(N),H=this._events,H===void 0)return this;if(te=H[R],te===void 0)return this;if(te===N||te.listener===N)--this._eventsCount===0?this._events=Object.create(null):(delete H[R],H.removeListener&&this.emit("removeListener",R,te.listener||N));else if(typeof te!="function"){for(U=-1,P=te.length-1;P>=0;P--)if(te[P]===N||te[P].listener===N){re=te[P].listener,U=P;break}if(U<0)return this;U===0?te.shift():T(te,U),te.length===1&&(H[R]=te[0]),H.removeListener!==void 0&&this.emit("removeListener",R,re||N)}return this},h.prototype.off=h.prototype.removeListener,h.prototype.removeAllListeners=function(R){var N,te,H;if(te=this._events,te===void 0)return this;if(te.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):te[R]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete te[R]),this;if(arguments.length===0){var U=Object.keys(te),P;for(H=0;H<U.length;++H)P=U[H],P!=="removeListener"&&this.removeAllListeners(P);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(N=te[R],typeof N=="function")this.removeListener(R,N);else if(N!==void 0)for(H=N.length-1;H>=0;H--)this.removeListener(R,N[H]);return this};function L(R,N,te){var H=R._events;if(H===void 0)return[];var U=H[N];return U===void 0?[]:typeof U=="function"?te?[U.listener||U]:[U]:te?C(U):M(U,U.length)}h.prototype.listeners=function(R){return L(this,R,!0)},h.prototype.rawListeners=function(R){return L(this,R,!1)},h.listenerCount=function(R,N){return typeof R.listenerCount=="function"?R.listenerCount(N):S.call(R,N)},h.prototype.listenerCount=S;function S(R){var N=this._events;if(N!==void 0){var te=N[R];if(typeof te=="function")return 1;if(te!==void 0)return te.length}return 0}h.prototype.eventNames=function(){return this._eventsCount>0?s(this._events):[]};function M(R,N){for(var te=new Array(N),H=0;H<N;++H)te[H]=R[H];return te}function T(R,N){for(;N+1<R.length;N++)R[N]=R[N+1];R.pop()}function C(R){for(var N=new Array(R.length),te=0;te<N.length;++te)N[te]=R[te].listener||R[te];return N}function m(R,N){return new Promise(function(te,H){function U(re){R.removeListener(N,P),H(re)}function P(){typeof R.removeListener=="function"&&R.removeListener("error",U),te([].slice.call(arguments))}A(R,N,P,{once:!0}),N!=="error"&&y(R,U,{once:!0})})}function y(R,N,te){typeof R.on=="function"&&A(R,"error",N,te)}function A(R,N,te,H){if(typeof R.on=="function")H.once?R.once(N,te):R.on(N,te);else if(typeof R.addEventListener=="function")R.addEventListener(N,function U(P){H.once&&R.removeEventListener(N,U),te(P)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof R)}}),xn=t((W,V)=>{var d=Zr().EventEmitter,i={init:function(s){if(s._ev instanceof d)return s;var f=new d,u=new d;return s._ev=f,s._internalEv=u,s.on=f.on.bind(f),s.once=f.once.bind(f),s.removeListener=f.removeListener.bind(f),s.removeAllListeners=f.removeAllListeners.bind(f),s._internalOn=u.on.bind(u),s._internalOnce=u.once.bind(u),s._removeInternalListener=u.removeListener.bind(u),s._removeAllInternalListeners=u.removeAllListeners.bind(u),s.emit=function(h,p){f.emit(h,p),u.emit(h,p)},typeof s.addEventListener=="function"&&s.addEventListener("wheel",()=>{},{passive:!0}),s},triggerHandler:function(s,f,u){var h,p=s._ev;if(!p)return;var v=p._events[f];if(!v)return;function o(g){if(g.listener){if(p.removeListener(f,g.listener),!g.fired)return g.fired=!0,g.listener.apply(p,[u])}else return g.apply(p,[u])}v=Array.isArray(v)?v:[v];var w;for(w=0;w<v.length-1;w++)o(v[w]);return h=o(v[w]),h},purge:function(s){return delete s._ev,delete s.on,delete s.once,delete s.removeListener,delete s.removeAllListeners,delete s.emit,delete s._ev,delete s._internalEv,delete s._internalOn,delete s._internalOnce,delete s._removeInternalListener,delete s._removeAllInternalListeners,s}};V.exports=i}),Pn=t((W,V)=>{var d=Mt(),i=Tr().dfltConfig;function s(u,h){for(var p=[],v,o=0;o<h.length;o++)v=h[o],v===u?p[o]=v:typeof v=="object"?p[o]=Array.isArray(v)?d.extendDeep([],v):d.extendDeepAll({},v):p[o]=v;return p}var f={};f.add=function(u,h,p,v,o){var w,g;if(u.undoQueue=u.undoQueue||{index:0,queue:[],sequence:!1},g=u.undoQueue.index,u.autoplay){u.undoQueue.inSequence||(u.autoplay=!1);return}!u.undoQueue.sequence||u.undoQueue.beginSequence?(w={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},u.undoQueue.queue.splice(g,u.undoQueue.queue.length-g,w),u.undoQueue.index+=1):w=u.undoQueue.queue[g-1],u.undoQueue.beginSequence=!1,w&&(w.undo.calls.unshift(h),w.undo.args.unshift(p),w.redo.calls.push(v),w.redo.args.push(o)),u.undoQueue.queue.length>i.queueLength&&(u.undoQueue.queue.shift(),u.undoQueue.index--)},f.startSequence=function(u){u.undoQueue=u.undoQueue||{index:0,queue:[],sequence:!1},u.undoQueue.sequence=!0,u.undoQueue.beginSequence=!0},f.stopSequence=function(u){u.undoQueue=u.undoQueue||{index:0,queue:[],sequence:!1},u.undoQueue.sequence=!1,u.undoQueue.beginSequence=!1},f.undo=function(u){var h,p;if(!(u.undoQueue===void 0||isNaN(u.undoQueue.index)||u.undoQueue.index<=0)){for(u.undoQueue.index--,h=u.undoQueue.queue[u.undoQueue.index],u.undoQueue.inSequence=!0,p=0;p<h.undo.calls.length;p++)f.plotDo(u,h.undo.calls[p],h.undo.args[p]);u.undoQueue.inSequence=!1,u.autoplay=!1}},f.redo=function(u){var h,p;if(!(u.undoQueue===void 0||isNaN(u.undoQueue.index)||u.undoQueue.index>=u.undoQueue.queue.length)){for(h=u.undoQueue.queue[u.undoQueue.index],u.undoQueue.inSequence=!0,p=0;p<h.redo.calls.length;p++)f.plotDo(u,h.redo.calls[p],h.redo.args[p]);u.undoQueue.inSequence=!1,u.autoplay=!1,u.undoQueue.index++}},f.plotDo=function(u,h,p){u.autoplay=!0,p=s(u,p),h.apply(null,p)},V.exports=f}),Dn=t((W,V)=>{V.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}}),Hn=t(W=>{var V=an(),d=Mt(),i=nt(),s=Sa(),f=Dn(),u=Xn(),h=Tr().configAttributes,p=Ft(),v=d.extendDeepAll,o=d.isPlainObject,w=d.isArrayOrTypedArray,g=d.nestedProperty,b=d.valObjectMeta,L="_isSubplotObj",S="_isLinkedToArray",M="_arrayAttrRegexps",T="_deprecated",C=[L,S,M,T];W.IS_SUBPLOT_OBJ=L,W.IS_LINKED_TO_ARRAY=S,W.DEPRECATED=T,W.UNDERSCORE_ATTRS=C,W.get=function(){var Y={};return V.allTypes.forEach(function(X){Y[X]=R(X)}),{defs:{valObjects:b,metaKeys:C.concat(["description","role","editType","impliedEdits"]),editType:{traces:p.traces,layout:p.layout},impliedEdits:{}},traces:Y,layout:N(),frames:te(),animation:H(u),config:H(h)}},W.crawl=function(Y,X,ne,ae){var B=ne||0;ae=ae||"",Object.keys(Y).forEach(function(ie){var se=Y[ie];if(C.indexOf(ie)===-1){var ye=(ae?ae+".":"")+ie;X(se,ie,Y,B,ye),!W.isValObject(se)&&o(se)&&ie!=="impliedEdits"&&W.crawl(se,X,B+1,ye)}})},W.isValObject=function(Y){return Y&&Y.valType!==void 0},W.findArrayAttributes=function(Y){var X=[],ne=[],ae=[],B,ie;function se(me,xe,Re,ke){ne=ne.slice(0,ke).concat([xe]),ae=ae.slice(0,ke).concat([me&&me._isLinkedToArray]);var Ie=me&&(me.valType==="data_array"||me.arrayOk===!0)&&!(ne[ke-1]==="colorbar"&&(xe==="ticktext"||xe==="tickvals"));Ie&&ye(B,0,"")}function ye(me,xe,Re){var ke=me[ne[xe]],Ie=Re+ne[xe];if(xe===ne.length-1)w(ke)&&X.push(ie+Ie);else if(ae[xe]){if(Array.isArray(ke))for(var Q=0;Q<ke.length;Q++)o(ke[Q])&&ye(ke[Q],xe+1,Ie+"["+Q+"].")}else o(ke)&&ye(ke,xe+1,Ie+".")}return B=Y,ie="",W.crawl(i,se),Y._module&&Y._module.attributes&&W.crawl(Y._module.attributes,se),X},W.getTraceValObject=function(Y,X){var ne=X[0],ae=1,B,ie,se=Y._module;if(se||(se=(V.modules[Y.type||i.type.dflt]||{})._module),!se)return!1;if(B=se.attributes,ie=B&&B[ne],!ie){var ye=se.basePlotModule;ye&&ye.attributes&&(ie=ye.attributes[ne])}return ie||(ie=i[ne]),y(ie,X,ae)},W.getLayoutValObject=function(Y,X){var ne=m(Y,X[0]);return y(ne,X,1)};function m(Y,X){var ne,ae,B,ie,se=Y._basePlotModules;if(se){var ye;for(ne=0;ne<se.length;ne++){if(B=se[ne],B.attrRegex&&B.attrRegex.test(X)){if(B.layoutAttrOverrides)return B.layoutAttrOverrides;!ye&&B.layoutAttributes&&(ye=B.layoutAttributes)}var me=B.baseLayoutAttrOverrides;if(me&&X in me)return me[X]}if(ye)return ye}var xe=Y._modules;if(xe){for(ne=0;ne<xe.length;ne++)if(ie=xe[ne].layoutAttributes,ie&&X in ie)return ie[X]}for(ae in V.componentsRegistry){if(B=V.componentsRegistry[ae],B.name==="colorscale"&&X.indexOf("coloraxis")===0)return B.layoutAttributes[X];if(!B.schema&&X===B.name)return B.layoutAttributes}return X in s?s[X]:!1}function y(Y,X,ne){if(!Y)return!1;if(Y._isLinkedToArray){if(A(X[ne]))ne++;else if(ne<X.length)return!1}for(;ne<X.length;ne++){var ae=Y[X[ne]];if(o(ae))Y=ae;else break;if(ne===X.length-1)break;if(Y._isLinkedToArray){if(ne++,!A(X[ne]))return!1}else if(Y.valType==="info_array"){ne++;var B=X[ne];if(!A(B))return!1;var ie=Y.items;if(Array.isArray(ie)){if(B>=ie.length)return!1;if(Y.dimensions===2){if(ne++,X.length===ne)return Y;var se=X[ne];if(!A(se))return!1;Y=ie[B][se]}else Y=ie[B]}else Y=ie}}return Y}function A(Y){return Y===Math.round(Y)&&Y>=0}function R(Y){var X,ne;X=V.modules[Y]._module,ne=X.basePlotModule;var ae={};ae.type=null;var B=v({},i),ie=v({},X.attributes);W.crawl(ie,function(me,xe,Re,ke,Ie){g(B,Ie).set(void 0),me===void 0&&g(ie,Ie).set(void 0)}),v(ae,B),V.traceIs(Y,"noOpacity")&&delete ae.opacity,V.traceIs(Y,"showLegend")||(delete ae.showlegend,delete ae.legendgroup),V.traceIs(Y,"noHover")&&(delete ae.hoverinfo,delete ae.hoverlabel),X.selectPoints||delete ae.selectedpoints,v(ae,ie),ne.attributes&&v(ae,ne.attributes),ae.type=Y;var se={meta:X.meta||{},categories:X.categories||{},animatable:!!X.animatable,type:Y,attributes:H(ae)};if(X.layoutAttributes){var ye={};v(ye,X.layoutAttributes),se.layoutAttributes=H(ye)}return X.animatable||W.crawl(se,function(me){W.isValObject(me)&&"anim"in me&&delete me.anim}),se}function N(){var Y={},X,ne;v(Y,s);for(X in V.subplotsRegistry)if(ne=V.subplotsRegistry[X],!!ne.layoutAttributes)if(Array.isArray(ne.attr))for(var ae=0;ae<ne.attr.length;ae++)G(Y,ne,ne.attr[ae]);else{var B=ne.attr==="subplot"?ne.name:ne.attr;G(Y,ne,B)}for(X in V.componentsRegistry){ne=V.componentsRegistry[X];var ie=ne.schema;if(ie&&(ie.subplots||ie.layout)){var se=ie.subplots;if(se&&se.xaxis&&!se.yaxis)for(var ye in se.xaxis)delete Y.yaxis[ye];delete Y.xaxis.shift,delete Y.xaxis.autoshift}else ne.name==="colorscale"?v(Y,ne.layoutAttributes):ne.layoutAttributes&&Z(Y,ne.layoutAttributes,ne.name)}return{layoutAttributes:H(Y)}}function te(){var Y={frames:v({},f)};return H(Y),Y.frames}function H(Y){return U(Y),P(Y),re(Y),Y}function U(Y){function X(ae){return{valType:"string",editType:"none"}}function ne(ae,B,ie){W.isValObject(ae)?(ae.arrayOk===!0||ae.valType==="data_array")&&(ie[B+"src"]=X()):o(ae)&&(ae.role="object")}W.crawl(Y,ne)}function P(Y){function X(ne,ae,B){if(ne){var ie=ne[S];ie&&(delete ne[S],B[ae]={items:{}},B[ae].items[ie]=ne,B[ae].role="object")}}W.crawl(Y,X)}function re(Y){function X(ne){for(var ae in ne)if(o(ne[ae]))X(ne[ae]);else if(Array.isArray(ne[ae]))for(var B=0;B<ne[ae].length;B++)X(ne[ae][B]);else ne[ae]instanceof RegExp&&(ne[ae]=ne[ae].toString())}X(Y)}function G(Y,X,ne){var ae=g(Y,ne),B=v({},X.layoutAttributes);B[L]=!0,ae.set(B)}function Z(Y,X,ne){var ae=g(Y,ne);ae.set(v(ae.get()||{},X))}}),fn=t(W=>{var V=Mt(),d=nt(),i="templateitemname",s={name:{valType:"string",editType:"none"}};s[i]={valType:"string",editType:"calc"},W.templatedArray=function(h,p){return p._isLinkedToArray=h,p.name=s.name,p[i]=s[i],p},W.traceTemplater=function(h){var p={},v,o;for(v in h)o=h[v],Array.isArray(o)&&o.length&&(p[v]=0);function w(g){v=V.coerce(g,{},d,"type");var b={type:v,_template:null};if(v in p){o=h[v];var L=p[v]%o.length;p[v]++,b._template=o[L]}return b}return{newTrace:w}},W.newContainer=function(h,p,v){var o=h._template,w=o&&(o[p]||v&&o[v]);V.isPlainObject(w)||(w=null);var g=h[p]={_template:w};return g},W.arrayTemplater=function(h,p,v){var o=h._template,w=o&&o[u(p)],g=o&&o[p];(!Array.isArray(g)||!g.length)&&(g=[]);var b={};function L(M){var T={name:M.name,_input:M},C=T[i]=M[i];if(!f(C))return T._template=w,T;for(var m=0;m<g.length;m++){var y=g[m];if(y.name===C)return b[C]=1,T._template=y,T}return T[v]=M[v]||!1,T._template=!1,T}function S(){for(var M=[],T=0;T<g.length;T++){var C=g[T],m=C.name;if(f(m)&&!b[m]){var y={_template:C,name:m,_input:{_templateitemname:m}};y[i]=C[i],M.push(y),b[m]=1}}return M}return{newItem:L,defaultItems:S}};function f(h){return h&&typeof h=="string"}function u(h){var p=h.length-1;return h.charAt(p)!=="s"&&V.warn("bad argument to arrayDefaultKey: "+h),h.substr(0,h.length-1)+"defaults"}W.arrayDefaultKey=u,W.arrayEditor=function(h,p,v){var o=(V.nestedProperty(h,p).get()||[]).length,w=v._index,g=w>=o&&(v._input||{})._templateitemname;g&&(w=o);var b=p+"["+w+"]",L;function S(){L={},g&&(L[b]={},L[b][i]=g)}S();function M(y,A){L[y]=A}function T(y,A){g?V.nestedProperty(L[b],y).set(A):L[b+"."+y]=A}function C(){var y=L;return S(),y}function m(y,A){y&&T(y,A);var R=C();for(var N in R)V.nestedProperty(h,N).set(R[N])}return{modifyBase:M,modifyItem:T,getUpdateObj:C,applyUpdate:m}}}),kn=t((W,V)=>{var d=cr().counter;V.exports={idRegex:{x:d("x","( domain)?"),y:d("y","( domain)?")},attrRegex:d("[xy]axis"),xAxisMatch:d("xaxis"),yAxisMatch:d("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINZOOM:20,DRAGGERSIZE:20,REDRAWDELAY:50,DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"},zindexSeparator:"z"}}),aa=t(W=>{var V=an(),d=kn();W.id2name=function(s){if(!(typeof s!="string"||!s.match(d.AX_ID_PATTERN))){var f=s.split(" ")[0].substr(1);return f==="1"&&(f=""),s.charAt(0)+"axis"+f}},W.name2id=function(s){if(s.match(d.AX_NAME_PATTERN)){var f=s.substr(5);return f==="1"&&(f=""),s.charAt(0)+f}},W.cleanId=function(s,f,u){var h=/( domain)$/.test(s);if(!(typeof s!="string"||!s.match(d.AX_ID_PATTERN))&&!(f&&s.charAt(0)!==f)&&!(h&&!u)){var p=s.split(" ")[0].substr(1).replace(/^0+/,"");return p==="1"&&(p=""),s.charAt(0)+p+(h&&u?" domain":"")}},W.list=function(s,f,u){var h=s._fullLayout;if(!h)return[];var p=W.listIds(s,f),v=new Array(p.length),o;for(o=0;o<p.length;o++){var w=p[o];v[o]=h[w.charAt(0)+"axis"+w.substr(1)]}if(!u){var g=h._subplots.gl3d||[];for(o=0;o<g.length;o++){var b=h[g[o]];f?v.push(b[f+"axis"]):v.push(b.xaxis,b.yaxis,b.zaxis)}}return v},W.listIds=function(s,f){var u=s._fullLayout;if(!u)return[];var h=u._subplots;return f?h[f+"axis"]:h.xaxis.concat(h.yaxis)},W.getFromId=function(s,f,u){var h=s._fullLayout;return f=f===void 0||typeof f!="string"?f:f.replace(" domain",""),u==="x"?f=f.replace(/y[0-9]*/,""):u==="y"&&(f=f.replace(/x[0-9]*/,"")),h[W.id2name(f)]},W.getFromTrace=function(s,f,u){var h=s._fullLayout,p=null;if(V.traceIs(f,"gl3d")){var v=f.scene;v.substr(0,5)==="scene"&&(p=h[v][u+"axis"])}else p=W.getFromId(s,f[u+"axis"]||u);return p},W.idSort=function(s,f){var u=s.charAt(0),h=f.charAt(0);return u!==h?u>h?1:-1:+(s.substr(1)||1)-+(f.substr(1)||1)},W.ref2id=function(s){return/^[xyz]/.test(s)?s.split(" ")[0]:!1};function i(s,f){if(f&&f.length){for(var u=0;u<f.length;u++)if(f[u][s])return!0}return!1}W.isLinked=function(s,f){return i(f,s._axisMatchGroups)||i(f,s._axisConstraintGroups)}}),Ha=t((W,V)=>{function d(s){var f=s._fullLayout._zoomlayer;f&&f.selectAll(".outline-controllers").remove()}function i(s){var f=s._fullLayout._zoomlayer;f&&f.selectAll(".select-outline").remove(),s._fullLayout._outlining=!1}V.exports={clearOutlineControllers:d,clearOutline:i}}),$a=t((W,V)=>{V.exports={scattermode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},scattergap:{valType:"number",min:0,max:1,editType:"calc"}}}),yi=t(W=>{var V=an();kn().SUBPLOT_PATTERN,W.getSubplotCalcData=function(d,i,s){var f=V.subplotsRegistry[i];if(!f)return[];for(var u=f.attr,h=[],p=0;p<d.length;p++){var v=d[p],o=v[0].trace;o[u]===s&&h.push(v)}return h},W.getModuleCalcData=function(d,i,s){var f=[],u=[],h;if(typeof i=="string"?h=V.getModule(i).plot:typeof i=="function"?h=i:h=i.plot,!h)return[f,d];for(var p=s,v=0;v<d.length;v++){var o=d[v],w=o[0].trace,g=w.zorder!==void 0;w.visible!==!0||w._length===0||(w._module&&w._module.plot===h&&(!g||w.zorder===p)?f.push(o):u.push(o))}return[f,u]},W.getSubplotData=function(d,i,s){if(!V.subplotsRegistry[i])return[];for(var f=V.subplotsRegistry[i].attr,u=[],h,p,v,o=0;o<d.length;o++)h=d[o],h[f]===s&&u.push(h);return u}}),ei=t(W=>{var V=an(),d=Mt();W.manageCommandObserver=function(p,v,o,w){var g={},b=!0;v&&v._commandObserver&&(g=v._commandObserver),g.cache||(g.cache={}),g.lookupTable={};var L=W.hasSimpleAPICommandBindings(p,o,g.lookupTable);if(v&&v._commandObserver){if(L)return g;if(v._commandObserver.remove)return v._commandObserver.remove(),v._commandObserver=null,g}if(L){i(p,L,g.cache),g.check=function(){if(b){var T=i(p,L,g.cache);return T.changed&&w&&g.lookupTable[T.value]!==void 0&&(g.disable(),Promise.resolve(w({value:T.value,type:L.type,prop:L.prop,traces:L.traces,index:g.lookupTable[T.value]})).then(g.enable,g.enable)),T.changed}};for(var S=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],M=0;M<S.length;M++)p._internalOn(S[M],g.check);g.remove=function(){for(var T=0;T<S.length;T++)p._removeInternalListener(S[T],g.check)}}else d.log("Unable to automatically bind plot updates to API command"),g.lookupTable={},g.remove=function(){};return g.disable=function(){b=!1},g.enable=function(){b=!0},v&&(v._commandObserver=g),g},W.hasSimpleAPICommandBindings=function(p,v,o){var w,g=v.length,b;for(w=0;w<g;w++){var L,S=v[w],M=S.method,T=S.args;if(Array.isArray(T)||(T=[]),!M)return!1;var C=W.computeAPICommandBindings(p,M,T);if(C.length!==1)return!1;if(!b)b=C[0],Array.isArray(b.traces)&&b.traces.sort();else{if(L=C[0],L.type!==b.type||L.prop!==b.prop)return!1;if(Array.isArray(b.traces))if(Array.isArray(L.traces)){L.traces.sort();for(var m=0;m<b.traces.length;m++)if(b.traces[m]!==L.traces[m])return!1}else return!1;else if(L.prop!==b.prop)return!1}L=C[0];var y=L.value;if(Array.isArray(y))if(y.length===1)y=y[0];else return!1;o&&(o[y]=w)}return b};function i(p,v,o){var w,g,b,L=!1;if(v.type==="data")w=p._fullData[v.traces!==null?v.traces[0]:0];else if(v.type==="layout")w=p._fullLayout;else return!1;return g=d.nestedProperty(w,v.prop).get(),b=o[v.type]=o[v.type]||{},b.hasOwnProperty(v.prop)&&b[v.prop]!==g&&(L=!0),b[v.prop]=g,{changed:L,value:g}}W.executeAPICommand=function(p,v,o){if(v==="skip")return Promise.resolve();var w=V.apiMethodRegistry[v],g=[p];Array.isArray(o)||(o=[]);for(var b=0;b<o.length;b++)g.push(o[b]);return w.apply(null,g).catch(function(L){return d.warn("API call to Plotly."+v+" rejected.",L),Promise.reject(L)})},W.computeAPICommandBindings=function(p,v,o){var w;switch(Array.isArray(o)||(o=[]),v){case"restyle":w=u(p,o);break;case"relayout":w=f(p,o);break;case"update":w=u(p,[o[0],o[2]]).concat(f(p,[o[1]]));break;case"animate":w=s(p,o);break;default:w=[]}return w};function s(p,v){return Array.isArray(v[0])&&v[0].length===1&&["string","number"].indexOf(typeof v[0][0])!==-1?[{type:"layout",prop:"_currentFrame",value:v[0][0].toString()}]:[]}function f(p,v){var o=[],w=v[0],g={};if(typeof w=="string")g[w]=v[1];else if(d.isPlainObject(w))g=w;else return o;return h(g,function(b,L,S){o.push({type:"layout",prop:b,value:S})},"",0),o}function u(p,v){var o,w,g,b,L=[];if(w=v[0],g=v[1],o=v[2],b={},typeof w=="string")b[w]=g;else if(d.isPlainObject(w))b=w,o===void 0&&(o=g);else return L;return o===void 0&&(o=null),h(b,function(S,M,T){var C,m;if(Array.isArray(T)){m=T.slice();var y=Math.min(m.length,p.data.length);o&&(y=Math.min(y,o.length)),C=[];for(var A=0;A<y;A++)C[A]=o?o[A]:A}else m=T,C=o?o.slice():null;if(C===null)Array.isArray(m)&&(m=m[0]);else if(Array.isArray(C)){if(!Array.isArray(m)){var R=m;m=[];for(var N=0;N<C.length;N++)m[N]=R}m.length=Math.min(C.length,m.length)}L.push({type:"data",prop:S,traces:C,value:m})},"",0),L}function h(p,v,o,w){Object.keys(p).forEach(function(g){var b=p[g];if(g[0]!=="_"){var L=o+(w>0?".":"")+g;d.isPlainObject(b)?h(b,v,L,w+1):v(L,g,b)}})}}),pn=t((W,V)=>{var d=l(),i=_().timeFormatLocale,s=O().formatLocale,f=q(),u=ue(),h=an(),p=Hn(),v=fn(),o=Mt(),w=Xt(),g=oe().BADNUM,b=aa(),L=Ha().clearOutline,S=$a(),M=Xn(),T=Dn(),C=yi().getModuleCalcData,m=o.relinkPrivateKeys,y=o._,A=V.exports={};o.extendFlat(A,h),A.attributes=nt(),A.attributes.type.values=A.allTypes,A.fontAttrs=pt(),A.layoutAttributes=Sa();var R=ei();A.executeAPICommand=R.executeAPICommand,A.computeAPICommandBindings=R.computeAPICommandBindings,A.manageCommandObserver=R.manageCommandObserver,A.hasSimpleAPICommandBindings=R.hasSimpleAPICommandBindings,A.redrawText=function(Q){return Q=o.getGraphDiv(Q),new Promise(function(ee){setTimeout(function(){Q._fullLayout&&(h.getComponentMethod("annotations","draw")(Q),h.getComponentMethod("legend","draw")(Q),h.getComponentMethod("colorbar","draw")(Q),ee(A.previousPromises(Q)))},300)})},A.resize=function(Q){Q=o.getGraphDiv(Q);var ee,D=new Promise(function(le,ge){(!Q||o.isHidden(Q))&&ge(new Error("Resize must be passed a displayed plot div element.")),Q._redrawTimer&&clearTimeout(Q._redrawTimer),Q._resolveResize&&(ee=Q._resolveResize),Q._resolveResize=le,Q._redrawTimer=setTimeout(function(){if(!Q.layout||Q.layout.width&&Q.layout.height||o.isHidden(Q)){le(Q);return}delete Q.layout.width,delete Q.layout.height;var j=Q.changed;Q.autoplay=!0,h.call("relayout",Q,{autosize:!0}).then(function(){Q.changed=j,Q._resolveResize===le&&(delete Q._resolveResize,le(Q))})},100)});return ee&&ee(D),D},A.previousPromises=function(Q){if((Q._promises||[]).length)return Promise.all(Q._promises).then(function(){Q._promises=[]})},A.addLinks=function(Q){if(!(!Q._context.showLink&&!Q._context.showSources)){var ee=Q._fullLayout,D=o.ensureSingle(ee._paper,"text","js-plot-link-container",function(J){J.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:w.defaultLine,"pointer-events":"all"}).each(function(){var K=d.select(this);K.append("tspan").classed("js-link-to-tool",!0),K.append("tspan").classed("js-link-spacer",!0),K.append("tspan").classed("js-sourcelinks",!0)})}),le=D.node(),ge={y:ee._paper.attr("height")-9};document.body.contains(le)&&le.getComputedTextLength()>=ee.width-20?(ge["text-anchor"]="start",ge.x=5):(ge["text-anchor"]="end",ge.x=ee._paper.attr("width")-7),D.attr(ge);var j=D.select(".js-link-to-tool"),k=D.select(".js-link-spacer"),F=D.select(".js-sourcelinks");Q._context.showSources&&Q._context.showSources(Q),Q._context.showLink&&N(Q,j),k.text(j.text()&&F.text()?" - ":"")}};function N(Q,ee){ee.text("");var D=ee.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(Q._context.linkText+" ");if(Q._context.sendData)D.on("click",function(){A.sendDataToCloud(Q)});else{var le=window.location.pathname.split("/"),ge=window.location.search;D.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+le[2].split(".")[0]+"/"+le[1]+ge})}}A.sendDataToCloud=function(Q){var ee=(window.PLOTLYENV||{}).BASE_URL||Q._context.plotlyServerURL;if(ee){Q.emit("plotly_beforeexport");var D=d.select(Q).append("div").attr("id","hiddenform").style("display","none"),le=D.append("form").attr({action:ee+"/external",method:"post",target:"_blank"}),ge=le.append("input").attr({type:"text",name:"data"});return ge.node().value=A.graphJson(Q,!1,"keepdata"),le.node().submit(),D.remove(),Q.emit("plotly_afterexport"),!1}};var te=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],H=["year","month","dayMonth","dayMonthYear"];A.supplyDefaults=function(Q,ee){var D=ee&&ee.skipUpdateCalc,le=Q._fullLayout||{};if(le._skipDefaults){delete le._skipDefaults;return}var ge=Q._fullLayout={},j=Q.layout||{},k=Q._fullData||[],F=Q._fullData=[],J=Q.data||[],K=Q.calcdata||[],ve=Q._context||{},Te;Q._transitionData||A.createTransitionData(Q),ge._dfltTitle={plot:y(Q,"Click to enter Plot title"),subtitle:y(Q,"Click to enter Plot subtitle"),x:y(Q,"Click to enter X axis title"),y:y(Q,"Click to enter Y axis title"),colorbar:y(Q,"Click to enter Colorscale title"),annotation:y(Q,"new text")},ge._traceWord=y(Q,"trace");var Ae=re(Q,te);if(ge._mapboxAccessToken=ve.mapboxAccessToken,le._initialAutoSizeIsDone){var Fe=le.width,Ge=le.height;A.supplyLayoutGlobalDefaults(j,ge,Ae),j.width||(ge.width=Fe),j.height||(ge.height=Ge),A.sanitizeMargins(ge)}else{A.supplyLayoutGlobalDefaults(j,ge,Ae);var rt=!j.width||!j.height,bt=ge.autosize,ht=ve.autosizable,ct=rt&&(bt||ht);ct?A.plotAutoSize(Q,j,ge):rt&&A.sanitizeMargins(ge),!bt&&rt&&(j.width=ge.width,j.height=ge.height)}ge._d3locale=G(Ae,ge.separators),ge._extraFormat=re(Q,H),ge._initialAutoSizeIsDone=!0,ge._dataLength=J.length,ge._modules=[],ge._visibleModules=[],ge._basePlotModules=[];var Oe=ge._subplots=P(),ze=ge._splomAxes={x:{},y:{}},we=ge._splomSubplots={};ge._splomGridDflt={},ge._scatterStackOpts={},ge._firstScatter={},ge._alignmentOpts={},ge._colorAxes={},ge._requestRangeslider={},ge._traceUids=U(k,J),A.supplyDataDefaults(J,F,j,ge);var je=Object.keys(ze.x),ot=Object.keys(ze.y);if(je.length>1&&ot.length>1){for(h.getComponentMethod("grid","sizeDefaults")(j,ge),Te=0;Te<je.length;Te++)o.pushUnique(Oe.xaxis,je[Te]);for(Te=0;Te<ot.length;Te++)o.pushUnique(Oe.yaxis,ot[Te]);for(var vt in we)o.pushUnique(Oe.cartesian,vt)}if(ge._has=A._hasPlotType.bind(ge),k.length===F.length)for(Te=0;Te<F.length;Te++)m(F[Te],k[Te]);A.supplyLayoutModuleDefaults(j,ge,F,Q._transitionData);var Lt=ge._visibleModules,Tt=[];for(Te=0;Te<Lt.length;Te++){var kt=Lt[Te].crossTraceDefaults;kt&&o.pushUnique(Tt,kt)}for(Te=0;Te<Tt.length;Te++)Tt[Te](F,ge);ge._hasOnlyLargeSploms=ge._basePlotModules.length===1&&ge._basePlotModules[0].name==="splom"&&je.length>15&&ot.length>15&&ge.shapes.length===0&&ge.images.length===0,A.linkSubplots(F,ge,k,le),A.cleanPlot(F,ge,k,le);var Nt=!!(le._has&&le._has("cartesian")),Pt=!!(ge._has&&ge._has("cartesian")),Wt=Nt,St=Pt;Wt&&!St?le._bgLayer.remove():St&&!Wt&&(ge._shouldCreateBgLayer=!0),le._zoomlayer&&!Q._dragging&&L({_fullLayout:le}),Z(F,ge),m(ge,le),h.getComponentMethod("colorscale","crossTraceDefaults")(F,ge),ge._preGUI||(ge._preGUI={}),ge._tracePreGUI||(ge._tracePreGUI={});var Qt=ge._tracePreGUI,rr={},Jt;for(Jt in Qt)rr[Jt]="old";for(Te=0;Te<F.length;Te++)Jt=F[Te]._fullInput.uid,rr[Jt]||(Qt[Jt]={}),rr[Jt]="new";for(Jt in rr)rr[Jt]==="old"&&delete Qt[Jt];ne(ge),h.getComponentMethod("rangeslider","makeData")(ge),!D&&K.length===F.length&&A.supplyDefaultsUpdateCalc(K,F)},A.supplyDefaultsUpdateCalc=function(Q,ee){for(var D=0;D<ee.length;D++){var le=ee[D],ge=(Q[D]||[])[0];if(ge&&ge.trace){var j=ge.trace;if(j._hasCalcTransform){var k=j._arrayAttrs,F,J,K;for(F=0;F<k.length;F++)J=k[F],K=o.nestedProperty(j,J).get().slice(),o.nestedProperty(le,J).set(K)}ge.trace=le}}};function U(Q,ee){var D=ee.length,le=[],ge,j;for(ge=0;ge<Q.length;ge++){var k=Q[ge]._fullInput;k!==j&&le.push(k),j=k}var F=le.length,J=new Array(D),K={};function ve(Fe,Ge){J[Ge]=Fe,K[Fe]=1}function Te(Fe,Ge){if(Fe&&typeof Fe=="string"&&!K[Fe])return ve(Fe,Ge),!0}for(ge=0;ge<D;ge++){var Ae=ee[ge].uid;typeof Ae=="number"&&(Ae=String(Ae)),!Te(Ae,ge)&&(ge<F&&Te(le[ge].uid,ge)||ve(o.randstr(K),ge))}return J}function P(){var Q=h.collectableSubplotTypes,ee={},D,le;if(!Q){Q=[];var ge=h.subplotsRegistry;for(var j in ge){var k=ge[j],F=k.attr;if(F&&(Q.push(j),Array.isArray(F)))for(le=0;le<F.length;le++)o.pushUnique(Q,F[le])}}for(D=0;D<Q.length;D++)ee[Q[D]]=[];return ee}function re(Q,ee){var D=Q._context.locale;D||(D="en-US");var le=!1,ge={};function j(Te){for(var Ae=!0,Fe=0;Fe<ee.length;Fe++){var Ge=ee[Fe];ge[Ge]||(Te[Ge]?ge[Ge]=Te[Ge]:Ae=!1)}Ae&&(le=!0)}for(var k=0;k<2;k++){for(var F=Q._context.locales,J=0;J<2;J++){var K=(F[D]||{}).format;if(K&&(j(K),le))break;F=h.localeRegistry}var ve=D.split("-")[0];if(le||ve===D)break;D=ve}return le||j(h.localeRegistry.en.format),ge}function G(Q,ee){return Q.decimal=ee.charAt(0),Q.thousands=ee.charAt(1),{numberFormat:function(D){try{D=s(Q).format(o.adjustFormat(D))}catch{return o.warnBadFormat(D),o.noFormat}return D},timeFormat:i(Q).utcFormat}}function Z(Q,ee){var D,le=[];ee.meta&&(D=ee._meta={meta:ee.meta,layout:{meta:ee.meta}});for(var ge=0;ge<Q.length;ge++){var j=Q[ge];j.meta?le[j.index]=j._meta={meta:j.meta}:ee.meta&&(j._meta={meta:ee.meta}),ee.meta&&(j._meta.layout={meta:ee.meta})}le.length&&(D||(D=ee._meta={}),D.data=le)}A.createTransitionData=function(Q){Q._transitionData||(Q._transitionData={}),Q._transitionData._frames||(Q._transitionData._frames=[]),Q._transitionData._frameHash||(Q._transitionData._frameHash={}),Q._transitionData._counter||(Q._transitionData._counter=0),Q._transitionData._interruptCallbacks||(Q._transitionData._interruptCallbacks=[])},A._hasPlotType=function(Q){var ee,D=this._basePlotModules||[];for(ee=0;ee<D.length;ee++)if(D[ee].name===Q)return!0;var le=this._modules||[];for(ee=0;ee<le.length;ee++){var ge=le[ee].name;if(ge===Q)return!0;var j=h.modules[ge];if(j&&j.categories[Q])return!0}return!1},A.cleanPlot=function(Q,ee,D,le){var ge,j,k=le._basePlotModules||[];for(ge=0;ge<k.length;ge++){var F=k[ge];F.clean&&F.clean(Q,ee,D,le)}var J=le._has&&le._has("gl"),K=ee._has&&ee._has("gl");J&&!K&&le._glcontainer!==void 0&&(le._glcontainer.selectAll(".gl-canvas").remove(),le._glcontainer.selectAll(".no-webgl").remove(),le._glcanvas=null);var ve=!!le._infolayer;e:for(ge=0;ge<D.length;ge++){var Te=D[ge],Ae=Te.uid;for(j=0;j<Q.length;j++){var Fe=Q[j];if(Ae===Fe.uid)continue e}ve&&le._infolayer.select(".cb"+Ae).remove()}},A.linkSubplots=function(Q,ee,D,le){var ge,j,k=le._plots||{},F=ee._plots={},J=ee._subplots,K={_fullData:Q,_fullLayout:ee},ve=J.cartesian||[];for(ge=0;ge<ve.length;ge++){var Te=ve[ge],Ae=k[Te],Fe=b.getFromId(K,Te,"x"),Ge=b.getFromId(K,Te,"y"),rt;for(Ae?rt=F[Te]=Ae:(rt=F[Te]={},rt.id=Te),Fe._counterAxes.push(Ge._id),Ge._counterAxes.push(Fe._id),Fe._subplotsWith.push(Te),Ge._subplotsWith.push(Te),rt.xaxis=Fe,rt.yaxis=Ge,rt._hasClipOnAxisFalse=!1,j=0;j<Q.length;j++){var bt=Q[j];if(bt.xaxis===rt.xaxis._id&&bt.yaxis===rt.yaxis._id&&bt.cliponaxis===!1){rt._hasClipOnAxisFalse=!0;break}}}var ht=b.list(K,null,!0),ct;for(ge=0;ge<ht.length;ge++){ct=ht[ge];var Oe=null;ct.overlaying&&(Oe=b.getFromId(K,ct.overlaying),Oe&&Oe.overlaying&&(ct.overlaying=!1,Oe=null)),ct._mainAxis=Oe||ct,Oe&&(ct.domain=Oe.domain.slice()),ct._anchorAxis=ct.anchor==="free"?null:b.getFromId(K,ct.anchor)}for(ge=0;ge<ht.length;ge++)if(ct=ht[ge],ct._counterAxes.sort(b.idSort),ct._subplotsWith.sort(o.subplotSort),ct._mainSubplot=Y(ct,ee),ct._counterAxes.length&&(ct.spikemode&&ct.spikemode.indexOf("across")!==-1||ct.automargin&&ct.mirror&&ct.anchor!=="free"||h.getComponentMethod("rangeslider","isVisible")(ct))){var ze=1,we=0;for(j=0;j<ct._counterAxes.length;j++){var je=b.getFromId(K,ct._counterAxes[j]);ze=Math.min(ze,je.domain[0]),we=Math.max(we,je.domain[1])}ze<we&&(ct._counterDomainMin=ze,ct._counterDomainMax=we)}};function Y(Q,ee){var D={_fullLayout:ee},le=Q._id.charAt(0)==="x",ge=Q._mainAxis._anchorAxis,j="",k="",F="";if(ge&&(F=ge._mainAxis._id,j=le?Q._id+F:F+Q._id),!j||!ee._plots[j]){j="";for(var J=Q._counterAxes,K=0;K<J.length;K++){var ve=J[K],Te=le?Q._id+ve:ve+Q._id;k||(k=Te);var Ae=b.getFromId(D,ve);if(F&&Ae.overlaying===F){j=Te;break}}}return j||k}A.clearExpandedTraceDefaultColors=function(Q){var ee,D,le;function ge(k,F,J,K){D[K]=F,D.length=K+1,k.valType==="color"&&k.dflt===void 0&&ee.push(D.join("."))}for(D=[],ee=Q._module._colorAttrs,ee||(Q._module._colorAttrs=ee=[],p.crawl(Q._module.attributes,ge)),le=0;le<ee.length;le++){var j=o.nestedProperty(Q,"_input."+ee[le]);j.get()||o.nestedProperty(Q,ee[le]).set(null)}},A.supplyDataDefaults=function(Q,ee,D,le){var ge=le._modules,j=le._visibleModules,k=le._basePlotModules,F=0,J,K,ve;le._transformModules=[];function Te(ht){ee.push(ht);var ct=ht._module;ct&&(o.pushUnique(ge,ct),ht.visible===!0&&o.pushUnique(j,ct),o.pushUnique(k,ht._module.basePlotModule),ht._input.visible!==!1&&F++)}var Ae={},Fe=[],Ge=(D.template||{}).data||{},rt=v.traceTemplater(Ge);for(J=0;J<Q.length;J++)ve=Q[J],K=rt.newTrace(ve),K.uid=le._traceUids[J],A.supplyTraceDefaults(ve,K,F,le,J),K.index=J,K._input=ve,K._fullInput=K,Te(K),h.traceIs(K,"carpetAxis")&&(Ae[K.carpet]=K),h.traceIs(K,"carpetDependent")&&Fe.push(J);for(J=0;J<Fe.length;J++)if(K=ee[Fe[J]],!!K.visible){var bt=Ae[K.carpet];if(K._carpet=bt,!bt||!bt.visible){K.visible=!1;continue}K.xaxis=bt.xaxis,K.yaxis=bt.yaxis}},A.supplyAnimationDefaults=function(Q){Q=Q||{};var ee,D={};function le(ge,j){return o.coerce(Q||{},D,M,ge,j)}if(le("mode"),le("direction"),le("fromcurrent"),Array.isArray(Q.frame))for(D.frame=[],ee=0;ee<Q.frame.length;ee++)D.frame[ee]=A.supplyAnimationFrameDefaults(Q.frame[ee]||{});else D.frame=A.supplyAnimationFrameDefaults(Q.frame||{});if(Array.isArray(Q.transition))for(D.transition=[],ee=0;ee<Q.transition.length;ee++)D.transition[ee]=A.supplyAnimationTransitionDefaults(Q.transition[ee]||{});else D.transition=A.supplyAnimationTransitionDefaults(Q.transition||{});return D},A.supplyAnimationFrameDefaults=function(Q){var ee={};function D(le,ge){return o.coerce(Q||{},ee,M.frame,le,ge)}return D("duration"),D("redraw"),ee},A.supplyAnimationTransitionDefaults=function(Q){var ee={};function D(le,ge){return o.coerce(Q||{},ee,M.transition,le,ge)}return D("duration"),D("easing"),ee},A.supplyFrameDefaults=function(Q){var ee={};function D(le,ge){return o.coerce(Q,ee,T,le,ge)}return D("group"),D("name"),D("traces"),D("baseframe"),D("data"),D("layout"),ee},A.supplyTraceDefaults=function(Q,ee,D,le,ge){var j=le.colorway||w.defaults,k=j[D%j.length],F;function J(Oe,ze){return o.coerce(Q,ee,A.attributes,Oe,ze)}var K=J("visible");J("type"),J("name",le._traceWord+" "+ge),J("uirevision",le.uirevision);var ve=A.getModule(ee);if(ee._module=ve,ve){var Te=ve.basePlotModule,Ae=Te.attr,Fe=Te.attributes;if(Ae&&Fe){var Ge=le._subplots,rt="";if(Array.isArray(Ae))for(F=0;F<Ae.length;F++){var bt=Ae[F],ht=o.coerce(Q,ee,Fe,bt);Ge[bt]&&o.pushUnique(Ge[bt],ht),rt+=ht}else rt=o.coerce(Q,ee,Fe,Ae);Ge[Te.name]&&o.pushUnique(Ge[Te.name],rt)}}if(K&&(J("customdata"),J("ids"),J("meta"),h.traceIs(ee,"showLegend")?(o.coerce(Q,ee,ve.attributes.showlegend?ve.attributes:A.attributes,"showlegend"),J("legend"),J("legendwidth"),J("legendgroup"),J("legendgrouptitle.text"),J("legendrank"),ee._dfltShowLegend=!0):ee._dfltShowLegend=!1,ve&&ve.supplyDefaults(Q,ee,k,le),h.traceIs(ee,"noOpacity")||J("opacity"),h.traceIs(ee,"notLegendIsolatable")&&(ee.visible=!!ee.visible),h.traceIs(ee,"noHover")||(ee.hovertemplate||o.coerceHoverinfo(Q,ee,le),ee.type!=="parcats"&&h.getComponentMethod("fx","supplyDefaults")(Q,ee,k,le)),ve&&ve.selectPoints)){var ct=J("selectedpoints");o.isTypedArray(ct)&&(ee.selectedpoints=Array.from(ct))}return ee},A.supplyLayoutGlobalDefaults=function(Q,ee,D){function le(Te,Ae){return o.coerce(Q,ee,A.layoutAttributes,Te,Ae)}var ge=Q.template;o.isPlainObject(ge)&&(ee.template=ge,ee._template=ge.layout,ee._dataTemplate=ge.data),le("autotypenumbers");var j=o.coerceFont(le,"font"),k=j.size;o.coerceFont(le,"title.font",j,{overrideDflt:{size:Math.round(k*1.4)}}),le("title.text",ee._dfltTitle.plot),le("title.xref");var F=le("title.yref");le("title.pad.t"),le("title.pad.r"),le("title.pad.b"),le("title.pad.l");var J=le("title.automargin");le("title.x"),le("title.xanchor"),le("title.y"),le("title.yanchor"),le("title.subtitle.text",ee._dfltTitle.subtitle),o.coerceFont(le,"title.subtitle.font",j,{overrideDflt:{size:Math.round(ee.title.font.size*.7)}}),J&&(F==="paper"&&(ee.title.y!==0&&(ee.title.y=1),ee.title.yanchor==="auto"&&(ee.title.yanchor=ee.title.y===0?"top":"bottom")),F==="container"&&(ee.title.y==="auto"&&(ee.title.y=1),ee.title.yanchor==="auto"&&(ee.title.yanchor=ee.title.y<.5?"bottom":"top")));var K=le("uniformtext.mode");K&&le("uniformtext.minsize"),le("autosize",!(Q.width&&Q.height)),le("width"),le("height"),le("minreducedwidth"),le("minreducedheight"),le("margin.l"),le("margin.r"),le("margin.t"),le("margin.b"),le("margin.pad"),le("margin.autoexpand"),Q.width&&Q.height&&A.sanitizeMargins(ee),h.getComponentMethod("grid","sizeDefaults")(Q,ee),le("paper_bgcolor"),le("separators",D.decimal+D.thousands),le("hidesources"),le("colorway"),le("datarevision");var ve=le("uirevision");le("editrevision",ve),le("selectionrevision",ve),h.getComponentMethod("modebar","supplyLayoutDefaults")(Q,ee),h.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(Q,ee,le),h.getComponentMethod("selections","supplyDrawNewSelectionDefaults")(Q,ee,le),le("meta"),o.isPlainObject(Q.transition)&&(le("transition.duration"),le("transition.easing"),le("transition.ordering")),h.getComponentMethod("calendars","handleDefaults")(Q,ee,"calendar"),h.getComponentMethod("fx","supplyLayoutGlobalDefaults")(Q,ee,le),o.coerce(Q,ee,S,"scattermode")};function X(Q){return typeof Q=="string"&&Q.substr(Q.length-2)==="px"&&parseFloat(Q)}A.plotAutoSize=function(Q,ee,D){var le=Q._context||{},ge=le.frameMargins,j,k,F=o.isPlotDiv(Q);if(F&&Q.emit("plotly_autosize"),le.fillFrame)j=window.innerWidth,k=window.innerHeight,document.body.style.overflow="hidden";else{var J=F?window.getComputedStyle(Q):{};if(j=X(J.width)||X(J.maxWidth)||D.width,k=X(J.height)||X(J.maxHeight)||D.height,f(ge)&&ge>0){var K=1-2*ge;j=Math.round(K*j),k=Math.round(K*k)}}var ve=A.layoutAttributes.width.min,Te=A.layoutAttributes.height.min;j<ve&&(j=ve),k<Te&&(k=Te);var Ae=!ee.width&&Math.abs(D.width-j)>1,Fe=!ee.height&&Math.abs(D.height-k)>1;(Fe||Ae)&&(Ae&&(D.width=j),Fe&&(D.height=k)),Q._initialAutoSize||(Q._initialAutoSize={width:j,height:k}),A.sanitizeMargins(D)},A.supplyLayoutModuleDefaults=function(Q,ee,D,le){var ge=h.componentsRegistry,j=ee._basePlotModules,k,F,J,K=h.subplotsRegistry.cartesian;for(k in ge)J=ge[k],J.includeBasePlot&&J.includeBasePlot(Q,ee);j.length||j.push(K),ee._has("cartesian")&&(h.getComponentMethod("grid","contentDefaults")(Q,ee),K.finalizeSubplots(Q,ee));for(var ve in ee._subplots)ee._subplots[ve].sort(o.subplotSort);for(F=0;F<j.length;F++)J=j[F],J.supplyLayoutDefaults&&J.supplyLayoutDefaults(Q,ee,D);var Te=ee._modules;for(F=0;F<Te.length;F++)J=Te[F],J.supplyLayoutDefaults&&J.supplyLayoutDefaults(Q,ee,D);var Ae=ee._transformModules;for(F=0;F<Ae.length;F++)J=Ae[F],J.supplyLayoutDefaults&&J.supplyLayoutDefaults(Q,ee,D,le);for(k in ge)J=ge[k],J.supplyLayoutDefaults&&J.supplyLayoutDefaults(Q,ee,D)},A.purge=function(Q){var ee=Q._fullLayout||{};ee._glcontainer!==void 0&&(ee._glcontainer.selectAll(".gl-canvas").remove(),ee._glcontainer.remove(),ee._glcanvas=null),ee._modeBar&&ee._modeBar.destroy(),Q._transitionData&&(Q._transitionData._interruptCallbacks&&(Q._transitionData._interruptCallbacks.length=0),Q._transitionData._animationRaf&&window.cancelAnimationFrame(Q._transitionData._animationRaf)),o.clearThrottle(),o.clearResponsive(Q),delete Q.data,delete Q.layout,delete Q._fullData,delete Q._fullLayout,delete Q.calcdata,delete Q.empty,delete Q.fid,delete Q.undoqueue,delete Q.undonum,delete Q.autoplay,delete Q.changed,delete Q._promises,delete Q._redrawTimer,delete Q._hmlumcount,delete Q._hmpixcount,delete Q._transitionData,delete Q._transitioning,delete Q._initialAutoSize,delete Q._transitioningWithDuration,delete Q._dragging,delete Q._dragged,delete Q._dragdata,delete Q._hoverdata,delete Q._snapshotInProgress,delete Q._editing,delete Q._mouseDownTime,delete Q._legendMouseDownTime,Q.removeAllListeners&&Q.removeAllListeners()},A.style=function(Q){var ee=Q._fullLayout._visibleModules,D=[],le;for(le=0;le<ee.length;le++){var ge=ee[le];ge.style&&o.pushUnique(D,ge.style)}for(le=0;le<D.length;le++)D[le](Q)},A.sanitizeMargins=function(Q){if(!(!Q||!Q.margin)){var ee=Q.width,D=Q.height,le=Q.margin,ge=ee-(le.l+le.r),j=D-(le.t+le.b),k;ge<0&&(k=(ee-1)/(le.l+le.r),le.l=Math.floor(k*le.l),le.r=Math.floor(k*le.r)),j<0&&(k=(D-1)/(le.t+le.b),le.t=Math.floor(k*le.t),le.b=Math.floor(k*le.b))}},A.clearAutoMarginIds=function(Q){Q._fullLayout._pushmarginIds={}},A.allowAutoMargin=function(Q,ee){Q._fullLayout._pushmarginIds[ee]=1};function ne(Q){var ee=Q.margin;if(!Q._size){var D=Q._size={l:Math.round(ee.l),r:Math.round(ee.r),t:Math.round(ee.t),b:Math.round(ee.b),p:Math.round(ee.pad)};D.w=Math.round(Q.width)-D.l-D.r,D.h=Math.round(Q.height)-D.t-D.b}Q._pushmargin||(Q._pushmargin={}),Q._pushmarginIds||(Q._pushmarginIds={}),Q._reservedMargin||(Q._reservedMargin={})}var ae=2,B=2;A.autoMargin=function(Q,ee,D){var le=Q._fullLayout,ge=le.width,j=le.height,k=le.margin,F=le.minreducedwidth,J=le.minreducedheight,K=o.constrain(ge-k.l-k.r,ae,F),ve=o.constrain(j-k.t-k.b,B,J),Te=Math.max(0,ge-K),Ae=Math.max(0,j-ve),Fe=le._pushmargin,Ge=le._pushmarginIds;if(k.autoexpand!==!1){if(!D)delete Fe[ee],delete Ge[ee];else{var rt=D.pad;if(rt===void 0&&(rt=Math.min(12,k.l,k.r,k.t,k.b)),Te){var bt=(D.l+D.r)/Te;bt>1&&(D.l/=bt,D.r/=bt)}if(Ae){var ht=(D.t+D.b)/Ae;ht>1&&(D.t/=ht,D.b/=ht)}var ct=D.xl!==void 0?D.xl:D.x,Oe=D.xr!==void 0?D.xr:D.x,ze=D.yt!==void 0?D.yt:D.y,we=D.yb!==void 0?D.yb:D.y;Fe[ee]={l:{val:ct,size:D.l+rt},r:{val:Oe,size:D.r+rt},b:{val:we,size:D.b+rt},t:{val:ze,size:D.t+rt}},Ge[ee]=1}if(!le._replotting)return A.doAutoMargin(Q)}};function ie(Q){if("_redrawFromAutoMarginCount"in Q._fullLayout)return!1;var ee=b.list(Q,"",!0);for(var D in ee)if(ee[D].autoshift||ee[D].shift)return!0;return!1}A.doAutoMargin=function(Q){var ee=Q._fullLayout,D=ee.width,le=ee.height;ee._size||(ee._size={}),ne(ee);var ge=ee._size,j=ee.margin,k={t:0,b:0,l:0,r:0},F=o.extendFlat({},ge),J=j.l,K=j.r,ve=j.t,Te=j.b,Ae=ee._pushmargin,Fe=ee._pushmarginIds,Ge=ee.minreducedwidth,rt=ee.minreducedheight;if(j.autoexpand!==!1){for(var bt in Ae)Fe[bt]||delete Ae[bt];var ht=Q._fullLayout._reservedMargin;for(var ct in ht)for(var Oe in ht[ct]){var ze=ht[ct][Oe];k[Oe]=Math.max(k[Oe],ze)}Ae.base={l:{val:0,size:J},r:{val:1,size:K},t:{val:1,size:ve},b:{val:0,size:Te}};for(var we in k){var je=0;for(var ot in Ae)ot!=="base"&&f(Ae[ot][we].size)&&(je=Ae[ot][we].size>je?Ae[ot][we].size:je);var vt=Math.max(0,j[we]-je);k[we]=Math.max(0,k[we]-vt)}for(var Lt in Ae){var Tt=Ae[Lt].l||{},kt=Ae[Lt].b||{},Nt=Tt.val,Pt=Tt.size,Wt=kt.val,St=kt.size,Qt=D-k.r-k.l,rr=le-k.t-k.b;for(var Jt in Ae){if(f(Pt)&&Ae[Jt].r){var sr=Ae[Jt].r.val,De=Ae[Jt].r.size;if(sr>Nt){var Je=(Pt*sr+(De-Qt)*Nt)/(sr-Nt),de=(De*(1-Nt)+(Pt-Qt)*(1-sr))/(sr-Nt);Je+de>J+K&&(J=Je,K=de)}}if(f(St)&&Ae[Jt].t){var Me=Ae[Jt].t.val,Ce=Ae[Jt].t.size;if(Me>Wt){var Ue=(St*Me+(Ce-rr)*Wt)/(Me-Wt),He=(Ce*(1-Wt)+(St-rr)*(1-Me))/(Me-Wt);Ue+He>Te+ve&&(Te=Ue,ve=He)}}}}}var et=o.constrain(D-j.l-j.r,ae,Ge),at=o.constrain(le-j.t-j.b,B,rt),xt=Math.max(0,D-et),mt=Math.max(0,le-at);if(xt){var yt=(J+K)/xt;yt>1&&(J/=yt,K/=yt)}if(mt){var It=(Te+ve)/mt;It>1&&(Te/=It,ve/=It)}if(ge.l=Math.round(J)+k.l,ge.r=Math.round(K)+k.r,ge.t=Math.round(ve)+k.t,ge.b=Math.round(Te)+k.b,ge.p=Math.round(j.pad),ge.w=Math.round(D)-ge.l-ge.r,ge.h=Math.round(le)-ge.t-ge.b,!ee._replotting&&(A.didMarginChange(F,ge)||ie(Q))){"_redrawFromAutoMarginCount"in ee?ee._redrawFromAutoMarginCount++:ee._redrawFromAutoMarginCount=1;var zt=3*(1+Object.keys(Fe).length);if(ee._redrawFromAutoMarginCount<zt)return h.call("_doPlot",Q);ee._size=F,o.warn("Too many auto-margin redraws.")}se(Q)};function se(Q){var ee=b.list(Q,"",!0);["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(D){for(var le=0;le<ee.length;le++){var ge=ee[le][D];ge&&ge()}})}var ye=["l","r","t","b","p","w","h"];A.didMarginChange=function(Q,ee){for(var D=0;D<ye.length;D++){var le=ye[D],ge=Q[le],j=ee[le];if(!f(ge)||Math.abs(j-ge)>1)return!0}return!1},A.graphJson=function(Q,ee,D,le,ge,j){(ge&&ee&&!Q._fullData||ge&&!ee&&!Q._fullLayout)&&A.supplyDefaults(Q);var k=ge?Q._fullData:Q.data,F=ge?Q._fullLayout:Q.layout,J=(Q._transitionData||{})._frames;function K(Ae,Fe){if(typeof Ae=="function")return Fe?"_function_":null;if(o.isPlainObject(Ae)){var Ge={},rt;return Object.keys(Ae).sort().forEach(function(Oe){if(["_","["].indexOf(Oe.charAt(0))===-1){if(typeof Ae[Oe]=="function"){Fe&&(Ge[Oe]="_function");return}if(D==="keepdata"){if(Oe.substr(Oe.length-3)==="src")return}else if(D==="keepstream"){if(rt=Ae[Oe+"src"],typeof rt=="string"&&rt.indexOf(":")>0&&!o.isPlainObject(Ae.stream))return}else if(D!=="keepall"&&(rt=Ae[Oe+"src"],typeof rt=="string"&&rt.indexOf(":")>0))return;Ge[Oe]=K(Ae[Oe],Fe)}}),Ge}var bt=Array.isArray(Ae),ht=o.isTypedArray(Ae);if((bt||ht)&&Ae.dtype&&Ae.shape){var ct=Ae.bdata;return K({dtype:Ae.dtype,shape:Ae.shape,bdata:o.isArrayBuffer(ct)?u.encode(ct):ct},Fe)}return bt?Ae.map(function(Oe){return K(Oe,Fe)}):ht?o.simpleMap(Ae,o.identity):o.isJSDate(Ae)?o.ms2DateTimeLocal(+Ae):Ae}var ve={data:(k||[]).map(function(Ae){var Fe=K(Ae);return ee&&delete Fe.fit,Fe})};if(!ee&&(ve.layout=K(F),ge)){var Te=F._size;ve.layout.computed={margin:{b:Te.b,l:Te.l,r:Te.r,t:Te.t}}}return J&&(ve.frames=K(J)),j&&(ve.config=K(Q._context,!0)),le==="object"?ve:JSON.stringify(ve)},A.modifyFrames=function(Q,ee){var D,le,ge,j=Q._transitionData._frames,k=Q._transitionData._frameHash;for(D=0;D<ee.length;D++)switch(le=ee[D],le.type){case"replace":ge=le.value;var F=(j[le.index]||{}).name,J=ge.name;j[le.index]=k[J]=ge,J!==F&&(delete k[F],k[J]=ge);break;case"insert":ge=le.value,k[ge.name]=ge,j.splice(le.index,0,ge);break;case"delete":ge=j[le.index],delete k[ge.name],j.splice(le.index,1);break}return Promise.resolve()},A.computeFrame=function(Q,ee){var D=Q._transitionData._frameHash,le,ge,j,k;if(!ee)throw new Error("computeFrame must be given a string frame name");var F=D[ee.toString()];if(!F)return!1;for(var J=[F],K=[F.name];F.baseframe&&(F=D[F.baseframe.toString()])&&K.indexOf(F.name)===-1;)J.push(F),K.push(F.name);for(var ve={};F=J.pop();)if(F.layout&&(ve.layout=A.extendLayout(ve.layout,F.layout)),F.data){if(ve.data||(ve.data=[]),ge=F.traces,!ge)for(ge=[],le=0;le<F.data.length;le++)ge[le]=le;for(ve.traces||(ve.traces=[]),le=0;le<F.data.length;le++)j=ge[le],j!=null&&(k=ve.traces.indexOf(j),k===-1&&(k=ve.data.length,ve.traces[k]=j),ve.data[k]=A.extendTrace(ve.data[k],F.data[le]))}return ve},A.recomputeFrameHash=function(Q){for(var ee=Q._transitionData._frameHash={},D=Q._transitionData._frames,le=0;le<D.length;le++){var ge=D[le];ge&&ge.name&&(ee[ge.name]=ge)}},A.extendObjectWithContainers=function(Q,ee,D){var le,ge,j,k,F,J,K,ve,Te=o.extendDeepNoArrays({},ee||{}),Ae=o.expandObjectPaths(Te),Fe={};if(D&&D.length)for(j=0;j<D.length;j++)le=o.nestedProperty(Ae,D[j]),ge=le.get(),ge===void 0?o.nestedProperty(Fe,D[j]).set(null):(le.set(null),o.nestedProperty(Fe,D[j]).set(ge));if(Q=o.extendDeepNoArrays(Q||{},Ae),D&&D.length){for(j=0;j<D.length;j++)if(F=o.nestedProperty(Fe,D[j]),K=F.get(),!!K){for(J=o.nestedProperty(Q,D[j]),ve=J.get(),Array.isArray(ve)||(ve=[],J.set(ve)),k=0;k<K.length;k++){var Ge=K[k];Ge===null?ve[k]=null:ve[k]=A.extendObjectWithContainers(ve[k],Ge)}J.set(ve)}}return Q},A.dataArrayContainers=["transforms","dimensions"],A.layoutArrayContainers=h.layoutArrayContainers,A.extendTrace=function(Q,ee){return A.extendObjectWithContainers(Q,ee,A.dataArrayContainers)},A.extendLayout=function(Q,ee){return A.extendObjectWithContainers(Q,ee,A.layoutArrayContainers)},A.transition=function(Q,ee,D,le,ge,j){var k={redraw:ge.redraw},F={},J=[];return k.prepareFn=function(){for(var K=Array.isArray(ee)?ee.length:0,ve=le.slice(0,K),Te=0;Te<ve.length;Te++){var Ae=ve[Te],Fe=Q._fullData[Ae],Ge=Fe._module;if(Ge){if(Ge.animatable){var rt=Ge.basePlotModule.name;F[rt]||(F[rt]=[]),F[rt].push(Ae)}Q.data[ve[Te]]=A.extendTrace(Q.data[ve[Te]],ee[Te])}}var bt=o.expandObjectPaths(o.extendDeepNoArrays({},D)),ht=/^[xy]axis[0-9]*$/;for(var ct in bt)ht.test(ct)&&delete bt[ct].range;A.extendLayout(Q.layout,bt),delete Q.calcdata,A.supplyDefaults(Q),A.doCalcdata(Q);var Oe=o.expandObjectPaths(D);if(Oe){var ze=Q._fullLayout._plots;for(var we in ze){var je=ze[we],ot=je.xaxis,vt=je.yaxis,Lt=ot.range.slice(),Tt=vt.range.slice(),kt=null,Nt=null,Pt=null,Wt=null;Array.isArray(Oe[ot._name+".range"])?kt=Oe[ot._name+".range"].slice():Array.isArray((Oe[ot._name]||{}).range)&&(kt=Oe[ot._name].range.slice()),Array.isArray(Oe[vt._name+".range"])?Nt=Oe[vt._name+".range"].slice():Array.isArray((Oe[vt._name]||{}).range)&&(Nt=Oe[vt._name].range.slice()),Lt&&kt&&(ot.r2l(Lt[0])!==ot.r2l(kt[0])||ot.r2l(Lt[1])!==ot.r2l(kt[1]))&&(Pt={xr0:Lt,xr1:kt}),Tt&&Nt&&(vt.r2l(Tt[0])!==vt.r2l(Nt[0])||vt.r2l(Tt[1])!==vt.r2l(Nt[1]))&&(Wt={yr0:Tt,yr1:Nt}),(Pt||Wt)&&J.push(o.extendFlat({plotinfo:je},Pt,Wt))}}return Promise.resolve()},k.runFn=function(K){var ve,Te=Q._fullLayout._basePlotModules,Ae=J.length,Fe;if(D)for(Fe=0;Fe<Te.length;Fe++)Te[Fe].transitionAxes&&Te[Fe].transitionAxes(Q,J,j,K);Ae?(ve=o.extendFlat({},j),ve.duration=0,delete F.cartesian):ve=j;for(var Ge in F){var rt=F[Ge],bt=Q._fullData[rt[0]]._module;bt.basePlotModule.plot(Q,rt,ve,K)}},me(Q,j,k)},A.transitionFromReact=function(Q,ee,D,le){var ge=Q._fullLayout,j=ge.transition,k={},F=[];return k.prepareFn=function(){var J=ge._plots;k.redraw=!1,ee.anim==="some"&&(k.redraw=!0),D.anim==="some"&&(k.redraw=!0);for(var K in J){var ve=J[K],Te=ve.xaxis,Ae=ve.yaxis,Fe=le[Te._name].range.slice(),Ge=le[Ae._name].range.slice(),rt=Te.range.slice(),bt=Ae.range.slice();Te.setScale(),Ae.setScale();var ht=null,ct=null;(Te.r2l(Fe[0])!==Te.r2l(rt[0])||Te.r2l(Fe[1])!==Te.r2l(rt[1]))&&(ht={xr0:Fe,xr1:rt}),(Ae.r2l(Ge[0])!==Ae.r2l(bt[0])||Ae.r2l(Ge[1])!==Ae.r2l(bt[1]))&&(ct={yr0:Ge,yr1:bt}),(ht||ct)&&F.push(o.extendFlat({plotinfo:ve},ht,ct))}return Promise.resolve()},k.runFn=function(J){for(var K=Q._fullData,ve=Q._fullLayout,Te=ve._basePlotModules,Ae,Fe,Ge,rt=[],bt=0;bt<K.length;bt++)rt.push(bt);function ht(){if(Q._fullLayout)for(var Oe=0;Oe<Te.length;Oe++)Te[Oe].transitionAxes&&Te[Oe].transitionAxes(Q,F,Ae,J)}function ct(){if(Q._fullLayout)for(var Oe=0;Oe<Te.length;Oe++)Te[Oe].plot(Q,Ge,Fe,J)}F.length&&ee.anim?j.ordering==="traces first"?(Ae=o.extendFlat({},j,{duration:0}),Ge=rt,Fe=j,setTimeout(ht,j.duration),ct()):(Ae=j,Ge=null,Fe=o.extendFlat({},j,{duration:0}),setTimeout(ct,Ae.duration),ht()):F.length?(Ae=j,ht()):ee.anim&&(Ge=rt,Fe=j,ct())},me(Q,j,k)};function me(Q,ee,D){var le=!1;function ge(Te){var Ae=Promise.resolve();if(!Te)return Ae;for(;Te.length;)Ae=Ae.then(Te.shift());return Ae}function j(Te){if(Te)for(;Te.length;)Te.shift()}function k(){return Q.emit("plotly_transitioning",[]),new Promise(function(Te){Q._transitioning=!0,ee.duration>0&&(Q._transitioningWithDuration=!0),Q._transitionData._interruptCallbacks.push(function(){le=!0}),D.redraw&&Q._transitionData._interruptCallbacks.push(function(){return h.call("redraw",Q)}),Q._transitionData._interruptCallbacks.push(function(){Q.emit("plotly_transitioninterrupted",[])});var Ae=0,Fe=0;function Ge(){return Ae++,function(){Fe++,!le&&Fe===Ae&&F(Te)}}D.runFn(Ge),setTimeout(Ge())})}function F(Te){if(Q._transitionData)return j(Q._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(D.redraw)return h.call("redraw",Q)}).then(function(){Q._transitioning=!1,Q._transitioningWithDuration=!1,Q.emit("plotly_transitioned",[])}).then(Te)}function J(){if(Q._transitionData)return Q._transitioning=!1,ge(Q._transitionData._interruptCallbacks)}var K=[A.previousPromises,J,D.prepareFn,A.rehover,A.reselect,k],ve=o.syncOrAsync(K,Q);return(!ve||!ve.then)&&(ve=Promise.resolve()),ve.then(function(){return Q})}A.doCalcdata=function(Q,ee){var D=b.list(Q),le=Q._fullData,ge=Q._fullLayout,j,k,F,J,K=new Array(le.length),ve=(Q.calcdata||[]).slice();for(Q.calcdata=K,ge._numBoxes=0,ge._numViolins=0,ge._violinScaleGroupStats={},Q._hmpixcount=0,Q._hmlumcount=0,ge._piecolormap={},ge._sunburstcolormap={},ge._treemapcolormap={},ge._iciclecolormap={},ge._funnelareacolormap={},F=0;F<le.length;F++)if(Array.isArray(ee)&&ee.indexOf(F)===-1){K[F]=ve[F];continue}for(F=0;F<le.length;F++)j=le[F],j._arrayAttrs=p.findArrayAttributes(j),j._extremes={};var Te=ge._subplots.polar||[];for(F=0;F<Te.length;F++)D.push(ge[Te[F]].radialaxis,ge[Te[F]].angularaxis);for(var Ae in ge._colorAxes){var Fe=ge[Ae];Fe.cauto!==!1&&(delete Fe.cmin,delete Fe.cmax)}var Ge=!1;function rt(ct){if(j=le[ct],k=j._module,j.visible===!0&&j.transforms){if(k&&k.calc){var Oe=k.calc(Q,j);Oe[0]&&Oe[0].t&&Oe[0].t._scene&&delete Oe[0].t._scene.dirty}for(J=0;J<j.transforms.length;J++){var ze=j.transforms[J];k=transformsRegistry[ze.type],k&&k.calcTransform&&(j._hasCalcTransform=!0,Ge=!0,k.calcTransform(Q,j,ze))}}}function bt(ct,Oe){if(j=le[ct],k=j._module,!!k.isContainer===Oe){var ze=[];if(j.visible===!0&&j._length!==0){delete j._indexToPoints;var we=j.transforms||[];for(J=we.length-1;J>=0;J--)if(we[J].enabled){j._indexToPoints=we[J]._indexToPoints;break}k&&k.calc&&(ze=k.calc(Q,j))}(!Array.isArray(ze)||!ze[0])&&(ze=[{x:g,y:g}]),ze[0].t||(ze[0].t={}),ze[0].trace=j,K[ct]=ze}}for(ke(D,le,ge),F=0;F<le.length;F++)bt(F,!0);for(F=0;F<le.length;F++)rt(F);for(Ge&&ke(D,le,ge),F=0;F<le.length;F++)bt(F,!0);for(F=0;F<le.length;F++)bt(F,!1);Ie(Q);var ht=Re(D,Q);if(ht.length){for(ge._numBoxes=0,ge._numViolins=0,F=0;F<ht.length;F++)bt(ht[F],!0);for(F=0;F<ht.length;F++)bt(ht[F],!1);Ie(Q)}h.getComponentMethod("fx","calc")(Q),h.getComponentMethod("errorbars","calc")(Q)};var xe=/(total|sum|min|max|mean|geometric mean|median) (ascending|descending)/;function Re(Q,ee){var D=[],le,ge,j,k,F;function J(Jt,sr,De){var Je=sr._id.charAt(0);if(Jt==="histogram2dcontour"){var de=sr._counterAxes[0],Me=b.getFromId(ee,de),Ce=Je==="x"||de==="x"&&Me.type==="category",Ue=Je==="y"||de==="y"&&Me.type==="category";return function(He,et){return He===0||et===0||Ce&&He===De[et].length-1||Ue&&et===De.length-1?-1:(Je==="y"?et:He)-1}}else return function(He,et){return Je==="y"?et:He}}var K={min:function(Jt){return o.aggNums(Math.min,null,Jt)},max:function(Jt){return o.aggNums(Math.max,null,Jt)},sum:function(Jt){return o.aggNums(function(sr,De){return sr+De},null,Jt)},total:function(Jt){return o.aggNums(function(sr,De){return sr+De},null,Jt)},mean:function(Jt){return o.mean(Jt)},"geometric mean":function(Jt){return o.geometricMean(Jt)},median:function(Jt){return o.median(Jt)}};function ve(Jt,sr){return Jt[1]-sr[1]}function Te(Jt,sr){return sr[1]-Jt[1]}for(le=0;le<Q.length;le++){var Ae=Q[le];if(Ae.type==="category"){var Fe=Ae.categoryorder.match(xe);if(Fe){var Ge=Fe[1],rt=Fe[2],bt=Ae._id.charAt(0),ht=bt==="x",ct=[];for(ge=0;ge<Ae._categories.length;ge++)ct.push([Ae._categories[ge],[]]);for(ge=0;ge<Ae._traceIndices.length;ge++){var Oe=Ae._traceIndices[ge],ze=ee._fullData[Oe];if(ze.visible===!0){var we=ze.type;h.traceIs(ze,"histogram")&&(delete ze._xautoBinFinished,delete ze._yautoBinFinished);var je=we==="splom",ot=we==="scattergl",vt=ee.calcdata[Oe];for(j=0;j<vt.length;j++){var Lt=vt[j],Tt,kt;if(je){var Nt=ze._axesDim[Ae._id];if(!ht){var Pt=ze._diag[Nt][0];Pt&&(Ae=ee._fullLayout[b.id2name(Pt)])}var Wt=Lt.trace.dimensions[Nt].values;for(k=0;k<Wt.length;k++)for(Tt=Ae._categoriesMap[Wt[k]],F=0;F<Lt.trace.dimensions.length;F++)if(F!==Nt){var St=Lt.trace.dimensions[F];ct[Tt][1].push(St.values[k])}}else if(ot){for(k=0;k<Lt.t.x.length;k++)ht?(Tt=Lt.t.x[k],kt=Lt.t.y[k]):(Tt=Lt.t.y[k],kt=Lt.t.x[k]),ct[Tt][1].push(kt);Lt.t&&Lt.t._scene&&delete Lt.t._scene.dirty}else if(Lt.hasOwnProperty("z")){kt=Lt.z;var Qt=J(ze.type,Ae,kt);for(k=0;k<kt.length;k++)for(F=0;F<kt[k].length;F++)Tt=Qt(F,k),Tt+1&&ct[Tt][1].push(kt[k][F])}else for(Tt=Lt.p,Tt===void 0&&(Tt=Lt[bt]),kt=Lt.s,kt===void 0&&(kt=Lt.v),kt===void 0&&(kt=ht?Lt.y:Lt.x),Array.isArray(kt)||(kt===void 0?kt=[]:kt=[kt]),k=0;k<kt.length;k++)ct[Tt][1].push(kt[k])}}}Ae._categoriesValue=ct;var rr=[];for(ge=0;ge<ct.length;ge++)rr.push([ct[ge][0],K[Ge](ct[ge][1])]);rr.sort(rt==="descending"?Te:ve),Ae._categoriesAggregatedValue=rr,Ae._initialCategories=rr.map(function(Jt){return Jt[0]}),D=D.concat(Ae.sortByInitialCategories())}}}return D}function ke(Q,ee,D){var le={};function ge(J){J.clearCalc(),J.type==="multicategory"&&J.setupMultiCategory(ee),le[J._id]=1}o.simpleMap(Q,ge);for(var j=D._axisMatchGroups||[],k=0;k<j.length;k++)for(var F in j[k])le[F]||ge(D[b.id2name(F)])}function Ie(Q){var ee=Q._fullLayout,D=ee._visibleModules,le={},ge,j,k;for(j=0;j<D.length;j++){var F=D[j],J=F.crossTraceCalc;if(J){var K=F.basePlotModule.name;le[K]?o.pushUnique(le[K],J):le[K]=[J]}}for(k in le){var ve=le[k],Te=ee._subplots[k];if(Array.isArray(Te))for(ge=0;ge<Te.length;ge++){var Ae=Te[ge],Fe=k==="cartesian"?ee._plots[Ae]:ee[Ae];for(j=0;j<ve.length;j++)ve[j](Q,Fe,Ae)}else for(j=0;j<ve.length;j++)ve[j](Q)}}A.rehover=function(Q){Q._fullLayout._rehover&&Q._fullLayout._rehover()},A.redrag=function(Q){Q._fullLayout._redrag&&Q._fullLayout._redrag()},A.reselect=function(Q){var ee=Q._fullLayout,D=(Q.layout||{}).selections,le=ee._previousSelections;ee._previousSelections=D;var ge=ee._reselect||JSON.stringify(D)!==JSON.stringify(le);h.getComponentMethod("selections","reselect")(Q,ge)},A.generalUpdatePerTraceModule=function(Q,ee,D,le){var ge=ee.traceHash,j={},k;for(k=0;k<D.length;k++){var F=D[k],J=F[0].trace;J.visible&&(j[J.type]=j[J.type]||[],j[J.type].push(F))}for(var K in ge)if(!j[K]){var ve=ge[K][0],Te=ve[0].trace;Te.visible=!1,j[K]=[ve]}for(var Ae in j){var Fe=j[Ae],Ge=Fe[0][0].trace._module;Ge.plot(Q,ee,o.filterVisible(Fe),le)}ee.traceHash=j},A.plotBasePlot=function(Q,ee,D,le,ge){var j=h.getModule(Q),k=C(ee.calcdata,j)[0];j.plot(ee,k,le,ge)},A.cleanBasePlot=function(Q,ee,D,le,ge){var j=ge._has&&ge._has(Q),k=D._has&&D._has(Q);j&&!k&&ge["_"+Q+"layer"].selectAll("g.trace").remove()}}),xi=t(W=>{W.xmlns="http://www.w3.org/2000/xmlns/",W.svg="http://www.w3.org/2000/svg",W.xlink="http://www.w3.org/1999/xlink",W.svgAttrs={xmlns:W.svg,"xmlns:xlink":W.xlink}}),fi=t((W,V)=>{V.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}}),ja=t(W=>{var V=l(),d=Mt(),i=d.strTranslate,s=xi(),f=fi().LINE_SPACING,u=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;W.convertToTspans=function(B,ie,se){var ye=B.text(),me=!B.attr("data-notex")&&ie&&ie._context.typesetMath&&typeof MathJax<"u"&&ye.match(u),xe=V.select(B.node().parentNode);if(xe.empty())return;var Re=B.attr("class")?B.attr("class").split(" ")[0]:"text";Re+="-math",xe.selectAll("svg."+Re).remove(),xe.selectAll("g."+Re+"-group").remove(),B.style("display",null).attr({"data-unformatted":ye,"data-math":"N"});function ke(){xe.empty()||(Re=B.attr("class")+"-math",xe.select("svg."+Re).remove()),B.text("").style("white-space","pre");var Ie=Y(B.node(),ye);Ie&&B.style("pointer-events","all"),W.positionText(B),se&&se.call(B)}return me?(ie&&ie._promises||[]).push(new Promise(function(Ie){B.style("display","none");var Q=parseInt(B.node().style.fontSize,10),ee={fontSize:Q};w(me[2],ee,function(D,le,ge){xe.selectAll("svg."+Re).remove(),xe.selectAll("g."+Re+"-group").remove();var j=D&&D.select("svg");if(!j||!j.node()){ke(),Ie();return}var k=xe.append("g").classed(Re+"-group",!0).attr({"pointer-events":"none","data-unformatted":ye,"data-math":"Y"});k.node().appendChild(j.node()),le&&le.node()&&j.node().insertBefore(le.node().cloneNode(!0),j.node().firstChild);var F=ge.width,J=ge.height;j.attr({class:Re,height:J,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var K=B.node().style.fill||"black",ve=j.select("g");ve.attr({fill:K,stroke:K});var Te=ve.node().getBoundingClientRect(),Ae=Te.width,Fe=Te.height;(Ae>F||Fe>J)&&(j.style("overflow","hidden"),Te=j.node().getBoundingClientRect(),Ae=Te.width,Fe=Te.height);var Ge=+B.attr("x"),rt=+B.attr("y"),bt=Q||B.node().getBoundingClientRect().height,ht=-bt/4;if(Re[0]==="y")k.attr({transform:"rotate("+[-90,Ge,rt]+")"+i(-Ae/2,ht-Fe/2)});else if(Re[0]==="l")rt=ht-Fe/2;else if(Re[0]==="a"&&Re.indexOf("atitle")!==0)Ge=0,rt=ht;else{var ct=B.attr("text-anchor");Ge=Ge-Ae*(ct==="middle"?.5:ct==="end"?1:0),rt=rt+ht-Fe/2}j.attr({x:Ge,y:rt}),se&&se.call(B,k),Ie(k)})})):ke(),B};var h=/(<|&lt;|&#60;)/g,p=/(>|&gt;|&#62;)/g;function v(B){return B.replace(h,"\\lt ").replace(p,"\\gt ")}var o=[["$","$"],["\\(","\\)"]];function w(B,ie,se){var ye=parseInt((MathJax.version||"").split(".")[0]);if(ye!==2&&ye!==3){d.warn("No MathJax version:",MathJax.version);return}var me,xe,Re,ke,Ie=function(){return xe=d.extendDeepAll({},MathJax.Hub.config),Re=MathJax.Hub.processSectionDelay,MathJax.Hub.processSectionDelay!==void 0&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:o},displayAlign:"left"})},Q=function(){xe=d.extendDeepAll({},MathJax.config),MathJax.config.tex||(MathJax.config.tex={}),MathJax.config.tex.inlineMath=o},ee=function(){if(me=MathJax.Hub.config.menuSettings.renderer,me!=="SVG")return MathJax.Hub.setRenderer("SVG")},D=function(){me=MathJax.config.startup.output,me!=="svg"&&(MathJax.config.startup.output="svg")},le=function(){var K="math-output-"+d.randstr({},64);ke=V.select("body").append("div").attr({id:K}).style({visibility:"hidden",position:"absolute","font-size":ie.fontSize+"px"}).text(v(B));var ve=ke.node();return ye===2?MathJax.Hub.Typeset(ve):MathJax.typeset([ve])},ge=function(){var K=ke.select(ye===2?".MathJax_SVG":".MathJax"),ve=!K.empty()&&ke.select("svg").node();if(!ve)d.log("There was an error in the tex syntax.",B),se();else{var Te=ve.getBoundingClientRect(),Ae;ye===2?Ae=V.select("body").select("#MathJax_SVG_glyphs"):Ae=K.select("defs"),se(K,Ae,Te)}ke.remove()},j=function(){if(me!=="SVG")return MathJax.Hub.setRenderer(me)},k=function(){me!=="svg"&&(MathJax.config.startup.output=me)},F=function(){return Re!==void 0&&(MathJax.Hub.processSectionDelay=Re),MathJax.Hub.Config(xe)},J=function(){MathJax.config=xe};ye===2?MathJax.Hub.Queue(Ie,ee,le,ge,j,F):ye===3&&(Q(),D(),MathJax.startup.defaultReady(),MathJax.startup.promise.then(function(){le(),ge(),k(),J()}))}var g={sup:"font-size:70%",sub:"font-size:70%",s:"text-decoration:line-through",u:"text-decoration:underline",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},b={sub:"0.3em",sup:"-0.6em"},L={sub:"-0.21em",sup:"0.42em"},S="",M=["http:","https:","mailto:","",void 0,":"],T=W.NEWLINES=/(\r\n?|\n)/g,C=/(<[^<>]*>)/,m=/<(\/?)([^ >]*)(\s+(.*))?>/i,y=/<br(\s+.*)?>/i;W.BR_TAG_ALL=/<br(\s+.*)?>/gi;var A=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,R=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,N=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,te=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function H(B,ie){if(!B)return null;var se=B.match(ie),ye=se&&(se[3]||se[4]);return ye&&G(ye)}var U=/(^|;)\s*color:/;W.plainText=function(B,ie){ie=ie||{};for(var se=ie.len!==void 0&&ie.len!==-1?ie.len:1/0,ye=ie.allowedTags!==void 0?ie.allowedTags:["br"],me="...",xe=me.length,Re=B.split(C),ke=[],Ie="",Q=0,ee=0;ee<Re.length;ee++){var D=Re[ee],le=D.match(m),ge=le&&le[2].toLowerCase();if(ge)ye.indexOf(ge)!==-1&&(ke.push(D),Ie=ge);else{var j=D.length;if(Q+j<se)ke.push(D),Q+=j;else if(Q<se){var k=se-Q;Ie&&(Ie!=="br"||k<=xe||j<=xe)&&ke.pop(),se>xe?ke.push(D.substr(0,k-xe)+me):ke.push(D.substr(0,k));break}Ie=""}}return ke.join("")};var P={mu:"",amp:"&",lt:"<",gt:">",nbsp:"",times:"",plusmn:"",deg:""},re=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function G(B){return B.replace(re,function(ie,se){var ye;return se.charAt(0)==="#"?ye=Z(se.charAt(1)==="x"?parseInt(se.substr(2),16):parseInt(se.substr(1),10)):ye=P[se],ye||ie})}W.convertEntities=G;function Z(B){if(!(B>1114111)){var ie=String.fromCodePoint;if(ie)return ie(B);var se=String.fromCharCode;return B<=65535?se(B):se((B>>10)+55232,B%1024+56320)}}function Y(B,ie){ie=ie.replace(T," ");var se=!1,ye=[],me,xe=-1;function Re(){xe++;var Fe=document.createElementNS(s.svg,"tspan");V.select(Fe).attr({class:"line",dy:xe*f+"em"}),B.appendChild(Fe),me=Fe;var Ge=ye;if(ye=[{node:Fe}],Ge.length>1)for(var rt=1;rt<Ge.length;rt++)ke(Ge[rt])}function ke(Fe){var Ge=Fe.type,rt={},bt;if(Ge==="a"){bt="a";var ht=Fe.target,ct=Fe.href,Oe=Fe.popup;ct&&(rt={"xlink:xlink:show":ht==="_blank"||ht.charAt(0)!=="_"?"new":"replace",target:ht,"xlink:xlink:href":ct},Oe&&(rt.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+Oe+'");return false;'))}else bt="tspan";Fe.style&&(rt.style=Fe.style);var ze=document.createElementNS(s.svg,bt);if(Ge==="sup"||Ge==="sub"){Ie(me,S),me.appendChild(ze);var we=document.createElementNS(s.svg,"tspan");Ie(we,S),V.select(we).attr("dy",L[Ge]),rt.dy=b[Ge],me.appendChild(ze),me.appendChild(we)}else me.appendChild(ze);V.select(ze).attr(rt),me=Fe.node=ze,ye.push(Fe)}function Ie(Fe,Ge){Fe.appendChild(document.createTextNode(Ge))}function Q(Fe){if(ye.length===1){d.log("Ignoring unexpected end tag </"+Fe+">.",ie);return}var Ge=ye.pop();Fe!==Ge.type&&d.log("Start tag <"+Ge.type+"> doesnt match end tag <"+Fe+">. Pretending it did match.",ie),me=ye[ye.length-1].node}var ee=y.test(ie);ee?Re():(me=B,ye=[{node:B}]);for(var D=ie.split(C),le=0;le<D.length;le++){var ge=D[le],j=ge.match(m),k=j&&j[2].toLowerCase(),F=g[k];if(k==="br")Re();else if(F===void 0)Ie(me,G(ge));else if(j[1])Q(k);else{var J=j[4],K={type:k},ve=H(J,A);if(ve?(ve=ve.replace(U,"$1 fill:"),F&&(ve+=";"+F)):F&&(ve=F),ve&&(K.style=ve),k==="a"){se=!0;var Te=H(J,R);if(Te){var Ae=X(Te);Ae&&(K.href=Ae,K.target=H(J,N)||"_blank",K.popup=H(J,te))}}ke(K)}}return se}function X(B){var ie=encodeURI(decodeURI(B)),se=document.createElement("a"),ye=document.createElement("a");se.href=B,ye.href=ie;var me=se.protocol,xe=ye.protocol;return M.indexOf(me)!==-1&&M.indexOf(xe)!==-1?ie:""}W.sanitizeHTML=function(B){B=B.replace(T," ");for(var ie=document.createElement("p"),se=ie,ye=[],me=B.split(C),xe=0;xe<me.length;xe++){var Re=me[xe],ke=Re.match(m),Ie=ke&&ke[2].toLowerCase();if(Ie in g)if(ke[1])ye.length&&(se=ye.pop());else{var Q=ke[4],ee=H(Q,A),D=ee?{style:ee}:{};if(Ie==="a"){var le=H(Q,R);if(le){var ge=X(le);if(ge){D.href=ge;var j=H(Q,N);j&&(D.target=j)}}}var k=document.createElement(Ie);se.appendChild(k),V.select(k).attr(D),se=k,ye.push(k)}else se.appendChild(document.createTextNode(G(Re)))}var F="innerHTML";return ie[F]},W.lineCount=function(B){return B.selectAll("tspan.line").size()||1},W.positionText=function(B,ie,se){return B.each(function(){var ye=V.select(this);function me(ke,Ie){return Ie===void 0?(Ie=ye.attr(ke),Ie===null&&(ye.attr(ke,0),Ie=0)):ye.attr(ke,Ie),Ie}var xe=me("x",ie),Re=me("y",se);this.nodeName==="text"&&ye.selectAll("tspan.line").attr({x:xe,y:Re})})};function ne(B,ie,se){var ye=se.horizontalAlign,me=se.verticalAlign||"top",xe=B.node().getBoundingClientRect(),Re=ie.node().getBoundingClientRect(),ke,Ie,Q;return me==="bottom"?Ie=function(){return xe.bottom-ke.height}:me==="middle"?Ie=function(){return xe.top+(xe.height-ke.height)/2}:Ie=function(){return xe.top},ye==="right"?Q=function(){return xe.right-ke.width}:ye==="center"?Q=function(){return xe.left+(xe.width-ke.width)/2}:Q=function(){return xe.left},function(){ke=this.node().getBoundingClientRect();var ee=Q()-Re.left,D=Ie()-Re.top,le=se.gd||{};if(se.gd){le._fullLayout._calcInverseTransform(le);var ge=d.apply3DTransform(le._fullLayout._invTransform)(ee,D);ee=ge[0],D=ge[1]}return this.style({top:D+"px",left:ee+"px","z-index":1e3}),this}}var ae="1px ";W.makeTextShadow=function(B){var ie=ae,se=ae,ye=ae;return ie+se+ye+B+", -"+ie+"-"+se+ye+B+", "+ie+"-"+se+ye+B+", -"+ie+se+ye+B},W.makeEditable=function(B,ie){var se=ie.gd,ye=ie.delegate,me=V.dispatch("edit","input","cancel"),xe=ye||B;if(B.style({"pointer-events":ye?"none":"all"}),B.size()!==1)throw new Error("boo");function Re(){Ie(),B.style({opacity:0});var Q=xe.attr("class"),ee;Q?ee="."+Q.split(" ")[0]+"-math-group":ee="[class*=-math-group]",ee&&V.select(B.node().parentNode).select(ee).style({opacity:0})}function ke(Q){var ee=Q.node(),D=document.createRange();D.selectNodeContents(ee);var le=window.getSelection();le.removeAllRanges(),le.addRange(D),ee.focus()}function Ie(){var Q=V.select(se),ee=Q.select(".svg-container"),D=ee.append("div"),le=B.node().style,ge=parseFloat(le.fontSize||12),j=ie.text;j===void 0&&(j=B.attr("data-unformatted")),D.classed("plugin-editable editable",!0).style({position:"absolute","font-family":le.fontFamily||"Arial","font-size":ge,color:ie.fill||le.fill||"black",opacity:1,"background-color":ie.background||"transparent",outline:"#ffffff33 1px solid",margin:[-ge/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(j).call(ne(B,ee,ie)).on("blur",function(){se._editing=!1,B.text(this.textContent).style({opacity:1});var k=V.select(this).attr("class"),F;k?F="."+k.split(" ")[0]+"-math-group":F="[class*=-math-group]",F&&V.select(B.node().parentNode).select(F).style({opacity:0});var J=this.textContent;V.select(this).transition().duration(0).remove(),V.select(document).on("mouseup",null),me.edit.call(B,J)}).on("focus",function(){var k=this;se._editing=!0,V.select(document).on("mouseup",function(){if(V.event.target===k)return!1;document.activeElement===D.node()&&D.node().blur()})}).on("keyup",function(){V.event.which===27?(se._editing=!1,B.style({opacity:1}),V.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),me.cancel.call(B,this.textContent)):(me.input.call(B,this.textContent),V.select(this).call(ne(B,ee,ie)))}).on("keydown",function(){V.event.which===13&&this.blur()}).call(ke)}return ie.immediate?Re():xe.on("click",Re),V.rebind(B,me,"on")}}),Di=t((W,V)=>{var d=l(),i=ft(),s=q(),f=Mt(),u=Xt(),h=nr().isValid;function p(T,C,m){var y=C?f.nestedProperty(T,C).get()||{}:T,A=y[m||"color"];A&&A._inputArray&&(A=A._inputArray);var R=!1;if(f.isArrayOrTypedArray(A)){for(var N=0;N<A.length;N++)if(s(A[N])){R=!0;break}}return f.isPlainObject(y)&&(R||y.showscale===!0||s(y.cmin)&&s(y.cmax)||h(y.colorscale)||f.isPlainObject(y.colorbar))}var v=["showscale","autocolorscale","colorscale","reversescale","colorbar"],o=["min","max","mid","auto"];function w(T){var C=T._colorAx,m=C||T,y={},A,R,N;for(R=0;R<v.length;R++)N=v[R],y[N]=m[N];if(C)for(A="c",R=0;R<o.length;R++)N=o[R],y[N]=m["c"+N];else{var te;for(R=0;R<o.length;R++){if(N=o[R],te="c"+N,te in m){y[N]=m[te];continue}te="z"+N,te in m&&(y[N]=m[te])}A=te.charAt(0)}return y._sync=function(H,U){var P=o.indexOf(H)!==-1?A+H:H;m[P]=m["_"+P]=U},y}function g(T){for(var C=w(T),m=C.min,y=C.max,A=C.reversescale?b(C.colorscale):C.colorscale,R=A.length,N=new Array(R),te=new Array(R),H=0;H<R;H++){var U=A[H];N[H]=m+U[0]*(y-m),te[H]=U[1]}return{domain:N,range:te}}function b(T){for(var C=T.length,m=new Array(C),y=C-1,A=0;y>=0;y--,A++){var R=T[y];m[A]=[1-R[0],R[1]]}return m}function L(T,C){C=C||{};for(var m=T.domain,y=T.range,A=y.length,R=new Array(A),N=0;N<A;N++){var te=i(y[N]).toRgb();R[N]=[te.r,te.g,te.b,te.a]}var H=d.scale.linear().domain(m).range(R).clamp(!0),U=C.noNumericCheck,P=C.returnArray,re;return U&&P?re=H:U?re=function(G){return M(H(G))}:P?re=function(G){return s(G)?H(G):i(G).isValid()?G:u.defaultLine}:re=function(G){return s(G)?M(H(G)):i(G).isValid()?G:u.defaultLine},re.domain=H.domain,re.range=function(){return y},re}function S(T,C){return L(g(T),C)}function M(T){var C={r:T[0],g:T[1],b:T[2],a:T[3]};return i(C).toRgbString()}V.exports={hasColorscale:p,extractOpts:w,extractScale:g,flipScale:b,makeColorScaleFunc:L,makeColorScaleFuncFromTrace:S}}),Fi=t((W,V)=>{var d=qt(),i=d.FORMAT_LINK,s=d.DATE_FORMAT_LINK;function f(p,v){return{valType:"string",dflt:"",editType:"none",description:(v?u:h)("hover text",p)+["By default the values are formatted using "+(v?"generic number format":"`"+p+"axis.hoverformat`")+"."].join(" ")}}function u(p,v){return["Sets the "+p+" formatting rule"+(v?"for `"+v+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+i+"."].join(" ")}function h(p,v){return u(p,v)+[" And for dates see: "+s+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}V.exports={axisHoverFormat:f,descriptionOnlyNumbers:u,descriptionWithDates:h}}),to=t((W,V)=>{var d=pt(),i=Zt(),s=Wr().dash,f=gt().extendFlat,u=fn().templatedArray;jr().templateFormatStringDescription;var h=Fi().descriptionWithDates,p=oe().ONEDAY,v=kn(),o=v.HOUR_PATTERN,w=v.WEEKDAY_PATTERN,g={valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}},b=f({},g,{values:g.values.slice().concat(["sync"])});function L(U){return{valType:"integer",min:0,dflt:U?5:0,editType:"ticks"}}var S={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},M={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},T={valType:"data_array",editType:"ticks"},C={valType:"enumerated",values:["outside","inside",""],editType:"ticks"};function m(U){var P={valType:"number",min:0,editType:"ticks"};return U||(P.dflt=5),P}function y(U){var P={valType:"number",min:0,editType:"ticks"};return U||(P.dflt=1),P}var A={valType:"color",dflt:i.defaultLine,editType:"ticks"},R={valType:"color",dflt:i.lightLine,editType:"ticks"};function N(U){var P={valType:"number",min:0,editType:"ticks"};return U||(P.dflt=1),P}var te=f({},s,{editType:"ticks"}),H={valType:"boolean",editType:"ticks"};V.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:i.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:d({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed","min reversed","max reversed","min","max"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},autorangeoptions:{minallowed:{valType:"any",editType:"plot",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},maxallowed:{valType:"any",editType:"plot",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},clipmin:{valType:"any",editType:"plot",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},clipmax:{valType:"any",editType:"plot",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},include:{valType:"any",arrayOk:!0,editType:"plot",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},editType:"plot"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},minallowed:{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},maxallowed:{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},modebardisable:{valType:"flaglist",flags:["autoscale","zoominout"],extras:["none"],dflt:"none",editType:"modebar"},insiderange:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},scaleanchor:{valType:"enumerated",values:[v.idRegex.x.toString(),v.idRegex.y.toString(),!1],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[v.idRegex.x.toString(),v.idRegex.y.toString()],editType:"calc"},rangebreaks:u("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[w,o,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:p},editType:"calc"}),tickmode:b,nticks:L(),tick0:S,dtick:M,ticklabelstep:{valType:"integer",min:1,dflt:1,editType:"ticks"},tickvals:T,ticktext:{valType:"data_array",editType:"ticks"},ticks:C,tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},ticklabelshift:{valType:"integer",dflt:0,editType:"ticks"},ticklabelstandoff:{valType:"integer",dflt:0,editType:"ticks"},ticklabelindex:{valType:"integer",arrayOk:!0,editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:m(),tickwidth:y(),tickcolor:A,showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},labelalias:{valType:"any",dflt:!1,editType:"ticks"},automargin:{valType:"flaglist",flags:["height","width","left","right","top","bottom"],extras:[!0,!1],dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:f({},s,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:d({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},autotickangles:{valType:"info_array",freeLength:!0,items:{valType:"angle"},dflt:[0,30,90],editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B","SI extended"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:h("tick label")},tickformatstops:u("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:h("hover text")},unifiedhovertitle:{text:{valType:"string",dflt:"",editType:"none"},editType:"none"},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:i.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:H,gridcolor:R,gridwidth:N(),griddash:te,zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:i.defaultLine,editType:"ticks"},zerolinelayer:{valType:"enumerated",values:["above traces","below traces"],dflt:"below traces",editType:"plot"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:i.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",v.idRegex.x.toString(),v.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",v.idRegex.x.toString(),v.idRegex.y.toString()],editType:"plot"},minor:{tickmode:g,nticks:L("minor"),tick0:S,dtick:M,tickvals:T,ticks:C,ticklen:m("minor"),tickwidth:y("minor"),tickcolor:A,gridcolor:R,gridwidth:N("minor"),griddash:te,showgrid:H,editType:"ticks"},minorloglabels:{valType:"enumerated",values:["small digits","complete","none"],dflt:"small digits",editType:"calc"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},autoshift:{valType:"boolean",dflt:!1,editType:"plot"},shift:{valType:"number",editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","geometric mean ascending","geometric mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc"}}),ri=t((W,V)=>{var d=to(),i=pt(),s=gt().extendFlat,f=Ft().overrideAll;V.exports=f({orientation:{valType:"enumerated",values:["h","v"],dflt:"v"},thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number"},xref:{valType:"enumerated",dflt:"paper",values:["container","paper"],editType:"layoutstyle"},xanchor:{valType:"enumerated",values:["left","center","right"]},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number"},yref:{valType:"enumerated",dflt:"paper",values:["container","paper"],editType:"layoutstyle"},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},ypad:{valType:"number",min:0,dflt:10},outlinecolor:d.linecolor,outlinewidth:d.linewidth,bordercolor:d.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:d.minor.tickmode,nticks:d.nticks,tick0:d.tick0,dtick:d.dtick,tickvals:d.tickvals,ticktext:d.ticktext,ticks:s({},d.ticks,{dflt:""}),ticklabeloverflow:s({},d.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside"},ticklen:d.ticklen,tickwidth:d.tickwidth,tickcolor:d.tickcolor,ticklabelstep:d.ticklabelstep,showticklabels:d.showticklabels,labelalias:d.labelalias,tickfont:i({}),tickangle:d.tickangle,tickformat:d.tickformat,tickformatstops:d.tickformatstops,tickprefix:d.tickprefix,showtickprefix:d.showtickprefix,ticksuffix:d.ticksuffix,showticksuffix:d.showticksuffix,separatethousands:d.separatethousands,exponentformat:d.exponentformat,minexponent:d.minexponent,showexponent:d.showexponent,title:{text:{valType:"string"},font:i({}),side:{valType:"enumerated",values:["right","top","bottom"]}}},"colorbars","from-root")}),Wi=t((W,V)=>{var d=ri(),i=cr().counter,s=Oo(),f=nr().scales;s(f);function u(h){return"`"+h+"`"}V.exports=function(h,p){h=h||"",p=p||{};var v=p.cLetter||"c";"onlyIfNumerical"in p&&p.onlyIfNumerical;var o="noScale"in p?p.noScale:h==="marker.line",w="showScaleDflt"in p?p.showScaleDflt:v==="z",g=typeof p.colorscaleDflt=="string"?f[p.colorscaleDflt]:null,b=p.editTypeOverride||"",L=h?h+".":"",S;"colorAttr"in p?(S=p.colorAttr,p.colorAttr):(S={z:"z",c:"color"}[v],""+u(L+S));var M=v+"auto",T=v+"min",C=v+"max",m=v+"mid",y={};y[T]=y[C]=void 0;var A={};A[M]=!1;var R={};return S==="color"&&(R.color={valType:"color",arrayOk:!0,editType:b||"style"},p.anim&&(R.color.anim=!0)),R[M]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:y},R[T]={valType:"number",dflt:null,editType:b||"plot",impliedEdits:A},R[C]={valType:"number",dflt:null,editType:b||"plot",impliedEdits:A},R[m]={valType:"number",dflt:null,editType:"calc",impliedEdits:y},R.colorscale={valType:"colorscale",editType:"calc",dflt:g,impliedEdits:{autocolorscale:!1}},R.autocolorscale={valType:"boolean",dflt:p.autoColorDflt!==!1,editType:"calc",impliedEdits:{colorscale:void 0}},R.reversescale={valType:"boolean",dflt:!1,editType:"plot"},o||(R.showscale={valType:"boolean",dflt:w,editType:"calc"},R.colorbar=d),p.noColorAxis||(R.coloraxis={valType:"subplotid",regex:i("coloraxis"),dflt:null,editType:"calc"}),R}}),ns=t((W,V)=>{var d=gt().extendFlat,i=Wi(),s=nr().scales;V.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:s.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:s.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:s.RdBu,editType:"calc"}},coloraxis:d({_isSubplotObj:!0,editType:"calc"},i("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}}),Qi=t((W,V)=>{var d=Mt();V.exports=function(i){return d.isPlainObject(i.colorbar)}}),Bs=t(W=>{var V=q(),d=Mt(),i=oe(),s=i.ONEDAY,f=i.ONEWEEK;W.dtick=function(u,h){var p=h==="log",v=h==="date",o=h==="category",w=v?s:1;if(!u)return w;if(V(u))return u=Number(u),u<=0?w:o?Math.max(1,Math.round(u)):v?Math.max(.1,u):u;if(typeof u!="string"||!(v||p))return w;var g=u.charAt(0),b=u.substr(1);return b=V(b)?Number(b):0,b<=0||!(v&&g==="M"&&b===Math.round(b)||p&&g==="L"||p&&g==="D"&&(b===1||b===2))?w:u},W.tick0=function(u,h,p,v){if(h==="date")return d.cleanDate(u,d.dateTick0(p,v%f===0?1:0));if(!(v==="D1"||v==="D2"))return V(u)?Number(u):0}}),ml=t((W,V)=>{var d=Bs(),i=Mt().isArrayOrTypedArray,s=be().isTypedArraySpec,f=be().decodeTypedArraySpec;V.exports=function(u,h,p,v,o){o||(o={});var w=o.isMinor,g=w?u.minor||{}:u,b=w?h.minor:h,L=w?"minor.":"";function S(N){var te=g[N];return s(te)&&(te=f(te)),te!==void 0?te:(b._template||{})[N]}var M=S("tick0"),T=S("dtick"),C=S("tickvals"),m=i(C)?"array":T?"linear":"auto",y=p(L+"tickmode",m);if(y==="auto"||y==="sync")p(L+"nticks");else if(y==="linear"){var A=b.dtick=d.dtick(T,v);b.tick0=d.tick0(M,v,h.calendar,A)}else if(v!=="multicategory"){var R=p(L+"tickvals");R===void 0?b.tickmode="auto":w||p("ticktext")}}}),gl=t((W,V)=>{var d=Mt(),i=to();V.exports=function(s,f,u,h){var p=h.isMinor,v=p?s.minor||{}:s,o=p?f.minor:f,w=p?i.minor:i,g=p?"minor.":"",b=d.coerce2(v,o,w,"ticklen",p?(f.ticklen||5)*.6:void 0),L=d.coerce2(v,o,w,"tickwidth",p?f.tickwidth||1:void 0),S=d.coerce2(v,o,w,"tickcolor",(p?f.tickcolor:void 0)||o.color),M=u(g+"ticks",!p&&h.outerTicks||b||L||S?"outside":"");M||(delete o.ticklen,delete o.tickwidth,delete o.tickcolor)}}),Ku=t((W,V)=>{V.exports=function(d){var i=["showexponent","showtickprefix","showticksuffix"],s=i.filter(function(u){return d[u]!==void 0}),f=function(u){return d[u]===d[s[0]]};if(s.every(f)||s.length===1)return d[s[0]]}}),No=t((W,V)=>{var d=Mt(),i=fn();V.exports=function(s,f,u){var h=u.name,p=u.inclusionAttr||"visible",v=f[h],o=d.isArrayOrTypedArray(s[h])?s[h]:[],w=f[h]=[],g=i.arrayTemplater(f,h,p),b,L;for(b=0;b<o.length;b++){var S=o[b];d.isPlainObject(S)?L=g.newItem(S):(L=g.newItem({}),L[p]=!1),L._index=b,L[p]!==!1&&u.handleItemDefaults(S,L,f,u),w.push(L)}var M=g.defaultItems();for(b=0;b<M.length;b++)L=M[b],L._index=w.length,u.handleItemDefaults({},L,f,u,{}),w.push(L);if(d.isArrayOrTypedArray(v)){var T=Math.min(v.length,w.length);for(b=0;b<T;b++)d.relinkPrivateKeys(w[b],v[b])}return w}}),Zc=t((W,V)=>{var d=Mt(),i=Xt().contrast,s=to(),f=Ku(),u=No();V.exports=function(p,v,o,w,g){g||(g={});var b=o("labelalias");d.isPlainObject(b)||delete v.labelalias;var L=f(p),S=o("showticklabels");if(S){g.noTicklabelshift||o("ticklabelshift"),g.noTicklabelstandoff||o("ticklabelstandoff");var M=g.font||{},T=v.color,C=v.ticklabelposition||"",m=C.indexOf("inside")!==-1?i(g.bgColor):T&&T!==s.color.dflt?T:M.color;if(d.coerceFont(o,"tickfont",M,{overrideDflt:{color:m}}),!g.noTicklabelstep&&w!=="multicategory"&&w!=="log"&&o("ticklabelstep"),!g.noAng){var y=o("tickangle");!g.noAutotickangles&&y==="auto"&&o("autotickangles")}if(w!=="category"){var A=o("tickformat");u(p,v,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:h}),v.tickformatstops.length||delete v.tickformatstops,!g.noExp&&!A&&w!=="date"&&(o("showexponent",L),o("exponentformat"),o("minexponent"),o("separatethousands"))}!g.noMinorloglabels&&w==="log"&&o("minorloglabels")}};function h(p,v){function o(g,b){return d.coerce(p,v,s.tickformatstops,g,b)}var w=o("enabled");w&&(o("dtickrange"),o("value"))}}),$u=t((W,V)=>{var d=Ku();V.exports=function(i,s,f,u,h){h||(h={});var p=h.tickSuffixDflt,v=d(i),o=f("tickprefix");o&&f("showtickprefix",v);var w=f("ticksuffix",p);w&&f("showticksuffix",v)}}),ed=t((W,V)=>{var d=Mt(),i=fn(),s=ml(),f=gl(),u=Zc(),h=$u(),p=ri();V.exports=function(v,o,w){var g=i.newContainer(o,"colorbar"),b=v.colorbar||{};function L(B,ie){return d.coerce(b,g,p,B,ie)}var S=w.margin||{t:0,b:0,l:0,r:0},M=w.width-S.l-S.r,T=w.height-S.t-S.b,C=L("orientation"),m=C==="v",y=L("thicknessmode");L("thickness",y==="fraction"?30/(m?M:T):30);var A=L("lenmode");L("len",A==="fraction"?1:m?T:M);var R=L("yref"),N=L("xref"),te=R==="paper",H=N==="paper",U,P,re,G="left";m?(re="middle",G=H?"left":"right",U=H?1.02:1,P=.5):(re=te?"bottom":"top",G="center",U=.5,P=te?1.02:1),d.coerce(b,g,{x:{valType:"number",min:H?-2:0,max:H?3:1,dflt:U}},"x"),d.coerce(b,g,{y:{valType:"number",min:te?-2:0,max:te?3:1,dflt:P}},"y"),L("xanchor",G),L("xpad"),L("yanchor",re),L("ypad"),d.noneOrAll(b,g,["x","y"]),L("outlinecolor"),L("outlinewidth"),L("bordercolor"),L("borderwidth"),L("bgcolor");var Z=d.coerce(b,g,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:m?["outside","inside","outside top","inside top","outside bottom","inside bottom"]:["outside","inside","outside left","inside left","outside right","inside right"]}},"ticklabelposition");L("ticklabeloverflow",Z.indexOf("inside")!==-1?"hide past domain":"hide past div"),s(b,g,L,"linear");var Y=w.font,X={noAutotickangles:!0,noTicklabelshift:!0,noTicklabelstandoff:!0,outerTicks:!1,font:Y};Z.indexOf("inside")!==-1&&(X.bgColor="black"),h(b,g,L,"linear",X),u(b,g,L,"linear",X),f(b,g,L,"linear",X),L("title.text",w._dfltTitle.colorbar);var ne=g.showticklabels?g.tickfont:Y,ae=d.extendFlat({},Y,{family:ne.family,size:d.bigFont(ne.size)});d.coerceFont(L,"title.font",ae),L("title.side",m?"top":"right")}}),vl=t((W,V)=>{var d=q(),i=Mt(),s=Qi(),f=ed(),u=nr().isValid,h=an().traceIs;function p(v,o){var w=o.slice(0,o.length-1);return o?i.nestedProperty(v,w).get()||{}:v}V.exports=function v(o,w,g,b,L){var S=L.prefix,M=L.cLetter,T="_module"in w,C=p(o,S),m=p(w,S),y=p(w._template||{},S)||{},A=function(){return delete o.coloraxis,delete w.coloraxis,v(o,w,g,b,L)};if(T){var R=g._colorAxes||{},N=b(S+"coloraxis");if(N){var te=h(w,"contour")&&i.nestedProperty(w,"contours.coloring").get()||"heatmap",H=R[N];H?(H[2].push(A),H[0]!==te&&(H[0]=!1,i.warn(["Ignoring coloraxis:",N,"setting","as it is linked to incompatible colorscales."].join(" ")))):R[N]=[te,w,[A]];return}}var U=C[M+"min"],P=C[M+"max"],re=d(U)&&d(P)&&U<P,G=b(S+M+"auto",!re);G?b(S+M+"mid"):(b(S+M+"min"),b(S+M+"max"));var Z=C.colorscale,Y=y.colorscale,X;if(Z!==void 0&&(X=!u(Z)),Y!==void 0&&(X=!u(Y)),b(S+"autocolorscale",X),b(S+"colorscale"),b(S+"reversescale"),S!=="marker.line."){var ne;S&&T&&(ne=s(C));var ae=b(S+"showscale",ne);ae&&(S&&y&&(m._template=y),f(C,m,g))}}}),Qc=t((W,V)=>{var d=Mt(),i=fn(),s=ns(),f=vl();V.exports=function(u,h){function p(M,T){return d.coerce(u,h,s,M,T)}p("colorscale.sequential"),p("colorscale.sequentialminus"),p("colorscale.diverging");var v=h._colorAxes,o,w;function g(M,T){return d.coerce(o,w,s.coloraxis,M,T)}for(var b in v){var L=v[b];if(L[0])o=u[b]||{},w=i.newContainer(h,b,"coloraxis"),w._name=b,f(o,w,h,g,{prefix:"",cLetter:"c"});else{for(var S=0;S<L[2].length;S++)L[2][S]();delete h._colorAxes[b]}}}}),Kh=t((W,V)=>{var d=Mt(),i=Di().hasColorscale,s=Di().extractOpts;V.exports=function(f,u){function h(L,S){var M=L["_"+S];M!==void 0&&(L[S]=M)}function p(L,S){var M=S.container?d.nestedProperty(L,S.container).get():L;if(M)if(M.coloraxis)M._colorAx=u[M.coloraxis];else{var T=s(M),C=T.auto;(C||T.min===void 0)&&h(M,S.min),(C||T.max===void 0)&&h(M,S.max),T.autocolorscale&&h(M,"colorscale")}}for(var v=0;v<f.length;v++){var o=f[v],w=o._module.colorbar;if(w)if(Array.isArray(w))for(var g=0;g<w.length;g++)p(o,w[g]);else p(o,w);i(o,"marker.line")&&p(o,{container:"marker.line",min:"cmin",max:"cmax"})}for(var b in u._colorAxes)p(u[b],{min:"cmin",max:"cmax"})}}),Kc=t((W,V)=>{var d=q(),i=Mt(),s=Di().extractOpts;V.exports=function(f,u,h){var p=f._fullLayout,v=h.vals,o=h.containerStr,w=o?i.nestedProperty(u,o).get():u,g=s(w),b=g.auto!==!1,L=g.min,S=g.max,M=g.mid,T=function(){return i.aggNums(Math.min,null,v)},C=function(){return i.aggNums(Math.max,null,v)};if(L===void 0?L=T():b&&(w._colorAx&&d(L)?L=Math.min(L,T()):L=T()),S===void 0?S=C():b&&(w._colorAx&&d(S)?S=Math.max(S,C()):S=C()),b&&M!==void 0&&(S-M>M-L?L=M-(S-M):S-M<M-L&&(S=M+(M-L))),L===S&&(L-=.5,S+=.5),g._sync("min",L),g._sync("max",S),g.autocolorscale){var m;L*S<0?m=p.colorscale.diverging:L>=0?m=p.colorscale.sequential:m=p.colorscale.sequentialminus,g._sync("colorscale",m)}}}),td=t((W,V)=>{var d=nr(),i=Di();V.exports={moduleType:"component",name:"colorscale",attributes:Wi(),layoutAttributes:ns(),supplyLayoutDefaults:Qc(),handleDefaults:vl(),crossTraceDefaults:Kh(),calc:Kc(),scales:d.scales,defaultScale:d.defaultScale,getScale:d.get,isValidScale:d.isValid,hasColorscale:i.hasColorscale,extractOpts:i.extractOpts,extractScale:i.extractScale,flipScale:i.flipScale,makeColorScaleFunc:i.makeColorScaleFunc,makeColorScaleFuncFromTrace:i.makeColorScaleFuncFromTrace}}),Ki=t((W,V)=>{var d=Mt(),i=be().isTypedArraySpec;V.exports={hasLines:function(s){return s.visible&&s.mode&&s.mode.indexOf("lines")!==-1},hasMarkers:function(s){return s.visible&&(s.mode&&s.mode.indexOf("markers")!==-1||s.type==="splom")},hasText:function(s){return s.visible&&s.mode&&s.mode.indexOf("text")!==-1},isBubble:function(s){var f=s.marker;return d.isPlainObject(f)&&(d.isArrayOrTypedArray(f.size)||i(f.size))}}}),$c=t((W,V)=>{var d=q();V.exports=function(i,s){s||(s=2);var f=i.marker,u=f.sizeref||1,h=f.sizemin||0,p=f.sizemode==="area"?function(v){return Math.sqrt(v/u)}:function(v){return v/u};return function(v){var o=p(v/s);return d(o)&&o>0?Math.max(o,h):0}}}),So=t(W=>{var V=Mt();W.getSubplot=function(h){return h.subplot||h.xaxis+h.yaxis||h.geo},W.isTraceInSubplots=function(h,p){if(h.type==="splom"){for(var v=h.xaxes||[],o=h.yaxes||[],w=0;w<v.length;w++)for(var g=0;g<o.length;g++)if(p.indexOf(v[w]+o[g])!==-1)return!0;return!1}return p.indexOf(W.getSubplot(h))!==-1},W.flat=function(h,p){for(var v=new Array(h.length),o=0;o<h.length;o++)v[o]=p;return v},W.p2c=function(h,p){for(var v=new Array(h.length),o=0;o<h.length;o++)v[o]=h[o].p2c(p);return v},W.getDistanceFunction=function(h,p,v,o){return h==="closest"?o||W.quadrature(p,v):h.charAt(0)==="x"?p:v},W.getClosest=function(h,p,v){if(v.index!==!1)v.index>=0&&v.index<h.length?v.distance=0:v.index=!1;else for(var o=1/0,w=h.length,g=0;g<w;g++)o=p(h[g]),o<=v.distance&&(v.index=g,v.distance=o);return v},W.inbox=function(h,p,v){return h*p<0||h===0?v:1/0},W.quadrature=function(h,p){return function(v){var o=h(v),w=p(v);return Math.sqrt(o*o+w*w)}},W.makeEventData=function(h,p,v){var o="index"in h?h.index:h.pointNumber,w={data:p._input,fullData:p,curveNumber:p.index,pointNumber:o};if(p._indexToPoints){var g=p._indexToPoints[o];g.length===1?w.pointIndex=g[0]:w.pointIndices=g}else w.pointIndex=o;return p._module.eventData?w=p._module.eventData(w,h,p,v,o):("xVal"in h?w.x=h.xVal:"x"in h&&(w.x=h.x),"yVal"in h?w.y=h.yVal:"y"in h&&(w.y=h.y),h.xa&&(w.xaxis=h.xa),h.ya&&(w.yaxis=h.ya),h.zLabelVal!==void 0&&(w.z=h.zLabelVal)),W.appendArrayPointValue(w,p,o),w},W.appendArrayPointValue=function(h,p,v){var o=p._arrayAttrs;if(o)for(var w=0;w<o.length;w++){var g=o[w],b=i(g);if(h[b]===void 0){var L=V.nestedProperty(p,g).get(),S=s(L,v);S!==void 0&&(h[b]=S)}}},W.appendArrayMultiPointValues=function(h,p,v){var o=p._arrayAttrs;if(o)for(var w=0;w<o.length;w++){var g=o[w],b=i(g);if(h[b]===void 0){for(var L=V.nestedProperty(p,g).get(),S=new Array(v.length),M=0;M<v.length;M++)S[M]=s(L,v[M]);h[b]=S}}};var d={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function i(h){return d[h]||h}function s(h,p){if(Array.isArray(p)){if(Array.isArray(h)&&Array.isArray(h[p[0]]))return h[p[0]][p[1]]}else return h[p]}var f={x:!0,y:!0},u={"x unified":!0,"y unified":!0};W.isUnifiedHover=function(h){return typeof h!="string"?!1:!!u[h]},W.isXYhover=function(h){return typeof h!="string"?!1:!!f[h]}}),Kl=t((W,V)=>{V.exports=s;var d={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},i=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function s(h){var p=[];return h.replace(i,function(v,o,w){var g=o.toLowerCase();for(w=u(w),g=="m"&&w.length>2&&(p.push([o].concat(w.splice(0,2))),g="l",o=o=="m"?"l":"L");;){if(w.length==d[g])return w.unshift(o),p.push(w);if(w.length<d[g])throw new Error("malformed path data");p.push([o].concat(w.splice(0,d[g])))}}),p}var f=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function u(h){var p=h.match(f);return p?p.map(Number):[]}}),$h=t((W,V)=>{var d=Kl(),i=function(M,T){return T?Math.round(M*(T=Math.pow(10,T)))/T:Math.round(M)},s="M0,0Z",f=Math.sqrt(2),u=Math.sqrt(3),h=Math.PI,p=Math.cos,v=Math.sin;V.exports={circle:{n:0,f:function(M,T,C){if(o(T))return s;var m=i(M,2),y="M"+m+",0A"+m+","+m+" 0 1,1 0,-"+m+"A"+m+","+m+" 0 0,1 "+m+",0Z";return C?S(T,C,y):y}},square:{n:1,f:function(M,T,C){if(o(T))return s;var m=i(M,2);return S(T,C,"M"+m+","+m+"H-"+m+"V-"+m+"H"+m+"Z")}},diamond:{n:2,f:function(M,T,C){if(o(T))return s;var m=i(M*1.3,2);return S(T,C,"M"+m+",0L0,"+m+"L-"+m+",0L0,-"+m+"Z")}},cross:{n:3,f:function(M,T,C){if(o(T))return s;var m=i(M*.4,2),y=i(M*1.2,2);return S(T,C,"M"+y+","+m+"H"+m+"V"+y+"H-"+m+"V"+m+"H-"+y+"V-"+m+"H-"+m+"V-"+y+"H"+m+"V-"+m+"H"+y+"Z")}},x:{n:4,f:function(M,T,C){if(o(T))return s;var m=i(M*.8/f,2),y="l"+m+","+m,A="l"+m+",-"+m,R="l-"+m+",-"+m,N="l-"+m+","+m;return S(T,C,"M0,"+m+y+A+R+A+R+N+R+N+y+N+y+"Z")}},"triangle-up":{n:5,f:function(M,T,C){if(o(T))return s;var m=i(M*2/u,2),y=i(M/2,2),A=i(M,2);return S(T,C,"M-"+m+","+y+"H"+m+"L0,-"+A+"Z")}},"triangle-down":{n:6,f:function(M,T,C){if(o(T))return s;var m=i(M*2/u,2),y=i(M/2,2),A=i(M,2);return S(T,C,"M-"+m+",-"+y+"H"+m+"L0,"+A+"Z")}},"triangle-left":{n:7,f:function(M,T,C){if(o(T))return s;var m=i(M*2/u,2),y=i(M/2,2),A=i(M,2);return S(T,C,"M"+y+",-"+m+"V"+m+"L-"+A+",0Z")}},"triangle-right":{n:8,f:function(M,T,C){if(o(T))return s;var m=i(M*2/u,2),y=i(M/2,2),A=i(M,2);return S(T,C,"M-"+y+",-"+m+"V"+m+"L"+A+",0Z")}},"triangle-ne":{n:9,f:function(M,T,C){if(o(T))return s;var m=i(M*.6,2),y=i(M*1.2,2);return S(T,C,"M-"+y+",-"+m+"H"+m+"V"+y+"Z")}},"triangle-se":{n:10,f:function(M,T,C){if(o(T))return s;var m=i(M*.6,2),y=i(M*1.2,2);return S(T,C,"M"+m+",-"+y+"V"+m+"H-"+y+"Z")}},"triangle-sw":{n:11,f:function(M,T,C){if(o(T))return s;var m=i(M*.6,2),y=i(M*1.2,2);return S(T,C,"M"+y+","+m+"H-"+m+"V-"+y+"Z")}},"triangle-nw":{n:12,f:function(M,T,C){if(o(T))return s;var m=i(M*.6,2),y=i(M*1.2,2);return S(T,C,"M-"+m+","+y+"V-"+m+"H"+y+"Z")}},pentagon:{n:13,f:function(M,T,C){if(o(T))return s;var m=i(M*.951,2),y=i(M*.588,2),A=i(-M,2),R=i(M*-.309,2),N=i(M*.809,2);return S(T,C,"M"+m+","+R+"L"+y+","+N+"H-"+y+"L-"+m+","+R+"L0,"+A+"Z")}},hexagon:{n:14,f:function(M,T,C){if(o(T))return s;var m=i(M,2),y=i(M/2,2),A=i(M*u/2,2);return S(T,C,"M"+A+",-"+y+"V"+y+"L0,"+m+"L-"+A+","+y+"V-"+y+"L0,-"+m+"Z")}},hexagon2:{n:15,f:function(M,T,C){if(o(T))return s;var m=i(M,2),y=i(M/2,2),A=i(M*u/2,2);return S(T,C,"M-"+y+","+A+"H"+y+"L"+m+",0L"+y+",-"+A+"H-"+y+"L-"+m+",0Z")}},octagon:{n:16,f:function(M,T,C){if(o(T))return s;var m=i(M*.924,2),y=i(M*.383,2);return S(T,C,"M-"+y+",-"+m+"H"+y+"L"+m+",-"+y+"V"+y+"L"+y+","+m+"H-"+y+"L-"+m+","+y+"V-"+y+"Z")}},star:{n:17,f:function(M,T,C){if(o(T))return s;var m=M*1.4,y=i(m*.225,2),A=i(m*.951,2),R=i(m*.363,2),N=i(m*.588,2),te=i(-m,2),H=i(m*-.309,2),U=i(m*.118,2),P=i(m*.809,2),re=i(m*.382,2);return S(T,C,"M"+y+","+H+"H"+A+"L"+R+","+U+"L"+N+","+P+"L0,"+re+"L-"+N+","+P+"L-"+R+","+U+"L-"+A+","+H+"H-"+y+"L0,"+te+"Z")}},hexagram:{n:18,f:function(M,T,C){if(o(T))return s;var m=i(M*.66,2),y=i(M*.38,2),A=i(M*.76,2);return S(T,C,"M-"+A+",0l-"+y+",-"+m+"h"+A+"l"+y+",-"+m+"l"+y+","+m+"h"+A+"l-"+y+","+m+"l"+y+","+m+"h-"+A+"l-"+y+","+m+"l-"+y+",-"+m+"h-"+A+"Z")}},"star-triangle-up":{n:19,f:function(M,T,C){if(o(T))return s;var m=i(M*u*.8,2),y=i(M*.8,2),A=i(M*1.6,2),R=i(M*4,2),N="A "+R+","+R+" 0 0 1 ";return S(T,C,"M-"+m+","+y+N+m+","+y+N+"0,-"+A+N+"-"+m+","+y+"Z")}},"star-triangle-down":{n:20,f:function(M,T,C){if(o(T))return s;var m=i(M*u*.8,2),y=i(M*.8,2),A=i(M*1.6,2),R=i(M*4,2),N="A "+R+","+R+" 0 0 1 ";return S(T,C,"M"+m+",-"+y+N+"-"+m+",-"+y+N+"0,"+A+N+m+",-"+y+"Z")}},"star-square":{n:21,f:function(M,T,C){if(o(T))return s;var m=i(M*1.1,2),y=i(M*2,2),A="A "+y+","+y+" 0 0 1 ";return S(T,C,"M-"+m+",-"+m+A+"-"+m+","+m+A+m+","+m+A+m+",-"+m+A+"-"+m+",-"+m+"Z")}},"star-diamond":{n:22,f:function(M,T,C){if(o(T))return s;var m=i(M*1.4,2),y=i(M*1.9,2),A="A "+y+","+y+" 0 0 1 ";return S(T,C,"M-"+m+",0"+A+"0,"+m+A+m+",0"+A+"0,-"+m+A+"-"+m+",0Z")}},"diamond-tall":{n:23,f:function(M,T,C){if(o(T))return s;var m=i(M*.7,2),y=i(M*1.4,2);return S(T,C,"M0,"+y+"L"+m+",0L0,-"+y+"L-"+m+",0Z")}},"diamond-wide":{n:24,f:function(M,T,C){if(o(T))return s;var m=i(M*1.4,2),y=i(M*.7,2);return S(T,C,"M0,"+y+"L"+m+",0L0,-"+y+"L-"+m+",0Z")}},hourglass:{n:25,f:function(M,T,C){if(o(T))return s;var m=i(M,2);return S(T,C,"M"+m+","+m+"H-"+m+"L"+m+",-"+m+"H-"+m+"Z")},noDot:!0},bowtie:{n:26,f:function(M,T,C){if(o(T))return s;var m=i(M,2);return S(T,C,"M"+m+","+m+"V-"+m+"L-"+m+","+m+"V-"+m+"Z")},noDot:!0},"circle-cross":{n:27,f:function(M,T,C){if(o(T))return s;var m=i(M,2);return S(T,C,"M0,"+m+"V-"+m+"M"+m+",0H-"+m+"M"+m+",0A"+m+","+m+" 0 1,1 0,-"+m+"A"+m+","+m+" 0 0,1 "+m+",0Z")},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(M,T,C){if(o(T))return s;var m=i(M,2),y=i(M/f,2);return S(T,C,"M"+y+","+y+"L-"+y+",-"+y+"M"+y+",-"+y+"L-"+y+","+y+"M"+m+",0A"+m+","+m+" 0 1,1 0,-"+m+"A"+m+","+m+" 0 0,1 "+m+",0Z")},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(M,T,C){if(o(T))return s;var m=i(M,2);return S(T,C,"M0,"+m+"V-"+m+"M"+m+",0H-"+m+"M"+m+","+m+"H-"+m+"V-"+m+"H"+m+"Z")},needLine:!0,noDot:!0},"square-x":{n:30,f:function(M,T,C){if(o(T))return s;var m=i(M,2);return S(T,C,"M"+m+","+m+"L-"+m+",-"+m+"M"+m+",-"+m+"L-"+m+","+m+"M"+m+","+m+"H-"+m+"V-"+m+"H"+m+"Z")},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(M,T,C){if(o(T))return s;var m=i(M*1.3,2);return S(T,C,"M"+m+",0L0,"+m+"L-"+m+",0L0,-"+m+"ZM0,-"+m+"V"+m+"M-"+m+",0H"+m)},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(M,T,C){if(o(T))return s;var m=i(M*1.3,2),y=i(M*.65,2);return S(T,C,"M"+m+",0L0,"+m+"L-"+m+",0L0,-"+m+"ZM-"+y+",-"+y+"L"+y+","+y+"M-"+y+","+y+"L"+y+",-"+y)},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(M,T,C){if(o(T))return s;var m=i(M*1.4,2);return S(T,C,"M0,"+m+"V-"+m+"M"+m+",0H-"+m)},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(M,T,C){if(o(T))return s;var m=i(M,2);return S(T,C,"M"+m+","+m+"L-"+m+",-"+m+"M"+m+",-"+m+"L-"+m+","+m)},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(M,T,C){if(o(T))return s;var m=i(M*1.2,2),y=i(M*.85,2);return S(T,C,"M0,"+m+"V-"+m+"M"+m+",0H-"+m+"M"+y+","+y+"L-"+y+",-"+y+"M"+y+",-"+y+"L-"+y+","+y)},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(M,T,C){if(o(T))return s;var m=i(M/2,2),y=i(M,2);return S(T,C,"M"+m+","+y+"V-"+y+"M"+(m-y)+",-"+y+"V"+y+"M"+y+","+m+"H-"+y+"M-"+y+","+(m-y)+"H"+y)},needLine:!0,noFill:!0},"y-up":{n:37,f:function(M,T,C){if(o(T))return s;var m=i(M*1.2,2),y=i(M*1.6,2),A=i(M*.8,2);return S(T,C,"M-"+m+","+A+"L0,0M"+m+","+A+"L0,0M0,-"+y+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(M,T,C){if(o(T))return s;var m=i(M*1.2,2),y=i(M*1.6,2),A=i(M*.8,2);return S(T,C,"M-"+m+",-"+A+"L0,0M"+m+",-"+A+"L0,0M0,"+y+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(M,T,C){if(o(T))return s;var m=i(M*1.2,2),y=i(M*1.6,2),A=i(M*.8,2);return S(T,C,"M"+A+","+m+"L0,0M"+A+",-"+m+"L0,0M-"+y+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(M,T,C){if(o(T))return s;var m=i(M*1.2,2),y=i(M*1.6,2),A=i(M*.8,2);return S(T,C,"M-"+A+","+m+"L0,0M-"+A+",-"+m+"L0,0M"+y+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(M,T,C){if(o(T))return s;var m=i(M*1.4,2);return S(T,C,"M"+m+",0H-"+m)},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(M,T,C){if(o(T))return s;var m=i(M*1.4,2);return S(T,C,"M0,"+m+"V-"+m)},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(M,T,C){if(o(T))return s;var m=i(M,2);return S(T,C,"M"+m+",-"+m+"L-"+m+","+m)},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(M,T,C){if(o(T))return s;var m=i(M,2);return S(T,C,"M"+m+","+m+"L-"+m+",-"+m)},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(M,T,C){if(o(T))return s;var m=i(M,2),y=i(M*2,2);return S(T,C,"M0,0L-"+m+","+y+"H"+m+"Z")},backoff:1,noDot:!0},"arrow-down":{n:46,f:function(M,T,C){if(o(T))return s;var m=i(M,2),y=i(M*2,2);return S(T,C,"M0,0L-"+m+",-"+y+"H"+m+"Z")},noDot:!0},"arrow-left":{n:47,f:function(M,T,C){if(o(T))return s;var m=i(M*2,2),y=i(M,2);return S(T,C,"M0,0L"+m+",-"+y+"V"+y+"Z")},noDot:!0},"arrow-right":{n:48,f:function(M,T,C){if(o(T))return s;var m=i(M*2,2),y=i(M,2);return S(T,C,"M0,0L-"+m+",-"+y+"V"+y+"Z")},noDot:!0},"arrow-bar-up":{n:49,f:function(M,T,C){if(o(T))return s;var m=i(M,2),y=i(M*2,2);return S(T,C,"M-"+m+",0H"+m+"M0,0L-"+m+","+y+"H"+m+"Z")},backoff:1,needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(M,T,C){if(o(T))return s;var m=i(M,2),y=i(M*2,2);return S(T,C,"M-"+m+",0H"+m+"M0,0L-"+m+",-"+y+"H"+m+"Z")},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(M,T,C){if(o(T))return s;var m=i(M*2,2),y=i(M,2);return S(T,C,"M0,-"+y+"V"+y+"M0,0L"+m+",-"+y+"V"+y+"Z")},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(M,T,C){if(o(T))return s;var m=i(M*2,2),y=i(M,2);return S(T,C,"M0,-"+y+"V"+y+"M0,0L-"+m+",-"+y+"V"+y+"Z")},needLine:!0,noDot:!0},arrow:{n:53,f:function(M,T,C){if(o(T))return s;var m=h/2.5,y=2*M*p(m),A=2*M*v(m);return S(T,C,"M0,0L"+-y+","+A+"L"+y+","+A+"Z")},backoff:.9,noDot:!0},"arrow-wide":{n:54,f:function(M,T,C){if(o(T))return s;var m=h/4,y=2*M*p(m),A=2*M*v(m);return S(T,C,"M0,0L"+-y+","+A+"A "+2*M+","+2*M+" 0 0 1 "+y+","+A+"Z")},backoff:.4,noDot:!0}};function o(M){return M===null}var w,g,b,L;function S(M,T,C){if((!M||M%360===0)&&!T)return C;if(b===M&&L===T&&w===C)return g;b=M,L=T,w=C;function m(X,ne){var ae=p(X),B=v(X),ie=ne[0],se=ne[1]+(T||0);return[ie*ae-se*B,ie*B+se*ae]}for(var y=M/180*h,A=0,R=0,N=d(C),te="",H=0;H<N.length;H++){var U=N[H],P=U[0],re=A,G=R;if(P==="M"||P==="L")A=+U[1],R=+U[2];else if(P==="m"||P==="l")A+=+U[1],R+=+U[2];else if(P==="H")A=+U[1];else if(P==="h")A+=+U[1];else if(P==="V")R=+U[1];else if(P==="v")R+=+U[1];else if(P==="A"){A=+U[1],R=+U[2];var Z=m(y,[+U[6],+U[7]]);U[6]=Z[0],U[7]=Z[1],U[3]=+U[3]+M}(P==="H"||P==="V")&&(P="L"),(P==="h"||P==="v")&&(P="l"),(P==="m"||P==="l")&&(A-=re,R-=G);var Y=m(y,[A,R]);(P==="H"||P==="V")&&(P="L"),(P==="M"||P==="L"||P==="m"||P==="l")&&(U[1]=Y[0],U[2]=Y[1]),U[0]=P,te+=U[0]+U.slice(1).join(",")}return g=te,te}}),Ra=t((W,V)=>{var d=l(),i=Mt(),s=i.numberFormat,f=q(),u=ft(),h=an(),p=Xt(),v=td(),o=i.strTranslate,w=ja(),g=xi(),b=fi(),L=b.LINE_SPACING,S=Pr().DESELECTDIM,M=Ki(),T=$c(),C=So().appendArrayPointValue,m=V.exports={};m.font=function(Oe,ze){var we=ze.variant,je=ze.style,ot=ze.weight,vt=ze.color,Lt=ze.size,Tt=ze.family,kt=ze.shadow,Nt=ze.lineposition,Pt=ze.textcase;Tt&&Oe.style("font-family",Tt),Lt+1&&Oe.style("font-size",Lt+"px"),vt&&Oe.call(p.fill,vt),ot&&Oe.style("font-weight",ot),je&&Oe.style("font-style",je),we&&Oe.style("font-variant",we),Pt&&Oe.style("text-transform",y(R(Pt))),kt&&Oe.style("text-shadow",kt==="auto"?w.makeTextShadow(p.contrast(vt)):y(kt)),Nt&&Oe.style("text-decoration-line",y(N(Nt)))};function y(Oe){return Oe==="none"?void 0:Oe}var A={normal:"none",lower:"lowercase",upper:"uppercase","word caps":"capitalize"};function R(Oe){return A[Oe]}function N(Oe){return Oe.replace("under","underline").replace("over","overline").replace("through","line-through").split("+").join(" ")}m.setPosition=function(Oe,ze,we){Oe.attr("x",ze).attr("y",we)},m.setSize=function(Oe,ze,we){Oe.attr("width",ze).attr("height",we)},m.setRect=function(Oe,ze,we,je,ot){Oe.call(m.setPosition,ze,we).call(m.setSize,je,ot)},m.translatePoint=function(Oe,ze,we,je){var ot=we.c2p(Oe.x),vt=je.c2p(Oe.y);if(f(ot)&&f(vt)&&ze.node())ze.node().nodeName==="text"?ze.attr("x",ot).attr("y",vt):ze.attr("transform",o(ot,vt));else return!1;return!0},m.translatePoints=function(Oe,ze,we){Oe.each(function(je){var ot=d.select(this);m.translatePoint(je,ot,ze,we)})},m.hideOutsideRangePoint=function(Oe,ze,we,je,ot,vt){ze.attr("display",we.isPtWithinRange(Oe,ot)&&je.isPtWithinRange(Oe,vt)?null:"none")},m.hideOutsideRangePoints=function(Oe,ze){if(ze._hasClipOnAxisFalse){var we=ze.xaxis,je=ze.yaxis;Oe.each(function(ot){var vt=ot[0].trace,Lt=vt.xcalendar,Tt=vt.ycalendar,kt=h.traceIs(vt,"bar-like")?".bartext":".point,.textpoint";Oe.selectAll(kt).each(function(Nt){m.hideOutsideRangePoint(Nt,d.select(this),we,je,Lt,Tt)})})}},m.crispRound=function(Oe,ze,we){return!ze||!f(ze)?we||0:Oe._context.staticPlot?ze:ze<1?1:Math.round(ze)},m.singleLineStyle=function(Oe,ze,we,je,ot){ze.style("fill","none");var vt=(((Oe||[])[0]||{}).trace||{}).line||{},Lt=we||vt.width||0,Tt=ot||vt.dash||"";p.stroke(ze,je||vt.color),m.dashLine(ze,Tt,Lt)},m.lineGroupStyle=function(Oe,ze,we,je){Oe.style("fill","none").each(function(ot){var vt=(((ot||[])[0]||{}).trace||{}).line||{},Lt=ze||vt.width||0,Tt=je||vt.dash||"";d.select(this).call(p.stroke,we||vt.color).call(m.dashLine,Tt,Lt)})},m.dashLine=function(Oe,ze,we){we=+we||0,ze=m.dashStyle(ze,we),Oe.style({"stroke-dasharray":ze,"stroke-width":we+"px"})},m.dashStyle=function(Oe,ze){ze=+ze||1;var we=Math.max(ze,3);return Oe==="solid"?Oe="":Oe==="dot"?Oe=we+"px,"+we+"px":Oe==="dash"?Oe=3*we+"px,"+3*we+"px":Oe==="longdash"?Oe=5*we+"px,"+5*we+"px":Oe==="dashdot"?Oe=3*we+"px,"+we+"px,"+we+"px,"+we+"px":Oe==="longdashdot"&&(Oe=5*we+"px,"+2*we+"px,"+we+"px,"+2*we+"px"),Oe};function te(Oe,ze,we,je){var ot=ze.fillpattern,vt=ze.fillgradient,Lt=m.getPatternAttr,Tt=ot&&(Lt(ot.shape,0,"")||Lt(ot.path,0,""));if(Tt){var kt=Lt(ot.bgcolor,0,null),Nt=Lt(ot.fgcolor,0,null),Pt=ot.fgopacity,Wt=Lt(ot.size,0,8),St=Lt(ot.solidity,0,.3),Qt=ze.uid;m.pattern(Oe,"point",we,Qt,Tt,Wt,St,void 0,ot.fillmode,kt,Nt,Pt)}else if(vt&&vt.type!=="none"){var rr=vt.type,Jt="scatterfill-"+ze.uid;if(je&&(Jt="legendfill-"+ze.uid),!je&&(vt.start!==void 0||vt.stop!==void 0)){var sr,De;rr==="horizontal"?(sr={x:vt.start,y:0},De={x:vt.stop,y:0}):rr==="vertical"&&(sr={x:0,y:vt.start},De={x:0,y:vt.stop}),sr.x=ze._xA.c2p(sr.x===void 0?ze._extremes.x.min[0].val:sr.x,!0),sr.y=ze._yA.c2p(sr.y===void 0?ze._extremes.y.min[0].val:sr.y,!0),De.x=ze._xA.c2p(De.x===void 0?ze._extremes.x.max[0].val:De.x,!0),De.y=ze._yA.c2p(De.y===void 0?ze._extremes.y.max[0].val:De.y,!0),Oe.call(Y,we,Jt,"linear",vt.colorscale,"fill",sr,De,!0,!1)}else rr==="horizontal"&&(rr=rr+"reversed"),Oe.call(m.gradient,we,Jt,rr,vt.colorscale,"fill")}else ze.fillcolor&&Oe.call(p.fill,ze.fillcolor)}m.singleFillStyle=function(Oe,ze){var we=d.select(Oe.node()),je=we.data(),ot=((je[0]||[])[0]||{}).trace||{};te(Oe,ot,ze,!1)},m.fillGroupStyle=function(Oe,ze,we){Oe.style("stroke-width",0).each(function(je){var ot=d.select(this);je[0].trace&&te(ot,je[0].trace,ze,we)})};var H=$h();m.symbolNames=[],m.symbolFuncs=[],m.symbolBackOffs=[],m.symbolNeedLines={},m.symbolNoDot={},m.symbolNoFill={},m.symbolList=[],Object.keys(H).forEach(function(Oe){var ze=H[Oe],we=ze.n;m.symbolList.push(we,String(we),Oe,we+100,String(we+100),Oe+"-open"),m.symbolNames[we]=Oe,m.symbolFuncs[we]=ze.f,m.symbolBackOffs[we]=ze.backoff||0,ze.needLine&&(m.symbolNeedLines[we]=!0),ze.noDot?m.symbolNoDot[we]=!0:m.symbolList.push(we+200,String(we+200),Oe+"-dot",we+300,String(we+300),Oe+"-open-dot"),ze.noFill&&(m.symbolNoFill[we]=!0)});var U=m.symbolNames.length,P="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";m.symbolNumber=function(Oe){if(f(Oe))Oe=+Oe;else if(typeof Oe=="string"){var ze=0;Oe.indexOf("-open")>0&&(ze=100,Oe=Oe.replace("-open","")),Oe.indexOf("-dot")>0&&(ze+=200,Oe=Oe.replace("-dot","")),Oe=m.symbolNames.indexOf(Oe),Oe>=0&&(Oe+=ze)}return Oe%100>=U||Oe>=400?0:Math.floor(Math.max(Oe,0))};function re(Oe,ze,we,je){var ot=Oe%100;return m.symbolFuncs[ot](ze,we,je)+(Oe>=200?P:"")}var G=s("~f"),Z={radial:{type:"radial"},radialreversed:{type:"radial",reversed:!0},horizontal:{type:"linear",start:{x:1,y:0},stop:{x:0,y:0}},horizontalreversed:{type:"linear",start:{x:1,y:0},stop:{x:0,y:0},reversed:!0},vertical:{type:"linear",start:{x:0,y:1},stop:{x:0,y:0}},verticalreversed:{type:"linear",start:{x:0,y:1},stop:{x:0,y:0},reversed:!0}};m.gradient=function(Oe,ze,we,je,ot,vt){var Lt=Z[je];return Y(Oe,ze,we,Lt.type,ot,vt,Lt.start,Lt.stop,!1,Lt.reversed)};function Y(Oe,ze,we,je,ot,vt,Lt,Tt,kt,Nt){var Pt=ot.length,Wt;je==="linear"?Wt={node:"linearGradient",attrs:{x1:Lt.x,y1:Lt.y,x2:Tt.x,y2:Tt.y,gradientUnits:kt?"userSpaceOnUse":"objectBoundingBox"},reversed:Nt}:je==="radial"&&(Wt={node:"radialGradient",reversed:Nt});for(var St=new Array(Pt),Qt=0;Qt<Pt;Qt++)Wt.reversed?St[Pt-1-Qt]=[G((1-ot[Qt][0])*100),ot[Qt][1]]:St[Qt]=[G(ot[Qt][0]*100),ot[Qt][1]];var rr=ze._fullLayout,Jt="g"+rr._uid+"-"+we,sr=rr._defs.select(".gradients").selectAll("#"+Jt).data([je+St.join(";")],i.identity);sr.exit().remove(),sr.enter().append(Wt.node).each(function(){var De=d.select(this);Wt.attrs&&De.attr(Wt.attrs),De.attr("id",Jt);var Je=De.selectAll("stop").data(St);Je.exit().remove(),Je.enter().append("stop"),Je.each(function(de){var Me=u(de[1]);d.select(this).attr({offset:de[0]+"%","stop-color":p.tinyRGB(Me),"stop-opacity":Me.getAlpha()})})}),Oe.style(vt,ge(Jt,ze)).style(vt+"-opacity",null),Oe.classed("gradient_filled",!0)}m.pattern=function(Oe,ze,we,je,ot,vt,Lt,Tt,kt,Nt,Pt,Wt){var St=ze==="legend";Tt&&(kt==="overlay"?(Nt=Tt,Pt=p.contrast(Nt)):(Nt=void 0,Pt=Tt));var Qt=we._fullLayout,rr="p"+Qt._uid+"-"+je,Jt,sr,De=function(It,zt,Ut,or,xr){return or+(xr-or)*(It-zt)/(Ut-zt)},Je,de,Me,Ce,Ue={},He=u(Pt),et=p.tinyRGB(He),at=He.getAlpha(),xt=Wt*at;switch(ot){case"/":Jt=vt*Math.sqrt(2),sr=vt*Math.sqrt(2),Je="M-"+Jt/4+","+sr/4+"l"+Jt/2+",-"+sr/2+"M0,"+sr+"L"+Jt+",0M"+Jt/4*3+","+sr/4*5+"l"+Jt/2+",-"+sr/2,de=Lt*vt,Ce="path",Ue={d:Je,opacity:xt,stroke:et,"stroke-width":de+"px"};break;case"\\":Jt=vt*Math.sqrt(2),sr=vt*Math.sqrt(2),Je="M"+Jt/4*3+",-"+sr/4+"l"+Jt/2+","+sr/2+"M0,0L"+Jt+","+sr+"M-"+Jt/4+","+sr/4*3+"l"+Jt/2+","+sr/2,de=Lt*vt,Ce="path",Ue={d:Je,opacity:xt,stroke:et,"stroke-width":de+"px"};break;case"x":Jt=vt*Math.sqrt(2),sr=vt*Math.sqrt(2),Je="M-"+Jt/4+","+sr/4+"l"+Jt/2+",-"+sr/2+"M0,"+sr+"L"+Jt+",0M"+Jt/4*3+","+sr/4*5+"l"+Jt/2+",-"+sr/2+"M"+Jt/4*3+",-"+sr/4+"l"+Jt/2+","+sr/2+"M0,0L"+Jt+","+sr+"M-"+Jt/4+","+sr/4*3+"l"+Jt/2+","+sr/2,de=vt-vt*Math.sqrt(1-Lt),Ce="path",Ue={d:Je,opacity:xt,stroke:et,"stroke-width":de+"px"};break;case"|":Jt=vt,sr=vt,Ce="path",Je="M"+Jt/2+",0L"+Jt/2+","+sr,de=Lt*vt,Ce="path",Ue={d:Je,opacity:xt,stroke:et,"stroke-width":de+"px"};break;case"-":Jt=vt,sr=vt,Ce="path",Je="M0,"+sr/2+"L"+Jt+","+sr/2,de=Lt*vt,Ce="path",Ue={d:Je,opacity:xt,stroke:et,"stroke-width":de+"px"};break;case"+":Jt=vt,sr=vt,Ce="path",Je="M"+Jt/2+",0L"+Jt/2+","+sr+"M0,"+sr/2+"L"+Jt+","+sr/2,de=vt-vt*Math.sqrt(1-Lt),Ce="path",Ue={d:Je,opacity:xt,stroke:et,"stroke-width":de+"px"};break;case".":Jt=vt,sr=vt,Lt<Math.PI/4?Me=Math.sqrt(Lt*vt*vt/Math.PI):Me=De(Lt,Math.PI/4,1,vt/2,vt/Math.sqrt(2)),Ce="circle",Ue={cx:Jt/2,cy:sr/2,r:Me,opacity:xt,fill:et};break;default:Jt=vt,sr=vt,Ce="path",Ue={d:ot,opacity:xt,fill:et};break}var mt=[ot||"noSh",Nt||"noBg",Pt||"noFg",vt,Lt].join(";"),yt=Qt._defs.select(".patterns").selectAll("#"+rr).data([mt],i.identity);yt.exit().remove(),yt.enter().append("pattern").each(function(){var It=d.select(this);if(It.attr({id:rr,width:Jt+"px",height:sr+"px",patternUnits:"userSpaceOnUse",patternTransform:St?"scale(0.8)":""}),Nt){var zt=u(Nt),Ut=p.tinyRGB(zt),or=zt.getAlpha(),xr=It.selectAll("rect").data([0]);xr.exit().remove(),xr.enter().append("rect").attr({width:Jt+"px",height:sr+"px",fill:Ut,"fill-opacity":or})}var zr=It.selectAll(Ce).data([0]);zr.exit().remove(),zr.enter().append(Ce).attr(Ue)}),Oe.style("fill",ge(rr,we)).style("fill-opacity",null),Oe.classed("pattern_filled",!0)},m.initGradients=function(Oe){var ze=Oe._fullLayout,we=i.ensureSingle(ze._defs,"g","gradients");we.selectAll("linearGradient,radialGradient").remove(),d.select(Oe).selectAll(".gradient_filled").classed("gradient_filled",!1)},m.initPatterns=function(Oe){var ze=Oe._fullLayout,we=i.ensureSingle(ze._defs,"g","patterns");we.selectAll("pattern").remove(),d.select(Oe).selectAll(".pattern_filled").classed("pattern_filled",!1)},m.getPatternAttr=function(Oe,ze,we){return Oe&&i.isArrayOrTypedArray(Oe)?ze<Oe.length?Oe[ze]:we:Oe},m.pointStyle=function(Oe,ze,we,je){if(Oe.size()){var ot=m.makePointStyleFns(ze);Oe.each(function(vt){m.singlePointStyle(vt,d.select(this),ze,ot,we,je)})}},m.singlePointStyle=function(Oe,ze,we,je,ot,vt){var Lt=we.marker,Tt=Lt.line;if(vt&&vt.i>=0&&Oe.i===void 0&&(Oe.i=vt.i),ze.style("opacity",je.selectedOpacityFn?je.selectedOpacityFn(Oe):Oe.mo===void 0?Lt.opacity:Oe.mo),je.ms2mrc){var kt;Oe.ms==="various"||Lt.size==="various"?kt=3:kt=je.ms2mrc(Oe.ms),Oe.mrc=kt,je.selectedSizeFn&&(kt=Oe.mrc=je.selectedSizeFn(Oe));var Nt=m.symbolNumber(Oe.mx||Lt.symbol)||0;Oe.om=Nt%200>=100;var Pt=ct(Oe,we),Wt=F(Oe,we);ze.attr("d",re(Nt,kt,Pt,Wt))}var St=!1,Qt,rr,Jt;if(Oe.so)Jt=Tt.outlierwidth,rr=Tt.outliercolor,Qt=Lt.outliercolor;else{var sr=(Tt||{}).width;Jt=(Oe.mlw+1||sr+1||(Oe.trace?(Oe.trace.marker.line||{}).width:0)+1)-1||0,"mlc"in Oe?rr=Oe.mlcc=je.lineScale(Oe.mlc):i.isArrayOrTypedArray(Tt.color)?rr=p.defaultLine:rr=Tt.color,i.isArrayOrTypedArray(Lt.color)&&(Qt=p.defaultLine,St=!0),"mc"in Oe?Qt=Oe.mcc=je.markerScale(Oe.mc):Qt=Lt.color||Lt.colors||"rgba(0,0,0,0)",je.selectedColorFn&&(Qt=je.selectedColorFn(Oe))}if(Oe.om)ze.call(p.stroke,Qt).style({"stroke-width":(Jt||1)+"px",fill:"none"});else{ze.style("stroke-width",(Oe.isBlank?0:Jt)+"px");var De=Lt.gradient,Je=Oe.mgt;Je?St=!0:Je=De&&De.type,i.isArrayOrTypedArray(Je)&&(Je=Je[0],Z[Je]||(Je=0));var de=Lt.pattern,Me=m.getPatternAttr,Ce=de&&(Me(de.shape,Oe.i,"")||Me(de.path,Oe.i,""));if(Je&&Je!=="none"){var Ue=Oe.mgc;Ue?St=!0:Ue=De.color;var He=we.uid;St&&(He+="-"+Oe.i),m.gradient(ze,ot,He,Je,[[0,Ue],[1,Qt]],"fill")}else if(Ce){var et=!1,at=de.fgcolor;!at&&vt&&vt.color&&(at=vt.color,et=!0);var xt=Me(at,Oe.i,vt&&vt.color||null),mt=Me(de.bgcolor,Oe.i,null),yt=de.fgopacity,It=Me(de.size,Oe.i,8),zt=Me(de.solidity,Oe.i,.3);et=et||Oe.mcc||i.isArrayOrTypedArray(de.shape)||i.isArrayOrTypedArray(de.path)||i.isArrayOrTypedArray(de.bgcolor)||i.isArrayOrTypedArray(de.fgcolor)||i.isArrayOrTypedArray(de.size)||i.isArrayOrTypedArray(de.solidity);var Ut=we.uid;et&&(Ut+="-"+Oe.i),m.pattern(ze,"point",ot,Ut,Ce,It,zt,Oe.mcc,de.fillmode,mt,xt,yt)}else i.isArrayOrTypedArray(Qt)?p.fill(ze,Qt[Oe.i]):p.fill(ze,Qt);Jt&&p.stroke(ze,rr)}},m.makePointStyleFns=function(Oe){var ze={},we=Oe.marker;return ze.markerScale=m.tryColorscale(we,""),ze.lineScale=m.tryColorscale(we,"line"),h.traceIs(Oe,"symbols")&&(ze.ms2mrc=M.isBubble(Oe)?T(Oe):function(){return(we.size||6)/2}),Oe.selectedpoints&&i.extendFlat(ze,m.makeSelectedPointStyleFns(Oe)),ze},m.makeSelectedPointStyleFns=function(Oe){var ze={},we=Oe.selected||{},je=Oe.unselected||{},ot=Oe.marker||{},vt=we.marker||{},Lt=je.marker||{},Tt=ot.opacity,kt=vt.opacity,Nt=Lt.opacity,Pt=kt!==void 0,Wt=Nt!==void 0;(i.isArrayOrTypedArray(Tt)||Pt||Wt)&&(ze.selectedOpacityFn=function(Me){var Ce=Me.mo===void 0?ot.opacity:Me.mo;return Me.selected?Pt?kt:Ce:Wt?Nt:S*Ce});var St=ot.color,Qt=vt.color,rr=Lt.color;(Qt||rr)&&(ze.selectedColorFn=function(Me){var Ce=Me.mcc||St;return Me.selected?Qt||Ce:rr||Ce});var Jt=ot.size,sr=vt.size,De=Lt.size,Je=sr!==void 0,de=De!==void 0;return h.traceIs(Oe,"symbols")&&(Je||de)&&(ze.selectedSizeFn=function(Me){var Ce=Me.mrc||Jt/2;return Me.selected?Je?sr/2:Ce:de?De/2:Ce}),ze},m.makeSelectedTextStyleFns=function(Oe){var ze={},we=Oe.selected||{},je=Oe.unselected||{},ot=Oe.textfont||{},vt=we.textfont||{},Lt=je.textfont||{},Tt=ot.color,kt=vt.color,Nt=Lt.color;return ze.selectedTextColorFn=function(Pt){var Wt=Pt.tc||Tt;return Pt.selected?kt||Wt:Nt||(kt?Wt:p.addOpacity(Wt,S))},ze},m.selectedPointStyle=function(Oe,ze){if(!(!Oe.size()||!ze.selectedpoints)){var we=m.makeSelectedPointStyleFns(ze),je=ze.marker||{},ot=[];we.selectedOpacityFn&&ot.push(function(vt,Lt){vt.style("opacity",we.selectedOpacityFn(Lt))}),we.selectedColorFn&&ot.push(function(vt,Lt){p.fill(vt,we.selectedColorFn(Lt))}),we.selectedSizeFn&&ot.push(function(vt,Lt){var Tt=Lt.mx||je.symbol||0,kt=we.selectedSizeFn(Lt);vt.attr("d",re(m.symbolNumber(Tt),kt,ct(Lt,ze),F(Lt,ze))),Lt.mrc2=kt}),ot.length&&Oe.each(function(vt){for(var Lt=d.select(this),Tt=0;Tt<ot.length;Tt++)ot[Tt](Lt,vt)})}},m.tryColorscale=function(Oe,ze){var we=ze?i.nestedProperty(Oe,ze).get():Oe;if(we){var je=we.color;if((we.colorscale||we._colorAx)&&i.isArrayOrTypedArray(je))return v.makeColorScaleFuncFromTrace(we)}return i.identity};var X={start:1,end:-1,middle:0,bottom:1,top:-1};function ne(Oe,ze,we,je,ot){var vt=d.select(Oe.node().parentNode),Lt=ze.indexOf("top")!==-1?"top":ze.indexOf("bottom")!==-1?"bottom":"middle",Tt=ze.indexOf("left")!==-1?"end":ze.indexOf("right")!==-1?"start":"middle",kt=je?je/.8+1:0,Nt=(w.lineCount(Oe)-1)*L+1,Pt=X[Tt]*kt,Wt=we*.75+X[Lt]*kt+(X[Lt]-1)*Nt*we/2;Oe.attr("text-anchor",Tt),ot||vt.attr("transform",o(Pt,Wt))}function ae(Oe,ze){var we=Oe.ts||ze.textfont.size;return f(we)&&we>0?we:0}m.textPointStyle=function(Oe,ze,we){if(Oe.size()){var je;if(ze.selectedpoints){var ot=m.makeSelectedTextStyleFns(ze);je=ot.selectedTextColorFn}var vt=ze.texttemplate,Lt=we._fullLayout;Oe.each(function(Tt){var kt=d.select(this),Nt=vt?i.extractOption(Tt,ze,"txt","texttemplate"):i.extractOption(Tt,ze,"tx","text");if(!Nt&&Nt!==0){kt.remove();return}if(vt){var Pt=ze._module.formatLabels,Wt=Pt?Pt(Tt,ze,Lt):{},St={};C(St,ze,Tt.i);var Qt=ze._meta||{};Nt=i.texttemplateString(Nt,Wt,Lt._d3locale,St,Tt,Qt)}var rr=Tt.tp||ze.textposition,Jt=ae(Tt,ze),sr=je?je(Tt):Tt.tc||ze.textfont.color;kt.call(m.font,{family:Tt.tf||ze.textfont.family,weight:Tt.tw||ze.textfont.weight,style:Tt.ty||ze.textfont.style,variant:Tt.tv||ze.textfont.variant,textcase:Tt.tC||ze.textfont.textcase,lineposition:Tt.tE||ze.textfont.lineposition,shadow:Tt.tS||ze.textfont.shadow,size:Jt,color:sr}).text(Nt).call(w.convertToTspans,we).call(ne,rr,Jt,Tt.mrc)})}},m.selectedTextStyle=function(Oe,ze){if(!(!Oe.size()||!ze.selectedpoints)){var we=m.makeSelectedTextStyleFns(ze);Oe.each(function(je){var ot=d.select(this),vt=we.selectedTextColorFn(je),Lt=je.tp||ze.textposition,Tt=ae(je,ze);p.fill(ot,vt);var kt=h.traceIs(ze,"bar-like");ne(ot,Lt,Tt,je.mrc2||je.mrc,kt)})}};var B=.5;m.smoothopen=function(Oe,ze){if(Oe.length<3)return"M"+Oe.join("L");var we="M"+Oe[0],je=[],ot;for(ot=1;ot<Oe.length-1;ot++)je.push(Re(Oe[ot-1],Oe[ot],Oe[ot+1],ze));for(we+="Q"+je[0][0]+" "+Oe[1],ot=2;ot<Oe.length-1;ot++)we+="C"+je[ot-2][1]+" "+je[ot-1][0]+" "+Oe[ot];return we+="Q"+je[Oe.length-3][1]+" "+Oe[Oe.length-1],we},m.smoothclosed=function(Oe,ze){if(Oe.length<3)return"M"+Oe.join("L")+"Z";var we="M"+Oe[0],je=Oe.length-1,ot=[Re(Oe[je],Oe[0],Oe[1],ze)],vt;for(vt=1;vt<je;vt++)ot.push(Re(Oe[vt-1],Oe[vt],Oe[vt+1],ze));for(ot.push(Re(Oe[je-1],Oe[je],Oe[0],ze)),vt=1;vt<=je;vt++)we+="C"+ot[vt-1][1]+" "+ot[vt][0]+" "+Oe[vt];return we+="C"+ot[je][1]+" "+ot[0][0]+" "+Oe[0]+"Z",we};var ie,se;function ye(Oe,ze,we){return we&&(Oe=Q(Oe)),ze?xe(Oe[1]):me(Oe[0])}function me(Oe){var ze=d.round(Oe,2);return ie=ze,ze}function xe(Oe){var ze=d.round(Oe,2);return se=ze,ze}function Re(Oe,ze,we,je){var ot=Oe[0]-ze[0],vt=Oe[1]-ze[1],Lt=we[0]-ze[0],Tt=we[1]-ze[1],kt=Math.pow(ot*ot+vt*vt,B/2),Nt=Math.pow(Lt*Lt+Tt*Tt,B/2),Pt=(Nt*Nt*ot-kt*kt*Lt)*je,Wt=(Nt*Nt*vt-kt*kt*Tt)*je,St=3*Nt*(kt+Nt),Qt=3*kt*(kt+Nt);return[[me(ze[0]+(St&&Pt/St)),xe(ze[1]+(St&&Wt/St))],[me(ze[0]-(Qt&&Pt/Qt)),xe(ze[1]-(Qt&&Wt/Qt))]]}var ke={hv:function(Oe,ze,we){return"H"+me(ze[0])+"V"+ye(ze,1,we)},vh:function(Oe,ze,we){return"V"+xe(ze[1])+"H"+ye(ze,0,we)},hvh:function(Oe,ze,we){return"H"+me((Oe[0]+ze[0])/2)+"V"+xe(ze[1])+"H"+ye(ze,0,we)},vhv:function(Oe,ze,we){return"V"+xe((Oe[1]+ze[1])/2)+"H"+me(ze[0])+"V"+ye(ze,1,we)}},Ie=function(Oe,ze,we){return"L"+ye(ze,0,we)+","+ye(ze,1,we)};m.steps=function(Oe){var ze=ke[Oe]||Ie;return function(we){for(var je="M"+me(we[0][0])+","+xe(we[0][1]),ot=we.length,vt=1;vt<ot;vt++)je+=ze(we[vt-1],we[vt],vt===ot-1);return je}};function Q(Oe,ze){var we=Oe.backoff,je=Oe.trace,ot=Oe.d,vt=Oe.i;if(we&&je&&je.marker&&je.marker.angle%360===0&&je.line&&je.line.shape!=="spline"){var Lt=i.isArrayOrTypedArray(we),Tt=Oe,kt=ze?ze[0]:ie||0,Nt=ze?ze[1]:se||0,Pt=Tt[0],Wt=Tt[1],St=Pt-kt,Qt=Wt-Nt,rr=Math.atan2(Qt,St),Jt=Lt?we[vt]:we;if(Jt==="auto"){var sr=Tt.i;je.type==="scatter"&&sr--;var De=Tt.marker,Je=De.symbol;i.isArrayOrTypedArray(Je)&&(Je=Je[sr]);var de=De.size;i.isArrayOrTypedArray(de)&&(de=de[sr]),Jt=De?m.symbolBackOffs[m.symbolNumber(Je)]*de:0,Jt+=m.getMarkerStandoff(ot[sr],je)||0}var Me=Pt-Jt*Math.cos(rr),Ce=Wt-Jt*Math.sin(rr);(Me<=Pt&&Me>=kt||Me>=Pt&&Me<=kt)&&(Ce<=Wt&&Ce>=Nt||Ce>=Wt&&Ce<=Nt)&&(Oe=[Me,Ce])}return Oe}m.applyBackoff=Q,m.makeTester=function(){var Oe=i.ensureSingleById(d.select("body"),"svg","js-plotly-tester",function(we){we.attr(g.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),ze=i.ensureSingle(Oe,"path","js-reference-point",function(we){we.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});m.tester=Oe,m.testref=ze},m.savedBBoxes={};var ee=0,D=1e4;m.bBox=function(Oe,ze,we){we||(we=le(Oe));var je;if(we){if(je=m.savedBBoxes[we],je)return i.extendFlat({},je)}else if(Oe.childNodes.length===1){var ot=Oe.childNodes[0];if(we=le(ot),we){var vt=+ot.getAttribute("x")||0,Lt=+ot.getAttribute("y")||0,Tt=ot.getAttribute("transform");if(!Tt){var kt=m.bBox(ot,!1,we);return vt&&(kt.left+=vt,kt.right+=vt),Lt&&(kt.top+=Lt,kt.bottom+=Lt),kt}if(we+="~"+vt+"~"+Lt+"~"+Tt,je=m.savedBBoxes[we],je)return i.extendFlat({},je)}}var Nt,Pt;ze?Nt=Oe:(Pt=m.tester.node(),Nt=Oe.cloneNode(!0),Pt.appendChild(Nt)),d.select(Nt).attr("transform",null).call(w.positionText,0,0);var Wt=Nt.getBoundingClientRect(),St=m.testref.node().getBoundingClientRect();ze||Pt.removeChild(Nt);var Qt={height:Wt.height,width:Wt.width,left:Wt.left-St.left,top:Wt.top-St.top,right:Wt.right-St.left,bottom:Wt.bottom-St.top};return ee>=D&&(m.savedBBoxes={},ee=0),we&&(m.savedBBoxes[we]=Qt),ee++,i.extendFlat({},Qt)};function le(Oe){var ze=Oe.getAttribute("data-unformatted");if(ze!==null)return ze+Oe.getAttribute("data-math")+Oe.getAttribute("text-anchor")+Oe.getAttribute("style")}m.setClipUrl=function(Oe,ze,we){Oe.attr("clip-path",ge(ze,we))};function ge(Oe,ze){if(!Oe)return null;var we=ze._context,je=we._exportedPlot?"":we._baseUrl||"";return je?"url('"+je+"#"+Oe+"')":"url(#"+Oe+")"}m.getTranslate=function(Oe){var ze=/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,we=Oe.attr?"attr":"getAttribute",je=Oe[we]("transform")||"",ot=je.replace(ze,function(vt,Lt,Tt){return[Lt,Tt].join(" ")}).split(" ");return{x:+ot[0]||0,y:+ot[1]||0}},m.setTranslate=function(Oe,ze,we){var je=/(\btranslate\(.*?\);?)/,ot=Oe.attr?"attr":"getAttribute",vt=Oe.attr?"attr":"setAttribute",Lt=Oe[ot]("transform")||"";return ze=ze||0,we=we||0,Lt=Lt.replace(je,"").trim(),Lt+=o(ze,we),Lt=Lt.trim(),Oe[vt]("transform",Lt),Lt},m.getScale=function(Oe){var ze=/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,we=Oe.attr?"attr":"getAttribute",je=Oe[we]("transform")||"",ot=je.replace(ze,function(vt,Lt,Tt){return[Lt,Tt].join(" ")}).split(" ");return{x:+ot[0]||1,y:+ot[1]||1}},m.setScale=function(Oe,ze,we){var je=/(\bscale\(.*?\);?)/,ot=Oe.attr?"attr":"getAttribute",vt=Oe.attr?"attr":"setAttribute",Lt=Oe[ot]("transform")||"";return ze=ze||1,we=we||1,Lt=Lt.replace(je,"").trim(),Lt+="scale("+ze+","+we+")",Lt=Lt.trim(),Oe[vt]("transform",Lt),Lt};var j=/\s*sc.*/;m.setPointGroupScale=function(Oe,ze,we){if(ze=ze||1,we=we||1,!!Oe){var je=ze===1&&we===1?"":"scale("+ze+","+we+")";Oe.each(function(){var ot=(this.getAttribute("transform")||"").replace(j,"");ot+=je,ot=ot.trim(),this.setAttribute("transform",ot)})}};var k=/translate\([^)]*\)\s*$/;m.setTextPointsScale=function(Oe,ze,we){Oe&&Oe.each(function(){var je,ot=d.select(this),vt=ot.select("text");if(vt.node()){var Lt=parseFloat(vt.attr("x")||0),Tt=parseFloat(vt.attr("y")||0),kt=(ot.attr("transform")||"").match(k);ze===1&&we===1?je=[]:je=[o(Lt,Tt),"scale("+ze+","+we+")",o(-Lt,-Tt)],kt&&je.push(kt),ot.attr("transform",je.join(""))}})};function F(Oe,ze){var we;return Oe&&(we=Oe.mf),we===void 0&&(we=ze.marker&&ze.marker.standoff||0),!ze._geo&&!ze._xA?-we:we}m.getMarkerStandoff=F;var J=Math.atan2,K=Math.cos,ve=Math.sin;function Te(Oe,ze){var we=ze[0],je=ze[1];return[we*K(Oe)-je*ve(Oe),we*ve(Oe)+je*K(Oe)]}var Ae,Fe,Ge,rt,bt,ht;function ct(Oe,ze){var we=Oe.ma;we===void 0&&(we=ze.marker.angle,(!we||i.isArrayOrTypedArray(we))&&(we=0));var je,ot,vt=ze.marker.angleref;if(vt==="previous"||vt==="north"){if(ze._geo){var Lt=ze._geo.project(Oe.lonlat);je=Lt[0],ot=Lt[1]}else{var Tt=ze._xA,kt=ze._yA;if(Tt&&kt)je=Tt.c2p(Oe.x),ot=kt.c2p(Oe.y);else return 90}if(ze._geo){var Nt=Oe.lonlat[0],Pt=Oe.lonlat[1],Wt=ze._geo.project([Nt,Pt+1e-5]),St=ze._geo.project([Nt+1e-5,Pt]),Qt=J(St[1]-ot,St[0]-je),rr=J(Wt[1]-ot,Wt[0]-je),Jt;if(vt==="north")Jt=we/180*Math.PI;else if(vt==="previous"){var sr=Nt/180*Math.PI,De=Pt/180*Math.PI,Je=Ae/180*Math.PI,de=Fe/180*Math.PI,Me=Je-sr,Ce=K(de)*ve(Me),Ue=ve(de)*K(De)-K(de)*ve(De)*K(Me);Jt=-J(Ce,Ue)-Math.PI,Ae=Nt,Fe=Pt}var He=Te(Qt,[K(Jt),0]),et=Te(rr,[ve(Jt),0]);we=J(He[1]+et[1],He[0]+et[0])/Math.PI*180,vt==="previous"&&!(ht===ze.uid&&Oe.i===bt+1)&&(we=null)}if(vt==="previous"&&!ze._geo)if(ht===ze.uid&&Oe.i===bt+1&&f(je)&&f(ot)){var at=je-Ge,xt=ot-rt,mt=ze.line&&ze.line.shape||"",yt=mt.slice(mt.length-1);yt==="h"&&(xt=0),yt==="v"&&(at=0),we+=J(xt,at)/Math.PI*180+90}else we=null}return Ge=je,rt=ot,bt=Oe.i,ht=ze.uid,we}m.getMarkerAngle=ct}),Hs=t((W,V)=>{var d=l(),i=q(),s=pn(),f=an(),u=Mt(),h=u.strTranslate,p=Ra(),v=Xt(),o=ja(),w=Pr(),g=fi().OPPOSITE_SIDE,b=/ [XY][0-9]* /,L=1.6,S=1.6;function M(T,C,m){var y=T._fullLayout,A=m.propContainer,R=m.propName,N=m.placeholder,te=m.traceIndex,H=m.avoid||{},U=m.attributes,P=m.transform,re=m.containerGroup,G=1,Z=A.title,Y=(Z&&Z.text?Z.text:"").trim(),X=!1,ne=Z&&Z.font?Z.font:{},ae=ne.family,B=ne.size,ie=ne.color,se=ne.weight,ye=ne.style,me=ne.variant,xe=ne.textcase,Re=ne.lineposition,ke=ne.shadow,Ie=m.subtitlePropName,Q=!!Ie,ee=m.subtitlePlaceholder,D=(A.title||{}).subtitle||{text:"",font:{}},le=(D.text||"").trim(),ge=!1,j=1,k=D.font,F=k.family,J=k.size,K=k.color,ve=k.weight,Te=k.style,Ae=k.variant,Fe=k.textcase,Ge=k.lineposition,rt=k.shadow,bt;R==="title.text"?bt="titleText":R.indexOf("axis")!==-1?bt="axisTitleText":R.indexOf("colorbar")!==-1&&(bt="colorbarTitleText");var ht=T._context.edits[bt];function ct(St,Qt){return St===void 0||Qt===void 0?!1:St.replace(b," % ")===Qt.replace(b," % ")}Y===""?G=0:ct(Y,N)&&(ht||(Y=""),G=.2,X=!0),Q&&(le===""?j=0:ct(le,ee)&&(ht||(le=""),j=.2,ge=!0)),m._meta?Y=u.templateString(Y,m._meta):y._meta&&(Y=u.templateString(Y,y._meta));var Oe=Y||le||ht,ze;re||(re=u.ensureSingle(y._infolayer,"g","g-"+C),ze=y._hColorbarMoveTitle);var we=re.selectAll("text."+C).data(Oe?[0]:[]);we.enter().append("text"),we.text(Y).attr("class",C),we.exit().remove();var je=null,ot=C+"-subtitle",vt=le||ht;if(Q&&(je=re.selectAll("text."+ot).data(vt?[0]:[]),je.enter().append("text"),je.text(le).attr("class",ot),je.exit().remove()),!Oe)return re;function Lt(St,Qt){u.syncOrAsync([Tt,kt],{title:St,subtitle:Qt})}function Tt(St){var Qt=St.title,rr=St.subtitle,Jt;!P&&ze&&(P={}),P?(Jt="",P.rotate&&(Jt+="rotate("+[P.rotate,U.x,U.y]+")"),(P.offset||ze)&&(Jt+=h(0,(P.offset||0)-(ze||0)))):Jt=null,Qt.attr("transform",Jt);function sr(Ue){if(Ue){var He=d.select(Ue.node().parentNode).select("."+ot);if(!He.empty()){var et=Ue.node().getBBox();if(et.height){var at=et.y+et.height+L*J;He.attr("y",at)}}}}if(Qt.style("opacity",G*v.opacity(ie)).call(p.font,{color:v.rgb(ie),size:d.round(B,2),family:ae,weight:se,style:ye,variant:me,textcase:xe,shadow:ke,lineposition:Re}).attr(U).call(o.convertToTspans,T,sr),rr&&!rr.empty()){var De=re.select("."+C+"-math-group"),Je=Qt.node().getBBox(),de=De.node()?De.node().getBBox():void 0,Me=de?de.y+de.height+L*J:Je.y+Je.height+S*J,Ce=u.extendFlat({},U,{y:Me});rr.attr("transform",Jt),rr.style("opacity",j*v.opacity(K)).call(p.font,{color:v.rgb(K),size:d.round(J,2),family:F,weight:ve,style:Te,variant:Ae,textcase:Fe,shadow:rt,lineposition:Ge}).attr(Ce).call(o.convertToTspans,T)}return s.previousPromises(T)}function kt(St){var Qt=St.title,rr=d.select(Qt.node().parentNode);if(H&&H.selection&&H.side&&Y){rr.attr("transform",null);var Jt=g[H.side],sr=H.side==="left"||H.side==="top"?-1:1,De=i(H.pad)?H.pad:2,Je=p.bBox(rr.node()),de={t:0,b:0,l:0,r:0},Me=T._fullLayout._reservedMargin;for(var Ce in Me)for(var Ue in Me[Ce]){var He=Me[Ce][Ue];de[Ue]=Math.max(de[Ue],He)}var et={left:de.l,top:de.t,right:y.width-de.r,bottom:y.height-de.b},at=H.maxShift||sr*(et[H.side]-Je[H.side]),xt=0;if(at<0)xt=at;else{var mt=H.offsetLeft||0,yt=H.offsetTop||0;Je.left-=mt,Je.right-=mt,Je.top-=yt,Je.bottom-=yt,H.selection.each(function(){var zt=p.bBox(this);u.bBoxIntersect(Je,zt,De)&&(xt=Math.max(xt,sr*(zt[H.side]-Je[Jt])+De))}),xt=Math.min(at,xt),A._titleScoot=Math.abs(xt)}if(xt>0||at<0){var It={left:[-xt,0],right:[xt,0],top:[0,-xt],bottom:[0,xt]}[H.side];rr.attr("transform",h(It[0],It[1]))}}}we.call(Lt,je);function Nt(St,Qt){St.text(Qt).on("mouseover.opacity",function(){d.select(this).transition().duration(w.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){d.select(this).transition().duration(w.HIDE_PLACEHOLDER).style("opacity",0)})}if(ht&&(Y?we.on(".opacity",null):(Nt(we,N),X=!0),we.call(o.makeEditable,{gd:T}).on("edit",function(St){te!==void 0?f.call("_guiRestyle",T,R,St,te):f.call("_guiRelayout",T,R,St)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(Lt)}).on("input",function(St){this.text(St||" ").call(o.positionText,U.x,U.y)}),Q)){if(Q&&!Y){var Pt=we.node().getBBox(),Wt=Pt.y+Pt.height+S*J;je.attr("y",Wt)}le?je.on(".opacity",null):(Nt(je,ee),ge=!0),je.call(o.makeEditable,{gd:T}).on("edit",function(St){f.call("_guiRelayout",T,"title.subtitle.text",St)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(Lt)}).on("input",function(St){this.text(St||" ").call(o.positionText,je.attr("x"),je.attr("y"))})}return we.classed("js-placeholder",X),je&&!je.empty()&&je.classed("js-placeholder",ge),re}V.exports={draw:M,SUBTITLE_PADDING_EM:S,SUBTITLE_PADDING_MATHJAX_EM:L}}),$l=t((W,V)=>{var d=l(),i=_().utcFormat,s=Mt(),f=s.numberFormat,u=q(),h=s.cleanNumber,p=s.ms2DateTime,v=s.dateTime2ms,o=s.ensureNumber,w=s.isArrayOrTypedArray,g=oe(),b=g.FP_SAFE,L=g.BADNUM,S=g.LOG_CLIP,M=g.ONEWEEK,T=g.ONEDAY,C=g.ONEHOUR,m=g.ONEMIN,y=g.ONESEC,A=aa(),R=kn(),N=R.HOUR_PATTERN,te=R.WEEKDAY_PATTERN;function H(P){return Math.pow(10,P)}function U(P){return P!=null}V.exports=function(P,re){re=re||{};var G=P._id||"x",Z=G.charAt(0);function Y(D,le){if(D>0)return Math.log(D)/Math.LN10;if(D<=0&&le&&P.range&&P.range.length===2){var ge=P.range[0],j=P.range[1];return .5*(ge+j-2*S*Math.abs(ge-j))}else return L}function X(D,le,ge,j){if((j||{}).msUTC&&u(D))return+D;var k=v(D,ge||P.calendar);if(k===L)if(u(D)){D=+D;var F=Math.floor(s.mod(D+.05,1)*10),J=Math.round(D-F/10);k=v(new Date(J))+F/10}else return L;return k}function ne(D,le,ge){return p(D,le,ge||P.calendar)}function ae(D){return P._categories[Math.round(D)]}function B(D){if(U(D)){if(P._categoriesMap===void 0&&(P._categoriesMap={}),P._categoriesMap[D]!==void 0)return P._categoriesMap[D];P._categories.push(typeof D=="number"?String(D):D);var le=P._categories.length-1;return P._categoriesMap[D]=le,le}return L}function ie(D,le){for(var ge=new Array(le),j=0;j<le;j++){var k=(D[0]||[])[j],F=(D[1]||[])[j];ge[j]=se([k,F])}return ge}function se(D){if(P._categoriesMap)return P._categoriesMap[D]}function ye(D){var le=se(D);if(le!==void 0)return le;if(u(D))return+D}function me(D){return u(D)?+D:se(D)}function xe(D,le,ge){return d.round(ge+le*D,2)}function Re(D,le,ge){return(D-ge)/le}var ke=function(D){return u(D)?xe(D,P._m,P._b):L},Ie=function(D){return Re(D,P._m,P._b)};if(P.rangebreaks){var Q=Z==="y";ke=function(D){if(!u(D))return L;var le=P._rangebreaks.length;if(!le)return xe(D,P._m,P._b);var ge=Q;P.range[0]>P.range[1]&&(ge=!ge);for(var j=ge?-1:1,k=j*D,F=0,J=0;J<le;J++){var K=j*P._rangebreaks[J].min,ve=j*P._rangebreaks[J].max;if(k<K)break;if(k>ve)F=J+1;else{F=k<(K+ve)/2?J:J+1;break}}var Te=P._B[F]||0;return isFinite(Te)?xe(D,P._m2,Te):0},Ie=function(D){var le=P._rangebreaks.length;if(!le)return Re(D,P._m,P._b);for(var ge=0,j=0;j<le&&!(D<P._rangebreaks[j].pmin);j++)D>P._rangebreaks[j].pmax&&(ge=j+1);return Re(D,P._m2,P._B[ge])}}P.c2l=P.type==="log"?Y:o,P.l2c=P.type==="log"?H:o,P.l2p=ke,P.p2l=Ie,P.c2p=P.type==="log"?function(D,le){return ke(Y(D,le))}:ke,P.p2c=P.type==="log"?function(D){return H(Ie(D))}:Ie,["linear","-"].indexOf(P.type)!==-1?(P.d2r=P.r2d=P.d2c=P.r2c=P.d2l=P.r2l=h,P.c2d=P.c2r=P.l2d=P.l2r=o,P.d2p=P.r2p=function(D){return P.l2p(h(D))},P.p2d=P.p2r=Ie,P.cleanPos=o):P.type==="log"?(P.d2r=P.d2l=function(D,le){return Y(h(D),le)},P.r2d=P.r2c=function(D){return H(h(D))},P.d2c=P.r2l=h,P.c2d=P.l2r=o,P.c2r=Y,P.l2d=H,P.d2p=function(D,le){return P.l2p(P.d2r(D,le))},P.p2d=function(D){return H(Ie(D))},P.r2p=function(D){return P.l2p(h(D))},P.p2r=Ie,P.cleanPos=o):P.type==="date"?(P.d2r=P.r2d=s.identity,P.d2c=P.r2c=P.d2l=P.r2l=X,P.c2d=P.c2r=P.l2d=P.l2r=ne,P.d2p=P.r2p=function(D,le,ge){return P.l2p(X(D,0,ge))},P.p2d=P.p2r=function(D,le,ge){return ne(Ie(D),le,ge)},P.cleanPos=function(D){return s.cleanDate(D,L,P.calendar)}):P.type==="category"?(P.d2c=P.d2l=B,P.r2d=P.c2d=P.l2d=ae,P.d2r=P.d2l_noadd=ye,P.r2c=function(D){var le=me(D);return le!==void 0?le:P.fraction2r(.5)},P.l2r=P.c2r=o,P.r2l=me,P.d2p=function(D){return P.l2p(P.r2c(D))},P.p2d=function(D){return ae(Ie(D))},P.r2p=P.d2p,P.p2r=Ie,P.cleanPos=function(D){return typeof D=="string"&&D!==""?D:o(D)}):P.type==="multicategory"&&(P.r2d=P.c2d=P.l2d=ae,P.d2r=P.d2l_noadd=ye,P.r2c=function(D){var le=ye(D);return le!==void 0?le:P.fraction2r(.5)},P.r2c_just_indices=se,P.l2r=P.c2r=o,P.r2l=ye,P.d2p=function(D){return P.l2p(P.r2c(D))},P.p2d=function(D){return ae(Ie(D))},P.r2p=P.d2p,P.p2r=Ie,P.cleanPos=function(D){return Array.isArray(D)||typeof D=="string"&&D!==""?D:o(D)},P.setupMultiCategory=function(D){var le=P._traceIndices,ge,j,k=P._matchGroup;if(k&&P._categories.length===0){for(var F in k)if(F!==G){var J=re[A.id2name(F)];le=le.concat(J._traceIndices)}}var K=[[0,{}],[0,{}]],ve=[];for(ge=0;ge<le.length;ge++){var Te=D[le[ge]];if(Z in Te){var Ae=Te[Z],Fe=Te._length||s.minRowLength(Ae);if(w(Ae[0])&&w(Ae[1]))for(j=0;j<Fe;j++){var Ge=Ae[0][j],rt=Ae[1][j];U(Ge)&&U(rt)&&(ve.push([Ge,rt]),Ge in K[0][1]||(K[0][1][Ge]=K[0][0]++),rt in K[1][1]||(K[1][1][rt]=K[1][0]++))}}}for(ve.sort(function(bt,ht){var ct=K[0][1],Oe=ct[bt[0]]-ct[ht[0]];if(Oe)return Oe;var ze=K[1][1];return ze[bt[1]]-ze[ht[1]]}),ge=0;ge<ve.length;ge++)B(ve[ge])}),P.fraction2r=function(D){var le=P.r2l(P.range[0]),ge=P.r2l(P.range[1]);return P.l2r(le+D*(ge-le))},P.r2fraction=function(D){var le=P.r2l(P.range[0]),ge=P.r2l(P.range[1]);return(P.r2l(D)-le)/(ge-le)},P.limitRange=function(D){var le=P.minallowed,ge=P.maxallowed;if(!(le===void 0&&ge===void 0)){D||(D="range");var j=s.nestedProperty(P,D).get(),k=s.simpleMap(j,P.r2l),F=k[1]<k[0];F&&k.reverse();var J=s.simpleMap([le,ge],P.r2l);if(le!==void 0&&k[0]<J[0]&&(j[F?1:0]=le),ge!==void 0&&k[1]>J[1]&&(j[F?0:1]=ge),j[0]===j[1]){var K=P.l2r(le),ve=P.l2r(ge);if(le!==void 0){var Te=K+1;ge!==void 0&&(Te=Math.min(Te,ve)),j[F?1:0]=Te}if(ge!==void 0){var Ae=ve+1;le!==void 0&&(Ae=Math.max(Ae,K)),j[F?0:1]=Ae}}}},P.cleanRange=function(D,le){P._cleanRange(D,le),P.limitRange(D)},P._cleanRange=function(D,le){le||(le={}),D||(D="range");var ge=s.nestedProperty(P,D).get(),j,k;if(P.type==="date"?k=s.dfltRange(P.calendar):Z==="y"?k=R.DFLTRANGEY:P._name==="realaxis"?k=[0,1]:k=le.dfltRange||R.DFLTRANGEX,k=k.slice(),(P.rangemode==="tozero"||P.rangemode==="nonnegative")&&(k[0]=0),!ge||ge.length!==2){s.nestedProperty(P,D).set(k);return}var F=ge[0]===null,J=ge[1]===null;for(P.type==="date"&&!P.autorange&&(ge[0]=s.cleanDate(ge[0],L,P.calendar),ge[1]=s.cleanDate(ge[1],L,P.calendar)),j=0;j<2;j++)if(P.type==="date"){if(!s.isDateTime(ge[j],P.calendar)){P[D]=k;break}if(P.r2l(ge[0])===P.r2l(ge[1])){var K=s.constrain(P.r2l(ge[0]),s.MIN_MS+1e3,s.MAX_MS-1e3);ge[0]=P.l2r(K-1e3),ge[1]=P.l2r(K+1e3);break}}else{if(!u(ge[j]))if(!(F||J)&&u(ge[1-j]))ge[j]=ge[1-j]*(j?10:.1);else{P[D]=k;break}if(ge[j]<-b?ge[j]=-b:ge[j]>b&&(ge[j]=b),ge[0]===ge[1]){var ve=Math.max(1,Math.abs(ge[0]*1e-6));ge[0]-=ve,ge[1]+=ve}}},P.setScale=function(D){var le=re._size;if(P.overlaying){var ge=A.getFromId({_fullLayout:re},P.overlaying);P.domain=ge.domain}var j=D&&P._r?"_r":"range",k=P.calendar;P.cleanRange(j);var F=P.r2l(P[j][0],k),J=P.r2l(P[j][1],k),K=Z==="y";if(K?(P._offset=le.t+(1-P.domain[1])*le.h,P._length=le.h*(P.domain[1]-P.domain[0]),P._m=P._length/(F-J),P._b=-P._m*J):(P._offset=le.l+P.domain[0]*le.w,P._length=le.w*(P.domain[1]-P.domain[0]),P._m=P._length/(J-F),P._b=-P._m*F),P._rangebreaks=[],P._lBreaks=0,P._m2=0,P._B=[],P.rangebreaks){var ve,Te;if(P._rangebreaks=P.locateBreaks(Math.min(F,J),Math.max(F,J)),P._rangebreaks.length){for(ve=0;ve<P._rangebreaks.length;ve++)Te=P._rangebreaks[ve],P._lBreaks+=Math.abs(Te.max-Te.min);var Ae=K;F>J&&(Ae=!Ae),Ae&&P._rangebreaks.reverse();var Fe=Ae?-1:1;for(P._m2=Fe*P._length/(Math.abs(J-F)-P._lBreaks),P._B.push(-P._m2*(K?J:F)),ve=0;ve<P._rangebreaks.length;ve++)Te=P._rangebreaks[ve],P._B.push(P._B[P._B.length-1]-Fe*P._m2*(Te.max-Te.min));for(ve=0;ve<P._rangebreaks.length;ve++)Te=P._rangebreaks[ve],Te.pmin=ke(Te.min),Te.pmax=ke(Te.max)}}if(!isFinite(P._m)||!isFinite(P._b)||P._length<0)throw re._replotting=!1,new Error("Something went wrong with axis scaling")},P.maskBreaks=function(D){var le=P.rangebreaks||[],ge,j,k,F,J;le._cachedPatterns||(le._cachedPatterns=le.map(function(ct){return ct.enabled&&ct.bounds?s.simpleMap(ct.bounds,ct.pattern?h:P.d2c):null})),le._cachedValues||(le._cachedValues=le.map(function(ct){return ct.enabled&&ct.values?s.simpleMap(ct.values,P.d2c).sort(s.sorterAsc):null}));for(var K=0;K<le.length;K++){var ve=le[K];if(ve.enabled){if(ve.bounds){var Te=ve.pattern;switch(ge=le._cachedPatterns[K],j=ge[0],k=ge[1],Te){case te:J=new Date(D),F=J.getUTCDay(),j>k&&(k+=7,F<j&&(F+=7));break;case N:J=new Date(D);var Ae=J.getUTCHours(),Fe=J.getUTCMinutes(),Ge=J.getUTCSeconds(),rt=J.getUTCMilliseconds();F=Ae+(Fe/60+Ge/3600+rt/36e5),j>k&&(k+=24,F<j&&(F+=24));break;case"":F=D;break}if(F>=j&&F<k)return L}else for(var bt=le._cachedValues[K],ht=0;ht<bt.length;ht++)if(j=bt[ht],k=j+ve.dvalue,D>=j&&D<k)return L}}return D},P.locateBreaks=function(D,le){var ge,j,k,F,J=[];if(!P.rangebreaks)return J;var K=P.rangebreaks.slice().sort(function(ze,we){return ze.pattern===te&&we.pattern===N?-1:we.pattern===te&&ze.pattern===N?1:0}),ve=function(ze,we){if(ze=s.constrain(ze,D,le),we=s.constrain(we,D,le),ze!==we){for(var je=!0,ot=0;ot<J.length;ot++){var vt=J[ot];ze<vt.max&&we>=vt.min&&(ze<vt.min&&(vt.min=ze),we>vt.max&&(vt.max=we),je=!1)}je&&J.push({min:ze,max:we})}};for(ge=0;ge<K.length;ge++){var Te=K[ge];if(Te.enabled)if(Te.bounds){var Ae=D,Fe=le;Te.pattern&&(Ae=Math.floor(Ae)),j=s.simpleMap(Te.bounds,Te.pattern?h:P.r2l),k=j[0],F=j[1];var Ge=new Date(Ae),rt,bt;switch(Te.pattern){case te:bt=M,rt=((F<k?7:0)+(F-k))*T,Ae+=k*T-(Ge.getUTCDay()*T+Ge.getUTCHours()*C+Ge.getUTCMinutes()*m+Ge.getUTCSeconds()*y+Ge.getUTCMilliseconds());break;case N:bt=T,rt=((F<k?24:0)+(F-k))*C,Ae+=k*C-(Ge.getUTCHours()*C+Ge.getUTCMinutes()*m+Ge.getUTCSeconds()*y+Ge.getUTCMilliseconds());break;default:Ae=Math.min(j[0],j[1]),Fe=Math.max(j[0],j[1]),bt=Fe-Ae,rt=bt}for(var ht=Ae;ht<Fe;ht+=bt)ve(ht,ht+rt)}else for(var ct=s.simpleMap(Te.values,P.d2c),Oe=0;Oe<ct.length;Oe++)k=ct[Oe],F=k+Te.dvalue,ve(k,F)}return J.sort(function(ze,we){return ze.min-we.min}),J},P.makeCalcdata=function(D,le,ge){var j,k,F,J,K=P.type,ve=K==="date"&&D[le+"calendar"];if(le in D){if(j=D[le],J=D._length||s.minRowLength(j),s.isTypedArray(j)&&(K==="linear"||K==="log")){if(J===j.length)return j;if(j.subarray)return j.subarray(0,J)}if(K==="multicategory")return ie(j,J);for(k=new Array(J),F=0;F<J;F++)k[F]=P.d2c(j[F],0,ve,ge)}else{var Te=le+"0"in D?P.d2c(D[le+"0"],0,ve):0,Ae=D["d"+le]?Number(D["d"+le]):1;for(j=D[{x:"y",y:"x"}[le]],J=D._length||j.length,k=new Array(J),F=0;F<J;F++)k[F]=Te+F*Ae}if(P.rangebreaks)for(F=0;F<J;F++)k[F]=P.maskBreaks(k[F]);return k},P.isValidRange=function(D,le){return Array.isArray(D)&&D.length===2&&(le&&D[0]===null||u(P.r2l(D[0])))&&(le&&D[1]===null||u(P.r2l(D[1])))},P.getAutorangeDflt=function(D,le){var ge=!P.isValidRange(D,"nullOk");return ge&&le&&le.reverseDflt?ge="reversed":D&&(D[0]===null&&D[1]===null?ge=!0:D[0]===null&&D[1]!==null?ge="min":D[0]!==null&&D[1]===null&&(ge="max")),ge},P.isReversed=function(){var D=P.autorange;return D==="reversed"||D==="min reversed"||D==="max reversed"},P.isPtWithinRange=function(D,le){var ge=P.c2l(D[Z],null,le),j=P.r2l(P.range[0]),k=P.r2l(P.range[1]);return j<k?j<=ge&&ge<=k:k<=ge&&ge<=j},P._emptyCategories=function(){P._categories=[],P._categoriesMap={}},P.clearCalc=function(){var D=P._matchGroup;if(D){var le=null,ge=null;for(var j in D){var k=re[A.id2name(j)];if(k._categories){le=k._categories,ge=k._categoriesMap;break}}le&&ge?(P._categories=le,P._categoriesMap=ge):P._emptyCategories()}else P._emptyCategories();if(P._initialCategories)for(var F=0;F<P._initialCategories.length;F++)B(P._initialCategories[F])},P.sortByInitialCategories=function(){var D=[];if(P._emptyCategories(),P._initialCategories)for(var le=0;le<P._initialCategories.length;le++)B(P._initialCategories[le]);D=D.concat(P._traceIndices);var ge=P._matchGroup;for(var j in ge)if(G!==j){var k=re[A.id2name(j)];k._categories=P._categories,k._categoriesMap=P._categoriesMap,D=D.concat(k._traceIndices)}return D};var ee=re._d3locale;P.type==="date"&&(P._dateFormat=ee?ee.timeFormat:i,P._extraFormat=re._extraFormat),P._separators=re.separators,P._numFormat=ee?ee.numberFormat:f,delete P._minDtick,delete P._forceTick0}}),as=t((W,V)=>{var d=q(),i=Mt(),s=oe().BADNUM,f=i.isArrayOrTypedArray,u=i.isDateTime,h=i.cleanNumber,p=Math.round;V.exports=function(S,M,T){var C=S,m=T.noMultiCategory;if(f(C)&&!C.length)return"-";if(!m&&L(C))return"multicategory";if(m&&Array.isArray(C[0])){for(var y=[],A=0;A<C.length;A++)if(f(C[A]))for(var R=0;R<C[A].length;R++)y.push(C[A][R]);C=y}if(w(C,M))return"date";var N=T.autotypenumbers!=="strict";return b(C,N)?"category":o(C,N)?"linear":"-"};function v(S,M){return M?d(S):typeof S=="number"}function o(S,M){for(var T=S.length,C=0;C<T;C++)if(v(S[C],M))return!0;return!1}function w(S,M){for(var T=S.length,C=g(T),m=0,y=0,A={},R=0;R<T;R+=C){var N=p(R),te=S[N],H=String(te);A[H]||(A[H]=1,u(te,M)&&m++,d(te)&&y++)}return m>y*2}function g(S){return Math.max(1,(S-1)/1e3)}function b(S,M){for(var T=S.length,C=g(T),m=0,y=0,A={},R=0;R<T;R+=C){var N=p(R),te=S[N],H=String(te);if(!A[H]){A[H]=1;var U=typeof te;U==="boolean"?y++:(M?h(te)!==s:U==="number")?m++:U==="string"&&y++}}return y>m*2}function L(S){return f(S[0])&&f(S[1])}}),is=t((W,V)=>{var d=l(),i=q(),s=Mt(),f=oe().FP_SAFE,u=an(),h=Ra(),p=aa(),v=p.getFromId,o=p.isLinked;V.exports={applyAutorangeOptions:re,getAutoRange:w,makePadFn:b,doAutoRange:T,findExtremes:C,concatExtremes:M};function w(G,Z){var Y,X,ne=[],ae=G._fullLayout,B=b(ae,Z,0),ie=b(ae,Z,1),se=M(G,Z),ye=se.min,me=se.max;if(ye.length===0||me.length===0)return s.simpleMap(Z.range,Z.r2l);var xe=ye[0].val,Re=me[0].val;for(Y=1;Y<ye.length&&xe===Re;Y++)xe=Math.min(xe,ye[Y].val);for(Y=1;Y<me.length&&xe===Re;Y++)Re=Math.max(Re,me[Y].val);var ke=Z.autorange,Ie=ke==="reversed"||ke==="min reversed"||ke==="max reversed";if(!Ie&&Z.range){var Q=s.simpleMap(Z.range,Z.r2l);Ie=Q[1]<Q[0]}Z.autorange==="reversed"&&(Z.autorange=!0);var ee=Z.rangemode,D=ee==="tozero",le=ee==="nonnegative",ge=Z._length,j=ge/10,k=0,F,J,K,ve,Te,Ae;for(Y=0;Y<ye.length;Y++)for(F=ye[Y],X=0;X<me.length;X++)J=me[X],Ae=J.val-F.val-g(Z,F.val,J.val),Ae>0&&(Te=ge-B(F)-ie(J),Te>j?Ae/Te>k&&(K=F,ve=J,k=Ae/Te):Ae/ge>k&&(K={val:F.val,nopad:1},ve={val:J.val,nopad:1},k=Ae/ge));function Fe(ct,Oe){return Math.max(ct,ie(Oe))}if(xe===Re){var Ge=xe-1,rt=xe+1;if(D)if(xe===0)ne=[0,1];else{var bt=(xe>0?me:ye).reduce(Fe,0),ht=xe/(1-Math.min(.5,bt/ge));ne=xe>0?[0,ht]:[ht,0]}else le?ne=[Math.max(0,Ge),Math.max(1,rt)]:ne=[Ge,rt]}else D?(K.val>=0&&(K={val:0,nopad:1}),ve.val<=0&&(ve={val:0,nopad:1})):le&&(K.val-k*B(K)<0&&(K={val:0,nopad:1}),ve.val<=0&&(ve={val:1,nopad:1})),k=(ve.val-K.val-g(Z,F.val,J.val))/(ge-B(K)-ie(ve)),ne=[K.val-k*B(K),ve.val+k*ie(ve)];return ne=re(ne,Z),Z.limitRange&&Z.limitRange(),Ie&&ne.reverse(),s.simpleMap(ne,Z.l2r||Number)}function g(G,Z,Y){var X=0;if(G.rangebreaks)for(var ne=G.locateBreaks(Z,Y),ae=0;ae<ne.length;ae++){var B=ne[ae];X+=B.max-B.min}return X}function b(G,Z,Y){var X=.05*Z._length,ne=Z._anchorAxis||{};if((Z.ticklabelposition||"").indexOf("inside")!==-1||(ne.ticklabelposition||"").indexOf("inside")!==-1){var ae=Z.isReversed();if(!ae){var B=s.simpleMap(Z.range,Z.r2l);ae=B[1]<B[0]}ae&&(Y=!Y)}var ie=0;return o(G,Z._id)||(ie=S(G,Z,Y)),X=Math.max(ie,X),Z.constrain==="domain"&&Z._inputDomain&&(X*=(Z._inputDomain[1]-Z._inputDomain[0])/(Z.domain[1]-Z.domain[0])),function(se){return se.nopad?0:se.pad+(se.extrapad?X:ie)}}var L=3;function S(G,Z,Y){var X=0,ne=Z._id.charAt(0)==="x";for(var ae in G._plots){var B=G._plots[ae];if(!(Z._id!==B.xaxis._id&&Z._id!==B.yaxis._id)){var ie=(ne?B.yaxis:B.xaxis)||{};if((ie.ticklabelposition||"").indexOf("inside")!==-1&&(!Y&&(ie.side==="left"||ie.side==="bottom")||Y&&(ie.side==="top"||ie.side==="right"))){if(ie._vals){var se=s.deg2rad(ie._tickAngles[ie._id+"tick"]||0),ye=Math.abs(Math.cos(se)),me=Math.abs(Math.sin(se));if(!ie._vals[0].bb){var xe=ie._id+"tick",Re=ie._selections[xe];Re.each(function(le){var ge=d.select(this),j=ge.select(".text-math-group");j.empty()&&(le.bb=h.bBox(ge.node()))})}for(var ke=0;ke<ie._vals.length;ke++){var Ie=ie._vals[ke],Q=Ie.bb;if(Q){var ee=2*L+Q.width,D=2*L+Q.height;X=Math.max(X,ne?Math.max(ee*ye,D*me):Math.max(D*ye,ee*me))}}}ie.ticks==="inside"&&ie.ticklabelposition==="inside"&&(X+=ie.ticklen||0)}}}return X}function M(G,Z,Y){var X=Z._id,ne=G._fullData,ae=G._fullLayout,B=[],ie=[],se,ye,me;function xe(ee,D){for(se=0;se<D.length;se++){var le=ee[D[se]],ge=(le._extremes||{})[X];if(le.visible===!0&&ge){for(ye=0;ye<ge.min.length;ye++)me=ge.min[ye],m(B,me.val,me.pad,{extrapad:me.extrapad});for(ye=0;ye<ge.max.length;ye++)me=ge.max[ye],y(ie,me.val,me.pad,{extrapad:me.extrapad})}}}if(xe(ne,Z._traceIndices),xe(ae.annotations||[],Z._annIndices||[]),xe(ae.shapes||[],Z._shapeIndices||[]),Z._matchGroup&&!Y){for(var Re in Z._matchGroup)if(Re!==Z._id){var ke=v(G,Re),Ie=M(G,ke,!0),Q=Z._length/ke._length;for(ye=0;ye<Ie.min.length;ye++)me=Ie.min[ye],m(B,me.val,me.pad*Q,{extrapad:me.extrapad});for(ye=0;ye<Ie.max.length;ye++)me=Ie.max[ye],y(ie,me.val,me.pad*Q,{extrapad:me.extrapad})}}return{min:B,max:ie}}function T(G,Z,Y){if(Z.setScale(),Z.autorange){Z.range=Y?Y.slice():w(G,Z),Z._r=Z.range.slice(),Z._rl=s.simpleMap(Z._r,Z.r2l);var X=Z._input,ne={};ne[Z._attr+".range"]=Z.range,ne[Z._attr+".autorange"]=Z.autorange,u.call("_storeDirectGUIEdit",G.layout,G._fullLayout._preGUI,ne),X.range=Z.range.slice(),X.autorange=Z.autorange}var ae=Z._anchorAxis;if(ae&&ae.rangeslider){var B=ae.rangeslider[Z._name];B&&B.rangemode==="auto"&&(B.range=w(G,Z)),ae._input.rangeslider[Z._name]=s.extendFlat({},B)}}function C(G,Z,Y){Y||(Y={}),G._m||G.setScale();var X=[],ne=[],ae=Z.length,B=Y.padded||!1,ie=Y.tozero&&(G.type==="linear"||G.type==="-"),se=G.type==="log",ye=!1,me=Y.vpadLinearized||!1,xe,Re,ke,Ie,Q,ee,D,le,ge;function j(Fe){if(Array.isArray(Fe))return ye=!0,function(rt){return Math.max(Number(Fe[rt]||0),0)};var Ge=Math.max(Number(Fe||0),0);return function(){return Ge}}var k=j((G._m>0?Y.ppadplus:Y.ppadminus)||Y.ppad||0),F=j((G._m>0?Y.ppadminus:Y.ppadplus)||Y.ppad||0),J=j(Y.vpadplus||Y.vpad),K=j(Y.vpadminus||Y.vpad);if(!ye){if(le=1/0,ge=-1/0,se)for(xe=0;xe<ae;xe++)Re=Z[xe],Re<le&&Re>0&&(le=Re),Re>ge&&Re<f&&(ge=Re);else for(xe=0;xe<ae;xe++)Re=Z[xe],Re<le&&Re>-f&&(le=Re),Re>ge&&Re<f&&(ge=Re);Z=[le,ge],ae=2}var ve={tozero:ie,extrapad:B};function Te(Fe){ke=Z[Fe],i(ke)&&(ee=k(Fe),D=F(Fe),me?(Ie=G.c2l(ke)-K(Fe),Q=G.c2l(ke)+J(Fe)):(le=ke-K(Fe),ge=ke+J(Fe),se&&le<ge/10&&(le=ge/10),Ie=G.c2l(le),Q=G.c2l(ge)),ie&&(Ie=Math.min(0,Ie),Q=Math.max(0,Q)),R(Ie)&&m(X,Ie,D,ve),R(Q)&&y(ne,Q,ee,ve))}var Ae=Math.min(6,ae);for(xe=0;xe<Ae;xe++)Te(xe);for(xe=ae-1;xe>=Ae;xe--)Te(xe);return{min:X,max:ne,opts:Y}}function m(G,Z,Y,X){A(G,Z,Y,X,N)}function y(G,Z,Y,X){A(G,Z,Y,X,te)}function A(G,Z,Y,X,ne){for(var ae=X.tozero,B=X.extrapad,ie=!0,se=0;se<G.length&&ie;se++){var ye=G[se];if(ne(ye.val,Z)&&ye.pad>=Y&&(ye.extrapad||!B)){ie=!1;break}else ne(Z,ye.val)&&ye.pad<=Y&&(B||!ye.extrapad)&&(G.splice(se,1),se--)}if(ie){var me=ae&&Z===0;G.push({val:Z,pad:me?0:Y,extrapad:me?!1:B})}}function R(G){return i(G)&&Math.abs(G)<f}function N(G,Z){return G<=Z}function te(G,Z){return G>=Z}function H(G,Z){var Y=Z.autorangeoptions;return Y&&Y.minallowed!==void 0&&P(Z,Y.minallowed,Y.maxallowed)?Y.minallowed:Y&&Y.clipmin!==void 0&&P(Z,Y.clipmin,Y.clipmax)?Math.max(G,Z.d2l(Y.clipmin)):G}function U(G,Z){var Y=Z.autorangeoptions;return Y&&Y.maxallowed!==void 0&&P(Z,Y.minallowed,Y.maxallowed)?Y.maxallowed:Y&&Y.clipmax!==void 0&&P(Z,Y.clipmin,Y.clipmax)?Math.min(G,Z.d2l(Y.clipmax)):G}function P(G,Z,Y){return Z!==void 0&&Y!==void 0?(Z=G.d2l(Z),Y=G.d2l(Y),Z<Y):!0}function re(G,Z){if(!Z||!Z.autorangeoptions)return G;var Y=G[0],X=G[1],ne=Z.autorangeoptions.include;if(ne!==void 0){var ae=Z.d2l(Y),B=Z.d2l(X);s.isArrayOrTypedArray(ne)||(ne=[ne]);for(var ie=0;ie<ne.length;ie++){var se=Z.d2l(ne[ie]);ae>=se&&(ae=se,Y=se),B<=se&&(B=se,X=se)}}return Y=H(Y,Z),X=U(X,Z),[Y,X]}}),Ja=t((W,V)=>{var d=l(),i=q(),s=pn(),f=an(),u=Mt(),h=u.strTranslate,p=ja(),v=Hs(),o=Xt(),w=Ra(),g=to(),b=Bs(),L=oe(),S=L.ONEMAXYEAR,M=L.ONEAVGYEAR,T=L.ONEMINYEAR,C=L.ONEMAXQUARTER,m=L.ONEAVGQUARTER,y=L.ONEMINQUARTER,A=L.ONEMAXMONTH,R=L.ONEAVGMONTH,N=L.ONEMINMONTH,te=L.ONEWEEK,H=L.ONEDAY,U=H/2,P=L.ONEHOUR,re=L.ONEMIN,G=L.ONESEC,Z=L.ONEMILLI,Y=L.ONEMICROSEC,X=L.MINUS_SIGN,ne=L.BADNUM,ae={K:"zeroline"},B={K:"gridline",L:"path"},ie={K:"minor-gridline",L:"path"},se={K:"tick",L:"path"},ye={K:"tick",L:"text"},me={width:["x","r","l","xl","xr"],height:["y","t","b","yt","yb"],right:["r","xr"],left:["l","xl"],top:["t","yt"],bottom:["b","yb"]},xe=fi(),Re=xe.MID_SHIFT,ke=xe.CAP_SHIFT,Ie=xe.LINE_SPACING,Q=xe.OPPOSITE_SIDE,ee=3,D=V.exports={};D.setConvert=$l();var le=as(),ge=aa(),j=ge.idSort,k=ge.isLinked;D.id2name=ge.id2name,D.name2id=ge.name2id,D.cleanId=ge.cleanId,D.list=ge.list,D.listIds=ge.listIds,D.getFromId=ge.getFromId,D.getFromTrace=ge.getFromTrace;var F=is();D.getAutoRange=F.getAutoRange,D.findExtremes=F.findExtremes;var J=1e-4;function K(pe){var he=(pe[1]-pe[0])*J;return[pe[0]-he,pe[1]+he]}D.coerceRef=function(pe,he,Ye,tt,lt,We){var Ze=tt.charAt(tt.length-1),dt=Ye._fullLayout._subplots[Ze+"axis"],it=tt+"ref",At={};return lt||(lt=dt[0]||(typeof We=="string"?We:We[0])),We||(We=lt),dt=dt.concat(dt.map(function(Rt){return Rt+" domain"})),At[it]={valType:"enumerated",values:dt.concat(We?typeof We=="string"?[We]:We:[]),dflt:lt},u.coerce(pe,he,At,it)},D.getRefType=function(pe){return pe===void 0?pe:pe==="paper"?"paper":pe==="pixel"?"pixel":/( domain)$/.test(pe)?"domain":"range"},D.coercePosition=function(pe,he,Ye,tt,lt,We){var Ze,dt,it=D.getRefType(tt);if(it!=="range")Ze=u.ensureNumber,dt=Ye(lt,We);else{var At=D.getFromId(he,tt);We=At.fraction2r(We),dt=Ye(lt,We),Ze=At.cleanPos}pe[lt]=Ze(dt)},D.cleanPosition=function(pe,he,Ye){var tt=Ye==="paper"||Ye==="pixel"?u.ensureNumber:D.getFromId(he,Ye).cleanPos;return tt(pe)},D.redrawComponents=function(pe,he){he=he||D.listIds(pe);var Ye=pe._fullLayout;function tt(lt,We,Ze,dt){for(var it=f.getComponentMethod(lt,We),At={},Rt=0;Rt<he.length;Rt++)for(var Yt=Ye[D.id2name(he[Rt])],pr=Yt[Ze],fr=0;fr<pr.length;fr++){var Sr=pr[fr];if(!At[Sr]&&(it(pe,Sr),At[Sr]=1,dt))return}}tt("annotations","drawOne","_annIndices"),tt("shapes","drawOne","_shapeIndices"),tt("images","draw","_imgIndices",!0),tt("selections","drawOne","_selectionIndices")};var ve=D.getDataConversions=function(pe,he,Ye,tt){var lt,We=Ye==="x"||Ye==="y"||Ye==="z"?Ye:tt;if(u.isArrayOrTypedArray(We)){if(lt={type:le(tt,void 0,{autotypenumbers:pe._fullLayout.autotypenumbers}),_categories:[]},D.setConvert(lt),lt.type==="category")for(var Ze=0;Ze<tt.length;Ze++)lt.d2c(tt[Ze])}else lt=D.getFromTrace(pe,he,We);return lt?{d2c:lt.d2c,c2d:lt.c2d}:We==="ids"?{d2c:Ae,c2d:Ae}:{d2c:Te,c2d:Te}};function Te(pe){return+pe}function Ae(pe){return String(pe)}D.getDataToCoordFunc=function(pe,he,Ye,tt){return ve(pe,he,Ye,tt).d2c},D.counterLetter=function(pe){var he=pe.charAt(0);if(he==="x")return"y";if(he==="y")return"x"},D.minDtick=function(pe,he,Ye,tt){["log","category","multicategory"].indexOf(pe.type)!==-1||!tt?pe._minDtick=0:pe._minDtick===void 0?(pe._minDtick=he,pe._forceTick0=Ye):pe._minDtick&&((pe._minDtick/he+1e-6)%1<2e-6&&((Ye-pe._forceTick0)/he%1+1.000001)%1<2e-6?(pe._minDtick=he,pe._forceTick0=Ye):((he/pe._minDtick+1e-6)%1>2e-6||((Ye-pe._forceTick0)/pe._minDtick%1+1.000001)%1>2e-6)&&(pe._minDtick=0))},D.saveRangeInitial=function(pe,he){for(var Ye=D.list(pe,"",!0),tt=!1,lt=0;lt<Ye.length;lt++){var We=Ye[lt],Ze=We._rangeInitial0===void 0&&We._rangeInitial1===void 0,dt=Ze||We.range[0]!==We._rangeInitial0||We.range[1]!==We._rangeInitial1,it=We.autorange;(Ze&&it!==!0||he&&dt)&&(We._rangeInitial0=it==="min"||it==="max reversed"?void 0:We.range[0],We._rangeInitial1=it==="max"||it==="min reversed"?void 0:We.range[1],We._autorangeInitial=it,tt=!0)}return tt},D.saveShowSpikeInitial=function(pe,he){for(var Ye=D.list(pe,"",!0),tt=!1,lt="on",We=0;We<Ye.length;We++){var Ze=Ye[We],dt=Ze._showSpikeInitial===void 0,it=dt||Ze.showspikes!==Ze._showspikes;(dt||he&&it)&&(Ze._showSpikeInitial=Ze.showspikes,tt=!0),lt==="on"&&!Ze.showspikes&&(lt="off")}return pe._fullLayout._cartesianSpikesEnabled=lt,tt},D.autoBin=function(pe,he,Ye,tt,lt,We){var Ze=u.aggNums(Math.min,null,pe),dt=u.aggNums(Math.max,null,pe);if(he.type==="category"||he.type==="multicategory")return{start:Ze-.5,end:dt+.5,size:Math.max(1,Math.round(We)||1),_dataSpan:dt-Ze};lt||(lt=he.calendar);var it;if(he.type==="log"?it={type:"linear",range:[Ze,dt]}:it={type:he.type,range:u.simpleMap([Ze,dt],he.c2r,0,lt),calendar:lt},D.setConvert(it),We=We&&b.dtick(We,it.type),We)it.dtick=We,it.tick0=b.tick0(void 0,it.type,lt);else{var At;if(Ye)At=(dt-Ze)/Ye;else{var Rt=u.distinctVals(pe),Yt=Math.pow(10,Math.floor(Math.log(Rt.minDiff)/Math.LN10)),pr=Yt*u.roundUp(Rt.minDiff/Yt,[.9,1.9,4.9,9.9],!0);At=Math.max(pr,2*u.stdev(pe)/Math.pow(pe.length,tt?.25:.4)),i(At)||(At=1)}D.autoTicks(it,At)}var fr=it.dtick,Sr=D.tickIncrement(D.tickFirst(it),fr,"reverse",lt),hr,Cr;if(typeof fr=="number")Sr=Fe(Sr,pe,it,Ze,dt),Cr=1+Math.floor((dt-Sr)/fr),hr=Sr+Cr*fr;else for(it.dtick.charAt(0)==="M"&&(Sr=Ge(Sr,pe,fr,Ze,lt)),hr=Sr,Cr=0;hr<=dt;)hr=D.tickIncrement(hr,fr,!1,lt),Cr++;return{start:he.c2r(Sr,0,lt),end:he.c2r(hr,0,lt),size:fr,_dataSpan:dt-Ze}};function Fe(pe,he,Ye,tt,lt){var We=0,Ze=0,dt=0,it=0;function At(fr){return(1+(fr-pe)*100/Ye.dtick)%100<2}for(var Rt=0;Rt<he.length;Rt++)he[Rt]%1===0?dt++:i(he[Rt])||it++,At(he[Rt])&&We++,At(he[Rt]+Ye.dtick/2)&&Ze++;var Yt=he.length-it;if(dt===Yt&&Ye.type!=="date")Ye.dtick<1?pe=tt-.5*Ye.dtick:(pe-=.5,pe+Ye.dtick<tt&&(pe+=Ye.dtick));else if(Ze<Yt*.1&&(We>Yt*.3||At(tt)||At(lt))){var pr=Ye.dtick/2;pe+=pe+pr<tt?pr:-pr}return pe}function Ge(pe,he,Ye,tt,lt){var We=u.findExactDates(he,lt),Ze=.8;if(We.exactDays>Ze){var dt=Number(Ye.substr(1));We.exactYears>Ze&&dt%12===0?pe=D.tickIncrement(pe,"M6","reverse")+H*1.5:We.exactMonths>Ze?pe=D.tickIncrement(pe,"M1","reverse")+H*15.5:pe-=U;var it=D.tickIncrement(pe,Ye);if(it<=tt)return it}return pe}D.prepMinorTicks=function(pe,he,Ye){if(!he.minor.dtick){delete pe.dtick;var tt=he.dtick&&i(he._tmin),lt;if(tt){var We=D.tickIncrement(he._tmin,he.dtick,!0);lt=[he._tmin,We*.99+he._tmin*.01]}else{var Ze=u.simpleMap(he.range,he.r2l);lt=[Ze[0],.8*Ze[0]+.2*Ze[1]]}if(pe.range=u.simpleMap(lt,he.l2r),pe._isMinor=!0,D.prepTicks(pe,Ye),tt){var dt=i(he.dtick),it=i(pe.dtick),At=dt?he.dtick:+he.dtick.substring(1),Rt=it?pe.dtick:+pe.dtick.substring(1);dt&&it?rt(At,Rt)?At===2*te&&Rt===2*H&&(pe.dtick=te):At===2*te&&Rt===3*H?pe.dtick=te:At===te&&!(he._input.minor||{}).nticks?pe.dtick=H:bt(At/Rt,2.5)?pe.dtick=At/2:pe.dtick=At:String(he.dtick).charAt(0)==="M"?it?pe.dtick="M1":rt(At,Rt)?At>=12&&Rt===2&&(pe.dtick="M3"):pe.dtick=he.dtick:String(pe.dtick).charAt(0)==="L"?String(he.dtick).charAt(0)==="L"?rt(At,Rt)||(pe.dtick=bt(At/Rt,2.5)?he.dtick/2:he.dtick):pe.dtick="D1":pe.dtick==="D2"&&+he.dtick>1&&(pe.dtick=1)}pe.range=he.range}he.minor._tick0Init===void 0&&(pe.tick0=he.tick0)};function rt(pe,he){return Math.abs((pe/he+.5)%1-.5)<.001}function bt(pe,he){return Math.abs(pe/he-1)<.001}D.prepTicks=function(pe,he){var Ye=u.simpleMap(pe.range,pe.r2l,void 0,void 0,he);if(pe.tickmode==="auto"||!pe.dtick){var tt=pe.nticks,lt;tt||(pe.type==="category"||pe.type==="multicategory"?(lt=pe.tickfont?u.bigFont(pe.tickfont.size||12):15,tt=pe._length/lt):(lt=pe._id.charAt(0)==="y"?40:80,tt=u.constrain(pe._length/lt,4,9)+1),pe._name==="radialaxis"&&(tt*=2)),pe.minor&&pe.minor.tickmode!=="array"||pe.tickmode==="array"&&(tt*=100),pe._roughDTick=Math.abs(Ye[1]-Ye[0])/tt,D.autoTicks(pe,pe._roughDTick),pe._minDtick>0&&pe.dtick<pe._minDtick*2&&(pe.dtick=pe._minDtick,pe.tick0=pe.l2r(pe._forceTick0))}pe.ticklabelmode==="period"&&ct(pe),pe.tick0||(pe.tick0=pe.type==="date"?"2000-01-01":0),pe.type==="date"&&pe.dtick<.1&&(pe.dtick=.1),St(pe)};function ht(pe){return+pe.substring(1)}function ct(pe){var he;function Ye(){return!(i(pe.dtick)||pe.dtick.charAt(0)!=="M")}var tt=Ye(),lt=D.getTickFormat(pe);if(lt){var We=pe._dtickInit!==pe.dtick;/%[fLQsSMX]/.test(lt)||(/%[HI]/.test(lt)?(he=P,We&&!tt&&pe.dtick<P&&(pe.dtick=P)):/%p/.test(lt)?(he=U,We&&!tt&&pe.dtick<U&&(pe.dtick=U)):/%[Aadejuwx]/.test(lt)?(he=H,We&&!tt&&pe.dtick<H&&(pe.dtick=H)):/%[UVW]/.test(lt)?(he=te,We&&!tt&&pe.dtick<te&&(pe.dtick=te)):/%[Bbm]/.test(lt)?(he=R,We&&(tt?ht(pe.dtick)<1:pe.dtick<N)&&(pe.dtick="M1")):/%[q]/.test(lt)?(he=m,We&&(tt?ht(pe.dtick)<3:pe.dtick<y)&&(pe.dtick="M3")):/%[Yy]/.test(lt)&&(he=M,We&&(tt?ht(pe.dtick)<12:pe.dtick<T)&&(pe.dtick="M12")))}tt=Ye(),tt&&pe.tick0===pe._dowTick0&&(pe.tick0=pe._rawTick0),pe._definedDelta=he}function Oe(pe,he,Ye){for(var tt=0;tt<pe.length;tt++){var lt=pe[tt].value,We=tt,Ze=tt+1;tt<pe.length-1?(We=tt,Ze=tt+1):tt>0?(We=tt-1,Ze=tt):(We=tt,Ze=tt);var dt=pe[We].value,it=pe[Ze].value,At=Math.abs(it-dt),Rt=Ye||At,Yt=0;Rt>=T?At>=T&&At<=S?Yt=At:Yt=M:Ye===m&&Rt>=y?At>=y&&At<=C?Yt=At:Yt=m:Rt>=N?At>=N&&At<=A?Yt=At:Yt=R:Ye===te&&Rt>=te?Yt=te:Rt>=H?Yt=H:Ye===U&&Rt>=U?Yt=U:Ye===P&&Rt>=P&&(Yt=P);var pr;Yt>=At&&(Yt=At,pr=!0);var fr=lt+Yt;if(he.rangebreaks&&Yt>0){for(var Sr=84,hr=0,Cr=0;Cr<Sr;Cr++){var Fr=(Cr+.5)/Sr;he.maskBreaks(lt*(1-Fr)+Fr*fr)!==ne&&hr++}Yt*=hr/Sr,Yt||(pe[tt].drop=!0),pr&&At>te&&(Yt=At)}(Yt>0||tt===0)&&(pe[tt].periodX=lt+Yt/2)}}D.calcTicks=function(pe,he){for(var Ye=pe.type,tt=pe.calendar,lt=pe.ticklabelstep,We=pe.ticklabelmode==="period",Ze=pe.range[0]>pe.range[1],dt=!pe.ticklabelindex||u.isArrayOrTypedArray(pe.ticklabelindex)?pe.ticklabelindex:[pe.ticklabelindex],it=u.simpleMap(pe.range,pe.r2l,void 0,void 0,he),At=it[1]<it[0],Rt=Math.min(it[0],it[1]),Yt=Math.max(it[0],it[1]),pr=Math.max(1e3,pe._length||0),fr=[],Sr=[],hr=[],Cr=[],Fr=[],Un=pe.minor&&(pe.minor.ticks||pe.minor.showgrid),on=1;on>=(Un?0:1);on--){var la=!on;on?(pe._dtickInit=pe.dtick,pe._tick0Init=pe.tick0):(pe.minor._dtickInit=pe.minor.dtick,pe.minor._tick0Init=pe.minor.tick0);var bn=on?pe:u.extendFlat({},pe,pe.minor);if(la?D.prepMinorTicks(bn,pe,he):D.prepTicks(bn,he),bn.tickmode==="array"){on?(hr=[],fr=je(pe,!la)):(Cr=[],Sr=je(pe,!la));continue}if(bn.tickmode==="sync"){hr=[],fr=we(pe);continue}var ha=K(it),sa=ha[0],Fa=ha[1],ka=i(bn.dtick),An=Ye==="log"&&!(ka||bn.dtick.charAt(0)==="L"),Va=D.tickFirst(bn,he);if(on){if(pe._tmin=Va,Va<sa!==At)break;(Ye==="category"||Ye==="multicategory")&&(Fa=At?Math.max(-.5,Fa):Math.min(pe._categories.length-.5,Fa))}var Pa=null,In=Va,Oa;if(on){var Ua;ka?Ua=pe.dtick:Ye==="date"?typeof pe.dtick=="string"&&pe.dtick.charAt(0)==="M"&&(Ua=R*pe.dtick.substring(1)):Ua=pe._roughDTick,Oa=Math.round((pe.r2l(In)-pe.r2l(pe.tick0))/Ua)-1}var Na=bn.dtick;for(bn.rangebreaks&&bn._tick0Init!==bn.tick0&&(In=Gn(In,pe),At||(In=D.tickIncrement(In,Na,!At,tt))),on&&We&&(In=D.tickIncrement(In,Na,!At,tt),Oa--);At?In>=Fa:In<=Fa;In=D.tickIncrement(In,Na,At,tt)){if(on&&Oa++,bn.rangebreaks&&!At){if(In<sa)continue;if(bn.maskBreaks(In)===ne&&Gn(In,bn)>=Yt)break}if(hr.length>pr||In===Pa)break;Pa=In;var ii={value:In};on?(An&&In!==(In|0)&&(ii.simpleLabel=!0),lt>1&&Oa%lt&&(ii.skipLabel=!0),hr.push(ii)):(ii.minor=!0,Cr.push(ii))}}if(!Cr||Cr.length<2)dt=!1;else{var Ii=(Cr[1].value-Cr[0].value)*(Ze?-1:1);oa(Ii,pe.tickformat)||(dt=!1)}if(!dt)Fr=hr;else{var ea=hr.concat(Cr);We&&hr.length&&(ea=ea.slice(1)),ea=ea.sort(function(wa,Za){return wa.value-Za.value}).filter(function(wa,Za,pi){return Za===0||wa.value!==pi[Za-1].value});var _a=ea.map(function(wa,Za){return wa.minor===void 0&&!wa.skipLabel?Za:null}).filter(function(wa){return wa!==null});_a.forEach(function(wa){dt.map(function(Za){var pi=wa+Za;pi>=0&&pi<ea.length&&u.pushUnique(Fr,ea[pi])})})}if(Un){var ca=pe.minor.ticks==="inside"&&pe.ticks==="outside"||pe.minor.ticks==="outside"&&pe.ticks==="inside";if(!ca){for(var ba=hr.map(function(wa){return wa.value}),Wa=[],oi=0;oi<Cr.length;oi++){var _i=Cr[oi],si=_i.value;if(ba.indexOf(si)===-1){for(var Li=!1,li=0;!Li&&li<hr.length;li++)1e7+hr[li].value===1e7+si&&(Li=!0);Li||Wa.push(_i)}}Cr=Wa}}We&&Oe(Fr,pe,pe._definedDelta);var ua;if(pe.rangebreaks){var ao=pe._id.charAt(0)==="y",bi=1;pe.tickmode==="auto"&&(bi=pe.tickfont?pe.tickfont.size:12);var Ui=NaN;for(ua=hr.length-1;ua>-1;ua--){if(hr[ua].drop){hr.splice(ua,1);continue}hr[ua].value=Gn(hr[ua].value,pe);var Ri=pe.c2p(hr[ua].value);(ao?Ui>Ri-bi:Ui<Ri+bi)?hr.splice(At?ua+1:ua,1):Ui=Ri}}Vn(pe)&&Math.abs(it[1]-it[0])===360&&hr.pop(),pe._tmax=(hr[hr.length-1]||{}).value,pe._prevDateHead="",pe._inCalcTicks=!0;var wi,bo=function(wa){wa.text="",pe._prevDateHead=wi};hr=hr.concat(Cr);function $i(wa,Za){var pi=D.tickText(wa,Za.value,!1,Za.simpleLabel),Bi=Za.periodX;return Bi!==void 0&&(pi.periodX=Bi,(Bi>Yt||Bi<Rt)&&(Bi>Yt&&(pi.periodX=Yt),Bi<Rt&&(pi.periodX=Rt),bo(pi))),pi}var Mi;for(ua=0;ua<hr.length;ua++){var po=hr[ua].minor,Co=hr[ua].value;po?(dt&&Fr.indexOf(hr[ua])!==-1?Mi=$i(pe,hr[ua]):Mi={x:Co},Mi.minor=!0,Sr.push(Mi)):(wi=pe._prevDateHead,Mi=$i(pe,hr[ua]),(hr[ua].skipLabel||dt&&Fr.indexOf(hr[ua])===-1)&&bo(Mi),fr.push(Mi))}return fr=fr.concat(Sr),pe._inCalcTicks=!1,We&&fr.length&&(fr[0].noTick=!0),fr};function ze(pe,he){return pe.rangebreaks&&(he=he.filter(function(Ye){return pe.maskBreaks(Ye.x)!==ne})),he}function we(pe){var he=pe._mainAxis,Ye=[];if(he._vals){for(var tt=0;tt<he._vals.length;tt++)if(!he._vals[tt].noTick){var lt=he.l2p(he._vals[tt].x),We=pe.p2l(lt),Ze=D.tickText(pe,We);he._vals[tt].minor&&(Ze.minor=!0,Ze.text=""),Ye.push(Ze)}}return Ye=ze(pe,Ye),Ye}function je(pe,he){var Ye=u.simpleMap(pe.range,pe.r2l),tt=K(Ye),lt=Math.min(tt[0],tt[1]),We=Math.max(tt[0],tt[1]),Ze=pe.type==="category"?pe.d2l_noadd:pe.d2l;pe.type==="log"&&String(pe.dtick).charAt(0)!=="L"&&(pe.dtick="L"+Math.pow(10,Math.floor(Math.min(pe.range[0],pe.range[1]))-1));for(var dt=[],it=0;it<=1;it++)if(!(he!==void 0&&(he&&it||he===!1&&!it))&&!(it&&!pe.minor)){var At=it?pe.minor.tickvals:pe.tickvals,Rt=it?[]:pe.ticktext;if(At){u.isArrayOrTypedArray(Rt)||(Rt=[]);for(var Yt=0;Yt<At.length;Yt++){var pr=Ze(At[Yt]);if(pr>lt&&pr<We){var fr=D.tickText(pe,pr,!1,String(Rt[Yt]));it&&(fr.minor=!0,fr.text=""),dt.push(fr)}}}}return dt=ze(pe,dt),dt}var ot=[2,5,10],vt=[1,2,3,6,12],Lt=[1,2,5,10,15,30],Tt=[1,2,3,7,14],kt=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],Nt=[-.301,0,.301,.699,1],Pt=[15,30,45,90,180];function Wt(pe,he,Ye){return he*u.roundUp(pe/he,Ye)}D.autoTicks=function(pe,he,Ye){var tt;function lt(Yt){return Math.pow(Yt,Math.floor(Math.log(he)/Math.LN10))}if(pe.type==="date"){pe.tick0=u.dateTick0(pe.calendar,0);var We=2*he;if(We>M)he/=M,tt=lt(10),pe.dtick="M"+12*Wt(he,tt,ot);else if(We>R)he/=R,pe.dtick="M"+Wt(he,1,vt);else if(We>H){if(pe.dtick=Wt(he,H,pe._hasDayOfWeekBreaks?[1,2,7,14]:Tt),!Ye){var Ze=D.getTickFormat(pe),dt=pe.ticklabelmode==="period";dt&&(pe._rawTick0=pe.tick0),/%[uVW]/.test(Ze)?pe.tick0=u.dateTick0(pe.calendar,2):pe.tick0=u.dateTick0(pe.calendar,1),dt&&(pe._dowTick0=pe.tick0)}}else We>P?pe.dtick=Wt(he,P,vt):We>re?pe.dtick=Wt(he,re,Lt):We>G?pe.dtick=Wt(he,G,Lt):(tt=lt(10),pe.dtick=Wt(he,tt,ot))}else if(pe.type==="log"){pe.tick0=0;var it=u.simpleMap(pe.range,pe.r2l);if(pe._isMinor&&(he*=1.5),he>.7)pe.dtick=Math.ceil(he);else if(Math.abs(it[1]-it[0])<1){var At=1.5*Math.abs((it[1]-it[0])/he);he=Math.abs(Math.pow(10,it[1])-Math.pow(10,it[0]))/At,tt=lt(10),pe.dtick="L"+Wt(he,tt,ot)}else pe.dtick=he>.3?"D2":"D1"}else pe.type==="category"||pe.type==="multicategory"?(pe.tick0=0,pe.dtick=Math.ceil(Math.max(he,1))):Vn(pe)?(pe.tick0=0,tt=1,pe.dtick=Wt(he,tt,Pt)):(pe.tick0=0,tt=lt(10),pe.dtick=Wt(he,tt,ot));if(pe.dtick===0&&(pe.dtick=1),!i(pe.dtick)&&typeof pe.dtick!="string"){var Rt=pe.dtick;throw pe.dtick=1,"ax.dtick error: "+String(Rt)}};function St(pe){var he=pe.dtick;if(pe._tickexponent=0,!i(he)&&typeof he!="string"&&(he=1),(pe.type==="category"||pe.type==="multicategory")&&(pe._tickround=null),pe.type==="date"){var Ye=pe.r2l(pe.tick0),tt=pe.l2r(Ye).replace(/(^-|i)/g,""),lt=tt.length;if(String(he).charAt(0)==="M")lt>10||tt.substr(5)!=="01-01"?pe._tickround="d":pe._tickround=+he.substr(1)%12===0?"y":"m";else if(he>=H&&lt<=10||he>=H*15)pe._tickround="d";else if(he>=re&&lt<=16||he>=P)pe._tickround="M";else if(he>=G&&lt<=19||he>=re)pe._tickround="S";else{var We=pe.l2r(Ye+he).replace(/^-/,"").length;pe._tickround=Math.max(lt,We)-20,pe._tickround<0&&(pe._tickround=4)}}else if(i(he)||he.charAt(0)==="L"){var Ze=pe.range.map(pe.r2d||Number);i(he)||(he=Number(he.substr(1))),pe._tickround=2-Math.floor(Math.log(he)/Math.LN10+.01);var dt=Math.max(Math.abs(Ze[0]),Math.abs(Ze[1])),it=Math.floor(Math.log(dt)/Math.LN10+.01),At=pe.minexponent===void 0?3:pe.minexponent;Math.abs(it)>At&&(He(pe.exponentformat)&&pe.exponentformat!=="SI extended"&&!et(it)||He(pe.exponentformat)&&pe.exponentformat==="SI extended"&&!at(it)?pe._tickexponent=3*Math.round((it-1)/3):pe._tickexponent=it)}else pe._tickround=null}D.tickIncrement=function(pe,he,Ye,tt){var lt=Ye?-1:1;if(i(he))return u.increment(pe,lt*he);var We=he.charAt(0),Ze=lt*Number(he.substr(1));if(We==="M")return u.incrementMonth(pe,Ze,tt);if(We==="L")return Math.log(Math.pow(10,pe)+Ze)/Math.LN10;if(We==="D"){var dt=he==="D2"?Nt:kt,it=pe+lt*.01,At=u.roundUp(u.mod(it,1),dt,Ye);return Math.floor(it)+Math.log(d.round(Math.pow(10,At),1))/Math.LN10}throw"unrecognized dtick "+String(he)},D.tickFirst=function(pe,he){var Ye=pe.r2l||Number,tt=u.simpleMap(pe.range,Ye,void 0,void 0,he),lt=tt[1]<tt[0],We=lt?Math.floor:Math.ceil,Ze=K(tt)[0],dt=pe.dtick,it=Ye(pe.tick0);if(i(dt)){var At=We((Ze-it)/dt)*dt+it;return(pe.type==="category"||pe.type==="multicategory")&&(At=u.constrain(At,0,pe._categories.length-1)),At}var Rt=dt.charAt(0),Yt=Number(dt.substr(1));if(Rt==="M"){for(var pr=0,fr=it,Sr,hr,Cr;pr<10;){if(Sr=D.tickIncrement(fr,dt,lt,pe.calendar),(Sr-Ze)*(fr-Ze)<=0)return lt?Math.min(fr,Sr):Math.max(fr,Sr);hr=(Ze-(fr+Sr)/2)/(Sr-fr),Cr=Rt+(Math.abs(Math.round(hr))||1)*Yt,fr=D.tickIncrement(fr,Cr,hr<0?!lt:lt,pe.calendar),pr++}return u.error("tickFirst did not converge",pe),fr}else{if(Rt==="L")return Math.log(We((Math.pow(10,Ze)-it)/Yt)*Yt+it)/Math.LN10;if(Rt==="D"){var Fr=dt==="D2"?Nt:kt,Un=u.roundUp(u.mod(Ze,1),Fr,lt);return Math.floor(Ze)+Math.log(d.round(Math.pow(10,Un),1))/Math.LN10}else throw"unrecognized dtick "+String(dt)}},D.tickText=function(pe,he,Ye,tt){var lt=Qt(pe,he),We=pe.tickmode==="array",Ze=Ye||We,dt=pe.type,it=dt==="category"?pe.d2l_noadd:pe.d2l,At,Rt=function(Cr){var Fr=pe.l2p(Cr);return Fr>=0&&Fr<=pe._length?Cr:null};if(We&&u.isArrayOrTypedArray(pe.ticktext)){var Yt=u.simpleMap(pe.range,pe.r2l),pr=(Math.abs(Yt[1]-Yt[0])-(pe._lBreaks||0))/1e4;for(At=0;At<pe.ticktext.length&&!(Math.abs(he-it(pe.tickvals[At]))<pr);At++);if(At<pe.ticktext.length)return lt.text=String(pe.ticktext[At]),lt.xbnd=[Rt(lt.x-.5),Rt(lt.x+pe.dtick-.5)],lt}function fr(Cr){if(Cr===void 0)return!0;if(Ye)return Cr==="none";var Fr={first:pe._tmin,last:pe._tmax}[Cr];return Cr!=="all"&&he!==Fr}var Sr=Ye?"never":pe.exponentformat!=="none"&&fr(pe.showexponent)?"hide":"";if(dt==="date"?rr(pe,lt,Ye,Ze):dt==="log"?Jt(pe,lt,Ye,Ze,Sr):dt==="category"?sr(pe,lt):dt==="multicategory"?De(pe,lt,Ye):Vn(pe)?de(pe,lt,Ye,Ze,Sr):Je(pe,lt,Ye,Ze,Sr),tt||(pe.tickprefix&&!fr(pe.showtickprefix)&&(lt.text=pe.tickprefix+lt.text),pe.ticksuffix&&!fr(pe.showticksuffix)&&(lt.text+=pe.ticksuffix)),pe.labelalias&&pe.labelalias.hasOwnProperty(lt.text)){var hr=pe.labelalias[lt.text];typeof hr=="string"&&(lt.text=hr)}return(pe.tickson==="boundaries"||pe.showdividers)&&(lt.xbnd=[Rt(lt.x-.5),Rt(lt.x+pe.dtick-.5)]),lt},D.hoverLabelText=function(pe,he,Ye){Ye&&(pe=u.extendFlat({},pe,{hoverformat:Ye}));var tt=u.isArrayOrTypedArray(he)?he[0]:he,lt=u.isArrayOrTypedArray(he)?he[1]:void 0;if(lt!==void 0&&lt!==tt)return D.hoverLabelText(pe,tt,Ye)+" - "+D.hoverLabelText(pe,lt,Ye);var We=pe.type==="log"&&tt<=0,Ze=D.tickText(pe,pe.c2l(We?-tt:tt),"hover").text;return We?tt===0?"0":X+Ze:Ze};function Qt(pe,he,Ye){var tt=pe.tickfont||{};return{x:he,dx:0,dy:0,text:Ye||"",fontSize:tt.size,font:tt.family,fontWeight:tt.weight,fontStyle:tt.style,fontVariant:tt.variant,fontTextcase:tt.textcase,fontLineposition:tt.lineposition,fontShadow:tt.shadow,fontColor:tt.color}}function rr(pe,he,Ye,tt){var lt=pe._tickround,We=Ye&&pe.hoverformat||D.getTickFormat(pe);tt=!We&&tt,tt&&(i(lt)?lt=4:lt={y:"m",m:"d",d:"M",M:"S",S:4}[lt]);var Ze=u.formatDate(he.x,We,lt,pe._dateFormat,pe.calendar,pe._extraFormat),dt,it=Ze.indexOf(`
`);if(it!==-1&&(dt=Ze.substr(it+1),Ze=Ze.substr(0,it)),tt&&(dt!==void 0&&(Ze==="00:00:00"||Ze==="00:00")?(Ze=dt,dt=""):Ze.length===8&&(Ze=Ze.replace(/:00$/,""))),dt)if(Ye)lt==="d"?Ze+=", "+dt:Ze=dt+(Ze?", "+Ze:"");else if(!pe._inCalcTicks||pe._prevDateHead!==dt)pe._prevDateHead=dt,Ze+="<br>"+dt;else{var At=sn(pe),Rt=pe._trueSide||pe.side;(!At&&Rt==="top"||At&&Rt==="bottom")&&(Ze+="<br> ")}he.text=Ze}function Jt(pe,he,Ye,tt,lt){var We=pe.dtick,Ze=he.x,dt=pe.tickformat,it=typeof We=="string"&&We.charAt(0);if(lt==="never"&&(lt=""),tt&&it!=="L"&&(We="L3",it="L"),dt||it==="L")he.text=mt(Math.pow(10,Ze),pe,lt,tt);else if(i(We)||it==="D"&&(pe.minorloglabels==="complete"||u.mod(Ze+.01,1)<.1)){pe.minorloglabels==="complete"&&!(u.mod(Ze+.01,1)<.1)&&(he.fontSize*=.75);var At=Math.pow(10,Ze).toExponential(0),Rt=At.split("e"),Yt=+Rt[1],pr=Math.abs(Yt),fr=pe.exponentformat;fr==="power"||He(fr)&&fr!=="SI extended"&&et(Yt)||He(fr)&&fr==="SI extended"&&at(Yt)?(he.text=Rt[0],pr>0&&(he.text+="x10"),he.text==="1x10"&&(he.text="10"),Yt!==0&&Yt!==1&&(he.text+="<sup>"+(Yt>0?"":X)+pr+"</sup>"),he.fontSize*=1.25):(fr==="e"||fr==="E")&&pr>2?he.text=Rt[0]+fr+(Yt>0?"+":X)+pr:(he.text=mt(Math.pow(10,Ze),pe,"","fakehover"),We==="D1"&&pe._id.charAt(0)==="y"&&(he.dy-=he.fontSize/6))}else if(it==="D")he.text=pe.minorloglabels==="none"?"":String(Math.round(Math.pow(10,u.mod(Ze,1)))),he.fontSize*=.75;else throw"unrecognized dtick "+String(We);if(pe.dtick==="D1"){var Sr=String(he.text).charAt(0);(Sr==="0"||Sr==="1")&&(pe._id.charAt(0)==="y"?he.dx-=he.fontSize/4:(he.dy+=he.fontSize/2,he.dx+=(pe.range[1]>pe.range[0]?1:-1)*he.fontSize*(Ze<0?.5:.25)))}}function sr(pe,he){var Ye=pe._categories[Math.round(he.x)];Ye===void 0&&(Ye=""),he.text=String(Ye)}function De(pe,he,Ye){var tt=Math.round(he.x),lt=pe._categories[tt]||[],We=lt[1]===void 0?"":String(lt[1]),Ze=lt[0]===void 0?"":String(lt[0]);Ye?he.text=Ze+" - "+We:(he.text=We,he.text2=Ze)}function Je(pe,he,Ye,tt,lt){lt==="never"?lt="":pe.showexponent==="all"&&Math.abs(he.x/pe.dtick)<1e-6&&(lt="hide"),he.text=mt(he.x,pe,lt,tt)}function de(pe,he,Ye,tt,lt){if(pe.thetaunit==="radians"&&!Ye){var We=he.x/180;if(We===0)he.text="0";else{var Ze=Me(We);if(Ze[1]>=100)he.text=mt(u.deg2rad(he.x),pe,lt,tt);else{var dt=he.x<0;Ze[1]===1?Ze[0]===1?he.text="":he.text=Ze[0]+"":he.text=["<sup>",Ze[0],"</sup>","","<sub>",Ze[1],"</sub>",""].join(""),dt&&(he.text=X+he.text)}}}else he.text=mt(he.x,pe,lt,tt)}function Me(pe){function he(dt,it){return Math.abs(dt-it)<=1e-6}function Ye(dt,it){return he(it,0)?dt:Ye(it,dt%it)}function tt(dt){for(var it=1;!he(Math.round(dt*it)/it,dt);)it*=10;return it}var lt=tt(pe),We=pe*lt,Ze=Math.abs(Ye(We,lt));return[Math.round(We/Ze),Math.round(lt/Ze)]}var Ce=["f","p","n","","m","","k","M","G","T"],Ue=["q","r","y","z","a",...Ce,"P","E","Z","Y","R","Q"],He=pe=>["SI","SI extended","B"].includes(pe);function et(pe){return pe>14||pe<-15}function at(pe){return pe>32||pe<-30}function xt(pe,he){return He(he)?!!(he==="SI extended"&&at(pe)||he!=="SI extended"&&et(pe)):!1}function mt(pe,he,Ye,tt){var lt=pe<0,We=he._tickround,Ze=Ye||he.exponentformat||"B",dt=he._tickexponent,it=D.getTickFormat(he),At=he.separatethousands;if(tt){var Rt={exponentformat:Ze,minexponent:he.minexponent,dtick:he.showexponent==="none"?he.dtick:i(pe)&&Math.abs(pe)||1,range:he.showexponent==="none"?he.range.map(he.r2d):[0,pe||1]};St(Rt),We=(Number(Rt._tickround)||0)+4,dt=Rt._tickexponent,he.hoverformat&&(it=he.hoverformat)}if(it)return he._numFormat(it)(pe).replace(/-/g,X);var Yt=Math.pow(10,-We)/2;if(Ze==="none"&&(dt=0),pe=Math.abs(pe),pe<Yt)pe="0",lt=!1;else{if(pe+=Yt,dt&&(pe*=Math.pow(10,-dt),We+=dt),We===0)pe=String(Math.floor(pe));else if(We<0){pe=String(Math.round(pe)),pe=pe.substr(0,pe.length+We);for(var pr=We;pr<0;pr++)pe+="0"}else{pe=String(pe);var fr=pe.indexOf(".")+1;fr&&(pe=pe.substr(0,fr+We).replace(/\.?0+$/,""))}pe=u.numSeparate(pe,he._separators,At)}if(dt&&Ze!=="hide"){xt(dt,Ze)&&(Ze="power");var Sr;dt<0?Sr=X+-dt:Ze!=="power"?Sr="+"+dt:Sr=String(dt),Ze==="e"||Ze==="E"?pe+=Ze+Sr:Ze==="power"?pe+="10<sup>"+Sr+"</sup>":Ze==="B"&&dt===9?pe+="B":He(Ze)&&(pe+=Ze==="SI extended"?Ue[dt/3+10]:Ce[dt/3+5])}return lt?X+pe:pe}D.getTickFormat=function(pe){var he;function Ye(it){return typeof it!="string"?it:Number(it.replace("M",""))*R}function tt(it,At){var Rt=["L","D"];if(typeof it==typeof At){if(typeof it=="number")return it-At;var Yt=Rt.indexOf(it.charAt(0)),pr=Rt.indexOf(At.charAt(0));return Yt===pr?Number(it.replace(/(L|D)/g,""))-Number(At.replace(/(L|D)/g,"")):Yt-pr}else return typeof it=="number"?1:-1}function lt(it,At,Rt){var Yt=Rt||function(Sr){return Sr},pr=At[0],fr=At[1];return(!pr&&typeof pr!="number"||Yt(pr)<=Yt(it))&&(!fr&&typeof fr!="number"||Yt(fr)>=Yt(it))}function We(it,At){var Rt=At[0]===null,Yt=At[1]===null,pr=tt(it,At[0])>=0,fr=tt(it,At[1])<=0;return(Rt||pr)&&(Yt||fr)}var Ze,dt;if(pe.tickformatstops&&pe.tickformatstops.length>0)switch(pe.type){case"date":case"linear":{for(he=0;he<pe.tickformatstops.length;he++)if(dt=pe.tickformatstops[he],dt.enabled&&lt(pe.dtick,dt.dtickrange,Ye)){Ze=dt;break}break}case"log":{for(he=0;he<pe.tickformatstops.length;he++)if(dt=pe.tickformatstops[he],dt.enabled&&We(pe.dtick,dt.dtickrange)){Ze=dt;break}break}}return Ze?Ze.value:pe.tickformat},D.getSubplots=function(pe,he){var Ye=pe._fullLayout._subplots,tt=Ye.cartesian.concat(Ye.gl2d||[]),lt=he?D.findSubplotsWithAxis(tt,he):tt;return lt.sort(function(We,Ze){var dt=We.substr(1).split("y"),it=Ze.substr(1).split("y");return dt[0]===it[0]?+dt[1]-+it[1]:+dt[0]-+it[0]}),lt},D.findSubplotsWithAxis=function(pe,he){for(var Ye=new RegExp(he._id.charAt(0)==="x"?"^"+he._id+"y":he._id+"$"),tt=[],lt=0;lt<pe.length;lt++){var We=pe[lt];Ye.test(We)&&tt.push(We)}return tt},D.makeClipPaths=function(pe){var he=pe._fullLayout;if(!he._hasOnlyLargeSploms){var Ye={_offset:0,_length:he.width,_id:""},tt={_offset:0,_length:he.height,_id:""},lt=D.list(pe,"x",!0),We=D.list(pe,"y",!0),Ze=[],dt,it;for(dt=0;dt<lt.length;dt++)for(Ze.push({x:lt[dt],y:tt}),it=0;it<We.length;it++)dt===0&&Ze.push({x:Ye,y:We[it]}),Ze.push({x:lt[dt],y:We[it]});var At=he._clips.selectAll(".axesclip").data(Ze,function(Rt){return Rt.x._id+Rt.y._id});At.enter().append("clipPath").classed("axesclip",!0).attr("id",function(Rt){return"clip"+he._uid+Rt.x._id+Rt.y._id}).append("rect"),At.exit().remove(),At.each(function(Rt){d.select(this).select("rect").attr({x:Rt.x._offset||0,y:Rt.y._offset||0,width:Rt.x._length||1,height:Rt.y._length||1})})}},D.draw=function(pe,he,Ye){var tt=pe._fullLayout;he==="redraw"&&tt._paper.selectAll("g.subplot").each(function(it){var At=it[0],Rt=tt._plots[At];if(Rt){var Yt=Rt.xaxis,pr=Rt.yaxis;Rt.xaxislayer.selectAll("."+Yt._id+"tick").remove(),Rt.yaxislayer.selectAll("."+pr._id+"tick").remove(),Rt.xaxislayer.selectAll("."+Yt._id+"tick2").remove(),Rt.yaxislayer.selectAll("."+pr._id+"tick2").remove(),Rt.xaxislayer.selectAll("."+Yt._id+"divider").remove(),Rt.yaxislayer.selectAll("."+pr._id+"divider").remove(),Rt.minorGridlayer&&Rt.minorGridlayer.selectAll("path").remove(),Rt.gridlayer&&Rt.gridlayer.selectAll("path").remove(),Rt.zerolinelayer&&Rt.zerolinelayer.selectAll("path").remove(),Rt.zerolinelayerAbove&&Rt.zerolinelayerAbove.selectAll("path").remove(),tt._infolayer.select(".g-"+Yt._id+"title").remove(),tt._infolayer.select(".g-"+pr._id+"title").remove()}});var lt=!he||he==="redraw"?D.listIds(pe):he,We=D.list(pe),Ze=We.filter(function(it){return it.autoshift}).map(function(it){return it.overlaying});lt.map(function(it){var At=D.getFromId(pe,it);if(At.tickmode==="sync"&&At.overlaying){var Rt=lt.findIndex(function(Yt){return Yt===At.overlaying});Rt>=0&&lt.unshift(lt.splice(Rt,1).shift())}});var dt={false:{left:0,right:0}};return u.syncOrAsync(lt.map(function(it){return function(){if(it){var At=D.getFromId(pe,it);Ye||(Ye={}),Ye.axShifts=dt,Ye.overlayingShiftedAx=Ze;var Rt=D.drawOne(pe,At,Ye);return At._shiftPusher&&Tn(At,At._fullDepth||0,dt,!0),At._r=At.range.slice(),At._rl=u.simpleMap(At._r,At.r2l),Rt}}}))},D.drawOne=function(pe,he,Ye){Ye=Ye||{};var tt=Ye.axShifts||{},lt=Ye.overlayingShiftedAx||[],We,Ze,dt;he.setScale();var it=pe._fullLayout,At=he._id,Rt=At.charAt(0),Yt=D.counterLetter(At),pr=it._plots[he._mainSubplot],fr=he.zerolinelayer==="above traces";if(!pr)return;if(he._shiftPusher=he.autoshift||lt.indexOf(he._id)!==-1||lt.indexOf(he.overlaying)!==-1,he._shiftPusher&he.anchor==="free"){var Sr=he.linewidth/2||0;he.ticks==="inside"&&(Sr+=he.ticklen),Tn(he,Sr,tt,!0),Tn(he,he.shift||0,tt,!1)}(Ye.skipTitle!==!0||he._shift===void 0)&&(he._shift=Mr(he,tt));var hr=pr[Rt+"axislayer"],Cr=he._mainLinePosition,Fr=Cr+=he._shift,Un=he._mainMirrorPosition,on=he._vals=D.calcTicks(he),la=[he.mirror,Fr,Un].join("_");for(We=0;We<on.length;We++)on[We].axInfo=la;he._selections={},he._tickAngles&&(he._prevTickAngles=he._tickAngles),he._tickAngles={},he._depth=null;var bn={};function ha(wa){var Za=At+(wa||"tick");return bn[Za]||(bn[Za]=or(he,Za,Fr)),bn[Za]}if(he.visible){var sa=D.makeTransTickFn(he),Fa=D.makeTransTickLabelFn(he),ka,An,Va=he.ticks==="inside",Pa=he.ticks==="outside";if(he.tickson==="boundaries"){var In=It(he,on);An=D.clipEnds(he,In),ka=Va?An:In}else An=D.clipEnds(he,on),ka=Va&&he.ticklabelmode!=="period"?An:on;var Oa=he._gridVals=An,Ua=Ut(he,on);if(!it._hasOnlyLargeSploms){var Na=he._subplotsWith,ii={};for(We=0;We<Na.length;We++){Ze=Na[We],dt=it._plots[Ze];var Ii=dt[Yt+"axis"],ea=Ii._mainAxis._id;if(!ii[ea]){ii[ea]=1;var _a=Rt==="x"?"M0,"+Ii._offset+"v"+Ii._length:"M"+Ii._offset+",0h"+Ii._length;D.drawGrid(pe,he,{vals:Oa,counterAxis:Ii,layer:dt.gridlayer.select("."+At),minorLayer:dt.minorGridlayer.select("."+At),path:_a,transFn:sa}),D.drawZeroLine(pe,he,{counterAxis:Ii,layer:fr?dt.zerolinelayerAbove:dt.zerolinelayer,path:_a,transFn:sa})}}}var ca,ba=D.getTickSigns(he),Wa=D.getTickSigns(he,"minor");if(he.ticks||he.minor&&he.minor.ticks){var oi=D.makeTickPath(he,Fr,ba[2]),_i=D.makeTickPath(he,Fr,Wa[2],{minor:!0}),si,Li,li,ua;if(he._anchorAxis&&he.mirror&&he.mirror!==!0?(si=D.makeTickPath(he,Un,ba[3]),Li=D.makeTickPath(he,Un,Wa[3],{minor:!0}),li=oi+si,ua=_i+Li):(si="",Li="",li=oi,ua=_i),he.showdividers&&Pa&&he.tickson==="boundaries"){var ao={};for(We=0;We<Ua.length;We++)ao[Ua[We].x]=1;ca=function(wa){return ao[wa.x]?si:li}}else ca=function(wa){return wa.minor?ua:li}}if(D.drawTicks(pe,he,{vals:ka,layer:hr,path:ca,transFn:sa}),he.mirror==="allticks"){var bi=Object.keys(he._linepositions||{});for(We=0;We<bi.length;We++){Ze=bi[We],dt=it._plots[Ze];var Ui=he._linepositions[Ze]||[],Ri=Ui[0],wi=Ui[1],bo=Ui[2],$i=D.makeTickPath(he,Ri,bo?ba[0]:Wa[0],{minor:bo})+D.makeTickPath(he,wi,bo?ba[1]:Wa[1],{minor:bo});D.drawTicks(pe,he,{vals:ka,layer:dt[Rt+"axislayer"],path:$i,transFn:sa})}}var Mi=[];if(Mi.push(function(){return D.drawLabels(pe,he,{vals:on,layer:hr,plotinfo:dt,transFn:Fa,labelFns:D.makeLabelFns(he,Fr)})}),he.type==="multicategory"){var po={x:2,y:10}[Rt];Mi.push(function(){var wa={x:"height",y:"width"}[Rt],Za=ha()[wa]+po+(he._tickAngles[At+"tick"]?he.tickfont.size*Ie:0);return D.drawLabels(pe,he,{vals:zt(he,on),layer:hr,cls:At+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:sa,labelFns:D.makeLabelFns(he,Fr+Za*ba[4])})}),Mi.push(function(){return he._depth=ba[4]*(ha("tick2")[he.side]-Fr),Gr(pe,he,{vals:Ua,layer:hr,path:D.makeTickPath(he,Fr,ba[4],{len:he._depth}),transFn:sa})})}else he.title.hasOwnProperty("standoff")&&Mi.push(function(){he._depth=ba[4]*(ha()[he.side]-Fr)});var Co=f.getComponentMethod("rangeslider","isVisible")(he);return!Ye.skipTitle&&!(Co&&he.side==="bottom")&&Mi.push(function(){return lr(pe,he)}),Mi.push(function(){var wa=he.side.charAt(0),Za=Q[he.side].charAt(0),pi=D.getPxPosition(pe,he),Bi=Pa?he.ticklen:0,ci,Da,Hi,Vs;(he.automargin||Co||he._shiftPusher)&&(he.type==="multicategory"?ci=ha("tick2"):(ci=ha(),Rt==="x"&&wa==="b"&&(he._depth=Math.max(ci.width>0?ci.bottom-pi:0,Bi))));var os=0,au=0;if(he._shiftPusher&&(os=Math.max(Bi,ci.height>0?wa==="l"?pi-ci.left:ci.right-pi:0),he.title.text!==it._dfltTitle[Rt]&&(au=(he._titleStandoff||0)+(he._titleScoot||0),wa==="l"&&(au+=wr(he))),he._fullDepth=Math.max(os,au)),he.automargin){Da={x:0,y:0,r:0,l:0,t:0,b:0};var ss=[0,1],md=typeof he._shift=="number"?he._shift:0;if(Rt==="x"){if(wa==="b"?Da[wa]=he._depth:(Da[wa]=he._depth=Math.max(ci.width>0?pi-ci.top:0,Bi),ss.reverse()),ci.width>0){var gd=ci.right-(he._offset+he._length);gd>0&&(Da.xr=1,Da.r=gd);var vd=he._offset-ci.left;vd>0&&(Da.xl=0,Da.l=vd)}}else if(wa==="l"?(he._depth=Math.max(ci.height>0?pi-ci.left:0,Bi),Da[wa]=he._depth-md):(he._depth=Math.max(ci.height>0?ci.right-pi:0,Bi),Da[wa]=he._depth+md,ss.reverse()),ci.height>0){var iu=ci.bottom-(he._offset+he._length);iu>0&&(Da.yb=0,Da.b=iu);var Gs=he._offset-ci.top;Gs>0&&(Da.yt=1,Da.t=Gs)}Da[Yt]=he.anchor==="free"?he.position:he._anchorAxis.domain[ss[0]],he.title.text!==it._dfltTitle[Rt]&&(Da[wa]+=wr(he)+(he.title.standoff||0)),he.mirror&&he.anchor!=="free"&&(Hi={x:0,y:0,r:0,l:0,t:0,b:0},Hi[Za]=he.linewidth,he.mirror&&he.mirror!==!0&&(Hi[Za]+=Bi),he.mirror===!0||he.mirror==="ticks"?Hi[Yt]=he._anchorAxis.domain[ss[1]]:(he.mirror==="all"||he.mirror==="allticks")&&(Hi[Yt]=[he._counterDomainMin,he._counterDomainMax][ss[1]]))}Co&&(Vs=f.getComponentMethod("rangeslider","autoMarginOpts")(pe,he)),typeof he.automargin=="string"&&(yt(Da,he.automargin),yt(Hi,he.automargin)),s.autoMargin(pe,Er(he),Da),s.autoMargin(pe,_r(he),Hi),s.autoMargin(pe,rn(he),Vs)}),u.syncOrAsync(Mi)}};function yt(pe,he){if(pe){var Ye=Object.keys(me).reduce(function(tt,lt){return he.indexOf(lt)!==-1&&me[lt].forEach(function(We){tt[We]=1}),tt},{});Object.keys(pe).forEach(function(tt){Ye[tt]||(tt.length===1?pe[tt]=0:delete pe[tt])})}}function It(pe,he){var Ye=[],tt,lt=function(We,Ze){var dt=We.xbnd[Ze];dt!==null&&Ye.push(u.extendFlat({},We,{x:dt}))};if(he.length){for(tt=0;tt<he.length;tt++)lt(he[tt],0);lt(he[tt-1],1)}return Ye}function zt(pe,he){for(var Ye=[],tt={},lt=0;lt<he.length;lt++){var We=he[lt];tt[We.text2]?tt[We.text2].push(We.x):tt[We.text2]=[We.x]}for(var Ze in tt)Ye.push(Qt(pe,u.interp(tt[Ze],.5),Ze));return Ye}function Ut(pe,he){var Ye=[],tt,lt,We=he.length&&he[he.length-1].x<he[0].x,Ze=function(it,At){var Rt=it.xbnd[At];Rt!==null&&Ye.push(u.extendFlat({},it,{x:Rt}))};if(pe.showdividers&&he.length){for(tt=0;tt<he.length;tt++){var dt=he[tt];dt.text2!==lt&&Ze(dt,We?1:0),lt=dt.text2}Ze(he[tt-1],We?0:1)}return Ye}function or(pe,he,Ye){var tt,lt,We,Ze;if(pe._selections[he].size())tt=1/0,lt=-1/0,We=1/0,Ze=-1/0,pe._selections[he].each(function(){var it=Ar(this);if(it.node().style.display!=="none"){var At=w.bBox(it.node().parentNode);tt=Math.min(tt,At.top),lt=Math.max(lt,At.bottom),We=Math.min(We,At.left),Ze=Math.max(Ze,At.right)}});else{var dt=D.makeLabelFns(pe,Ye);tt=lt=dt.yFn({dx:0,dy:0,fontSize:0}),We=Ze=dt.xFn({dx:0,dy:0,fontSize:0})}return{top:tt,bottom:lt,left:We,right:Ze,height:lt-tt,width:Ze-We}}D.getTickSigns=function(pe,he){var Ye=pe._id.charAt(0),tt={x:"top",y:"right"}[Ye],lt=pe.side===tt?1:-1,We=[-1,1,lt,-lt],Ze=he?(pe.minor||{}).ticks:pe.ticks;return Ze!=="inside"==(Ye==="x")&&(We=We.map(function(dt){return-dt})),pe.side&&We.push({l:-1,t:-1,r:1,b:1}[pe.side.charAt(0)]),We},D.makeTransTickFn=function(pe){return pe._id.charAt(0)==="x"?function(he){return h(pe._offset+pe.l2p(he.x),0)}:function(he){return h(0,pe._offset+pe.l2p(he.x))}},D.makeTransTickLabelFn=function(pe){var he=zr(pe),Ye=pe.ticklabelshift||0,tt=pe.ticklabelstandoff||0,lt=he[0],We=he[1],Ze=pe.range[0]>pe.range[1],dt=pe.ticklabelposition&&pe.ticklabelposition.indexOf("inside")!==-1,it=!dt;if(Ye){var At=Ze?-1:1;Ye=Ye*At}if(tt){var Rt=pe.side,Yt=dt&&(Rt==="top"||Rt==="left")||it&&(Rt==="bottom"||Rt==="right")?1:-1;tt=tt*Yt}return pe._id.charAt(0)==="x"?function(pr){return h(lt+pe._offset+pe.l2p(xr(pr))+Ye,We+tt)}:function(pr){return h(We+tt,lt+pe._offset+pe.l2p(xr(pr))+Ye)}};function xr(pe){return pe.periodX!==void 0?pe.periodX:pe.x}function zr(pe){var he=pe.ticklabelposition||"",Ye=pe.tickson||"",tt=function(Sr){return he.indexOf(Sr)!==-1},lt=tt("top"),We=tt("left"),Ze=tt("right"),dt=tt("bottom"),it=tt("inside"),At=Ye!=="boundaries"&&(dt||We||lt||Ze);if(!At&&!it)return[0,0];var Rt=pe.side,Yt=At?(pe.tickwidth||0)/2:0,pr=ee,fr=pe.tickfont?pe.tickfont.size:12;return(dt||lt)&&(Yt+=fr*ke,pr+=(pe.linewidth||0)/2),(We||Ze)&&(Yt+=(pe.linewidth||0)/2,pr+=ee),it&&Rt==="top"&&(pr-=fr*(1-ke)),(We||lt)&&(Yt=-Yt),(Rt==="bottom"||Rt==="right")&&(pr=-pr),[At?Yt:0,it?pr:0]}D.makeTickPath=function(pe,he,Ye,tt){tt||(tt={});var lt=tt.minor;if(lt&&!pe.minor)return"";var We=tt.len!==void 0?tt.len:lt?pe.minor.ticklen:pe.ticklen,Ze=pe._id.charAt(0),dt=(pe.linewidth||1)/2;return Ze==="x"?"M0,"+(he+dt*Ye)+"v"+We*Ye:"M"+(he+dt*Ye)+",0h"+We*Ye},D.makeLabelFns=function(pe,he,Ye){var tt=pe.ticklabelposition||"",lt=pe.tickson||"",We=function(In){return tt.indexOf(In)!==-1},Ze=We("top"),dt=We("left"),it=We("right"),At=We("bottom"),Rt=lt!=="boundaries"&&(At||dt||Ze||it),Yt=We("inside"),pr=tt==="inside"&&pe.ticks==="inside"||!Yt&&pe.ticks==="outside"&&lt!=="boundaries",fr=0,Sr=0,hr=pr?pe.ticklen:0;if(Yt?hr*=-1:Rt&&(hr=0),pr&&(fr+=hr,Ye)){var Cr=u.deg2rad(Ye);fr=hr*Math.cos(Cr)+1,Sr=hr*Math.sin(Cr)}pe.showticklabels&&(pr||pe.showline)&&(fr+=.2*pe.tickfont.size),fr+=(pe.linewidth||1)/2*(Yt?-1:1);var Fr={labelStandoff:fr,labelShift:Sr},Un,on,la,bn,ha=0,sa=pe.side,Fa=pe._id.charAt(0),ka=pe.tickangle,An;if(Fa==="x")An=!Yt&&sa==="bottom"||Yt&&sa==="top",bn=An?1:-1,Yt&&(bn*=-1),Un=Sr*bn,on=he+fr*bn,la=An?1:-.2,Math.abs(ka)===90&&(Yt?la+=Re:ka===-90&&sa==="bottom"?la=ke:ka===90&&sa==="top"?la=Re:la=.5,ha=Re/2*(ka/90)),Fr.xFn=function(In){return In.dx+Un+ha*In.fontSize},Fr.yFn=function(In){return In.dy+on+In.fontSize*la},Fr.anchorFn=function(In,Oa){if(Rt){if(dt)return"end";if(it)return"start"}return!i(Oa)||Oa===0||Oa===180?"middle":Oa*bn<0!==Yt?"end":"start"},Fr.heightFn=function(In,Oa,Ua){return Oa<-60||Oa>60?-.5*Ua:pe.side==="top"!==Yt?-Ua:0};else if(Fa==="y"){if(An=!Yt&&sa==="left"||Yt&&sa==="right",bn=An?1:-1,Yt&&(bn*=-1),Un=fr,on=Sr*bn,la=0,!Yt&&Math.abs(ka)===90&&(ka===-90&&sa==="left"||ka===90&&sa==="right"?la=ke:la=.5),Yt){var Va=i(ka)?+ka:0;if(Va!==0){var Pa=u.deg2rad(Va);ha=Math.abs(Math.sin(Pa))*ke*bn,la=0}}Fr.xFn=function(In){return In.dx+he-(Un+In.fontSize*la)*bn+ha*In.fontSize},Fr.yFn=function(In){return In.dy+on+In.fontSize*Re},Fr.anchorFn=function(In,Oa){return i(Oa)&&Math.abs(Oa)===90?"middle":An?"end":"start"},Fr.heightFn=function(In,Oa,Ua){return pe.side==="right"&&(Oa*=-1),Oa<-30?-Ua:Oa<30?-.5*Ua:0}}return Fr};function Br(pe){return[pe.text,pe.x,pe.axInfo,pe.font,pe.fontSize,pe.fontColor].join("_")}D.drawTicks=function(pe,he,Ye){Ye=Ye||{};var tt=he._id+"tick",lt=[].concat(he.minor&&he.minor.ticks?Ye.vals.filter(function(Ze){return Ze.minor&&!Ze.noTick}):[]).concat(he.ticks?Ye.vals.filter(function(Ze){return!Ze.minor&&!Ze.noTick}):[]),We=Ye.layer.selectAll("path."+tt).data(lt,Br);We.exit().remove(),We.enter().append("path").classed(tt,1).classed("ticks",1).classed("crisp",Ye.crisp!==!1).each(function(Ze){return o.stroke(d.select(this),Ze.minor?he.minor.tickcolor:he.tickcolor)}).style("stroke-width",function(Ze){return w.crispRound(pe,Ze.minor?he.minor.tickwidth:he.tickwidth,1)+"px"}).attr("d",Ye.path).style("display",null),Fn(he,[se]),We.attr("transform",Ye.transFn)},D.drawGrid=function(pe,he,Ye){if(Ye=Ye||{},he.tickmode!=="sync"){var tt=he._id+"grid",lt=he.minor&&he.minor.showgrid,We=lt?Ye.vals.filter(function(Fr){return Fr.minor}):[],Ze=he.showgrid?Ye.vals.filter(function(Fr){return!Fr.minor}):[],dt=Ye.counterAxis;if(dt&&D.shouldShowZeroLine(pe,he,dt))for(var it=he.tickmode==="array",At=0;At<Ze.length;At++){var Rt=Ze[At].x;if(it?!Rt:Math.abs(Rt)<he.dtick/100)if(Ze=Ze.slice(0,At).concat(Ze.slice(At+1)),it)At--;else break}he._gw=w.crispRound(pe,he.gridwidth,1);for(var Yt=lt?w.crispRound(pe,he.minor.gridwidth,1):0,pr=Ye.layer,fr=Ye.minorLayer,Sr=1;Sr>=0;Sr--){var hr=Sr?pr:fr;if(hr){var Cr=hr.selectAll("path."+tt).data(Sr?Ze:We,Br);Cr.exit().remove(),Cr.enter().append("path").classed(tt,1).classed("crisp",Ye.crisp!==!1),Cr.attr("transform",Ye.transFn).attr("d",Ye.path).each(function(Fr){return o.stroke(d.select(this),Fr.minor?he.minor.gridcolor:he.gridcolor||"#ddd")}).style("stroke-dasharray",function(Fr){return w.dashStyle(Fr.minor?he.minor.griddash:he.griddash,Fr.minor?he.minor.gridwidth:he.gridwidth)}).style("stroke-width",function(Fr){return(Fr.minor?Yt:he._gw)+"px"}).style("display",null),typeof Ye.path=="function"&&Cr.attr("d",Ye.path)}}Fn(he,[B,ie])}},D.drawZeroLine=function(pe,he,Ye){Ye=Ye||Ye;var tt=he._id+"zl",lt=D.shouldShowZeroLine(pe,he,Ye.counterAxis),We=Ye.layer.selectAll("path."+tt).data(lt?[{x:0,id:he._id}]:[]);We.exit().remove(),We.enter().append("path").classed(tt,1).classed("zl",1).classed("crisp",Ye.crisp!==!1).each(function(){Ye.layer.selectAll("path").sort(function(Ze,dt){return j(Ze.id,dt.id)})}),We.attr("transform",Ye.transFn).attr("d",Ye.path).call(o.stroke,he.zerolinecolor||o.defaultLine).style("stroke-width",w.crispRound(pe,he.zerolinewidth,he._gw||1)+"px").style("display",null),Fn(he,[ae])},D.drawLabels=function(pe,he,Ye){Ye=Ye||{};var tt=pe._fullLayout,lt=he._id,We=he.zerolinelayer==="above traces",Ze=Ye.cls||lt+"tick",dt=Ye.vals.filter(function(ea){return ea.text}),it=Ye.labelFns,At=Ye.secondary?0:he.tickangle,Rt=(he._prevTickAngles||{})[Ze],Yt=Ye.layer.selectAll("g."+Ze).data(he.showticklabels?dt:[],Br),pr=[];Yt.enter().append("g").classed(Ze,1).append("text").attr("text-anchor","middle").each(function(ea){var _a=d.select(this),ca=pe._promises.length;_a.call(p.positionText,it.xFn(ea),it.yFn(ea)).call(w.font,{family:ea.font,size:ea.fontSize,color:ea.fontColor,weight:ea.fontWeight,style:ea.fontStyle,variant:ea.fontVariant,textcase:ea.fontTextcase,lineposition:ea.fontLineposition,shadow:ea.fontShadow}).text(ea.text).call(p.convertToTspans,pe),pe._promises[ca]?pr.push(pe._promises.pop().then(function(){fr(_a,At)})):fr(_a,At)}),Fn(he,[ye]),Yt.exit().remove(),Ye.repositionOnUpdate&&Yt.each(function(ea){d.select(this).select("text").call(p.positionText,it.xFn(ea),it.yFn(ea))});function fr(ea,_a){ea.each(function(ca){var ba=d.select(this),Wa=ba.select(".text-math-group"),oi=it.anchorFn(ca,_a),_i=Ye.transFn.call(ba.node(),ca)+(i(_a)&&+_a!=0?" rotate("+_a+","+it.xFn(ca)+","+(it.yFn(ca)-ca.fontSize/2)+")":""),si=p.lineCount(ba),Li=Ie*ca.fontSize,li=it.heightFn(ca,i(_a)?+_a:0,(si-1)*Li);if(li&&(_i+=h(0,li)),Wa.empty()){var ua=ba.select("text");ua.attr({transform:_i,"text-anchor":oi}),ua.style("display",null),he._adjustTickLabelsOverflow&&he._adjustTickLabelsOverflow()}else{var ao=w.bBox(Wa.node()).width,bi=ao*{end:-.5,start:.5}[oi];Wa.attr("transform",_i+h(bi,0))}})}he._adjustTickLabelsOverflow=function(){var ea=he.ticklabeloverflow;if(!(!ea||ea==="allow")){var _a=ea.indexOf("hide")!==-1,ca=he._id.charAt(0)==="x",ba=0,Wa=ca?pe._fullLayout.width:pe._fullLayout.height;if(ea.indexOf("domain")!==-1){var oi=u.simpleMap(he.range,he.r2l);ba=he.l2p(oi[0])+he._offset,Wa=he.l2p(oi[1])+he._offset}var _i=Math.min(ba,Wa),si=Math.max(ba,Wa),Li=he.side,li=1/0,ua=-1/0;Yt.each(function(Ri){var wi=d.select(this),bo=wi.select(".text-math-group");if(bo.empty()){var $i=w.bBox(wi.node()),Mi=0;ca?($i.right>si||$i.left<_i)&&(Mi=1):($i.bottom>si||$i.top+(he.tickangle?0:Ri.fontSize/4)<_i)&&(Mi=1);var po=wi.select("text");Mi?_a&&po.style("display","none"):po.node().style.display!=="none"&&(po.style("display",null),Li==="bottom"||Li==="right"?li=Math.min(li,ca?$i.top:$i.left):li=-1/0,Li==="top"||Li==="left"?ua=Math.max(ua,ca?$i.bottom:$i.right):ua=1/0)}});for(var ao in tt._plots){var bi=tt._plots[ao];if(!(he._id!==bi.xaxis._id&&he._id!==bi.yaxis._id)){var Ui=ca?bi.yaxis:bi.xaxis;Ui&&(Ui["_visibleLabelMin_"+he._id]=li,Ui["_visibleLabelMax_"+he._id]=ua)}}}},he._hideCounterAxisInsideTickLabels=function(ea){var _a=he._id.charAt(0)==="x",ca=[];for(var ba in tt._plots){var Wa=tt._plots[ba];he._id!==Wa.xaxis._id&&he._id!==Wa.yaxis._id||ca.push(_a?Wa.yaxis:Wa.xaxis)}ca.forEach(function(oi,_i){oi&&sn(oi)&&(ea||[ae,ie,B,se,ye]).forEach(function(si){var Li=si.K==="tick"&&si.L==="text"&&he.ticklabelmode==="period",li=tt._plots[he._mainSubplot],ua;if(si.K===ae.K){var ao=We?li.zerolinelayerAbove:li.zerolinelayer;ua=ao.selectAll("."+he._id+"zl")}else si.K===ie.K?ua=li.minorGridlayer.selectAll("."+he._id):si.K===B.K?ua=li.gridlayer.selectAll("."+he._id):ua=li[he._id.charAt(0)+"axislayer"];ua.each(function(){var bi=d.select(this);si.L&&(bi=bi.selectAll(si.L)),bi.each(function(Ui){var Ri=he.l2p(Li?xr(Ui):Ui.x)+he._offset,wi=d.select(this);Ri<he["_visibleLabelMax_"+oi._id]&&Ri>he["_visibleLabelMin_"+oi._id]?wi.style("display","none"):si.K==="tick"&&!_i&&wi.node().style.display!=="none"&&wi.style("display",null)})})})})},fr(Yt,Rt+1?Rt:At);function Sr(){return pr.length&&Promise.all(pr)}var hr=null;function Cr(){if(fr(Yt,At),dt.length&&he.autotickangles&&(he.type!=="log"||String(he.dtick).charAt(0)!=="D")){hr=he.autotickangles[0];var ea=0,_a=[],ca,ba=1;Yt.each(function(Da){ea=Math.max(ea,Da.fontSize);var Hi=he.l2p(Da.x),Vs=Ar(this),os=w.bBox(Vs.node());ba=Math.max(ba,p.lineCount(Vs)),_a.push({top:0,bottom:10,height:10,left:Hi-os.width/2,right:Hi+os.width/2+2,width:os.width+2})});var Wa=(he.tickson==="boundaries"||he.showdividers)&&!Ye.secondary,oi=dt.length,_i=Math.abs((dt[oi-1].x-dt[0].x)*he._m)/(oi-1),si=Wa?_i/2:_i,Li=Wa?he.ticklen:ea*1.25*ba,li=Math.sqrt(Math.pow(si,2)+Math.pow(Li,2)),ua=si/li,ao=he.autotickangles.map(function(Da){return Da*Math.PI/180}),bi=ao.find(function(Da){return Math.abs(Math.cos(Da))<=ua});bi===void 0&&(bi=ao.reduce(function(Da,Hi){return Math.abs(Math.cos(Da))<Math.abs(Math.cos(Hi))?Da:Hi},ao[0]));var Ui=bi*(180/Math.PI);if(Wa){var Ri=2;for(he.ticks&&(Ri+=he.tickwidth/2),ca=0;ca<_a.length;ca++){var wi=dt[ca].xbnd,bo=_a[ca];if(wi[0]!==null&&bo.left-he.l2p(wi[0])<Ri||wi[1]!==null&&he.l2p(wi[1])-bo.right<Ri){hr=Ui;break}}}else{var $i=he.ticklabelposition||"",Mi=he.tickson||"",po=function(Da){return $i.indexOf(Da)!==-1},Co=po("top"),wa=po("left"),Za=po("right"),pi=po("bottom"),Bi=Mi!=="boundaries"&&(pi||wa||Co||Za),ci=Bi?(he.tickwidth||0)+2*ee:0;for(ca=0;ca<_a.length-1;ca++)if(u.bBoxIntersect(_a[ca],_a[ca+1],ci)){hr=Ui;break}}hr&&fr(Yt,hr)}}he._selections&&(he._selections[Ze]=Yt);var Fr=[Sr];he.automargin&&tt._redrawFromAutoMarginCount&&Rt===90?(hr=Rt,Fr.push(function(){fr(Yt,Rt)})):Fr.push(Cr),he._tickAngles&&Fr.push(function(){he._tickAngles[Ze]=hr===null?i(At)?At:0:hr});var Un=function(){var ea=0,_a=0;return Yt.each(function(ca,ba){var Wa=Ar(this),oi=Wa.select(".text-math-group");if(oi.empty()){var _i;he._vals[ba]&&(_i=he._vals[ba].bb||w.bBox(Wa.node()),he._vals[ba].bb=_i),ea=Math.max(ea,_i.width),_a=Math.max(_a,_i.height)}}),{labelsMaxW:ea,labelsMaxH:_a}},on=he._anchorAxis;if(on&&(on.autorange||on.insiderange)&&sn(he)&&!k(tt,he._id)&&(tt._insideTickLabelsUpdaterange||(tt._insideTickLabelsUpdaterange={}),on.autorange&&(tt._insideTickLabelsUpdaterange[on._name+".autorange"]=on.autorange,Fr.push(Un)),on.insiderange)){var la=Un(),bn=he._id.charAt(0)==="y"?la.labelsMaxW:la.labelsMaxH;bn+=2*ee,he.ticklabelposition==="inside"&&(bn+=he.ticklen||0);var ha=he.side==="right"||he.side==="top"?1:-1,sa=ha===1?1:0,Fa=ha===1?0:1,ka=[];ka[Fa]=on.range[Fa];var An=on.range,Va=on.r2p(An[sa]),Pa=on.r2p(An[Fa]),In=tt._insideTickLabelsUpdaterange[on._name+".range"];if(In){var Oa=on.r2p(In[sa]),Ua=on.r2p(In[Fa]),Na=ha*(he._id.charAt(0)==="y"?1:-1);Na*Va<Na*Oa&&(Va=Oa,ka[sa]=An[sa]=In[sa]),Na*Pa>Na*Ua&&(Pa=Ua,ka[Fa]=An[Fa]=In[Fa])}var ii=Math.abs(Pa-Va);ii-bn>0?(ii-=bn,bn*=1+bn/ii):bn=0,he._id.charAt(0)!=="y"&&(bn=-bn),ka[sa]=on.p2r(on.r2p(An[sa])+ha*bn),on.autorange==="min"||on.autorange==="max reversed"?(ka[0]=null,on._rangeInitial0=void 0,on._rangeInitial1=void 0):(on.autorange==="max"||on.autorange==="min reversed")&&(ka[1]=null,on._rangeInitial0=void 0,on._rangeInitial1=void 0),tt._insideTickLabelsUpdaterange[on._name+".range"]=ka}var Ii=u.syncOrAsync(Fr);return Ii&&Ii.then&&pe._promises.push(Ii),Ii};function Gr(pe,he,Ye){var tt=he._id+"divider",lt=Ye.vals,We=Ye.layer.selectAll("path."+tt).data(lt,Br);We.exit().remove(),We.enter().insert("path",":first-child").classed(tt,1).classed("crisp",1).call(o.stroke,he.dividercolor).style("stroke-width",w.crispRound(pe,he.dividerwidth,1)+"px"),We.attr("transform",Ye.transFn).attr("d",Ye.path)}D.getPxPosition=function(pe,he){var Ye=pe._fullLayout._size,tt=he._id.charAt(0),lt=he.side,We;if(he.anchor!=="free"?We=he._anchorAxis:tt==="x"?We={_offset:Ye.t+(1-(he.position||0))*Ye.h,_length:0}:tt==="y"&&(We={_offset:Ye.l+(he.position||0)*Ye.w+he._shift,_length:0}),lt==="top"||lt==="left")return We._offset;if(lt==="bottom"||lt==="right")return We._offset+We._length};function wr(pe){var he=pe.title.font.size,Ye=(pe.title.text.match(p.BR_TAG_ALL)||[]).length;return pe.title.hasOwnProperty("standoff")?he*(ke+Ye*Ie):Ye?he*(Ye+1)*Ie:he}function lr(pe,he){var Ye=pe._fullLayout,tt=he._id,lt=tt.charAt(0),We=he.title.font.size,Ze,dt=(he.title.text.match(p.BR_TAG_ALL)||[]).length;if(he.title.hasOwnProperty("standoff"))he.side==="bottom"||he.side==="right"?Ze=he._depth+he.title.standoff+We*ke:(he.side==="top"||he.side==="left")&&(Ze=he._depth+he.title.standoff+We*(Re+dt*Ie));else{var it=sn(he);if(he.type==="multicategory")Ze=he._depth;else{var At=1.5*We;it&&(At=.5*We,he.ticks==="outside"&&(At+=he.ticklen)),Ze=10+At+(he.linewidth?he.linewidth-1:0)}it||(lt==="x"?Ze+=he.side==="top"?We*(he.showticklabels?1:0):We*(he.showticklabels?1.5:.5):Ze+=he.side==="right"?We*(he.showticklabels?1:.5):We*(he.showticklabels?.5:0))}var Rt=D.getPxPosition(pe,he),Yt,pr,fr;lt==="x"?(pr=he._offset+he._length/2,fr=he.side==="top"?Rt-Ze:Rt+Ze):(fr=he._offset+he._length/2,pr=he.side==="right"?Rt+Ze:Rt-Ze,Yt={rotate:"-90",offset:0});var Sr;if(he.type!=="multicategory"){var hr=he._selections[he._id+"tick"];if(Sr={selection:hr,side:he.side},hr&&hr.node()&&hr.node().parentNode){var Cr=w.getTranslate(hr.node().parentNode);Sr.offsetLeft=Cr.x,Sr.offsetTop=Cr.y}he.title.hasOwnProperty("standoff")&&(Sr.pad=0)}return he._titleStandoff=Ze,v.draw(pe,tt+"title",{propContainer:he,propName:he._name+".title.text",placeholder:Ye._dfltTitle[lt],avoid:Sr,transform:Yt,attributes:{x:pr,y:fr,"text-anchor":"middle"}})}D.shouldShowZeroLine=function(pe,he,Ye){var tt=u.simpleMap(he.range,he.r2l);return tt[0]*tt[1]<=0&&he.zeroline&&(he.type==="linear"||he.type==="-")&&!(he.rangebreaks&&he.maskBreaks(0)===ne)&&(Dr(he,0)||!Hr(pe,he,Ye,tt)||Rr(pe,he))},D.clipEnds=function(pe,he){return he.filter(function(Ye){return Dr(pe,Ye.x)})};function Dr(pe,he){var Ye=pe.l2p(he);return Ye>1&&Ye<pe._length-1}function Hr(pe,he,Ye,tt){var lt=Ye._mainAxis;if(!lt)return;var We=pe._fullLayout,Ze=he._id.charAt(0),dt=D.counterLetter(he._id),it=he._offset+(Math.abs(tt[0])<Math.abs(tt[1])==(Ze==="x")?0:he._length);function At(Sr){if(!Sr.showline||!Sr.linewidth)return!1;var hr=Math.max((Sr.linewidth+he.zerolinewidth)/2,1);function Cr(on){return typeof on=="number"&&Math.abs(on-it)<hr}if(Cr(Sr._mainLinePosition)||Cr(Sr._mainMirrorPosition))return!0;var Fr=Sr._linepositions||{};for(var Un in Fr)if(Cr(Fr[Un][0])||Cr(Fr[Un][1]))return!0}var Rt=We._plots[Ye._mainSubplot];if(!(Rt.mainplotinfo||Rt).overlays.length)return At(Ye);for(var Yt=D.list(pe,dt),pr=0;pr<Yt.length;pr++){var fr=Yt[pr];if(fr._mainAxis===lt&&At(fr))return!0}}function Rr(pe,he){for(var Ye=pe._fullData,tt=he._mainSubplot,lt=he._id.charAt(0),We=0;We<Ye.length;We++){var Ze=Ye[We];if(Ze.visible===!0&&Ze.xaxis+Ze.yaxis===tt&&(f.traceIs(Ze,"bar-like")&&Ze.orientation==={x:"h",y:"v"}[lt]||Ze.fill&&Ze.fill.charAt(Ze.fill.length-1)===lt))return!0}return!1}function Ar(pe){var he=d.select(pe),Ye=he.select(".text-math-group");return Ye.empty()?he.select("text"):Ye}D.allowAutoMargin=function(pe){for(var he=D.list(pe,"",!0),Ye=0;Ye<he.length;Ye++){var tt=he[Ye];tt.automargin&&(s.allowAutoMargin(pe,Er(tt)),tt.mirror&&s.allowAutoMargin(pe,_r(tt))),f.getComponentMethod("rangeslider","isVisible")(tt)&&s.allowAutoMargin(pe,rn(tt))}};function Er(pe){return pe._id+".automargin"}function _r(pe){return Er(pe)+".mirror"}function rn(pe){return pe._id+".rangeslider"}D.swap=function(pe,he){for(var Ye=gn(pe,he),tt=0;tt<Ye.length;tt++)vn(pe,Ye[tt].x,Ye[tt].y)};function gn(pe,he){var Ye=[],tt,lt;for(tt=0;tt<he.length;tt++){var We=[],Ze=pe._fullData[he[tt]].xaxis,dt=pe._fullData[he[tt]].yaxis;if(!(!Ze||!dt)){for(lt=0;lt<Ye.length;lt++)(Ye[lt].x.indexOf(Ze)!==-1||Ye[lt].y.indexOf(dt)!==-1)&&We.push(lt);if(!We.length){Ye.push({x:[Ze],y:[dt]});continue}var it=Ye[We[0]],At;if(We.length>1)for(lt=1;lt<We.length;lt++)At=Ye[We[lt]],Ur(it.x,At.x),Ur(it.y,At.y);Ur(it.x,[Ze]),Ur(it.y,[dt])}}return Ye}function Ur(pe,he){for(var Ye=0;Ye<he.length;Ye++)pe.indexOf(he[Ye])===-1&&pe.push(he[Ye])}function vn(pe,he,Ye){var tt=[],lt=[],We=pe.layout,Ze,dt;for(Ze=0;Ze<he.length;Ze++)tt.push(D.getFromId(pe,he[Ze]));for(Ze=0;Ze<Ye.length;Ze++)lt.push(D.getFromId(pe,Ye[Ze]));var it=Object.keys(g),At=["anchor","domain","overlaying","position","side","tickangle","editType"],Rt=["linear","log"];for(Ze=0;Ze<it.length;Ze++){var Yt=it[Ze],pr=tt[0][Yt],fr=lt[0][Yt],Sr=!0,hr=!1,Cr=!1;if(!(Yt.charAt(0)==="_"||typeof pr=="function"||At.indexOf(Yt)!==-1)){for(dt=1;dt<tt.length&&Sr;dt++){var Fr=tt[dt][Yt];Yt==="type"&&Rt.indexOf(pr)!==-1&&Rt.indexOf(Fr)!==-1&&pr!==Fr?hr=!0:Fr!==pr&&(Sr=!1)}for(dt=1;dt<lt.length&&Sr;dt++){var Un=lt[dt][Yt];Yt==="type"&&Rt.indexOf(fr)!==-1&&Rt.indexOf(Un)!==-1&&fr!==Un?Cr=!0:lt[dt][Yt]!==fr&&(Sr=!1)}Sr&&(hr&&(We[tt[0]._name].type="linear"),Cr&&(We[lt[0]._name].type="linear"),Cn(We,Yt,tt,lt,pe._fullLayout._dfltTitle))}}for(Ze=0;Ze<pe._fullLayout.annotations.length;Ze++){var on=pe._fullLayout.annotations[Ze];he.indexOf(on.xref)!==-1&&Ye.indexOf(on.yref)!==-1&&u.swapAttrs(We.annotations[Ze],["?"])}}function Cn(pe,he,Ye,tt,lt){var We=u.nestedProperty,Ze=We(pe[Ye[0]._name],he).get(),dt=We(pe[tt[0]._name],he).get(),it;for(he==="title"&&(Ze&&Ze.text===lt.x&&(Ze.text=lt.y),dt&&dt.text===lt.y&&(dt.text=lt.x)),it=0;it<Ye.length;it++)We(pe,Ye[it]._name+"."+he).set(dt);for(it=0;it<tt.length;it++)We(pe,tt[it]._name+"."+he).set(Ze)}function Vn(pe){return pe._id==="angularaxis"}function Gn(pe,he){for(var Ye=he._rangebreaks.length,tt=0;tt<Ye;tt++){var lt=he._rangebreaks[tt];if(pe>=lt.min&&pe<lt.max)return lt.max}return pe}function sn(pe){return(pe.ticklabelposition||"").indexOf("inside")!==-1}function Fn(pe,he){sn(pe._anchorAxis||{})&&pe._hideCounterAxisInsideTickLabels&&pe._hideCounterAxisInsideTickLabels(he)}function Tn(pe,he,Ye,tt){var lt=pe.anchor!=="free"&&(pe.overlaying===void 0||pe.overlaying===!1)?pe._id:pe.overlaying,We;tt?We=pe.side==="right"?he:-he:We=he,lt in Ye||(Ye[lt]={}),pe.side in Ye[lt]||(Ye[lt][pe.side]=0),Ye[lt][pe.side]+=We}function Mr(pe,he){return pe.autoshift?he[pe.overlaying][pe.side]:pe.shift||0}function oa(pe,he){return/%f/.test(he)?pe>=Y:/%L/.test(he)?pe>=Z:/%[SX]/.test(he)?pe>=G:/%M/.test(he)?pe>=re:/%[HI]/.test(he)?pe>=P:/%p/.test(he)?pe>=U:/%[Aadejuwx]/.test(he)?pe>=H:/%[UVW]/.test(he)?pe>=te:/%[Bbm]/.test(he)?pe>=N:/%[q]/.test(he)?pe>=y:/%[Yy]/.test(he)?pe>=T:!0}}),rd=t((W,V)=>{V.exports=function(d,i,s){var f,u;if(s){var h=i==="reversed"||i==="min reversed"||i==="max reversed";f=s[h?1:0],u=s[h?0:1]}var p=d("autorangeoptions.minallowed",u===null?f:void 0),v=d("autorangeoptions.maxallowed",f===null?u:void 0);p===void 0&&d("autorangeoptions.clipmin"),v===void 0&&d("autorangeoptions.clipmax"),d("autorangeoptions.include")}}),nd=t((W,V)=>{var d=rd();V.exports=function(i,s,f,u){var h=s._template||{},p=s.type||h.type||"-";f("minallowed"),f("maxallowed");var v=f("range");if(!v){var o;!u.noInsiderange&&p!=="log"&&(o=f("insiderange"),o&&(o[0]===null||o[1]===null)&&(s.insiderange=!1,o=void 0),o&&(v=f("range",o)))}var w=s.getAutorangeDflt(v,u),g=f("autorange",w),b;v&&(v[0]===null&&v[1]===null||(v[0]===null||v[1]===null)&&(g==="reversed"||g===!0)||v[0]!==null&&(g==="min"||g==="max reversed")||v[1]!==null&&(g==="max"||g==="min reversed"))&&(v=void 0,delete s.range,s.autorange=!0,b=!0),b||(w=s.getAutorangeDflt(v,u),g=f("autorange",w)),g&&(d(f,g,v),(p==="linear"||p==="-")&&f("rangemode")),s.cleanRange()}}),ad=t((W,V)=>{var d={left:0,top:0};V.exports=i;function i(f,u,h){u=u||f.currentTarget||f.srcElement,Array.isArray(h)||(h=[0,0]);var p=f.clientX||0,v=f.clientY||0,o=s(u);return h[0]=p-o.left,h[1]=v-o.top,h}function s(f){return f===window||f===document||f===document.body?d:f.getBoundingClientRect()}}),id=t((W,V)=>{var d=vr();function i(){var s=!1;try{var f=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("test",null,f),window.removeEventListener("test",null,f)}catch{s=!1}return s}V.exports=d&&i()}),ef=t((W,V)=>{V.exports=function(d,i,s,f,u){var h=(d-s)/(f-s),p=h+i/(f-s),v=(h+p)/2;return u==="left"||u==="bottom"?h:u==="center"||u==="middle"?v:u==="right"||u==="top"?p:h<2/3-v?h:p>4/3-v?p:v}}),od=t((W,V)=>{var d=Mt(),i=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];V.exports=function(s,f,u,h){return u==="left"?s=0:u==="center"?s=1:u==="right"?s=2:s=d.constrain(Math.floor(s*3),0,2),h==="bottom"?f=0:h==="middle"?f=1:h==="top"?f=2:f=d.constrain(Math.floor(f*3),0,2),i[f][s]}}),tf=t((W,V)=>{var d=xn(),i=Ao(),s=Mn().getGraphDiv,f=Ht(),u=V.exports={};u.wrapped=function(h,p,v){h=s(h),h._fullLayout&&i.clear(h._fullLayout._uid+f.HOVERID),u.raw(h,p,v)},u.raw=function(h,p){var v=h._fullLayout,o=h._hoverdata;p||(p={}),!(p.target&&!h._dragged&&d.triggerHandler(h,"plotly_beforehover",p)===!1)&&(v._hoverlayer.selectAll("g").remove(),v._hoverlayer.selectAll("line").remove(),v._hoverlayer.selectAll("circle").remove(),h._hoverdata=void 0,p.target&&o&&h.emit("plotly_unhover",{event:p,points:o}))}}),Ot=t((W,V)=>{var d=ad(),i=ir(),s=id(),f=Mt().removeElement,u=kn(),h=V.exports={};h.align=ef(),h.getCursor=od();var p=tf();h.unhover=p.wrapped,h.unhoverRaw=p.raw,h.init=function(w){var g=w.gd,b=1,L=g._context.doubleClickDelay,S=w.element,M,T,C,m,y,A,R,N;g._mouseDownTime||(g._mouseDownTime=0),S.style.pointerEvents="all",S.onmousedown=U,s?(S._ontouchstart&&S.removeEventListener("touchstart",S._ontouchstart),S._ontouchstart=U,S.addEventListener("touchstart",U,{passive:!1})):S.ontouchstart=U;function te(G,Z,Y){return Math.abs(G)<Y&&(G=0),Math.abs(Z)<Y&&(Z=0),[G,Z]}var H=w.clampFn||te;function U(G){g._dragged=!1,g._dragging=!0;var Z=o(G);M=Z[0],T=Z[1],R=G.target,A=G,N=G.buttons===2||G.ctrlKey,typeof G.clientX>"u"&&typeof G.clientY>"u"&&(G.clientX=M,G.clientY=T),C=new Date().getTime(),C-g._mouseDownTime<L?b+=1:(b=1,g._mouseDownTime=C),w.prepFn&&w.prepFn(G,M,T),i&&!N?(y=v(),y.style.cursor=window.getComputedStyle(S).cursor):i||(y=document,m=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(S).cursor),document.addEventListener("mouseup",re),document.addEventListener("touchend",re),w.dragmode!==!1&&(G.preventDefault(),document.addEventListener("mousemove",P),document.addEventListener("touchmove",P,{passive:!1}))}function P(G){G.preventDefault();var Z=o(G),Y=w.minDrag||u.MINDRAG,X=H(Z[0]-M,Z[1]-T,Y),ne=X[0],ae=X[1];(ne||ae)&&(g._dragged=!0,h.unhover(g,G)),g._dragged&&w.moveFn&&!N&&(g._dragdata={element:S,dx:ne,dy:ae},w.moveFn(ne,ae))}function re(G){if(delete g._dragdata,w.dragmode!==!1&&(G.preventDefault(),document.removeEventListener("mousemove",P),document.removeEventListener("touchmove",P)),document.removeEventListener("mouseup",re),document.removeEventListener("touchend",re),i?f(y):m&&(y.documentElement.style.cursor=m,m=null),!g._dragging){g._dragged=!1;return}if(g._dragging=!1,new Date().getTime()-g._mouseDownTime>L&&(b=Math.max(b-1,1)),g._dragged)w.doneFn&&w.doneFn();else{var Z;A.target===R?Z=A:(Z={target:R,srcElement:R,toElement:R},Object.keys(A).concat(Object.keys(A.__proto__)).forEach(Y=>{var X=A[Y];!Z[Y]&&typeof X!="function"&&(Z[Y]=X)})),w.clickFn&&w.clickFn(b,Z),N||R.dispatchEvent(new MouseEvent("click",G))}g._dragging=!1,g._dragged=!1}};function v(){var w=document.createElement("div");w.className="dragcover";var g=w.style;return g.position="fixed",g.left=0,g.right=0,g.top=0,g.bottom=0,g.zIndex=999999999,g.background="none",document.body.appendChild(w),w}h.coverSlip=v;function o(w){return d(w.changedTouches?w.changedTouches[0]:w,document.body)}}),ar=t((W,V)=>{V.exports=function(d,i){(d.attr("class")||"").split(" ").forEach(function(s){s.indexOf("cursor-")===0&&d.classed(s,!1)}),i&&d.classed("cursor-"+i,!0)}}),br=t((W,V)=>{var d=ar(),i="data-savedcursor",s="!!";V.exports=function(f,u){var h=f.attr(i);if(u){if(!h){for(var p=(f.attr("class")||"").split(" "),v=0;v<p.length;v++){var o=p[v];o.indexOf("cursor-")===0&&f.attr(i,o.substr(7)).classed(o,!1)}f.attr(i)||f.attr(i,s)}d(f,u)}else h&&(f.attr(i,null),h===s?d(f):d(f,h))}}),On=t((W,V)=>{var d=pt(),i=Zt();V.exports={_isSubplotObj:!0,visible:{valType:"boolean",dflt:!0,editType:"legend"},bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:i.defaultLine,editType:"legend"},maxheight:{valType:"number",min:0,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:d({editType:"legend"}),grouptitlefont:d({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},entrywidth:{valType:"number",min:0,editType:"legend"},entrywidthmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels",editType:"legend"},indentation:{valType:"number",min:-15,dflt:0,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",editType:"legend"},xref:{valType:"enumerated",dflt:"paper",values:["container","paper"],editType:"layoutstyle"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",editType:"legend"},yref:{valType:"enumerated",dflt:"paper",values:["container","paper"],editType:"layoutstyle"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:d({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left","top center","top right"],editType:"legend"},editType:"legend"},editType:"legend"}}),Ta=t(W=>{W.isGrouped=function(V){return(V.traceorder||"").indexOf("grouped")!==-1},W.isVertical=function(V){return V.orientation!=="h"},W.isReversed=function(V){return(V.traceorder||"").indexOf("reversed")!==-1}}),Xa=t((W,V)=>{var d=an(),i=Mt(),s=fn(),f=nt(),u=On(),h=Sa(),p=Ta();function v(o,w,g,b){var L=w[o]||{},S=s.newContainer(g,o);function M(Ie,Q){return i.coerce(L,S,u,Ie,Q)}var T=i.coerceFont(M,"font",g.font);M("bgcolor",g.paper_bgcolor),M("bordercolor");var C=M("visible");if(C){for(var m,y=function(Ie,Q){var ee=m._input,D=m;return i.coerce(ee,D,f,Ie,Q)},A=g.font||{},R=i.coerceFont(M,"grouptitlefont",A,{overrideDflt:{size:Math.round(A.size*1.1)}}),N=0,te=!1,H="normal",U=(g.shapes||[]).filter(function(Ie){return Ie.showlegend}),P=b.concat(U).filter(function(Ie){return o===(Ie.legend||"legend")}),re=0;re<P.length;re++)if(m=P[re],!!m.visible){var G=m._isShape;(m.showlegend||m._dfltShowLegend&&!(m._module&&m._module.attributes&&m._module.attributes.showlegend&&m._module.attributes.showlegend.dflt===!1))&&(N++,m.showlegend&&(te=!0,(!G&&d.traceIs(m,"pie-like")||m._input.showlegend===!0)&&N++),i.coerceFont(y,"legendgrouptitle.font",R)),(!G&&d.traceIs(m,"bar")&&g.barmode==="stack"||["tonextx","tonexty"].indexOf(m.fill)!==-1)&&(H=p.isGrouped({traceorder:H})?"grouped+reversed":"reversed"),m.legendgroup!==void 0&&m.legendgroup!==""&&(H=p.isReversed({traceorder:H})?"reversed+grouped":"grouped")}var Z=i.coerce(w,g,h,"showlegend",te&&N>(o==="legend"?1:0));if(Z===!1&&(g[o]=void 0),!(Z===!1&&!L.uirevision)&&(M("uirevision",g.uirevision),Z!==!1)){M("borderwidth");var Y=M("orientation"),X=M("yref"),ne=M("xref"),ae=Y==="h",B=X==="paper",ie=ne==="paper",se,ye,me,xe="left";ae?(se=0,d.getComponentMethod("rangeslider","isVisible")(w.xaxis)?B?(ye=1.1,me="bottom"):(ye=1,me="top"):B?(ye=-.1,me="top"):(ye=0,me="bottom")):(ye=1,me="auto",ie?se=1.02:(se=1,xe="right")),i.coerce(L,S,{x:{valType:"number",editType:"legend",min:ie?-2:0,max:ie?3:1,dflt:se}},"x"),i.coerce(L,S,{y:{valType:"number",editType:"legend",min:B?-2:0,max:B?3:1,dflt:ye}},"y"),M("traceorder",H),p.isGrouped(g[o])&&M("tracegroupgap"),M("entrywidth"),M("entrywidthmode"),M("indentation"),M("itemsizing"),M("itemwidth"),M("itemclick"),M("itemdoubleclick"),M("groupclick"),M("xanchor",xe),M("yanchor",me),M("maxheight"),M("valign"),i.noneOrAll(L,S,["x","y"]);var Re=M("title.text");if(Re){M("title.side",ae?"left":"top");var ke=i.extendFlat({},T,{size:i.bigFont(T.size)});i.coerceFont(M,"title.font",ke)}}}}V.exports=function(o,w,g){var b,L=g.slice(),S=w.shapes;if(S)for(b=0;b<S.length;b++){var M=S[b];if(M.showlegend){var T={_input:M._input,visible:M.visible,showlegend:M.showlegend,legend:M.legend};L.push(T)}}var C=["legend"];for(b=0;b<L.length;b++)i.pushUnique(C,L[b].legend);for(w._legends=[],b=0;b<C.length;b++){var m=C[b];v(m,o,w,L),w[m]&&(w[m]._id=m),w._legends.push(m)}}}),ni=t((W,V)=>{var d=an(),i=Mt(),s=i.pushUnique,f=!0;V.exports=function(u,h,p){var v=h._fullLayout;if(h._dragged||h._editing)return;var o=v.legend.itemclick,w=v.legend.itemdoubleclick,g=v.legend.groupclick;p===1&&o==="toggle"&&w==="toggleothers"&&f&&h.data&&h._context.showTips&&i.notifier(i._(h,"Double-click on legend to isolate one trace"),"long"),f=!1;var b;if(p===1?b=o:p===2&&(b=w),!b)return;var L=g==="togglegroup",S=v.hiddenlabels?v.hiddenlabels.slice():[],M=u.data()[0][0];if(M.groupTitle&&M.noClick)return;var T=h._fullData,C=(v.shapes||[]).filter(function(ct){return ct.showlegend}),m=T.concat(C),y=M.trace;y._isShape&&(y=y._fullInput);var A=y.legendgroup,R,N,te,H,U,P,re={},G=[],Z=[],Y=[];function X(ct,Oe){var ze=G.indexOf(ct),we=re.visible;return we||(we=re.visible=[]),G.indexOf(ct)===-1&&(G.push(ct),ze=G.length-1),we[ze]=Oe,ze}var ne=(v.shapes||[]).map(function(ct){return ct._input}),ae=!1;function B(ct,Oe){ne[ct].visible=Oe,ae=!0}function ie(ct,Oe){if(!(M.groupTitle&&!L)){var ze=ct._fullInput||ct,we=ze._isShape,je=ze.index;je===void 0&&(je=ze._index);var ot=ze.visible===!1?!1:Oe;we?B(je,ot):X(je,ot)}}var se=y.legend,ye=y._fullInput,me=ye&&ye._isShape;if(!me&&d.traceIs(y,"pie-like")){var xe=M.label,Re=S.indexOf(xe);if(b==="toggle")Re===-1?S.push(xe):S.splice(Re,1);else if(b==="toggleothers"){var ke=Re!==-1,Ie=[];for(R=0;R<h.calcdata.length;R++){var Q=h.calcdata[R];for(N=0;N<Q.length;N++){var ee=Q[N],D=ee.label;se===Q[0].trace.legend&&xe!==D&&(S.indexOf(D)===-1&&(ke=!0),s(S,D),Ie.push(D))}}if(!ke)for(var le=0;le<Ie.length;le++){var ge=S.indexOf(Ie[le]);ge!==-1&&S.splice(ge,1)}}d.call("_guiRelayout",h,"hiddenlabels",S)}else{var j=A&&A.length,k=[],F;if(j)for(R=0;R<m.length;R++)F=m[R],F.visible&&F.legendgroup===A&&k.push(R);if(b==="toggle"){var J;switch(y.visible){case!0:J="legendonly";break;case!1:J=!1;break;case"legendonly":J=!0;break}if(j)if(L)for(R=0;R<m.length;R++){var K=m[R];K.visible!==!1&&K.legendgroup===A&&ie(K,J)}else ie(y,J);else ie(y,J)}else if(b==="toggleothers"){var ve,Te,Ae,Fe,Ge,rt=!0;for(R=0;R<m.length;R++)if(Ge=m[R],ve=Ge===y,Ae=Ge.showlegend!==!0,!(ve||Ae)&&(Te=j&&Ge.legendgroup===A,!Te&&Ge.legend===se&&Ge.visible===!0&&!d.traceIs(Ge,"notLegendIsolatable"))){rt=!1;break}for(R=0;R<m.length;R++)if(Ge=m[R],!(Ge.visible===!1||Ge.legend!==se)&&!d.traceIs(Ge,"notLegendIsolatable"))switch(y.visible){case"legendonly":ie(Ge,!0);break;case!0:Fe=rt?!0:"legendonly",ve=Ge===y,Ae=Ge.showlegend!==!0&&!Ge.legendgroup,Te=ve||j&&Ge.legendgroup===A,ie(Ge,Te||Ae?!0:Fe);break}}for(R=0;R<Z.length;R++)if(te=Z[R],!!te){var bt=te.constructUpdate(),ht=Object.keys(bt);for(N=0;N<ht.length;N++)H=ht[N],P=re[H]=re[H]||[],P[Y[R]]=bt[H]}for(U=Object.keys(re),R=0;R<U.length;R++)for(H=U[R],N=0;N<G.length;N++)re[H].hasOwnProperty(N)||(re[H][N]=void 0);ae?d.call("_guiUpdate",h,re,{shapes:ne},G):d.call("_guiRestyle",h,re,G)}}}),za=t((W,V)=>{V.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}}),ai=t((W,V)=>{var d=an(),i=Ta();V.exports=function(s,f,u){var h=f._inHover,p=i.isGrouped(f),v=i.isReversed(f),o={},w=[],g=!1,b={},L=0,S=0,M,T;function C(ie,se,ye){if(f.visible!==!1&&!(u&&ie!==f._id))if(se===""||!i.isGrouped(f)){var me="~~i"+L;w.push(me),o[me]=[ye],L++}else w.indexOf(se)===-1?(w.push(se),g=!0,o[se]=[ye]):o[se].push(ye)}for(M=0;M<s.length;M++){var m=s[M],y=m[0],A=y.trace,R=A.legend,N=A.legendgroup;if(!(!h&&(!A.visible||!A.showlegend)))if(d.traceIs(A,"pie-like"))for(b[N]||(b[N]={}),T=0;T<m.length;T++){var te=m[T].label;b[N][te]||(C(R,N,{label:te,color:m[T].color,i:m[T].i,trace:A,pts:m[T].pts}),b[N][te]=!0,S=Math.max(S,(te||"").length))}else C(R,N,y),S=Math.max(S,(A.name||"").length)}if(!w.length)return[];var H=!g||!p,U=[];for(M=0;M<w.length;M++){var P=o[w[M]];H?U.push(P[0]):U.push(P)}for(H&&(U=[U]),M=0;M<U.length;M++){var re=1/0;for(T=0;T<U[M].length;T++){var G=U[M][T].trace.legendrank;re>G&&(re=G)}U[M][0]._groupMinRank=re,U[M][0]._preGroupSort=M}var Z=function(ie,se){return ie[0]._groupMinRank-se[0]._groupMinRank||ie[0]._preGroupSort-se[0]._preGroupSort},Y=function(ie,se){return ie.trace.legendrank-se.trace.legendrank||ie._preSort-se._preSort};for(U.forEach(function(ie,se){ie[0]._preGroupSort=se}),U.sort(Z),M=0;M<U.length;M++){U[M].forEach(function(ie,se){ie._preSort=se}),U[M].sort(Y);var X=U[M][0].trace,ne=null;for(T=0;T<U[M].length;T++){var ae=U[M][T].trace.legendgrouptitle;if(ae&&ae.text){ne=ae,h&&(ae.font=f._groupTitleFont);break}}if(v&&U[M].reverse(),ne){var B=!1;for(T=0;T<U[M].length;T++)if(d.traceIs(U[M][T].trace,"pie-like")){B=!0;break}U[M].unshift({i:-1,groupTitle:ne,noClick:B,trace:{showlegend:X.showlegend,legendgroup:X.legendgroup,visible:f.groupclick==="toggleitem"?!0:X.visible}})}for(T=0;T<U[M].length;T++)U[M][T]=[U[M][T]]}return f._lgroupsLength=U.length,f._maxNameLength=S,U}}),ho=t(W=>{var V=Mt();function d(i){return i.indexOf("e")!==-1?i.replace(/[.]?0+e/,"e"):i.indexOf(".")!==-1?i.replace(/[.]?0+$/,""):i}W.formatPiePercent=function(i,s){var f=d((i*100).toPrecision(3));return V.numSeparate(f,s)+"%"},W.formatPieValue=function(i,s){var f=d(i.toPrecision(10));return V.numSeparate(f,s)},W.getFirstFilled=function(i,s){if(V.isArrayOrTypedArray(i))for(var f=0;f<s.length;f++){var u=i[s[f]];if(u||u===0||u==="")return u}},W.castOption=function(i,s){if(V.isArrayOrTypedArray(i))return W.getFirstFilled(i,s);if(i)return i},W.getRotationAngle=function(i){return(i==="auto"?0:i)*Math.PI/180}}),fo=t((W,V)=>{var d=Ra(),i=Xt();V.exports=function(s,f,u,h){var p=u.marker.pattern;p&&p.shape?d.pointStyle(s,u,h,f):i.fill(s,f.color)}}),bs=t((W,V)=>{var d=Xt(),i=ho().castOption,s=fo();V.exports=function(f,u,h,p){var v=h.marker.line,o=i(v.color,u.pts)||d.defaultLine,w=i(v.width,u.pts)||0;f.call(s,u,h,p).style("stroke-width",w).call(d.stroke,o)}}),ec=t((W,V)=>{var d=l(),i=an(),s=Mt(),f=s.strTranslate,u=Ra(),h=Xt(),p=Di().extractOpts,v=Ki(),o=bs(),w=ho().castOption,g=za(),b=12,L=5,S=2,M=10,T=5;V.exports=function(A,R,N){var te=R._fullLayout;N||(N=te.legend);var H=N.itemsizing==="constant",U=N.itemwidth,P=(U+g.itemGap*2)/2,re=f(P,0),G=function(Ie,Q,ee,D){var le;if(Ie+1)le=Ie;else if(Q&&Q.width>0)le=Q.width;else return 0;return H?D:Math.min(le,ee)};A.each(function(Ie){var Q=d.select(this),ee=s.ensureSingle(Q,"g","layers");ee.style("opacity",Ie[0].trace.opacity);var D=N.indentation,le=N.valign,ge=Ie[0].lineHeight,j=Ie[0].height;if(le==="middle"&&D===0||!ge||!j)ee.attr("transform",null);else{var k={top:1,bottom:-1}[le],F=k*(.5*(ge-j+3))||0,J=N.indentation;ee.attr("transform",f(J,F))}var K=ee.selectAll("g.legendfill").data([Ie]);K.enter().append("g").classed("legendfill",!0);var ve=ee.selectAll("g.legendlines").data([Ie]);ve.enter().append("g").classed("legendlines",!0);var Te=ee.selectAll("g.legendsymbols").data([Ie]);Te.enter().append("g").classed("legendsymbols",!0),Te.selectAll("g.legendpoints").data([Ie]).enter().append("g").classed("legendpoints",!0)}).each(ke).each(X).each(ae).each(ne).each(ie).each(xe).each(me).each(Z).each(Y).each(se).each(ye);function Z(Ie){var Q=m(Ie),ee=Q.showFill,D=Q.showLine,le=Q.showGradientLine,ge=Q.showGradientFill,j=Q.anyFill,k=Q.anyLine,F=Ie[0],J=F.trace,K,ve,Te=p(J),Ae=Te.colorscale,Fe=Te.reversescale,Ge=function(we){if(we.size())if(ee)u.fillGroupStyle(we,R,!0);else{var je="legendfill-"+J.uid;u.gradient(we,R,je,C(Fe),Ae,"fill")}},rt=function(we){if(we.size()){var je="legendline-"+J.uid;u.lineGroupStyle(we),u.gradient(we,R,je,C(Fe),Ae,"stroke")}},bt=v.hasMarkers(J)||!j?"M5,0":k?"M5,-2":"M5,-3",ht=d.select(this),ct=ht.select(".legendfill").selectAll("path").data(ee||ge?[Ie]:[]);if(ct.enter().append("path").classed("js-fill",!0),ct.exit().remove(),ct.attr("d",bt+"h"+U+"v6h-"+U+"z").call(Ge),D||le){var Oe=G(void 0,J.line,M,L);ve=s.minExtend(J,{line:{width:Oe}}),K=[s.minExtend(F,{trace:ve})]}var ze=ht.select(".legendlines").selectAll("path").data(D||le?[K]:[]);ze.enter().append("path").classed("js-line",!0),ze.exit().remove(),ze.attr("d",bt+(le?"l"+U+",0.0001":"h"+U)).call(D?u.lineGroupStyle:rt)}function Y(Ie){var Q=m(Ie),ee=Q.anyFill,D=Q.anyLine,le=Q.showLine,ge=Q.showMarker,j=Ie[0],k=j.trace,F=!ge&&!D&&!ee&&v.hasText(k),J,K;function ve(ct,Oe,ze,we){var je=s.nestedProperty(k,ct).get(),ot=s.isArrayOrTypedArray(je)&&Oe?Oe(je):je;if(H&&ot&&we!==void 0&&(ot=we),ze){if(ot<ze[0])return ze[0];if(ot>ze[1])return ze[1]}return ot}function Te(ct){return j._distinct&&j.index&&ct[j.index]?ct[j.index]:ct[0]}if(ge||F||le){var Ae={},Fe={};if(ge){Ae.mc=ve("marker.color",Te),Ae.mx=ve("marker.symbol",Te),Ae.mo=ve("marker.opacity",s.mean,[.2,1]),Ae.mlc=ve("marker.line.color",Te),Ae.mlw=ve("marker.line.width",s.mean,[0,5],S),Fe.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var Ge=ve("marker.size",s.mean,[2,16],b);Ae.ms=Ge,Fe.marker.size=Ge}le&&(Fe.line={width:ve("line.width",Te,[0,10],L)}),F&&(Ae.tx="Aa",Ae.tp=ve("textposition",Te),Ae.ts=10,Ae.tc=ve("textfont.color",Te),Ae.tf=ve("textfont.family",Te),Ae.tw=ve("textfont.weight",Te),Ae.ty=ve("textfont.style",Te),Ae.tv=ve("textfont.variant",Te),Ae.tC=ve("textfont.textcase",Te),Ae.tE=ve("textfont.lineposition",Te),Ae.tS=ve("textfont.shadow",Te)),J=[s.minExtend(j,Ae)],K=s.minExtend(k,Fe),K.selectedpoints=null,K.texttemplate=null}var rt=d.select(this).select("g.legendpoints"),bt=rt.selectAll("path.scatterpts").data(ge?J:[]);bt.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",re),bt.exit().remove(),bt.call(u.pointStyle,K,R),ge&&(J[0].mrc=3);var ht=rt.selectAll("g.pointtext").data(F?J:[]);ht.enter().append("g").classed("pointtext",!0).append("text").attr("transform",re),ht.exit().remove(),ht.selectAll("text").call(u.textPointStyle,K,R)}function X(Ie){var Q=Ie[0].trace,ee=Q.type==="waterfall";if(Ie[0]._distinct&&ee){var D=Ie[0].trace[Ie[0].dir].marker;return Ie[0].mc=D.color,Ie[0].mlw=D.line.width,Ie[0].mlc=D.line.color,B(Ie,this,"waterfall")}var le=[];Q.visible&&ee&&(le=Ie[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var ge=d.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(le);ge.enter().append("path").classed("legendwaterfall",!0).attr("transform",re).style("stroke-miterlimit",1),ge.exit().remove(),ge.each(function(j){var k=d.select(this),F=Q[j[0]].marker,J=G(void 0,F.line,T,S);k.attr("d",j[1]).style("stroke-width",J+"px").call(h.fill,F.color),J&&k.call(h.stroke,F.line.color)})}function ne(Ie){B(Ie,this)}function ae(Ie){B(Ie,this,"funnel")}function B(Ie,Q,ee){var D=Ie[0].trace,le=D.marker||{},ge=le.line||{},j=le.cornerradius?"M6,3a3,3,0,0,1-3,3H-3a3,3,0,0,1-3-3V-3a3,3,0,0,1,3-3H3a3,3,0,0,1,3,3Z":"M6,6H-6V-6H6Z",k=ee?D.visible&&D.type===ee:i.traceIs(D,"bar"),F=d.select(Q).select("g.legendpoints").selectAll("path.legend"+ee).data(k?[Ie]:[]);F.enter().append("path").classed("legend"+ee,!0).attr("d",j).attr("transform",re),F.exit().remove(),F.each(function(J){var K=d.select(this),ve=J[0],Te=G(ve.mlw,le.line,T,S);K.style("stroke-width",Te+"px");var Ae=ve.mcc;if(!N._inHover&&"mc"in ve){var Fe=p(le),Ge=Fe.mid;Ge===void 0&&(Ge=(Fe.max+Fe.min)/2),Ae=u.tryColorscale(le,"")(Ge)}var rt=Ae||ve.mc||le.color,bt=le.pattern,ht=u.getPatternAttr,ct=bt&&(ht(bt.shape,0,"")||ht(bt.path,0,""));if(ct){var Oe=ht(bt.bgcolor,0,null),ze=ht(bt.fgcolor,0,null),we=bt.fgopacity,je=y(bt.size,8,10),ot=y(bt.solidity,.5,1),vt="legend-"+D.uid;K.call(u.pattern,"legend",R,vt,ct,je,ot,Ae,bt.fillmode,Oe,ze,we)}else K.call(h.fill,rt);Te&&h.stroke(K,ve.mlc||ge.color)})}function ie(Ie){var Q=Ie[0].trace,ee=d.select(this).select("g.legendpoints").selectAll("path.legendbox").data(Q.visible&&i.traceIs(Q,"box-violin")?[Ie]:[]);ee.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",re),ee.exit().remove(),ee.each(function(){var D=d.select(this);if((Q.boxpoints==="all"||Q.points==="all")&&h.opacity(Q.fillcolor)===0&&h.opacity((Q.line||{}).color)===0){var le=s.minExtend(Q,{marker:{size:H?b:s.constrain(Q.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});ee.call(u.pointStyle,le,R)}else{var ge=G(void 0,Q.line,T,S);D.style("stroke-width",ge+"px").call(h.fill,Q.fillcolor),ge&&h.stroke(D,Q.line.color)}})}function se(Ie){var Q=Ie[0].trace,ee=d.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(Q.visible&&Q.type==="candlestick"?[Ie,Ie]:[]);ee.enter().append("path").classed("legendcandle",!0).attr("d",function(D,le){return le?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",re).style("stroke-miterlimit",1),ee.exit().remove(),ee.each(function(D,le){var ge=d.select(this),j=Q[le?"increasing":"decreasing"],k=G(void 0,j.line,T,S);ge.style("stroke-width",k+"px").call(h.fill,j.fillcolor),k&&h.stroke(ge,j.line.color)})}function ye(Ie){var Q=Ie[0].trace,ee=d.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(Q.visible&&Q.type==="ohlc"?[Ie,Ie]:[]);ee.enter().append("path").classed("legendohlc",!0).attr("d",function(D,le){return le?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",re).style("stroke-miterlimit",1),ee.exit().remove(),ee.each(function(D,le){var ge=d.select(this),j=Q[le?"increasing":"decreasing"],k=G(void 0,j.line,T,S);ge.style("fill","none").call(u.dashLine,j.line.dash,k),k&&h.stroke(ge,j.line.color)})}function me(Ie){Re(Ie,this,"pie")}function xe(Ie){Re(Ie,this,"funnelarea")}function Re(Ie,Q,ee){var D=Ie[0],le=D.trace,ge=ee?le.visible&&le.type===ee:i.traceIs(le,ee),j=d.select(Q).select("g.legendpoints").selectAll("path.legend"+ee).data(ge?[Ie]:[]);if(j.enter().append("path").classed("legend"+ee,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",re),j.exit().remove(),j.size()){var k=le.marker||{},F=G(w(k.line.width,D.pts),k.line,T,S),J="pieLike",K=s.minExtend(le,{marker:{line:{width:F}}},J),ve=s.minExtend(D,{trace:K},J);o(j,ve,K,R)}}function ke(Ie){var Q=Ie[0].trace,ee,D=[];if(Q.visible)switch(Q.type){case"histogram2d":case"heatmap":D=[["M-15,-2V4H15V-2Z"]],ee=!0;break;case"choropleth":case"choroplethmapbox":case"choroplethmap":D=[["M-6,-6V6H6V-6Z"]],ee=!0;break;case"densitymapbox":case"densitymap":D=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],ee="radial";break;case"cone":D=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],ee=!1;break;case"streamtube":D=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],ee=!1;break;case"surface":D=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],ee=!0;break;case"mesh3d":D=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],ee=!1;break;case"volume":D=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],ee=!0;break;case"isosurface":D=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],ee=!1;break}var le=d.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(D);le.enter().append("path").classed("legend3dandfriends",!0).attr("transform",re).style("stroke-miterlimit",1),le.exit().remove(),le.each(function(ge,j){var k=d.select(this),F=p(Q),J=F.colorscale,K=F.reversescale,ve=function(Ge){if(Ge.size()){var rt="legendfill-"+Q.uid;u.gradient(Ge,R,rt,C(K,ee==="radial"),J,"fill")}},Te;if(J){if(!ee){var Ae=J.length;Te=j===0?J[K?Ae-1:0][1]:j===1?J[K?0:Ae-1][1]:J[Math.floor((Ae-1)/2)][1]}}else{var Fe=Q.vertexcolor||Q.facecolor||Q.color;Te=s.isArrayOrTypedArray(Fe)?Fe[j]||Fe[0]:Fe}k.attr("d",ge[0]),Te?k.call(h.fill,Te):k.call(ve)})}};function C(A,R){var N=R?"radial":"horizontal";return N+(A?"":"reversed")}function m(A){var R=A[0].trace,N=R.contours,te=v.hasLines(R),H=v.hasMarkers(R),U=R.visible&&R.fill&&R.fill!=="none",P=!1,re=!1;if(N){var G=N.coloring;G==="lines"?P=!0:te=G==="none"||G==="heatmap"||N.showlines,N.type==="constraint"?U=N._operation!=="=":(G==="fill"||G==="heatmap")&&(re=!0)}return{showMarker:H,showLine:te,showFill:U,showGradientLine:P,showGradientFill:re,anyLine:te||P,anyFill:U||re}}function y(A,R,N){return A&&s.isArrayOrTypedArray(A)?R:A>N?N:A}}),tc=t((W,V)=>{var d=l(),i=Mt(),s=pn(),f=an(),u=xn(),h=Ot(),p=Ra(),v=Xt(),o=ja(),w=ni(),g=za(),b=fi(),L=b.LINE_SPACING,S=b.FROM_TL,M=b.FROM_BR,T=ai(),C=ec(),m=Ta(),y=1,A=/^legend[0-9]*$/;V.exports=function(se,ye){if(ye)N(se,ye);else{var me=se._fullLayout,xe=me._legends,Re=me._infolayer.selectAll('[class^="legend"]');Re.each(function(){var ee=d.select(this),D=ee.attr("class"),le=D.split(" ")[0];le.match(A)&&xe.indexOf(le)===-1&&ee.remove()});for(var ke=0;ke<xe.length;ke++){var Ie=xe[ke],Q=se._fullLayout[Ie];N(se,Q)}}};function R(se,ye,me){if(!(ye.title.side!=="top center"&&ye.title.side!=="top right")){var xe=ye.title.font,Re=xe.size*L,ke=0,Ie=se.node(),Q=p.bBox(Ie).width;ye.title.side==="top center"?ke=.5*(ye._width-2*me-2*g.titlePad-Q):ye.title.side==="top right"&&(ke=ye._width-2*me-2*g.titlePad-Q),o.positionText(se,me+g.titlePad+ke,me+Re)}}function N(se,ye){var me=ye||{},xe=se._fullLayout,Re=ie(me),ke,Ie,Q=me._inHover;if(Q?(Ie=me.layer,ke="hover"):(Ie=xe._infolayer,ke=Re),!!Ie){ke+=xe._uid,se._legendMouseDownTime||(se._legendMouseDownTime=0);var ee;if(Q){if(!me.entries)return;ee=T(me.entries,me)}else{for(var D=(se.calcdata||[]).slice(),le=xe.shapes,ge=0;ge<le.length;ge++){var j=le[ge];if(j.showlegend){var k={_isShape:!0,_fullInput:j,index:j._index,name:j.name||j.label.text||"shape "+j._index,legend:j.legend,legendgroup:j.legendgroup,legendgrouptitle:j.legendgrouptitle,legendrank:j.legendrank,legendwidth:j.legendwidth,showlegend:j.showlegend,visible:j.visible,opacity:j.opacity,mode:j.type==="line"?"lines":"markers",line:j.line,marker:{line:j.line,color:j.fillcolor,size:12,symbol:j.type==="rect"?"square":j.type==="circle"?"circle":"hexagon2"}};D.push([{trace:k}])}}ee=xe.showlegend&&T(D,me,xe._legends.length>1)}var F=xe.hiddenlabels||[];if(!Q&&(!xe.showlegend||!ee.length))return Ie.selectAll("."+Re).remove(),xe._topdefs.select("#"+ke).remove(),s.autoMargin(se,Re);var J=i.ensureSingle(Ie,"g",Re,function(ht){Q||ht.attr("pointer-events","all")}),K=i.ensureSingleById(xe._topdefs,"clipPath",ke,function(ht){ht.append("rect")}),ve=i.ensureSingle(J,"rect","bg",function(ht){ht.attr("shape-rendering","crispEdges")});ve.call(v.stroke,me.bordercolor).call(v.fill,me.bgcolor).style("stroke-width",me.borderwidth+"px");var Te=i.ensureSingle(J,"g","scrollbox"),Ae=me.title;me._titleWidth=0,me._titleHeight=0;var Fe;Ae.text?(Fe=i.ensureSingle(Te,"text",Re+"titletext"),Fe.attr("text-anchor","start").call(p.font,Ae.font).text(Ae.text),G(Fe,Te,se,me,y)):Te.selectAll("."+Re+"titletext").remove();var Ge=i.ensureSingle(J,"rect","scrollbar",function(ht){ht.attr(g.scrollBarEnterAttrs).call(v.fill,g.scrollBarColor)}),rt=Te.selectAll("g.groups").data(ee);rt.enter().append("g").attr("class","groups"),rt.exit().remove();var bt=rt.selectAll("g.traces").data(i.identity);bt.enter().append("g").attr("class","traces"),bt.exit().remove(),bt.style("opacity",function(ht){var ct=ht[0].trace;return f.traceIs(ct,"pie-like")?F.indexOf(ht[0].label)!==-1?.5:1:ct.visible==="legendonly"?.5:1}).each(function(){d.select(this).call(U,se,me)}).call(C,se,me).each(function(){Q||d.select(this).call(re,se,Re)}),i.syncOrAsync([s.previousPromises,function(){return X(se,rt,bt,me)},function(){var ht=xe._size,ct=me.borderwidth,Oe=me.xref==="paper",ze=me.yref==="paper";if(Ae.text&&R(Fe,me,ct),!Q){var we,je;Oe?we=ht.l+ht.w*me.x-S[ae(me)]*me._width:we=xe.width*me.x-S[ae(me)]*me._width,ze?je=ht.t+ht.h*(1-me.y)-S[B(me)]*me._effHeight:je=xe.height*(1-me.y)-S[B(me)]*me._effHeight;var ot=ne(se,Re,we,je);if(ot)return;if(xe.margin.autoexpand){var vt=we,Lt=je;we=Oe?i.constrain(we,0,xe.width-me._width):vt,je=ze?i.constrain(je,0,xe.height-me._effHeight):Lt,we!==vt&&i.log("Constrain "+Re+".x to make legend fit inside graph"),je!==Lt&&i.log("Constrain "+Re+".y to make legend fit inside graph")}p.setTranslate(J,we,je)}if(Ge.on(".drag",null),J.on("wheel",null),Q||me._height<=me._maxHeight||se._context.staticPlot){var Tt=me._effHeight;Q&&(Tt=me._height),ve.attr({width:me._width-ct,height:Tt-ct,x:ct/2,y:ct/2}),p.setTranslate(Te,0,0),K.select("rect").attr({width:me._width-2*ct,height:Tt-2*ct,x:ct,y:ct}),p.setClipUrl(Te,ke,se),p.setRect(Ge,0,0,0,0),delete me._scrollY}else{var kt=Math.max(g.scrollBarMinHeight,me._effHeight*me._effHeight/me._height),Nt=me._effHeight-kt-2*g.scrollBarMargin,Pt=me._height-me._effHeight,Wt=Nt/Pt,St=Math.min(me._scrollY||0,Pt);ve.attr({width:me._width-2*ct+g.scrollBarWidth+g.scrollBarMargin,height:me._effHeight-ct,x:ct/2,y:ct/2}),K.select("rect").attr({width:me._width-2*ct+g.scrollBarWidth+g.scrollBarMargin,height:me._effHeight-2*ct,x:ct,y:ct+St}),p.setClipUrl(Te,ke,se),Me(St,kt,Wt),J.on("wheel",function(){St=i.constrain(me._scrollY+d.event.deltaY/Nt*Pt,0,Pt),Me(St,kt,Wt),St!==0&&St!==Pt&&d.event.preventDefault()});var Qt,rr,Jt,sr=function(at,xt,mt){var yt=(mt-xt)/Wt+at;return i.constrain(yt,0,Pt)},De=function(at,xt,mt){var yt=(xt-mt)/Wt+at;return i.constrain(yt,0,Pt)},Je=d.behavior.drag().on("dragstart",function(){var at=d.event.sourceEvent;at.type==="touchstart"?Qt=at.changedTouches[0].clientY:Qt=at.clientY,Jt=St}).on("drag",function(){var at=d.event.sourceEvent;at.buttons===2||at.ctrlKey||(at.type==="touchmove"?rr=at.changedTouches[0].clientY:rr=at.clientY,St=sr(Jt,Qt,rr),Me(St,kt,Wt))});Ge.call(Je);var de=d.behavior.drag().on("dragstart",function(){var at=d.event.sourceEvent;at.type==="touchstart"&&(Qt=at.changedTouches[0].clientY,Jt=St)}).on("drag",function(){var at=d.event.sourceEvent;at.type==="touchmove"&&(rr=at.changedTouches[0].clientY,St=De(Jt,Qt,rr),Me(St,kt,Wt))});Te.call(de)}function Me(at,xt,mt){me._scrollY=se._fullLayout[Re]._scrollY=at,p.setTranslate(Te,0,-at),p.setRect(Ge,me._width,g.scrollBarMargin+at*mt,g.scrollBarWidth,xt),K.select("rect").attr("y",ct+at)}if(se._context.edits.legendPosition){var Ce,Ue,He,et;J.classed("cursor-move",!0),h.init({element:J.node(),gd:se,prepFn:function(at){if(at.target!==Ge.node()){var xt=p.getTranslate(J);He=xt.x,et=xt.y}},moveFn:function(at,xt){if(He!==void 0&&et!==void 0){var mt=He+at,yt=et+xt;p.setTranslate(J,mt,yt),Ce=h.align(mt,me._width,ht.l,ht.l+ht.w,me.xanchor),Ue=h.align(yt+me._height,-me._height,ht.t+ht.h,ht.t,me.yanchor)}},doneFn:function(){if(Ce!==void 0&&Ue!==void 0){var at={};at[Re+".x"]=Ce,at[Re+".y"]=Ue,f.call("_guiRelayout",se,at)}},clickFn:function(at,xt){var mt=Ie.selectAll("g.traces").filter(function(){var yt=this.getBoundingClientRect();return xt.clientX>=yt.left&&xt.clientX<=yt.right&&xt.clientY>=yt.top&&xt.clientY<=yt.bottom});mt.size()>0&&H(se,J,mt,at,xt)}})}}],se)}}function te(se,ye,me){var xe=se[0],Re=xe.width,ke=ye.entrywidthmode,Ie=xe.trace.legendwidth||ye.entrywidth;return ke==="fraction"?ye._maxWidth*Ie:me+(Ie||Re)}function H(se,ye,me,xe,Re){var ke=me.data()[0][0].trace,Ie={event:Re,node:me.node(),curveNumber:ke.index,expandedIndex:ke.index,data:se.data,layout:se.layout,frames:se._transitionData._frames,config:se._context,fullData:se._fullData,fullLayout:se._fullLayout};ke._group&&(Ie.group=ke._group),f.traceIs(ke,"pie-like")&&(Ie.label=me.datum()[0].label);var Q=u.triggerHandler(se,"plotly_legendclick",Ie);if(xe===1){if(Q===!1)return;ye._clickTimeout=setTimeout(function(){se._fullLayout&&w(me,se,xe)},se._context.doubleClickDelay)}else if(xe===2){ye._clickTimeout&&clearTimeout(ye._clickTimeout),se._legendMouseDownTime=0;var ee=u.triggerHandler(se,"plotly_legenddoubleclick",Ie);ee!==!1&&Q!==!1&&w(me,se,xe)}}function U(se,ye,me){var xe=ie(me),Re=se.data()[0][0],ke=Re.trace,Ie=f.traceIs(ke,"pie-like"),Q=!me._inHover&&ye._context.edits.legendText&&!Ie,ee=me._maxNameLength,D,le;Re.groupTitle?(D=Re.groupTitle.text,le=Re.groupTitle.font):(le=me.font,me.entries?D=Re.text:(D=Ie?Re.label:ke.name,ke._meta&&(D=i.templateString(D,ke._meta))));var ge=i.ensureSingle(se,"text",xe+"text");ge.attr("text-anchor","start").call(p.font,le).text(Q?P(D,ee):D);var j=me.indentation+me.itemwidth+g.itemGap*2;o.positionText(ge,j,0),Q?ge.call(o.makeEditable,{gd:ye,text:D}).call(G,se,ye,me).on("edit",function(k){this.text(P(k,ee)).call(G,se,ye,me);var F=Re.trace._fullInput||{},J={};return J.name=k,F._isShape?f.call("_guiRelayout",ye,"shapes["+ke.index+"].name",J.name):f.call("_guiRestyle",ye,J,ke.index)}):G(ge,se,ye,me)}function P(se,ye){var me=Math.max(4,ye);if(se&&se.trim().length>=me/2)return se;se=se||"";for(var xe=me-se.length;xe>0;xe--)se+=" ";return se}function re(se,ye,me){var xe=ye._context.doubleClickDelay,Re,ke=1,Ie=i.ensureSingle(se,"rect",me+"toggle",function(Q){ye._context.staticPlot||Q.style("cursor","pointer").attr("pointer-events","all"),Q.call(v.fill,"rgba(0,0,0,0)")});ye._context.staticPlot||(Ie.on("mousedown",function(){Re=new Date().getTime(),Re-ye._legendMouseDownTime<xe?ke+=1:(ke=1,ye._legendMouseDownTime=Re)}),Ie.on("mouseup",function(){if(!(ye._dragged||ye._editing)){var Q=ye._fullLayout[me];new Date().getTime()-ye._legendMouseDownTime>xe&&(ke=Math.max(ke-1,1)),H(ye,Q,se,ke,d.event)}}))}function G(se,ye,me,xe,Re){xe._inHover&&se.attr("data-notex",!0),o.convertToTspans(se,me,function(){Z(ye,me,xe,Re)})}function Z(se,ye,me,xe){var Re=se.data()[0][0];if(!me._inHover&&Re&&!Re.trace.showlegend){se.remove();return}var ke=se.select("g[class*=math-group]"),Ie=ke.node(),Q=ie(me);me||(me=ye._fullLayout[Q]);var ee=me.borderwidth,D;xe===y?D=me.title.font:Re.groupTitle?D=Re.groupTitle.font:D=me.font;var le=D.size*L,ge,j;if(Ie){var k=p.bBox(Ie);ge=k.height,j=k.width,xe===y?p.setTranslate(ke,ee,ee+ge*.75):p.setTranslate(ke,0,ge*.25)}else{var F="."+Q+(xe===y?"title":"")+"text",J=se.select(F),K=o.lineCount(J),ve=J.node();if(ge=le*K,j=ve?p.bBox(ve).width:0,xe===y)me.title.side==="left"&&(j+=g.itemGap*2),o.positionText(J,ee+g.titlePad,ee+le);else{var Te=g.itemGap*2+me.indentation+me.itemwidth;Re.groupTitle&&(Te=g.itemGap,j-=me.indentation+me.itemwidth),o.positionText(J,Te,-le*((K-1)/2-.3))}}xe===y?(me._titleWidth=j,me._titleHeight=ge):(Re.lineHeight=le,Re.height=Math.max(ge,16)+3,Re.width=j)}function Y(se){var ye=0,me=0,xe=se.title.side;return xe&&(xe.indexOf("left")!==-1&&(ye=se._titleWidth),xe.indexOf("top")!==-1&&(me=se._titleHeight)),[ye,me]}function X(se,ye,me,xe){var Re=se._fullLayout,ke=ie(xe);xe||(xe=Re[ke]);var Ie=Re._size,Q=m.isVertical(xe),ee=m.isGrouped(xe),D=xe.entrywidthmode==="fraction",le=xe.borderwidth,ge=2*le,j=g.itemGap,k=xe.indentation+xe.itemwidth+j*2,F=2*(le+j),J=B(xe),K=xe.y<0||xe.y===0&&J==="top",ve=xe.y>1||xe.y===1&&J==="bottom",Te=xe.tracegroupgap,Ae={};let{orientation:Fe,yref:Ge}=xe,{maxheight:rt}=xe,bt=K||ve||Fe!=="v"||Ge!=="paper";rt||(rt=bt?.5:1);let ht=bt?Re.height:Ie.h;xe._maxHeight=Math.max(rt>1?rt:rt*ht,30);var ct=0;xe._width=0,xe._height=0;var Oe=Y(xe);if(Q)me.each(function(Me){var Ce=Me[0].height;p.setTranslate(this,le+Oe[0],le+Oe[1]+xe._height+Ce/2+j),xe._height+=Ce,xe._width=Math.max(xe._width,Me[0].width)}),ct=k+xe._width,xe._width+=j+k+ge,xe._height+=F,ee&&(ye.each(function(Me,Ce){p.setTranslate(this,0,Ce*xe.tracegroupgap)}),xe._height+=(xe._lgroupsLength-1)*xe.tracegroupgap);else{var ze=ae(xe),we=xe.x<0||xe.x===0&&ze==="right",je=xe.x>1||xe.x===1&&ze==="left",ot=ve||K,vt=Re.width/2;xe._maxWidth=Math.max(we?ot&&ze==="left"?Ie.l+Ie.w:vt:je?ot&&ze==="right"?Ie.r+Ie.w:vt:Ie.w,2*k);var Lt=0,Tt=0;me.each(function(Me){var Ce=te(Me,xe,k);Lt=Math.max(Lt,Ce),Tt+=Ce}),ct=null;var kt=0;if(ee){var Nt=0,Pt=0,Wt=0;ye.each(function(){var Me=0,Ce=0;d.select(this).selectAll("g.traces").each(function(He){var et=te(He,xe,k),at=He[0].height;p.setTranslate(this,Oe[0],Oe[1]+le+j+at/2+Ce),Ce+=at,Me=Math.max(Me,et),Ae[He[0].trace.legendgroup]=Me});var Ue=Me+j;Pt>0&&Ue+le+Pt>xe._maxWidth?(kt=Math.max(kt,Pt),Pt=0,Wt+=Nt+Te,Nt=Ce):Nt=Math.max(Nt,Ce),p.setTranslate(this,Pt,Wt),Pt+=Ue}),xe._width=Math.max(kt,Pt)+le,xe._height=Wt+Nt+F}else{var St=me.size(),Qt=Tt+ge+(St-1)*j<xe._maxWidth,rr=0,Jt=0,sr=0,De=0;me.each(function(Me){var Ce=Me[0].height,Ue=te(Me,xe,k),He=Qt?Ue:Lt;D||(He+=j),He+le+Jt-j>=xe._maxWidth&&(kt=Math.max(kt,De),Jt=0,sr+=rr,xe._height+=rr,rr=0),p.setTranslate(this,Oe[0]+le+Jt,Oe[1]+le+sr+Ce/2+j),De=Jt+Ue+j,Jt+=He,rr=Math.max(rr,Ce)}),Qt?(xe._width=Jt+ge,xe._height=rr+F):(xe._width=Math.max(kt,De)+ge,xe._height+=rr+F)}}xe._width=Math.ceil(Math.max(xe._width+Oe[0],xe._titleWidth+2*(le+g.titlePad))),xe._height=Math.ceil(Math.max(xe._height+Oe[1],xe._titleHeight+2*(le+g.itemGap))),xe._effHeight=Math.min(xe._height,xe._maxHeight);var Je=se._context.edits,de=Je.legendText||Je.legendPosition;me.each(function(Me){var Ce=d.select(this).select("."+ke+"toggle"),Ue=Me[0].height,He=Me[0].trace.legendgroup,et=te(Me,xe,k);ee&&He!==""&&(et=Ae[He]);var at=de?k:ct||et;!Q&&!D&&(at+=j/2),p.setRect(Ce,0,-Ue/2,at,Ue)})}function ne(se,ye,me,xe){var Re=se._fullLayout,ke=Re[ye],Ie=ae(ke),Q=B(ke),ee=ke.xref==="paper",D=ke.yref==="paper";se._fullLayout._reservedMargin[ye]={};var le=ke.y<.5?"b":"t",ge=ke.x<.5?"l":"r",j={r:Re.width-me,l:me+ke._width,b:Re.height-xe,t:xe+ke._effHeight};if(ee&&D)return s.autoMargin(se,ye,{x:ke.x,y:ke.y,l:ke._width*S[Ie],r:ke._width*M[Ie],b:ke._effHeight*M[Q],t:ke._effHeight*S[Q]});ee?se._fullLayout._reservedMargin[ye][le]=j[le]:D||ke.orientation==="v"?se._fullLayout._reservedMargin[ye][ge]=j[ge]:se._fullLayout._reservedMargin[ye][le]=j[le]}function ae(se){return i.isRightAnchor(se)?"right":i.isCenterAnchor(se)?"center":"left"}function B(se){return i.isBottomAnchor(se)?"bottom":i.isMiddleAnchor(se)?"middle":"top"}function ie(se){return se._id||"legend"}}),eu=t(W=>{var V=l(),d=q(),i=ft(),s=Mt(),f=s.pushUnique,u=s.strTranslate,h=s.strRotate,p=xn(),v=ja(),o=br(),w=Ra(),g=Xt(),b=Ot(),L=Ja(),S=kn().zindexSeparator,M=an(),T=So(),C=Ht(),m=Xa(),y=tc(),A=C.YANGLE,R=Math.PI*A/180,N=1/Math.sin(R),te=Math.cos(R),H=Math.sin(R),U=C.HOVERARROWSIZE,P=C.HOVERTEXTPAD,re={box:!0,ohlc:!0,violin:!0,candlestick:!0},G={scatter:!0,scattergl:!0,splom:!0};function Z(k,F){return k.distance-F.distance}W.hover=function(k,F,J,K){k=s.getGraphDiv(k);var ve=F.target;s.throttle(k._fullLayout._uid+C.HOVERID,C.HOVERMINTIME,function(){Y(k,F,J,K,ve)})},W.loneHover=function(k,F){var J=!0;Array.isArray(k)||(J=!1,k=[k]);var K=F.gd,ve=le(K),Te=ge(K),Ae=k.map(function(we){var je=we._x0||we.x0||we.x||0,ot=we._x1||we.x1||we.x||0,vt=we._y0||we.y0||we.y||0,Lt=we._y1||we.y1||we.y||0,Tt=we.eventData;if(Tt){var kt=Math.min(je,ot),Nt=Math.max(je,ot),Pt=Math.min(vt,Lt),Wt=Math.max(vt,Lt),St=we.trace;if(M.traceIs(St,"gl3d")){var Qt=K._fullLayout[St.scene]._scene.container,rr=Qt.offsetLeft,Jt=Qt.offsetTop;kt+=rr,Nt+=rr,Pt+=Jt,Wt+=Jt}Tt.bbox={x0:kt+Te,x1:Nt+Te,y0:Pt+ve,y1:Wt+ve},F.inOut_bbox&&F.inOut_bbox.push(Tt.bbox)}else Tt=!1;return{color:we.color||g.defaultLine,x0:we.x0||we.x||0,x1:we.x1||we.x||0,y0:we.y0||we.y||0,y1:we.y1||we.y||0,xLabel:we.xLabel,yLabel:we.yLabel,zLabel:we.zLabel,text:we.text,name:we.name,idealAlign:we.idealAlign,borderColor:we.borderColor,fontFamily:we.fontFamily,fontSize:we.fontSize,fontColor:we.fontColor,fontWeight:we.fontWeight,fontStyle:we.fontStyle,fontVariant:we.fontVariant,nameLength:we.nameLength,textAlign:we.textAlign,trace:we.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:we.hovertemplate||!1,hovertemplateLabels:we.hovertemplateLabels||!1,eventData:Tt}}),Fe=!1,Ge=ae(Ae,{gd:K,hovermode:"closest",rotateLabels:Fe,bgColor:F.bgColor||g.background,container:V.select(F.container),outerContainer:F.outerContainer||F.container}),rt=Ge.hoverLabels,bt=5,ht=0,ct=0;rt.sort(function(we,je){return we.y0-je.y0}).each(function(we,je){var ot=we.y0-we.by/2;ot-bt<ht?we.offset=ht-ot+bt:we.offset=0,ht=ot+we.by+we.offset,je===F.anchorIndex&&(ct=we.offset)}).each(function(we){we.offset-=ct});var Oe=K._fullLayout._invScaleX,ze=K._fullLayout._invScaleY;return me(rt,Fe,Oe,ze),J?rt:rt.node()};function Y(k,F,J,K,ve){J||(J="xy"),typeof J=="string"&&(J=J.split(S)[0]);var Te=Array.isArray(J)?J:[J],Ae,Fe=k._fullLayout,Ge=Fe.hoversubplots,rt=Fe._plots||[],bt=rt[J],ht=Fe._has("cartesian"),ct=F.hovermode||Fe.hovermode,Oe=(ct||"").charAt(0)==="x",ze=(ct||"").charAt(0)==="y",we,je;if(ht&&(Oe||ze)&&Ge==="axis"){for(var ot=Te.length,vt=0;vt<ot;vt++)if(Ae=Te[vt],rt[Ae]){we=L.getFromId(k,Ae,"x"),je=L.getFromId(k,Ae,"y");var Lt=(Oe?we:je)._subplotsWith;if(Lt&&Lt.length)for(var Tt=0;Tt<Lt.length;Tt++)f(Te,Lt[Tt])}}if(bt&&Ge!=="single"){var kt=bt.overlays.map(function(An){return An.id});Te=Te.concat(kt)}for(var Nt=Te.length,Pt=new Array(Nt),Wt=new Array(Nt),St=!1,Qt=0;Qt<Nt;Qt++)if(Ae=Te[Qt],rt[Ae])St=!0,Pt[Qt]=rt[Ae].xaxis,Wt[Qt]=rt[Ae].yaxis;else if(Fe[Ae]&&Fe[Ae]._subplot){var rr=Fe[Ae]._subplot;Pt[Qt]=rr.xaxis,Wt[Qt]=rr.yaxis}else{s.warn("Unrecognized subplot: "+Ae);return}if(ct&&!St&&(ct="closest"),["x","y","closest","x unified","y unified"].indexOf(ct)===-1||!k.calcdata||k.querySelector(".zoombox")||k._dragging)return b.unhoverRaw(k,F);var Jt=Fe.hoverdistance;Jt===-1&&(Jt=1/0);var sr=Fe.spikedistance;sr===-1&&(sr=1/0);var De=[],Je=[],de,Me,Ce,Ue,He,et,at,xt,mt,yt,It,zt,Ut,or={hLinePoint:null,vLinePoint:null},xr=!1;if(Array.isArray(F))for(ct="array",Ce=0;Ce<F.length;Ce++)He=k.calcdata[F[Ce].curveNumber||0],He&&(et=He[0].trace,He[0].trace.hoverinfo!=="skip"&&(Je.push(He),et.orientation==="h"&&(xr=!0)));else{var zr=k.calcdata.slice();for(zr.sort(function(An,Va){var Pa=An[0].trace.zorder||0,In=Va[0].trace.zorder||0;return Pa-In}),Ue=0;Ue<zr.length;Ue++)He=zr[Ue],et=He[0].trace,et.hoverinfo!=="skip"&&T.isTraceInSubplots(et,Te)&&(Je.push(He),et.orientation==="h"&&(xr=!0));var Br=!ve,Gr,wr;if(Br)"xpx"in F?Gr=F.xpx:Gr=Pt[0]._length/2,"ypx"in F?wr=F.ypx:wr=Wt[0]._length/2;else{if(p.triggerHandler(k,"plotly_beforehover",F)===!1)return;var lr=ve.getBoundingClientRect();Gr=F.clientX-lr.left,wr=F.clientY-lr.top,Fe._calcInverseTransform(k);var Dr=s.apply3DTransform(Fe._invTransform)(Gr,wr);if(Gr=Dr[0],wr=Dr[1],Gr<0||Gr>Pt[0]._length||wr<0||wr>Wt[0]._length)return b.unhoverRaw(k,F)}if(F.pointerX=Gr+Pt[0]._offset,F.pointerY=wr+Wt[0]._offset,"xval"in F?de=T.flat(Te,F.xval):de=T.p2c(Pt,Gr),"yval"in F?Me=T.flat(Te,F.yval):Me=T.p2c(Wt,wr),!d(de[0])||!d(Me[0]))return s.warn("Fx.hover failed",F,k),b.unhoverRaw(k,F)}var Hr=1/0;function Rr(An,Va){for(Ue=0;Ue<Je.length;Ue++)if(He=Je[Ue],!(!He||!He[0]||!He[0].trace)&&(et=He[0].trace,!(et.visible!==!0||et._length===0)&&["carpet","contourcarpet"].indexOf(et._module.name)===-1)){if(mt=ct,T.isUnifiedHover(mt)&&(mt=mt.charAt(0)),et.type==="splom"?(xt=0,at=Te[xt]):(at=T.getSubplot(et),xt=Te.indexOf(at)),zt={cd:He,trace:et,xa:Pt[xt],ya:Wt[xt],maxHoverDistance:Jt,maxSpikeDistance:sr,index:!1,distance:Math.min(Hr,Jt),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:g.defaultLine,name:et.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},Fe[at]&&(zt.subplot=Fe[at]._subplot),Fe._splomScenes&&Fe._splomScenes[et.uid]&&(zt.scene=Fe._splomScenes[et.uid]),mt==="array"){var Pa=F[Ue];"pointNumber"in Pa?(zt.index=Pa.pointNumber,mt="closest"):(mt="","xval"in Pa&&(yt=Pa.xval,mt="x"),"yval"in Pa&&(It=Pa.yval,mt=mt?"closest":"y"))}else An!==void 0&&Va!==void 0?(yt=An,It=Va):(yt=de[xt],It=Me[xt]);if(Ut=De.length,Jt!==0)if(et._module&&et._module.hoverPoints){var In=et._module.hoverPoints(zt,yt,It,mt,{finiteRange:!0,hoverLayer:Fe._hoverlayer,hoversubplots:Ge,gd:k});if(In)for(var Oa,Ua=0;Ua<In.length;Ua++)Oa=In[Ua],d(Oa.x0)&&d(Oa.y0)&&De.push(xe(Oa,ct))}else s.log("Unrecognized trace type in hover:",et);if(ct==="closest"&&De.length>Ut&&(De.splice(0,Ut),Hr=De[0].distance),ht&&sr!==0&&De.length===0){zt.distance=sr,zt.index=!1;var Na=et._module.hoverPoints(zt,yt,It,"closest",{hoverLayer:Fe._hoverlayer});if(Na&&(Na=Na.filter(function(ba){return ba.spikeDistance<=sr})),Na&&Na.length){var ii,Ii=Na.filter(function(ba){return ba.xa.showspikes&&ba.xa.spikesnap!=="hovered data"});if(Ii.length){var ea=Ii[0];d(ea.x0)&&d(ea.y0)&&(ii=Er(ea),(!or.vLinePoint||or.vLinePoint.spikeDistance>ii.spikeDistance)&&(or.vLinePoint=ii))}var _a=Na.filter(function(ba){return ba.ya.showspikes&&ba.ya.spikesnap!=="hovered data"});if(_a.length){var ca=_a[0];d(ca.x0)&&d(ca.y0)&&(ii=Er(ca),(!or.hLinePoint||or.hLinePoint.spikeDistance>ii.spikeDistance)&&(or.hLinePoint=ii))}}}}}Rr();function Ar(An,Va,Pa){for(var In=null,Oa=1/0,Ua,Na=0;Na<An.length;Na++)we&&we._id!==An[Na].xa._id||je&&je._id!==An[Na].ya._id||(Ua=An[Na].spikeDistance,Pa&&Na===0&&(Ua=-1/0),Ua<=Oa&&Ua<=Va&&(In=An[Na],Oa=Ua));return In}function Er(An){return An?{xa:An.xa,ya:An.ya,x:An.xSpike!==void 0?An.xSpike:(An.x0+An.x1)/2,y:An.ySpike!==void 0?An.ySpike:(An.y0+An.y1)/2,distance:An.distance,spikeDistance:An.spikeDistance,curveNumber:An.trace.index,color:An.color,pointNumber:An.index}:null}var _r={fullLayout:Fe,container:Fe._hoverlayer,event:F};k._spikepoints;var rn={vLinePoint:or.vLinePoint,hLinePoint:or.hLinePoint};k._spikepoints=rn;var gn=function(){var An=De.filter(function(Pa){return we&&we._id===Pa.xa._id&&je&&je._id===Pa.ya._id}),Va=De.filter(function(Pa){return!(we&&we._id===Pa.xa._id&&je&&je._id===Pa.ya._id)});An.sort(Z),Va.sort(Z),De=An.concat(Va),De=ee(De,ct)};gn();var Ur=ct.charAt(0),vn=(Ur==="x"||Ur==="y")&&De[0]&&G[De[0].trace.type];if(ht&&sr!==0&&De.length!==0){var Cn=De.filter(function(An){return An.ya.showspikes}),Vn=Ar(Cn,sr,vn);or.hLinePoint=Er(Vn);var Gn=De.filter(function(An){return An.xa.showspikes}),sn=Ar(Gn,sr,vn);or.vLinePoint=Er(sn)}if(De.length===0){var Fn=b.unhoverRaw(k,F);return ht&&(or.hLinePoint!==null||or.vLinePoint!==null)&&Ie()&&Re(k,or,_r),Fn}if(ht&&Ie()&&Re(k,or,_r),T.isXYhover(mt)&&De[0].length!==0&&De[0].trace.type!=="splom"){var Tn=De[0];re[Tn.trace.type]?De=De.filter(function(An){return An.trace.index===Tn.trace.index}):De=[Tn];var Mr=De.length,oa=D("x",Tn,Fe),pe=D("y",Tn,Fe);Rr(oa,pe);var he=[],Ye={},tt=0,lt=function(An){var Va=re[An.trace.type]?X(An):An.trace.index;if(!Ye[Va])tt++,Ye[Va]=tt,he.push(An);else{var Pa=Ye[Va]-1,In=he[Pa];Pa>0&&Math.abs(An.distance)<Math.abs(In.distance)&&(he[Pa]=An)}},We;for(We=0;We<Mr;We++)lt(De[We]);for(We=De.length-1;We>Mr-1;We--)lt(De[We]);De=he,gn()}var Ze=k._hoverdata,dt=[],it=le(k),At=ge(k);for(Ce=0;Ce<De.length;Ce++){var Rt=De[Ce],Yt=T.makeEventData(Rt,Rt.trace,Rt.cd);if(Rt.hovertemplate!==!1){var pr=!1;Rt.cd[Rt.index]&&Rt.cd[Rt.index].ht&&(pr=Rt.cd[Rt.index].ht),Rt.hovertemplate=pr||Rt.trace.hovertemplate||!1}if(Rt.xa&&Rt.ya){var fr=Rt.x0+Rt.xa._offset,Sr=Rt.x1+Rt.xa._offset,hr=Rt.y0+Rt.ya._offset,Cr=Rt.y1+Rt.ya._offset,Fr=Math.min(fr,Sr),Un=Math.max(fr,Sr),on=Math.min(hr,Cr),la=Math.max(hr,Cr);Yt.bbox={x0:Fr+At,x1:Un+At,y0:on+it,y1:la+it}}Rt.eventData=[Yt],dt.push(Yt)}k._hoverdata=dt;var bn=ct==="y"&&(Je.length>1||De.length>1)||ct==="closest"&&xr&&De.length>1,ha=g.combine(Fe.plot_bgcolor||g.background,Fe.paper_bgcolor),sa=ae(De,{gd:k,hovermode:ct,rotateLabels:bn,bgColor:ha,container:Fe._hoverlayer,outerContainer:Fe._paper.node(),commonLabelOpts:Fe.hoverlabel,hoverdistance:Fe.hoverdistance}),Fa=sa.hoverLabels;if(T.isUnifiedHover(ct)||(ie(Fa,bn,Fe,sa.commonLabelBoundingBox),me(Fa,bn,Fe._invScaleX,Fe._invScaleY)),ve&&ve.tagName){var ka=M.getComponentMethod("annotations","hasClickToShow")(k,dt);o(V.select(ve),ka?"pointer":"")}!ve||K||!ke(k,F,Ze)||(Ze&&k.emit("plotly_unhover",{event:F,points:Ze}),k.emit("plotly_hover",{event:F,points:k._hoverdata,xaxes:Pt,yaxes:Wt,xvals:de,yvals:Me}))}function X(k){return[k.trace.index,k.index,k.x0,k.y0,k.name,k.attr,k.xa?k.xa._id:"",k.ya?k.ya._id:""].join(",")}var ne=/<extra>([\s\S]*)<\/extra>/;function ae(k,F){var J=F.gd,K=J._fullLayout,ve=F.hovermode,Te=F.rotateLabels,Ae=F.bgColor,Fe=F.container,Ge=F.outerContainer,rt=F.commonLabelOpts||{};if(k.length===0)return[[]];var bt=F.fontFamily||C.HOVERFONT,ht=F.fontSize||C.HOVERFONTSIZE,ct=F.fontWeight||K.font.weight,Oe=F.fontStyle||K.font.style,ze=F.fontVariant||K.font.variant,we=F.fontTextcase||K.font.textcase,je=F.fontLineposition||K.font.lineposition,ot=F.fontShadow||K.font.shadow,vt=k[0],Lt=vt.xa,Tt=vt.ya,kt=ve.charAt(0),Nt=kt+"Label",Pt=vt[Nt];if(Pt===void 0&&Lt.type==="multicategory")for(var Wt=0;Wt<k.length&&(Pt=k[Wt][Nt],Pt===void 0);Wt++);var St=j(J,Ge),Qt=St.top,rr=St.width,Jt=St.height,sr=Pt!==void 0&&vt.distance<=F.hoverdistance&&(ve==="x"||ve==="y");if(sr){var De=!0,Je,de;for(Je=0;Je<k.length;Je++)if(De&&k[Je].zLabel===void 0&&(De=!1),de=k[Je].hoverinfo||k[Je].trace.hoverinfo,de){var Me=Array.isArray(de)?de:de.split("+");if(Me.indexOf("all")===-1&&Me.indexOf(ve)===-1){sr=!1;break}}De&&(sr=!1)}var Ce=Fe.selectAll("g.axistext").data(sr?[0]:[]);Ce.enter().append("g").classed("axistext",!0),Ce.exit().remove();var Ue={minX:0,maxX:0,minY:0,maxY:0};if(Ce.each(function(){var Mr=V.select(this),oa=s.ensureSingle(Mr,"path","",function(bn){bn.style({"stroke-width":"1px"})}),pe=s.ensureSingle(Mr,"text","",function(bn){bn.attr("data-notex",1)}),he=rt.bgcolor||g.defaultLine,Ye=rt.bordercolor||g.contrast(he),tt=g.contrast(he),lt=rt.font,We={weight:lt.weight||ct,style:lt.style||Oe,variant:lt.variant||ze,textcase:lt.textcase||we,lineposition:lt.lineposition||je,shadow:lt.shadow||ot,family:lt.family||bt,size:lt.size||ht,color:lt.color||tt};oa.style({fill:he,stroke:Ye}),pe.text(Pt).call(w.font,We).call(v.positionText,0,0).call(v.convertToTspans,J),Mr.attr("transform","");var Ze=j(J,pe.node()),dt,it;if(ve==="x"){var At=Lt.side==="top"?"-":"";pe.attr("text-anchor","middle").call(v.positionText,0,Lt.side==="top"?Qt-Ze.bottom-U-P:Qt-Ze.top+U+P),dt=Lt._offset+(vt.x0+vt.x1)/2,it=Tt._offset+(Lt.side==="top"?0:Tt._length);var Rt=Ze.width/2+P,Yt=dt;dt<Rt?Yt=Rt:dt>K.width-Rt&&(Yt=K.width-Rt),oa.attr("d","M"+(dt-Yt)+",0L"+(dt-Yt+U)+","+At+U+"H"+Rt+"v"+At+(P*2+Ze.height)+"H"+-Rt+"V"+At+U+"H"+(dt-Yt-U)+"Z"),dt=Yt,Ue.minX=dt-Rt,Ue.maxX=dt+Rt,Lt.side==="top"?(Ue.minY=it-(P*2+Ze.height),Ue.maxY=it-P):(Ue.minY=it+P,Ue.maxY=it+(P*2+Ze.height))}else{var pr,fr,Sr;Tt.side==="right"?(pr="start",fr=1,Sr="",dt=Lt._offset+Lt._length):(pr="end",fr=-1,Sr="-",dt=Lt._offset),it=Tt._offset+(vt.y0+vt.y1)/2,pe.attr("text-anchor",pr),oa.attr("d","M0,0L"+Sr+U+","+U+"V"+(P+Ze.height/2)+"h"+Sr+(P*2+Ze.width)+"V-"+(P+Ze.height/2)+"H"+Sr+U+"V-"+U+"Z"),Ue.minY=it-(P+Ze.height/2),Ue.maxY=it+(P+Ze.height/2),Tt.side==="right"?(Ue.minX=dt+U,Ue.maxX=dt+U+(P*2+Ze.width)):(Ue.minX=dt-U-(P*2+Ze.width),Ue.maxX=dt-U);var hr=Ze.height/2,Cr=Qt-Ze.top-hr,Fr="clip"+K._uid+"commonlabel"+Tt._id,Un;if(dt<Ze.width+2*P+U){Un="M-"+(U+P)+"-"+hr+"h-"+(Ze.width-P)+"V"+hr+"h"+(Ze.width-P)+"Z";var on=Ze.width-dt+P;v.positionText(pe,on,Cr),pr==="end"&&pe.selectAll("tspan").each(function(){var bn=V.select(this),ha=w.tester.append("text").text(bn.text()).call(w.font,We),sa=j(J,ha.node());Math.round(sa.width)<Math.round(Ze.width)&&bn.attr("x",on-sa.width),ha.remove()})}else v.positionText(pe,fr*(P+U),Cr),Un=null;var la=K._topclips.selectAll("#"+Fr).data(Un?[0]:[]);la.enter().append("clipPath").attr("id",Fr).append("path"),la.exit().remove(),la.select("path").attr("d",Un),w.setClipUrl(pe,Un?Fr:null,J)}Mr.attr("transform",u(dt,it))}),T.isUnifiedHover(ve)){Fe.selectAll("g.hovertext").remove();var He=k.filter(function(Mr){return Mr.hoverinfo!=="none"});if(He.length===0)return[];var et=K.hoverlabel,at=et.font,xt=He[0],mt=((ve==="x unified"?xt.xa:xt.ya).unifiedhovertitle||{}).text,yt=mt?s.hovertemplateString(mt,{},K._d3locale,ve==="x unified"?{xa:xt.xa,x:xt.xVal}:{ya:xt.ya,y:xt.yVal}):Pt,It={showlegend:!0,legend:{title:{text:yt,font:at},font:at,bgcolor:et.bgcolor,bordercolor:et.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:K.legend?K.legend.traceorder:void 0,orientation:"v"}},zt={font:at};m(It,zt,J._fullData);var Ut=zt.legend;Ut.entries=[];for(var or=0;or<He.length;or++){var xr=He[or];if(xr.hoverinfo!=="none"){var zr=B(xr,!0,ve,K,Pt),Br=zr[0],Gr=zr[1];xr.name=Gr,Gr!==""?xr.text=Gr+" : "+Br:xr.text=Br;var wr=xr.cd[xr.index];wr&&(wr.mc&&(xr.mc=wr.mc),wr.mcc&&(xr.mc=wr.mcc),wr.mlc&&(xr.mlc=wr.mlc),wr.mlcc&&(xr.mlc=wr.mlcc),wr.mlw&&(xr.mlw=wr.mlw),wr.mrc&&(xr.mrc=wr.mrc),wr.dir&&(xr.dir=wr.dir)),xr._distinct=!0,Ut.entries.push([xr])}}Ut.entries.sort(function(Mr,oa){return Mr[0].trace.index-oa[0].trace.index}),Ut.layer=Fe,Ut._inHover=!0,Ut._groupTitleFont=et.grouptitlefont,y(J,Ut);var lr=Fe.select("g.legend"),Dr=j(J,lr.node()),Hr=Dr.width+2*P,Rr=Dr.height+2*P,Ar=He[0],Er=(Ar.x0+Ar.x1)/2,_r=(Ar.y0+Ar.y1)/2,rn=!(M.traceIs(Ar.trace,"bar-like")||M.traceIs(Ar.trace,"box-violin")),gn,Ur;kt==="y"?rn?(Ur=_r-P,gn=_r+P):(Ur=Math.min.apply(null,He.map(function(Mr){return Math.min(Mr.y0,Mr.y1)})),gn=Math.max.apply(null,He.map(function(Mr){return Math.max(Mr.y0,Mr.y1)}))):Ur=gn=s.mean(He.map(function(Mr){return(Mr.y0+Mr.y1)/2}))-Rr/2;var vn,Cn;kt==="x"?rn?(vn=Er+P,Cn=Er-P):(vn=Math.max.apply(null,He.map(function(Mr){return Math.max(Mr.x0,Mr.x1)})),Cn=Math.min.apply(null,He.map(function(Mr){return Math.min(Mr.x0,Mr.x1)}))):vn=Cn=s.mean(He.map(function(Mr){return(Mr.x0+Mr.x1)/2}))-Hr/2;var Vn=Lt._offset,Gn=Tt._offset;gn+=Gn,vn+=Vn,Cn+=Vn-Hr,Ur+=Gn-Rr;var sn,Fn;return vn+Hr<rr&&vn>=0?sn=vn:Cn+Hr<rr&&Cn>=0?sn=Cn:Vn+Hr<rr?sn=Vn:vn-Er<Er-Cn+Hr?sn=rr-Hr:sn=0,sn+=P,gn+Rr<Jt&&gn>=0?Fn=gn:Ur+Rr<Jt&&Ur>=0?Fn=Ur:Gn+Rr<Jt?Fn=Gn:gn-_r<_r-Ur+Rr?Fn=Jt-Rr:Fn=0,Fn+=P,lr.attr("transform",u(sn-1,Fn-1)),lr}var Tn=Fe.selectAll("g.hovertext").data(k,function(Mr){return X(Mr)});return Tn.enter().append("g").classed("hovertext",!0).each(function(){var Mr=V.select(this);Mr.append("rect").call(g.fill,g.addOpacity(Ae,.8)),Mr.append("text").classed("name",!0),Mr.append("path").style("stroke-width","1px"),Mr.append("text").classed("nums",!0).call(w.font,{weight:ct,style:Oe,variant:ze,textcase:we,lineposition:je,shadow:ot,family:bt,size:ht})}),Tn.exit().remove(),Tn.each(function(Mr){var oa=V.select(this).attr("transform",""),pe=Mr.color;Array.isArray(pe)&&(pe=pe[Mr.eventData[0].pointNumber]);var he=Mr.bgcolor||pe,Ye=g.combine(g.opacity(he)?he:g.defaultLine,Ae),tt=g.combine(g.opacity(pe)?pe:g.defaultLine,Ae),lt=Mr.borderColor||g.contrast(Ye),We=B(Mr,sr,ve,K,Pt,oa),Ze=We[0],dt=We[1],it=oa.select("text.nums").call(w.font,{family:Mr.fontFamily||bt,size:Mr.fontSize||ht,color:Mr.fontColor||lt,weight:Mr.fontWeight||ct,style:Mr.fontStyle||Oe,variant:Mr.fontVariant||ze,textcase:Mr.fontTextcase||we,lineposition:Mr.fontLineposition||je,shadow:Mr.fontShadow||ot}).text(Ze).attr("data-notex",1).call(v.positionText,0,0).call(v.convertToTspans,J),At=oa.select("text.name"),Rt=0,Yt=0;if(dt&&dt!==Ze){At.call(w.font,{family:Mr.fontFamily||bt,size:Mr.fontSize||ht,color:tt,weight:Mr.fontWeight||ct,style:Mr.fontStyle||Oe,variant:Mr.fontVariant||ze,textcase:Mr.fontTextcase||we,lineposition:Mr.fontLineposition||je,shadow:Mr.fontShadow||ot}).text(dt).attr("data-notex",1).call(v.positionText,0,0).call(v.convertToTspans,J);var pr=j(J,At.node());Rt=pr.width+2*P,Yt=pr.height+2*P}else At.remove(),oa.select("rect").remove();oa.select("path").style({fill:Ye,stroke:lt});var fr=Mr.xa._offset+(Mr.x0+Mr.x1)/2,Sr=Mr.ya._offset+(Mr.y0+Mr.y1)/2,hr=Math.abs(Mr.x1-Mr.x0),Cr=Math.abs(Mr.y1-Mr.y0),Fr=j(J,it.node()),Un=Fr.width/K._invScaleX,on=Fr.height/K._invScaleY;Mr.ty0=(Qt-Fr.top)/K._invScaleY,Mr.bx=Un+2*P,Mr.by=Math.max(on+2*P,Yt),Mr.anchor="start",Mr.txwidth=Un,Mr.tx2width=Rt,Mr.offset=0;var la=(Un+U+P+Rt)*K._invScaleX,bn,ha;if(Te)Mr.pos=fr,bn=Sr+Cr/2+la<=Jt,ha=Sr-Cr/2-la>=0,(Mr.idealAlign==="top"||!bn)&&ha?(Sr-=Cr/2,Mr.anchor="end"):bn?(Sr+=Cr/2,Mr.anchor="start"):Mr.anchor="middle",Mr.crossPos=Sr;else{if(Mr.pos=Sr,bn=fr+hr/2+la<=rr,ha=fr-hr/2-la>=0,(Mr.idealAlign==="left"||!bn)&&ha)fr-=hr/2,Mr.anchor="end";else if(bn)fr+=hr/2,Mr.anchor="start";else{Mr.anchor="middle";var sa=la/2,Fa=fr+sa-rr,ka=fr-sa;Fa>0&&(fr-=Fa),ka<0&&(fr+=-ka)}Mr.crossPos=fr}it.attr("text-anchor",Mr.anchor),Rt&&At.attr("text-anchor",Mr.anchor),oa.attr("transform",u(fr,Sr)+(Te?h(A):""))}),{hoverLabels:Tn,commonLabelBoundingBox:Ue}}function B(k,F,J,K,ve,Te){var Ae="",Fe="";k.nameOverride!==void 0&&(k.name=k.nameOverride),k.name&&(k.trace._meta&&(k.name=s.templateString(k.name,k.trace._meta)),Ae=Q(k.name,k.nameLength));var Ge=J.charAt(0),rt=Ge==="x"?"y":"x";k.zLabel!==void 0?(k.xLabel!==void 0&&(Fe+="x: "+k.xLabel+"<br>"),k.yLabel!==void 0&&(Fe+="y: "+k.yLabel+"<br>"),k.trace.type!=="choropleth"&&k.trace.type!=="choroplethmapbox"&&k.trace.type!=="choroplethmap"&&(Fe+=(Fe?"z: ":"")+k.zLabel)):F&&k[Ge+"Label"]===ve?Fe=k[rt+"Label"]||"":k.xLabel===void 0?k.yLabel!==void 0&&k.trace.type!=="scattercarpet"&&(Fe=k.yLabel):k.yLabel===void 0?Fe=k.xLabel:Fe="("+k.xLabel+", "+k.yLabel+")",(k.text||k.text===0)&&!Array.isArray(k.text)&&(Fe+=(Fe?"<br>":"")+k.text),k.extraText!==void 0&&(Fe+=(Fe?"<br>":"")+k.extraText),Te&&Fe===""&&!k.hovertemplate&&(Ae===""&&Te.remove(),Fe=Ae);var bt=k.hovertemplate||!1;if(bt){var ht=k.hovertemplateLabels||k;k[Ge+"Label"]!==ve&&(ht[Ge+"other"]=ht[Ge+"Val"],ht[Ge+"otherLabel"]=ht[Ge+"Label"]),Fe=s.hovertemplateString(bt,ht,K._d3locale,k.eventData[0]||{},k.trace._meta),Fe=Fe.replace(ne,function(ct,Oe){return Ae=Q(Oe,k.nameLength),""})}return[Fe,Ae]}function ie(k,F,J,K){var ve=F?"xa":"ya",Te=F?"ya":"xa",Ae=0,Fe=1,Ge=k.size(),rt=new Array(Ge),bt=0,ht=K.minX,ct=K.maxX,Oe=K.minY,ze=K.maxY,we=function(de){return de*J._invScaleX},je=function(de){return de*J._invScaleY};k.each(function(de){var Me=de[ve],Ce=de[Te],Ue=Me._id.charAt(0)==="x",He=Me.range;bt===0&&He&&He[0]>He[1]!==Ue&&(Fe=-1);var et=0,at=Ue?J.width:J.height;if(J.hovermode==="x"||J.hovermode==="y"){var xt=se(de,F),mt=de.anchor,yt=mt==="end"?-1:1,It,zt;if(mt==="middle")It=de.crossPos+(Ue?je(xt.y-de.by/2):we(de.bx/2+de.tx2width/2)),zt=It+(Ue?je(de.by):we(de.bx));else if(Ue)It=de.crossPos+je(U+xt.y)-je(de.by/2-U),zt=It+je(de.by);else{var Ut=we(yt*U+xt.x),or=Ut+we(yt*de.bx);It=de.crossPos+Math.min(Ut,or),zt=de.crossPos+Math.max(Ut,or)}Ue?Oe!==void 0&&ze!==void 0&&Math.min(zt,ze)-Math.max(It,Oe)>1&&(Ce.side==="left"?(et=Ce._mainLinePosition,at=J.width):at=Ce._mainLinePosition):ht!==void 0&&ct!==void 0&&Math.min(zt,ct)-Math.max(It,ht)>1&&(Ce.side==="top"?(et=Ce._mainLinePosition,at=J.height):at=Ce._mainLinePosition)}rt[bt++]=[{datum:de,traceIndex:de.trace.index,dp:0,pos:de.pos,posref:de.posref,size:de.by*(Ue?N:1)/2,pmin:et,pmax:at}]}),rt.sort(function(de,Me){return de[0].posref-Me[0].posref||Fe*(Me[0].traceIndex-de[0].traceIndex)});var ot,vt,Lt,Tt,kt,Nt,Pt;function Wt(de){var Me=de[0],Ce=de[de.length-1];if(vt=Me.pmin-Me.pos-Me.dp+Me.size,Lt=Ce.pos+Ce.dp+Ce.size-Me.pmax,vt>.01){for(kt=de.length-1;kt>=0;kt--)de[kt].dp+=vt;ot=!1}if(!(Lt<.01)){if(vt<-.01){for(kt=de.length-1;kt>=0;kt--)de[kt].dp-=Lt;ot=!1}if(ot){var Ue=0;for(Tt=0;Tt<de.length;Tt++)Nt=de[Tt],Nt.pos+Nt.dp+Nt.size>Me.pmax&&Ue++;for(Tt=de.length-1;Tt>=0&&!(Ue<=0);Tt--)Nt=de[Tt],Nt.pos>Me.pmax-1&&(Nt.del=!0,Ue--);for(Tt=0;Tt<de.length&&!(Ue<=0);Tt++)if(Nt=de[Tt],Nt.pos<Me.pmin+1)for(Nt.del=!0,Ue--,Lt=Nt.size*2,kt=de.length-1;kt>=0;kt--)de[kt].dp-=Lt;for(Tt=de.length-1;Tt>=0&&!(Ue<=0);Tt--)Nt=de[Tt],Nt.pos+Nt.dp+Nt.size>Me.pmax&&(Nt.del=!0,Ue--)}}}for(;!ot&&Ae<=Ge;){for(Ae++,ot=!0,Tt=0;Tt<rt.length-1;){var St=rt[Tt],Qt=rt[Tt+1],rr=St[St.length-1],Jt=Qt[0];if(vt=rr.pos+rr.dp+rr.size-Jt.pos-Jt.dp+Jt.size,vt>.01){for(kt=Qt.length-1;kt>=0;kt--)Qt[kt].dp+=vt;for(St.push.apply(St,Qt),rt.splice(Tt+1,1),Pt=0,kt=St.length-1;kt>=0;kt--)Pt+=St[kt].dp;for(Lt=Pt/St.length,kt=St.length-1;kt>=0;kt--)St[kt].dp-=Lt;ot=!1}else Tt++}rt.forEach(Wt)}for(Tt=rt.length-1;Tt>=0;Tt--){var sr=rt[Tt];for(kt=sr.length-1;kt>=0;kt--){var De=sr[kt],Je=De.datum;Je.offset=De.dp,Je.del=De.del}}}function se(k,F){var J=0,K=k.offset;return F&&(K*=-H,J=k.offset*te),{x:J,y:K}}function ye(k){var F={start:1,end:-1,middle:0}[k.anchor],J=F*(U+P),K=J+F*(k.txwidth+P),ve=k.anchor==="middle";return ve&&(J-=k.tx2width/2,K+=k.txwidth/2+P),{alignShift:F,textShiftX:J,text2ShiftX:K}}function me(k,F,J,K){var ve=function(Ae){return Ae*J},Te=function(Ae){return Ae*K};k.each(function(Ae){var Fe=V.select(this);if(Ae.del)return Fe.remove();var Ge=Fe.select("text.nums"),rt=Ae.anchor,bt=rt==="end"?-1:1,ht=ye(Ae),ct=se(Ae,F),Oe=ct.x,ze=ct.y,we=rt==="middle",je="hoverlabel"in Ae.trace?Ae.trace.hoverlabel.showarrow:!0,ot;we?ot="M-"+ve(Ae.bx/2+Ae.tx2width/2)+","+Te(ze-Ae.by/2)+"h"+ve(Ae.bx)+"v"+Te(Ae.by)+"h-"+ve(Ae.bx)+"Z":je?ot="M0,0L"+ve(bt*U+Oe)+","+Te(U+ze)+"v"+Te(Ae.by/2-U)+"h"+ve(bt*Ae.bx)+"v-"+Te(Ae.by)+"H"+ve(bt*U+Oe)+"V"+Te(ze-U)+"Z":ot="M"+ve(bt*U+Oe)+","+Te(ze-Ae.by/2)+"h"+ve(bt*Ae.bx)+"v"+Te(Ae.by)+"h"+ve(-bt*Ae.bx)+"Z",Fe.select("path").attr("d",ot);var vt=Oe+ht.textShiftX,Lt=ze+Ae.ty0-Ae.by/2+P,Tt=Ae.textAlign||"auto";Tt!=="auto"&&(Tt==="left"&&rt!=="start"?(Ge.attr("text-anchor","start"),vt=we?-Ae.bx/2-Ae.tx2width/2+P:-Ae.bx-P):Tt==="right"&&rt!=="end"&&(Ge.attr("text-anchor","end"),vt=we?Ae.bx/2-Ae.tx2width/2-P:Ae.bx+P)),Ge.call(v.positionText,ve(vt),Te(Lt)),Ae.tx2width&&(Fe.select("text.name").call(v.positionText,ve(ht.text2ShiftX+ht.alignShift*P+Oe),Te(ze+Ae.ty0-Ae.by/2+P)),Fe.select("rect").call(w.setRect,ve(ht.text2ShiftX+(ht.alignShift-1)*Ae.tx2width/2+Oe),Te(ze-Ae.by/2-1),ve(Ae.tx2width),Te(Ae.by+2)))})}function xe(k,F){var J=k.index,K=k.trace||{},ve=k.cd[0],Te=k.cd[J]||{};function Ae(ct){return ct||d(ct)&&ct===0}var Fe=Array.isArray(J)?function(ct,Oe){var ze=s.castOption(ve,J,ct);return Ae(ze)?ze:s.extractOption({},K,"",Oe)}:function(ct,Oe){return s.extractOption(Te,K,ct,Oe)};function Ge(ct,Oe,ze){var we=Fe(Oe,ze);Ae(we)&&(k[ct]=we)}if(Ge("hoverinfo","hi","hoverinfo"),Ge("bgcolor","hbg","hoverlabel.bgcolor"),Ge("borderColor","hbc","hoverlabel.bordercolor"),Ge("fontFamily","htf","hoverlabel.font.family"),Ge("fontSize","hts","hoverlabel.font.size"),Ge("fontColor","htc","hoverlabel.font.color"),Ge("fontWeight","htw","hoverlabel.font.weight"),Ge("fontStyle","hty","hoverlabel.font.style"),Ge("fontVariant","htv","hoverlabel.font.variant"),Ge("nameLength","hnl","hoverlabel.namelength"),Ge("textAlign","hta","hoverlabel.align"),k.posref=F==="y"||F==="closest"&&K.orientation==="h"?k.xa._offset+(k.x0+k.x1)/2:k.ya._offset+(k.y0+k.y1)/2,k.x0=s.constrain(k.x0,0,k.xa._length),k.x1=s.constrain(k.x1,0,k.xa._length),k.y0=s.constrain(k.y0,0,k.ya._length),k.y1=s.constrain(k.y1,0,k.ya._length),k.xLabelVal!==void 0&&(k.xLabel="xLabel"in k?k.xLabel:L.hoverLabelText(k.xa,k.xLabelVal,K.xhoverformat),k.xVal=k.xa.c2d(k.xLabelVal)),k.yLabelVal!==void 0&&(k.yLabel="yLabel"in k?k.yLabel:L.hoverLabelText(k.ya,k.yLabelVal,K.yhoverformat),k.yVal=k.ya.c2d(k.yLabelVal)),k.zLabelVal!==void 0&&k.zLabel===void 0&&(k.zLabel=String(k.zLabelVal)),!isNaN(k.xerr)&&!(k.xa.type==="log"&&k.xerr<=0)){var rt=L.tickText(k.xa,k.xa.c2l(k.xerr),"hover").text;k.xerrneg!==void 0?k.xLabel+=" +"+rt+" / -"+L.tickText(k.xa,k.xa.c2l(k.xerrneg),"hover").text:k.xLabel+="  "+rt,F==="x"&&(k.distance+=1)}if(!isNaN(k.yerr)&&!(k.ya.type==="log"&&k.yerr<=0)){var bt=L.tickText(k.ya,k.ya.c2l(k.yerr),"hover").text;k.yerrneg!==void 0?k.yLabel+=" +"+bt+" / -"+L.tickText(k.ya,k.ya.c2l(k.yerrneg),"hover").text:k.yLabel+="  "+bt,F==="y"&&(k.distance+=1)}var ht=k.hoverinfo||k.trace.hoverinfo;return ht&&ht!=="all"&&(ht=Array.isArray(ht)?ht:ht.split("+"),ht.indexOf("x")===-1&&(k.xLabel=void 0),ht.indexOf("y")===-1&&(k.yLabel=void 0),ht.indexOf("z")===-1&&(k.zLabel=void 0),ht.indexOf("text")===-1&&(k.text=void 0),ht.indexOf("name")===-1&&(k.name=void 0)),k}function Re(k,F,J){var K=J.container,ve=J.fullLayout,Te=ve._size,Ae=J.event,Fe=!!F.hLinePoint,Ge=!!F.vLinePoint,rt,bt;if(K.selectAll(".spikeline").remove(),!!(Ge||Fe)){var ht=g.combine(ve.plot_bgcolor,ve.paper_bgcolor);if(Fe){var ct=F.hLinePoint,Oe,ze;rt=ct&&ct.xa,bt=ct&&ct.ya;var we=bt.spikesnap;we==="cursor"?(Oe=Ae.pointerX,ze=Ae.pointerY):(Oe=rt._offset+ct.x,ze=bt._offset+ct.y);var je=i.readability(ct.color,ht)<1.5?g.contrast(ht):ct.color,ot=bt.spikemode,vt=bt.spikethickness,Lt=bt.spikecolor||je,Tt=L.getPxPosition(k,bt),kt,Nt;if(ot.indexOf("toaxis")!==-1||ot.indexOf("across")!==-1){if(ot.indexOf("toaxis")!==-1&&(kt=Tt,Nt=Oe),ot.indexOf("across")!==-1){var Pt=bt._counterDomainMin,Wt=bt._counterDomainMax;bt.anchor==="free"&&(Pt=Math.min(Pt,bt.position),Wt=Math.max(Wt,bt.position)),kt=Te.l+Pt*Te.w,Nt=Te.l+Wt*Te.w}K.insert("line",":first-child").attr({x1:kt,x2:Nt,y1:ze,y2:ze,"stroke-width":vt,stroke:Lt,"stroke-dasharray":w.dashStyle(bt.spikedash,vt)}).classed("spikeline",!0).classed("crisp",!0),K.insert("line",":first-child").attr({x1:kt,x2:Nt,y1:ze,y2:ze,"stroke-width":vt+2,stroke:ht}).classed("spikeline",!0).classed("crisp",!0)}ot.indexOf("marker")!==-1&&K.insert("circle",":first-child").attr({cx:Tt+(bt.side!=="right"?vt:-vt),cy:ze,r:vt,fill:Lt}).classed("spikeline",!0)}if(Ge){var St=F.vLinePoint,Qt,rr;rt=St&&St.xa,bt=St&&St.ya;var Jt=rt.spikesnap;Jt==="cursor"?(Qt=Ae.pointerX,rr=Ae.pointerY):(Qt=rt._offset+St.x,rr=bt._offset+St.y);var sr=i.readability(St.color,ht)<1.5?g.contrast(ht):St.color,De=rt.spikemode,Je=rt.spikethickness,de=rt.spikecolor||sr,Me=L.getPxPosition(k,rt),Ce,Ue;if(De.indexOf("toaxis")!==-1||De.indexOf("across")!==-1){if(De.indexOf("toaxis")!==-1&&(Ce=Me,Ue=rr),De.indexOf("across")!==-1){var He=rt._counterDomainMin,et=rt._counterDomainMax;rt.anchor==="free"&&(He=Math.min(He,rt.position),et=Math.max(et,rt.position)),Ce=Te.t+(1-et)*Te.h,Ue=Te.t+(1-He)*Te.h}K.insert("line",":first-child").attr({x1:Qt,x2:Qt,y1:Ce,y2:Ue,"stroke-width":Je,stroke:de,"stroke-dasharray":w.dashStyle(rt.spikedash,Je)}).classed("spikeline",!0).classed("crisp",!0),K.insert("line",":first-child").attr({x1:Qt,x2:Qt,y1:Ce,y2:Ue,"stroke-width":Je+2,stroke:ht}).classed("spikeline",!0).classed("crisp",!0)}De.indexOf("marker")!==-1&&K.insert("circle",":first-child").attr({cx:Qt,cy:Me-(rt.side!=="top"?Je:-Je),r:Je,fill:de}).classed("spikeline",!0)}}}function ke(k,F,J){if(!J||J.length!==k._hoverdata.length)return!0;for(var K=J.length-1;K>=0;K--){var ve=J[K],Te=k._hoverdata[K];if(ve.curveNumber!==Te.curveNumber||String(ve.pointNumber)!==String(Te.pointNumber)||String(ve.pointNumbers)!==String(Te.pointNumbers)||ve.binNumber!==Te.binNumber)return!0}return!1}function Ie(k,F){return!0}function Q(k,F){return v.plainText(k||"",{len:F,allowedTags:["br","sub","sup","b","i","em","s","u"]})}function ee(k,F){for(var J=F.charAt(0),K=[],ve=[],Te=[],Ae=0;Ae<k.length;Ae++){var Fe=k[Ae];M.traceIs(Fe.trace,"bar-like")||M.traceIs(Fe.trace,"box-violin")?Te.push(Fe):Fe.trace[J+"period"]?ve.push(Fe):K.push(Fe)}return K.concat(ve).concat(Te)}function D(k,F,J){var K=F[k+"a"],ve=F[k+"Val"],Te=F.cd[0];if(K.type==="category"||K.type==="multicategory")ve=K._categoriesMap[ve];else if(K.type==="date"){var Ae=F.trace[k+"periodalignment"];if(Ae){var Fe=F.cd[F.index],Ge=Fe[k+"Start"];Ge===void 0&&(Ge=Fe[k]);var rt=Fe[k+"End"];rt===void 0&&(rt=Fe[k]);var bt=rt-Ge;Ae==="end"?ve+=bt:Ae==="middle"&&(ve+=bt/2)}ve=K.d2c(ve)}return Te&&Te.t&&Te.t.posLetter===K._id&&(J.boxmode==="group"||J.violinmode==="group")&&(ve+=Te.t.dPos),ve}function le(k){return k.offsetTop+k.clientTop}function ge(k){return k.offsetLeft+k.clientLeft}function j(k,F){var J=k._fullLayout,K=F.getBoundingClientRect(),ve=K.left,Te=K.top,Ae=ve+K.width,Fe=Te+K.height,Ge=s.apply3DTransform(J._invTransform)(ve,Te),rt=s.apply3DTransform(J._invTransform)(Ae,Fe),bt=Ge[0],ht=Ge[1],ct=rt[0],Oe=rt[1];return{x:bt,y:ht,width:ct-bt,height:Oe-ht,top:Math.min(ht,Oe),left:Math.min(bt,ct),right:Math.max(bt,ct),bottom:Math.max(ht,Oe)}}}),rf=t((W,V)=>{var d=Mt(),i=Xt(),s=So().isUnifiedHover;V.exports=function(f,u,h,p){p=p||{};var v=u.legend;function o(w){p.font[w]||(p.font[w]=v?u.legend.font[w]:u.font[w])}u&&s(u.hovermode)&&(p.font||(p.font={}),o("size"),o("family"),o("color"),o("weight"),o("style"),o("variant"),v?(p.bgcolor||(p.bgcolor=i.combine(u.legend.bgcolor,u.paper_bgcolor)),p.bordercolor||(p.bordercolor=u.legend.bordercolor)):p.bgcolor||(p.bgcolor=u.paper_bgcolor)),h("hoverlabel.bgcolor",p.bgcolor),h("hoverlabel.bordercolor",p.bordercolor),h("hoverlabel.namelength",p.namelength),h("hoverlabel.showarrow",p.showarrow),d.coerceFont(h,"hoverlabel.font",p.font),h("hoverlabel.align",p.align)}}),Z2=t((W,V)=>{var d=Mt(),i=rf(),s=ur();V.exports=function(f,u){function h(p,v){return d.coerce(f,u,s,p,v)}i(f,u,h)}}),Q2=t((W,V)=>{var d=Mt(),i=Ve(),s=rf();V.exports=function(f,u,h,p){function v(w,g){return d.coerce(f,u,i,w,g)}var o=d.extendFlat({},p.hoverlabel);u.hovertemplate&&(o.namelength=-1),s(f,u,v,o)}}),km=t((W,V)=>{var d=Mt(),i=ur();V.exports=function(s,f){function u(h,p){return f[h]!==void 0?f[h]:d.coerce(s,f,i,h,p)}return u("clickmode"),u("hoversubplots"),u("hovermode")}}),K2=t((W,V)=>{var d=Mt(),i=ur(),s=km(),f=rf();V.exports=function(u,h){function p(S,M){return d.coerce(u,h,i,S,M)}var v=s(u,h);v&&(p("hoverdistance"),p("spikedistance"));var o=p("dragmode");o==="select"&&p("selectdirection");var w=h._has("mapbox"),g=h._has("map"),b=h._has("geo"),L=h._basePlotModules.length;h.dragmode==="zoom"&&((w||g||b)&&L===1||(w||g)&&b&&L===2)&&(h.dragmode="pan"),f(u,h,p),d.coerceFont(p,"hoverlabel.grouptitlefont",h.hoverlabel.font)}}),$2=t((W,V)=>{var d=Mt(),i=an();V.exports=function(f){var u=f.calcdata,h=f._fullLayout;function p(b){return function(L){return d.coerceHoverinfo({hoverinfo:L},{_module:b._module},h)}}for(var v=0;v<u.length;v++){var o=u[v],w=o[0].trace;if(!i.traceIs(w,"pie-like")){var g=i.traceIs(w,"2dMap")?s:d.fillArray;g(w.hoverinfo,o,"hi",p(w)),w.hovertemplate&&g(w.hovertemplate,o,"ht"),w.hoverlabel&&(g(w.hoverlabel.bgcolor,o,"hbg"),g(w.hoverlabel.bordercolor,o,"hbc"),g(w.hoverlabel.font.size,o,"hts"),g(w.hoverlabel.font.color,o,"htc"),g(w.hoverlabel.font.family,o,"htf"),g(w.hoverlabel.font.weight,o,"htw"),g(w.hoverlabel.font.style,o,"hty"),g(w.hoverlabel.font.variant,o,"htv"),g(w.hoverlabel.namelength,o,"hnl"),g(w.hoverlabel.align,o,"hta"),g(w.hoverlabel.showarrow,o,"htsa"))}}};function s(f,u,h,p){p=p||d.identity,Array.isArray(f)&&(u[0][h]=p(f))}}),ex=t((W,V)=>{var d=an(),i=eu().hover;V.exports=function(s,f,u){var h=d.getComponentMethod("annotations","onClick")(s,s._hoverdata);u!==void 0&&i(s,f,u,!0);function p(){s.emit("plotly_click",{points:s._hoverdata,event:f})}s._hoverdata&&f&&f.target&&(h&&h.then?h.then(p):p(),f.stopImmediatePropagation&&f.stopImmediatePropagation())}}),ws=t((W,V)=>{var d=l(),i=Mt(),s=Ot(),f=So(),u=ur(),h=eu();V.exports={moduleType:"component",name:"fx",constants:Ht(),schema:{layout:u},attributes:Ve(),layoutAttributes:u,supplyLayoutGlobalDefaults:Z2(),supplyDefaults:Q2(),supplyLayoutDefaults:K2(),calc:$2(),getDistanceFunction:f.getDistanceFunction,getClosest:f.getClosest,inbox:f.inbox,quadrature:f.quadrature,appendArrayPointValue:f.appendArrayPointValue,castHoverOption:v,castHoverinfo:o,hover:h.hover,unhover:s.unhover,loneHover:h.loneHover,loneUnhover:p,click:ex()};function p(w){var g=i.isD3Selection(w)?w:d.select(w);g.selectAll("g.hovertext").remove(),g.selectAll(".spikeline").remove()}function v(w,g,b){return i.castOption(w,g,"hoverlabel."+b)}function o(w,g,b){function L(S){return i.coerceHoverinfo({hoverinfo:S},{_module:w._module},g)}return i.castOption(w,b,"hoverinfo",L)}}),tu=t(W=>{W.selectMode=function(V){return V==="lasso"||V==="select"},W.drawMode=function(V){return V==="drawclosedpath"||V==="drawopenpath"||V==="drawline"||V==="drawrect"||V==="drawcircle"},W.openMode=function(V){return V==="drawline"||V==="drawopenpath"},W.rectMode=function(V){return V==="select"||V==="drawline"||V==="drawrect"||V==="drawcircle"},W.freeMode=function(V){return V==="lasso"||V==="drawclosedpath"||V==="drawopenpath"},W.selectingOrDrawing=function(V){return W.freeMode(V)||W.rectMode(V)}}),nf=t((W,V)=>{V.exports=function(d){var i=d._fullLayout;i._glcanvas&&i._glcanvas.size()&&i._glcanvas.each(function(s){s.regl&&s.regl.clear({color:!0,depth:!0})})}}),af=t((W,V)=>{V.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:["<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'>"," <title>plotly-logomark</title>"," <g id='symbol'>","  <rect fill='#000' x='0' y='0' width='132' height='132' rx='18' ry='18'/>","  <circle fill='#9EF' cx='102' cy='30' r='6'/>","  <circle fill='#BAC' cx='78' cy='30' r='6'/>","  <circle fill='#BAC' cx='78' cy='54' r='6'/>","  <circle fill='#D69' cx='54' cy='30' r='6'/>","  <circle fill='#F26' cx='30' cy='30' r='6'/>","  <circle fill='#F26' cx='30' cy='54' r='6'/>","  <path fill='#FFF' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/>","  <path fill='#FFF' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/>","  <path fill='#FFF' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/>","  <path fill='#FFF' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/>"," </g>","</svg>"].join("")}}}),of=t((W,V)=>{var d=32;V.exports={CIRCLE_SIDES:d,i000:0,i090:d/4,i180:d/2,i270:d/4*3,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}}),sf=t((W,V)=>{var d=Mt().strTranslate;function i(h,p){switch(h.type){case"log":return h.p2d(p);case"date":return h.p2r(p,0,h.calendar);default:return h.p2r(p)}}function s(h,p){switch(h.type){case"log":return h.d2p(p);case"date":return h.r2p(p,0,h.calendar);default:return h.r2p(p)}}function f(h){var p=h._id.charAt(0)==="y"?1:0;return function(v){return i(h,v[p])}}function u(h){return d(h.xaxis._offset,h.yaxis._offset)}V.exports={p2r:i,r2p:s,axValue:f,getTransform:u}}),yl=t(W=>{var V=Kl(),d=of(),i=d.CIRCLE_SIDES,s=d.SQRT2,f=sf(),u=f.p2r,h=f.r2p,p=[0,3,4,5,6,1,2],v=[0,3,4,1,2];W.writePaths=function(g){var b=g.length;if(!b)return"M0,0Z";for(var L="",S=0;S<b;S++)for(var M=g[S].length,T=0;T<M;T++){var C=g[S][T][0];if(C==="Z")L+="Z";else for(var m=g[S][T].length,y=0;y<m;y++){var A=y;C==="Q"||C==="S"?A=v[y]:C==="C"&&(A=p[y]),L+=g[S][T][A],y>0&&y<m-1&&(L+=",")}}return L},W.readPaths=function(g,b,L,S){var M=V(g),T=[],C=-1,m=function(){C++,T[C]=[]},y,A=0,R=0,N,te,H=function(){N=A,te=R};H();for(var U=0;U<M.length;U++){var P=[],re,G,Z,Y,X=M[U][0],ne=X;switch(X){case"M":m(),A=+M[U][1],R=+M[U][2],P.push([ne,A,R]),H();break;case"Q":case"S":re=+M[U][1],Z=+M[U][2],A=+M[U][3],R=+M[U][4],P.push([ne,A,R,re,Z]);break;case"C":re=+M[U][1],Z=+M[U][2],G=+M[U][3],Y=+M[U][4],A=+M[U][5],R=+M[U][6],P.push([ne,A,R,re,Z,G,Y]);break;case"T":case"L":A=+M[U][1],R=+M[U][2],P.push([ne,A,R]);break;case"H":ne="L",A=+M[U][1],P.push([ne,A,R]);break;case"V":ne="L",R=+M[U][1],P.push([ne,A,R]);break;case"A":ne="L";var ae=+M[U][1],B=+M[U][2];+M[U][4]||(ae=-ae,B=-B);var ie=A-ae,se=R;for(y=1;y<=i/2;y++){var ye=2*Math.PI*y/i;P.push([ne,ie+ae*Math.cos(ye),se+B*Math.sin(ye)])}break;case"Z":(A!==N||R!==te)&&(A=N,R=te,P.push([ne,A,R]));break}for(var me=(L||{}).domain,xe=b._fullLayout._size,Re=L&&L.xsizemode==="pixel",ke=L&&L.ysizemode==="pixel",Ie=S===!1,Q=0;Q<P.length;Q++){for(y=0;y+2<7;y+=2){var ee=P[Q][y+1],D=P[Q][y+2];ee===void 0||D===void 0||(A=ee,R=D,L&&(L.xaxis&&L.xaxis.p2r?(Ie&&(ee-=L.xaxis._offset),Re?ee=h(L.xaxis,L.xanchor)+ee:ee=u(L.xaxis,ee)):(Ie&&(ee-=xe.l),me?ee=me.x[0]+ee/xe.w:ee=ee/xe.w),L.yaxis&&L.yaxis.p2r?(Ie&&(D-=L.yaxis._offset),ke?D=h(L.yaxis,L.yanchor)-D:D=u(L.yaxis,D)):(Ie&&(D-=xe.t),me?D=me.y[1]-D/xe.h:D=1-D/xe.h)),P[Q][y+1]=ee,P[Q][y+2]=D)}T[C].push(P[Q].slice())}}return T};function o(g,b){return Math.abs(g-b)<=1e-6}function w(g,b){var L=b[1]-g[1],S=b[2]-g[2];return Math.sqrt(L*L+S*S)}W.pointsOnRectangle=function(g){var b=g.length;if(b!==5)return!1;for(var L=1;L<3;L++){var S=g[0][L]-g[1][L],M=g[3][L]-g[2][L];if(!o(S,M))return!1;var T=g[0][L]-g[3][L],C=g[1][L]-g[2][L];if(!o(T,C))return!1}return!o(g[0][1],g[1][1])&&!o(g[0][1],g[3][1])?!1:!!(w(g[0],g[1])*w(g[0],g[3]))},W.pointsOnEllipse=function(g){var b=g.length;if(b!==i+1)return!1;b=i;for(var L=0;L<b;L++){var S=(b*2-L)%b,M=(b/2+S)%b,T=(b/2+L)%b;if(!o(w(g[L],g[T]),w(g[S],g[M])))return!1}return!0},W.handleEllipse=function(g,b,L){if(!g)return[b,L];var S=W.ellipseOver({x0:b[0],y0:b[1],x1:L[0],y1:L[1]}),M=(S.x1+S.x0)/2,T=(S.y1+S.y0)/2,C=(S.x1-S.x0)/2,m=(S.y1-S.y0)/2;C||(C=m=m/s),m||(m=C=C/s);for(var y=[],A=0;A<i;A++){var R=A*2*Math.PI/i;y.push([M+C*Math.cos(R),T+m*Math.sin(R)])}return y},W.ellipseOver=function(g){var b=g.x0,L=g.y0,S=g.x1,M=g.y1,T=S-b,C=M-L;b-=T,L-=C;var m=(b+S)/2,y=(L+M)/2,A=s;return T*=A,C*=A,{x0:m-T,y0:y-C,x1:m+T,y1:y+C}},W.fixDatesForPaths=function(g,b,L){var S=b.type==="date",M=L.type==="date";if(!S&&!M)return g;for(var T=0;T<g.length;T++)for(var C=0;C<g[T].length;C++)for(var m=0;m+2<g[T][C].length;m+=2)S&&(g[T][C][m+1]=g[T][C][m+1].replace(" ","_")),M&&(g[T][C][m+2]=g[T][C][m+2].replace(" ","_"));return g}}),lf=t((W,V)=>{var d=aa(),i=tu(),s=i.drawMode,f=i.openMode,u=of(),h=u.i000,p=u.i090,v=u.i180,o=u.i270,w=u.cos45,g=u.sin45,b=sf(),L=b.p2r,S=b.r2p,M=Ha(),T=M.clearOutline,C=yl(),m=C.readPaths,y=C.writePaths,A=C.ellipseOver,R=C.fixDatesForPaths;function N(H,U){if(H.length){var P=H[0][0];if(P){var re=U.gd,G=U.isActiveShape,Z=U.dragmode,Y=(re.layout||{}).shapes||[];if(!s(Z)&&G!==void 0){var X=re._fullLayout._activeShapeIndex;if(X<Y.length)switch(re._fullLayout.shapes[X].type){case"rect":Z="drawrect";break;case"circle":Z="drawcircle";break;case"line":Z="drawline";break;case"path":var ne=Y[X].path||"";ne[ne.length-1]==="Z"?Z="drawclosedpath":Z="drawopenpath";break}}var ae=te(H,U,Z);T(re);for(var B=U.editHelpers,ie=(B||{}).modifyItem,se=[],ye=0;ye<Y.length;ye++){var me=re._fullLayout.shapes[ye];if(se[ye]=me._input,G!==void 0&&ye===re._fullLayout._activeShapeIndex){var xe=ae;switch(me.type){case"line":case"rect":case"circle":var Re=d.getFromId(re,me.xref);me.xref.charAt(0)==="x"&&Re.type.includes("category")?(ie("x0",xe.x0-(me.x0shift||0)),ie("x1",xe.x1-(me.x1shift||0))):(ie("x0",xe.x0),ie("x1",xe.x1));var ke=d.getFromId(re,me.yref);me.yref.charAt(0)==="y"&&ke.type.includes("category")?(ie("y0",xe.y0-(me.y0shift||0)),ie("y1",xe.y1-(me.y1shift||0))):(ie("y0",xe.y0),ie("y1",xe.y1));break;case"path":ie("path",xe.path);break}}}return G===void 0?(se.push(ae),se):B?B.getUpdateObj():{}}}}function te(H,U,P){var re=H[0][0],G=U.gd,Z=re.getAttribute("d"),Y=G._fullLayout.newshape,X=U.plotinfo,ne=U.isActiveShape,ae=X.xaxis,B=X.yaxis,ie=!!X.domain||!X.xaxis,se=!!X.domain||!X.yaxis,ye=f(P),me=m(Z,G,X,ne),xe={editable:!0,visible:Y.visible,name:Y.name,showlegend:Y.showlegend,legend:Y.legend,legendwidth:Y.legendwidth,legendgroup:Y.legendgroup,legendgrouptitle:{text:Y.legendgrouptitle.text,font:Y.legendgrouptitle.font},legendrank:Y.legendrank,label:Y.label,xref:ie?"paper":ae._id,yref:se?"paper":B._id,layer:Y.layer,opacity:Y.opacity,line:{color:Y.line.color,width:Y.line.width,dash:Y.line.dash}};ye||(xe.fillcolor=Y.fillcolor,xe.fillrule=Y.fillrule);var Re;if(me.length===1&&(Re=me[0]),Re&&Re.length===5&&P==="drawrect")xe.type="rect",xe.x0=Re[0][1],xe.y0=Re[0][2],xe.x1=Re[2][1],xe.y1=Re[2][2];else if(Re&&P==="drawline")xe.type="line",xe.x0=Re[0][1],xe.y0=Re[0][2],xe.x1=Re[1][1],xe.y1=Re[1][2];else if(Re&&P==="drawcircle"){xe.type="circle";var ke=Re[h][1],Ie=Re[p][1],Q=Re[v][1],ee=Re[o][1],D=Re[h][2],le=Re[p][2],ge=Re[v][2],j=Re[o][2],k=X.xaxis&&(X.xaxis.type==="date"||X.xaxis.type==="log"),F=X.yaxis&&(X.yaxis.type==="date"||X.yaxis.type==="log");k&&(ke=S(X.xaxis,ke),Ie=S(X.xaxis,Ie),Q=S(X.xaxis,Q),ee=S(X.xaxis,ee)),F&&(D=S(X.yaxis,D),le=S(X.yaxis,le),ge=S(X.yaxis,ge),j=S(X.yaxis,j));var J=(Ie+ee)/2,K=(D+ge)/2,ve=(ee-Ie+Q-ke)/2,Te=(j-le+ge-D)/2,Ae=A({x0:J,y0:K,x1:J+ve*w,y1:K+Te*g});k&&(Ae.x0=L(X.xaxis,Ae.x0),Ae.x1=L(X.xaxis,Ae.x1)),F&&(Ae.y0=L(X.yaxis,Ae.y0),Ae.y1=L(X.yaxis,Ae.y1)),xe.x0=Ae.x0,xe.y0=Ae.y0,xe.x1=Ae.x1,xe.y1=Ae.y1}else xe.type="path",ae&&B&&R(me,ae,B),xe.path=y(me),Re=null;return xe}V.exports={newShapes:N,createShapeObj:te}}),Pm=t((W,V)=>{var d=tu(),i=d.selectMode,s=Ha(),f=s.clearOutline,u=yl(),h=u.readPaths,p=u.writePaths,v=u.fixDatesForPaths;V.exports=function(o,w){if(o.length){var g=o[0][0];if(g){var b=g.getAttribute("d"),L=w.gd,S=L._fullLayout.newselection,M=w.plotinfo,T=M.xaxis,C=M.yaxis,m=w.isActiveSelection,y=w.dragmode,A=(L.layout||{}).selections||[];if(!i(y)&&m!==void 0){var R=L._fullLayout._activeSelectionIndex;if(R<A.length)switch(L._fullLayout.selections[R].type){case"rect":y="select";break;case"path":y="lasso";break}}var N=h(b,L,M,m),te={xref:T._id,yref:C._id,opacity:S.opacity,line:{color:S.line.color,width:S.line.width,dash:S.line.dash}},H;N.length===1&&(H=N[0]),H&&H.length===5&&y==="select"?(te.type="rect",te.x0=H[0][1],te.y0=H[0][2],te.x1=H[2][1],te.y1=H[2][2]):(te.type="path",T&&C&&v(N,T,C),te.path=p(N),H=null),f(L);for(var U=w.editHelpers,P=(U||{}).modifyItem,re=[],G=0;G<A.length;G++){var Z=L._fullLayout.selections[G];if(!Z){re[G]=Z;continue}if(re[G]=Z._input,m!==void 0&&G===L._fullLayout._activeSelectionIndex){var Y=te;switch(Z.type){case"rect":P("x0",Y.x0),P("x1",Y.x1),P("y0",Y.y0),P("y1",Y.y1);break;case"path":P("path",Y.path);break}}}return m===void 0?(re.push(te),re):U?U.getUpdateObj():{}}}}}),sd=t((W,V)=>{V.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}}),xl=t(W=>{var V=sd(),d=Mt(),i=Ja();W.rangeToShapePosition=function(u){return u.type==="log"?u.r2d:function(h){return h}},W.shapePositionToRange=function(u){return u.type==="log"?u.d2r:function(h){return h}},W.decodeDate=function(u){return function(h){return h.replace&&(h=h.replace("_"," ")),u(h)}},W.encodeDate=function(u){return function(h){return u(h).replace(" ","_")}},W.extractPathCoords=function(u,h,p){var v=[],o=u.match(V.segmentRE);return o.forEach(function(w){var g=h[w.charAt(0)].drawn;if(g!==void 0){var b=w.substr(1).match(V.paramRE);if(!(!b||b.length<g)){var L=b[g],S=p?L:d.cleanNumber(L);v.push(S)}}}),v},W.getDataToPixel=function(u,h,p,v,o){var w=u._fullLayout._size,g;if(h)if(o==="domain")g=function(L){return h._length*(v?1-L:L)+h._offset};else{var b=W.shapePositionToRange(h);g=function(L){var S=f(h,p);return h._offset+h.r2p(b(L,!0))+S},h.type==="date"&&(g=W.decodeDate(g))}else v?g=function(L){return w.t+w.h*(1-L)}:g=function(L){return w.l+w.w*L};return g},W.getPixelToData=function(u,h,p,v){var o=u._fullLayout._size,w;if(h)if(v==="domain")w=function(b){var L=(b-h._offset)/h._length;return p?1-L:L};else{var g=W.rangeToShapePosition(h);w=function(b){return g(h.p2r(b-h._offset))}}else p?w=function(b){return 1-(b-o.t)/o.h}:w=function(b){return(b-o.l)/o.w};return w},W.roundPositionForSharpStrokeRendering=function(u,h){var p=Math.round(h%2)===1,v=Math.round(u);return p?v+.5:v},W.makeShapesOptionsAndPlotinfo=function(u,h){var p=u._fullLayout.shapes[h]||{},v=u._fullLayout._plots[p.xref+p.yref],o=!!v;return o?v._hadPlotinfo=!0:(v={},p.xref&&p.xref!=="paper"&&(v.xaxis=u._fullLayout[p.xref+"axis"]),p.yref&&p.yref!=="paper"&&(v.yaxis=u._fullLayout[p.yref+"axis"])),v.xsizemode=p.xsizemode,v.ysizemode=p.ysizemode,v.xanchor=p.xanchor,v.yanchor=p.yanchor,{options:p,plotinfo:v}},W.makeSelectionsOptionsAndPlotinfo=function(u,h){var p=u._fullLayout.selections[h]||{},v=u._fullLayout._plots[p.xref+p.yref],o=!!v;return o?v._hadPlotinfo=!0:(v={},p.xref&&(v.xaxis=u._fullLayout[p.xref+"axis"]),p.yref&&(v.yaxis=u._fullLayout[p.yref+"axis"])),{options:p,plotinfo:v}},W.getPathString=function(u,h){var p=h.type,v=i.getRefType(h.xref),o=i.getRefType(h.yref),w=i.getFromId(u,h.xref),g=i.getFromId(u,h.yref),b=u._fullLayout._size,L,S,M,T,C=f(w,h.x0shift),m=f(w,h.x1shift),y=f(g,h.y0shift),A=f(g,h.y1shift),R,N,te,H;if(w?v==="domain"?S=function(B){return w._offset+w._length*B}:(L=W.shapePositionToRange(w),S=function(B){return w._offset+w.r2p(L(B,!0))}):S=function(B){return b.l+b.w*B},g?o==="domain"?T=function(B){return g._offset+g._length*(1-B)}:(M=W.shapePositionToRange(g),T=function(B){return g._offset+g.r2p(M(B,!0))}):T=function(B){return b.t+b.h*(1-B)},p==="path")return w&&w.type==="date"&&(S=W.decodeDate(S)),g&&g.type==="date"&&(T=W.decodeDate(T)),s(h,S,T);if(h.xsizemode==="pixel"){var U=S(h.xanchor);R=U+h.x0+C,N=U+h.x1+m}else R=S(h.x0)+C,N=S(h.x1)+m;if(h.ysizemode==="pixel"){var P=T(h.yanchor);te=P-h.y0+y,H=P-h.y1+A}else te=T(h.y0)+y,H=T(h.y1)+A;if(p==="line")return"M"+R+","+te+"L"+N+","+H;if(p==="rect")return"M"+R+","+te+"H"+N+"V"+H+"H"+R+"Z";var re=(R+N)/2,G=(te+H)/2,Z=Math.abs(re-R),Y=Math.abs(G-te),X="A"+Z+","+Y,ne=re+Z+","+G,ae=re+","+(G-Y);return"M"+ne+X+" 0 1,1 "+ae+X+" 0 0,1 "+ne+"Z"};function s(u,h,p){var v=u.path,o=u.xsizemode,w=u.ysizemode,g=u.xanchor,b=u.yanchor;return v.replace(V.segmentRE,function(L){var S=0,M=L.charAt(0),T=V.paramIsX[M],C=V.paramIsY[M],m=V.numParams[M],y=L.substr(1).replace(V.paramRE,function(A){return T[S]?o==="pixel"?A=h(g)+Number(A):A=h(A):C[S]&&(w==="pixel"?A=p(b)-Number(A):A=p(A)),S++,S>m&&(A="X"),A});return S>m&&(y=y.replace(/[\s,]*X.*/,""),d.log("Ignoring extra params in segment "+L)),M+y})}function f(u,h){h=h||0;var p=0;return h&&u&&(u.type==="category"||u.type==="multicategory")&&(p=(u.r2p(1)-u.r2p(0))*h),p}}),Om=t((W,V)=>{var d=Mt(),i=Ja(),s=ja(),f=Ra(),u=yl().readPaths,h=xl(),p=h.getPathString,v=mr(),o=fi().FROM_TL;V.exports=function(b,L,S,M){if(M.selectAll(".shape-label").remove(),!!(S.label.text||S.label.texttemplate)){var T;if(S.label.texttemplate){var C={};if(S.type!=="path"){var m=i.getFromId(b,S.xref),y=i.getFromId(b,S.yref);for(var A in v){var R=v[A](S,m,y);R!==void 0&&(C[A]=R)}}T=d.texttemplateStringForShapes(S.label.texttemplate,{},b._fullLayout._d3locale,C)}else T=S.label.text;var N={"data-index":L},te=S.label.font,H={"data-notex":1},U=M.append("g").attr(N).classed("shape-label",!0),P=U.append("text").attr(H).classed("shape-label-text",!0).text(T),re,G,Z,Y;if(S.path){var X=p(b,S),ne=u(X,b);re=1/0,Z=1/0,G=-1/0,Y=-1/0;for(var ae=0;ae<ne.length;ae++)for(var B=0;B<ne[ae].length;B++)for(var ie=ne[ae][B],se=1;se<ie.length;se+=2){var ye=ie[se],me=ie[se+1];re=Math.min(re,ye),G=Math.max(G,ye),Z=Math.min(Z,me),Y=Math.max(Y,me)}}else{var xe=i.getFromId(b,S.xref),Re=S.x0shift,ke=S.x1shift,Ie=i.getRefType(S.xref),Q=i.getFromId(b,S.yref),ee=S.y0shift,D=S.y1shift,le=i.getRefType(S.yref),ge=function(Ae,Fe){var Ge=h.getDataToPixel(b,xe,Fe,!1,Ie);return Ge(Ae)},j=function(Ae,Fe){var Ge=h.getDataToPixel(b,Q,Fe,!0,le);return Ge(Ae)};re=ge(S.x0,Re),G=ge(S.x1,ke),Z=j(S.y0,ee),Y=j(S.y1,D)}var k=S.label.textangle;k==="auto"&&(S.type==="line"?k=w(re,Z,G,Y):k=0),P.call(function(Ae){return Ae.call(f.font,te).attr({}),s.convertToTspans(Ae,b),Ae});var F=f.bBox(P.node()),J=g(re,Z,G,Y,S,k,F),K=J.textx,ve=J.texty,Te=J.xanchor;P.attr({"text-anchor":{left:"start",center:"middle",right:"end"}[Te],y:ve,x:K,transform:"rotate("+k+","+K+","+ve+")"}).call(s.positionText,K,ve)}};function w(b,L,S,M){var T,C;return C=Math.abs(S-b),S>=b?T=L-M:T=M-L,-180/Math.PI*Math.atan2(T,C)}function g(b,L,S,M,T,C,m){var y=T.label.textposition,A=T.label.textangle,R=T.label.padding,N=T.type,te=Math.PI/180*C,H=Math.sin(te),U=Math.cos(te),P=T.label.xanchor,re=T.label.yanchor,G,Z,Y,X;if(N==="line"){y==="start"?(G=b,Z=L):y==="end"?(G=S,Z=M):(G=(b+S)/2,Z=(L+M)/2),P==="auto"&&(y==="start"?A==="auto"?S>b?P="left":S<b?P="right":P="center":S>b?P="right":S<b?P="left":P="center":y==="end"?A==="auto"?S>b?P="right":S<b?P="left":P="center":S>b?P="left":S<b?P="right":P="center":P="center");var ne={left:1,center:0,right:-1},ae={bottom:-1,middle:0,top:1};if(A==="auto"){var B=ae[re];Y=-R*H*B,X=R*U*B}else{var ie=ne[P],se=ae[re];Y=R*ie,X=R*se}G=G+Y,Z=Z+X}else Y=R+3,y.indexOf("right")!==-1?(G=Math.max(b,S)-Y,P==="auto"&&(P="right")):y.indexOf("left")!==-1?(G=Math.min(b,S)+Y,P==="auto"&&(P="left")):(G=(b+S)/2,P==="auto"&&(P="center")),y.indexOf("top")!==-1?Z=Math.min(L,M):y.indexOf("bottom")!==-1?Z=Math.max(L,M):Z=(L+M)/2,X=R,re==="bottom"?Z=Z-X:re==="top"&&(Z=Z+X);var ye=o[re],me=T.label.font.size,xe=m.height,Re=(xe*ye-me)*H,ke=-(xe*ye-me)*U;return{textx:G+Re,texty:Z+ke,xanchor:P}}}),cf=t((W,V)=>{var d=Mt(),i=d.strTranslate,s=Ot(),f=tu(),u=f.drawMode,h=f.selectMode,p=an(),v=Xt(),o=of(),w=o.i000,g=o.i090,b=o.i180,L=o.i270,S=Ha(),M=S.clearOutlineControllers,T=yl(),C=T.pointsOnRectangle,m=T.pointsOnEllipse,y=T.writePaths,A=lf().newShapes,R=lf().createShapeObj,N=Pm(),te=Om();V.exports=function re(G,Z,Y,X){X||(X=0);var ne=Y.gd;function ae(){re(G,Z,Y,X++),(m(G[0])||Y.hasText)&&B({redrawing:!0})}function B(ht){var ct={};Y.isActiveShape!==void 0&&(Y.isActiveShape=!1,ct=A(Z,Y)),Y.isActiveSelection!==void 0&&(Y.isActiveSelection=!1,ct=N(Z,Y),ne._fullLayout._reselect=!0),Object.keys(ct).length&&p.call((ht||{}).redrawing?"relayout":"_guiRelayout",ne,ct)}var ie=ne._fullLayout,se=ie._zoomlayer,ye=Y.dragmode,me=u(ye),xe=h(ye);(me||xe)&&(ne._fullLayout._outlining=!0),M(ne),Z.attr("d",y(G));var Re,ke,Ie,Q,ee;if(!X&&(Y.isActiveShape||Y.isActiveSelection)){ee=H([],G);var D=se.append("g").attr("class","outline-controllers");ve(D),bt()}if(me&&Y.hasText){var le=se.select(".label-temp"),ge=R(Z,Y,Y.dragmode);te(ne,"label-temp",ge,le)}function j(ht){Ie=+ht.srcElement.getAttribute("data-i"),Q=+ht.srcElement.getAttribute("data-j"),Re[Ie][Q].moveFn=k}function k(ht,ct){if(G.length){var Oe=ee[Ie][Q][1],ze=ee[Ie][Q][2],we=G[Ie],je=we.length;if(C(we)){var ot=ht,vt=ct;if(Y.isActiveSelection){var Lt=U(we,Q);Lt[1]===we[Q][1]?vt=0:ot=0}for(var Tt=0;Tt<je;Tt++)if(Tt!==Q){var kt=we[Tt];kt[1]===we[Q][1]&&(kt[1]=Oe+ot),kt[2]===we[Q][2]&&(kt[2]=ze+vt)}if(we[Q][1]=Oe+ot,we[Q][2]=ze+vt,!C(we))for(var Nt=0;Nt<je;Nt++)for(var Pt=0;Pt<we[Nt].length;Pt++)we[Nt][Pt]=ee[Ie][Nt][Pt]}else we[Q][1]=Oe+ht,we[Q][2]=ze+ct;ae()}}function F(){B()}function J(){if(G.length&&G[Ie]&&G[Ie].length){for(var ht=[],ct=0;ct<G[Ie].length;ct++)ct!==Q&&ht.push(G[Ie][ct]);ht.length>1&&!(ht.length===2&&ht[1][0]==="Z")&&(Q===0&&(ht[0][0]="M"),G[Ie]=ht,ae(),B())}}function K(ht,ct){if(ht===2){Ie=+ct.srcElement.getAttribute("data-i"),Q=+ct.srcElement.getAttribute("data-j");var Oe=G[Ie];!C(Oe)&&!m(Oe)&&J()}}function ve(ht){Re=[];for(var ct=0;ct<G.length;ct++){var Oe=G[ct],ze=C(Oe),we=!ze&&m(Oe);Re[ct]=[];for(var je=Oe.length,ot=0;ot<je;ot++)if(Oe[ot][0]!=="Z"&&!(we&&ot!==w&&ot!==g&&ot!==b&&ot!==L)){var vt=ze&&Y.isActiveSelection,Lt;vt&&(Lt=U(Oe,ot));var Tt=Oe[ot][1],kt=Oe[ot][2],Nt=ht.append(vt?"rect":"circle").attr("data-i",ct).attr("data-j",ot).style({fill:v.background,stroke:v.defaultLine,"stroke-width":1,"shape-rendering":"crispEdges"});if(vt){var Pt=Lt[1]-Tt,Wt=Lt[2]-kt,St=Wt?5:Math.max(Math.min(25,Math.abs(Pt)-5),5),Qt=Pt?5:Math.max(Math.min(25,Math.abs(Wt)-5),5);Nt.classed(Wt?"cursor-ew-resize":"cursor-ns-resize",!0).attr("width",St).attr("height",Qt).attr("x",Tt-St/2).attr("y",kt-Qt/2).attr("transform",i(Pt/2,Wt/2))}else Nt.classed("cursor-grab",!0).attr("r",5).attr("cx",Tt).attr("cy",kt);Re[ct][ot]={element:Nt.node(),gd:ne,prepFn:j,doneFn:F,clickFn:K},s.init(Re[ct][ot])}}}function Te(ht,ct){if(G.length)for(var Oe=0;Oe<G.length;Oe++)for(var ze=0;ze<G[Oe].length;ze++)for(var we=0;we+2<G[Oe][ze].length;we+=2)G[Oe][ze][we+1]=ee[Oe][ze][we+1]+ht,G[Oe][ze][we+2]=ee[Oe][ze][we+2]+ct}function Ae(ht,ct){Te(ht,ct),ae()}function Fe(ht){Ie=+ht.srcElement.getAttribute("data-i"),Ie||(Ie=0),ke[Ie].moveFn=Ae}function Ge(){B()}function rt(ht){ht===2&&P(ne)}function bt(){if(ke=[],!!G.length){var ht=0;ke[ht]={element:Z[0][0],gd:ne,prepFn:Fe,doneFn:Ge,clickFn:rt},s.init(ke[ht])}}};function H(re,G){for(var Z=0;Z<G.length;Z++){var Y=G[Z];re[Z]=[];for(var X=0;X<Y.length;X++){re[Z][X]=[];for(var ne=0;ne<Y[X].length;ne++)re[Z][X][ne]=Y[X][ne]}}return re}function U(re,G){var Z=re[G][1],Y=re[G][2],X=re.length,ne,ae,B;return ne=(G+1)%X,ae=re[ne][1],B=re[ne][2],ae===Z&&B===Y&&(ne=(G+2)%X,ae=re[ne][1],B=re[ne][2]),[ne,ae,B]}function P(re){if(h(re._fullLayout.dragmode)){M(re);var G=re._fullLayout._activeSelectionIndex,Z=(re.layout||{}).selections||[];if(G<Z.length){for(var Y=[],X=0;X<Z.length;X++)X!==G&&Y.push(Z[X]);delete re._fullLayout._activeSelectionIndex;var ne=re._fullLayout.selections[G];re._fullLayout._deselect={xref:ne.xref,yref:ne.yref},p.call("_guiRelayout",re,{selections:Y})}}}}),uf=t((W,V)=>{var d=l(),i=an(),s=Mt(),f=Ja(),u=yl().readPaths,h=cf(),p=Om(),v=Ha().clearOutlineControllers,o=Xt(),w=Ra(),g=fn().arrayEditor,b=Ot(),L=ar(),S=sd(),M=xl(),T=M.getPathString;V.exports={draw:C,drawOne:A,eraseActiveShape:P,drawLabel:p};function C(re){var G=re._fullLayout;G._shapeUpperLayer.selectAll("path").remove(),G._shapeLowerLayer.selectAll("path").remove(),G._shapeUpperLayer.selectAll("text").remove(),G._shapeLowerLayer.selectAll("text").remove();for(var Z in G._plots){var Y=G._plots[Z].shapelayer;Y&&(Y.selectAll("path").remove(),Y.selectAll("text").remove())}for(var X=0;X<G.shapes.length;X++)G.shapes[X].visible===!0&&A(re,X)}function m(re){return!!re._fullLayout._outlining}function y(re){return!re._context.edits.shapePosition}function A(re,G){re._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+G+'"]').remove();var Z=M.makeShapesOptionsAndPlotinfo(re,G),Y=Z.options,X=Z.plotinfo;if(!Y._input||Y.visible!==!0)return;if(Y.layer==="above")ae(re._fullLayout._shapeUpperLayer);else if(Y.xref==="paper"||Y.yref==="paper")ae(re._fullLayout._shapeLowerLayer);else if(Y.layer==="between")ae(X.shapelayerBetween);else if(X._hadPlotinfo){var ne=X.mainplotinfo||X;ae(ne.shapelayer)}else ae(re._fullLayout._shapeLowerLayer);function ae(B){var ie=T(re,Y),se={"data-index":G,"fill-rule":Y.fillrule,d:ie},ye=Y.opacity,me=Y.fillcolor,xe=Y.line.width?Y.line.color:"rgba(0,0,0,0)",Re=Y.line.width,ke=Y.line.dash;!Re&&Y.editable===!0&&(Re=5,ke="solid");var Ie=ie[ie.length-1]!=="Z",Q=y(re)&&Y.editable&&re._fullLayout._activeShapeIndex===G;Q&&(me=Ie?"rgba(0,0,0,0)":re._fullLayout.activeshape.fillcolor,ye=re._fullLayout.activeshape.opacity);var ee=B.append("g").classed("shape-group",!0).attr({"data-index":G}),D=ee.append("path").attr(se).style("opacity",ye).call(o.stroke,xe).call(o.fill,me).call(w.dashLine,ke,Re);R(ee,re,Y),p(re,G,Y,ee);var le;if((Q||re._context.edits.shapePosition)&&(le=g(re.layout,"shapes",Y)),Q){D.style({cursor:"move"});var ge={element:D.node(),plotinfo:X,gd:re,editHelpers:le,hasText:Y.label.text||Y.label.texttemplate,isActiveShape:!0},j=u(ie,re);h(j,D,ge)}else re._context.edits.shapePosition?N(re,D,Y,G,B,le):Y.editable===!0&&D.style("pointer-events",Ie||o.opacity(me)*ye<=.5?"stroke":"all");D.node().addEventListener("click",function(){return H(re,D)})}}function R(re,G,Z){var Y=(Z.xref+Z.yref).replace(/paper/g,"").replace(/[xyz][0-9]* *domain/g,"");w.setClipUrl(re,Y?"clip"+G._fullLayout._uid+Y:null,G)}function N(re,G,Z,Y,X,ne){var ae=10,B=10,ie=Z.xsizemode==="pixel",se=Z.ysizemode==="pixel",ye=Z.type==="line",me=Z.type==="path",xe=ne.modifyItem,Re,ke,Ie,Q,ee,D,le,ge,j,k,F,J,K,ve,Te,Ae=d.select(G.node().parentNode),Fe=f.getFromId(re,Z.xref),Ge=f.getRefType(Z.xref),rt=f.getFromId(re,Z.yref),bt=f.getRefType(Z.yref),ht=Z.x0shift,ct=Z.x1shift,Oe=Z.y0shift,ze=Z.y1shift,we=function(Me,Ce){var Ue=M.getDataToPixel(re,Fe,Ce,!1,Ge);return Ue(Me)},je=function(Me,Ce){var Ue=M.getDataToPixel(re,rt,Ce,!0,bt);return Ue(Me)},ot=M.getPixelToData(re,Fe,!1,Ge),vt=M.getPixelToData(re,rt,!0,bt),Lt=Nt(),Tt={element:Lt.node(),gd:re,prepFn:St,doneFn:Qt,clickFn:rr},kt;b.init(Tt),Lt.node().onmousemove=Wt;function Nt(){return ye?Pt():G}function Pt(){var Me=10,Ce=Math.max(Z.line.width,Me),Ue=X.append("g").attr("data-index",Y).attr("drag-helper",!0);Ue.append("path").attr("d",G.attr("d")).style({cursor:"move","stroke-width":Ce,"stroke-opacity":"0"});var He={"fill-opacity":"0"},et=Math.max(Ce/2,Me);return Ue.append("circle").attr({"data-line-point":"start-point",cx:ie?we(Z.xanchor)+Z.x0:we(Z.x0,ht),cy:se?je(Z.yanchor)-Z.y0:je(Z.y0,Oe),r:et}).style(He).classed("cursor-grab",!0),Ue.append("circle").attr({"data-line-point":"end-point",cx:ie?we(Z.xanchor)+Z.x1:we(Z.x1,ct),cy:se?je(Z.yanchor)-Z.y1:je(Z.y1,ze),r:et}).style(He).classed("cursor-grab",!0),Ue}function Wt(Me){if(m(re)){kt=null;return}if(ye)Me.target.tagName==="path"?kt="move":kt=Me.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point";else{var Ce=Tt.element.getBoundingClientRect(),Ue=Ce.right-Ce.left,He=Ce.bottom-Ce.top,et=Me.clientX-Ce.left,at=Me.clientY-Ce.top,xt=!me&&Ue>ae&&He>B&&!Me.shiftKey?b.getCursor(et/Ue,1-at/He):"move";L(G,xt),kt=xt.split("-")[0]}}function St(Me){m(re)||(ie&&(ee=we(Z.xanchor)),se&&(D=je(Z.yanchor)),Z.type==="path"?Te=Z.path:(Re=ie?Z.x0:we(Z.x0),ke=se?Z.y0:je(Z.y0),Ie=ie?Z.x1:we(Z.x1),Q=se?Z.y1:je(Z.y1)),Re<Ie?(j=Re,K="x0",k=Ie,ve="x1"):(j=Ie,K="x1",k=Re,ve="x0"),!se&&ke<Q||se&&ke>Q?(le=ke,F="y0",ge=Q,J="y1"):(le=Q,F="y1",ge=ke,J="y0"),Wt(Me),De(X,Z),de(G,Z,re),Tt.moveFn=kt==="move"?Jt:sr,Tt.altKey=Me.altKey)}function Qt(){m(re)||(L(G),Je(X),R(G,re,Z),i.call("_guiRelayout",re,ne.getUpdateObj()))}function rr(){m(re)||Je(X)}function Jt(Me,Ce){if(Z.type==="path"){var Ue=function(at){return at},He=Ue,et=Ue;ie?xe("xanchor",Z.xanchor=ot(ee+Me)):(He=function(at){return ot(we(at)+Me)},Fe&&Fe.type==="date"&&(He=M.encodeDate(He))),se?xe("yanchor",Z.yanchor=vt(D+Ce)):(et=function(at){return vt(je(at)+Ce)},rt&&rt.type==="date"&&(et=M.encodeDate(et))),xe("path",Z.path=te(Te,He,et))}else ie?xe("xanchor",Z.xanchor=ot(ee+Me)):(xe("x0",Z.x0=ot(Re+Me)),xe("x1",Z.x1=ot(Ie+Me))),se?xe("yanchor",Z.yanchor=vt(D+Ce)):(xe("y0",Z.y0=vt(ke+Ce)),xe("y1",Z.y1=vt(Q+Ce)));G.attr("d",T(re,Z)),De(X,Z),p(re,Y,Z,Ae)}function sr(Me,Ce){if(me){var Ue=function(lr){return lr},He=Ue,et=Ue;ie?xe("xanchor",Z.xanchor=ot(ee+Me)):(He=function(lr){return ot(we(lr)+Me)},Fe&&Fe.type==="date"&&(He=M.encodeDate(He))),se?xe("yanchor",Z.yanchor=vt(D+Ce)):(et=function(lr){return vt(je(lr)+Ce)},rt&&rt.type==="date"&&(et=M.encodeDate(et))),xe("path",Z.path=te(Te,He,et))}else if(ye){if(kt==="resize-over-start-point"){var at=Re+Me,xt=se?ke-Ce:ke+Ce;xe("x0",Z.x0=ie?at:ot(at)),xe("y0",Z.y0=se?xt:vt(xt))}else if(kt==="resize-over-end-point"){var mt=Ie+Me,yt=se?Q-Ce:Q+Ce;xe("x1",Z.x1=ie?mt:ot(mt)),xe("y1",Z.y1=se?yt:vt(yt))}}else{var It=function(lr){return kt.indexOf(lr)!==-1},zt=It("n"),Ut=It("s"),or=It("w"),xr=It("e"),zr=zt?le+Ce:le,Br=Ut?ge+Ce:ge,Gr=or?j+Me:j,wr=xr?k+Me:k;se&&(zt&&(zr=le-Ce),Ut&&(Br=ge-Ce)),(!se&&Br-zr>B||se&&zr-Br>B)&&(xe(F,Z[F]=se?zr:vt(zr)),xe(J,Z[J]=se?Br:vt(Br))),wr-Gr>ae&&(xe(K,Z[K]=ie?Gr:ot(Gr)),xe(ve,Z[ve]=ie?wr:ot(wr)))}G.attr("d",T(re,Z)),De(X,Z),p(re,Y,Z,Ae)}function De(Me,Ce){(ie||se)&&Ue();function Ue(){var He=Ce.type!=="path",et=Me.selectAll(".visual-cue").data([0]),at=1;et.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":at}).classed("visual-cue",!0);var xt=we(ie?Ce.xanchor:s.midRange(He?[Ce.x0,Ce.x1]:M.extractPathCoords(Ce.path,S.paramIsX))),mt=je(se?Ce.yanchor:s.midRange(He?[Ce.y0,Ce.y1]:M.extractPathCoords(Ce.path,S.paramIsY)));if(xt=M.roundPositionForSharpStrokeRendering(xt,at),mt=M.roundPositionForSharpStrokeRendering(mt,at),ie&&se){var yt="M"+(xt-1-at)+","+(mt-1-at)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";et.attr("d",yt)}else if(ie){var It="M"+(xt-1-at)+","+(mt-9-at)+"v18 h2 v-18 Z";et.attr("d",It)}else{var zt="M"+(xt-9-at)+","+(mt-1-at)+"h18 v2 h-18 Z";et.attr("d",zt)}}}function Je(Me){Me.selectAll(".visual-cue").remove()}function de(Me,Ce,Ue){var He=Ce.xref,et=Ce.yref,at=f.getFromId(Ue,He),xt=f.getFromId(Ue,et),mt="";He!=="paper"&&!at.autorange&&(mt+=He),et!=="paper"&&!xt.autorange&&(mt+=et),w.setClipUrl(Me,mt?"clip"+Ue._fullLayout._uid+mt:null,Ue)}}function te(re,G,Z){return re.replace(S.segmentRE,function(Y){var X=0,ne=Y.charAt(0),ae=S.paramIsX[ne],B=S.paramIsY[ne],ie=S.numParams[ne],se=Y.substr(1).replace(S.paramRE,function(ye){return X>=ie||(ae[X]?ye=G(ye):B[X]&&(ye=Z(ye)),X++),ye});return ne+se})}function H(re,G){if(y(re)){var Z=G.node(),Y=+Z.getAttribute("data-index");if(Y>=0){if(Y===re._fullLayout._activeShapeIndex){U(re);return}re._fullLayout._activeShapeIndex=Y,re._fullLayout._deactivateShape=U,C(re)}}}function U(re){if(y(re)){var G=re._fullLayout._activeShapeIndex;G>=0&&(v(re),delete re._fullLayout._activeShapeIndex,C(re))}}function P(re){if(y(re)){v(re);var G=re._fullLayout._activeShapeIndex,Z=(re.layout||{}).shapes||[];if(G<Z.length){for(var Y=[],X=0;X<Z.length;X++)X!==G&&Y.push(Z[X]);return delete re._fullLayout._activeShapeIndex,i.call("_guiRelayout",re,{shapes:Y})}}}}),Nm=t((W,V)=>{var d=an(),i=pn(),s=aa(),f=af(),u=uf().eraseActiveShape,h=Mt(),p=h._,v=V.exports={};v.toImage={name:"toImage",title:function(N){var te=N._context.toImageButtonOptions||{},H=te.format||"png";return H==="png"?p(N,"Download plot as a PNG"):p(N,"Download plot")},icon:f.camera,click:function(N){var te=N._context.toImageButtonOptions,H={format:te.format||"png"};h.notifier(p(N,"Taking snapshot - this may take a few seconds"),"long"),["filename","width","height","scale"].forEach(function(U){U in te&&(H[U]=te[U])}),d.call("downloadImage",N,H).then(function(U){h.notifier(p(N,"Snapshot succeeded")+" - "+U,"long")}).catch(function(){h.notifier(p(N,"Sorry, there was a problem downloading your snapshot!"),"long")})}},v.sendDataToCloud={name:"sendDataToCloud",title:function(N){return p(N,"Edit in Chart Studio")},icon:f.disk,click:function(N){i.sendDataToCloud(N)}},v.editInChartStudio={name:"editInChartStudio",title:function(N){return p(N,"Edit in Chart Studio")},icon:f.pencil,click:function(N){i.sendDataToCloud(N)}},v.zoom2d={name:"zoom2d",_cat:"zoom",title:function(N){return p(N,"Zoom")},attr:"dragmode",val:"zoom",icon:f.zoombox,click:o},v.pan2d={name:"pan2d",_cat:"pan",title:function(N){return p(N,"Pan")},attr:"dragmode",val:"pan",icon:f.pan,click:o},v.select2d={name:"select2d",_cat:"select",title:function(N){return p(N,"Box Select")},attr:"dragmode",val:"select",icon:f.selectbox,click:o},v.lasso2d={name:"lasso2d",_cat:"lasso",title:function(N){return p(N,"Lasso Select")},attr:"dragmode",val:"lasso",icon:f.lasso,click:o},v.drawclosedpath={name:"drawclosedpath",title:function(N){return p(N,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:f.drawclosedpath,click:o},v.drawopenpath={name:"drawopenpath",title:function(N){return p(N,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:f.drawopenpath,click:o},v.drawline={name:"drawline",title:function(N){return p(N,"Draw line")},attr:"dragmode",val:"drawline",icon:f.drawline,click:o},v.drawrect={name:"drawrect",title:function(N){return p(N,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:f.drawrect,click:o},v.drawcircle={name:"drawcircle",title:function(N){return p(N,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:f.drawcircle,click:o},v.eraseshape={name:"eraseshape",title:function(N){return p(N,"Erase active shape")},icon:f.eraseshape,click:u},v.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(N){return p(N,"Zoom in")},attr:"zoom",val:"in",icon:f.zoom_plus,click:o},v.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(N){return p(N,"Zoom out")},attr:"zoom",val:"out",icon:f.zoom_minus,click:o},v.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(N){return p(N,"Autoscale")},attr:"zoom",val:"auto",icon:f.autoscale,click:o},v.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(N){return p(N,"Reset axes")},attr:"zoom",val:"reset",icon:f.home,click:o},v.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(N){return p(N,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:f.tooltip_basic,gravity:"ne",click:o},v.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(N){return p(N,"Compare data on hover")},attr:"hovermode",val:function(N){return N._fullLayout._isHoriz?"y":"x"},icon:f.tooltip_compare,gravity:"ne",click:o};function o(N,te){var H=te.currentTarget,U=H.getAttribute("data-attr"),P=H.getAttribute("data-val")||!0,re=N._fullLayout,G={},Z=s.list(N,null,!0),Y=re._cartesianSpikesEnabled,X,ne;if(U==="zoom"){var ae=P==="in"?.5:2,B=(1+ae)/2,ie=(1-ae)/2,se,ye;for(ne=0;ne<Z.length;ne++)if(X=Z[ne],ye=X.modebardisable==="none"||X.modebardisable.indexOf(P==="auto"||P==="reset"?"autoscale":"zoominout")===-1,ye&&!X.fixedrange)if(se=X._name,P==="auto")G[se+".autorange"]=!0;else if(P==="reset")X._rangeInitial0===void 0&&X._rangeInitial1===void 0?G[se+".autorange"]=!0:X._rangeInitial0===void 0?(G[se+".autorange"]=X._autorangeInitial,G[se+".range"]=[null,X._rangeInitial1]):X._rangeInitial1===void 0?(G[se+".range"]=[X._rangeInitial0,null],G[se+".autorange"]=X._autorangeInitial):G[se+".range"]=[X._rangeInitial0,X._rangeInitial1],X._showSpikeInitial!==void 0&&(G[se+".showspikes"]=X._showSpikeInitial,Y==="on"&&!X._showSpikeInitial&&(Y="off"));else{var me=[X.r2l(X.range[0]),X.r2l(X.range[1])],xe=[B*me[0]+ie*me[1],B*me[1]+ie*me[0]];G[se+".range[0]"]=X.l2r(xe[0]),G[se+".range[1]"]=X.l2r(xe[1])}}else U==="hovermode"&&(P==="x"||P==="y")&&(P=re._isHoriz?"y":"x",H.setAttribute("data-val",P)),G[U]=P;re._cartesianSpikesEnabled=Y,d.call("_guiRelayout",N,G)}v.zoom3d={name:"zoom3d",_cat:"zoom",title:function(N){return p(N,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:f.zoombox,click:w},v.pan3d={name:"pan3d",_cat:"pan",title:function(N){return p(N,"Pan")},attr:"scene.dragmode",val:"pan",icon:f.pan,click:w},v.orbitRotation={name:"orbitRotation",title:function(N){return p(N,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:f["3d_rotate"],click:w},v.tableRotation={name:"tableRotation",title:function(N){return p(N,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:f["z-axis"],click:w};function w(N,te){for(var H=te.currentTarget,U=H.getAttribute("data-attr"),P=H.getAttribute("data-val")||!0,re=N._fullLayout._subplots.gl3d||[],G={},Z=U.split("."),Y=0;Y<re.length;Y++)G[re[Y]+"."+Z[1]]=P;var X=P==="pan"?P:"zoom";G.dragmode=X,d.call("_guiRelayout",N,G)}v.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(N){return p(N,"Reset camera to default")},attr:"resetDefault",icon:f.home,click:g},v.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(N){return p(N,"Reset camera to last save")},attr:"resetLastSave",icon:f.movie,click:g};function g(N,te){for(var H=te.currentTarget,U=H.getAttribute("data-attr"),P=U==="resetLastSave",re=U==="resetDefault",G=N._fullLayout,Z=G._subplots.gl3d||[],Y={},X=0;X<Z.length;X++){var ne=Z[X],ae=ne+".camera",B=ne+".aspectratio",ie=ne+".aspectmode",se=G[ne]._scene,ye;P?(Y[ae+".up"]=se.viewInitial.up,Y[ae+".eye"]=se.viewInitial.eye,Y[ae+".center"]=se.viewInitial.center,ye=!0):re&&(Y[ae+".up"]=null,Y[ae+".eye"]=null,Y[ae+".center"]=null,ye=!0),ye&&(Y[B+".x"]=se.viewInitial.aspectratio.x,Y[B+".y"]=se.viewInitial.aspectratio.y,Y[B+".z"]=se.viewInitial.aspectratio.z,Y[ie]=se.viewInitial.aspectmode)}d.call("_guiRelayout",N,Y)}v.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(N){return p(N,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:f.tooltip_basic,gravity:"ne",click:L};function b(N,te){var H=te.currentTarget,U=H._previousVal,P=N._fullLayout,re=P._subplots.gl3d||[],G=["xaxis","yaxis","zaxis"],Z={},Y={};if(U)Y=U,H._previousVal=null;else{for(var X=0;X<re.length;X++){var ne=re[X],ae=P[ne],B=ne+".hovermode";Z[B]=ae.hovermode,Y[B]=!1;for(var ie=0;ie<3;ie++){var se=G[ie],ye=ne+"."+se+".showspikes";Y[ye]=!1,Z[ye]=ae[se].showspikes}}H._previousVal=Z}return Y}function L(N,te){var H=b(N,te);d.call("_guiRelayout",N,H)}v.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(N){return p(N,"Zoom in")},attr:"zoom",val:"in",icon:f.zoom_plus,click:S},v.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(N){return p(N,"Zoom out")},attr:"zoom",val:"out",icon:f.zoom_minus,click:S},v.resetGeo={name:"resetGeo",_cat:"reset",title:function(N){return p(N,"Reset")},attr:"reset",val:null,icon:f.autoscale,click:S},v.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(N){return p(N,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:f.tooltip_basic,gravity:"ne",click:T};function S(N,te){for(var H=te.currentTarget,U=H.getAttribute("data-attr"),P=H.getAttribute("data-val")||!0,re=N._fullLayout,G=re._subplots.geo||[],Z=0;Z<G.length;Z++){var Y=G[Z],X=re[Y];if(U==="zoom"){var ne=X.projection.scale,ae=P==="in"?2*ne:.5*ne;d.call("_guiRelayout",N,Y+".projection.scale",ae)}}U==="reset"&&R(N,"geo")}v.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(N){return p(N,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:f.tooltip_basic,gravity:"ne",click:T};function M(N){var te=N._fullLayout;return te.hovermode?!1:te._has("cartesian")?te._isHoriz?"y":"x":"closest"}function T(N){var te=M(N);d.call("_guiRelayout",N,"hovermode",te)}v.resetViewSankey={name:"resetSankeyGroup",title:function(N){return p(N,"Reset view")},icon:f.home,click:function(N){for(var te={"node.groups":[],"node.x":[],"node.y":[]},H=0;H<N._fullData.length;H++){var U=N._fullData[H]._viewInitial;te["node.groups"].push(U.node.groups.slice()),te["node.x"].push(U.node.x.slice()),te["node.y"].push(U.node.y.slice())}d.call("restyle",N,te)}},v.toggleHover={name:"toggleHover",title:function(N){return p(N,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:f.tooltip_basic,gravity:"ne",click:function(N,te){var H=b(N,te);H.hovermode=M(N),d.call("_guiRelayout",N,H)}},v.resetViews={name:"resetViews",title:function(N){return p(N,"Reset views")},icon:f.home,click:function(N,te){var H=te.currentTarget;H.setAttribute("data-attr","zoom"),H.setAttribute("data-val","reset"),o(N,te),H.setAttribute("data-attr","resetLastSave"),g(N,te),R(N,"geo"),R(N,"mapbox"),R(N,"map")}},v.toggleSpikelines={name:"toggleSpikelines",title:function(N){return p(N,"Toggle Spike Lines")},icon:f.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(N){var te=N._fullLayout,H=te._cartesianSpikesEnabled;te._cartesianSpikesEnabled=H==="on"?"off":"on",d.call("_guiRelayout",N,C(N))}};function C(N){for(var te=N._fullLayout,H=te._cartesianSpikesEnabled==="on",U=s.list(N,null,!0),P={},re=0;re<U.length;re++){var G=U[re];P[G._name+".showspikes"]=H?!0:G._showSpikeInitial}return P}v.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(N){return p(N,"Reset view")},attr:"reset",icon:f.home,click:function(N){R(N,"mapbox")}},v.resetViewMap={name:"resetViewMap",_cat:"resetView",title:function(N){return p(N,"Reset view")},attr:"reset",icon:f.home,click:function(N){R(N,"map")}},v.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(N){return p(N,"Zoom in")},attr:"zoom",val:"in",icon:f.zoom_plus,click:m},v.zoomInMap={name:"zoomInMap",_cat:"zoomin",title:function(N){return p(N,"Zoom in")},attr:"zoom",val:"in",icon:f.zoom_plus,click:y},v.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(N){return p(N,"Zoom out")},attr:"zoom",val:"out",icon:f.zoom_minus,click:m},v.zoomOutMap={name:"zoomOutMap",_cat:"zoomout",title:function(N){return p(N,"Zoom out")},attr:"zoom",val:"out",icon:f.zoom_minus,click:y};function m(N,te){A(N,te,"mapbox")}function y(N,te){A(N,te,"map")}function A(N,te,H){for(var U=te.currentTarget,P=U.getAttribute("data-val"),re=N._fullLayout,G=re._subplots[H]||[],Z=1.05,Y={},X=0;X<G.length;X++){var ne=G[X],ae=re[ne].zoom,B=P==="in"?Z*ae:ae/Z;Y[ne+".zoom"]=B}d.call("_guiRelayout",N,Y)}function R(N,te){for(var H=N._fullLayout,U=H._subplots[te]||[],P={},re=0;re<U.length;re++)for(var G=U[re],Z=H[G]._subplot,Y=Z.viewInitial,X=Object.keys(Y),ne=0;ne<X.length;ne++){var ae=X[ne];P[G+"."+ae]=Y[ae]}d.call("_guiRelayout",N,P)}}),Dm=t((W,V)=>{var d=Nm(),i=Object.keys(d),s=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],f=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(s),u=[],h=function(p){if(f.indexOf(p._cat||p.name)===-1){var v=p.name,o=(p._cat||p.name).toLowerCase();u.indexOf(v)===-1&&u.push(v),u.indexOf(o)===-1&&u.push(o)}};i.forEach(function(p){h(d[p])}),u.sort(),V.exports={DRAW_MODES:s,backButtons:f,foreButtons:u}}),Im=t((W,V)=>{Dm(),V.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}}),tx=t((W,V)=>{var d=Mt(),i=Xt(),s=fn(),f=Im();V.exports=function(u,h){var p=u.modebar||{},v=s.newContainer(h,"modebar");function o(g,b){return d.coerce(p,v,f,g,b)}o("orientation"),o("bgcolor",i.addOpacity(h.paper_bgcolor,.5));var w=i.contrast(i.rgb(h.modebar.bgcolor));o("color",i.addOpacity(w,.3)),o("activecolor",i.addOpacity(w,.7)),o("uirevision",h.uirevision),o("add"),o("remove")}}),rx=t((W,V)=>{var d=l(),i=q(),s=Mt(),f=af(),u=r().version,h=new DOMParser;function p(g){this.container=g.container,this.element=document.createElement("div"),this.update(g.graphInfo,g.buttons),this.container.appendChild(this.element)}var v=p.prototype;v.update=function(g,b){this.graphInfo=g;var L=this.graphInfo._context,S=this.graphInfo._fullLayout,M="modebar-"+S._uid;this.element.setAttribute("id",M),this.element.setAttribute("role","toolbar"),this._uid=M,this.element.className="modebar modebar--custom",L.displayModeBar==="hover"&&(this.element.className+=" modebar--hover ease-bg"),S.modebar.orientation==="v"&&(this.element.className+=" vertical",b=b.reverse());var T=S.modebar,C="#"+M+" .modebar-group";document.querySelectorAll(C).forEach(function(N){N.style.backgroundColor=T.bgcolor});var m=!this.hasButtons(b),y=this.hasLogo!==L.displaylogo,A=this.locale!==L.locale;if(this.locale=L.locale,(m||y||A)&&(this.removeAllButtons(),this.updateButtons(b),L.watermark||L.displaylogo)){var R=this.getLogo();L.watermark&&(R.className=R.className+" watermark"),S.modebar.orientation==="v"?this.element.insertBefore(R,this.element.childNodes[0]):this.element.appendChild(R),this.hasLogo=!0}this.updateActiveButton(),s.setStyleOnHover("#"+M+" .modebar-btn",".active",".icon path","fill: "+T.activecolor,"fill: "+T.color,this.element)},v.updateButtons=function(g){var b=this;this.buttons=g,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(L){var S=b.createGroup();L.forEach(function(M){var T=M.name;if(!T)throw new Error("must provide button 'name' in button config");if(b.buttonsNames.indexOf(T)!==-1)throw new Error("button name '"+T+"' is taken");b.buttonsNames.push(T);var C=b.createButton(M);b.buttonElements.push(C),S.appendChild(C)}),b.element.appendChild(S)})},v.createGroup=function(){var g=document.createElement("div");g.className="modebar-group";var b=this.graphInfo._fullLayout.modebar;return g.style.backgroundColor=b.bgcolor,g},v.createButton=function(g){var b=this,L=document.createElement("button");L.setAttribute("type","button"),L.setAttribute("rel","tooltip"),L.className="modebar-btn";var S=g.title;S===void 0?S=g.name:typeof S=="function"&&(S=S(this.graphInfo)),(S||S===0)&&(L.setAttribute("data-title",S),L.setAttribute("aria-label",S)),g.attr!==void 0&&L.setAttribute("data-attr",g.attr);var M=g.val;M!==void 0&&(typeof M=="function"&&(M=M(this.graphInfo)),L.setAttribute("data-val",M));var T=g.click;if(typeof T!="function")throw new Error("must provide button 'click' function in button config");L.addEventListener("click",function(m){g.click(b.graphInfo,m),b.updateActiveButton(m.currentTarget)}),L.setAttribute("data-toggle",g.toggle||!1),g.toggle&&d.select(L).classed("active",!0);var C=g.icon;return typeof C=="function"?L.appendChild(C()):L.appendChild(this.createIcon(C||f.question)),L.setAttribute("data-gravity",g.gravity||"n"),L},v.createIcon=function(g){var b=i(g.height)?Number(g.height):g.ascent-g.descent,L="http://www.w3.org/2000/svg",S;if(g.path){S=document.createElementNS(L,"svg"),S.setAttribute("viewBox",[0,0,g.width,b].join(" ")),S.setAttribute("class","icon");var M=document.createElementNS(L,"path");M.setAttribute("d",g.path),g.transform?M.setAttribute("transform",g.transform):g.ascent!==void 0&&M.setAttribute("transform","matrix(1 0 0 -1 0 "+g.ascent+")"),S.appendChild(M)}if(g.svg){var T=h.parseFromString(g.svg,"application/xml");S=T.childNodes[0]}return S.setAttribute("height","1em"),S.setAttribute("width","1em"),S},v.updateActiveButton=function(g){var b=this.graphInfo._fullLayout,L=g!==void 0?g.getAttribute("data-attr"):null;this.buttonElements.forEach(function(S){var M=S.getAttribute("data-val")||!0,T=S.getAttribute("data-attr"),C=S.getAttribute("data-toggle")==="true",m=d.select(S),y=function(N,te){var H=b.modebar,U=N.querySelector(".icon path");U&&(te||N.matches(":hover")?U.style.fill=H.activecolor:U.style.fill=H.color)};if(C){if(T===L){var A=!m.classed("active");m.classed("active",A),y(S,A)}}else{var R=T===null?T:s.nestedProperty(b,T).get();m.classed("active",R===M),y(S,R===M)}})},v.hasButtons=function(g){var b=this.buttons;if(!b||g.length!==b.length)return!1;for(var L=0;L<g.length;++L){if(g[L].length!==b[L].length)return!1;for(var S=0;S<g[L].length;S++)if(g[L][S].name!==b[L][S].name)return!1}return!0};function o(g){return g+" (v"+u+")"}v.getLogo=function(){var g=this.createGroup(),b=document.createElement("a");return b.href="https://plotly.com/",b.target="_blank",b.setAttribute("data-title",o(s._(this.graphInfo,"Produced with Plotly.js"))),b.className="modebar-btn plotlyjsicon modebar-btn--logo",b.appendChild(this.createIcon(f.newplotlylogo)),g.appendChild(b),g},v.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},v.destroy=function(){s.removeElement(this.container.querySelector(".modebar"))};function w(g,b){var L=g._fullLayout,S=new p({graphInfo:g,container:L._modebardiv.node(),buttons:b});return L._privateplot&&d.select(S.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),S}V.exports=w}),nx=t((W,V)=>{var d=aa(),i=Ki(),s=an(),f=So().isUnifiedHover,u=rx(),h=Nm(),p=Dm().DRAW_MODES,v=Mt().extendDeep;V.exports=function(M){var T=M._fullLayout,C=M._context,m=T._modeBar;if(!C.displayModeBar&&!C.watermark){m&&(m.destroy(),delete T._modeBar);return}if(!Array.isArray(C.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(C.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var y=C.modeBarButtons,A;Array.isArray(y)&&y.length?A=S(y):!C.displayModeBar&&C.watermark?A=[]:A=o(M),m?m.update(M,A):T._modeBar=u(M,A)};function o(M){var T=M._fullLayout,C=M._fullData,m=M._context;function y(k,F){if(typeof F=="string"){if(F.toLowerCase()===k.toLowerCase())return!0}else{var J=F.name,K=F._cat||F.name;if(J===k||K===k.toLowerCase())return!0}return!1}var A=T.modebar.add;typeof A=="string"&&(A=[A]);var R=T.modebar.remove;typeof R=="string"&&(R=[R]);var N=m.modeBarButtonsToAdd.concat(A.filter(function(k){for(var F=0;F<m.modeBarButtonsToRemove.length;F++)if(y(k,m.modeBarButtonsToRemove[F]))return!1;return!0})),te=m.modeBarButtonsToRemove.concat(R.filter(function(k){for(var F=0;F<m.modeBarButtonsToAdd.length;F++)if(y(k,m.modeBarButtonsToAdd[F]))return!1;return!0})),H=T._has("cartesian"),U=T._has("gl3d"),P=T._has("geo"),re=T._has("pie"),G=T._has("funnelarea"),Z=T._has("ternary"),Y=T._has("mapbox"),X=T._has("map"),ne=T._has("polar"),ae=T._has("smith"),B=T._has("sankey"),ie=w(T),se=f(T.hovermode),ye=[];function me(k){if(k.length){for(var F=[],J=0;J<k.length;J++){for(var K=k[J],ve=h[K],Te=ve.name.toLowerCase(),Ae=(ve._cat||ve.name).toLowerCase(),Fe=!1,Ge=0;Ge<te.length;Ge++){var rt=te[Ge].toLowerCase();if(rt===Te||rt===Ae){Fe=!0;break}}Fe||F.push(h[K])}ye.push(F)}}var xe=["toImage"];m.showEditInChartStudio?xe.push("editInChartStudio"):m.showSendToCloud&&xe.push("sendDataToCloud"),me(xe);var Re=[],ke=[],Ie=[],Q=[];(H||re||G||Z)+P+U+Y+X+ne+ae>1?(ke=["toggleHover"],Ie=["resetViews"]):P?(Re=["zoomInGeo","zoomOutGeo"],ke=["hoverClosestGeo"],Ie=["resetGeo"]):U?(ke=["hoverClosest3d"],Ie=["resetCameraDefault3d","resetCameraLastSave3d"]):Y?(Re=["zoomInMapbox","zoomOutMapbox"],ke=["toggleHover"],Ie=["resetViewMapbox"]):X?(Re=["zoomInMap","zoomOutMap"],ke=["toggleHover"],Ie=["resetViewMap"]):re?ke=["hoverClosestPie"]:B?(ke=["hoverClosestCartesian","hoverCompareCartesian"],Ie=["resetViewSankey"]):ke=["toggleHover"],H&&ke.push("toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"),(b(C)||se)&&(ke=[]),H&&!ie&&(Re=["zoomIn2d","zoomOut2d","autoScale2d"],Ie[0]!=="resetViews"&&(Ie=["resetScale2d"])),U?Q=["zoom3d","pan3d","orbitRotation","tableRotation"]:H&&!ie||Z?Q=["zoom2d","pan2d"]:Y||X||P?Q=["pan2d"]:ne&&(Q=["zoom2d"]),g(C)&&Q.push("select2d","lasso2d");var ee=[],D=function(k){ee.indexOf(k)===-1&&ke.indexOf(k)!==-1&&ee.push(k)};if(Array.isArray(N)){for(var le=[],ge=0;ge<N.length;ge++){var j=N[ge];typeof j=="string"?(j=j.toLowerCase(),p.indexOf(j)!==-1?(T._has("mapbox")||T._has("map")||T._has("cartesian"))&&Q.push(j):j==="togglespikelines"?D("toggleSpikelines"):j==="togglehover"?D("toggleHover"):j==="hovercompare"?D("hoverCompareCartesian"):j==="hoverclosest"?(D("hoverClosestCartesian"),D("hoverClosestGeo"),D("hoverClosest3d"),D("hoverClosestPie")):j==="v1hovermode"&&(D("hoverClosestCartesian"),D("hoverCompareCartesian"),D("hoverClosestGeo"),D("hoverClosest3d"),D("hoverClosestPie"))):le.push(j)}N=le}return me(Q),me(Re.concat(Ie)),me(ee),L(ye,N)}function w(M){for(var T=d.list({_fullLayout:M},null,!0),C=0;C<T.length;C++){var m=T[C].modebardisable;if(!T[C].fixedrange&&m!=="autoscale+zoominout"&&m!=="zoominout+autoscale")return!1}return!0}function g(M){for(var T=!1,C=0;C<M.length&&!T;C++){var m=M[C];!m._module||!m._module.selectPoints||(s.traceIs(m,"scatter-like")?(i.hasMarkers(m)||i.hasText(m))&&(T=!0):s.traceIs(m,"box-violin")?(m.boxpoints==="all"||m.points==="all")&&(T=!0):T=!0)}return T}function b(M){for(var T=0;T<M.length;T++)if(!s.traceIs(M[T],"noHover"))return!1;return!0}function L(M,T){if(T.length)if(Array.isArray(T[0]))for(var C=0;C<T.length;C++)M.push(T[C]);else M.push(T);return M}function S(M){for(var T=v([],M),C=0;C<T.length;C++)for(var m=T[C],y=0;y<m.length;y++){var A=m[y];if(typeof A=="string")if(h[A]!==void 0)T[C][y]=h[A];else throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "))}return T}}),zm=t((W,V)=>{V.exports={moduleType:"component",name:"modebar",layoutAttributes:Im(),supplyLayoutDefaults:tx(),manage:nx()}}),Fm=t((W,V)=>{var d=fi().FROM_BL;V.exports=function(i,s,f){f===void 0&&(f=d[i.constraintoward||"center"]);var u=[i.r2l(i.range[0]),i.r2l(i.range[1])],h=u[0]+(u[1]-u[0])*f;i.range=i._input.range=[i.l2r(h+(u[0]-h)*s),i.l2r(h+(u[1]-h)*s)],i.setScale()}}),ld=t(W=>{var V=Mt(),d=is(),i=aa().id2name,s=to(),f=Fm(),u=$l(),h=oe().ALMOST_EQUAL,p=fi().FROM_BL;W.handleDefaults=function(M,T,C){var m=C.axIds,y=C.axHasImage,A=T._axisConstraintGroups=[],R=T._axisMatchGroups=[],N,te,H,U,P,re,G,Z;for(N=0;N<m.length;N++)U=i(m[N]),P=M[U],re=T[U],v(P,re,{axIds:m,layoutOut:T,hasImage:y[U]});function Y(xe,Re){for(N=0;N<xe.length;N++){te=xe[N];for(H in te)T[i(H)][Re]=te}}for(Y(R,"_matchGroup"),N=0;N<A.length;N++){te=A[N];for(H in te)if(re=T[i(H)],re.fixedrange){for(var X in te){var ne=i(X);(M[ne]||{}).fixedrange===!1&&V.warn("fixedrange was specified as false for axis "+ne+" but was overridden because another axis in its constraint group has fixedrange true"),T[ne].fixedrange=!0}break}}for(N=0;N<A.length;){te=A[N];for(H in te){re=T[i(H)],re._matchGroup&&Object.keys(re._matchGroup).length===Object.keys(te).length&&(A.splice(N,1),N--);break}N++}Y(A,"_constraintGroup");var ae=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],B=!1,ie=!1;function se(){Z=re[G],G==="rangebreaks"&&(ie=re._hasDayOfWeekBreaks)}for(N=0;N<R.length;N++){te=R[N];for(var ye=0;ye<ae.length;ye++){G=ae[ye],Z=null;var me;for(H in te)if(U=i(H),P=M[U],re=T[U],G in re){if(!re.matches&&(me=re,G in P)){se();break}Z===null&&G in P&&se()}if(G==="range"&&Z&&P.range&&P.range.length===2&&P.range[0]!==null&&P.range[1]!==null&&(B=!0),G==="autorange"&&Z===null&&B&&(Z=!1),Z===null&&G in me&&(Z=me[G]),Z!==null)for(H in te)re=T[i(H)],re[G]=G==="range"?Z.slice():Z,G==="rangebreaks"&&(re._hasDayOfWeekBreaks=ie,u(re,T))}}};function v(M,T,C){var m=C.axIds,y=C.layoutOut,A=C.hasImage,R=y._axisConstraintGroups,N=y._axisMatchGroups,te=T._id,H=te.charAt(0),U=((y._splomAxes||{})[H]||{})[te]||{},P=T._id,re=P.charAt(0)==="x";T._matchGroup=null,T._constraintGroup=null;function G(Q,ee){return V.coerce(M,T,s,Q,ee)}G("constrain",A?"domain":"range"),V.coerce(M,T,{constraintoward:{valType:"enumerated",values:re?["left","center","right"]:["bottom","middle","top"],dflt:re?"center":"middle"}},"constraintoward");var Z=T.type,Y,X,ne=[];for(Y=0;Y<m.length;Y++)if(X=m[Y],X!==P){var ae=y[i(X)];ae.type===Z&&ne.push(X)}var B=w(R,P);if(B){var ie=[];for(Y=0;Y<ne.length;Y++)X=ne[Y],B[X]||ie.push(X);ne=ie}var se=ne.length,ye,me;se&&(M.matches||U.matches)&&(ye=V.coerce(M,T,{matches:{valType:"enumerated",values:ne,dflt:ne.indexOf(U.matches)!==-1?U.matches:void 0}},"matches"));var xe=A&&!re?T.anchor:void 0;if(se&&!ye&&(M.scaleanchor||xe)&&(me=V.coerce(M,T,{scaleanchor:{valType:"enumerated",values:ne.concat([!1])}},"scaleanchor",xe)),ye){T._matchGroup=g(N,P,ye,1);var Re=y[i(ye)],ke=o(y,T)/o(y,Re);re!==(ye.charAt(0)==="x")&&(ke=(re?"x":"y")+ke),g(R,P,ye,ke)}else M.matches&&m.indexOf(M.matches)!==-1&&V.warn("ignored "+T._name+'.matches: "'+M.matches+'" to avoid an infinite loop');if(me){var Ie=G("scaleratio");Ie||(Ie=T.scaleratio=1),g(R,P,me,Ie)}else M.scaleanchor&&m.indexOf(M.scaleanchor)!==-1&&V.warn("ignored "+T._name+'.scaleanchor: "'+M.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function o(M,T){var C=T.domain;return C||(C=M[i(T.overlaying)].domain),C[1]-C[0]}function w(M,T){for(var C=0;C<M.length;C++)if(M[C][T])return M[C];return null}function g(M,T,C,m){var y,A,R,N,te,H=w(M,T);H===null?(H={},H[T]=1,te=M.length,M.push(H)):te=M.indexOf(H);var U=Object.keys(H);for(y=0;y<M.length;y++)if(R=M[y],y!==te&&R[C]){var P=R[C];for(A=0;A<U.length;A++)N=U[A],R[N]=b(P,b(m,H[N]));M.splice(te,1);return}if(m!==1)for(A=0;A<U.length;A++){var re=U[A];H[re]=b(m,H[re])}H[C]=1}function b(M,T){var C="",m="",y,A;typeof M=="string"&&(C=M.match(/^[xy]*/)[0],y=C.length,M=+M.substr(y)),typeof T=="string"&&(m=T.match(/^[xy]*/)[0],A=m.length,T=+T.substr(A));var R=M*T;return!y&&!A?R:!y||!A||C.charAt(0)===m.charAt(0)?C+m+M*T:y===A?R:(y>A?C.substr(A):m.substr(y))+R}function L(M,T){for(var C=T._size,m=C.h/C.w,y={},A=Object.keys(M),R=0;R<A.length;R++){var N=A[R],te=M[N];if(typeof te=="string"){var H=te.match(/^[xy]*/)[0],U=H.length;te=+te.substr(U);for(var P=H.charAt(0)==="y"?m:1/m,re=0;re<U;re++)te*=P}y[N]=te}return y}W.enforce=function(M){var T=M._fullLayout,C=T._axisConstraintGroups||[],m,y,A,R,N,te,H,U;for(m=0;m<C.length;m++){A=L(C[m],T);var P=Object.keys(A),re=1/0,G=0,Z=1/0,Y={},X={},ne=!1;for(y=0;y<P.length;y++)R=P[y],X[R]=N=T[i(R)],N._inputDomain?N.domain=N._inputDomain.slice():N._inputDomain=N.domain.slice(),N._inputRange||(N._inputRange=N.range.slice()),N.setScale(),Y[R]=te=Math.abs(N._m)/A[R],re=Math.min(re,te),(N.constrain==="domain"||!N._constraintShrinkable)&&(Z=Math.min(Z,te)),delete N._constraintShrinkable,G=Math.max(G,te),N.constrain==="domain"&&(ne=!0);if(!(re>h*G&&!ne)){for(y=0;y<P.length;y++)if(R=P[y],te=Y[R],N=X[R],H=N.constrain,te!==Z||H==="domain")if(U=te/Z,H==="range")f(N,U);else{var ae=N._inputDomain,B=(N.domain[1]-N.domain[0])/(ae[1]-ae[0]),ie=(N.r2l(N.range[1])-N.r2l(N.range[0]))/(N.r2l(N._inputRange[1])-N.r2l(N._inputRange[0]));if(U/=B,U*ie<1){N.domain=N._input.domain=ae.slice(),f(N,U);continue}if(ie<1&&(N.range=N._input.range=N._inputRange.slice(),U*=ie),N.autorange){var se=N.r2l(N.range[0]),ye=N.r2l(N.range[1]),me=(se+ye)/2,xe=me,Re=me,ke=Math.abs(ye-me),Ie=me-ke*U*1.0001,Q=me+ke*U*1.0001,ee=d.makePadFn(T,N,0),D=d.makePadFn(T,N,1);S(N,U);var le=Math.abs(N._m),ge=d.concatExtremes(M,N),j=ge.min,k=ge.max,F,J;for(J=0;J<j.length;J++)F=j[J].val-ee(j[J])/le,F>Ie&&F<xe&&(xe=F);for(J=0;J<k.length;J++)F=k[J].val+D(k[J])/le,F<Q&&F>Re&&(Re=F);var K=(Re-xe)/(2*ke);U/=K,xe=N.l2r(xe),Re=N.l2r(Re),N.range=N._input.range=se<ye?[xe,Re]:[Re,xe]}S(N,U)}}}},W.getAxisGroup=function(M,T){for(var C=M._axisMatchGroups,m=0;m<C.length;m++){var y=C[m];if(y[T])return"g"+m}return T},W.clean=function(M,T){if(T._inputDomain){for(var C=!1,m=T._id,y=M._fullLayout._axisConstraintGroups,A=0;A<y.length;A++)if(y[A][m]){C=!0;break}(!C||T.constrain!=="domain")&&(T._input.domain=T.domain=T._inputDomain,delete T._inputDomain)}};function S(M,T){var C=M._inputDomain,m=p[M.constraintoward],y=C[0]+(C[1]-C[0])*m;M.domain=M._input.domain=[y+(C[0]-y)/T,y+(C[1]-y)/T],M.setScale()}}),df=t(W=>{var V=l(),d=an(),i=pn(),s=Mt(),f=ja(),u=nf(),h=Xt(),p=Ra(),v=Hs(),o=zm(),w=Ja(),g=fi(),b=ld(),L=b.enforce,S=b.clean,M=is().doAutoRange,T="start",C="middle",m="end",y=kn().zindexSeparator;W.layoutStyles=function(B){return s.syncOrAsync([i.doAutoMargin,R],B)};function A(B,ie,se){for(var ye=0;ye<se.length;ye++){var me=se[ye][0],xe=se[ye][1];if(!(me[0]>=B[1]||me[1]<=B[0])&&xe[0]<ie[1]&&xe[1]>ie[0])return!0}return!1}function R(B){var ie=B._fullLayout,se=ie._size,ye=se.p,me=w.list(B,"",!0),xe,Re,ke,Ie,Q,ee;if(ie._paperdiv.style({width:B._context.responsive&&ie.autosize&&!B._context._hasZeroWidth&&!B.layout.width?"100%":ie.width+"px",height:B._context.responsive&&ie.autosize&&!B._context._hasZeroHeight&&!B.layout.height?"100%":ie.height+"px"}).selectAll(".main-svg").call(p.setSize,ie.width,ie.height),B._context.setBackground(B,ie.paper_bgcolor),W.drawMainTitle(B),o.manage(B),!ie._has("cartesian"))return i.previousPromises(B);function D(de,Me,Ce){var Ue=de._lw/2;if(de._id.charAt(0)==="x"){if(Me){if(Ce==="top")return Me._offset-ye-Ue}else return se.t+se.h*(1-(de.position||0))+Ue%1;return Me._offset+Me._length+ye+Ue}if(Me){if(Ce==="right")return Me._offset+Me._length+ye+Ue}else return se.l+se.w*(de.position||0)+Ue%1;return Me._offset-ye-Ue}for(xe=0;xe<me.length;xe++){Ie=me[xe];var le=Ie._anchorAxis;Ie._linepositions={},Ie._lw=p.crispRound(B,Ie.linewidth,1),Ie._mainLinePosition=D(Ie,le,Ie.side),Ie._mainMirrorPosition=Ie.mirror&&le?D(Ie,le,g.OPPOSITE_SIDE[Ie.side]):null}var ge=[],j=[],k=[],F=h.opacity(ie.paper_bgcolor)===1&&h.opacity(ie.plot_bgcolor)===1&&ie.paper_bgcolor===ie.plot_bgcolor;for(Re in ie._plots)if(ke=ie._plots[Re],ke.mainplot)ke.bg&&ke.bg.remove(),ke.bg=void 0;else{var J=ke.xaxis.domain,K=ke.yaxis.domain,ve=ke.plotgroup;if(A(J,K,k)&&Re.indexOf(y)===-1){var Te=ve.node(),Ae=ke.bg=s.ensureSingle(ve,"rect","bg");Te.insertBefore(Ae.node(),Te.childNodes[0]),j.push(Re)}else ve.select("rect.bg").remove(),k.push([J,K]),F||(ge.push(Re),j.push(Re))}var Fe=ie._bgLayer.selectAll(".bg").data(ge);for(Fe.enter().append("rect").classed("bg",!0),Fe.exit().remove(),Fe.each(function(de){ie._plots[de].bg=V.select(this)}),xe=0;xe<j.length;xe++)ke=ie._plots[j[xe]],Q=ke.xaxis,ee=ke.yaxis,ke.bg&&Q._offset!==void 0&&ee._offset!==void 0&&ke.bg.call(p.setRect,Q._offset-ye,ee._offset-ye,Q._length+2*ye,ee._length+2*ye).call(h.fill,ie.plot_bgcolor).style("stroke-width",0);if(!ie._hasOnlyLargeSploms)for(Re in ie._plots){ke=ie._plots[Re],Q=ke.xaxis,ee=ke.yaxis;var Ge=ke.clipId="clip"+ie._uid+Re+"plot",rt=s.ensureSingleById(ie._clips,"clipPath",Ge,function(de){de.classed("plotclip",!0).append("rect")});ke.clipRect=rt.select("rect").attr({width:Q._length,height:ee._length}),p.setTranslate(ke.plot,Q._offset,ee._offset);var bt,ht;ke._hasClipOnAxisFalse?(bt=null,ht=Ge):(bt=Ge,ht=null),p.setClipUrl(ke.plot,bt,B),ke.layerClipId=ht}var ct,Oe,ze,we,je,ot,vt,Lt,Tt,kt,Nt,Pt,Wt;function St(de){return"M"+ct+","+de+"H"+Oe}function Qt(de){return"M"+Q._offset+","+de+"h"+Q._length}function rr(de){return"M"+de+","+Lt+"V"+vt}function Jt(de){return ee._shift!==void 0&&(de+=ee._shift),"M"+de+","+ee._offset+"v"+ee._length}function sr(de,Me,Ce){if(!de.showline||Re!==de._mainSubplot)return"";if(!de._anchorAxis)return Ce(de._mainLinePosition);var Ue=Me(de._mainLinePosition);return de.mirror&&(Ue+=Me(de._mainMirrorPosition)),Ue}for(Re in ie._plots){ke=ie._plots[Re],Q=ke.xaxis,ee=ke.yaxis;var De="M0,0";N(Q,Re)&&(je=H(Q,"left",ee,me),ct=Q._offset-(je?ye+je:0),ot=H(Q,"right",ee,me),Oe=Q._offset+Q._length+(ot?ye+ot:0),ze=D(Q,ee,"bottom"),we=D(Q,ee,"top"),Wt=!Q._anchorAxis||Re!==Q._mainSubplot,Wt&&(Q.mirror==="allticks"||Q.mirror==="all")&&(Q._linepositions[Re]=[ze,we]),De=sr(Q,St,Qt),Wt&&Q.showline&&(Q.mirror==="all"||Q.mirror==="allticks")&&(De+=St(ze)+St(we)),ke.xlines.style("stroke-width",Q._lw+"px").call(h.stroke,Q.showline?Q.linecolor:"rgba(0,0,0,0)")),ke.xlines.attr("d",De);var Je="M0,0";N(ee,Re)&&(Nt=H(ee,"bottom",Q,me),vt=ee._offset+ee._length+(Nt?ye:0),Pt=H(ee,"top",Q,me),Lt=ee._offset-(Pt?ye:0),Tt=D(ee,Q,"left"),kt=D(ee,Q,"right"),Wt=!ee._anchorAxis||Re!==ee._mainSubplot,Wt&&(ee.mirror==="allticks"||ee.mirror==="all")&&(ee._linepositions[Re]=[Tt,kt]),Je=sr(ee,rr,Jt),Wt&&ee.showline&&(ee.mirror==="all"||ee.mirror==="allticks")&&(Je+=rr(Tt)+rr(kt)),ke.ylines.style("stroke-width",ee._lw+"px").call(h.stroke,ee.showline?ee.linecolor:"rgba(0,0,0,0)")),ke.ylines.attr("d",Je)}return w.makeClipPaths(B),i.previousPromises(B)}function N(B,ie){return(B.ticks||B.showline)&&(ie===B._mainSubplot||B.mirror==="all"||B.mirror==="allticks")}function te(B,ie,se){if(!se.showline||!se._lw)return!1;if(se.mirror==="all"||se.mirror==="allticks")return!0;var ye=se._anchorAxis;if(!ye)return!1;var me=g.FROM_BL[ie];return se.side===ie?ye.domain[me]===B.domain[me]:se.mirror&&ye.domain[1-me]===B.domain[1-me]}function H(B,ie,se,ye){if(te(B,ie,se))return se._lw;for(var me=0;me<ye.length;me++){var xe=ye[me];if(xe._mainAxis===se._mainAxis&&te(B,ie,xe))return xe._lw}return 0}W.drawMainTitle=function(B){var ie=B._fullLayout.title,se=B._fullLayout,ye=ne(se),me=ae(se),xe=Y(se,me),Re=Z(se,ye);if(v.draw(B,"gtitle",{propContainer:se,propName:"title.text",subtitlePropName:"title.subtitle.text",placeholder:se._dfltTitle.plot,subtitlePlaceholder:se._dfltTitle.subtitle,attributes:{x:Re,y:xe,"text-anchor":ye,dy:me}}),ie.text&&ie.automargin){var ke=V.select(B).selectAll(".gtitle"),Ie=p.bBox(V.select(B).selectAll(".g-gtitle").node()).height,Q=re(B,ie,Ie);if(Q>0){G(B,xe,Q,Ie),ke.attr({x:Re,y:xe,"text-anchor":ye,dy:X(ie.yanchor)}).call(f.positionText,Re,xe);var ee=(ie.text.match(f.BR_TAG_ALL)||[]).length;if(ee){var D=g.LINE_SPACING*ee+g.MID_SHIFT;ie.y===0&&(D=-D),ke.selectAll(".line").each(function(){var F=+this.getAttribute("dy").slice(0,-2)-D+"em";this.setAttribute("dy",F)})}var le=V.select(B).selectAll(".gtitle-subtitle");if(le.node()){var ge=ke.node().getBBox(),j=ge.y+ge.height,k=j+v.SUBTITLE_PADDING_EM*ie.subtitle.font.size;le.attr({x:Re,y:k,"text-anchor":ye,dy:X(ie.yanchor)}).call(f.positionText,Re,k)}}}};function U(B,ie,se,ye,me){var xe=ie.yref==="paper"?B._fullLayout._size.h:B._fullLayout.height,Re=s.isTopAnchor(ie)?ye:ye-me,ke=se==="b"?xe-Re:Re;return s.isTopAnchor(ie)&&se==="t"||s.isBottomAnchor(ie)&&se==="b"?!1:ke<me}function P(B,ie,se,ye,me){var xe=0;return se==="middle"&&(xe+=me/2),B==="t"?(se==="top"&&(xe+=me),xe+=ye-ie*ye):(se==="bottom"&&(xe+=me),xe+=ie*ye),xe}function re(B,ie,se){var ye=ie.y,me=ie.yanchor,xe=ye>.5?"t":"b",Re=B._fullLayout.margin[xe],ke=0;return ie.yref==="paper"?ke=se+ie.pad.t+ie.pad.b:ie.yref==="container"&&(ke=P(xe,ye,me,B._fullLayout.height,se)+ie.pad.t+ie.pad.b),ke>Re?ke:0}function G(B,ie,se,ye){var me="title.automargin",xe=B._fullLayout.title,Re=xe.y>.5?"t":"b",ke={x:xe.x,y:xe.y,t:0,b:0},Ie={};xe.yref==="paper"&&U(B,xe,Re,ie,ye)?ke[Re]=se:xe.yref==="container"&&(Ie[Re]=se,B._fullLayout._reservedMargin[me]=Ie),i.allowAutoMargin(B,me),i.autoMargin(B,me,ke)}function Z(B,ie){var se=B.title,ye=B._size,me=0;switch(ie===T?me=se.pad.l:ie===m&&(me=-se.pad.r),se.xref){case"paper":return ye.l+ye.w*se.x+me;case"container":default:return B.width*se.x+me}}function Y(B,ie){var se=B.title,ye=B._size,me=0;if(ie==="0em"||!ie?me=-se.pad.b:ie===g.CAP_SHIFT+"em"&&(me=se.pad.t),se.y==="auto")return ye.t/2;switch(se.yref){case"paper":return ye.t+ye.h-ye.h*se.y+me;case"container":default:return B.height-B.height*se.y+me}}function X(B){return B==="top"?g.CAP_SHIFT+.3+"em":B==="bottom"?"-0.3em":g.MID_SHIFT+"em"}function ne(B){var ie=B.title,se=C;return s.isRightAnchor(ie)?se=m:s.isLeftAnchor(ie)&&(se=T),se}function ae(B){var ie=B.title,se="0em";return s.isTopAnchor(ie)?se=g.CAP_SHIFT+"em":s.isMiddleAnchor(ie)&&(se=g.MID_SHIFT+"em"),se}W.doTraceStyle=function(B){var ie=B.calcdata,se=[],ye;for(ye=0;ye<ie.length;ye++){var me=ie[ye],xe=me[0]||{},Re=xe.trace||{},ke=Re._module||{},Ie=ke.arraysToCalcdata;Ie&&Ie(me,Re);var Q=ke.editStyle;Q&&se.push({fn:Q,cd0:xe})}if(se.length){for(ye=0;ye<se.length;ye++){var ee=se[ye];ee.fn(B,ee.cd0)}u(B),W.redrawReglTraces(B)}return i.style(B),d.getComponentMethod("legend","draw")(B),i.previousPromises(B)},W.doColorBars=function(B){return d.getComponentMethod("colorbar","draw")(B),i.previousPromises(B)},W.layoutReplot=function(B){var ie=B.layout;return B.layout=void 0,d.call("_doPlot",B,"",ie)},W.doLegend=function(B){return d.getComponentMethod("legend","draw")(B),i.previousPromises(B)},W.doTicksRelayout=function(B){return w.draw(B,"redraw"),B._fullLayout._hasOnlyLargeSploms&&(d.subplotsRegistry.splom.updateGrid(B),u(B),W.redrawReglTraces(B)),W.drawMainTitle(B),i.previousPromises(B)},W.doModeBar=function(B){var ie=B._fullLayout;o.manage(B);for(var se=0;se<ie._basePlotModules.length;se++){var ye=ie._basePlotModules[se].updateFx;ye&&ye(B)}return i.previousPromises(B)},W.doCamera=function(B){for(var ie=B._fullLayout,se=ie._subplots.gl3d,ye=0;ye<se.length;ye++){var me=ie[se[ye]],xe=me._scene;xe.setViewport(me)}},W.drawData=function(B){var ie=B._fullLayout;u(B);for(var se=ie._basePlotModules,ye=0;ye<se.length;ye++)se[ye].plot(B);return W.redrawReglTraces(B),i.style(B),d.getComponentMethod("selections","draw")(B),d.getComponentMethod("shapes","draw")(B),d.getComponentMethod("annotations","draw")(B),d.getComponentMethod("images","draw")(B),ie._replotting=!1,i.previousPromises(B)},W.redrawReglTraces=function(B){var ie=B._fullLayout;if(ie._has("regl")){var se=B._fullData,ye=[],me=[],xe,Re;for(ie._hasOnlyLargeSploms&&ie._splomGrid.draw(),xe=0;xe<se.length;xe++){var ke=se[xe];ke.visible===!0&&ke._length!==0&&(ke.type==="splom"?ie._splomScenes[ke.uid].draw():ke.type==="scattergl"?s.pushUnique(ye,ke.xaxis+ke.yaxis):ke.type==="scatterpolargl"&&s.pushUnique(me,ke.subplot))}for(xe=0;xe<ye.length;xe++)Re=ie._plots[ye[xe]],Re._scene&&Re._scene.draw();for(xe=0;xe<me.length;xe++)Re=ie[me[xe]]._subplot,Re._scene&&Re._scene.draw()}},W.doAutoRangeAndConstraints=function(B){for(var ie=w.list(B,"",!0),se,ye={},me=0;me<ie.length;me++)if(se=ie[me],!ye[se._id]){ye[se._id]=1,S(B,se),M(B,se);var xe=se._matchGroup;if(xe)for(var Re in xe){var ke=w.getFromId(B,Re);M(B,ke,se.range),ye[Re]=1}}L(B)},W.finalDraw=function(B){d.getComponentMethod("rangeslider","draw")(B),d.getComponentMethod("rangeselector","draw")(B)},W.drawMarginPushers=function(B){d.getComponentMethod("legend","draw")(B),d.getComponentMethod("rangeselector","draw")(B),d.getComponentMethod("sliders","draw")(B),d.getComponentMethod("updatemenus","draw")(B),d.getComponentMethod("colorbar","draw")(B)}}),Um=t((W,V)=>{var d=yl().readPaths,i=cf(),s=Ha().clearOutlineControllers,f=Xt(),u=Ra(),h=fn().arrayEditor,p=xl(),v=p.getPathString;V.exports={draw:o,drawOne:g,activateLastSelection:S};function o(T){var C=T._fullLayout;s(T),C._selectionLayer.selectAll("path").remove();for(var m in C._plots){var y=C._plots[m].selectionLayer;y&&y.selectAll("path").remove()}for(var A=0;A<C.selections.length;A++)g(T,A)}function w(T){return T._context.editSelection}function g(T,C){T._fullLayout._paperdiv.selectAll('.selectionlayer [data-index="'+C+'"]').remove();var m=p.makeSelectionsOptionsAndPlotinfo(T,C),y=m.options,A=m.plotinfo;if(!y._input)return;R(T._fullLayout._selectionLayer);function R(N){var te=v(T,y),H={"data-index":C,"fill-rule":"evenodd",d:te},U=y.opacity,P="rgba(0,0,0,0)",re=y.line.color||f.contrast(T._fullLayout.plot_bgcolor),G=y.line.width,Z=y.line.dash;G||(G=5,Z="solid");var Y=w(T)&&T._fullLayout._activeSelectionIndex===C;Y&&(P=T._fullLayout.activeselection.fillcolor,U=T._fullLayout.activeselection.opacity);for(var X=[],ne=1;ne>=0;ne--){var ae=N.append("path").attr(H).style("opacity",ne?.1:U).call(f.stroke,re).call(f.fill,P).call(u.dashLine,ne?"solid":Z,ne?4+G:G);if(b(ae,T,y),Y){var B=h(T.layout,"selections",y);ae.style({cursor:"move"});var ie={element:ae.node(),plotinfo:A,gd:T,editHelpers:B,isActiveSelection:!0},se=d(te,T);i(se,ae,ie)}else ae.style("pointer-events",ne?"all":"none");X[ne]=ae}var ye=X[0],me=X[1];me.node().addEventListener("click",function(){return L(T,ye)})}}function b(T,C,m){var y=m.xref+m.yref;u.setClipUrl(T,"clip"+C._fullLayout._uid+y,C)}function L(T,C){if(w(T)){var m=C.node(),y=+m.getAttribute("data-index");if(y>=0){if(y===T._fullLayout._activeSelectionIndex){M(T);return}T._fullLayout._activeSelectionIndex=y,T._fullLayout._deactivateSelection=M,o(T)}}}function S(T){if(w(T)){var C=T._fullLayout.selections.length-1;T._fullLayout._activeSelectionIndex=C,T._fullLayout._deactivateSelection=M,o(T)}}function M(T){if(w(T)){var C=T._fullLayout._activeSelectionIndex;C>=0&&(s(T),delete T._fullLayout._activeSelectionIndex,o(T))}}}),ax=t((W,V)=>{function d(){var i,s=0,f=!1;function u(h,p){return i.list.push({type:h,data:p?JSON.parse(JSON.stringify(p)):void 0}),i}return i={list:[],segmentId:function(){return s++},checkIntersection:function(h,p){return u("check",{seg1:h,seg2:p})},segmentChop:function(h,p){return u("div_seg",{seg:h,pt:p}),u("chop",{seg:h,pt:p})},statusRemove:function(h){return u("pop_seg",{seg:h})},segmentUpdate:function(h){return u("seg_update",{seg:h})},segmentNew:function(h,p){return u("new_seg",{seg:h,primary:p})},segmentRemove:function(h){return u("rem_seg",{seg:h})},tempStatus:function(h,p,v){return u("temp_status",{seg:h,above:p,below:v})},rewind:function(h){return u("rewind",{seg:h})},status:function(h,p,v){return u("status",{seg:h,above:p,below:v})},vert:function(h){return h===f?i:(f=h,u("vert",{x:h}))},log:function(h){return typeof h!="string"&&(h=JSON.stringify(h,!1,"  ")),u("log",{txt:h})},reset:function(){return u("reset")},selected:function(h){return u("selected",{segs:h})},chainStart:function(h){return u("chain_start",{seg:h})},chainRemoveHead:function(h,p){return u("chain_rem_head",{index:h,pt:p})},chainRemoveTail:function(h,p){return u("chain_rem_tail",{index:h,pt:p})},chainNew:function(h,p){return u("chain_new",{pt1:h,pt2:p})},chainMatch:function(h){return u("chain_match",{index:h})},chainClose:function(h){return u("chain_close",{index:h})},chainAddHead:function(h,p){return u("chain_add_head",{index:h,pt:p})},chainAddTail:function(h,p){return u("chain_add_tail",{index:h,pt:p})},chainConnect:function(h,p){return u("chain_con",{index1:h,index2:p})},chainReverse:function(h){return u("chain_rev",{index:h})},chainJoin:function(h,p){return u("chain_join",{index1:h,index2:p})},done:function(){return u("done")}},i}V.exports=d}),ix=t((W,V)=>{function d(i){typeof i!="number"&&(i=1e-10);var s={epsilon:function(f){return typeof f=="number"&&(i=f),i},pointAboveOrOnLine:function(f,u,h){var p=u[0],v=u[1],o=h[0],w=h[1],g=f[0],b=f[1];return(o-p)*(b-v)-(w-v)*(g-p)>=-i},pointBetween:function(f,u,h){var p=f[1]-u[1],v=h[0]-u[0],o=f[0]-u[0],w=h[1]-u[1],g=o*v+p*w;if(g<i)return!1;var b=v*v+w*w;return!(g-b>-i)},pointsSameX:function(f,u){return Math.abs(f[0]-u[0])<i},pointsSameY:function(f,u){return Math.abs(f[1]-u[1])<i},pointsSame:function(f,u){return s.pointsSameX(f,u)&&s.pointsSameY(f,u)},pointsCompare:function(f,u){return s.pointsSameX(f,u)?s.pointsSameY(f,u)?0:f[1]<u[1]?-1:1:f[0]<u[0]?-1:1},pointsCollinear:function(f,u,h){var p=f[0]-u[0],v=f[1]-u[1],o=u[0]-h[0],w=u[1]-h[1];return Math.abs(p*w-o*v)<i},linesIntersect:function(f,u,h,p){var v=u[0]-f[0],o=u[1]-f[1],w=p[0]-h[0],g=p[1]-h[1],b=v*g-o*w;if(Math.abs(b)<i)return!1;var L=f[0]-h[0],S=f[1]-h[1],M=(w*S-g*L)/b,T=(v*S-o*L)/b,C={alongA:0,alongB:0,pt:[f[0]+M*v,f[1]+M*o]};return M<=-i?C.alongA=-2:M<i?C.alongA=-1:M-1<=-i?C.alongA=0:M-1<i?C.alongA=1:C.alongA=2,T<=-i?C.alongB=-2:T<i?C.alongB=-1:T-1<=-i?C.alongB=0:T-1<i?C.alongB=1:C.alongB=2,C},pointInsideRegion:function(f,u){for(var h=f[0],p=f[1],v=u[u.length-1][0],o=u[u.length-1][1],w=!1,g=0;g<u.length;g++){var b=u[g][0],L=u[g][1];L-p>i!=o-p>i&&(v-b)*(p-L)/(o-L)+b-h>i&&(w=!w),v=b,o=L}return w}};return s}V.exports=d}),ox=t((W,V)=>{var d={create:function(){var i={root:{root:!0,next:null},exists:function(s){return!(s===null||s===i.root)},isEmpty:function(){return i.root.next===null},getHead:function(){return i.root.next},insertBefore:function(s,f){for(var u=i.root,h=i.root.next;h!==null;){if(f(h)){s.prev=h.prev,s.next=h,h.prev.next=s,h.prev=s;return}u=h,h=h.next}u.next=s,s.prev=u,s.next=null},findTransition:function(s){for(var f=i.root,u=i.root.next;u!==null&&!s(u);)f=u,u=u.next;return{before:f===i.root?null:f,after:u,insert:function(h){return h.prev=f,h.next=u,f.next=h,u!==null&&(u.prev=h),h}}}};return i},node:function(i){return i.prev=null,i.next=null,i.remove=function(){i.prev.next=i.next,i.next&&(i.next.prev=i.prev),i.prev=null,i.next=null},i}};V.exports=d}),sx=t((W,V)=>{var d=ox();function i(s,f,u){function h(C,m){return{id:u?u.segmentId():-1,start:C,end:m,myFill:{above:null,below:null},otherFill:null}}function p(C,m,y){return{id:u?u.segmentId():-1,start:C,end:m,myFill:{above:y.myFill.above,below:y.myFill.below},otherFill:null}}var v=d.create();function o(C,m,y,A,R,N){var te=f.pointsCompare(m,R);return te!==0?te:f.pointsSame(y,N)?0:C!==A?C?1:-1:f.pointAboveOrOnLine(y,A?R:N,A?N:R)?1:-1}function w(C,m){v.insertBefore(C,function(y){var A=o(C.isStart,C.pt,m,y.isStart,y.pt,y.other.pt);return A<0})}function g(C,m){var y=d.node({isStart:!0,pt:C.start,seg:C,primary:m,other:null,status:null});return w(y,C.end),y}function b(C,m,y){var A=d.node({isStart:!1,pt:m.end,seg:m,primary:y,other:C,status:null});C.other=A,w(A,C.pt)}function L(C,m){var y=g(C,m);return b(y,C,m),y}function S(C,m){u&&u.segmentChop(C.seg,m),C.other.remove(),C.seg.end=m,C.other.pt=m,w(C.other,C.pt)}function M(C,m){var y=p(m,C.seg.end,C.seg);return S(C,m),L(y,C.primary)}function T(C,m){var y=d.create();function A(ae,B){var ie=ae.seg.start,se=ae.seg.end,ye=B.seg.start,me=B.seg.end;return f.pointsCollinear(ie,ye,me)?f.pointsCollinear(se,ye,me)||f.pointAboveOrOnLine(se,ye,me)?1:-1:f.pointAboveOrOnLine(ie,ye,me)?1:-1}function R(ae){return y.findTransition(function(B){var ie=A(ae,B.ev);return ie>0})}function N(ae,B){var ie=ae.seg,se=B.seg,ye=ie.start,me=ie.end,xe=se.start,Re=se.end;u&&u.checkIntersection(ie,se);var ke=f.linesIntersect(ye,me,xe,Re);if(ke===!1){if(!f.pointsCollinear(ye,me,xe)||f.pointsSame(ye,Re)||f.pointsSame(me,xe))return!1;var Ie=f.pointsSame(ye,xe),Q=f.pointsSame(me,Re);if(Ie&&Q)return B;var ee=!Ie&&f.pointBetween(ye,xe,Re),D=!Q&&f.pointBetween(me,xe,Re);if(Ie)return D?M(B,me):M(ae,Re),B;ee&&(Q||(D?M(B,me):M(ae,Re)),M(B,ye))}else ke.alongA===0&&(ke.alongB===-1?M(ae,xe):ke.alongB===0?M(ae,ke.pt):ke.alongB===1&&M(ae,Re)),ke.alongB===0&&(ke.alongA===-1?M(B,ye):ke.alongA===0?M(B,ke.pt):ke.alongA===1&&M(B,me));return!1}for(var te=[];!v.isEmpty();){var H=v.getHead();if(u&&u.vert(H.pt[0]),H.isStart){let ae=function(){if(P){var B=N(H,P);if(B)return B}return re?N(H,re):!1};u&&u.segmentNew(H.seg,H.primary);var U=R(H),P=U.before?U.before.ev:null,re=U.after?U.after.ev:null;u&&u.tempStatus(H.seg,P?P.seg:!1,re?re.seg:!1);var G=ae();if(G){if(s){var Z;H.seg.myFill.below===null?Z=!0:Z=H.seg.myFill.above!==H.seg.myFill.below,Z&&(G.seg.myFill.above=!G.seg.myFill.above)}else G.seg.otherFill=H.seg.myFill;u&&u.segmentUpdate(G.seg),H.other.remove(),H.remove()}if(v.getHead()!==H){u&&u.rewind(H.seg);continue}if(s){var Z;H.seg.myFill.below===null?Z=!0:Z=H.seg.myFill.above!==H.seg.myFill.below,re?H.seg.myFill.below=re.seg.myFill.above:H.seg.myFill.below=C,Z?H.seg.myFill.above=!H.seg.myFill.below:H.seg.myFill.above=H.seg.myFill.below}else if(H.seg.otherFill===null){var Y;re?H.primary===re.primary?Y=re.seg.otherFill.above:Y=re.seg.myFill.above:Y=H.primary?m:C,H.seg.otherFill={above:Y,below:Y}}u&&u.status(H.seg,P?P.seg:!1,re?re.seg:!1),H.other.status=U.insert(d.node({ev:H}))}else{var X=H.status;if(X===null)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(y.exists(X.prev)&&y.exists(X.next)&&N(X.prev.ev,X.next.ev),u&&u.statusRemove(X.ev.seg),X.remove(),!H.primary){var ne=H.seg.myFill;H.seg.myFill=H.seg.otherFill,H.seg.otherFill=ne}te.push(H.seg)}v.getHead().remove()}return u&&u.done(),te}return s?{addRegion:function(C){for(var m,y=C[C.length-1],A=0;A<C.length;A++){m=y,y=C[A];var R=f.pointsCompare(m,y);R!==0&&L(h(R<0?m:y,R<0?y:m),!0)}},calculate:function(C){return T(C,!1)}}:{calculate:function(C,m,y,A){return C.forEach(function(R){L(p(R.start,R.end,R),!0)}),y.forEach(function(R){L(p(R.start,R.end,R),!1)}),T(m,A)}}}V.exports=i}),lx=t((W,V)=>{function d(i,s,f){var u=[],h=[];return i.forEach(function(p){var v=p.start,o=p.end;if(s.pointsSame(v,o)){console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");return}f&&f.chainStart(p);var w={index:0,matches_head:!1,matches_pt1:!1},g={index:0,matches_head:!1,matches_pt1:!1},b=w;function L(Y,X,ne){return b.index=Y,b.matches_head=X,b.matches_pt1=ne,b===w?(b=g,!1):(b=null,!0)}for(var S=0;S<u.length;S++){var M=u[S],T=M[0];M[1];var C=M[M.length-1];if(M[M.length-2],s.pointsSame(T,v)){if(L(S,!0,!0))break}else if(s.pointsSame(T,o)){if(L(S,!0,!1))break}else if(s.pointsSame(C,v)){if(L(S,!1,!0))break}else if(s.pointsSame(C,o)&&L(S,!1,!1))break}if(b===w){u.push([v,o]),f&&f.chainNew(v,o);return}if(b===g){f&&f.chainMatch(w.index);var m=w.index,y=w.matches_pt1?o:v,A=w.matches_head,M=u[m],R=A?M[0]:M[M.length-1],N=A?M[1]:M[M.length-2],te=A?M[M.length-1]:M[0],H=A?M[M.length-2]:M[1];if(s.pointsCollinear(N,R,y)&&(A?(f&&f.chainRemoveHead(w.index,y),M.shift()):(f&&f.chainRemoveTail(w.index,y),M.pop()),R=N),s.pointsSame(te,y)){u.splice(m,1),s.pointsCollinear(H,te,R)&&(A?(f&&f.chainRemoveTail(w.index,R),M.pop()):(f&&f.chainRemoveHead(w.index,R),M.shift())),f&&f.chainClose(w.index),h.push(M);return}A?(f&&f.chainAddHead(w.index,y),M.unshift(y)):(f&&f.chainAddTail(w.index,y),M.push(y));return}function U(Y){f&&f.chainReverse(Y),u[Y].reverse()}function P(Y,X){var ne=u[Y],ae=u[X],B=ne[ne.length-1],ie=ne[ne.length-2],se=ae[0],ye=ae[1];s.pointsCollinear(ie,B,se)&&(f&&f.chainRemoveTail(Y,B),ne.pop(),B=ie),s.pointsCollinear(B,se,ye)&&(f&&f.chainRemoveHead(X,se),ae.shift()),f&&f.chainJoin(Y,X),u[Y]=ne.concat(ae),u.splice(X,1)}var re=w.index,G=g.index;f&&f.chainConnect(re,G);var Z=u[re].length<u[G].length;w.matches_head?g.matches_head?Z?(U(re),P(re,G)):(U(G),P(G,re)):P(G,re):g.matches_head?P(re,G):Z?(U(re),P(G,re)):(U(G),P(re,G))}),h}V.exports=d}),cx=t((W,V)=>{function d(s,f,u){var h=[];return s.forEach(function(p){var v=(p.myFill.above?8:0)+(p.myFill.below?4:0)+(p.otherFill&&p.otherFill.above?2:0)+(p.otherFill&&p.otherFill.below?1:0);f[v]!==0&&h.push({id:u?u.segmentId():-1,start:p.start,end:p.end,myFill:{above:f[v]===1,below:f[v]===2},otherFill:null})}),u&&u.selected(h),h}var i={union:function(s,f){return d(s,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],f)},intersect:function(s,f){return d(s,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],f)},difference:function(s,f){return d(s,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],f)},differenceRev:function(s,f){return d(s,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],f)},xor:function(s,f){return d(s,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],f)}};V.exports=i}),ux=t((W,V)=>{var d={toPolygon:function(i,s){function f(p){if(p.length<=0)return i.segments({inverted:!1,regions:[]});function v(g){var b=g.slice(0,g.length-1);return i.segments({inverted:!1,regions:[b]})}for(var o=v(p[0]),w=1;w<p.length;w++)o=i.selectDifference(i.combine(o,v(p[w])));return o}if(s.type==="Polygon")return i.polygon(f(s.coordinates));if(s.type==="MultiPolygon"){for(var u=i.segments({inverted:!1,regions:[]}),h=0;h<s.coordinates.length;h++)u=i.selectUnion(i.combine(u,f(s.coordinates[h])));return i.polygon(u)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(i,s,f){f=i.polygon(i.segments(f));function u(M,T){return s.pointInsideRegion([(M[0][0]+M[1][0])*.5,(M[0][1]+M[1][1])*.5],T)}function h(M){return{region:M,children:[]}}var p=h(null);function v(M,T){for(var C=0;C<M.children.length;C++){var m=M.children[C];if(u(T,m.region)){v(m,T);return}}for(var y=h(T),C=0;C<M.children.length;C++){var m=M.children[C];u(m.region,T)&&(y.children.push(m),M.children.splice(C,1),C--)}M.children.push(y)}for(var o=0;o<f.regions.length;o++){var w=f.regions[o];w.length<3||v(p,w)}function g(M,T){for(var C=0,m=M[M.length-1][0],y=M[M.length-1][1],A=[],R=0;R<M.length;R++){var N=M[R][0],te=M[R][1];A.push([N,te]),C+=te*m-N*y,m=N,y=te}var H=C<0;return H!==T&&A.reverse(),A.push([A[0][0],A[0][1]]),A}var b=[];function L(M){var T=[g(M.region,!1)];b.push(T);for(var C=0;C<M.children.length;C++)T.push(S(M.children[C]))}function S(M){for(var T=0;T<M.children.length;T++)L(M.children[T]);return g(M.region,!0)}for(var o=0;o<p.children.length;o++)L(p.children[o]);return b.length<=0?{type:"Polygon",coordinates:[]}:b.length==1?{type:"Polygon",coordinates:b[0]}:{type:"MultiPolygon",coordinates:b}}};V.exports=d}),dx=t((W,V)=>{var d=ax(),i=ix(),s=sx(),f=lx(),u=cx(),h=ux(),p=!1,v=i(),o;o={buildLog:function(g){return g===!0?p=d():g===!1&&(p=!1),p===!1?!1:p.list},epsilon:function(g){return v.epsilon(g)},segments:function(g){var b=s(!0,v,p);return g.regions.forEach(b.addRegion),{segments:b.calculate(g.inverted),inverted:g.inverted}},combine:function(g,b){var L=s(!1,v,p);return{combined:L.calculate(g.segments,g.inverted,b.segments,b.inverted),inverted1:g.inverted,inverted2:b.inverted}},selectUnion:function(g){return{segments:u.union(g.combined,p),inverted:g.inverted1||g.inverted2}},selectIntersect:function(g){return{segments:u.intersect(g.combined,p),inverted:g.inverted1&&g.inverted2}},selectDifference:function(g){return{segments:u.difference(g.combined,p),inverted:g.inverted1&&!g.inverted2}},selectDifferenceRev:function(g){return{segments:u.differenceRev(g.combined,p),inverted:!g.inverted1&&g.inverted2}},selectXor:function(g){return{segments:u.xor(g.combined,p),inverted:g.inverted1!==g.inverted2}},polygon:function(g){return{regions:f(g.segments,v,p),inverted:g.inverted}},polygonFromGeoJSON:function(g){return h.toPolygon(o,g)},polygonToGeoJSON:function(g){return h.fromPolygon(o,v,g)},union:function(g,b){return w(g,b,o.selectUnion)},intersect:function(g,b){return w(g,b,o.selectIntersect)},difference:function(g,b){return w(g,b,o.selectDifference)},differenceRev:function(g,b){return w(g,b,o.selectDifferenceRev)},xor:function(g,b){return w(g,b,o.selectXor)}};function w(g,b,L){var S=o.segments(g),M=o.segments(b),T=o.combine(S,M),C=L(T);return o.polygon(C)}typeof window=="object"&&(window.PolyBool=o),V.exports=o}),hx=t((W,V)=>{V.exports=function(d,i,s,f){var u=d[0],h=d[1],p=!1;s===void 0&&(s=0),f===void 0&&(f=i.length);for(var v=f-s,o=0,w=v-1;o<v;w=o++){var g=i[o+s][0],b=i[o+s][1],L=i[w+s][0],S=i[w+s][1],M=b>h!=S>h&&u<(L-g)*(h-b)/(S-b)+g;M&&(p=!p)}return p}}),Bm=t((W,V)=>{var d=$n().dot,i=oe().BADNUM,s=V.exports={};s.tester=function(f){var u=f.slice(),h=u[0][0],p=h,v=u[0][1],o=v,w;for((u[u.length-1][0]!==u[0][0]||u[u.length-1][1]!==u[0][1])&&u.push(u[0]),w=1;w<u.length;w++)h=Math.min(h,u[w][0]),p=Math.max(p,u[w][0]),v=Math.min(v,u[w][1]),o=Math.max(o,u[w][1]);var g=!1,b;u.length===5&&(u[0][0]===u[1][0]?u[2][0]===u[3][0]&&u[0][1]===u[3][1]&&u[1][1]===u[2][1]&&(g=!0,b=function(C){return C[0]===u[0][0]}):u[0][1]===u[1][1]&&u[2][1]===u[3][1]&&u[0][0]===u[3][0]&&u[1][0]===u[2][0]&&(g=!0,b=function(C){return C[1]===u[0][1]}));function L(C,m){var y=C[0],A=C[1];return!(y===i||y<h||y>p||A===i||A<v||A>o||m&&b(C))}function S(C,m){var y=C[0],A=C[1];if(y===i||y<h||y>p||A===i||A<v||A>o)return!1;var R=u.length,N=u[0][0],te=u[0][1],H=0,U,P,re,G,Z;for(U=1;U<R;U++)if(P=N,re=te,N=u[U][0],te=u[U][1],G=Math.min(P,N),!(y<G||y>Math.max(P,N)||A>Math.max(re,te)))if(A<Math.min(re,te))y!==G&&H++;else{if(N===P?Z=A:Z=re+(y-P)*(te-re)/(N-P),A===Z)return!(U===1&&m);A<=Z&&y!==G&&H++}return H%2===1}var M=!0,T=u[0];for(w=1;w<u.length;w++)if(T[0]!==u[w][0]||T[1]!==u[w][1]){M=!1;break}return{xmin:h,xmax:p,ymin:v,ymax:o,pts:u,contains:g?L:S,isRect:g,degenerate:M}},s.isSegmentBent=function(f,u,h,p){var v=f[u],o=[f[h][0]-v[0],f[h][1]-v[1]],w=d(o,o),g=Math.sqrt(w),b=[-o[1]/g,o[0]/g],L,S,M;for(L=u+1;L<h;L++)if(S=[f[L][0]-v[0],f[L][1]-v[1]],M=d(S,o),M<0||M>w||Math.abs(d(S,b))>p)return!0;return!1},s.filter=function(f,u){var h=[f[0]],p=0,v=0;function o(g){f.push(g);var b=h.length,L=p;h.splice(v+1);for(var S=L+1;S<f.length;S++)(S===f.length-1||s.isSegmentBent(f,L,S+1,u))&&(h.push(f[S]),h.length<b-2&&(p=S,v=h.length-1),L=S)}if(f.length>1){var w=f.pop();o(w)}return{addPt:o,raw:f,filtered:h}}}),fx=t((W,V)=>{V.exports={BENDPX:1.5,MINSELECT:12,SELECTDELAY:100,SELECTID:"-select"}}),px=t((W,V)=>{var d=dx(),i=hx(),s=an(),f=Ra().dashStyle,u=Xt(),h=ws(),p=So().makeEventData,v=tu(),o=v.freeMode,w=v.rectMode,g=v.drawMode,b=v.openMode,L=v.selectMode,S=xl(),M=sd(),T=cf(),C=Ha().clearOutline,m=yl(),y=m.handleEllipse,A=m.readPaths,R=lf().newShapes,N=Pm(),te=Um().activateLastSelection,H=Mt(),U=H.sorterAsc,P=Bm(),re=Ao(),G=aa().getFromId,Z=nf(),Y=df().redrawReglTraces,X=fx(),ne=X.MINSELECT,ae=P.filter,B=P.tester,ie=sf(),se=ie.p2r,ye=ie.axValue,me=ie.getTransform;function xe(De){return De.subplot!==void 0}function Re(De,Je,de,Me,Ce){var Ue=!xe(Me),He=o(Ce),et=w(Ce),at=b(Ce),xt=g(Ce),mt=L(Ce),yt=Ce==="drawline",It=Ce==="drawcircle",zt=yt||It,Ut=Me.gd,or=Ut._fullLayout,xr=mt&&or.newselection.mode==="immediate"&&Ue,zr=or._zoomlayer,Br=Me.element.getBoundingClientRect(),Gr=Me.plotinfo,wr=me(Gr),lr=Je-Br.left,Dr=de-Br.top;or._calcInverseTransform(Ut);var Hr=H.apply3DTransform(or._invTransform)(lr,Dr);lr=Hr[0],Dr=Hr[1];var Rr=or._invScaleX,Ar=or._invScaleY,Er=lr,_r=Dr,rn="M"+lr+","+Dr,gn=Me.xaxes[0],Ur=Me.yaxes[0],vn=gn._length,Cn=Ur._length,Vn=De.altKey&&!(g(Ce)&&at),Gn,sn,Fn,Tn,Mr,oa,pe;le(De,Ut,Me),He&&(Gn=ae([[lr,Dr]],X.BENDPX));var he=zr.selectAll("path.select-outline-"+Gr.id).data([1]),Ye=xt?or.newshape:or.newselection;xt&&(Me.hasText=Ye.label.text||Ye.label.texttemplate);var tt=xt&&!at?Ye.fillcolor:"rgba(0,0,0,0)",lt=Ye.line.color||(Ue?u.contrast(Ut._fullLayout.plot_bgcolor):"#7f7f7f");he.enter().append("path").attr("class","select-outline select-outline-"+Gr.id).style({opacity:xt?Ye.opacity/2:1,"stroke-dasharray":f(Ye.line.dash,Ye.line.width),"stroke-width":Ye.line.width+"px","shape-rendering":"crispEdges"}).call(u.stroke,lt).call(u.fill,tt).attr("fill-rule","evenodd").classed("cursor-move",!!xt).attr("transform",wr).attr("d",rn+"Z");var We=zr.append("path").attr("class","zoombox-corners").style({fill:u.background,stroke:u.defaultLine,"stroke-width":1}).attr("transform",wr).attr("d","M0,0Z");if(xt&&Me.hasText){var Ze=zr.select(".label-temp");Ze.empty()&&(Ze=zr.append("g").classed("label-temp",!0).classed("select-outline",!0).style({opacity:.8}))}var dt=or._uid+X.SELECTID,it=[],At=J(Ut,Me.xaxes,Me.yaxes,Me.subplot);xr&&!De.shiftKey&&(Me._clearSubplotSelections=function(){if(Ue){var Yt=gn._id,pr=Ur._id;vt(Ut,Yt,pr,At);for(var fr=(Ut.layout||{}).selections||[],Sr=[],hr=!1,Cr=0;Cr<fr.length;Cr++){var Fr=or.selections[Cr];!Fr||Fr.xref!==Yt||Fr.yref!==pr?Sr.push(fr[Cr]):hr=!0}hr&&(Ut._fullLayout._noEmitSelectedAtStart=!0,s.call("_guiRelayout",Ut,{selections:Sr}))}});var Rt=Qt(Me);Me.moveFn=function(Yt,pr){Me._clearSubplotSelections&&(Me._clearSubplotSelections(),Me._clearSubplotSelections=void 0),Er=Math.max(0,Math.min(vn,Rr*Yt+lr)),_r=Math.max(0,Math.min(Cn,Ar*pr+Dr));var fr=Math.abs(Er-lr),Sr=Math.abs(_r-Dr);if(et){var hr,Cr,Fr;if(mt){var Un=or.selectdirection;switch(Un==="any"?Sr<Math.min(fr*.6,ne)?hr="h":fr<Math.min(Sr*.6,ne)?hr="v":hr="d":hr=Un,hr){case"h":Cr=It?Cn/2:0,Fr=Cn;break;case"v":Cr=It?vn/2:0,Fr=vn;break}}if(xt)switch(or.newshape.drawdirection){case"vertical":hr="h",Cr=It?Cn/2:0,Fr=Cn;break;case"horizontal":hr="v",Cr=It?vn/2:0,Fr=vn;break;case"ortho":fr<Sr?(hr="h",Cr=Dr,Fr=_r):(hr="v",Cr=lr,Fr=Er);break;default:hr="d"}hr==="h"?(Tn=zt?y(It,[Er,Cr],[Er,Fr]):[[lr,Cr],[lr,Fr],[Er,Fr],[Er,Cr]],Tn.xmin=zt?Er:Math.min(lr,Er),Tn.xmax=zt?Er:Math.max(lr,Er),Tn.ymin=Math.min(Cr,Fr),Tn.ymax=Math.max(Cr,Fr),We.attr("d","M"+Tn.xmin+","+(Dr-ne)+"h-4v"+2*ne+"h4ZM"+(Tn.xmax-1)+","+(Dr-ne)+"h4v"+2*ne+"h-4Z")):hr==="v"?(Tn=zt?y(It,[Cr,_r],[Fr,_r]):[[Cr,Dr],[Cr,_r],[Fr,_r],[Fr,Dr]],Tn.xmin=Math.min(Cr,Fr),Tn.xmax=Math.max(Cr,Fr),Tn.ymin=zt?_r:Math.min(Dr,_r),Tn.ymax=zt?_r:Math.max(Dr,_r),We.attr("d","M"+(lr-ne)+","+Tn.ymin+"v-4h"+2*ne+"v4ZM"+(lr-ne)+","+(Tn.ymax-1)+"v4h"+2*ne+"v-4Z")):hr==="d"&&(Tn=zt?y(It,[lr,Dr],[Er,_r]):[[lr,Dr],[lr,_r],[Er,_r],[Er,Dr]],Tn.xmin=Math.min(lr,Er),Tn.xmax=Math.max(lr,Er),Tn.ymin=Math.min(Dr,_r),Tn.ymax=Math.max(Dr,_r),We.attr("d","M0,0Z"))}else He&&(Gn.addPt([Er,_r]),Tn=Gn.filtered);if(Me.selectionDefs&&Me.selectionDefs.length?(Fn=ht(Me.mergedPolygons,Tn,Vn),Tn.subtract=Vn,sn=D(Me.selectionDefs.concat([Tn]))):(Fn=[Tn],sn=B(Tn)),T(Oe(Fn,at),he,Me),mt){var on=we(Ut,!1),la=on.eventData?on.eventData.points.slice():[];on=we(Ut,!1,sn,At,Me),sn=on.selectionTesters,pe=on.eventData;var bn;Gn?bn=Gn.filtered:bn=Pt(Fn),re.throttle(dt,X.SELECTDELAY,function(){it=ze(sn,At);for(var ha=it.slice(),sa=0;sa<la.length;sa++){for(var Fa=la[sa],ka=!1,An=0;An<ha.length;An++)if(ha[An].curveNumber===Fa.curveNumber&&ha[An].pointNumber===Fa.pointNumber){ka=!0;break}ka||ha.push(Fa)}ha.length&&(pe||(pe={}),pe.points=ha),Rt(pe,bn),rr(Ut,pe)})}},Me.clickFn=function(Yt,pr){if(We.remove(),Ut._fullLayout._activeShapeIndex>=0){Ut._fullLayout._deactivateShape(Ut);return}if(!xt){var fr=or.clickmode;re.done(dt).then(function(){if(re.clear(dt),Yt===2){for(he.remove(),Mr=0;Mr<At.length;Mr++)oa=At[Mr],oa._module.selectPoints(oa,!1);if(rt(Ut,At),k(Me),sr(Ut),At.length){var Sr=At[0].xaxis,hr=At[0].yaxis;if(Sr&&hr){for(var Cr=[],Fr=Ut._fullLayout.selections,Un=0;Un<Fr.length;Un++){var on=Fr[Un];on&&(on.xref!==Sr._id||on.yref!==hr._id)&&Cr.push(on)}Cr.length<Fr.length&&(Ut._fullLayout._noEmitSelectedAtStart=!0,s.call("_guiRelayout",Ut,{selections:Cr}))}}}else fr.indexOf("select")>-1&&ke(pr,Ut,Me.xaxes,Me.yaxes,Me.subplot,Me,he),fr==="event"&&Jt(Ut,void 0);h.click(Ut,pr,Gr.id)}).catch(H.error)}},Me.doneFn=function(){We.remove(),re.done(dt).then(function(){re.clear(dt),!xr&&Tn&&Me.selectionDefs&&(Tn.subtract=Vn,Me.selectionDefs.push(Tn),Me.mergedPolygons.length=0,[].push.apply(Me.mergedPolygons,Fn)),(xr||xt)&&k(Me,xr),Me.doneFnCompleted&&Me.doneFnCompleted(it),mt&&Jt(Ut,pe)}).catch(H.error)}}function ke(De,Je,de,Me,Ce,Ue,He){var et=Je._hoverdata,at=Je._fullLayout,xt=at.clickmode,mt=xt.indexOf("event")>-1,yt=[],It,zt,Ut,or,xr,zr,Br,Gr,wr,lr;if(ve(et)){le(De,Je,Ue),It=J(Je,de,Me,Ce);var Dr=Te(et,It),Hr=Dr.pointNumbers.length>0;if(Hr?Fe(It,Dr):Ge(It)&&(Br=Ae(Dr))){for(He&&He.remove(),lr=0;lr<It.length;lr++)zt=It[lr],zt._module.selectPoints(zt,!1);rt(Je,It),k(Ue),mt&&sr(Je)}else{Gr=De.shiftKey&&(Br!==void 0?Br:Ae(Dr)),Ut=Ie(Dr.pointNumber,Dr.searchInfo,Gr);var Rr=Ue.selectionDefs.concat([Ut]);for(or=D(Rr),lr=0;lr<It.length;lr++)if(xr=It[lr]._module.selectPoints(It[lr],or),zr=ct(xr,It[lr]),yt.length)for(var Ar=0;Ar<zr.length;Ar++)yt.push(zr[Ar]);else yt=zr;if(wr={points:yt},rt(Je,It,wr),Ut&&Ue&&Ue.selectionDefs.push(Ut),He){var Er=Ue.mergedPolygons,_r=b(Ue.dragmode);T(Oe(Er,_r),He,Ue)}mt&&Jt(Je,wr)}}}function Ie(De,Je,de){return{pointNumber:De,searchInfo:Je,subtract:!!de}}function Q(De){return"pointNumber"in De&&"searchInfo"in De}function ee(De){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(Je,de,Me,Ce){var Ue=De.searchInfo.cd[0].trace.index,He=Ce.cd[0].trace.index;return He===Ue&&Me===De.pointNumber},isRect:!1,degenerate:!1,subtract:!!De.subtract}}function D(De){if(!De.length)return;for(var Je=[],de=Q(De[0])?0:De[0][0][0],Me=de,Ce=Q(De[0])?0:De[0][0][1],Ue=Ce,He=0;He<De.length;He++)if(Q(De[He]))Je.push(ee(De[He]));else{var et=B(De[He]);et.subtract=!!De[He].subtract,Je.push(et),de=Math.min(de,et.xmin),Me=Math.max(Me,et.xmax),Ce=Math.min(Ce,et.ymin),Ue=Math.max(Ue,et.ymax)}function at(xt,mt,yt,It){for(var zt=!1,Ut=0;Ut<Je.length;Ut++)Je[Ut].contains(xt,mt,yt,It)&&(zt=!Je[Ut].subtract);return zt}return{xmin:de,xmax:Me,ymin:Ce,ymax:Ue,pts:[],contains:at,isRect:!1,degenerate:!1}}function le(De,Je,de){var Me=Je._fullLayout,Ce=de.plotinfo,Ue=de.dragmode,He=Me._lastSelectedSubplot&&Me._lastSelectedSubplot===Ce.id,et=(De.shiftKey||De.altKey)&&!(g(Ue)&&b(Ue));He&&et&&Ce.selection&&Ce.selection.selectionDefs&&!de.selectionDefs?(de.selectionDefs=Ce.selection.selectionDefs,de.mergedPolygons=Ce.selection.mergedPolygons):(!et||!Ce.selection)&&k(de),He||(C(Je),Me._lastSelectedSubplot=Ce.id)}function ge(De){return De._fullLayout._activeShapeIndex>=0}function j(De){return De._fullLayout._activeSelectionIndex>=0}function k(De,Je){var de=De.dragmode,Me=De.plotinfo,Ce=De.gd;ge(Ce)&&Ce._fullLayout._deactivateShape(Ce),j(Ce)&&Ce._fullLayout._deactivateSelection(Ce);var Ue=Ce._fullLayout,He=Ue._zoomlayer,et=g(de),at=L(de);if(et||at){var xt=He.selectAll(".select-outline-"+Me.id);if(xt&&Ce._fullLayout._outlining){var mt;et&&(mt=R(xt,De)),mt&&s.call("_guiRelayout",Ce,{shapes:mt});var yt;at&&!xe(De)&&(yt=N(xt,De)),yt&&(Ce._fullLayout._noEmitSelectedAtStart=!0,s.call("_guiRelayout",Ce,{selections:yt}).then(function(){Je&&te(Ce)})),Ce._fullLayout._outlining=!1}}Me.selection={},Me.selection.selectionDefs=De.selectionDefs=[],Me.selection.mergedPolygons=De.mergedPolygons=[]}function F(De){return De._id}function J(De,Je,de,Me){if(!De.calcdata)return[];var Ce=[],Ue=Je.map(F),He=de.map(F),et,at,xt;for(xt=0;xt<De.calcdata.length;xt++)if(et=De.calcdata[xt],at=et[0].trace,!(at.visible!==!0||!at._module||!at._module.selectPoints))if(xe({subplot:Me})&&(at.subplot===Me||at.geo===Me))Ce.push(K(at._module,et,Je[0],de[0]));else if(at.type==="splom"){if(at._xaxes[Ue[0]]&&at._yaxes[He[0]]){var mt=K(at._module,et,Je[0],de[0]);mt.scene=De._fullLayout._splomScenes[at.uid],Ce.push(mt)}}else if(at.type==="sankey"){var yt=K(at._module,et,Je[0],de[0]);Ce.push(yt)}else{if(Ue.indexOf(at.xaxis)===-1&&(!at._xA||!at._xA.overlaying)||He.indexOf(at.yaxis)===-1&&(!at._yA||!at._yA.overlaying))continue;Ce.push(K(at._module,et,G(De,at.xaxis),G(De,at.yaxis)))}return Ce}function K(De,Je,de,Me){return{_module:De,cd:Je,xaxis:de,yaxis:Me}}function ve(De){return De&&Array.isArray(De)&&De[0].hoverOnBox!==!0}function Te(De,Je){var de=De[0],Me=-1,Ce=[],Ue,He;for(He=0;He<Je.length;He++)if(Ue=Je[He],de.fullData.index===Ue.cd[0].trace.index){if(de.hoverOnBox===!0)break;de.pointNumber!==void 0?Me=de.pointNumber:de.binNumber!==void 0&&(Me=de.binNumber,Ce=de.pointNumbers);break}return{pointNumber:Me,pointNumbers:Ce,searchInfo:Ue}}function Ae(De){var Je=De.searchInfo.cd[0].trace,de=De.pointNumber,Me=De.pointNumbers,Ce=Me.length>0,Ue=Ce?Me[0]:de;return Je.selectedpoints?Je.selectedpoints.indexOf(Ue)>-1:!1}function Fe(De,Je){var de=[],Me,Ce,Ue,He;for(He=0;He<De.length;He++)Me=De[He],Me.cd[0].trace.selectedpoints&&Me.cd[0].trace.selectedpoints.length>0&&de.push(Me);if(de.length===1&&(Ue=de[0]===Je.searchInfo,Ue&&(Ce=Je.searchInfo.cd[0].trace,Ce.selectedpoints.length===Je.pointNumbers.length))){for(He=0;He<Je.pointNumbers.length;He++)if(Ce.selectedpoints.indexOf(Je.pointNumbers[He])<0)return!1;return!0}return!1}function Ge(De){var Je=0,de,Me,Ce;for(Ce=0;Ce<De.length;Ce++)if(de=De[Ce],Me=de.cd[0].trace,Me.selectedpoints&&(Me.selectedpoints.length>1||(Je+=Me.selectedpoints.length,Je>1)))return!1;return Je===1}function rt(De,Je,de){var Me;for(Me=0;Me<Je.length;Me++){var Ce=Je[Me].cd[0].trace._fullInput,Ue=De._fullLayout._tracePreGUI[Ce.uid]||{};Ue.selectedpoints===void 0&&(Ue.selectedpoints=Ce._input.selectedpoints||null)}var He;if(de){var et=de.points||[];for(Me=0;Me<Je.length;Me++)He=Je[Me].cd[0].trace,He._input.selectedpoints=He._fullInput.selectedpoints=[],He._fullInput!==He&&(He.selectedpoints=[]);for(var at=0;at<et.length;at++){var xt=et[at],mt=xt.data,yt=xt.fullData,It=xt.pointIndex,zt=xt.pointIndices;zt?([].push.apply(mt.selectedpoints,zt),He._fullInput!==He&&[].push.apply(yt.selectedpoints,zt)):(mt.selectedpoints.push(It),He._fullInput!==He&&yt.selectedpoints.push(It))}}else for(Me=0;Me<Je.length;Me++)He=Je[Me].cd[0].trace,delete He.selectedpoints,delete He._input.selectedpoints,He._fullInput!==He&&delete He._fullInput.selectedpoints;bt(De,Je)}function bt(De,Je){for(var de=!1,Me=0;Me<Je.length;Me++){var Ce=Je[Me],Ue=Ce.cd;s.traceIs(Ue[0].trace,"regl")&&(de=!0);var He=Ce._module,et=He.styleOnSelect||He.style;et&&(et(De,Ue,Ue[0].node3),Ue[0].nodeRangePlot3&&et(De,Ue,Ue[0].nodeRangePlot3))}de&&(Z(De),Y(De))}function ht(De,Je,de){for(var Me=de?d.difference:d.union,Ce=Me({regions:De},{regions:[Je]}),Ue=Ce.regions.reverse(),He=0;He<Ue.length;He++){var et=Ue[He];et.subtract=kt(et,Ue.slice(0,He))}return Ue}function ct(De,Je){if(Array.isArray(De))for(var de=Je.cd,Me=Je.cd[0].trace,Ce=0;Ce<De.length;Ce++)De[Ce]=p(De[Ce],Me,de);return De}function Oe(De,Je){for(var de=[],Me=0;Me<De.length;Me++){de[Me]=[];for(var Ce=0;Ce<De[Me].length;Ce++){de[Me][Ce]=[],de[Me][Ce][0]=Ce?"L":"M";for(var Ue=0;Ue<De[Me][Ce].length;Ue++)de[Me][Ce].push(De[Me][Ce][Ue])}Je||de[Me].push(["Z",de[Me][0][1],de[Me][0][2]])}return de}function ze(De,Je){for(var de=[],Me,Ce=[],Ue,He=0;He<Je.length;He++){var et=Je[He];Ue=et._module.selectPoints(et,De),Ce.push(Ue),Me=ct(Ue,et),de=de.concat(Me)}return de}function we(De,Je,de,Me,Ce){var Ue=!!Me,He,et,at;Ce&&(He=Ce.plotinfo,et=Ce.xaxes[0]._id,at=Ce.yaxes[0]._id);var xt=[],mt=[],yt=Tt(De),It=De._fullLayout;if(He){var zt=It._zoomlayer,Ut=It.dragmode,or=g(Ut),xr=L(Ut);if(or||xr){var zr=G(De,et,"x"),Br=G(De,at,"y");if(zr&&Br){var Gr=zt.selectAll(".select-outline-"+He.id);if(Gr&&De._fullLayout._outlining&&Gr.length){for(var wr=Gr[0][0],lr=wr.getAttribute("d"),Dr=A(lr,De,He),Hr=[],Rr=0;Rr<Dr.length;Rr++){for(var Ar=Dr[Rr],Er=[],_r=0;_r<Ar.length;_r++)Er.push([Nt(zr,Ar[_r][1]),Nt(Br,Ar[_r][2])]);Er.xref=et,Er.yref=at,Er.subtract=kt(Er,Hr),Hr.push(Er)}yt=yt.concat(Hr)}}}}var rn=et&&at?[et+at]:It._subplots.cartesian;je(De);for(var gn={},Ur=0;Ur<rn.length;Ur++){var vn=rn[Ur],Cn=vn.indexOf("y"),Vn=vn.slice(0,Cn),Gn=vn.slice(Cn),sn=et&&at?de:void 0;if(sn=Lt(yt,Vn,Gn,sn),sn){var Fn=Me;if(!Ue){var Tn=G(De,Vn,"x"),Mr=G(De,Gn,"y");Fn=J(De,[Tn],[Mr],vn);for(var oa=0;oa<Fn.length;oa++){var pe=Fn[oa],he=pe.cd[0],Ye=he.trace;if(pe._module.name==="scattergl"&&!he.t.xpx){var tt=Ye.x,lt=Ye.y,We=Ye._length;he.t.xpx=[],he.t.ypx=[];for(var Ze=0;Ze<We;Ze++)he.t.xpx[Ze]=Tn.c2p(tt[Ze]),he.t.ypx[Ze]=Mr.c2p(lt[Ze])}pe._module.name==="splom"&&(gn[Ye.uid]||(gn[Ye.uid]=!0))}}var dt=ze(sn,Fn);xt=xt.concat(dt),mt=mt.concat(Fn)}}var it={points:xt};rt(De,mt,it);var At=It.clickmode,Rt=At.indexOf("event")>-1&&Je;if(!He&&Je){var Yt=Tt(De,!0);if(Yt.length){var pr=Yt[0].xref,fr=Yt[0].yref;if(pr&&fr){var Sr=Pt(Yt),hr=St([G(De,pr,"x"),G(De,fr,"y")]);hr(it,Sr)}}De._fullLayout._noEmitSelectedAtStart?De._fullLayout._noEmitSelectedAtStart=!1:Rt&&Jt(De,it),It._reselect=!1}if(!He&&It._deselect){var Cr=It._deselect;et=Cr.xref,at=Cr.yref,ot(et,at,mt)||vt(De,et,at,Me),Rt&&(it.points.length?Jt(De,it):sr(De)),It._deselect=!1}return{eventData:it,selectionTesters:de}}function je(De){var Je=De.calcdata;if(Je)for(var de=0;de<Je.length;de++){var Me=Je[de][0],Ce=Me.trace,Ue=De._fullLayout._splomScenes;if(Ue){var He=Ue[Ce.uid];He&&(He.selectBatch=[])}}}function ot(De,Je,de){for(var Me=0;Me<de.length;Me++){var Ce=de[Me];if(Ce.xaxis&&Ce.xaxis._id===De&&Ce.yaxis&&Ce.yaxis._id===Je)return!0}return!1}function vt(De,Je,de,Me){Me=J(De,[G(De,Je,"x")],[G(De,de,"y")],Je+de);for(var Ce=0;Ce<Me.length;Ce++){var Ue=Me[Ce];Ue._module.selectPoints(Ue,!1)}rt(De,Me)}function Lt(De,Je,de,Me){for(var Ce,Ue=0;Ue<De.length;Ue++){var He=De[Ue];if(!(Je!==He.xref||de!==He.yref))if(Ce){var et=!!He.subtract;Ce=ht(Ce,He,et),Me=D(Ce)}else Ce=[He],Me=B(He)}return Me}function Tt(De,Je){for(var de=[],Me=De._fullLayout,Ce=Me.selections,Ue=Ce.length,He=0;He<Ue;He++)if(!(Je&&He!==Me._activeSelectionIndex)){var et=Ce[He];if(et){var at=et.xref,xt=et.yref,mt=G(De,at,"x"),yt=G(De,xt,"y"),It,zt,Ut,or,xr;if(et.type==="rect"){xr=[];var zr=Nt(mt,et.x0),Br=Nt(mt,et.x1),Gr=Nt(yt,et.y0),wr=Nt(yt,et.y1);xr=[[zr,Gr],[zr,wr],[Br,wr],[Br,Gr]],It=Math.min(zr,Br),zt=Math.max(zr,Br),Ut=Math.min(Gr,wr),or=Math.max(Gr,wr),xr.xmin=It,xr.xmax=zt,xr.ymin=Ut,xr.ymax=or,xr.xref=at,xr.yref=xt,xr.subtract=!1,xr.isRect=!0,de.push(xr)}else if(et.type==="path")for(var lr=et.path.split("Z"),Dr=[],Hr=0;Hr<lr.length;Hr++){var Rr=lr[Hr];if(Rr){Rr+="Z";var Ar=S.extractPathCoords(Rr,M.paramIsX,"raw"),Er=S.extractPathCoords(Rr,M.paramIsY,"raw");It=1/0,zt=-1/0,Ut=1/0,or=-1/0,xr=[];for(var _r=0;_r<Ar.length;_r++){var rn=Nt(mt,Ar[_r]),gn=Nt(yt,Er[_r]);xr.push([rn,gn]),It=Math.min(rn,It),zt=Math.max(rn,zt),Ut=Math.min(gn,Ut),or=Math.max(gn,or)}xr.xmin=It,xr.xmax=zt,xr.ymin=Ut,xr.ymax=or,xr.xref=at,xr.yref=xt,xr.subtract=kt(xr,Dr),Dr.push(xr),de.push(xr)}}}}return de}function kt(De,Je){for(var de=!1,Me=0;Me<Je.length;Me++)for(var Ce=Je[Me],Ue=0;Ue<De.length;Ue++)if(i(De[Ue],Ce)){de=!de;break}return de}function Nt(De,Je){return De.type==="date"&&(Je=Je.replace("_"," ")),De.type==="log"?De.c2p(Je):De.r2p(Je,null,De.calendar)}function Pt(De){for(var Je=De.length,de=[],Me=0;Me<Je;Me++){var Ce=De[Me];de=de.concat(Ce),de=de.concat([Ce[0]])}return Wt(de)}function Wt(De){return De.isRect=De.length===5&&De[0][0]===De[4][0]&&De[0][1]===De[4][1]&&De[0][0]===De[1][0]&&De[2][0]===De[3][0]&&De[0][1]===De[3][1]&&De[1][1]===De[2][1]||De[0][1]===De[1][1]&&De[2][1]===De[3][1]&&De[0][0]===De[3][0]&&De[1][0]===De[2][0],De.isRect&&(De.xmin=Math.min(De[0][0],De[2][0]),De.xmax=Math.max(De[0][0],De[2][0]),De.ymin=Math.min(De[0][1],De[2][1]),De.ymax=Math.max(De[0][1],De[2][1])),De}function St(De){return function(Je,de){for(var Me,Ce,Ue=0;Ue<De.length;Ue++){var He=De[Ue],et=He._id,at=et.charAt(0);if(de.isRect){Me||(Me={});var xt=de[at+"min"],mt=de[at+"max"];xt!==void 0&&mt!==void 0&&(Me[et]=[se(He,xt),se(He,mt)].sort(U))}else Ce||(Ce={}),Ce[et]=de.map(ye(He))}Me&&(Je.range=Me),Ce&&(Je.lassoPoints=Ce)}}function Qt(De){var Je=De.plotinfo;return Je.fillRangeItems||St(De.xaxes.concat(De.yaxes))}function rr(De,Je){De.emit("plotly_selecting",Je)}function Jt(De,Je){Je&&(Je.selections=(De.layout||{}).selections||[]),De.emit("plotly_selected",Je)}function sr(De){De.emit("plotly_deselect",null)}V.exports={reselect:we,prepSelect:Re,clearOutline:C,clearSelectionsCache:k,selectOnClick:ke}}),Hm=t((W,V)=>{V.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]}),cd=t((W,V)=>{V.exports={axisRefDescription:function(d,i,s){return["If set to a",d,"axis id (e.g. *"+d+"* or","*"+d+"2*), the `"+d+"` position refers to a",d,"coordinate. If set to *paper*, the `"+d+"`","position refers to the distance from the",i,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",i,"("+s+"). If set to a",d,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",i,"of the domain of that axis: e.g.,","*"+d+"2 domain* refers to the domain of the second",d," axis and a",d,"position of 0.5 refers to the","point between the",i,"and the",s,"of the domain of the","second",d,"axis."].join(" ")}}}),ru=t((W,V)=>{var d=Hm(),i=pt(),s=kn(),f=fn().templatedArray;cd(),V.exports=f("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:i({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:d.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:d.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",s.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",s.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",s.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",s.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:i({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc"})}),hf=t((W,V)=>{V.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}}),mx=t((W,V)=>{V.exports=function(d){return{valType:"color",editType:"style",anim:!0}}}),rc=t((W,V)=>{var d=Fi().axisHoverFormat,i=jr().texttemplateAttrs,s=jr().hovertemplateAttrs,f=Wi(),u=pt(),h=Wr().dash,p=Wr().pattern,v=Ra(),o=hf(),w=gt().extendFlat,g=mx();function b(M){return{valType:"any",dflt:0,editType:"calc"}}function L(M){return{valType:"any",editType:"calc"}}function S(M){return{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"}}V.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:b(),yperiod:b(),xperiod0:L(),yperiod0:L(),xperiodalignment:S(),yperiodalignment:S(),xhoverformat:d("x"),yhoverformat:d("y"),offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:i({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:s({},{keys:o.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:w({},h,{editType:"style"}),backoff:{valType:"number",min:0,dflt:"auto",arrayOk:!0,editType:"plot"},simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:g(!0),fillgradient:w({type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],dflt:"none",editType:"calc"},start:{valType:"number",editType:"calc"},stop:{valType:"number",editType:"calc"},colorscale:{valType:"colorscale",editType:"style"},editType:"calc"}),fillpattern:p,marker:w({symbol:{valType:"enumerated",values:v.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},angle:{valType:"angle",dflt:0,arrayOk:!0,editType:"plot",anim:!1},angleref:{valType:"enumerated",values:["previous","up"],dflt:"up",editType:"plot",anim:!1},standoff:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"plot",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:w({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},f("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},f("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:u({editType:"calc",colorEditType:"style",arrayOk:!0}),zorder:{valType:"integer",dflt:0,editType:"plot"}}}),Vm=t((W,V)=>{var d=ru(),i=rc().line,s=Wr().dash,f=gt().extendFlat,u=Ft().overrideAll,h=fn().templatedArray;cd(),V.exports=u(h("selection",{type:{valType:"enumerated",values:["rect","path"]},xref:f({},d.xref,{}),yref:f({},d.yref,{}),x0:{valType:"any"},x1:{valType:"any"},y0:{valType:"any"},y1:{valType:"any"},path:{valType:"string",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:.7,editType:"arraydraw"},line:{color:i.color,width:f({},i.width,{min:1,dflt:1}),dash:f({},s,{dflt:"dot"})}}),"arraydraw","from-root")}),gx=t((W,V)=>{var d=Mt(),i=Ja(),s=No(),f=Vm(),u=xl();V.exports=function(p,v){s(p,v,{name:"selections",handleItemDefaults:h});for(var o=v.selections,w=0;w<o.length;w++){var g=o[w];g&&g.path===void 0&&(g.x0===void 0||g.x1===void 0||g.y0===void 0||g.y1===void 0)&&(v.selections[w]=null)}};function h(p,v,o){function w(Z,Y){return d.coerce(p,v,f,Z,Y)}var g=w("path"),b=g?"path":"rect",L=w("type",b),S=L!=="path";S&&delete v.path,w("opacity"),w("line.color"),w("line.width"),w("line.dash");for(var M=["x","y"],T=0;T<2;T++){var C=M[T],m={_fullLayout:o},y,A,R,N=i.coerceRef(p,v,m,C);if(y=i.getFromId(m,N),y._selectionIndices.push(v._index),R=u.rangeToShapePosition(y),A=u.shapePositionToRange(y),S){var te=C+"0",H=C+"1",U=p[te],P=p[H];p[te]=A(p[te],!0),p[H]=A(p[H],!0),i.coercePosition(v,m,w,N,te),i.coercePosition(v,m,w,N,H);var re=v[te],G=v[H];re!==void 0&&G!==void 0&&(v[te]=R(re),v[H]=R(G),p[te]=U,p[H]=P)}}S&&d.noneOrAll(p,v,["x0","x1","y0","y1"])}}),vx=t((W,V)=>{V.exports=function(d,i,s){s("newselection.mode");var f=s("newselection.line.width");f&&(s("newselection.line.color"),s("newselection.line.dash")),s("activeselection.fillcolor"),s("activeselection.opacity")}}),ud=t((W,V)=>{var d=an(),i=Mt(),s=aa();V.exports=function(f){return function(u,h){var p=u[f];if(Array.isArray(p))for(var v=d.subplotsRegistry.cartesian,o=v.idRegex,w=h._subplots,g=w.xaxis,b=w.yaxis,L=w.cartesian,S=h._has("cartesian"),M=0;M<p.length;M++){var T=p[M];if(i.isPlainObject(T)){var C=s.cleanId(T.xref,"x",!1),m=s.cleanId(T.yref,"y",!1),y=o.x.test(C),A=o.y.test(m);if(y||A){S||i.pushUnique(h._basePlotModules,v);var R=!1;y&&g.indexOf(C)===-1&&(g.push(C),R=!0),A&&b.indexOf(m)===-1&&(b.push(m),R=!0),R&&y&&A&&L.push(C+m)}}}}}}),nu=t((W,V)=>{var d=Um(),i=px();V.exports={moduleType:"component",name:"selections",layoutAttributes:Vm(),supplyLayoutDefaults:gx(),supplyDrawNewSelectionDefaults:vx(),includeBasePlot:ud()("selections"),draw:d.draw,drawOne:d.drawOne,reselect:i.reselect,prepSelect:i.prepSelect,clearOutline:i.clearOutline,clearSelectionsCache:i.clearSelectionsCache,selectOnClick:i.selectOnClick}}),yx=t((W,V)=>{var d=l(),i=Mt(),s=i.numberFormat,f=ft(),u=id(),h=an(),p=i.strTranslate,v=ja(),o=Xt(),w=Ra(),g=ws(),b=Ja(),L=ar(),S=Ot(),M=tu(),T=M.selectingOrDrawing,C=M.freeMode,m=fi().FROM_TL,y=nf(),A=df().redrawReglTraces,R=pn(),N=aa().getFromId,te=nu().prepSelect,H=nu().clearOutline,U=nu().selectOnClick,P=Fm(),re=kn(),G=re.MINDRAG,Z=re.MINZOOM,Y=!0;function X(K,ve,Te,Ae,Fe,Ge,rt,bt){var ht=K._fullLayout._zoomlayer,ct=rt+bt==="nsew",Oe=(rt+bt).length===1,ze,we,je,ot,vt,Lt,Tt,kt,Nt,Pt,Wt,St,Qt,rr,Jt,sr,De,Je,de,Me,Ce,Ue,He;Te+=ve.yaxis._shift;function et(){if(ze=ve.xaxis,we=ve.yaxis,Nt=ze._length,Pt=we._length,Tt=ze._offset,kt=we._offset,je={},je[ze._id]=ze,ot={},ot[we._id]=we,rt&&bt)for(var he=ve.overlays,Ye=0;Ye<he.length;Ye++){var tt=he[Ye].xaxis;je[tt._id]=tt;var lt=he[Ye].yaxis;ot[lt._id]=lt}vt=J(je),Lt=J(ot),Qt=B(vt,bt),rr=B(Lt,rt),Jt=!rr&&!Qt,St=k(K,K._fullLayout._axisMatchGroups,je,ot),Wt=k(K,K._fullLayout._axisConstraintGroups,je,ot,St);var We=Wt.isSubplotConstrained||St.isSubplotConstrained;sr=bt||We,De=rt||We;var Ze=K._fullLayout;Je=Ze._has("scattergl"),de=Ze._has("splom"),Me=Ze._has("svg")}et();var at=xe(rr+Qt,K._fullLayout.dragmode,ct),xt=ae(ve,rt+bt+"drag",at,Te,Ae,Fe,Ge);if(Jt&&!ct)return xt.onmousedown=null,xt.style.pointerEvents="none",xt;var mt={element:xt,gd:K,plotinfo:ve};mt.prepFn=function(he,Ye,tt){var lt=mt.dragmode,We=K._fullLayout.dragmode;We!==lt&&(mt.dragmode=We),et(),Ue=K._fullLayout._invScaleX,He=K._fullLayout._invScaleY,Jt||(ct?he.shiftKey?We==="pan"?We="zoom":T(We)||(We="pan"):he.ctrlKey&&(We="pan"):We="pan"),C(We)?mt.minDrag=1:mt.minDrag=void 0,T(We)?(mt.xaxes=vt,mt.yaxes=Lt,te(he,Ye,tt,mt,We)):(mt.clickFn=It,T(lt)&&yt(),Jt||(We==="zoom"?(mt.moveFn=Rr,mt.doneFn=Er,mt.minDrag=1,Hr(he,Ye,tt)):We==="pan"&&(mt.moveFn=Cn,mt.doneFn=Fn))),K._fullLayout._redrag=function(){var Ze=K._dragdata;if(Ze&&Ze.element===xt){var dt=K._fullLayout.dragmode;T(dt)||(et(),Tn([0,0,Nt,Pt]),mt.moveFn(Ze.dx,Ze.dy))}}};function yt(){mt.plotinfo.selection=!1,H(K)}function It(he,Ye){var tt=mt.gd;if(tt._fullLayout._activeShapeIndex>=0){tt._fullLayout._deactivateShape(tt);return}var lt=tt._fullLayout.clickmode;if(ee(tt),he===2&&!Oe&&sn(),ct)lt.indexOf("select")>-1&&U(Ye,tt,vt,Lt,ve.id,mt),lt.indexOf("event")>-1&&g.click(tt,Ye,ve.id);else if(he===1&&Oe){var We=rt?we:ze,Ze=rt==="s"||bt==="w"?0:1,dt=We._name+".range["+Ze+"]",it=ie(We,Ze),At="left",Rt="middle";if(We.fixedrange)return;rt?(Rt=rt==="n"?"top":"bottom",We.side==="right"&&(At="right")):bt==="e"&&(At="right"),tt._context.showAxisRangeEntryBoxes&&d.select(xt).call(v.makeEditable,{gd:tt,immediate:!0,background:tt._fullLayout.paper_bgcolor,text:String(it),fill:We.tickfont?We.tickfont.color:"#444",horizontalAlign:At,verticalAlign:Rt}).on("edit",function(Yt){var pr=We.d2r(Yt);pr!==void 0&&h.call("_guiRelayout",tt,dt,pr)})}}S.init(mt);var zt,Ut,or,xr,zr,Br,Gr,wr,lr,Dr;function Hr(he,Ye,tt){var lt=xt.getBoundingClientRect();zt=Ye-lt.left,Ut=tt-lt.top,K._fullLayout._calcInverseTransform(K);var We=i.apply3DTransform(K._fullLayout._invTransform)(zt,Ut);zt=We[0],Ut=We[1],or={l:zt,r:zt,w:0,t:Ut,b:Ut,h:0},xr=K._hmpixcount?K._hmlumcount/K._hmpixcount:f(K._fullLayout.plot_bgcolor).getLuminance(),zr="M0,0H"+Nt+"V"+Pt+"H0V0",Br=!1,Gr="xy",Dr=!1,wr=Re(ht,xr,Tt,kt,zr),lr=ke(ht,Tt,kt)}function Rr(he,Ye){if(K._transitioningWithDuration)return!1;var tt=Math.max(0,Math.min(Nt,Ue*he+zt)),lt=Math.max(0,Math.min(Pt,He*Ye+Ut)),We=Math.abs(tt-zt),Ze=Math.abs(lt-Ut);or.l=Math.min(zt,tt),or.r=Math.max(zt,tt),or.t=Math.min(Ut,lt),or.b=Math.max(Ut,lt);function dt(){Gr="",or.r=or.l,or.t=or.b,lr.attr("d","M0,0Z")}if(Wt.isSubplotConstrained)We>Z||Ze>Z?(Gr="xy",We/Nt>Ze/Pt?(Ze=We*Pt/Nt,Ut>lt?or.t=Ut-Ze:or.b=Ut+Ze):(We=Ze*Nt/Pt,zt>tt?or.l=zt-We:or.r=zt+We),lr.attr("d",j(or))):dt();else if(St.isSubplotConstrained)if(We>Z||Ze>Z){Gr="xy";var it=Math.min(or.l/Nt,(Pt-or.b)/Pt),At=Math.max(or.r/Nt,(Pt-or.t)/Pt);or.l=it*Nt,or.r=At*Nt,or.b=(1-it)*Pt,or.t=(1-At)*Pt,lr.attr("d",j(or))}else dt();else!rr||Ze<Math.min(Math.max(We*.6,G),Z)?We<G||!Qt?dt():(or.t=0,or.b=Pt,Gr="x",lr.attr("d",le(or,Ut))):!Qt||We<Math.min(Ze*.6,Z)?(or.l=0,or.r=Nt,Gr="y",lr.attr("d",ge(or,zt))):(Gr="xy",lr.attr("d",j(or)));or.w=or.r-or.l,or.h=or.b-or.t,Gr&&(Dr=!0),K._dragged=Dr,Ie(wr,lr,or,zr,Br,xr),Ar(),K.emit("plotly_relayouting",Ce),Br=!0}function Ar(){Ce={},(Gr==="xy"||Gr==="x")&&(se(vt,or.l/Nt,or.r/Nt,Ce,Wt.xaxes),Vn("x",Ce)),(Gr==="xy"||Gr==="y")&&(se(Lt,(Pt-or.b)/Pt,(Pt-or.t)/Pt,Ce,Wt.yaxes),Vn("y",Ce))}function Er(){Ar(),ee(K),Fn(),D(K)}var _r=[0,0,Nt,Pt],rn=null,gn=re.REDRAWDELAY,Ur=ve.mainplot?K._fullLayout._plots[ve.mainplot]:ve;function vn(he){if(!K._context._scrollZoom.cartesian&&!K._fullLayout._enablescrollzoom)return;if(yt(),K._transitioningWithDuration){he.preventDefault(),he.stopPropagation();return}et(),clearTimeout(rn);var Ye=-he.deltaY;if(isFinite(Ye)||(Ye=he.wheelDelta/10),!isFinite(Ye)){i.log("Did not find wheel motion attributes: ",he);return}var tt=Math.exp(-Math.min(Math.max(Ye,-20),20)/200),lt=Ur.draglayer.select(".nsewdrag").node().getBoundingClientRect(),We=(he.clientX-lt.left)/lt.width,Ze=(lt.bottom-he.clientY)/lt.height,dt;function it(At,Rt,Yt){if(At.fixedrange)return;var pr=i.simpleMap(At.range,At.r2l),fr=pr[0]+(pr[1]-pr[0])*Rt;function Sr(hr){return At.l2r(fr+(hr-fr)*Yt)}At.range=pr.map(Sr)}if(sr){for(bt||(We=.5),dt=0;dt<vt.length;dt++)it(vt[dt],We,tt);Vn("x"),_r[2]*=tt,_r[0]+=_r[2]*We*(1/tt-1)}if(De){for(rt||(Ze=.5),dt=0;dt<Lt.length;dt++)it(Lt[dt],Ze,tt);Vn("y"),_r[3]*=tt,_r[1]+=_r[3]*(1-Ze)*(1/tt-1)}Tn(_r),Gn(),K.emit("plotly_relayouting",Ce),rn=setTimeout(function(){K._fullLayout&&(_r=[0,0,Nt,Pt],Fn())},gn),he.preventDefault()}rt.length*bt.length!==1&&F(xt,vn);function Cn(he,Ye){if(he=he*Ue,Ye=Ye*He,K._transitioningWithDuration)return;if(K._fullLayout._replotting=!0,Qt==="ew"||rr==="ns"){var tt=Qt?-he:0,lt=rr?-Ye:0;if(St.isSubplotConstrained){if(Qt&&rr){var We=(he/Nt-Ye/Pt)/2;he=We*Nt,Ye=-We*Pt,tt=-he,lt=-Ye}rr?tt=-lt*Nt/Pt:lt=-tt*Pt/Nt}Qt&&(ye(vt,he),Vn("x")),rr&&(ye(Lt,Ye),Vn("y")),Tn([tt,lt,Nt,Pt]),Gn(),K.emit("plotly_relayouting",Ce);return}function Ze(Sr,hr,Cr){for(var Fr=1-hr,Un,on,la=0;la<Sr.length;la++){var bn=Sr[la];if(!bn.fixedrange){Un=bn,on=bn._rl[Fr]+(bn._rl[hr]-bn._rl[Fr])/me(Cr/bn._length);var ha=bn.l2r(on);ha!==!1&&ha!==void 0&&(bn.range[hr]=ha)}}return Un._length*(Un._rl[hr]-on)/(Un._rl[hr]-Un._rl[Fr])}var dt=Qt==="w"==(rr==="n")?1:-1;if(Qt&&rr&&(Wt.isSubplotConstrained||St.isSubplotConstrained)){var it=(he/Nt+dt*Ye/Pt)/2;he=it*Nt,Ye=dt*it*Pt}var At,Rt;if(Qt==="w"?he=Ze(vt,0,he):Qt==="e"?he=Ze(vt,1,-he):Qt||(he=0),rr==="n"?Ye=Ze(Lt,1,Ye):rr==="s"?Ye=Ze(Lt,0,-Ye):rr||(Ye=0),At=Qt==="w"?he:0,Rt=rr==="n"?Ye:0,Wt.isSubplotConstrained&&!St.isSubplotConstrained||St.isSubplotConstrained&&Qt&&rr&&dt>0){var Yt;if(St.isSubplotConstrained||!Qt&&rr.length===1){for(Yt=0;Yt<vt.length;Yt++)vt[Yt].range=vt[Yt]._r.slice(),P(vt[Yt],1-Ye/Pt);he=Ye*Nt/Pt,At=he/2}if(St.isSubplotConstrained||!rr&&Qt.length===1){for(Yt=0;Yt<Lt.length;Yt++)Lt[Yt].range=Lt[Yt]._r.slice(),P(Lt[Yt],1-he/Nt);Ye=he*Pt/Nt,Rt=Ye/2}}(!St.isSubplotConstrained||!rr)&&Vn("x"),(!St.isSubplotConstrained||!Qt)&&Vn("y");var pr=Nt-he,fr=Pt-Ye;St.isSubplotConstrained&&!(Qt&&rr)&&(Qt?(Rt=At?0:he*Pt/Nt,fr=pr*Pt/Nt):(At=Rt?0:Ye*Nt/Pt,pr=fr*Nt/Pt)),Tn([At,Rt,pr,fr]),Gn(),K.emit("plotly_relayouting",Ce)}function Vn(he,Ye){for(var tt=St.isSubplotConstrained?{x:Lt,y:vt}[he]:St[he+"axes"],lt=St.isSubplotConstrained?{x:vt,y:Lt}[he]:[],We=0;We<tt.length;We++){var Ze=tt[We],dt=Ze._id,it=St.xLinks[dt]||St.yLinks[dt],At=lt[0]||je[it]||ot[it];At&&(Ye?(Ye[Ze._name+".range[0]"]=Ye[At._name+".range[0]"],Ye[Ze._name+".range[1]"]=Ye[At._name+".range[1]"]):Ze.range=At.range.slice())}}function Gn(){var he=[],Ye;function tt(dt){for(Ye=0;Ye<dt.length;Ye++)dt[Ye].fixedrange||he.push(dt[Ye]._id)}function lt(dt,it){for(Ye=0;Ye<dt.length;Ye++){var At=dt[Ye],Rt=At[it];!At.fixedrange&&Rt.tickmode==="sync"&&he.push(Rt._id)}}for(sr&&(tt(vt),tt(Wt.xaxes),tt(St.xaxes),lt(ve.overlays,"xaxis")),De&&(tt(Lt),tt(Wt.yaxes),tt(St.yaxes),lt(ve.overlays,"yaxis")),Ce={},Ye=0;Ye<he.length;Ye++){var We=he[Ye],Ze=N(K,We);b.drawOne(K,Ze,{skipTitle:!0}),Ce[Ze._name+".range[0]"]=Ze.range[0],Ce[Ze._name+".range[1]"]=Ze.range[1]}b.redrawComponents(K,he)}function sn(){if(!K._transitioningWithDuration){var he=K._context.doubleClick,Ye=[];Qt&&(Ye=Ye.concat(vt)),rr&&(Ye=Ye.concat(Lt)),St.xaxes&&(Ye=Ye.concat(St.xaxes)),St.yaxes&&(Ye=Ye.concat(St.yaxes));var tt={},lt,We;if(he==="reset+autosize")for(he="autosize",We=0;We<Ye.length;We++){lt=Ye[We];var Ze=lt._rangeInitial0,dt=lt._rangeInitial1,it=Ze!==void 0||dt!==void 0;if(it&&(Ze!==void 0&&Ze!==lt.range[0]||dt!==void 0&&dt!==lt.range[1])||!it&&lt.autorange!==!0){he="reset";break}}if(he==="autosize")for(We=0;We<Ye.length;We++)lt=Ye[We],lt.fixedrange||(tt[lt._name+".autorange"]=!0);else if(he==="reset"){for((Qt||Wt.isSubplotConstrained)&&(Ye=Ye.concat(Wt.xaxes)),rr&&!Wt.isSubplotConstrained&&(Ye=Ye.concat(Wt.yaxes)),Wt.isSubplotConstrained&&(Qt?rr||(Ye=Ye.concat(Lt)):Ye=Ye.concat(vt)),We=0;We<Ye.length;We++)if(lt=Ye[We],!lt.fixedrange){var At=lt._name,Rt=lt._autorangeInitial;lt._rangeInitial0===void 0&&lt._rangeInitial1===void 0?tt[At+".autorange"]=!0:lt._rangeInitial0===void 0?(tt[At+".autorange"]=Rt,tt[At+".range"]=[null,lt._rangeInitial1]):lt._rangeInitial1===void 0?(tt[At+".range"]=[lt._rangeInitial0,null],tt[At+".autorange"]=Rt):tt[At+".range"]=[lt._rangeInitial0,lt._rangeInitial1]}}K.emit("plotly_doubleclick",null),h.call("_guiRelayout",K,tt)}}function Fn(){Tn([0,0,Nt,Pt]),i.syncOrAsync([R.previousPromises,function(){K._fullLayout._replotting=!1,h.call("_guiRelayout",K,Ce)}],K)}function Tn(he){var Ye=K._fullLayout,tt=Ye._plots,lt=Ye._subplots.cartesian,We,Ze,dt,it;if(de&&h.subplotsRegistry.splom.drag(K),Je){for(We=0;We<lt.length;We++)if(Ze=tt[lt[We]],dt=Ze.xaxis,it=Ze.yaxis,Ze._scene){dt.limitRange&&dt.limitRange(),it.limitRange&&it.limitRange();var At=i.simpleMap(dt.range,dt.r2l),Rt=i.simpleMap(it.range,it.r2l);Ze._scene.update({range:[At[0],Rt[0],At[1],Rt[1]]})}}if((de||Je)&&(y(K),A(K)),Me){var Yt=he[2]/ze._length,pr=he[3]/we._length;for(We=0;We<lt.length;We++){Ze=tt[lt[We]],dt=Ze.xaxis,it=Ze.yaxis;var fr=(sr||St.isSubplotConstrained)&&!dt.fixedrange&&je[dt._id],Sr=(De||St.isSubplotConstrained)&&!it.fixedrange&&ot[it._id],hr,Cr,Fr,Un;if(fr?(hr=Yt,Fr=bt||St.isSubplotConstrained?he[0]:pe(dt,hr)):St.xaHash[dt._id]?(hr=Yt,Fr=he[0]*dt._length/ze._length):St.yaHash[dt._id]?(hr=pr,Fr=rr==="ns"?-he[1]*dt._length/we._length:pe(dt,hr,{n:"top",s:"bottom"}[rr])):(hr=Mr(dt,Yt,pr),Fr=oa(dt,hr)),hr>1&&(dt.maxallowed!==void 0&&sr===(dt.range[0]<dt.range[1]?"e":"w")||dt.minallowed!==void 0&&sr===(dt.range[0]<dt.range[1]?"w":"e"))&&(hr=1,Fr=0),Sr?(Cr=pr,Un=rt||St.isSubplotConstrained?he[1]:pe(it,Cr)):St.yaHash[it._id]?(Cr=pr,Un=he[1]*it._length/we._length):St.xaHash[it._id]?(Cr=Yt,Un=Qt==="ew"?-he[0]*it._length/ze._length:pe(it,Cr,{e:"right",w:"left"}[Qt])):(Cr=Mr(it,Yt,pr),Un=oa(it,Cr)),Cr>1&&(it.maxallowed!==void 0&&De===(it.range[0]<it.range[1]?"n":"s")||it.minallowed!==void 0&&De===(it.range[0]<it.range[1]?"s":"n"))&&(Cr=1,Un=0),!(!hr&&!Cr)){hr||(hr=1),Cr||(Cr=1);var on=dt._offset-Fr/hr,la=it._offset-Un/Cr;Ze.clipRect.call(w.setTranslate,Fr,Un).call(w.setScale,hr,Cr),Ze.plot.call(w.setTranslate,on,la).call(w.setScale,1/hr,1/Cr),(hr!==Ze.xScaleFactor||Cr!==Ze.yScaleFactor)&&(w.setPointGroupScale(Ze.zoomScalePts,hr,Cr),w.setTextPointsScale(Ze.zoomScaleTxt,hr,Cr)),w.hideOutsideRangePoints(Ze.clipOnAxisFalseTraces,Ze),Ze.xScaleFactor=hr,Ze.yScaleFactor=Cr}}}}function Mr(he,Ye,tt){return he.fixedrange?0:sr&&Wt.xaHash[he._id]?Ye:De&&(Wt.isSubplotConstrained?Wt.xaHash:Wt.yaHash)[he._id]?tt:0}function oa(he,Ye){return Ye?(he.range=he._r.slice(),P(he,Ye),pe(he,Ye)):0}function pe(he,Ye,tt){return he._length*(1-Ye)*m[tt||he.constraintoward||"middle"]}return xt}function ne(K,ve,Te,Ae){var Fe=i.ensureSingle(K.draglayer,ve,Te,function(Ge){Ge.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",K.id)});return Fe.call(L,Ae),Fe.node()}function ae(K,ve,Te,Ae,Fe,Ge,rt){var bt=ne(K,"rect",ve,Te);return d.select(bt).call(w.setRect,Ae,Fe,Ge,rt),bt}function B(K,ve){for(var Te=0;Te<K.length;Te++)if(!K[Te].fixedrange)return ve;return""}function ie(K,ve){var Te=K.range[ve],Ae=Math.abs(Te-K.range[1-ve]),Fe;return K.type==="date"?Te:K.type==="log"?(Fe=Math.ceil(Math.max(0,-Math.log(Ae)/Math.LN10))+3,s("."+Fe+"g")(Math.pow(10,Te))):(Fe=Math.floor(Math.log(Math.abs(Te))/Math.LN10)-Math.floor(Math.log(Ae)/Math.LN10)+4,s("."+String(Fe)+"g")(Te))}function se(K,ve,Te,Ae,Fe){for(var Ge=0;Ge<K.length;Ge++){var rt=K[Ge];if(!rt.fixedrange)if(rt.rangebreaks){var bt=rt._id.charAt(0)==="y",ht=bt?1-ve:ve,ct=bt?1-Te:Te;Ae[rt._name+".range[0]"]=rt.l2r(rt.p2l(ht*rt._length)),Ae[rt._name+".range[1]"]=rt.l2r(rt.p2l(ct*rt._length))}else{var Oe=rt._rl[0],ze=rt._rl[1]-Oe;Ae[rt._name+".range[0]"]=rt.l2r(Oe+ze*ve),Ae[rt._name+".range[1]"]=rt.l2r(Oe+ze*Te)}}if(Fe&&Fe.length){var we=(ve+(1-Te))/2;se(Fe,we,1-we,Ae,[])}}function ye(K,ve){for(var Te=0;Te<K.length;Te++){var Ae=K[Te];if(!Ae.fixedrange){if(Ae.rangebreaks){var Fe=0,Ge=Ae._length,rt=Ae.p2l(Fe+ve)-Ae.p2l(Fe),bt=Ae.p2l(Ge+ve)-Ae.p2l(Ge),ht=(rt+bt)/2;Ae.range=[Ae.l2r(Ae._rl[0]-ht),Ae.l2r(Ae._rl[1]-ht)]}else Ae.range=[Ae.l2r(Ae._rl[0]-ve/Ae._m),Ae.l2r(Ae._rl[1]-ve/Ae._m)];Ae.limitRange&&Ae.limitRange()}}}function me(K){return 1-(K>=0?Math.min(K,.9):1/(1/Math.max(K,-.3)+3.222))}function xe(K,ve,Te){return K?K==="nsew"?Te?"":ve==="pan"?"move":"crosshair":K.toLowerCase()+"-resize":"pointer"}function Re(K,ve,Te,Ae,Fe){return K.append("path").attr("class","zoombox").style({fill:ve>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",p(Te,Ae)).attr("d",Fe+"Z")}function ke(K,ve,Te){return K.append("path").attr("class","zoombox-corners").style({fill:o.background,stroke:o.defaultLine,"stroke-width":1,opacity:0}).attr("transform",p(ve,Te)).attr("d","M0,0Z")}function Ie(K,ve,Te,Ae,Fe,Ge){K.attr("d",Ae+"M"+Te.l+","+Te.t+"v"+Te.h+"h"+Te.w+"v-"+Te.h+"h-"+Te.w+"Z"),Q(K,ve,Fe,Ge)}function Q(K,ve,Te,Ae){Te||(K.transition().style("fill",Ae>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ve.transition().style("opacity",1).duration(200))}function ee(K){d.select(K).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function D(K){Y&&K.data&&K._context.showTips&&(i.notifier(i._(K,"Double-click to zoom back out"),"long"),Y=!1)}function le(K,ve){return"M"+(K.l-.5)+","+(ve-Z-.5)+"h-3v"+(2*Z+1)+"h3ZM"+(K.r+.5)+","+(ve-Z-.5)+"h3v"+(2*Z+1)+"h-3Z"}function ge(K,ve){return"M"+(ve-Z-.5)+","+(K.t-.5)+"v-3h"+(2*Z+1)+"v3ZM"+(ve-Z-.5)+","+(K.b+.5)+"v3h"+(2*Z+1)+"v-3Z"}function j(K){var ve=Math.floor(Math.min(K.b-K.t,K.r-K.l,Z)/2);return"M"+(K.l-3.5)+","+(K.t-.5+ve)+"h3v"+-ve+"h"+ve+"v-3h-"+(ve+3)+"ZM"+(K.r+3.5)+","+(K.t-.5+ve)+"h-3v"+-ve+"h"+-ve+"v-3h"+(ve+3)+"ZM"+(K.r+3.5)+","+(K.b+.5-ve)+"h-3v"+ve+"h"+-ve+"v3h"+(ve+3)+"ZM"+(K.l-3.5)+","+(K.b+.5-ve)+"h3v"+ve+"h"+ve+"v3h-"+(ve+3)+"Z"}function k(K,ve,Te,Ae,Fe){for(var Ge=!1,rt={},bt={},ht,ct,Oe,ze,we=(Fe||{}).xaHash,je=(Fe||{}).yaHash,ot=0;ot<ve.length;ot++){var vt=ve[ot];for(ht in Te)if(vt[ht]){for(Oe in vt)!(Fe&&(we[Oe]||je[Oe]))&&!(Oe.charAt(0)==="x"?Te:Ae)[Oe]&&(rt[Oe]=ht);for(ct in Ae)!(Fe&&(we[ct]||je[ct]))&&vt[ct]&&(Ge=!0)}for(ct in Ae)if(vt[ct])for(ze in vt)!(Fe&&(we[ze]||je[ze]))&&!(ze.charAt(0)==="x"?Te:Ae)[ze]&&(bt[ze]=ct)}Ge&&(i.extendFlat(rt,bt),bt={});var Lt={},Tt=[];for(Oe in rt){var kt=N(K,Oe);Tt.push(kt),Lt[kt._id]=kt}var Nt={},Pt=[];for(ze in bt){var Wt=N(K,ze);Pt.push(Wt),Nt[Wt._id]=Wt}return{xaHash:Lt,yaHash:Nt,xaxes:Tt,yaxes:Pt,xLinks:rt,yLinks:bt,isSubplotConstrained:Ge}}function F(K,ve){if(!u)K.onwheel!==void 0?K.onwheel=ve:K.onmousewheel!==void 0?K.onmousewheel=ve:K.isAddedWheelEvent||(K.isAddedWheelEvent=!0,K.addEventListener("wheel",ve,{passive:!1}));else{var Te=K.onwheel!==void 0?"wheel":"mousewheel";K._onwheel&&K.removeEventListener(Te,K._onwheel),K._onwheel=ve,K.addEventListener(Te,ve,{passive:!1})}}function J(K){var ve=[];for(var Te in K)ve.push(K[Te]);return ve}V.exports={makeDragBox:X,makeDragger:ne,makeRectDragger:ae,makeZoombox:Re,makeCorners:ke,updateZoombox:Ie,xyCorners:j,transitionZoombox:Q,removeZoombox:ee,showDoubleClickNotifier:D,attachWheelEventHandler:F}}),Gm=t(W=>{var V=l(),d=ws(),i=Ot(),s=ar(),f=yx().makeDragBox,u=kn().DRAGGERSIZE;W.initInteractions=function(h){var p=h._fullLayout;if(h._context.staticPlot){V.select(h).selectAll(".drag").remove();return}if(!(!p._has("cartesian")&&!p._has("splom"))){var v=Object.keys(p._plots||{}).sort(function(w,g){if((p._plots[w].mainplot&&!0)===(p._plots[g].mainplot&&!0)){var b=w.split("y"),L=g.split("y");return b[0]===L[0]?Number(b[1]||1)-Number(L[1]||1):Number(b[0]||1)-Number(L[0]||1)}return p._plots[w].mainplot?1:-1});v.forEach(function(w){var g=p._plots[w],b=g.xaxis,L=g.yaxis;if(!g.mainplot){var S=f(h,g,b._offset,L._offset,b._length,L._length,"ns","ew");S.onmousemove=function(C){h._fullLayout._rehover=function(){h._fullLayout._hoversubplot===w&&h._fullLayout._plots[w]&&d.hover(h,C,w)},d.hover(h,C,w),h._fullLayout._lasthover=S,h._fullLayout._hoversubplot=w},S.onmouseout=function(C){h._dragging||(h._fullLayout._hoversubplot=null,i.unhover(h,C))},h._context.showAxisDragHandles&&(f(h,g,b._offset-u,L._offset-u,u,u,"n","w"),f(h,g,b._offset+b._length,L._offset-u,u,u,"n","e"),f(h,g,b._offset-u,L._offset+L._length,u,u,"s","w"),f(h,g,b._offset+b._length,L._offset+L._length,u,u,"s","e"))}if(h._context.showAxisDragHandles){if(w===b._mainSubplot){var M=b._mainLinePosition;b.side==="top"&&(M-=u),f(h,g,b._offset+b._length*.1,M,b._length*.8,u,"","ew"),f(h,g,b._offset,M,b._length*.1,u,"","w"),f(h,g,b._offset+b._length*.9,M,b._length*.1,u,"","e")}if(w===L._mainSubplot){var T=L._mainLinePosition;L.side!=="right"&&(T-=u),f(h,g,T,L._offset+L._length*.1,u,L._length*.8,"ns",""),f(h,g,T,L._offset+L._length*.9,u,L._length*.1,"s",""),f(h,g,T,L._offset,u,L._length*.1,"n","")}}});var o=p._hoverlayer.node();o.onmousemove=function(w){w.target=h._fullLayout._lasthover,d.hover(h,w,p._hoversubplot)},o.onclick=function(w){w.target=h._fullLayout._lasthover,d.click(h,w)},o.onmousedown=function(w){h._fullLayout._lasthover.onmousedown(w)},W.updateFx(h)}},W.updateFx=function(h){var p=h._fullLayout,v=p.dragmode==="pan"?"move":"crosshair";s(p._draggers,v)}}),xx=t((W,V)=>{var d=an();V.exports=function(i){for(var s=d.layoutArrayContainers,f=d.layoutArrayRegexes,u=i.split("[")[0],h,p,v=0;v<f.length;v++)if(p=i.match(f[v]),p&&p.index===0){h=p[0];break}if(h||(h=s[s.indexOf(u)]),!h)return!1;var o=i.substr(h.length);return o?(p=o.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/),p?{array:h,index:Number(p[1]),property:p[3]||""}:!1):{array:h,index:"",property:""}}}),_x=t(W=>{var V=_e(),d=Wn(),i=Sn(),s=Ka().sorterAsc,f=an();W.containerArrayMatch=xx();var u=W.isAddVal=function(p){return p==="add"||V(p)},h=W.isRemoveVal=function(p){return p===null||p==="remove"};W.applyContainerArrayChanges=function(p,v,o,w,g){var b=v.astr,L=f.getComponentMethod(b,"supplyLayoutDefaults"),S=f.getComponentMethod(b,"draw"),M=f.getComponentMethod(b,"drawOne"),T=w.replot||w.recalc||L===d||S===d,C=p.layout,m=p._fullLayout;if(o[""]){Object.keys(o).length>1&&i.warn("Full array edits are incompatible with other edits",b);var y=o[""][""];if(h(y))v.set(null);else if(Array.isArray(y))v.set(y);else return i.warn("Unrecognized full array edit value",b,y),!0;return T?!1:(L(C,m),S(p),!0)}var A=Object.keys(o).map(Number).sort(s),R=v.get(),N=R||[],te=g(m,b).get(),H=[],U=-1,P=N.length,re,G,Z,Y,X,ne,ae,B;for(re=0;re<A.length;re++){if(Z=A[re],Y=o[Z],X=Object.keys(Y),ne=Y[""],ae=u(ne),Z<0||Z>N.length-(ae?0:1)){i.warn("index out of range",b,Z);continue}if(ne!==void 0)X.length>1&&i.warn("Insertion & removal are incompatible with edits to the same index.",b,Z),h(ne)?H.push(Z):ae?(ne==="add"&&(ne={}),N.splice(Z,0,ne),te&&te.splice(Z,0,{})):i.warn("Unrecognized full object edit value",b,Z,ne),U===-1&&(U=Z);else for(G=0;G<X.length;G++)B=b+"["+Z+"].",g(N[Z],X[G],B).set(Y[X[G]])}for(re=H.length-1;re>=0;re--)N.splice(H[re],1),te&&te.splice(H[re],1);if(N.length?R||v.set(N):v.set(null),T)return!1;if(L(C,m),M!==d){var ie;if(U===-1)ie=A;else{for(P=Math.max(N.length,P),ie=[],re=0;re<A.length&&(Z=A[re],!(Z>=U));re++)ie.push(Z);for(re=U;re<P;re++)ie.push(re)}for(re=0;re<ie.length;re++)M(p,ie[re])}else S(p);return!0}}),bx=t(W=>{var V=q(),d=an(),i=Mt(),s=pn(),f=aa(),u=Xt(),h=f.cleanId,p=f.getFromTrace,v=d.traceIs,o=["x","y","z"];W.clearPromiseQueue=function(m){Array.isArray(m._promises)&&m._promises.length>0&&i.log("Clearing previous rejected promises from queue."),m._promises=[]},W.cleanLayout=function(m){var y;m||(m={}),m.xaxis1&&(m.xaxis||(m.xaxis=m.xaxis1),delete m.xaxis1),m.yaxis1&&(m.yaxis||(m.yaxis=m.yaxis1),delete m.yaxis1),m.scene1&&(m.scene||(m.scene=m.scene1),delete m.scene1);var A=(s.subplotsRegistry.cartesian||{}).attrRegex;(s.subplotsRegistry.polar||{}).attrRegex,(s.subplotsRegistry.ternary||{}).attrRegex,(s.subplotsRegistry.gl3d||{}).attrRegex;var R=Object.keys(m);for(y=0;y<R.length;y++){var N=R[y];if(A&&A.test(N)){var te=m[N];te.anchor&&te.anchor!=="free"&&(te.anchor=h(te.anchor)),te.overlaying&&(te.overlaying=h(te.overlaying)),te.type||(te.isdate?te.type="date":te.islog?te.type="log":te.isdate===!1&&te.islog===!1&&(te.type="linear")),(te.autorange==="withzero"||te.autorange==="tozero")&&(te.autorange=!0,te.rangemode="tozero"),te.insiderange&&delete te.range,delete te.islog,delete te.isdate,delete te.categories,S(te,"domain")&&delete te.domain}}var H=Array.isArray(m.annotations)?m.annotations.length:0;for(y=0;y<H;y++){var U=m.annotations[y];i.isPlainObject(U)&&(w(U,"xref"),w(U,"yref"))}var P=Array.isArray(m.shapes)?m.shapes.length:0;for(y=0;y<P;y++){var re=m.shapes[y];i.isPlainObject(re)&&(w(re,"xref"),w(re,"yref"))}var G=Array.isArray(m.images)?m.images.length:0;for(y=0;y<G;y++){var Z=m.images[y];i.isPlainObject(Z)&&(w(Z,"xref"),w(Z,"yref"))}var Y=m.legend;return Y&&(Y.x>3?(Y.x=1.02,Y.xanchor="left"):Y.x<-2&&(Y.x=-.02,Y.xanchor="right"),Y.y>3?(Y.y=1.02,Y.yanchor="bottom"):Y.y<-2&&(Y.y=-.02,Y.yanchor="top")),m.dragmode==="rotate"&&(m.dragmode="orbit"),u.clean(m),m.template&&m.template.layout&&W.cleanLayout(m.template.layout),m};function w(m,y){var A=m[y],R=y.charAt(0);A&&A!=="paper"&&(m[y]=h(A,R,!0))}W.cleanData=function(m){for(var y=0;y<m.length;y++){var A=m[y],R;if(A.type==="histogramy"&&"xbins"in A&&!("ybins"in A)&&(A.ybins=A.xbins,delete A.xbins),A.type==="histogramy"&&W.swapXYData(A),(A.type==="histogramx"||A.type==="histogramy")&&(A.type="histogram"),"scl"in A&&!("colorscale"in A)&&(A.colorscale=A.scl,delete A.scl),"reversescl"in A&&!("reversescale"in A)&&(A.reversescale=A.reversescl,delete A.reversescl),A.xaxis&&(A.xaxis=h(A.xaxis,"x")),A.yaxis&&(A.yaxis=h(A.yaxis,"y")),v(A,"gl3d")&&A.scene&&(A.scene=s.subplotsRegistry.gl3d.cleanId(A.scene)),!v(A,"pie-like")&&!v(A,"bar-like"))if(Array.isArray(A.textposition))for(R=0;R<A.textposition.length;R++)A.textposition[R]=L(A.textposition[R]);else A.textposition&&(A.textposition=L(A.textposition));var N=d.getModule(A);if(N&&N.colorbar){var te=N.colorbar.container,H=te?A[te]:A;H&&H.colorscale&&(H.colorscale==="YIGnBu"&&(H.colorscale="YlGnBu"),H.colorscale==="YIOrRd"&&(H.colorscale="YlOrRd"))}if(A.type==="surface"&&i.isPlainObject(A.contours)){var U=["x","y","z"];for(R=0;R<U.length;R++){var P=A.contours[U[R]];i.isPlainObject(P)&&(P.highlightColor&&(P.highlightcolor=P.highlightColor,delete P.highlightColor),P.highlightWidth&&(P.highlightwidth=P.highlightWidth,delete P.highlightWidth))}}if(A.type==="candlestick"||A.type==="ohlc"){var re=(A.increasing||{}).showlegend!==!1,G=(A.decreasing||{}).showlegend!==!1,Z=g(A.increasing),Y=g(A.decreasing);if(Z!==!1&&Y!==!1){var X=b(Z,Y,re,G);X&&(A.name=X)}else(Z||Y)&&!A.name&&(A.name=Z||Y)}S(A,"line")&&delete A.line,"marker"in A&&(S(A.marker,"line")&&delete A.marker.line,S(A,"marker")&&delete A.marker),u.clean(A),A.autobinx&&(delete A.autobinx,delete A.xbins),A.autobiny&&(delete A.autobiny,delete A.ybins)}};function g(m){if(!i.isPlainObject(m))return!1;var y=m.name;return delete m.name,delete m.showlegend,(typeof y=="string"||typeof y=="number")&&String(y)}function b(m,y,A,R){if(A&&!R)return m;if(R&&!A||!m.trim())return y;if(!y.trim())return m;var N=Math.min(m.length,y.length),te;for(te=0;te<N&&m.charAt(te)===y.charAt(te);te++);var H=m.substr(0,te);return H.trim()}function L(m){var y="middle",A="center";return typeof m=="string"&&(m.indexOf("top")!==-1?y="top":m.indexOf("bottom")!==-1&&(y="bottom"),m.indexOf("left")!==-1?A="left":m.indexOf("right")!==-1&&(A="right")),y+" "+A}function S(m,y){return y in m&&typeof m[y]=="object"&&Object.keys(m[y]).length===0}W.swapXYData=function(m){var y;if(i.swapAttrs(m,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(m.z)&&Array.isArray(m.z[0])&&(m.transpose?delete m.transpose:m.transpose=!0),m.error_x&&m.error_y){var A=m.error_y,R="copy_ystyle"in A?A.copy_ystyle:!(A.color||A.thickness||A.width);i.swapAttrs(m,["error_?.copy_ystyle"]),R&&i.swapAttrs(m,["error_?.color","error_?.thickness","error_?.width"])}if(typeof m.hoverinfo=="string"){var N=m.hoverinfo.split("+");for(y=0;y<N.length;y++)N[y]==="x"?N[y]="y":N[y]==="y"&&(N[y]="x");m.hoverinfo=N.join("+")}},W.coerceTraceIndices=function(m,y){if(V(y))return[y];if(!Array.isArray(y)||!y.length)return m.data.map(function(N,te){return te});if(Array.isArray(y)){for(var A=[],R=0;R<y.length;R++)i.isIndex(y[R],m.data.length)?A.push(y[R]):i.warn("trace index (",y[R],") is not a number or is out of bounds");return A}return y},W.manageArrayContainers=function(m,y,A){var R=m.obj,N=m.parts,te=N.length,H=N[te-1],U=V(H);if(U&&y===null){var P=N.slice(0,te-1).join("."),re=i.nestedProperty(R,P).get();re.splice(H,1)}else U&&m.get()===void 0&&m.get()===void 0&&(A[m.astr]=null),m.set(y)};var M=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function T(m){var y=m.search(M);if(y>0)return m.substr(0,y)}W.hasParent=function(m,y){for(var A=T(y);A;){if(A in m)return!0;A=T(A)}return!1},W.clearAxisTypes=function(m,y,A){for(var R=0;R<y.length;R++)for(var N=m._fullData[R],te=0;te<3;te++){var H=p(m,N,o[te]);if(H&&H.type!=="log"){var U=H._name,P=H._id.substr(1);if(P.substr(0,5)==="scene"){if(A[P]!==void 0)continue;U=P+"."+U}var re=U+".type";A[U]===void 0&&A[re]===void 0&&i.nestedProperty(m.layout,re).set(null)}}};var C=(m,y)=>{let A=(...R)=>R.every(N=>i.isPlainObject(N))||R.every(N=>Array.isArray(N));if([m,y].every(R=>Array.isArray(R))){if(m.length!==y.length)return!1;for(let R=0;R<m.length;R++){let N=m[R],te=y[R];if(N!==te&&!(A(N,te)&&C(N,te)))return!1}return!0}else if([m,y].every(R=>i.isPlainObject(R))){if(Object.keys(m).length!==Object.keys(y).length)return!1;for(let R in m){if(R.startsWith("_"))continue;let N=m[R],te=y[R];if(N!==te&&!(A(N,te)&&C(N,te)))return!1}return!0}return!1};W.collectionsAreEqual=C}),jm=t(W=>{var V=l(),d=q(),i=ir(),s=Mt(),f=s.nestedProperty,u=xn(),h=Pn(),p=an(),v=Hn(),o=pn(),w=Ja(),g=nd(),b=to(),L=Ra(),S=Xt(),M=Gm().initInteractions,T=xi(),C=nu().clearOutline,m=Tr().dfltConfig,y=_x(),A=bx(),R=df(),N=Ft(),te=kn().AX_NAME_PATTERN,H=0,U=5;function P(de,Me,Ce,Ue){var He;if(de=s.getGraphDiv(de),u.init(de),s.isPlainObject(Me)){var et=Me;Me=et.data,Ce=et.layout,Ue=et.config,He=et.frames}var at=u.triggerHandler(de,"plotly_beforeplot",[Me,Ce,Ue]);if(at===!1)return Promise.reject();!Me&&!Ce&&!s.isPlotDiv(de)&&s.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",de);function xt(){if(He)return W.addFrames(de,He)}X(de,Ue),Ce||(Ce={}),V.select(de).classed("js-plotly-plot",!0),L.makeTester(),Array.isArray(de._promises)||(de._promises=[]);var mt=(de.data||[]).length===0&&Array.isArray(Me);Array.isArray(Me)&&(A.cleanData(Me),mt?de.data=Me:de.data.push.apply(de.data,Me),de.empty=!1),(!de.layout||mt)&&(de.layout=A.cleanLayout(Ce)),o.supplyDefaults(de);var yt=de._fullLayout,It=yt._has("cartesian");yt._replotting=!0,(mt||yt._shouldCreateBgLayer)&&(Je(de),yt._shouldCreateBgLayer&&delete yt._shouldCreateBgLayer),L.initGradients(de),L.initPatterns(de),mt&&w.saveShowSpikeInitial(de);var zt=!de.calcdata||de.calcdata.length!==(de._fullData||[]).length;zt&&o.doCalcdata(de);for(var Ut=0;Ut<de.calcdata.length;Ut++)de.calcdata[Ut][0].trace=de._fullData[Ut];de._context.responsive?de._responsiveChartHandler||(de._responsiveChartHandler=function(){s.isHidden(de)||o.resize(de)},window.addEventListener("resize",de._responsiveChartHandler)):s.clearResponsive(de);var or=s.extendFlat({},yt._size),xr=0;function zr(){for(var Ar=yt._basePlotModules,Er=0;Er<Ar.length;Er++)Ar[Er].drawFramework&&Ar[Er].drawFramework(de);!yt._glcanvas&&yt._has("gl")&&(yt._glcanvas=yt._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(Ur){return Ur.key}),yt._glcanvas.enter().append("canvas").attr("class",function(Ur){return"gl-canvas gl-canvas-"+Ur.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var _r=de._context.plotGlPixelRatio;if(yt._glcanvas){yt._glcanvas.attr("width",yt.width*_r).attr("height",yt.height*_r).style("width",yt.width+"px").style("height",yt.height+"px");var rn=yt._glcanvas.data()[0].regl;if(rn&&(Math.floor(yt.width*_r)!==rn._gl.drawingBufferWidth||Math.floor(yt.height*_r)!==rn._gl.drawingBufferHeight)){var gn="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(xr)s.error(gn);else return s.log(gn+" Clearing graph and plotting again."),o.cleanPlot([],{},de._fullData,yt),o.supplyDefaults(de),yt=de._fullLayout,o.doCalcdata(de),xr++,zr()}}return yt.modebar.orientation==="h"?yt._modebardiv.style("height",null).style("width","100%"):yt._modebardiv.style("width",null).style("height",yt.height+"px"),o.previousPromises(de)}function Br(){if(o.clearAutoMarginIds(de),R.drawMarginPushers(de),w.allowAutoMargin(de),de._fullLayout.title.text&&de._fullLayout.title.automargin&&o.allowAutoMargin(de,"title.automargin"),yt._has("pie"))for(var Ar=de._fullData,Er=0;Er<Ar.length;Er++){var _r=Ar[Er];_r.type==="pie"&&_r.automargin&&o.allowAutoMargin(de,"pie."+_r.uid+".automargin")}return o.doAutoMargin(de),o.previousPromises(de)}function Gr(){if(o.didMarginChange(or,yt._size))return s.syncOrAsync([Br,R.layoutStyles],de)}function wr(){if(!zt){lr();return}return s.syncOrAsync([p.getComponentMethod("shapes","calcAutorange"),p.getComponentMethod("annotations","calcAutorange"),lr],de)}function lr(){de._transitioning||(R.doAutoRangeAndConstraints(de),mt&&w.saveRangeInitial(de),p.getComponentMethod("rangeslider","calcAutorange")(de))}function Dr(){return w.draw(de,mt?"":"redraw")}var Hr=[o.previousPromises,xt,zr,Br,Gr];It&&Hr.push(wr),Hr.push(R.layoutStyles),It&&Hr.push(Dr,function(Ar){var Er=Ar._fullLayout._insideTickLabelsUpdaterange;if(Er)return Ar._fullLayout._insideTickLabelsUpdaterange=void 0,ve(Ar,Er).then(function(){w.saveRangeInitial(Ar,!0)})}),Hr.push(R.drawData,R.finalDraw,M,o.addLinks,o.rehover,o.redrag,o.reselect,o.doAutoMargin,o.previousPromises);var Rr=s.syncOrAsync(Hr,de);return(!Rr||!Rr.then)&&(Rr=Promise.resolve()),Rr.then(function(){return re(de),de})}function re(de){var Me=de._fullLayout;Me._redrawFromAutoMarginCount?Me._redrawFromAutoMarginCount--:de.emit("plotly_afterplot")}function G(de){return s.extendFlat(m,de)}function Z(de,Me){try{de._fullLayout._paper.style("background",Me)}catch(Ce){s.error(Ce)}}function Y(de,Me){var Ce=S.combine(Me,"white");Z(de,Ce)}function X(de,Me){if(!de._context){de._context=s.extendDeep({},m);var Ce=V.select("base");de._context._baseUrl=Ce.size()&&Ce.attr("href")?window.location.href.split("#")[0]:""}var Ue=de._context,He,et,at;if(Me){for(et=Object.keys(Me),He=0;He<et.length;He++)at=et[He],!(at==="editable"||at==="edits")&&at in Ue&&(at==="setBackground"&&Me[at]==="opaque"?Ue[at]=Y:Ue[at]=Me[at]);var xt=Me.editable;if(xt!==void 0)for(Ue.editable=xt,et=Object.keys(Ue.edits),He=0;He<et.length;He++)Ue.edits[et[He]]=xt;if(Me.edits)for(et=Object.keys(Me.edits),He=0;He<et.length;He++)at=et[He],at in Ue.edits&&(Ue.edits[at]=Me.edits[at]);Ue._exportedPlot=Me._exportedPlot}Ue.staticPlot&&(Ue.editable=!1,Ue.edits={},Ue.autosizable=!1,Ue.scrollZoom=!1,Ue.doubleClick=!1,Ue.showTips=!1,Ue.showLink=!1,Ue.displayModeBar=!1),Ue.displayModeBar==="hover"&&!i&&(Ue.displayModeBar=!0),(Ue.setBackground==="transparent"||typeof Ue.setBackground!="function")&&(Ue.setBackground=Z),Ue._hasZeroHeight=Ue._hasZeroHeight||de.clientHeight===0,Ue._hasZeroWidth=Ue._hasZeroWidth||de.clientWidth===0;var mt=Ue.scrollZoom,yt=Ue._scrollZoom={};if(mt===!0)yt.cartesian=1,yt.gl3d=1,yt.geo=1,yt.mapbox=1,yt.map=1;else if(typeof mt=="string"){var It=mt.split("+");for(He=0;He<It.length;He++)yt[It[He]]=1}else mt!==!1&&(yt.gl3d=1,yt.geo=1,yt.mapbox=1,yt.map=1)}function ne(de){if(de=s.getGraphDiv(de),!s.isPlotDiv(de))throw new Error("This element is not a Plotly plot: "+de);return A.cleanData(de.data),A.cleanLayout(de.layout),de.calcdata=void 0,W._doPlot(de).then(function(){return de.emit("plotly_redraw"),de})}function ae(de,Me,Ce,Ue){return de=s.getGraphDiv(de),o.cleanPlot([],{},de._fullData||[],de._fullLayout||{}),o.purge(de),W._doPlot(de,Me,Ce,Ue)}function B(de,Me){var Ce=Me+1,Ue=[],He,et;for(He=0;He<de.length;He++)et=de[He],et<0?Ue.push(Ce+et):Ue.push(et);return Ue}function ie(de,Me,Ce){var Ue,He;for(Ue=0;Ue<Me.length;Ue++){if(He=Me[Ue],He!==parseInt(He,10))throw new Error("all values in "+Ce+" must be integers");if(He>=de.data.length||He<-de.data.length)throw new Error(Ce+" must be valid indices for gd.data.");if(Me.indexOf(He,Ue+1)>-1||He>=0&&Me.indexOf(-de.data.length+He)>-1||He<0&&Me.indexOf(de.data.length+He)>-1)throw new Error("each index in "+Ce+" must be unique.")}}function se(de,Me,Ce){if(!Array.isArray(de.data))throw new Error("gd.data must be an array.");if(typeof Me>"u")throw new Error("currentIndices is a required argument.");if(Array.isArray(Me)||(Me=[Me]),ie(de,Me,"currentIndices"),typeof Ce<"u"&&!Array.isArray(Ce)&&(Ce=[Ce]),typeof Ce<"u"&&ie(de,Ce,"newIndices"),typeof Ce<"u"&&Me.length!==Ce.length)throw new Error("current and new indices must be of equal length.")}function ye(de,Me,Ce){var Ue,He;if(!Array.isArray(de.data))throw new Error("gd.data must be an array.");if(typeof Me>"u")throw new Error("traces must be defined.");for(Array.isArray(Me)||(Me=[Me]),Ue=0;Ue<Me.length;Ue++)if(He=Me[Ue],typeof He!="object"||Array.isArray(He)||He===null)throw new Error("all values in traces array must be non-array objects");if(typeof Ce<"u"&&!Array.isArray(Ce)&&(Ce=[Ce]),typeof Ce<"u"&&Ce.length!==Me.length)throw new Error("if indices is specified, traces.length must equal indices.length")}function me(de,Me,Ce,Ue){var He=s.isPlainObject(Ue);if(!Array.isArray(de.data))throw new Error("gd.data must be an array");if(!s.isPlainObject(Me))throw new Error("update must be a key:value object");if(typeof Ce>"u")throw new Error("indices must be an integer or array of integers");ie(de,Ce,"indices");for(var et in Me){if(!Array.isArray(Me[et])||Me[et].length!==Ce.length)throw new Error("attribute "+et+" must be an array of length equal to indices array length");if(He&&(!(et in Ue)||!Array.isArray(Ue[et])||Ue[et].length!==Me[et].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 correspondence with the keys and number of traces in the update object")}}function xe(de,Me,Ce,Ue){var He=s.isPlainObject(Ue),et=[],at,xt,mt,yt,It;Array.isArray(Ce)||(Ce=[Ce]),Ce=B(Ce,de.data.length-1);for(var zt in Me)for(var Ut=0;Ut<Ce.length;Ut++){if(at=de.data[Ce[Ut]],mt=f(at,zt),xt=mt.get(),yt=Me[zt][Ut],!s.isArrayOrTypedArray(yt))throw new Error("attribute: "+zt+" index: "+Ut+" must be an array");if(!s.isArrayOrTypedArray(xt))throw new Error("cannot extend missing or non-array attribute: "+zt);if(xt.constructor!==yt.constructor)throw new Error("cannot extend array with an array of a different type: "+zt);It=He?Ue[zt][Ut]:Ue,d(It)||(It=-1),et.push({prop:mt,target:xt,insert:yt,maxp:Math.floor(It)})}return et}function Re(de,Me,Ce,Ue,He){me(de,Me,Ce,Ue);for(var et=xe(de,Me,Ce,Ue),at={},xt={},mt=0;mt<et.length;mt++){var yt=et[mt].prop,It=et[mt].maxp,zt=He(et[mt].target,et[mt].insert,It);yt.set(zt[0]),Array.isArray(at[yt.astr])||(at[yt.astr]=[]),at[yt.astr].push(zt[1]),Array.isArray(xt[yt.astr])||(xt[yt.astr]=[]),xt[yt.astr].push(et[mt].target.length)}return{update:at,maxPoints:xt}}function ke(de,Me){var Ce=new de.constructor(de.length+Me.length);return Ce.set(de),Ce.set(Me,de.length),Ce}function Ie(de,Me,Ce,Ue){de=s.getGraphDiv(de);function He(mt,yt,It){var zt,Ut;if(s.isTypedArray(mt))if(It<0){var or=new mt.constructor(0),xr=ke(mt,yt);It<0?(zt=xr,Ut=or):(zt=or,Ut=xr)}else if(zt=new mt.constructor(It),Ut=new mt.constructor(mt.length+yt.length-It),It===yt.length)zt.set(yt),Ut.set(mt);else if(It<yt.length){var zr=yt.length-It;zt.set(yt.subarray(zr)),Ut.set(mt),Ut.set(yt.subarray(0,zr),mt.length)}else{var Br=It-yt.length,Gr=mt.length-Br;zt.set(mt.subarray(Gr)),zt.set(yt,Br),Ut.set(mt.subarray(0,Gr))}else zt=mt.concat(yt),Ut=It>=0&&It<zt.length?zt.splice(0,zt.length-It):[];return[zt,Ut]}var et=Re(de,Me,Ce,Ue,He),at=W.redraw(de),xt=[de,et.update,Ce,et.maxPoints];return h.add(de,W.prependTraces,xt,Ie,arguments),at}function Q(de,Me,Ce,Ue){de=s.getGraphDiv(de);function He(mt,yt,It){var zt,Ut;if(s.isTypedArray(mt))if(It<=0){var or=new mt.constructor(0),xr=ke(yt,mt);It<0?(zt=xr,Ut=or):(zt=or,Ut=xr)}else if(zt=new mt.constructor(It),Ut=new mt.constructor(mt.length+yt.length-It),It===yt.length)zt.set(yt),Ut.set(mt);else if(It<yt.length){var zr=yt.length-It;zt.set(yt.subarray(0,zr)),Ut.set(yt.subarray(zr)),Ut.set(mt,zr)}else{var Br=It-yt.length;zt.set(yt),zt.set(mt.subarray(0,Br),yt.length),Ut.set(mt.subarray(Br))}else zt=yt.concat(mt),Ut=It>=0&&It<zt.length?zt.splice(It,zt.length):[];return[zt,Ut]}var et=Re(de,Me,Ce,Ue,He),at=W.redraw(de),xt=[de,et.update,Ce,et.maxPoints];return h.add(de,W.extendTraces,xt,Q,arguments),at}function ee(de,Me,Ce){de=s.getGraphDiv(de);var Ue=[],He=W.deleteTraces,et=ee,at=[de,Ue],xt=[de,Me],mt,yt;for(ye(de,Me,Ce),Array.isArray(Me)||(Me=[Me]),Me=Me.map(function(It){return s.extendFlat({},It)}),A.cleanData(Me),mt=0;mt<Me.length;mt++)de.data.push(Me[mt]);for(mt=0;mt<Me.length;mt++)Ue.push(-Me.length+mt);if(typeof Ce>"u")return yt=W.redraw(de),h.add(de,He,at,et,xt),yt;Array.isArray(Ce)||(Ce=[Ce]);try{se(de,Ue,Ce)}catch(It){throw de.data.splice(de.data.length-Me.length,Me.length),It}return h.startSequence(de),h.add(de,He,at,et,xt),yt=W.moveTraces(de,Ue,Ce),h.stopSequence(de),yt}function D(de,Me){de=s.getGraphDiv(de);var Ce=[],Ue=W.addTraces,He=D,et=[de,Ce,Me],at=[de,Me],xt,mt;if(typeof Me>"u")throw new Error("indices must be an integer or array of integers.");for(Array.isArray(Me)||(Me=[Me]),ie(de,Me,"indices"),Me=B(Me,de.data.length-1),Me.sort(s.sorterDes),xt=0;xt<Me.length;xt+=1)mt=de.data.splice(Me[xt],1)[0],Ce.push(mt);var yt=W.redraw(de);return h.add(de,Ue,et,He,at),yt}function le(de,Me,Ce){de=s.getGraphDiv(de);var Ue=[],He=[],et=le,at=le,xt=[de,Ce,Me],mt=[de,Me,Ce],yt;if(se(de,Me,Ce),Me=Array.isArray(Me)?Me:[Me],typeof Ce>"u")for(Ce=[],yt=0;yt<Me.length;yt++)Ce.push(-Me.length+yt);for(Ce=Array.isArray(Ce)?Ce:[Ce],Me=B(Me,de.data.length-1),Ce=B(Ce,de.data.length-1),yt=0;yt<de.data.length;yt++)Me.indexOf(yt)===-1&&Ue.push(de.data[yt]);for(yt=0;yt<Me.length;yt++)He.push({newIndex:Ce[yt],trace:de.data[Me[yt]]});for(He.sort(function(zt,Ut){return zt.newIndex-Ut.newIndex}),yt=0;yt<He.length;yt+=1)Ue.splice(He[yt].newIndex,0,He[yt].trace);de.data=Ue;var It=W.redraw(de);return h.add(de,et,xt,at,mt),It}function ge(de,Me,Ce,Ue){de=s.getGraphDiv(de),A.clearPromiseQueue(de);var He={};if(typeof Me=="string")He[Me]=Ce;else if(s.isPlainObject(Me))He=s.extendFlat({},Me),Ue===void 0&&(Ue=Ce);else return s.warn("Restyle fail.",Me,Ce,Ue),Promise.reject();Object.keys(He).length&&(de.changed=!0);var et=A.coerceTraceIndices(de,Ue),at=K(de,He,et),xt=at.flags;xt.calc&&(de.calcdata=void 0),xt.clearAxisTypes&&A.clearAxisTypes(de,et,{});var mt=[];xt.fullReplot?mt.push(W._doPlot):(mt.push(o.previousPromises),o.supplyDefaults(de),xt.markerSize&&(o.doCalcdata(de),Ae(mt)),xt.style&&mt.push(R.doTraceStyle),xt.colorbars&&mt.push(R.doColorBars),mt.push(re)),mt.push(o.rehover,o.redrag,o.reselect),h.add(de,ge,[de,at.undoit,at.traces],ge,[de,at.redoit,at.traces]);var yt=s.syncOrAsync(mt,de);return(!yt||!yt.then)&&(yt=Promise.resolve()),yt.then(function(){return de.emit("plotly_restyle",at.eventData),de})}function j(de){return de===void 0?null:de}function k(de,Me){return Me?function(Ce,Ue,He){var et=f(Ce,Ue),at=et.set;return et.set=function(xt){var mt=(He||"")+Ue;F(mt,et.get(),xt,de),at(xt)},et}:f}function F(de,Me,Ce,Ue){if(Array.isArray(Me)||Array.isArray(Ce))for(var He=Array.isArray(Me)?Me:[],et=Array.isArray(Ce)?Ce:[],at=Math.max(He.length,et.length),xt=0;xt<at;xt++)F(de+"["+xt+"]",He[xt],et[xt],Ue);else if(s.isPlainObject(Me)||s.isPlainObject(Ce)){var mt=s.isPlainObject(Me)?Me:{},yt=s.isPlainObject(Ce)?Ce:{},It=s.extendFlat({},mt,yt);for(var zt in It)F(de+"."+zt,mt[zt],yt[zt],Ue)}else Ue[de]===void 0&&(Ue[de]=j(Me))}function J(de,Me,Ce){for(var Ue in Ce){var He=f(de,Ue);F(Ue,He.get(),Ce[Ue],Me)}}function K(de,Me,Ce){var Ue=de._fullLayout,He=de._fullData,et=de.data,at=Ue._guiEditing,xt=k(Ue._preGUI,at),mt=s.extendDeepAll({},Me),yt,It=N.traceFlags(),zt={},Ut={},or;function xr(){return Ce.map(function(){})}function zr(Rt){var Yt=w.id2name(Rt);or.indexOf(Yt)===-1&&or.push(Yt)}function Br(Rt){return"LAYOUT"+Rt+".autorange"}function Gr(Rt){return"LAYOUT"+Rt+".range"}function wr(Rt){for(var Yt=Rt;Yt<He.length;Yt++)if(He[Yt]._input===et[Rt])return He[Yt]}function lr(Rt,Yt,pr){if(Array.isArray(Rt)){Rt.forEach(function(Cr){lr(Cr,Yt,pr)});return}if(!(Rt in Me||A.hasParent(Me,Rt))){var fr;if(Rt.substr(0,6)==="LAYOUT")fr=xt(de.layout,Rt.replace("LAYOUT",""));else{var Sr=Ce[pr],hr=Ue._tracePreGUI[wr(Sr)._fullInput.uid];fr=k(hr,at)(et[Sr],Rt)}Rt in Ut||(Ut[Rt]=xr()),Ut[Rt][pr]===void 0&&(Ut[Rt][pr]=j(fr.get())),Yt!==void 0&&fr.set(Yt)}}function Dr(Rt){return function(Yt){return He[Yt][Rt]}}function Hr(Rt){return function(Yt,pr){return Yt===!1?He[Ce[pr]][Rt]:null}}for(var Rr in Me){if(A.hasParent(Me,Rr))throw new Error("cannot set "+Rr+" and a parent attribute simultaneously");var Ar=Me[Rr],Er,_r,rn,gn,Ur,vn;if((Rr==="autobinx"||Rr==="autobiny")&&(Rr=Rr.charAt(Rr.length-1)+"bins",Array.isArray(Ar)?Ar=Ar.map(Hr(Rr)):Ar===!1?Ar=Ce.map(Dr(Rr)):Ar=null),zt[Rr]=Ar,Rr.substr(0,6)==="LAYOUT"){rn=xt(de.layout,Rr.replace("LAYOUT","")),Ut[Rr]=[j(rn.get())],rn.set(Array.isArray(Ar)?Ar[0]:Ar),It.calc=!0;continue}for(Ut[Rr]=xr(),yt=0;yt<Ce.length;yt++){Er=et[Ce[yt]],_r=wr(Ce[yt]);var Cn=Ue._tracePreGUI[_r._fullInput.uid];if(rn=k(Cn,at)(Er,Rr),gn=rn.get(),Ur=Array.isArray(Ar)?Ar[yt%Ar.length]:Ar,Ur!==void 0){var Vn=rn.parts[rn.parts.length-1],Gn=Rr.substr(0,Rr.length-Vn.length-1),sn=Gn?Gn+".":"",Fn=Gn?f(_r,Gn).get():_r;if(vn=v.getTraceValObject(_r,rn.parts),vn&&vn.impliedEdits&&Ur!==null)for(var Tn in vn.impliedEdits)lr(s.relativeAttr(Rr,Tn),vn.impliedEdits[Tn],yt);else if((Vn==="thicknessmode"||Vn==="lenmode")&&gn!==Ur&&(Ur==="fraction"||Ur==="pixels")&&Fn){var Mr=Ue._size,oa=Fn.orient,pe=oa==="top"||oa==="bottom";if(Vn==="thicknessmode"){var he=pe?Mr.h:Mr.w;lr(sn+"thickness",Fn.thickness*(Ur==="fraction"?1/he:he),yt)}else{var Ye=pe?Mr.w:Mr.h;lr(sn+"len",Fn.len*(Ur==="fraction"?1/Ye:Ye),yt)}}else if(Rr==="type"&&(Ur==="pie"!=(gn==="pie")||Ur==="funnelarea"!=(gn==="funnelarea"))){var tt="x",lt="y";(Ur==="bar"||gn==="bar")&&Er.orientation==="h"&&(tt="y",lt="x"),s.swapAttrs(Er,["?","?src"],"labels",tt),s.swapAttrs(Er,["d?","?0"],"label",tt),s.swapAttrs(Er,["?","?src"],"values",lt),gn==="pie"||gn==="funnelarea"?(f(Er,"marker.color").set(f(Er,"marker.colors").get()),Ue._pielayer.selectAll("g.trace").remove()):p.traceIs(Er,"cartesian")&&f(Er,"marker.colors").set(f(Er,"marker.color").get())}Ut[Rr][yt]=j(gn);var We=["swapxy","swapxyaxes","orientation","orientationaxes"];if(We.indexOf(Rr)!==-1){if(Rr==="orientation"){rn.set(Ur);var Ze=Er.x&&!Er.y?"h":"v";if((rn.get()||Ze)===_r.orientation)continue}else Rr==="orientationaxes"&&(Er.orientation={v:"h",h:"v"}[_r.orientation]);A.swapXYData(Er),It.calc=It.clearAxisTypes=!0}else o.dataArrayContainers.indexOf(rn.parts[0])!==-1?(A.manageArrayContainers(rn,Ur,Ut),It.calc=!0):(vn?vn.arrayOk&&!p.traceIs(_r,"regl")&&(s.isArrayOrTypedArray(Ur)||s.isArrayOrTypedArray(gn))?It.calc=!0:N.update(It,vn):It.calc=!0,rn.set(Ur))}}if(["swapxyaxes","orientationaxes"].indexOf(Rr)!==-1&&w.swap(de,Ce),Rr==="orientationaxes"){var dt=f(de.layout,"hovermode"),it=dt.get();it==="x"?dt.set("y"):it==="y"?dt.set("x"):it==="x unified"?dt.set("y unified"):it==="y unified"&&dt.set("x unified")}if(["orientation","type"].indexOf(Rr)!==-1){for(or=[],yt=0;yt<Ce.length;yt++){var At=et[Ce[yt]];p.traceIs(At,"cartesian")&&(zr(At.xaxis||"x"),zr(At.yaxis||"y"))}lr(or.map(Br),!0,0),lr(or.map(Gr),[0,1],0)}}return(It.calc||It.plot)&&(It.fullReplot=!0),{flags:It,undoit:Ut,redoit:zt,traces:Ce,eventData:s.extendDeepNoArrays([],[mt,Ce])}}function ve(de,Me,Ce){de=s.getGraphDiv(de),A.clearPromiseQueue(de);var Ue={};if(typeof Me=="string")Ue[Me]=Ce;else if(s.isPlainObject(Me))Ue=s.extendFlat({},Me);else return s.warn("Relayout fail.",Me,Ce),Promise.reject();Object.keys(Ue).length&&(de.changed=!0);var He=bt(de,Ue),et=He.flags;et.calc&&(de.calcdata=void 0);var at=[o.previousPromises];et.layoutReplot?at.push(R.layoutReplot):Object.keys(Ue).length&&(Te(de,et,He)||o.supplyDefaults(de),et.legend&&at.push(R.doLegend),et.layoutstyle&&at.push(R.layoutStyles),et.axrange&&Ae(at,He.rangesAltered),et.ticks&&at.push(R.doTicksRelayout),et.modebar&&at.push(R.doModeBar),et.camera&&at.push(R.doCamera),et.colorbars&&at.push(R.doColorBars),at.push(re)),at.push(o.rehover,o.redrag,o.reselect),h.add(de,ve,[de,He.undoit],ve,[de,He.redoit]);var xt=s.syncOrAsync(at,de);return(!xt||!xt.then)&&(xt=Promise.resolve(de)),xt.then(function(){return de.emit("plotly_relayout",He.eventData),de})}function Te(de,Me,Ce){var Ue=de._fullLayout;if(!Me.axrange)return!1;for(var He in Me)if(He!=="axrange"&&Me[He])return!1;var et,at,xt=function(or,xr){return s.coerce(et,at,b,or,xr)},mt={};for(var yt in Ce.rangesAltered){var It=w.id2name(yt);if(et=de.layout[It],at=Ue[It],g(et,at,xt,mt),at._matchGroup){for(var zt in at._matchGroup)if(zt!==yt){var Ut=Ue[w.id2name(zt)];Ut.autorange=at.autorange,Ut.range=at.range.slice(),Ut._input.range=at.range.slice()}}}return!0}function Ae(de,Me){var Ce=Me?function(Ue){var He=[],et=!0;for(var at in Me){var xt=w.getFromId(Ue,at);if(He.push(at),(xt.ticklabelposition||"").indexOf("inside")!==-1&&xt._anchorAxis&&He.push(xt._anchorAxis._id),xt._matchGroup)for(var mt in xt._matchGroup)Me[mt]||He.push(mt)}return w.draw(Ue,He,{skipTitle:et})}:function(Ue){return w.draw(Ue,"redraw")};de.push(C,R.doAutoRangeAndConstraints,Ce,R.drawData,R.finalDraw)}var Fe=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,Ge=/^[xyz]axis[0-9]*\.autorange$/,rt=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function bt(de,Me){var Ce=de.layout,Ue=de._fullLayout,He=Ue._guiEditing,et=k(Ue._preGUI,He),at=Object.keys(Me),xt=w.list(de),mt=s.extendDeepAll({},Me),yt={},It,zt,Ut;for(at=Object.keys(Me),zt=0;zt<at.length;zt++)if(at[zt].indexOf("allaxes")===0){for(Ut=0;Ut<xt.length;Ut++){var or=xt[Ut]._id.substr(1),xr=or.indexOf("scene")!==-1?or+".":"",zr=at[zt].replace("allaxes",xr+xt[Ut]._name);Me[zr]||(Me[zr]=Me[at[zt]])}delete Me[at[zt]]}var Br=N.layoutFlags(),Gr={},wr={};function lr(hr,Cr){if(Array.isArray(hr)){hr.forEach(function(Un){lr(Un,Cr)});return}if(!(hr in Me||A.hasParent(Me,hr))){var Fr=et(Ce,hr);hr in wr||(wr[hr]=j(Fr.get())),Cr!==void 0&&Fr.set(Cr)}}var Dr={},Hr;function Rr(hr){var Cr=w.name2id(hr.split(".")[0]);return Dr[Cr]=1,Cr}for(var Ar in Me){if(A.hasParent(Me,Ar))throw new Error("cannot set "+Ar+" and a parent attribute simultaneously");for(var Er=et(Ce,Ar),_r=Me[Ar],rn=Er.parts.length,gn=rn-1;gn>0&&typeof Er.parts[gn]!="string";)gn--;var Ur=Er.parts[gn],vn=Er.parts[gn-1]+"."+Ur,Cn=Er.parts.slice(0,gn).join("."),Vn=f(de.layout,Cn).get(),Gn=f(Ue,Cn).get(),sn=Er.get();if(_r!==void 0){Gr[Ar]=_r,wr[Ar]=Ur==="reverse"?_r:j(sn);var Fn=v.getLayoutValObject(Ue,Er.parts);if(Fn&&Fn.impliedEdits&&_r!==null)for(var Tn in Fn.impliedEdits)lr(s.relativeAttr(Ar,Tn),Fn.impliedEdits[Tn]);if(["width","height"].indexOf(Ar)!==-1)if(_r){lr("autosize",null);var Mr=Ar==="height"?"width":"height";lr(Mr,Ue[Mr])}else Ue[Ar]=de._initialAutoSize[Ar];else if(Ar==="autosize")lr("width",_r?null:Ue.width),lr("height",_r?null:Ue.height);else if(vn.match(Fe))Rr(vn),f(Ue,Cn+"._inputRange").set(null);else if(vn.match(Ge)){Rr(vn),f(Ue,Cn+"._inputRange").set(null);var oa=f(Ue,Cn).get();oa._inputDomain&&(oa._input.domain=oa._inputDomain.slice())}else vn.match(rt)&&f(Ue,Cn+"._inputDomain").set(null);if(Ur==="type"){Hr=Vn;var pe=Gn.type==="linear"&&_r==="log",he=Gn.type==="log"&&_r==="linear";if(pe||he){if(!Hr||!Hr.range)lr(Cn+".autorange",!0);else if(Gn.autorange)pe&&(Hr.range=Hr.range[1]>Hr.range[0]?[1,2]:[2,1]);else{var Ye=Hr.range[0],tt=Hr.range[1];pe?(Ye<=0&&tt<=0&&lr(Cn+".autorange",!0),Ye<=0?Ye=tt/1e6:tt<=0&&(tt=Ye/1e6),lr(Cn+".range[0]",Math.log(Ye)/Math.LN10),lr(Cn+".range[1]",Math.log(tt)/Math.LN10)):(lr(Cn+".range[0]",Math.pow(10,Ye)),lr(Cn+".range[1]",Math.pow(10,tt)))}Array.isArray(Ue._subplots.polar)&&Ue._subplots.polar.length&&Ue[Er.parts[0]]&&Er.parts[1]==="radialaxis"&&delete Ue[Er.parts[0]]._subplot.viewInitial["radialaxis.range"],p.getComponentMethod("annotations","convertCoords")(de,Gn,_r,lr),p.getComponentMethod("images","convertCoords")(de,Gn,_r,lr)}else lr(Cn+".autorange",!0),lr(Cn+".range",null);f(Ue,Cn+"._inputRange").set(null)}else if(Ur.match(te)){var lt=f(Ue,Ar).get(),We=(_r||{}).type;(!We||We==="-")&&(We="linear"),p.getComponentMethod("annotations","convertCoords")(de,lt,We,lr),p.getComponentMethod("images","convertCoords")(de,lt,We,lr)}var Ze=y.containerArrayMatch(Ar);if(Ze){It=Ze.array,zt=Ze.index;var dt=Ze.property,it=Fn||{editType:"calc"};zt!==""&&dt===""&&(y.isAddVal(_r)?wr[Ar]=null:y.isRemoveVal(_r)?wr[Ar]=(f(Ce,It).get()||[])[zt]:s.warn("unrecognized full object value",Me)),N.update(Br,it),yt[It]||(yt[It]={});var At=yt[It][zt];At||(At=yt[It][zt]={}),At[dt]=_r,delete Me[Ar]}else Ur==="reverse"?(Vn.range?Vn.range.reverse():(lr(Cn+".autorange",!0),Vn.range=[1,0]),Gn.autorange?Br.calc=!0:Br.plot=!0):(Ar==="dragmode"&&(_r===!1&&sn!==!1||_r!==!1&&sn===!1)||Ue._has("scatter-like")&&Ue._has("regl")&&Ar==="dragmode"&&(_r==="lasso"||_r==="select")&&!(sn==="lasso"||sn==="select")?Br.plot=!0:Fn?N.update(Br,Fn):Br.calc=!0,Er.set(_r))}}for(It in yt){var Rt=y.applyContainerArrayChanges(de,et(Ce,It),yt[It],Br,et);Rt||(Br.plot=!0)}for(var Yt in Dr){Hr=w.getFromId(de,Yt);var pr=Hr&&Hr._constraintGroup;if(pr){Br.calc=!0;for(var fr in pr)Dr[fr]||(w.getFromId(de,fr)._constraintShrinkable=!0)}}(ht(de)||Me.height||Me.width)&&(Br.plot=!0);var Sr=Ue.shapes;for(zt=0;zt<Sr.length;zt++)if(Sr[zt].showlegend){Br.calc=!0;break}return(Br.plot||Br.calc)&&(Br.layoutReplot=!0),{flags:Br,rangesAltered:Dr,undoit:wr,redoit:Gr,eventData:mt}}function ht(de){var Me=de._fullLayout,Ce=Me.width,Ue=Me.height;return de.layout.autosize&&o.plotAutoSize(de,de.layout,Me),Me.width!==Ce||Me.height!==Ue}function ct(de,Me,Ce,Ue){de=s.getGraphDiv(de),A.clearPromiseQueue(de),s.isPlainObject(Me)||(Me={}),s.isPlainObject(Ce)||(Ce={}),Object.keys(Me).length&&(de.changed=!0),Object.keys(Ce).length&&(de.changed=!0);var He=A.coerceTraceIndices(de,Ue),et=K(de,s.extendFlat({},Me),He),at=et.flags,xt=bt(de,s.extendFlat({},Ce)),mt=xt.flags;(at.calc||mt.calc)&&(de.calcdata=void 0),at.clearAxisTypes&&A.clearAxisTypes(de,He,Ce);var yt=[];mt.layoutReplot?yt.push(R.layoutReplot):at.fullReplot?yt.push(W._doPlot):(yt.push(o.previousPromises),Te(de,mt,xt)||o.supplyDefaults(de),at.style&&yt.push(R.doTraceStyle),(at.colorbars||mt.colorbars)&&yt.push(R.doColorBars),mt.legend&&yt.push(R.doLegend),mt.layoutstyle&&yt.push(R.layoutStyles),mt.axrange&&Ae(yt,xt.rangesAltered),mt.ticks&&yt.push(R.doTicksRelayout),mt.modebar&&yt.push(R.doModeBar),mt.camera&&yt.push(R.doCamera),yt.push(re)),yt.push(o.rehover,o.redrag,o.reselect),h.add(de,ct,[de,et.undoit,xt.undoit,et.traces],ct,[de,et.redoit,xt.redoit,et.traces]);var It=s.syncOrAsync(yt,de);return(!It||!It.then)&&(It=Promise.resolve(de)),It.then(function(){return de.emit("plotly_update",{data:et.eventData,layout:xt.eventData}),de})}function Oe(de){return function(Me){Me._fullLayout._guiEditing=!0;var Ce=de.apply(null,arguments);return Me._fullLayout._guiEditing=!1,Ce}}var ze=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^(map\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],we=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function je(de,Me){for(var Ce=0;Ce<Me.length;Ce++){var Ue=Me[Ce],He=de.match(Ue.pattern);if(He){var et=He[1]||"";return{head:et,tail:de.substr(et.length+1),attr:Ue.attr}}}}function ot(de,Me){var Ce=f(Me,de).get();if(Ce!==void 0)return Ce;var Ue=de.split(".");for(Ue.pop();Ue.length>1;)if(Ue.pop(),Ce=f(Me,Ue.join(".")+".uirevision").get(),Ce!==void 0)return Ce;return Me.uirevision}function vt(de,Me){for(var Ce=0;Ce<Me.length;Ce++)if(Me[Ce]._fullInput.uid===de)return Ce;return-1}function Lt(de,Me,Ce){for(var Ue=0;Ue<Me.length;Ue++)if(Me[Ue].uid===de)return Ue;return!Me[Ce]||Me[Ce].uid?-1:Ce}function Tt(de,Me){var Ce=s.isPlainObject(de),Ue=Array.isArray(de);return Ce||Ue?(Ce&&s.isPlainObject(Me)||Ue&&Array.isArray(Me))&&JSON.stringify(de)===JSON.stringify(Me):de===Me}function kt(de,Me,Ce,Ue){var He=Ue._preGUI,et,at,xt,mt,yt,It,zt,Ut,or,xr,zr=[],Br={},Gr={};for(et in He){if(yt=je(et,ze),yt){if(or=yt.head,xr=yt.tail,at=yt.attr||or+".uirevision",xt=f(Ue,at).get(),mt=xt&&ot(at,Me),mt&&mt===xt){if(It=He[et],It===null&&(It=void 0),zt=f(Me,et),Ut=zt.get(),Tt(Ut,It)){Ut===void 0&&xr==="autorange"&&zr.push(or),zt.set(j(f(Ue,et).get()));continue}else if(xr==="autorange"||xr.substr(0,6)==="range["){var wr=He[or+".range[0]"],lr=He[or+".range[1]"],Dr=He[or+".autorange"];if(Dr||Dr===null&&wr===null&&lr===null){if(!(or in Br)){var Hr=f(Me,or).get();Br[or]=Hr&&(Hr.autorange||Hr.autorange!==!1&&(!Hr.range||Hr.range.length!==2))}if(Br[or]){zt.set(j(f(Ue,et).get()));continue}}}}}else s.warn("unrecognized GUI edit: "+et);delete He[et],yt&&yt.tail.substr(0,6)==="range["&&(Gr[yt.head]=1)}for(var Rr=0;Rr<zr.length;Rr++){var Ar=zr[Rr];if(Gr[Ar]){var Er=f(Me,Ar).get();Er&&delete Er.autorange}}var _r=Ue._tracePreGUI;for(var rn in _r){var gn=_r[rn],Ur=null,vn;for(et in gn){if(!Ur){var Cn=vt(rn,Ce);if(Cn<0){delete _r[rn];break}var Vn=Ce[Cn];vn=Vn._fullInput;var Gn=Lt(rn,de,vn.index);if(Gn<0){delete _r[rn];break}Ur=de[Gn]}if(yt=je(et,we),yt){if(yt.attr?(xt=f(Ue,yt.attr).get(),mt=xt&&ot(yt.attr,Me)):(xt=vn.uirevision,mt=Ur.uirevision,mt===void 0&&(mt=Me.uirevision)),mt&&mt===xt&&(It=gn[et],It===null&&(It=void 0),zt=f(Ur,et),Ut=zt.get(),Tt(Ut,It))){zt.set(j(f(vn,et).get()));continue}}else s.warn("unrecognized GUI edit: "+et+" in trace uid "+rn);delete gn[et]}}}function Nt(de,Me,Ce,Ue){var He,et;function at(){return W.addFrames(de,He)}de=s.getGraphDiv(de),A.clearPromiseQueue(de);var xt=de._fullData,mt=de._fullLayout;if(!s.isPlotDiv(de)||!xt||!mt)et=W.newPlot(de,Me,Ce,Ue);else{if(s.isPlainObject(Me)){var yt=Me;Me=yt.data,Ce=yt.layout,Ue=yt.config,He=yt.frames}var It=!1;if(Ue){let vn=s.extendDeepAll({},de._context);de._context=void 0,X(de,Ue),It=!A.collectionsAreEqual(vn,de._context)}if(It){let vn=de._ev.eventNames().map(Cn=>[Cn,de._ev.listeners(Cn)]);et=W.newPlot(de,Me,Ce,Ue).then(()=>{for(let[Cn,Vn]of vn)Vn.forEach(Gn=>de.on(Cn,Gn));return W.react(de,Me,Ce,Ue)})}else{de.data=Me||[],A.cleanData(de.data),de.layout=Ce||{},A.cleanLayout(de.layout),kt(de.data,de.layout,xt,mt),o.supplyDefaults(de,{skipUpdateCalc:!0});var zt=de._fullData,Ut=de._fullLayout,or=Ut.datarevision===void 0,xr=Ut.transition,zr=Wt(de,mt,Ut,or,xr),Br=zr.newDataRevision,Gr=Pt(de,xt,zt,or,xr,Br);if(ht(de)&&(zr.layoutReplot=!0),Gr.calc||zr.calc){de.calcdata=void 0;for(var wr=Object.getOwnPropertyNames(Ut),lr=0;lr<wr.length;lr++){var Dr=wr[lr],Hr=Dr.substring(0,5);if(Hr==="xaxis"||Hr==="yaxis"){var Rr=Ut[Dr]._emptyCategories;Rr&&Rr()}}}else o.supplyDefaultsUpdateCalc(de.calcdata,zt);var Ar=[];if(He&&(de._transitionData={},o.createTransitionData(de),Ar.push(at)),Ut.transition&&(Gr.anim||zr.anim))zr.ticks&&Ar.push(R.doTicksRelayout),o.doCalcdata(de),R.doAutoRangeAndConstraints(de),Ar.push(function(){return o.transitionFromReact(de,Gr,zr,mt)});else if(Gr.fullReplot||zr.layoutReplot)de._fullLayout._skipDefaults=!0,Ar.push(W._doPlot);else{for(var Er in zr.arrays){var _r=zr.arrays[Er];if(_r.length){var rn=p.getComponentMethod(Er,"drawOne");if(rn!==s.noop)for(var gn=0;gn<_r.length;gn++)rn(de,_r[gn]);else{var Ur=p.getComponentMethod(Er,"draw");if(Ur===s.noop)throw new Error("cannot draw components: "+Er);Ur(de)}}}Ar.push(o.previousPromises),Gr.style&&Ar.push(R.doTraceStyle),(Gr.colorbars||zr.colorbars)&&Ar.push(R.doColorBars),zr.legend&&Ar.push(R.doLegend),zr.layoutstyle&&Ar.push(R.layoutStyles),zr.axrange&&Ae(Ar),zr.ticks&&Ar.push(R.doTicksRelayout),zr.modebar&&Ar.push(R.doModeBar),zr.camera&&Ar.push(R.doCamera),Ar.push(re)}Ar.push(o.rehover,o.redrag,o.reselect),et=s.syncOrAsync(Ar,de),(!et||!et.then)&&(et=Promise.resolve(de))}}return et.then(()=>(It||de.emit("plotly_react",{config:Ue,data:Me,layout:Ce}),de))}function Pt(de,Me,Ce,Ue,He,et){var at=Me.length===Ce.length;if(!He&&!at)return{fullReplot:!0,calc:!0};var xt=N.traceFlags();xt.arrays={},xt.nChanges=0,xt.nChangesAnim=0;var mt,yt;function It(or){var xr=v.getTraceValObject(yt,or);return!yt._module.animatable&&xr.anim&&(xr.anim=!1),xr}var zt={getValObject:It,flags:xt,immutable:Ue,transition:He,newDataRevision:et,gd:de},Ut={};for(mt=0;mt<Me.length;mt++)if(Ce[mt]){if(yt=Ce[mt]._fullInput,Ut[yt.uid])continue;Ut[yt.uid]=1,St(Me[mt]._fullInput,yt,[],zt)}return(xt.calc||xt.plot)&&(xt.fullReplot=!0),He&&xt.nChanges&&xt.nChangesAnim&&(xt.anim=xt.nChanges===xt.nChangesAnim&&at?"all":"some"),xt}function Wt(de,Me,Ce,Ue,He){var et=N.layoutFlags();et.arrays={},et.rangesAltered={},et.nChanges=0,et.nChangesAnim=0;function at(Ut){return v.getLayoutValObject(Ce,Ut)}for(var xt in Ce)if(!(!xt.startsWith("xaxis")&&!xt.startsWith("yaxis"))&&Me[xt]){var mt=Ce[xt].domain,yt=Me[xt].domain,It=Me[xt]._inputDomain;Me[xt]._inputDomain&&(mt[0]===It[0]&&mt[1]===It[1]?Ce[xt].domain=Me[xt].domain:(mt[0]!==yt[0]||mt[1]!==yt[1])&&(Ce[xt]._inputDomain=null))}var zt={getValObject:at,flags:et,immutable:Ue,transition:He,gd:de};return St(Me,Ce,[],zt),(et.plot||et.calc)&&(et.layoutReplot=!0),He&&et.nChanges&&et.nChangesAnim&&(et.anim=et.nChanges===et.nChangesAnim?"all":"some"),et}function St(de,Me,Ce,Ue){var He,et,at,xt=Ue.getValObject,mt=Ue.flags,yt=Ue.immutable,It=Ue.inArray,zt=Ue.arrayIndex;function Ut(){var Cn=He.editType;if(It&&Cn.indexOf("arraydraw")!==-1){s.pushUnique(mt.arrays[It],zt);return}N.update(mt,He),Cn!=="none"&&mt.nChanges++,Ue.transition&&He.anim&&mt.nChangesAnim++,(Fe.test(at)||Ge.test(at))&&(mt.rangesAltered[Ce[0]]=1),et==="datarevision"&&(mt.newDataRevision=1)}function or(Cn){return Cn.valType==="data_array"||Cn.arrayOk}for(et in de){if(mt.calc&&!Ue.transition)return;var xr=de[et],zr=Me[et],Br=Ce.concat(et);if(at=Br.join("."),!(et.charAt(0)==="_"||typeof xr=="function"||xr===zr)){if((et==="tick0"||et==="dtick")&&Ce[0]!=="geo"){var Gr=Me.tickmode;if(Gr==="auto"||Gr==="array"||!Gr)continue}if(!(et==="range"&&Me.autorange)&&!((et==="zmin"||et==="zmax")&&Me.type==="contourcarpet")&&(He=xt(Br),!!He&&!(He._compareAsJSON&&JSON.stringify(xr)===JSON.stringify(zr)))){var wr=He.valType,lr,Dr=or(He),Hr=Array.isArray(xr),Rr=Array.isArray(zr);if(Hr&&Rr){var Ar="_input_"+et,Er=de[Ar],_r=Me[Ar];if(Array.isArray(Er)&&Er===_r)continue}if(zr===void 0)Dr&&Hr?mt.calc=!0:Ut();else if(He._isLinkedToArray){var rn=[],gn=!1;It||(mt.arrays[et]=rn);var Ur=Math.min(xr.length,zr.length),vn=Math.max(xr.length,zr.length);if(Ur!==vn)if(He.editType==="arraydraw")gn=!0;else{Ut();continue}for(lr=0;lr<Ur;lr++)St(xr[lr],zr[lr],Br.concat(lr),s.extendFlat({inArray:et,arrayIndex:lr},Ue));if(gn)for(lr=Ur;lr<vn;lr++)rn.push(lr)}else!wr&&s.isPlainObject(xr)?St(xr,zr,Br,Ue):Dr?Hr&&Rr?(yt&&(mt.calc=!0),(yt||Ue.newDataRevision)&&Ut()):Hr!==Rr?mt.calc=!0:Ut():Hr&&Rr?(xr.length!==zr.length||String(xr)!==String(zr))&&Ut():Ut()}}}for(et in Me)if(!(et in de||et.charAt(0)==="_"||typeof Me[et]=="function"))if(He=xt(Ce.concat(et)),or(He)&&Array.isArray(Me[et])){mt.calc=!0;return}else Ut()}function Qt(de,Me,Ce){if(de=s.getGraphDiv(de),!s.isPlotDiv(de))throw new Error("This element is not a Plotly plot: "+de+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var Ue=de._transitionData;Ue._frameQueue||(Ue._frameQueue=[]),Ce=o.supplyAnimationDefaults(Ce);var He=Ce.transition,et=Ce.frame;Ue._frameWaitingCnt===void 0&&(Ue._frameWaitingCnt=0);function at(yt){return Array.isArray(He)?yt>=He.length?He[0]:He[yt]:He}function xt(yt){return Array.isArray(et)?yt>=et.length?et[0]:et[yt]:et}function mt(yt,It){var zt=0;return function(){if(yt&&++zt===It)return yt()}}return new Promise(function(yt,It){function zt(){if(Ue._frameQueue.length!==0){for(;Ue._frameQueue.length;){var Ur=Ue._frameQueue.pop();Ur.onInterrupt&&Ur.onInterrupt()}de.emit("plotly_animationinterrupted",[])}}function Ut(Ur){if(Ur.length!==0){for(var vn=0;vn<Ur.length;vn++){var Cn;Ur[vn].type==="byname"?Cn=o.computeFrame(de,Ur[vn].name):Cn=Ur[vn].data;var Vn=xt(vn),Gn=at(vn);Gn.duration=Math.min(Gn.duration,Vn.duration);var sn={frame:Cn,name:Ur[vn].name,frameOpts:Vn,transitionOpts:Gn};vn===Ur.length-1&&(sn.onComplete=mt(yt,2),sn.onInterrupt=It),Ue._frameQueue.push(sn)}Ce.mode==="immediate"&&(Ue._lastFrameAt=-1/0),Ue._animationRaf||zr()}}function or(){de.emit("plotly_animated"),window.cancelAnimationFrame(Ue._animationRaf),Ue._animationRaf=null}function xr(){Ue._currentFrame&&Ue._currentFrame.onComplete&&Ue._currentFrame.onComplete();var Ur=Ue._currentFrame=Ue._frameQueue.shift();if(Ur){var vn=Ur.name?Ur.name.toString():null;de._fullLayout._currentFrame=vn,Ue._lastFrameAt=Date.now(),Ue._timeToNext=Ur.frameOpts.duration,o.transition(de,Ur.frame.data,Ur.frame.layout,A.coerceTraceIndices(de,Ur.frame.traces),Ur.frameOpts,Ur.transitionOpts).then(function(){Ur.onComplete&&Ur.onComplete()}),de.emit("plotly_animatingframe",{name:vn,frame:Ur.frame,animation:{frame:Ur.frameOpts,transition:Ur.transitionOpts}})}else or()}function zr(){de.emit("plotly_animating"),Ue._lastFrameAt=-1/0,Ue._timeToNext=0,Ue._runningTransitions=0,Ue._currentFrame=null;var Ur=function(){Ue._animationRaf=window.requestAnimationFrame(Ur),Date.now()-Ue._lastFrameAt>Ue._timeToNext&&xr()};Ur()}var Br=0;function Gr(Ur){return Array.isArray(He)?Br>=He.length?Ur.transitionOpts=He[Br]:Ur.transitionOpts=He[0]:Ur.transitionOpts=He,Br++,Ur}var wr,lr,Dr=[],Hr=Me==null,Rr=Array.isArray(Me),Ar=!Hr&&!Rr&&s.isPlainObject(Me);if(Ar)Dr.push({type:"object",data:Gr(s.extendFlat({},Me))});else if(Hr||["string","number"].indexOf(typeof Me)!==-1)for(wr=0;wr<Ue._frames.length;wr++)lr=Ue._frames[wr],lr&&(Hr||String(lr.group)===String(Me))&&Dr.push({type:"byname",name:String(lr.name),data:Gr({name:lr.name})});else if(Rr)for(wr=0;wr<Me.length;wr++){var Er=Me[wr];["number","string"].indexOf(typeof Er)!==-1?(Er=String(Er),Dr.push({type:"byname",name:Er,data:Gr({name:Er})})):s.isPlainObject(Er)&&Dr.push({type:"object",data:Gr(s.extendFlat({},Er))})}for(wr=0;wr<Dr.length;wr++)if(lr=Dr[wr],lr.type==="byname"&&!Ue._frameHash[lr.data.name]){s.warn('animate failure: frame not found: "'+lr.data.name+'"'),It();return}["next","immediate"].indexOf(Ce.mode)!==-1&&zt(),Ce.direction==="reverse"&&Dr.reverse();var _r=de._fullLayout._currentFrame;if(_r&&Ce.fromcurrent){var rn=-1;for(wr=0;wr<Dr.length;wr++)if(lr=Dr[wr],lr.type==="byname"&&lr.name===_r){rn=wr;break}if(rn>0&&rn<Dr.length-1){var gn=[];for(wr=0;wr<Dr.length;wr++)lr=Dr[wr],(Dr[wr].type!=="byname"||wr>rn)&&gn.push(lr);Dr=gn}}Dr.length>0?Ut(Dr):(de.emit("plotly_animated"),yt())})}function rr(de,Me,Ce){if(de=s.getGraphDiv(de),Me==null)return Promise.resolve();if(!s.isPlotDiv(de))throw new Error("This element is not a Plotly plot: "+de+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var Ue,He,et,at,xt=de._transitionData._frames,mt=de._transitionData._frameHash;if(!Array.isArray(Me))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+Me);var yt=xt.length+Me.length*2,It=[],zt={};for(Ue=Me.length-1;Ue>=0;Ue--)if(s.isPlainObject(Me[Ue])){var Ut=Me[Ue].name,or=(mt[Ut]||zt[Ut]||{}).name,xr=Me[Ue].name,zr=mt[or]||zt[or];or&&xr&&typeof xr=="number"&&zr&&H<U&&(H++,s.warn('addFrames: overwriting frame "'+(mt[or]||zt[or]).name+'" with a frame whose name of type "number" also equates to "'+or+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),H===U&&s.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),zt[Ut]={name:Ut},It.push({frame:o.supplyFrameDefaults(Me[Ue]),index:Ce&&Ce[Ue]!==void 0&&Ce[Ue]!==null?Ce[Ue]:yt+Ue})}It.sort(function(Ar,Er){return Ar.index>Er.index?-1:Ar.index<Er.index?1:0});var Br=[],Gr=[],wr=xt.length;for(Ue=It.length-1;Ue>=0;Ue--){if(He=It[Ue].frame,typeof He.name=="number"&&s.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!He.name)for(;mt[He.name="frame "+de._transitionData._counter++];);if(mt[He.name]){for(et=0;et<xt.length&&(xt[et]||{}).name!==He.name;et++);Br.push({type:"replace",index:et,value:He}),Gr.unshift({type:"replace",index:et,value:xt[et]})}else at=Math.max(0,Math.min(It[Ue].index,wr)),Br.push({type:"insert",index:at,value:He}),Gr.unshift({type:"delete",index:at}),wr++}var lr=o.modifyFrames,Dr=o.modifyFrames,Hr=[de,Gr],Rr=[de,Br];return h&&h.add(de,lr,Hr,Dr,Rr),o.modifyFrames(de,Br)}function Jt(de,Me){if(de=s.getGraphDiv(de),!s.isPlotDiv(de))throw new Error("This element is not a Plotly plot: "+de);var Ce,Ue,He=de._transitionData._frames,et=[],at=[];if(!Me)for(Me=[],Ce=0;Ce<He.length;Ce++)Me.push(Ce);for(Me=Me.slice(),Me.sort(),Ce=Me.length-1;Ce>=0;Ce--)Ue=Me[Ce],et.push({type:"delete",index:Ue}),at.unshift({type:"insert",index:Ue,value:He[Ue]});var xt=o.modifyFrames,mt=o.modifyFrames,yt=[de,at],It=[de,et];return h&&h.add(de,xt,yt,mt,It),o.modifyFrames(de,et)}function sr(de){de=s.getGraphDiv(de);var Me=de._fullLayout||{},Ce=de._fullData||[];return o.cleanPlot([],{},Ce,Me),o.purge(de),u.purge(de),Me._container&&Me._container.remove(),delete de._context,de}function De(de){var Me=de._fullLayout,Ce=de.getBoundingClientRect();if(!s.equalDomRects(Ce,Me._lastBBox)){var Ue=Me._invTransform=s.inverseTransformMatrix(s.getFullTransformMatrix(de));Me._invScaleX=Math.sqrt(Ue[0][0]*Ue[0][0]+Ue[0][1]*Ue[0][1]+Ue[0][2]*Ue[0][2]),Me._invScaleY=Math.sqrt(Ue[1][0]*Ue[1][0]+Ue[1][1]*Ue[1][1]+Ue[1][2]*Ue[1][2]),Me._lastBBox=Ce}}function Je(de){var Me=V.select(de),Ce=de._fullLayout;if(Ce._calcInverseTransform=De,Ce._calcInverseTransform(de),Ce._container=Me.selectAll(".plot-container").data([0]),Ce._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0).style({width:"100%",height:"100%"}),Ce._paperdiv=Ce._container.selectAll(".svg-container").data([0]),Ce._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),Ce._glcontainer=Ce._paperdiv.selectAll(".gl-container").data([{}]),Ce._glcontainer.enter().append("div").classed("gl-container",!0),Ce._paperdiv.selectAll(".main-svg").remove(),Ce._paperdiv.select(".modebar-container").remove(),Ce._paper=Ce._paperdiv.insert("svg",":first-child").classed("main-svg",!0),Ce._toppaper=Ce._paperdiv.append("svg").classed("main-svg",!0),Ce._modebardiv=Ce._paperdiv.append("div"),delete Ce._modeBar,Ce._hoverpaper=Ce._paperdiv.append("svg").classed("main-svg",!0),!Ce._uid){var Ue={};V.selectAll("defs").each(function(){this.id&&(Ue[this.id.split("-")[1]]=1)}),Ce._uid=s.randstr(Ue)}Ce._paperdiv.selectAll(".main-svg").attr(T.svgAttrs),Ce._defs=Ce._paper.append("defs").attr("id","defs-"+Ce._uid),Ce._clips=Ce._defs.append("g").classed("clips",!0),Ce._topdefs=Ce._toppaper.append("defs").attr("id","topdefs-"+Ce._uid),Ce._topclips=Ce._topdefs.append("g").classed("clips",!0),Ce._bgLayer=Ce._paper.append("g").classed("bglayer",!0),Ce._draggers=Ce._paper.append("g").classed("draglayer",!0);var He=Ce._paper.append("g").classed("layer-below",!0);Ce._imageLowerLayer=He.append("g").classed("imagelayer",!0),Ce._shapeLowerLayer=He.append("g").classed("shapelayer",!0),Ce._cartesianlayer=Ce._paper.append("g").classed("cartesianlayer",!0),Ce._polarlayer=Ce._paper.append("g").classed("polarlayer",!0),Ce._smithlayer=Ce._paper.append("g").classed("smithlayer",!0),Ce._ternarylayer=Ce._paper.append("g").classed("ternarylayer",!0),Ce._geolayer=Ce._paper.append("g").classed("geolayer",!0),Ce._funnelarealayer=Ce._paper.append("g").classed("funnelarealayer",!0),Ce._pielayer=Ce._paper.append("g").classed("pielayer",!0),Ce._iciclelayer=Ce._paper.append("g").classed("iciclelayer",!0),Ce._treemaplayer=Ce._paper.append("g").classed("treemaplayer",!0),Ce._sunburstlayer=Ce._paper.append("g").classed("sunburstlayer",!0),Ce._indicatorlayer=Ce._toppaper.append("g").classed("indicatorlayer",!0),Ce._glimages=Ce._paper.append("g").classed("glimages",!0);var et=Ce._toppaper.append("g").classed("layer-above",!0);Ce._imageUpperLayer=et.append("g").classed("imagelayer",!0),Ce._shapeUpperLayer=et.append("g").classed("shapelayer",!0),Ce._selectionLayer=Ce._toppaper.append("g").classed("selectionlayer",!0),Ce._infolayer=Ce._toppaper.append("g").classed("infolayer",!0),Ce._menulayer=Ce._toppaper.append("g").classed("menulayer",!0),Ce._zoomlayer=Ce._toppaper.append("g").classed("zoomlayer",!0),Ce._hoverlayer=Ce._hoverpaper.append("g").classed("hoverlayer",!0),Ce._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),de.emit("plotly_framework")}W.animate=Qt,W.addFrames=rr,W.deleteFrames=Jt,W.addTraces=ee,W.deleteTraces=D,W.extendTraces=Ie,W.moveTraces=le,W.prependTraces=Q,W.newPlot=ae,W._doPlot=P,W.purge=sr,W.react=Nt,W.redraw=ne,W.relayout=ve,W.restyle=ge,W.setPlotConfig=G,W.update=ct,W._guiRelayout=Oe(ve),W._guiRestyle=Oe(ge),W._guiUpdate=Oe(ct),W._storeDirectGUIEdit=J}),nc=t(W=>{var V=an();W.getDelay=function(s){return s._has&&(s._has("gl3d")||s._has("mapbox")||s._has("map"))?500:0},W.getRedrawFunc=function(s){return function(){V.getComponentMethod("colorbar","draw")(s)}},W.encodeSVG=function(s){return"data:image/svg+xml,"+encodeURIComponent(s)},W.encodeJSON=function(s){return"data:application/json,"+encodeURIComponent(s)};var d=window.URL||window.webkitURL;W.createObjectURL=function(s){return d.createObjectURL(s)},W.revokeObjectURL=function(s){return d.revokeObjectURL(s)},W.createBlob=function(s,f){if(f==="svg")return new window.Blob([s],{type:"image/svg+xml;charset=utf-8"});if(f==="full-json")return new window.Blob([s],{type:"application/json;charset=utf-8"});var u=i(window.atob(s));return new window.Blob([u],{type:"image/"+f})},W.octetStream=function(s){document.location.href="data:application/octet-stream"+s};function i(s){for(var f=s.length,u=new ArrayBuffer(f),h=new Uint8Array(u),p=0;p<f;p++)h[p]=s.charCodeAt(p);return u}W.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/}),ff=t((W,V)=>{var d=l();Mt();var i=Ra(),s=Xt();xi();var f=/"/g,u="TOBESTRIPPED",h=new RegExp('("'+u+")|("+u+'")',"g");function p(o){var w=d.select("body").append("div").style({display:"none"}).html(""),g=o.replace(/(&[^;]*;)/gi,function(b){return b==="&lt;"?"&#60;":b==="&rt;"?"&#62;":b.indexOf("<")!==-1||b.indexOf(">")!==-1?"":w.html(b).text()});return w.remove(),g}function v(o){return o.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}V.exports=function(o,w,g){var b=o._fullLayout,L=b._paper,S=b._toppaper,M=b.width,T=b.height,C;L.insert("rect",":first-child").call(i.setRect,0,0,M,T).call(s.fill,b.paper_bgcolor);var m=b._basePlotModules||[];for(C=0;C<m.length;C++){var y=m[C];y.toSVG&&y.toSVG(o)}if(S){var A=S.node().childNodes,R=Array.prototype.slice.call(A);for(C=0;C<R.length;C++){var N=R[C];N.childNodes.length&&L.node().appendChild(N)}}b._draggers&&b._draggers.remove(),L.node().style.background="",L.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var H=d.select(this);if(this.style.visibility==="hidden"||this.style.display==="none"){H.remove();return}else H.style({visibility:null,display:null});var U=this.style.fontFamily;U&&U.indexOf('"')!==-1&&H.style("font-family",U.replace(f,u));var P=this.style.fontWeight;P&&(P==="normal"||P==="400")&&H.style("font-weight",void 0);var re=this.style.fontStyle;re&&re==="normal"&&H.style("font-style",void 0);var G=this.style.fontVariant;G&&G==="normal"&&H.style("font-variant",void 0)}),L.selectAll(".gradient_filled,.pattern_filled").each(function(){var H=d.select(this),U=this.style.fill;U&&U.indexOf("url(")!==-1&&H.style("fill",U.replace(f,u));var P=this.style.stroke;P&&P.indexOf("url(")!==-1&&H.style("stroke",P.replace(f,u))}),(w==="pdf"||w==="eps")&&L.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),w==="svg"&&g&&(L.attr("width",g*M),L.attr("height",g*T),L.attr("viewBox","0 0 "+M+" "+T));var te=new window.XMLSerializer().serializeToString(L.node());return te=p(te),te=v(te),te=te.replace(h,"'"),te}}),pf=t((W,V)=>{var d=Mt(),i=Zr().EventEmitter,s=nc();function f(u){var h=u.emitter||new i,p=new Promise(function(v,o){var w=window.Image,g=u.svg,b=u.format||"png",L=u.canvas,S=u.scale||1,M=u.width||300,T=u.height||150,C=S*M,m=S*T,y=L.getContext("2d",{willReadFrequently:!0}),A=new w,R,N;b==="svg"||d.isSafari()?N=s.encodeSVG(g):(R=s.createBlob(g,"svg"),N=s.createObjectURL(R)),L.width=C,L.height=m,A.onload=function(){var te;switch(R=null,s.revokeObjectURL(N),b!=="svg"&&y.drawImage(A,0,0,C,m),b){case"jpeg":te=L.toDataURL("image/jpeg");break;case"png":te=L.toDataURL("image/png");break;case"webp":te=L.toDataURL("image/webp");break;case"svg":te=N;break;default:var H="Image format is not jpeg, png, svg or webp.";if(o(new Error(H)),!u.promise)return h.emit("error",H)}v(te),u.promise||h.emit("success",te)},A.onerror=function(te){if(R=null,s.revokeObjectURL(N),o(te),!u.promise)return h.emit("error",te)},A.src=N});return u.promise?p:h}V.exports=f}),Wm=t((W,V)=>{var d=q(),i=jm(),s=pn(),f=Mt(),u=nc(),h=ff(),p=pf(),v=r().version,o={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};function w(g,b){b=b||{};var L,S,M,T;f.isPlainObject(g)?(L=g.data||[],S=g.layout||{},M=g.config||{},T={}):(g=f.getGraphDiv(g),L=f.extendDeep([],g.data),S=f.extendDeep({},g.layout),M=g._context,T=g._fullLayout||{});function C(ae){return!(ae in b)||f.validate(b[ae],o[ae])}if(!C("width")&&b.width!==null||!C("height")&&b.height!==null)throw new Error("Height and width should be pixel values.");if(!C("format"))throw new Error("Export format is not "+f.join2(o.format.values,", "," or ")+".");var m={};function y(ae,B){return f.coerce(b,m,o,ae,B)}var A=y("format"),R=y("width"),N=y("height"),te=y("scale"),H=y("setBackground"),U=y("imageDataOnly"),P=document.createElement("div");P.style.position="absolute",P.style.left="-5000px",document.body.appendChild(P);var re=f.extendFlat({},S);R?re.width=R:b.width===null&&d(T.width)&&(re.width=T.width),N?re.height=N:b.height===null&&d(T.height)&&(re.height=T.height);var G=f.extendFlat({},M,{_exportedPlot:!0,staticPlot:!0,setBackground:H}),Z=u.getRedrawFunc(P);function Y(){return new Promise(function(ae){setTimeout(ae,u.getDelay(P._fullLayout))})}function X(){return new Promise(function(ae,B){var ie=h(P,A,te),se=P._fullLayout.width,ye=P._fullLayout.height;function me(){i.purge(P),document.body.removeChild(P)}if(A==="full-json"){var xe=s.graphJson(P,!1,"keepdata","object",!0,!0);return xe.version=v,xe=JSON.stringify(xe),me(),ae(U?xe:u.encodeJSON(xe))}if(me(),A==="svg")return ae(U?ie:u.encodeSVG(ie));var Re=document.createElement("canvas");Re.id=f.randstr(),p({format:A,width:se,height:ye,scale:te,canvas:Re,svg:ie,promise:!0}).then(ae).catch(B)})}function ne(ae){return U?ae.replace(u.IMAGE_URL_PREFIX,""):ae}return new Promise(function(ae,B){i.newPlot(P,L,re,G).then(Z).then(Y).then(X).then(function(ie){ae(ne(ie))}).catch(function(ie){B(ie)})})}V.exports=w}),wx=t((W,V)=>{var d=Mt(),i=pn(),s=Hn(),f=Tr().dfltConfig,u=d.isPlainObject,h=Array.isArray,p=d.isArrayOrTypedArray;V.exports=function(m,y){m===void 0&&(m=[]),y===void 0&&(y={});var A=s.get(),R=[],N={_context:d.extendFlat({},f)},te,H;h(m)?(N.data=d.extendDeep([],m),te=m):(N.data=[],te=[],R.push(b("array","data"))),u(y)?(N.layout=d.extendDeep({},y),H=y):(N.layout={},H={},arguments.length>1&&R.push(b("object","layout"))),i.supplyDefaults(N);for(var U=N._fullData,P=te.length,re=0;re<P;re++){var G=te[re],Z=["data",re];if(!u(G)){R.push(b("object",Z));continue}var Y=U[re],X=Y.type,ne=A.traces[X].attributes;ne.type={valType:"enumerated",values:[X]},Y.visible===!1&&G.visible!==!1&&R.push(b("invisible",Z)),v(G,Y,ne,R,Z)}var ae=N._fullLayout,B=o(A,U);return v(H,ae,B,R,"layout"),R.length===0?void 0:R};function v(m,y,A,R,N,te){te=te||[];for(var H=Object.keys(m),U=0;U<H.length;U++){var P=H[U],re=te.slice();re.push(P);var G=m[P],Z=y[P],Y=S(A,P),X=(Y||{}).valType,ne=X==="info_array",ae=X==="colorscale",B=(Y||{}).items;if(!L(A,P))R.push(b("schema",N,re));else if(u(G)&&u(Z)&&X!=="any")v(G,Z,Y,R,N,re);else if(ne&&h(G)){G.length>Z.length&&R.push(b("unused",N,re.concat(Z.length)));var ie=Z.length,se=Array.isArray(B);se&&(ie=Math.min(ie,B.length));var ye,me,xe,Re,ke;if(Y.dimensions===2)for(me=0;me<ie;me++)if(h(G[me])){G[me].length>Z[me].length&&R.push(b("unused",N,re.concat(me,Z[me].length)));var Ie=Z[me].length;for(ye=0;ye<(se?Math.min(Ie,B[me].length):Ie);ye++)xe=se?B[me][ye]:B,Re=G[me][ye],ke=Z[me][ye],d.validate(Re,xe)?ke!==Re&&ke!==+Re&&R.push(b("dynamic",N,re.concat(me,ye),Re,ke)):R.push(b("value",N,re.concat(me,ye),Re))}else R.push(b("array",N,re.concat(me),G[me]));else for(me=0;me<ie;me++)xe=se?B[me]:B,Re=G[me],ke=Z[me],d.validate(Re,xe)?ke!==Re&&ke!==+Re&&R.push(b("dynamic",N,re.concat(me),Re,ke)):R.push(b("value",N,re.concat(me),Re))}else if(Y.items&&!ne&&h(G)){var Q=B[Object.keys(B)[0]],ee=[],D,le;for(D=0;D<Z.length;D++){var ge=Z[D]._index||D;if(le=re.slice(),le.push(ge),u(G[ge])&&u(Z[D])){ee.push(ge);var j=G[ge],k=Z[D];u(j)&&j.visible!==!1&&k.visible===!1?R.push(b("invisible",N,le)):v(j,k,Q,R,N,le)}}for(D=0;D<G.length;D++)le=re.slice(),le.push(D),u(G[D])?ee.indexOf(D)===-1&&R.push(b("unused",N,le)):R.push(b("object",N,le,G[D]))}else!u(G)&&u(Z)?R.push(b("object",N,re,G)):!p(G)&&p(Z)&&!ne&&!ae?R.push(b("array",N,re,G)):P in y?d.validate(G,Y)?Y.valType==="enumerated"&&(Y.coerceNumber&&G!==+Z||!p(G)&&G!==Z||String(G)!==String(Z))&&R.push(b("dynamic",N,re,G,Z)):R.push(b("value",N,re,G)):R.push(b("unused",N,re,G))}return R}function o(m,y){for(var A=m.layout.layoutAttributes,R=0;R<y.length;R++){var N=y[R],te=m.traces[N.type],H=te.layoutAttributes;H&&(N.subplot?d.extendFlat(A[te.attributes.subplot.dflt],H):d.extendFlat(A,H))}return A}var w={object:function(m,y){var A;return m==="layout"&&y===""?A="The layout argument":m[0]==="data"&&y===""?A="Trace "+m[1]+" in the data argument":A=g(m)+"key "+y,A+" must be linked to an object container"},array:function(m,y){var A;return m==="data"?A="The data argument":A=g(m)+"key "+y,A+" must be linked to an array container"},schema:function(m,y){return g(m)+"key "+y+" is not part of the schema"},unused:function(m,y,A){var R=u(A)?"container":"key";return g(m)+R+" "+y+" did not get coerced"},dynamic:function(m,y,A,R){return[g(m)+"key",y,"(set to '"+A+"')","got reset to","'"+R+"'","during defaults."].join(" ")},invisible:function(m,y){return(y?g(m)+"item "+y:"Trace "+m[1])+" got defaulted to be not visible"},value:function(m,y,A){return[g(m)+"key "+y,"is set to an invalid value ("+A+")"].join(" ")}};function g(m){return h(m)?"In data trace "+m[1]+", ":"In "+m+", "}function b(m,y,A,R,N){A=A||"";var te,H;h(y)?(te=y[0],H=y[1]):(te=y,H=null);var U=C(A),P=w[m](y,U,R,N);return d.log(P),{code:m,container:te,trace:H,path:A,astr:U,msg:P}}function L(m,y){var A=T(y),R=A.keyMinusId,N=A.id;return R in m&&m[R]._isSubplotObj&&N?!0:y in m}function S(m,y){if(y in m)return m[y];var A=T(y);return m[A.keyMinusId]}var M=d.counterRegex("([a-z]+)");function T(m){var y=m.match(M);return{keyMinusId:y&&y[1],id:y&&y[2]}}function C(m){if(!h(m))return String(m);for(var y="",A=0;A<m.length;A++){var R=m[A];typeof R=="number"?y=y.substr(0,y.length-1)+"["+R+"]":y+=R,A<m.length-1&&(y+=".")}return y}}),Mx=t((W,V)=>{var d=Mt(),i=nc();function s(f,u,h){var p=document.createElement("a"),v="download"in p,o=new Promise(function(w,g){var b,L;if(v)return b=i.createBlob(f,h),L=i.createObjectURL(b),p.href=L,p.download=u,document.body.appendChild(p),p.click(),document.body.removeChild(p),i.revokeObjectURL(L),b=null,w(u);if(d.isSafari()){var S=h==="svg"?",":";base64,";return i.octetStream(S+encodeURIComponent(f)),w(u)}g(new Error("download error"))});return o}V.exports=s}),Ym=t((W,V)=>{var d=Mt(),i=Wm(),s=Mx();nc();function f(u,h){var p;return d.isPlainObject(u)||(p=d.getGraphDiv(u)),h=h||{},h.format=h.format||"png",h.width=h.width||null,h.height=h.height||null,h.imageDataOnly=!0,new Promise(function(v,o){p&&p._snapshotInProgress&&o(new Error("Snapshotting already in progress.")),p&&(p._snapshotInProgress=!0);var w=i(u,h),g=h.filename||u.fn||"newplot";g+="."+h.format.replace("-","."),w.then(function(b){return p&&(p._snapshotInProgress=!1),s(b,g,h.format)}).then(function(b){v(b)}).catch(function(b){p&&(p._snapshotInProgress=!1),o(b)})})}V.exports=f}),Tx=t(W=>{var V=Mt(),d=V.isPlainObject,i=Hn(),s=pn(),f=nt(),u=fn(),h=Tr().dfltConfig;W.makeTemplate=function(M){M=V.isPlainObject(M)?M:V.getGraphDiv(M),M=V.extendDeep({_context:h},{data:M.data,layout:M.layout}),s.supplyDefaults(M);var T=M.data||[],C=M.layout||{};C._basePlotModules=M._fullLayout._basePlotModules,C._modules=M._fullLayout._modules;var m={data:{},layout:{}};T.forEach(function(G){var Z={};o(G,Z,g.bind(null,G));var Y=V.coerce(G,{},f,"type"),X=m.data[Y];X||(X=m.data[Y]=[]),X.push(Z)}),o(C,m.layout,w.bind(null,C)),delete m.layout.template;var y=C.template;if(d(y)){var A=y.layout,R,N,te,H,U,P;d(A)&&p(A,m.layout);var re=y.data;if(d(re)){for(N in m.data)if(te=re[N],Array.isArray(te)){for(U=m.data[N],P=U.length,H=te.length,R=0;R<P;R++)p(te[R%H],U[R]);for(R=P;R<H;R++)U.push(V.extendDeep({},te[R]))}for(N in re)N in m.data||(m.data[N]=V.extendDeep([],re[N]))}}return m};function p(M,T){M=V.extendDeep({},M);var C=Object.keys(M).sort(),m,y;function A(U,P,re){if(d(P)&&d(U))p(U,P);else if(Array.isArray(P)&&Array.isArray(U)){var G=u.arrayTemplater({_template:M},re);for(y=0;y<P.length;y++){var Z=P[y],Y=G.newItem(Z)._template;Y&&p(Y,Z)}var X=G.defaultItems();for(y=0;y<X.length;y++)P.push(X[y]._template);for(y=0;y<P.length;y++)delete P[y].templateitemname}}for(m=0;m<C.length;m++){var R=C[m],N=M[R];if(R in T?A(N,T[R],R):T[R]=N,v(R)===R)for(var te in T){var H=v(te);te!==H&&H===R&&!(te in M)&&A(N,T[te],R)}}}function v(M){return M.replace(/[0-9]+$/,"")}function o(M,T,C,m,y){var A=y&&C(y);for(var R in M){var N=M[R],te=b(M,R,m),H=b(M,R,y),U=C(H);if(!U){var P=v(R);P!==R&&(H=b(M,P,y),U=C(H))}if(!(A&&A===U)&&!(!U||U._noTemplating||U.valType==="data_array"||U.arrayOk&&Array.isArray(N)))if(!U.valType&&d(N))o(N,T,C,te,H);else if(U._isLinkedToArray&&Array.isArray(N))for(var re=!1,G=0,Z={},Y=0;Y<N.length;Y++){var X=N[Y];if(d(X)){var ne=X.name;if(ne)Z[ne]||(o(X,T,C,b(N,G,te),b(N,G,H)),G++,Z[ne]=1);else if(!re){var ae=u.arrayDefaultKey(R),B=b(M,ae,m),ie=b(N,G,te);o(X,T,C,ie,b(N,G,H));var se=V.nestedProperty(T,ie),ye=V.nestedProperty(T,B);ye.set(se.get()),se.set(null),re=!0}}}else{var me=V.nestedProperty(T,te);me.set(N)}}}function w(M,T){return i.getLayoutValObject(M,V.nestedProperty({},T).parts)}function g(M,T){return i.getTraceValObject(M,V.nestedProperty({},T).parts)}function b(M,T,C){var m;return C?Array.isArray(M)?m=C+"["+T+"]":m=C+"."+T:m=T,m}W.validateTemplate=function(M,T){var C=V.extendDeep({},{_context:h,data:M.data,layout:M.layout}),m=C.layout||{};d(T)||(T=m.template||{});var y=T.layout,A=T.data,R=[];C.layout=m,C.layout.template=T,s.supplyDefaults(C);var N=C._fullLayout,te=C._fullData,H={};function U(B,ie){for(var se in B)if(se.charAt(0)!=="_"&&d(B[se])){var ye=v(se),me=[],xe;for(xe=0;xe<ie.length;xe++)me.push(b(B,se,ie[xe])),ye!==se&&me.push(b(B,ye,ie[xe]));for(xe=0;xe<me.length;xe++)H[me[xe]]=1;U(B[se],me)}}function P(B,ie){for(var se in B)if(se.indexOf("defaults")===-1&&d(B[se])){var ye=b(B,se,ie);H[ye]?P(B[se],ye):R.push({code:"unused",path:ye})}}if(d(y)?(U(N,["layout"]),P(y,"layout")):R.push({code:"layout"}),!d(A))R.push({code:"data"});else{for(var re={},G,Z=0;Z<te.length;Z++){var Y=te[Z];G=Y.type,re[G]=(re[G]||0)+1,Y._fullInput._template||R.push({code:"missing",index:Y.index,traceType:G})}for(G in A){var X=A[G].length,ne=re[G]||0;X>ne?R.push({code:"unused",traceType:G,templateCount:X,dataCount:ne}):ne>X&&R.push({code:"reused",traceType:G,templateCount:X,dataCount:ne})}}function ae(B,ie){for(var se in B)if(se.charAt(0)!=="_"){var ye=B[se],me=b(B,se,ie);d(ye)?(Array.isArray(B)&&ye._template===!1&&ye.templateitemname&&R.push({code:"missing",path:me,templateitemname:ye.templateitemname}),ae(ye,me)):Array.isArray(ye)&&L(ye)&&ae(ye,me)}}if(ae({data:te,layout:N},""),R.length)return R.map(S)};function L(M){for(var T=0;T<M.length;T++)if(d(M[T]))return!0}function S(M){var T;switch(M.code){case"data":T="The template has no key data.";break;case"layout":T="The template has no key layout.";break;case"missing":M.path?T="There are no templates for item "+M.path+" with name "+M.templateitemname:T="There are no templates for trace "+M.index+", of type "+M.traceType+".";break;case"unused":M.path?T="The template item at "+M.path+" was not used in constructing the plot.":M.dataCount?T="Some of the templates of type "+M.traceType+" were not used. The template has "+M.templateCount+" traces, the data only has "+M.dataCount+" of this type.":T="The template has "+M.templateCount+" traces of type "+M.traceType+" but there are none in the data.";break;case"reused":T="Some of the templates of type "+M.traceType+" were used more than once. The template has "+M.templateCount+" traces, the data has "+M.dataCount+" of this type.";break}return M.msg=T,M}}),Ax=t(W=>{var V=jm();W._doPlot=V._doPlot,W.newPlot=V.newPlot,W.restyle=V.restyle,W.relayout=V.relayout,W.redraw=V.redraw,W.update=V.update,W._guiRestyle=V._guiRestyle,W._guiRelayout=V._guiRelayout,W._guiUpdate=V._guiUpdate,W._storeDirectGUIEdit=V._storeDirectGUIEdit,W.react=V.react,W.extendTraces=V.extendTraces,W.prependTraces=V.prependTraces,W.addTraces=V.addTraces,W.deleteTraces=V.deleteTraces,W.moveTraces=V.moveTraces,W.purge=V.purge,W.addFrames=V.addFrames,W.deleteFrames=V.deleteFrames,W.animate=V.animate,W.setPlotConfig=V.setPlotConfig;var d=Mn().getGraphDiv,i=uf().eraseActiveShape;W.deleteActiveShape=function(f){return i(d(f))},W.toImage=Wm(),W.validate=wx(),W.downloadImage=Ym();var s=Tx();W.makeTemplate=s.makeTemplate,W.validateTemplate=s.validateTemplate}),qm=t((W,V)=>{var d=Mt(),i=an();V.exports=function(s,f,u,h){var p=h("x"),v=h("y"),o,w=i.getComponentMethod("calendars","handleTraceDefaults");if(w(s,f,["x","y"],u),p){var g=d.minRowLength(p);v?o=Math.min(g,d.minRowLength(v)):(o=g,h("y0"),h("dy"))}else{if(!v)return 0;o=d.minRowLength(v),h("x0"),h("dx")}return f._length=o,o}}),Jm=t((W,V)=>{var d=Mt().dateTick0,i=oe(),s=i.ONEWEEK;function f(u,h){return u%s===0?d(h,1):d(h,0)}V.exports=function(u,h,p,v,o){if(o||(o={x:!0,y:!0}),o.x){var w=v("xperiod");w&&(v("xperiod0",f(w,h.xcalendar)),v("xperiodalignment"))}if(o.y){var g=v("yperiod");g&&(v("yperiod0",f(g,h.ycalendar)),v("yperiodalignment"))}}}),Sx=t((W,V)=>{var d=["orientation","groupnorm","stackgaps"];V.exports=function(i,s,f,u){var h=f._scatterStackOpts,p=u("stackgroup");if(p){var v=s.xaxis+s.yaxis,o=h[v];o||(o=h[v]={});var w=o[p],g=!1;w?w.traces.push(s):(w=o[p]={traceIndices:[],traces:[s]},g=!0);for(var b={orientation:s.x&&!s.y?"h":"v"},L=0;L<d.length;L++){var S=d[L],M=S+"Found";if(!w[M]){var T=i[S]!==void 0,C=S==="orientation";if((T||g)&&(w[S]=u(S,b[S]),C&&(w.fillDflt=w[S]==="h"?"tonextx":"tonexty"),T&&(w[M]=!0,!g&&(delete w.traces[0][S],C))))for(var m=0;m<w.traces.length-1;m++){var y=w.traces[m];y._input.fill!==y.fill&&(y.fill=w.fillDflt)}}}return w}}}),Cx=t((W,V)=>{var d=Xt(),i=Di().hasColorscale,s=vl(),f=Ki();V.exports=function(u,h,p,v,o,w){var g=f.isBubble(u),b=(u.line||{}).color,L;if(w=w||{},b&&(p=b),o("marker.symbol"),o("marker.opacity",g?.7:1),o("marker.size"),w.noAngle||(o("marker.angle"),w.noAngleRef||o("marker.angleref"),w.noStandOff||o("marker.standoff")),o("marker.color",p),i(u,"marker")&&s(u,h,v,o,{prefix:"marker.",cLetter:"c"}),w.noSelect||(o("selected.marker.color"),o("unselected.marker.color"),o("selected.marker.size"),o("unselected.marker.size")),w.noLine||(b&&!Array.isArray(b)&&h.marker.color!==b?L=b:g?L=d.background:L=d.defaultLine,o("marker.line.color",L),i(u,"marker.line")&&s(u,h,v,o,{prefix:"marker.line.",cLetter:"c"}),o("marker.line.width",g?1:0)),g&&(o("marker.sizeref"),o("marker.sizemin"),o("marker.sizemode")),w.gradient){var S=o("marker.gradient.type");S!=="none"&&o("marker.gradient.color")}}}),Ex=t((W,V)=>{var d=Mt().isArrayOrTypedArray,i=Di().hasColorscale,s=vl();V.exports=function(f,u,h,p,v,o){o||(o={});var w=(f.marker||{}).color;if(w&&w._inputArray&&(w=w._inputArray),v("line.color",h),i(f,"line"))s(f,u,p,v,{prefix:"line.",cLetter:"c"});else{var g=(d(w)?!1:w)||h;v("line.color",g)}v("line.width"),o.noDash||v("line.dash"),o.backoff&&v("line.backoff")}}),Lx=t((W,V)=>{V.exports=function(d,i,s){var f=s("line.shape");f==="spline"&&s("line.smoothing")}}),Rx=t((W,V)=>{var d=Mt();V.exports=function(i,s,f,u,h){h=h||{},u("textposition"),d.coerceFont(u,"textfont",h.font||f.font,h),h.noSelect||(u("selected.textfont.color"),u("unselected.textfont.color"))}}),kx=t((W,V)=>{var d=Xt(),i=Mt().isArrayOrTypedArray;function s(f){for(var u=d.interpolate(f[0][1],f[1][1],.5),h=2;h<f.length;h++){var p=d.interpolate(f[h-1][1],f[h][1],.5);u=d.interpolate(u,p,f[h-1][0]/f[h][0])}return u}V.exports=function(f,u,h,p,v){v||(v={});var o=!1;if(u.marker){var w=u.marker.color,g=(u.marker.line||{}).color;w&&!i(w)?o=w:g&&!i(g)&&(o=g)}var b;if(v.moduleHasFillgradient){var L=p("fillgradient.type");if(L!=="none"){p("fillgradient.start"),p("fillgradient.stop");var S=p("fillgradient.colorscale");S&&(b=s(S))}}p("fillcolor",d.addOpacity((u.line||{}).color||o||b||h,.5))}}),Px=t((W,V)=>{var d=Mt(),i=an(),s=rc(),f=hf(),u=Ki(),h=qm(),p=Jm(),v=Sx(),o=Cx(),w=Ex(),g=Lx(),b=Rx(),L=kx(),S=Mt().coercePattern;V.exports=function(M,T,C,m){function y(re,G){return d.coerce(M,T,s,re,G)}var A=h(M,T,m,y);if(A||(T.visible=!1),!!T.visible){p(M,T,m,y),y("xhoverformat"),y("yhoverformat"),y("zorder");var R=v(M,T,m,y);m.scattermode==="group"&&T.orientation===void 0&&y("orientation","v");var N=!R&&A<f.PTS_LINESONLY?"lines+markers":"lines";y("text"),y("hovertext"),y("mode",N),u.hasMarkers(T)&&o(M,T,C,m,y,{gradient:!0}),u.hasLines(T)&&(w(M,T,C,m,y,{backoff:!0}),g(M,T,y),y("connectgaps"),y("line.simplify")),u.hasText(T)&&(y("texttemplate"),b(M,T,m,y));var te=[];(u.hasMarkers(T)||u.hasText(T))&&(y("cliponaxis"),y("marker.maxdisplayed"),te.push("points")),y("fill",R?R.fillDflt:"none"),T.fill!=="none"&&(L(M,T,C,y,{moduleHasFillgradient:!0}),u.hasLines(T)||g(M,T,y),S(y,"fillpattern",T.fillcolor,!1));var H=(T.line||{}).color,U=(T.marker||{}).color;(T.fill==="tonext"||T.fill==="toself")&&te.push("fills"),y("hoveron",te.join("+")||"points"),T.hoveron!=="fills"&&y("hovertemplate");var P=i.getComponentMethod("errorbars","supplyDefaults");P(M,T,H||U||C,{axis:"y"}),P(M,T,H||U||C,{axis:"x",inherit:"y"}),d.coerceSelectionMarkerOpacity(T,y)}}}),Xm=t((W,V)=>{var d=ld().getAxisGroup;V.exports=function(i,s,f,u,h){var p=s.orientation,v=s[{v:"x",h:"y"}[p]+"axis"],o=d(f,v)+p,w=f._alignmentOpts||{},g=u("alignmentgroup"),b=w[o];b||(b=w[o]={});var L=b[g];L?L.traces.push(s):L=b[g]={traces:[s],alignmentIndex:Object.keys(b).length,offsetGroups:{}};var S=u("offsetgroup")||"",M=L.offsetGroups,T=M[S];s._offsetIndex=0,(h!=="group"||S)&&(T||(T=M[S]={offsetIndex:Object.keys(M).length}),s._offsetIndex=T.offsetIndex)}}),Ox=t((W,V)=>{var d=Mt(),i=Xm(),s=rc();V.exports=function(f,u){var h,p,v,o=u.scattermode;function w(M){return d.coerce(p._input,p,s,M)}if(u.scattermode==="group")for(v=0;v<f.length;v++)p=f[v],p.type==="scatter"&&(h=p._input,i(h,p,u,w,o));for(v=0;v<f.length;v++){var g=f[v];if(g.type==="scatter"){var b=g.fill;if(!(b==="none"||b==="toself")&&(g.opacity=void 0,b==="tonexty"||b==="tonextx"))for(var L=v-1;L>=0;L--){var S=f[L];if(S.type==="scatter"&&S.xaxis===g.xaxis&&S.yaxis===g.yaxis){S.opacity=void 0;break}}}}}}),Nx=t((W,V)=>{var d=Mt(),i=$a();V.exports=function(s,f){function u(p,v){return d.coerce(s,f,i,p,v)}var h=f.barmode==="group";f.scattermode==="group"&&u("scattergap",h?f.bargap:.2)}}),Zm=t((W,V)=>{var d=q(),i=Mt(),s=i.dateTime2ms,f=i.incrementMonth,u=oe(),h=u.ONEAVGMONTH;V.exports=function(p,v,o,w){if(v.type!=="date")return{vals:w};var g=p[o+"periodalignment"];if(!g)return{vals:w};var b=p[o+"period"],L;if(d(b)){if(b=+b,b<=0)return{vals:w}}else if(typeof b=="string"&&b.charAt(0)==="M"){var S=+b.substring(1);if(S>0&&Math.round(S)===S)L=S;else return{vals:w}}for(var M=v.calendar,T=g==="start",C=g==="end",m=p[o+"period0"],y=s(m,M)||0,A=[],R=[],N=[],te=w.length,H=0;H<te;H++){var U=w[H],P,re,G;if(L){for(P=Math.round((U-y)/(L*h)),G=f(y,L*P,M);G>U;)G=f(G,-L,M);for(;G<=U;)G=f(G,L,M);re=f(G,-L,M)}else{for(P=Math.round((U-y)/b),G=y+P*b;G>U;)G-=b;for(;G<=U;)G+=b;re=G-b}A[H]=T?re:C?G:(re+G)/2,R[H]=re,N[H]=G}return{vals:A,starts:R,ends:N}}}),Dx=t((W,V)=>{var d=Di().hasColorscale,i=Kc(),s=Ki();V.exports=function(f,u){s.hasLines(u)&&d(u,"line")&&i(f,u,{vals:u.line.color,containerStr:"line",cLetter:"c"}),s.hasMarkers(u)&&(d(u,"marker")&&i(f,u,{vals:u.marker.color,containerStr:"marker",cLetter:"c"}),d(u,"marker.line")&&i(f,u,{vals:u.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}}),Qm=t((W,V)=>{var d=Mt();V.exports=function(i,s){for(var f=0;f<i.length;f++)i[f].i=f;d.mergeArray(s.text,i,"tx"),d.mergeArray(s.texttemplate,i,"txt"),d.mergeArray(s.hovertext,i,"htx"),d.mergeArray(s.customdata,i,"data"),d.mergeArray(s.textposition,i,"tp"),s.textfont&&(d.mergeArrayCastPositive(s.textfont.size,i,"ts"),d.mergeArray(s.textfont.color,i,"tc"),d.mergeArray(s.textfont.family,i,"tf"),d.mergeArray(s.textfont.weight,i,"tw"),d.mergeArray(s.textfont.style,i,"ty"),d.mergeArray(s.textfont.variant,i,"tv"),d.mergeArray(s.textfont.textcase,i,"tC"),d.mergeArray(s.textfont.lineposition,i,"tE"),d.mergeArray(s.textfont.shadow,i,"tS"));var u=s.marker;if(u){d.mergeArrayCastPositive(u.size,i,"ms"),d.mergeArrayCastPositive(u.opacity,i,"mo"),d.mergeArray(u.symbol,i,"mx"),d.mergeArray(u.angle,i,"ma"),d.mergeArray(u.standoff,i,"mf"),d.mergeArray(u.color,i,"mc");var h=u.line;u.line&&(d.mergeArray(h.color,i,"mlc"),d.mergeArrayCastPositive(h.width,i,"mlw"));var p=u.gradient;p&&p.type!=="none"&&(d.mergeArray(p.type,i,"mgt"),d.mergeArray(p.color,i,"mgc"))}}}),Km=t((W,V)=>{var d=Mt();V.exports=function(i,s){d.isArrayOrTypedArray(s.selectedpoints)&&d.tagSelected(i,s)}}),$m=t((W,V)=>{var d=q(),i=Mt(),s=Ja(),f=Zm(),u=oe().BADNUM,h=Ki(),p=Dx(),v=Qm(),o=Km();function w(T,C){var m=T._fullLayout,y=C._xA=s.getFromId(T,C.xaxis||"x","x"),A=C._yA=s.getFromId(T,C.yaxis||"y","y"),R=y.makeCalcdata(C,"x"),N=A.makeCalcdata(C,"y"),te=f(C,y,"x",R),H=f(C,A,"y",N),U=te.vals,P=H.vals,re=C._length,G=new Array(re),Z=C.ids,Y=M(C,m,y,A),X=!1,ne,ae,B,ie,se,ye;L(m,C);var me="x",xe="y",Re;if(Y)i.pushUnique(Y.traceIndices,C.index),ne=Y.orientation==="v",ne?(xe="s",Re="x"):(me="s",Re="y"),se=Y.stackgaps==="interpolate";else{var ke=b(C,re);g(T,C,y,A,U,P,ke)}var Ie=!!C.xperiodalignment,Q=!!C.yperiodalignment;for(ae=0;ae<re;ae++){var ee=G[ae]={},D=d(U[ae]),le=d(P[ae]);D&&le?(ee[me]=U[ae],ee[xe]=P[ae],Ie&&(ee.orig_x=R[ae],ee.xEnd=te.ends[ae],ee.xStart=te.starts[ae]),Q&&(ee.orig_y=N[ae],ee.yEnd=H.ends[ae],ee.yStart=H.starts[ae])):Y&&(ne?D:le)?(ee[Re]=ne?U[ae]:P[ae],ee.gap=!0,se?(ee.s=u,X=!0):ee.s=0):ee[me]=ee[xe]=u,Z&&(ee.id=String(Z[ae]))}if(v(G,C),p(T,C),o(G,C),Y){for(ae=0;ae<G.length;)G[ae][Re]===u?G.splice(ae,1):ae++;if(i.sort(G,function(F,J){return F[Re]-J[Re]||F.i-J.i}),X){for(ae=0;ae<G.length-1&&G[ae].gap;)ae++;for(ye=G[ae].s,ye||(ye=G[ae].s=0),B=0;B<ae;B++)G[B].s=ye;for(ie=G.length-1;ie>ae&&G[ie].gap;)ie--;for(ye=G[ie].s,B=G.length-1;B>ie;B--)G[B].s=ye;for(;ae<ie;)if(ae++,G[ae].gap){for(B=ae+1;G[B].gap;)B++;for(var ge=G[ae-1][Re],j=G[ae-1].s,k=(G[B].s-j)/(G[B][Re]-ge);ae<B;)G[ae].s=j+(G[ae][Re]-ge)*k,ae++}}}return G}function g(T,C,m,y,A,R,N){var te=C._length,H=T._fullLayout,U=m._id,P=y._id,re=H._firstScatter[S(C)]===C.uid,G=(M(C,H,m,y)||{}).orientation,Z=C.fill;m._minDtick=0,y._minDtick=0;var Y={padded:!0},X={padded:!0};N&&(Y.ppad=X.ppad=N);var ne=te<2||A[0]!==A[te-1]||R[0]!==R[te-1];ne&&(Z==="tozerox"||Z==="tonextx"&&(re||G==="h"))?Y.tozero=!0:!(C.error_y||{}).visible&&(Z==="tonexty"||Z==="tozeroy"||!h.hasMarkers(C)&&!h.hasText(C))&&(Y.padded=!1,Y.ppad=0),ne&&(Z==="tozeroy"||Z==="tonexty"&&(re||G==="v"))?X.tozero=!0:(Z==="tonextx"||Z==="tozerox")&&(X.padded=!1),U&&(C._extremes[U]=s.findExtremes(m,A,Y)),P&&(C._extremes[P]=s.findExtremes(y,R,X))}function b(T,C){if(h.hasMarkers(T)){var m=T.marker,y=1.6*(T.marker.sizeref||1),A;if(T.marker.sizemode==="area"?A=function(U){return Math.max(Math.sqrt((U||0)/y),3)}:A=function(U){return Math.max((U||0)/y,3)},i.isArrayOrTypedArray(m.size)){var R={type:"linear"};s.setConvert(R);for(var N=R.makeCalcdata(T.marker,"size"),te=new Array(C),H=0;H<C;H++)te[H]=A(N[H]);return te}else return A(m.size)}}function L(T,C){var m=S(C),y=T._firstScatter;y[m]||(y[m]=C.uid)}function S(T){var C=T.stackgroup;return T.xaxis+T.yaxis+T.type+(C?"-"+C:"")}function M(T,C,m,y){var A=T.stackgroup;if(A){var R=C._scatterStackOpts[m._id+y._id][A],N=R.orientation==="v"?y:m;if(N.type==="linear"||N.type==="log")return R}}V.exports={calc:w,calcMarkerSize:b,calcAxisExpansion:g,setFirstScatter:L,getStackOpts:M}}),Ix=t((W,V)=>{V.exports=i;var d=Mt().distinctVals;function i(s,f){this.traces=s,this.sepNegVal=f.sepNegVal,this.overlapNoMerge=f.overlapNoMerge;for(var u=1/0,h=f.posAxis._id.charAt(0),p=[],v=0;v<s.length;v++){for(var o=s[v],w=0;w<o.length;w++){var g=o[w],b=g.p;b===void 0&&(b=g[h]),b!==void 0&&p.push(b)}o[0]&&o[0].width1&&(u=Math.min(o[0].width1,u))}this.positions=p;var L=d(p);this.distinctPositions=L.vals,L.vals.length===1&&u!==1/0?this.minDiff=u:this.minDiff=Math.min(L.minDiff,u);var S=(f.posAxis||{}).type;(S==="category"||S==="multicategory")&&(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}i.prototype.put=function(s,f,u){var h=this.getLabel(s,f,u),p=this.bins[h]||0;return this.bins[h]=p+u,p},i.prototype.get=function(s,f,u){var h=this.getLabel(s,f,u);return this.bins[h]||0},i.prototype.getLabel=function(s,f,u){var h=u<0&&this.sepNegVal?"v":"^",p=this.overlapNoMerge?s:Math.round(s/this.binWidth);return h+p+"g"+f}}),e1=t((W,V)=>{var d=q(),i=Mt().isArrayOrTypedArray,s=oe().BADNUM,f=an(),u=Ja(),h=ld().getAxisGroup,p=Ix();function v(G,Z){for(var Y=Z.xaxis,X=Z.yaxis,ne=G._fullLayout,ae=G._fullData,B=G.calcdata,ie=[],se=[],ye=0;ye<ae.length;ye++){var me=ae[ye];if(me.visible===!0&&f.traceIs(me,"bar")&&me.xaxis===Y._id&&me.yaxis===X._id&&(me.orientation==="h"?ie.push(B[ye]):se.push(B[ye]),me._computePh))for(var xe=G.calcdata[ye],Re=0;Re<xe.length;Re++)typeof xe[Re].ph0=="function"&&(xe[Re].ph0=xe[Re].ph0()),typeof xe[Re].ph1=="function"&&(xe[Re].ph1=xe[Re].ph1())}var ke={xCat:Y.type==="category"||Y.type==="multicategory",yCat:X.type==="category"||X.type==="multicategory",mode:ne.barmode,norm:ne.barnorm,gap:ne.bargap,groupgap:ne.bargroupgap};o(G,Y,X,se,ke),o(G,X,Y,ie,ke)}function o(G,Z,Y,X,ne){if(X.length){var ae,B,ie,se,ye;switch(b(Y,X),ne.mode){case"overlay":L(G,Z,Y,X,ne);break;case"group":for(ae=[],B=[],ie=0;ie<X.length;ie++)se=X[ie],ye=se[0].trace,ye.offset===void 0?B.push(se):ae.push(se);B.length&&S(G,Z,Y,B,ne),ae.length&&L(G,Z,Y,ae,ne);break;case"stack":case"relative":for(ae=[],B=[],ie=0;ie<X.length;ie++)se=X[ie],ye=se[0].trace,ye.base===void 0?B.push(se):ae.push(se);g(B),B.length&&M(G,Z,Y,B,ne),ae.length&&L(G,Z,Y,ae,ne);break}w(X),P(X,Z)}}function w(G){var Z,Y,X,ne,ae,B,ie;for(Z=0;Z<G.length;Z++)Y=G[Z],X=Y[0].trace,ne=Y[0].t,ne.cornerradiusvalue===void 0&&(ae=X.marker?X.marker.cornerradius:void 0,ae!==void 0&&(B=d(ae)?+ae:+ae.slice(0,-1),ie=d(ae)?"px":"%",ne.cornerradiusvalue=B,ne.cornerradiusform=ie))}function g(G){if(!(G.length<2)){var Z,Y,X,ne,ae,B,ie;for(Z=0;Z<G.length&&(Y=G[Z],X=Y[0].trace,ae=X.marker?X.marker.cornerradius:void 0,ae===void 0);Z++);if(ae!==void 0)for(B=d(ae)?+ae:+ae.slice(0,-1),ie=d(ae)?"px":"%",Z=0;Z<G.length;Z++)Y=G[Z],ne=Y[0].t,ne.cornerradiusvalue=B,ne.cornerradiusform=ie}}function b(G,Z){var Y,X;for(Y=0;Y<Z.length;Y++){var ne=Z[Y],ae=ne[0].trace,B=ae.type==="funnel"?ae._base:ae.base,ie,se=ae.orientation==="h"?ae.xcalendar:ae.ycalendar,ye=G.type==="category"||G.type==="multicategory"?function(){return null}:G.d2c;if(i(B)){for(X=0;X<Math.min(B.length,ne.length);X++)ie=ye(B[X],0,se),d(ie)?(ne[X].b=+ie,ne[X].hasB=1):ne[X].b=0;for(;X<ne.length;X++)ne[X].b=0}else{ie=ye(B,0,se);var me=d(ie);for(ie=me?ie:0,X=0;X<ne.length;X++)ne[X].b=ie,me&&(ne[X].hasB=1)}}}function L(G,Z,Y,X,ne){for(var ae=0;ae<X.length;ae++){var B=X[ae],ie=new p([B],{posAxis:Z,sepNegVal:!1,overlapNoMerge:!ne.norm});T(G,Z,ie,ne),ne.norm?(N(ie),H(Y,ie,ne)):A(Y,ie)}}function S(G,Z,Y,X,ne){var ae=new p(X,{posAxis:Z,sepNegVal:!1,overlapNoMerge:!ne.norm});T(G,Z,ae,ne),te(ae,Z),ne.norm?(N(ae),H(Y,ae,ne)):A(Y,ae)}function M(G,Z,Y,X,ne){var ae=new p(X,{posAxis:Z,sepNegVal:ne.mode==="relative",overlapNoMerge:!(ne.norm||ne.mode==="stack"||ne.mode==="relative")});T(G,Z,ae,ne),R(Y,ae,ne);for(var B=0;B<X.length;B++)for(var ie=X[B],se=ie[0].t.offsetindex,ye=0;ye<ie.length;ye++){var me=ie[ye];if(me.s!==s){var xe=me.b+me.s===ae.get(me.p,se,me.s);xe&&(me._outmost=!0)}}ne.norm&&H(Y,ae,ne)}function T(G,Z,Y,X){var ne=G._fullLayout,ae=Y.positions,B=Y.distinctPositions,ie=Y.minDiff,se=Y.traces,ye=se.length,me=ae.length!==B.length,xe=ie*(1-X.gap),Re,ke,Ie,Q;if(Z._id==="angularaxis")Re=xe,ke=Re*(1-(X.groupgap||0)),Ie=-ke/2;else{var ee=h(ne,Z._id)+se[0][0].trace.orientation;Q=ne._alignmentOpts[ee]||{}}for(var D=0;D<ye;D++){var le=se[D],ge=le[0].trace;if(Z._id!=="angularaxis"){var j=Q[ge.alignmentgroup]||{},k=Object.keys(j.offsetGroups||{}).length;k?Re=xe/k:Re=me?xe/ye:xe,ke=Re*(1-(X.groupgap||0)),k?Ie=((2*ge._offsetIndex+1-k)*Re-ke)/2:Ie=me?((2*D+1-ye)*Re-ke)/2:-ke/2}var F=le[0].t;F.barwidth=ke,F.offsetindex=ge._offsetIndex||0,F.poffset=Ie,F.bargroupwidth=xe,F.bardelta=ie}Y.binWidth=se[0][0].t.barwidth/100,C(Y),m(Z,Y),Z._id==="angularaxis"?y(Z,Y):y(Z,Y,me)}function C(G){var Z=G.traces,Y,X;for(Y=0;Y<Z.length;Y++){var ne=Z[Y],ae=ne[0],B=ae.trace,ie=ae.t,se=B._offset||B.offset,ye=ie.poffset,me;if(i(se)){for(me=Array.prototype.slice.call(se,0,ne.length),X=0;X<me.length;X++)d(me[X])||(me[X]=ye);for(X=me.length;X<ne.length;X++)me.push(ye);ie.poffset=me}else se!==void 0&&(ie.poffset=se);var xe=B._width||B.width,Re=ie.barwidth;if(i(xe)){var ke=Array.prototype.slice.call(xe,0,ne.length);for(X=0;X<ke.length;X++)d(ke[X])||(ke[X]=Re);for(X=ke.length;X<ne.length;X++)ke.push(Re);if(ie.barwidth=ke,se===void 0){for(me=[],X=0;X<ne.length;X++)me.push(ye+(Re-ke[X])/2);ie.poffset=me}}else xe!==void 0&&(ie.barwidth=xe,se===void 0&&(ie.poffset=ye+(Re-xe)/2))}}function m(G,Z){for(var Y=Z.traces,X=re(G),ne=0;ne<Y.length;ne++)for(var ae=Y[ne],B=ae[0].t,ie=B.poffset,se=i(ie),ye=B.barwidth,me=i(ye),xe=0;xe<ae.length;xe++){var Re=ae[xe],ke=Re.w=me?ye[xe]:ye;Re.p===void 0&&(Re.p=Re[X],Re["orig_"+X]=Re[X]);var Ie=(se?ie[xe]:ie)+ke/2;Re[X]=Re.p+Ie}}function y(G,Z,Y){var X=Z.traces,ne=Z.minDiff,ae=ne/2;u.minDtick(G,Z.minDiff,Z.distinctPositions[0],Y);for(var B=0;B<X.length;B++){var ie=X[B],se=ie[0],ye=se.trace,me=[],xe,Re,ke,Ie;for(Ie=0;Ie<ie.length;Ie++)xe=ie[Ie],Re=xe.p-ae,ke=xe.p+ae,me.push(Re,ke);if(ye.width||ye.offset){var Q=se.t,ee=Q.poffset,D=Q.barwidth,le=i(ee),ge=i(D);for(Ie=0;Ie<ie.length;Ie++){xe=ie[Ie];var j=le?ee[Ie]:ee,k=ge?D[Ie]:D;Re=xe.p+j,ke=Re+k,me.push(Re,ke)}}ye._extremes[G._id]=u.findExtremes(G,me,{padded:!1})}}function A(G,Z){for(var Y=Z.traces,X=re(G),ne=0;ne<Y.length;ne++){for(var ae=Y[ne],B=ae[0].trace,ie=B.type==="scatter",se=B.orientation==="v",ye=[],me=!1,xe=0;xe<ae.length;xe++){var Re=ae[xe],ke=ie?0:Re.b,Ie=ie?se?Re.y:Re.x:ke+Re.s;Re[X]=Ie,ye.push(Ie),Re.hasB&&ye.push(ke),(!Re.hasB||!Re.b)&&(me=!0)}B._extremes[G._id]=u.findExtremes(G,ye,{tozero:me,padded:!0})}}function R(G,Z,Y){var X=re(G),ne=Z.traces,ae,B,ie,se,ye,me,xe;for(se=0;se<ne.length;se++)if(ae=ne[se],B=ae[0].trace,B.type==="funnel")for(xe=ae[0].t.offsetindex,ye=0;ye<ae.length;ye++)me=ae[ye],me.s!==s&&Z.put(me.p,xe,-.5*me.s);for(se=0;se<ne.length;se++){ae=ne[se],B=ae[0].trace,ie=B.type==="funnel",xe=B.type==="barpolar"?0:ae[0].t.offsetindex;var Re=[];for(ye=0;ye<ae.length;ye++)if(me=ae[ye],me.s!==s){var ke;ie?ke=me.s:ke=me.s+me.b;var Ie=Z.put(me.p,xe,ke),Q=Ie+ke;me.b=Ie,me[X]=Q,Y.norm||(Re.push(Q),me.hasB&&Re.push(Ie))}Y.norm||(B._extremes[G._id]=u.findExtremes(G,Re,{tozero:!0,padded:!0}))}}function N(G){for(var Z=G.traces,Y=0;Y<Z.length;Y++)for(var X=Z[Y],ne=X[0].t.offsetindex,ae=0;ae<X.length;ae++){var B=X[ae];B.s!==s&&G.put(B.p,ne,B.b+B.s)}}function te(G,Z){for(var Y=G.traces,X=0;X<Y.length;X++){var ne=Y[X],ae=ne[0].trace,B=ne[0].t.offsetindex;if(ae.base===void 0)for(var ie=new p([ne],{posAxis:Z,sepNegVal:!0,overlapNoMerge:!0}),se=0;se<ne.length;se++){var ye=ne[se];if(ye.p!==s){var me=ie.put(ye.p,B,ye.b+ye.s);me&&(ye.b=me)}}}}function H(G,Z,Y){var X=Z.traces,ne=re(G),ae=Y.norm==="fraction"?1:100,B=ae/1e9,ie=G.l2c(G.c2l(0)),se=Y.mode==="stack"?ae:ie;function ye(F){return d(G.c2l(F))&&(F<ie-B||F>se+B||!d(ie))}for(var me=0;me<X.length;me++){for(var xe=X[me],Re=xe[0].t.offsetindex,ke=xe[0].trace,Ie=[],Q=!1,ee=!1,D=0;D<xe.length;D++){var le=xe[D];if(le.s!==s){var ge=Math.abs(ae/Z.get(le.p,Re,le.s));le.b*=ge,le.s*=ge;var j=le.b,k=j+le.s;le[ne]=k,Ie.push(k),ee=ee||ye(k),le.hasB&&(Ie.push(j),ee=ee||ye(j)),(!le.hasB||!le.b)&&(Q=!0)}}ke._extremes[G._id]=u.findExtremes(G,Ie,{tozero:Q,padded:ee})}}function U(G,Z,Y,X){for(var ne=re(X),ae=0;ae<G.length;ae++)for(var B=G[ae],ie=0;ie<B.length;ie++){var se=B[ie],ye=se[ne];se._sMin=Z[ye],se._sMax=Y[ye]}}function P(G,Z){var Y=re(Z),X={},ne,ae,B,ie=1/0,se=-1/0;for(ne=0;ne<G.length;ne++)for(B=G[ne],ae=0;ae<B.length;ae++){var ye=B[ae].p;d(ye)&&(ie=Math.min(ie,ye),se=Math.max(se,ye))}var me=1e4/(se-ie),xe=X.round=function(K){return String(Math.round(me*(K-ie)))},Re={},ke={},Ie=G.some(function(K){var ve=K[0].trace;return"marker"in ve&&ve.marker.cornerradius});for(ne=0;ne<G.length;ne++){B=G[ne],B[0].t.extents=X;var Q=B[0].t.poffset,ee=i(Q);for(ae=0;ae<B.length;ae++){var D=B[ae],le=D[Y]-D.w/2;if(d(le)){var ge=D[Y]+D.w/2,j=xe(D.p);X[j]?X[j]=[Math.min(le,X[j][0]),Math.max(ge,X[j][1])]:X[j]=[le,ge]}if(D.p0=D.p+(ee?Q[ae]:Q),D.p1=D.p0+D.w,D.s0=D.b,D.s1=D.s0+D.s,Ie){var k=Math.min(D.s0,D.s1)||0,F=Math.max(D.s0,D.s1)||0,J=D[Y];Re[J]=J in Re?Math.min(Re[J],k):k,ke[J]=J in ke?Math.max(ke[J],F):F}}}Ie&&U(G,Re,ke,Z)}function re(G){return G._id.charAt(0)}V.exports={crossTraceCalc:v,setGroupPositions:o}}),zx=t((W,V)=>{var d=$m(),i=e1().setGroupPositions;function s(h,p){for(var v=p.xaxis,o=p.yaxis,w=h._fullLayout,g=h._fullData,b=h.calcdata,L=[],S=[],M=0;M<g.length;M++){var T=g[M];T.visible===!0&&T.type==="scatter"&&T.xaxis===v._id&&T.yaxis===o._id&&(T.orientation==="h"?L.push(b[M]):T.orientation==="v"&&S.push(b[M]))}var C={mode:w.scattermode,gap:w.scattergap};i(h,v,o,S,C),i(h,o,v,L,C)}V.exports=function(h,p){h._fullLayout.scattermode==="group"&&s(h,p);var v=p.xaxis,o=p.yaxis,w=v._id+o._id,g=h._fullLayout._scatterStackOpts[w];if(g){var b=h.calcdata,L,S,M,T,C,m,y,A,R,N,te,H,U,P,re;for(var G in g){N=g[G];var Z=N.traceIndices;if(Z.length){for(te=N.stackgaps==="interpolate",H=N.groupnorm,N.orientation==="v"?(U="x",P="y"):(U="y",P="x"),re=new Array(Z.length),L=0;L<re.length;L++)re[L]=!1;m=b[Z[0]];var Y=new Array(m.length);for(L=0;L<m.length;L++)Y[L]=m[L][U];for(L=1;L<Z.length;L++){for(C=b[Z[L]],S=M=0;S<C.length;S++){for(y=C[S][U];y>Y[M]&&M<Y.length;M++)f(C,S,Y[M],L,re,te,U),S++;if(y!==Y[M]){for(T=0;T<L;T++)f(b[Z[T]],M,y,T,re,te,U);Y.splice(M,0,y)}M++}for(;M<Y.length;M++)f(C,S,Y[M],L,re,te,U),S++}var X=Y.length;for(S=0;S<m.length;S++){for(A=m[S][P]=m[S].s,L=1;L<Z.length;L++)C=b[Z[L]],C[0].trace._rawLength=C[0].trace._length,C[0].trace._length=X,A+=C[S].s,C[S][P]=A;if(H)for(R=(H==="fraction"?A:A/100)||1,L=0;L<Z.length;L++){var ne=b[Z[L]][S];ne[P]/=R,ne.sNorm=ne.s/R}}for(L=0;L<Z.length;L++){C=b[Z[L]];var ae=C[0].trace,B=d.calcMarkerSize(ae,ae._rawLength),ie=Array.isArray(B);if(B&&re[L]||ie){var se=B;for(B=new Array(X),S=0;S<X;S++)B[S]=C[S].gap?0:ie?se[C[S].i]:se}var ye=new Array(X),me=new Array(X);for(S=0;S<X;S++)ye[S]=C[S].x,me[S]=C[S].y;d.calcAxisExpansion(h,ae,v,o,ye,me,B),C[0].t.orientation=N.orientation}}}}};function f(h,p,v,o,w,g,b){w[o]=!0;var L={i:null,gap:!0,s:0};if(L[b]=v,h.splice(p,0,L),p&&v===h[p-1][b]){var S=h[p-1];L.s=S.s,L.i=S.i,L.gap=S.gap}else g&&(L.s=u(h,p,v,b));p||(h[0].t=h[1].t,h[0].trace=h[1].trace,delete h[1].t,delete h[1].trace)}function u(h,p,v,o){var w=h[p-1],g=h[p+1];return g?w?w.s+(g.s-w.s)*(v-w[o])/(g[o]-w[o]):g.s:w.s}}),Fx=t((W,V)=>{var d=Ra(),i=oe(),s=i.BADNUM,f=i.LOG_CLIP,u=f+.5,h=f-.5,p=Mt(),v=p.segmentsIntersect,o=p.constrain,w=hf();V.exports=function(g,b){var L=b.trace||{},S=b.xaxis,M=b.yaxis,T=S.type==="log",C=M.type==="log",m=S._length,y=M._length,A=b.backoff,R=L.marker,N=b.connectGaps,te=b.baseTolerance,H=b.shape,U=H==="linear",P=L.fill&&L.fill!=="none",re=[],G=w.minTolerance,Z=g.length,Y=new Array(Z),X=0,ne,ae,B,ie,se,ye,me,xe,Re,ke,Ie,Q,ee,D,le,ge;function j(at){var xt=g[at];if(!xt)return!1;var mt=b.linearized?S.l2p(xt.x):S.c2p(xt.x),yt=b.linearized?M.l2p(xt.y):M.c2p(xt.y);if(mt===s){if(T&&(mt=S.c2p(xt.x,!0)),mt===s)return!1;C&&yt===s&&(mt*=Math.abs(S._m*y*(S._m>0?u:h)/(M._m*m*(M._m>0?u:h)))),mt*=1e3}if(yt===s){if(C&&(yt=M.c2p(xt.y,!0)),yt===s)return!1;yt*=1e3}return[mt,yt]}function k(at,xt,mt,yt){var It=mt-at,zt=yt-xt,Ut=.5-at,or=.5-xt,xr=It*It+zt*zt,zr=It*Ut+zt*or;if(zr>0&&zr<xr){var Br=Ut*zt-or*It;if(Br*Br<xr)return!0}}var F,J;function K(at,xt){var mt=at[0]/m,yt=at[1]/y,It=Math.max(0,-mt,mt-1,-yt,yt-1);return It&&F!==void 0&&k(mt,yt,F,J)&&(It=0),It&&xt&&k(mt,yt,xt[0]/m,xt[1]/y)&&(It=0),(1+w.toleranceGrowth*It)*te}function ve(at,xt){var mt=at[0]-xt[0],yt=at[1]-xt[1];return Math.sqrt(mt*mt+yt*yt)}var Te=w.maxScreensAway,Ae=-m*Te,Fe=m*(1+Te),Ge=-y*Te,rt=y*(1+Te),bt=[[Ae,Ge,Fe,Ge],[Fe,Ge,Fe,rt],[Fe,rt,Ae,rt],[Ae,rt,Ae,Ge]],ht,ct,Oe,ze,we,je;function ot(at,xt){for(var mt=[],yt=0,It=0;It<4;It++){var zt=bt[It],Ut=v(at[0],at[1],xt[0],xt[1],zt[0],zt[1],zt[2],zt[3]);Ut&&(!yt||Math.abs(Ut.x-mt[0][0])>1||Math.abs(Ut.y-mt[0][1])>1)&&(Ut=[Ut.x,Ut.y],yt&&ve(Ut,at)<ve(mt[0],at)?mt.unshift(Ut):mt.push(Ut),yt++)}return mt}function vt(at){if(at[0]<Ae||at[0]>Fe||at[1]<Ge||at[1]>rt)return[o(at[0],Ae,Fe),o(at[1],Ge,rt)]}function Lt(at,xt){if(at[0]===xt[0]&&(at[0]===Ae||at[0]===Fe)||at[1]===xt[1]&&(at[1]===Ge||at[1]===rt))return!0}function Tt(at,xt){var mt=[],yt=vt(at),It=vt(xt);return yt&&It&&Lt(yt,It)||(yt&&mt.push(yt),It&&mt.push(It)),mt}function kt(at,xt,mt){return function(yt,It){var zt=vt(yt),Ut=vt(It),or=[];if(zt&&Ut&&Lt(zt,Ut))return or;zt&&or.push(zt),Ut&&or.push(Ut);var xr=2*p.constrain((yt[at]+It[at])/2,xt,mt)-((zt||yt)[at]+(Ut||It)[at]);if(xr){var zr;zt&&Ut?zr=xr>0==zt[at]>Ut[at]?zt:Ut:zr=zt||Ut,zr[at]+=xr}return or}}var Nt;H==="linear"||H==="spline"?Nt=ot:H==="hv"||H==="vh"?Nt=Tt:H==="hvh"?Nt=kt(0,Ae,Fe):H==="vhv"&&(Nt=kt(1,Ge,rt));function Pt(at,xt){var mt=xt[0]-at[0],yt=(xt[1]-at[1])/mt,It=(at[1]*xt[0]-xt[1]*at[0])/mt;return It>0?[yt>0?Ae:Fe,rt]:[yt>0?Fe:Ae,Ge]}function Wt(at){var xt=at[0],mt=at[1],yt=xt===Y[X-1][0],It=mt===Y[X-1][1];if(!(yt&&It))if(X>1){var zt=xt===Y[X-2][0],Ut=mt===Y[X-2][1];yt&&(xt===Ae||xt===Fe)&&zt?Ut?X--:Y[X-1]=at:It&&(mt===Ge||mt===rt)&&Ut?zt?X--:Y[X-1]=at:Y[X++]=at}else Y[X++]=at}function St(at){Y[X-1][0]!==at[0]&&Y[X-1][1]!==at[1]&&Wt([Oe,ze]),Wt(at),we=null,Oe=ze=0}var Qt=p.isArrayOrTypedArray(R);function rr(at){if(at&&A&&(at.i=ne,at.d=g,at.trace=L,at.marker=Qt?R[at.i]:R,at.backoff=A),F=at[0]/m,J=at[1]/y,ht=at[0]<Ae?Ae:at[0]>Fe?Fe:0,ct=at[1]<Ge?Ge:at[1]>rt?rt:0,ht||ct){if(!X)Y[X++]=[ht||at[0],ct||at[1]];else if(we){var xt=Nt(we,at);xt.length>1&&(St(xt[0]),Y[X++]=xt[1])}else je=Nt(Y[X-1],at)[0],Y[X++]=je;var mt=Y[X-1];ht&&ct&&(mt[0]!==ht||mt[1]!==ct)?(we&&(Oe!==ht&&ze!==ct?Wt(Oe&&ze?Pt(we,at):[Oe||ht,ze||ct]):Oe&&ze&&Wt([Oe,ze])),Wt([ht,ct])):Oe-ht&&ze-ct&&Wt([ht||Oe,ct||ze]),we=at,Oe=ht,ze=ct}else we&&St(Nt(we,at)[0]),Y[X++]=at}for(ne=0;ne<Z;ne++)if(ae=j(ne),!!ae){for(X=0,we=null,rr(ae),ne++;ne<Z;ne++){if(ie=j(ne),!ie){if(N)continue;break}if(!U||!b.simplify){rr(ie);continue}var Jt=j(ne+1);if(ke=ve(ie,ae),!(!(P&&(X===0||X===Z-1))&&ke<K(ie,Jt)*G)){for(xe=[(ie[0]-ae[0])/ke,(ie[1]-ae[1])/ke],se=ae,Ie=ke,Q=D=le=0,me=!1,B=ie,ne++;ne<g.length;ne++){if(ye=Jt,Jt=j(ne+1),!ye){if(N)continue;break}if(Re=[ye[0]-ae[0],ye[1]-ae[1]],ge=Re[0]*xe[1]-Re[1]*xe[0],D=Math.min(D,ge),le=Math.max(le,ge),le-D>K(ye,Jt))break;B=ye,ee=Re[0]*xe[0]+Re[1]*xe[1],ee>Ie?(Ie=ee,ie=ye,me=!1):ee<Q&&(Q=ee,se=ye,me=!0)}if(me?(rr(ie),B!==se&&rr(se)):(se!==ae&&rr(se),B!==ie&&rr(ie)),rr(B),ne>=g.length||!ye)break;rr(ye),ae=ye}}we&&Wt([Oe||we[0],ze||we[1]]),re.push(Y.slice(0,X))}var sr=H.slice(H.length-1);if(A&&sr!=="h"&&sr!=="v"){for(var De=!1,Je=-1,de=[],Me=0;Me<re.length;Me++)for(var Ce=0;Ce<re[Me].length-1;Ce++){var Ue=re[Me][Ce],He=re[Me][Ce+1],et=d.applyBackoff(He,Ue);(et[0]!==He[0]||et[1]!==He[1])&&(De=!0),de[Je+1]||(Je++,de[Je]=[Ue,[et[0],et[1]]])}return De?de:re}return re}}),Ux=t((W,V)=>{var d={tonextx:1,tonexty:1,tonext:1};V.exports=function(i,s,f){var u,h,p,v,o,w={},g=!1,b=-1,L=0,S=-1;for(h=0;h<f.length;h++)u=f[h][0].trace,p=u.stackgroup||"",p?p in w?o=w[p]:(o=w[p]=L,L++):u.fill in d&&S>=0?o=S:(o=S=L,L++),o<b&&(g=!0),u._groupIndex=b=o;var M=f.slice();g&&M.sort(function(C,m){var y=C[0].trace,A=m[0].trace;return y._groupIndex-A._groupIndex||y.index-A.index});var T={};for(h=0;h<M.length;h++)u=M[h][0].trace,p=u.stackgroup||"",u.visible===!0?(u._nexttrace=null,u.fill in d&&(v=T[p],u._prevtrace=v||null,v&&(v._nexttrace=u)),u._ownfill=u.fill&&(u.fill.substr(0,6)==="tozero"||u.fill==="toself"||u.fill.substr(0,2)==="to"&&!u._prevtrace),T[p]=u):u._prevtrace=u._nexttrace=u._ownfill=null;return M}}),Bx=t((W,V)=>{var d=l(),i=an(),s=Mt(),f=s.ensureSingle,u=s.identity,h=Ra(),p=Ki(),v=Fx(),o=Ux(),w=Bm().tester;V.exports=function(S,M,T,C,m,y){var A,R,N=!m,te=!!m&&m.duration>0,H=o(S,M,T);if(A=C.selectAll("g.trace").data(H,function(P){return P[0].trace.uid}),A.enter().append("g").attr("class",function(P){return"trace scatter trace"+P[0].trace.uid}).style("stroke-miterlimit",2),A.order(),g(S,A,M),te){y&&(R=y());var U=d.transition().duration(m.duration).ease(m.easing).each("end",function(){R&&R()}).each("interrupt",function(){R&&R()});U.each(function(){C.selectAll("g.trace").each(function(P,re){b(S,re,M,P,H,this,m)})})}else A.each(function(P,re){b(S,re,M,P,H,this,m)});N&&A.exit().remove(),C.selectAll("path:not([d])").remove()};function g(S,M,T){M.each(function(C){var m=f(d.select(this),"g","fills");h.setClipUrl(m,T.layerClipId,S);var y=C[0].trace,A=[];y._ownfill&&A.push("_ownFill"),y._nexttrace&&A.push("_nextFill");var R=m.selectAll("g").data(A,u);R.enter().append("g"),R.exit().each(function(N){y[N]=null}).remove(),R.order().each(function(N){y[N]=f(d.select(this),"path","js-fill")})})}function b(S,M,T,C,m,y,A){var R=S._context.staticPlot,N;L(S,M,T,C,m);var te=!!A&&A.duration>0;function H(St){return te?St.transition():St}var U=T.xaxis,P=T.yaxis,re=C[0].trace,G=re.line,Z=d.select(y),Y=f(Z,"g","errorbars"),X=f(Z,"g","lines"),ne=f(Z,"g","points"),ae=f(Z,"g","text");if(i.getComponentMethod("errorbars","plot")(S,Y,T,A),re.visible!==!0)return;H(Z).style("opacity",re.opacity);var B,ie,se=re.fill.charAt(re.fill.length-1);se!=="x"&&se!=="y"&&(se="");var ye,me;se==="y"?(ye=1,me=P.c2p(0,!0)):se==="x"&&(ye=0,me=U.c2p(0,!0)),C[0][T.isRangePlot?"nodeRangePlot3":"node3"]=Z;var xe="",Re=[],ke=re._prevtrace,Ie=null,Q=null;ke&&(xe=ke._prevRevpath||"",ie=ke._nextFill,Re=ke._ownPolygons,Ie=ke._fillsegments,Q=ke._fillElement);var ee,D,le="",ge="",j,k,F,J,K,ve,Te=[];re._polygons=[];var Ae=[],Fe=[],Ge=s.noop;if(B=re._ownFill,p.hasLines(re)||re.fill!=="none"){ie&&ie.datum(C),["hv","vh","hvh","vhv"].indexOf(G.shape)!==-1?(j=h.steps(G.shape),k=h.steps(G.shape.split("").reverse().join(""))):G.shape==="spline"?j=k=function(St){var Qt=St[St.length-1];return St.length>1&&St[0][0]===Qt[0]&&St[0][1]===Qt[1]?h.smoothclosed(St.slice(1),G.smoothing):h.smoothopen(St,G.smoothing)}:j=k=function(St){return"M"+St.join("L")},F=function(St){return k(St.reverse())},Fe=v(C,{xaxis:U,yaxis:P,trace:re,connectGaps:re.connectgaps,baseTolerance:Math.max(G.width||1,3)/4,shape:G.shape,backoff:G.backoff,simplify:G.simplify,fill:re.fill}),Ae=new Array(Fe.length);var rt=0;for(N=0;N<Fe.length;N++){var bt,ht=Fe[N];!bt||!se?(bt=ht.slice(),Ae[rt]=bt,rt++):bt.push.apply(bt,ht)}re._fillElement=null,re._fillExclusionElement=Q,re._fillsegments=Ae.slice(0,rt),Ae=re._fillsegments,Fe.length&&(J=Fe[0][0].slice(),K=Fe[Fe.length-1],ve=K[K.length-1].slice()),Ge=function(St){return function(Qt){if(ee=j(Qt),D=F(Qt),le?se?(le+="L"+ee.substr(1),ge=D+("L"+ge.substr(1))):(le+="Z"+ee,ge=D+"Z"+ge):(le=ee,ge=D),p.hasLines(re)){var rr=d.select(this);if(rr.datum(C),St)H(rr.style("opacity",0).attr("d",ee).call(h.lineGroupStyle)).style("opacity",1);else{var Jt=H(rr);Jt.attr("d",ee),h.singleLineStyle(C,Jt)}}}}}var ct=X.selectAll(".js-line").data(Fe);H(ct.exit()).style("opacity",0).remove(),ct.each(Ge(!1)),ct.enter().append("path").classed("js-line",!0).style("vector-effect",R?"none":"non-scaling-stroke").call(h.lineGroupStyle).each(Ge(!0)),h.setClipUrl(ct,T.layerClipId,S);function Oe(St){H(St).attr("d","M0,0Z")}var ze=function(){var St=new Array(Ae.length);for(N=0;N<Ae.length;N++)St[N]=w(Ae[N]);return St},we=function(St){var Qt,rr;if(!St||St.length===0)for(Qt=new Array(Ae.length),rr=0;rr<Ae.length;rr++){var Jt=Ae[rr][0].slice(),sr=Ae[rr][Ae[rr].length-1].slice();Jt[ye]=sr[ye]=me;var De=[sr,Jt],Je=De.concat(Ae[rr]);Qt[rr]=w(Je)}else{for(Qt=new Array(St.length-1+Ae.length),rr=0;rr<St.length-1;rr++)Qt[rr]=w(St[rr]);var de=St[St.length-1].slice();for(de.reverse(),rr=0;rr<Ae.length;rr++)Qt[St.length-1+rr]=w(Ae[rr].concat(de))}return Qt};Fe.length?(B?(B.datum(C),J&&ve&&(se?(J[ye]=ve[ye]=me,H(B).attr("d","M"+ve+"L"+J+"L"+le.substr(1)).call(h.singleFillStyle,S),Te=we(null)):(H(B).attr("d",le+"Z").call(h.singleFillStyle,S),Te=ze())),re._polygons=Te,re._fillElement=B):ie&&(re.fill.substr(0,6)==="tonext"&&le&&xe?(re.fill==="tonext"?(H(ie).attr("d",le+"Z"+xe+"Z").call(h.singleFillStyle,S),Te=ze(),re._polygons=Te.concat(Re)):(H(ie).attr("d",le+"L"+xe.substr(1)+"Z").call(h.singleFillStyle,S),Te=we(Ie),re._polygons=Te),re._fillElement=ie):Oe(ie)),re._prevRevpath=ge):(B?Oe(B):ie&&Oe(ie),re._prevRevpath=null),re._ownPolygons=Te;function je(St){return St.filter(function(Qt){return!Qt.gap&&Qt.vis})}function ot(St){return St.filter(function(Qt){return Qt.vis})}function vt(St){return St.filter(function(Qt){return!Qt.gap})}function Lt(St){return St.id}function Tt(St){if(St.ids)return Lt}function kt(){return!1}function Nt(St,Qt,rr){var Jt,sr,De,Je=rr[0].trace,de=p.hasMarkers(Je),Me=p.hasText(Je),Ce=Tt(Je),Ue=kt,He=kt;if(de||Me){var et=u,at=Je.stackgroup,xt=at&&S._fullLayout._scatterStackOpts[U._id+P._id][at].stackgaps==="infer zero";Je.marker.maxdisplayed||Je._needsCull?et=xt?ot:je:at&&!xt&&(et=vt),de&&(Ue=et),Me&&(He=et)}sr=St.selectAll("path.point"),Jt=sr.data(Ue,Ce);var mt=Jt.enter().append("path").classed("point",!0);te&&mt.call(h.pointStyle,Je,S).call(h.translatePoints,U,P).style("opacity",0).transition().style("opacity",1),Jt.order();var yt;de&&(yt=h.makePointStyleFns(Je)),Jt.each(function(It){var zt=d.select(this),Ut=H(zt);De=h.translatePoint(It,Ut,U,P),De?(h.singlePointStyle(It,Ut,Je,yt,S),T.layerClipId&&h.hideOutsideRangePoint(It,Ut,U,P,Je.xcalendar,Je.ycalendar),Je.customdata&&zt.classed("plotly-customdata",It.data!==null&&It.data!==void 0)):Ut.remove()}),te?Jt.exit().transition().style("opacity",0).remove():Jt.exit().remove(),sr=Qt.selectAll("g"),Jt=sr.data(He,Ce),Jt.enter().append("g").classed("textpoint",!0).append("text"),Jt.order(),Jt.each(function(It){var zt=d.select(this),Ut=H(zt.select("text"));De=h.translatePoint(It,Ut,U,P),De?T.layerClipId&&h.hideOutsideRangePoint(It,zt,U,P,Je.xcalendar,Je.ycalendar):zt.remove()}),Jt.selectAll("text").call(h.textPointStyle,Je,S).each(function(It){var zt=U.c2p(It.x),Ut=P.c2p(It.y);d.select(this).selectAll("tspan.line").each(function(){H(d.select(this)).attr({x:zt,y:Ut})})}),Jt.exit().remove()}ne.datum(C),ae.datum(C),Nt(ne,ae,C);var Pt=re.cliponaxis===!1,Wt=Pt?null:T.layerClipId;h.setClipUrl(ne,Wt,S),h.setClipUrl(ae,Wt,S)}function L(S,M,T,C,m){var y=T.xaxis,A=T.yaxis,R=d.extent(s.simpleMap(y.range,y.r2c)),N=d.extent(s.simpleMap(A.range,A.r2c)),te=C[0].trace;if(p.hasMarkers(te)){var H=te.marker.maxdisplayed;if(H!==0){var U=C.filter(function(Z){return Z.x>=R[0]&&Z.x<=R[1]&&Z.y>=N[0]&&Z.y<=N[1]}),P=Math.ceil(U.length/H),re=0;m.forEach(function(Z,Y){var X=Z[0].trace;p.hasMarkers(X)&&X.marker.maxdisplayed>0&&Y<M&&re++});var G=Math.round(re*P/3+Math.floor(re/3)*P/7.1);C.forEach(function(Z){delete Z.vis}),U.forEach(function(Z,Y){Math.round((Y+G)%P)===0&&(Z.vis=!0)})}}}}),t1=t((W,V)=>{V.exports={container:"marker",min:"cmin",max:"cmax"}}),Hx=t((W,V)=>{var d=Ja();V.exports=function(i,s,f){var u={},h={_fullLayout:f},p=d.getFromTrace(h,s,"x"),v=d.getFromTrace(h,s,"y"),o=i.orig_x;o===void 0&&(o=i.x);var w=i.orig_y;return w===void 0&&(w=i.y),u.xLabel=d.tickText(p,p.c2l(o),!0).text,u.yLabel=d.tickText(v,v.c2l(w),!0).text,u}}),r1=t((W,V)=>{var d=l(),i=Ra(),s=an();function f(v){var o=d.select(v).selectAll("g.trace.scatter");o.style("opacity",function(w){return w[0].trace.opacity}),o.selectAll("g.points").each(function(w){var g=d.select(this),b=w.trace||w[0].trace;u(g,b,v)}),o.selectAll("g.text").each(function(w){var g=d.select(this),b=w.trace||w[0].trace;h(g,b,v)}),o.selectAll("g.trace path.js-line").call(i.lineGroupStyle),o.selectAll("g.trace path.js-fill").call(i.fillGroupStyle,v,!1),s.getComponentMethod("errorbars","style")(o)}function u(v,o,w){i.pointStyle(v.selectAll("path.point"),o,w)}function h(v,o,w){i.textPointStyle(v.selectAll("text"),o,w)}function p(v,o,w){var g=o[0].trace;g.selectedpoints?(i.selectedPointStyle(w.selectAll("path.point"),g),i.selectedTextStyle(w.selectAll("text"),g)):(u(w,g,v),h(w,g,v))}V.exports={style:f,stylePoints:u,styleText:h,styleOnSelect:p}}),Vx=t((W,V)=>{var d=Xt(),i=Ki();V.exports=function(s,f){var u,h;if(s.mode==="lines")return u=s.line.color,u&&d.opacity(u)?u:s.fillcolor;if(s.mode==="none")return s.fill?s.fillcolor:"";var p=f.mcc||(s.marker||{}).color,v=f.mlcc||((s.marker||{}).line||{}).color;return h=p&&d.opacity(p)?p:v&&d.opacity(v)&&(f.mlw||((s.marker||{}).line||{}).width)?v:"",h?d.opacity(h)<.3?d.addOpacity(h,.3):h:(u=(s.line||{}).color,u&&d.opacity(u)&&i.hasLines(s)&&s.line.width?u:s.fillcolor)}}),Gx=t((W,V)=>{var d=Mt(),i=ws(),s=an(),f=Vx(),u=Xt(),h=d.fillText;V.exports=function(p,v,o,w){var g=p.cd,b=g[0].trace,L=p.xa,S=p.ya,M=L.c2p(v),T=S.c2p(o),C=[M,T],m=b.hoveron||"",y=b.mode.indexOf("markers")!==-1?3:.5,A=!!b.xperiodalignment,R=!!b.yperiodalignment;if(m.indexOf("points")!==-1){var N=function(xe){if(A){var Re=L.c2p(xe.xStart),ke=L.c2p(xe.xEnd);return M>=Math.min(Re,ke)&&M<=Math.max(Re,ke)?0:1/0}var Ie=Math.max(3,xe.mrc||0),Q=1-1/Ie,ee=Math.abs(L.c2p(xe.x)-M);return ee<Ie?Q*ee/Ie:ee-Ie+Q},te=function(xe){if(R){var Re=S.c2p(xe.yStart),ke=S.c2p(xe.yEnd);return T>=Math.min(Re,ke)&&T<=Math.max(Re,ke)?0:1/0}var Ie=Math.max(3,xe.mrc||0),Q=1-1/Ie,ee=Math.abs(S.c2p(xe.y)-T);return ee<Ie?Q*ee/Ie:ee-Ie+Q},H=function(xe){var Re=Math.max(y,xe.mrc||0),ke=L.c2p(xe.x)-M,Ie=S.c2p(xe.y)-T;return Math.max(Math.sqrt(ke*ke+Ie*Ie)-Re,1-y/Re)},U=i.getDistanceFunction(w,N,te,H);if(i.getClosest(g,U,p),p.index!==!1){var P=g[p.index],re=L.c2p(P.x,!0),G=S.c2p(P.y,!0),Z=P.mrc||1;p.index=P.i;var Y=g[0].t.orientation,X=Y&&(P.sNorm||P.s),ne=Y==="h"?X:P.orig_x!==void 0?P.orig_x:P.x,ae=Y==="v"?X:P.orig_y!==void 0?P.orig_y:P.y;return d.extendFlat(p,{color:f(b,P),x0:re-Z,x1:re+Z,xLabelVal:ne,y0:G-Z,y1:G+Z,yLabelVal:ae,spikeDistance:H(P),hovertemplate:b.hovertemplate}),h(P,b,p),s.getComponentMethod("errorbars","hoverInfo")(P,b,p),[p]}}function B(xe){if(!xe)return!1;var Re=xe.node();try{var ke=new DOMPoint(C[0],C[1]);return Re.isPointInFill(ke)}catch{var Ie=Re.ownerSVGElement.createSVGPoint();return Ie.x=C[0],Ie.y=C[1],Re.isPointInFill(Ie)}}function ie(xe){var Re,ke=[],Ie=1/0,Q=-1/0,ee=1/0,D=-1/0,le;for(Re=0;Re<xe.length;Re++){var ge=xe[Re];ge.contains(C)&&(ke.push(ge),ee=Math.min(ee,ge.ymin),D=Math.max(D,ge.ymax))}if(ke.length===0)return null;ee=Math.max(ee,0),D=Math.min(D,S._length),le=(ee+D)/2;var j,k,F,J,K,ve,Te;for(Re=0;Re<ke.length;Re++)for(k=ke[Re].pts,j=1;j<k.length;j++)ve=k[j-1][1],Te=k[j][1],ve>le!=Te>=le&&(J=k[j-1][0],K=k[j][0],Te-ve&&(F=J+(K-J)*(le-ve)/(Te-ve),Ie=Math.min(Ie,F),Q=Math.max(Q,F)));return Ie=Math.max(Ie,0),Q=Math.min(Q,L._length),{x0:Ie,x1:Q,y0:le,y1:le}}if(m.indexOf("fills")!==-1&&b._fillElement){var se=B(b._fillElement)&&!B(b._fillExclusionElement);if(se){var ye=ie(b._polygons);ye===null&&(ye={x0:C[0],x1:C[0],y0:C[1],y1:C[1]});var me=u.defaultLine;return u.opacity(b.fillcolor)?me=b.fillcolor:u.opacity((b.line||{}).color)&&(me=b.line.color),d.extendFlat(p,{distance:p.maxHoverDistance,x0:ye.x0,x1:ye.x1,y0:ye.y0,y1:ye.y1,color:me,hovertemplate:!1}),delete p.index,b.text&&!d.isArrayOrTypedArray(b.text)?p.text=String(b.text):p.text=b.name,[p]}}}}),jx=t((W,V)=>{var d=Ki();V.exports=function(i,s){var f=i.cd,u=i.xaxis,h=i.yaxis,p=[],v=f[0].trace,o,w,g,b,L=!d.hasMarkers(v)&&!d.hasText(v);if(L)return[];if(s===!1)for(o=0;o<f.length;o++)f[o].selected=0;else for(o=0;o<f.length;o++)w=f[o],g=u.c2p(w.x),b=h.c2p(w.y),w.i!==null&&s.contains([g,b],!1,o,i)?(p.push({pointNumber:w.i,x:u.c2d(w.x),y:h.c2d(w.y)}),w.selected=1):w.selected=0;return p}}),Wx=t((W,V)=>{V.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}}),Yx=t((W,V)=>{var d=an().traceIs,i=as();V.exports=function(p,v,o,w){o("autotypenumbers",w.autotypenumbersDflt);var g=o("type",(w.splomStash||{}).type);g==="-"&&(s(v,w.data),v.type==="-"?v.type="linear":p.type=v.type)};function s(p,v){if(p.type==="-"){var o=p._id,w=o.charAt(0),g;o.indexOf("scene")!==-1&&(o=w);var b=f(v,o,w);if(b){if(b.type==="histogram"&&w==={v:"y",h:"x"}[b.orientation||"v"]){p.type="linear";return}var L=w+"calendar",S=b[L],M={noMultiCategory:!d(b,"cartesian")||d(b,"noMultiCategory")};if(b.type==="box"&&b._hasPreCompStats&&w==={h:"x",v:"y"}[b.orientation||"v"]&&(M.noMultiCategory=!0),M.autotypenumbers=p.autotypenumbers,h(b,w)){var T=u(b),C=[];for(g=0;g<v.length;g++){var m=v[g];!d(m,"box-violin")||(m[w+"axis"]||w)!==o||(m[T]!==void 0?C.push(m[T][0]):m.name!==void 0?C.push(m.name):C.push("text"),m[L]!==S&&(S=void 0))}p.type=i(C,S,M)}else if(b.type==="splom"){var y=b.dimensions,A=y[b._axesDim[o]];A.visible&&(p.type=i(A.values,S,M))}else p.type=i(b[w]||[b[w+"0"]],S,M)}}}function f(p,v,o){for(var w=0;w<p.length;w++){var g=p[w];if(g.type==="splom"&&g._length>0&&(g["_"+o+"axes"]||{})[v]||(g[o+"axis"]||o)===v&&(h(g,o)||(g[o]||[]).length||g[o+"0"]))return g}}function u(p){return{v:"x",h:"y"}[p.orientation||"v"]}function h(p,v){var o=u(p),w=d(p,"box-violin"),g=d(p._fullInput||{},"candlestick");return w&&!g&&v===o&&p[o]===void 0&&p[o+"0"]===void 0}}),qx=t((W,V)=>{var d=be().isTypedArraySpec;function i(s,f){var u=f.dataAttr||s._id.charAt(0),h={},p,v,o;if(f.axData)p=f.axData;else for(p=[],v=0;v<f.data.length;v++){var w=f.data[v];w[u+"axis"]===s._id&&p.push(w)}for(v=0;v<p.length;v++){var g=p[v][u];for(o=0;o<g.length;o++){var b=g[o];b!=null&&(h[b]=1)}}return Object.keys(h)}V.exports=function(s,f,u,h){if(f.type==="category"){var p=s.categoryarray,v=Array.isArray(p)&&p.length>0||d(p),o;v&&(o="array");var w=u("categoryorder",o),g;w==="array"&&(g=u("categoryarray")),!v&&w==="array"&&(w=f.categoryorder="trace"),w==="trace"?f._initialCategories=[]:w==="array"?f._initialCategories=g.slice():(g=i(f,h).sort(),w==="category ascending"?f._initialCategories=g:w==="category descending"&&(f._initialCategories=g.reverse()))}}}),Jx=t((W,V)=>{var d=ft().mix,i=Zt(),s=Mt();V.exports=function(f,u,h,p){p=p||{};var v=p.dfltColor;function o(P,re){return s.coerce2(f,u,p.attributes,P,re)}var w=o("linecolor",v),g=o("linewidth"),b=h("showline",p.showLine||!!w||!!g);b||(delete u.linecolor,delete u.linewidth);var L=d(v,p.bgColor,p.blend||i.lightFraction).toRgbString(),S=o("gridcolor",L),M=o("gridwidth"),T=o("griddash"),C=h("showgrid",p.showGrid||!!S||!!M||!!T);if(C||(delete u.gridcolor,delete u.gridwidth,delete u.griddash),p.hasMinor){var m=d(u.gridcolor,p.bgColor,67).toRgbString(),y=o("minor.gridcolor",m),A=o("minor.gridwidth",u.gridwidth||1),R=o("minor.griddash",u.griddash||"solid"),N=h("minor.showgrid",!!y||!!A||!!R);N||(delete u.minor.gridcolor,delete u.minor.gridwidth,delete u.minor.griddash)}if(!p.noZeroLine){o("zerolinelayer");var te=o("zerolinecolor",v),H=o("zerolinewidth"),U=h("zeroline",p.showGrid||!!te||!!H);U||(delete u.zerolinelayer,delete u.zerolinecolor,delete u.zerolinewidth)}}}),n1=t((W,V)=>{var d=q(),i=an(),s=Mt(),f=fn(),u=No(),h=to(),p=ml(),v=gl(),o=Zc(),w=$u(),g=qx(),b=Jx(),L=nd(),S=$l(),M=kn().WEEKDAY_PATTERN,T=kn().HOUR_PATTERN;V.exports=function(A,R,N,te,H){var U=te.letter,P=te.font||{},re=te.splomStash||{},G=N("visible",!te.visibleDflt),Z=R._template||{},Y=R.type||Z.type||"-",X;if(Y==="date"){var ne=i.getComponentMethod("calendars","handleDefaults");ne(A,R,"calendar",te.calendar),te.noTicklabelmode||(X=N("ticklabelmode"))}!te.noTicklabelindex&&(Y==="date"||Y==="linear")&&N("ticklabelindex");var ae="";(!te.noTicklabelposition||Y==="multicategory")&&(ae=s.coerce(A,R,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:X==="period"?["outside","inside"]:U==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),te.noTicklabeloverflow||N("ticklabeloverflow",ae.indexOf("inside")!==-1?"hide past domain":Y==="category"||Y==="multicategory"?"allow":"hide past div"),S(R,H),L(A,R,N,te),g(A,R,N,te),te.noHover||(Y!=="category"&&N("hoverformat"),te.noUnifiedhovertitle||N("unifiedhovertitle.text"));var B=N("color"),ie=B!==h.color.dflt?B:P.color,se=re.label||H._dfltTitle[U];if(w(A,R,N,Y,te),!G)return R;N("title.text",se),s.coerceFont(N,"title.font",P,{overrideDflt:{size:s.bigFont(P.size),color:ie}}),p(A,R,N,Y);var ye=te.hasMinor;if(ye&&(f.newContainer(R,"minor"),p(A,R,N,Y,{isMinor:!0})),o(A,R,N,Y,te),v(A,R,N,te),ye){var me=te.isMinor;te.isMinor=!0,v(A,R,N,te),te.isMinor=me}b(A,R,N,{dfltColor:B,bgColor:te.bgColor,showGrid:te.showGrid,hasMinor:ye,attributes:h}),ye&&!R.minor.ticks&&!R.minor.showgrid&&delete R.minor,(R.showline||R.ticks)&&N("mirror");var xe=Y==="multicategory";if(!te.noTickson&&(Y==="category"||xe)&&(R.ticks||R.showgrid)&&(xe?(N("tickson","boundaries"),delete R.ticklabelposition):N("tickson")),xe){var Re=N("showdividers");Re&&(N("dividercolor"),N("dividerwidth"))}if(Y==="date")if(u(A,R,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:C}),!R.rangebreaks.length)delete R.rangebreaks;else{for(var ke=0;ke<R.rangebreaks.length;ke++)if(R.rangebreaks[ke].pattern===M){R._hasDayOfWeekBreaks=!0;break}if(S(R,H),H._has("scattergl")||H._has("splom"))for(var Ie=0;Ie<te.data.length;Ie++){var Q=te.data[Ie];(Q.type==="scattergl"||Q.type==="splom")&&(Q.visible=!1,s.warn(Q.type+" traces do not work on axes with rangebreaks. Setting trace "+Q.index+" to `visible: false`."))}}return R};function C(A,R,N){function te(ne,ae){return s.coerce(A,R,h.rangebreaks,ne,ae)}var H=te("enabled");if(H){var U=te("bounds");if(U&&U.length>=2){var P="",re,G;if(U.length===2){for(re=0;re<2;re++)if(G=y(U[re]),G){P=M;break}}var Z=te("pattern",P);if(Z===M)for(re=0;re<2;re++)G=y(U[re]),G&&(R.bounds[re]=U[re]=G-1);if(Z)for(re=0;re<2;re++)switch(G=U[re],Z){case M:if(!d(G)){R.enabled=!1;return}if(G=+G,G!==Math.floor(G)||G<0||G>=7){R.enabled=!1;return}R.bounds[re]=U[re]=G;break;case T:if(!d(G)){R.enabled=!1;return}if(G=+G,G<0||G>24){R.enabled=!1;return}R.bounds[re]=U[re]=G;break}if(N.autorange===!1){var Y=N.range;if(Y[0]<Y[1]){if(U[0]<Y[0]&&U[1]>Y[1]){R.enabled=!1;return}}else if(U[0]>Y[0]&&U[1]<Y[1]){R.enabled=!1;return}}}else{var X=te("values");if(X&&X.length)te("dvalue");else{R.enabled=!1;return}}}}var m={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function y(A){if(typeof A=="string")return m[A.substr(0,3).toLowerCase()]}}),a1=t((W,V)=>{var d=q(),i=Mt();V.exports=function(s,f,u,h){var p=h.counterAxes||[],v=h.overlayableAxes||[],o=h.letter,w=h.grid,g=h.overlayingDomain,b,L,S,M,T,C;w&&(L=w._domains[o][w._axisMap[f._id]],b=w._anchors[f._id],L&&(S=w[o+"side"].split(" ")[0],M=w.domain[o][S==="right"||S==="top"?1:0])),L=L||[0,1],b=b||(d(s.position)?"free":p[0]||"free"),S=S||(o==="x"?"bottom":"left"),M=M||0,T=0,C=!1;var m=i.coerce(s,f,{anchor:{valType:"enumerated",values:["free"].concat(p),dflt:b}},"anchor"),y=i.coerce(s,f,{side:{valType:"enumerated",values:o==="x"?["bottom","top"]:["left","right"],dflt:S}},"side");if(m==="free"){if(o==="y"){var A=u("autoshift");A&&(M=y==="left"?g[0]:g[1],C=f.automargin?f.automargin:!0,T=y==="left"?-3:3),u("shift",T)}u("position",M)}u("automargin",C);var R=!1;if(v.length&&(R=i.coerce(s,f,{overlaying:{valType:"enumerated",values:[!1].concat(v),dflt:!1}},"overlaying")),!R){var N=u("domain",L);N[0]>N[1]-1/4096&&(f.domain=L),i.noneOrAll(s.domain,f.domain,L),f.tickmode==="sync"&&(f.tickmode="auto")}return u("layer"),f}}),Xx=t((W,V)=>{var d=Mt(),i=Xt(),s=So().isUnifiedHover,f=km(),u=fn(),h=Sa(),p=to(),v=Yx(),o=n1(),w=ld(),g=a1(),b=aa(),L=b.id2name,S=b.name2id,M=kn().AX_ID_PATTERN,T=an(),C=T.traceIs,m=T.getComponentMethod;function y(A,R,N){Array.isArray(A[R])?A[R].push(N):A[R]=[N]}V.exports=function(A,R,N){var te=R.autotypenumbers,H={},U={},P={},re={},G={},Z={},Y={},X={},ne={},ae={},B,ie;for(B=0;B<N.length;B++){var se=N[B];if(C(se,"cartesian")){var ye;if(se.xaxis)ye=L(se.xaxis),y(H,ye,se);else if(se.xaxes)for(ie=0;ie<se.xaxes.length;ie++)y(H,L(se.xaxes[ie]),se);var me;if(se.yaxis)me=L(se.yaxis),y(H,me,se);else if(se.yaxes)for(ie=0;ie<se.yaxes.length;ie++)y(H,L(se.yaxes[ie]),se);if(se.type==="funnel"?se.orientation==="h"?(ye&&(U[ye]=!0),me&&(Y[me]=!0)):me&&(P[me]=!0):se.type==="image"?(me&&(X[me]=!0),ye&&(X[ye]=!0)):(me&&(G[me]=!0,Z[me]=!0),(!C(se,"carpet")||se.type==="carpet"&&!se._cheater)&&ye&&(re[ye]=!0)),se.type==="carpet"&&se._cheater&&ye&&(U[ye]=!0),C(se,"2dMap")&&(ne[ye]=!0,ne[me]=!0),C(se,"oriented")){var xe=se.orientation==="h"?me:ye;ae[xe]=!0}}}var Re=R._subplots,ke=Re.xaxis,Ie=Re.yaxis,Q=d.simpleMap(ke,L),ee=d.simpleMap(Ie,L),D=Q.concat(ee),le=i.background;ke.length&&Ie.length&&(le=d.coerce(A,R,h,"plot_bgcolor"));var ge=i.combine(le,R.paper_bgcolor),j,k,F,J,K;function ve(){var Ce=H[j]||[];K._traceIndices=Ce.map(function(Ue){return Ue.index}),K._annIndices=[],K._shapeIndices=[],K._selectionIndices=[],K._imgIndices=[],K._subplotsWith=[],K._counterAxes=[],K._name=K._attr=j,K._id=k}function Te(Ce,Ue){return d.coerce(J,K,p,Ce,Ue)}function Ae(Ce,Ue){return d.coerce2(J,K,p,Ce,Ue)}function Fe(Ce){return Ce==="x"?Ie:ke}function Ge(Ce,Ue){for(var He=Ce==="x"?Q:ee,et=[],at=0;at<He.length;at++){var xt=He[at];xt!==Ue&&!(A[xt]||{}).overlaying&&et.push(S(xt))}return et}var rt={x:Fe("x"),y:Fe("y")},bt=rt.x.concat(rt.y),ht={},ct=[];function Oe(){var Ce=J.matches;M.test(Ce)&&bt.indexOf(Ce)===-1&&(ht[Ce]=J.type,ct=Object.keys(ht))}var ze=f(A,R),we=s(ze);for(B=0;B<D.length;B++){j=D[B],k=S(j),F=j.charAt(0),d.isPlainObject(A[j])||(A[j]={}),J=A[j],K=u.newContainer(R,j,F+"axis"),ve();var je=F==="x"&&!re[j]&&U[j]||F==="y"&&!G[j]&&P[j],ot=F==="y"&&(!Z[j]&&Y[j]||X[j]),vt={hasMinor:!0,letter:F,font:R.font,outerTicks:ne[j],showGrid:!ae[j],data:H[j]||[],bgColor:ge,calendar:R.calendar,automargin:!0,visibleDflt:je,reverseDflt:ot,autotypenumbersDflt:te,splomStash:((R._splomAxes||{})[F]||{})[k],noAutotickangles:F==="y"};Te("uirevision",R.uirevision),v(J,K,Te,vt),o(J,K,Te,vt,R);var Lt=we&&F===ze.charAt(0),Tt=Ae("spikecolor",we?K.color:void 0),kt=Ae("spikethickness",we?1.5:void 0),Nt=Ae("spikedash",we?"dot":void 0),Pt=Ae("spikemode",we?"across":void 0),Wt=Ae("spikesnap"),St=Te("showspikes",!!Lt||!!Tt||!!kt||!!Nt||!!Pt||!!Wt);St||(delete K.spikecolor,delete K.spikethickness,delete K.spikedash,delete K.spikemode,delete K.spikesnap);var Qt=L(J.overlaying),rr=[0,1];if(R[Qt]!==void 0){var Jt=L(R[Qt].anchor);R[Jt]!==void 0&&(rr=R[Jt].domain)}g(J,K,Te,{letter:F,counterAxes:rt[F],overlayableAxes:Ge(F,j),grid:R.grid,overlayingDomain:rr}),Te("title.standoff"),Oe(),K._input=J}for(B=0;B<ct.length;){k=ct[B++],j=L(k),F=j.charAt(0),d.isPlainObject(A[j])||(A[j]={}),J=A[j],K=u.newContainer(R,j,F+"axis"),ve();var sr={letter:F,font:R.font,outerTicks:ne[j],showGrid:!ae[j],data:[],bgColor:ge,calendar:R.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:te,splomStash:((R._splomAxes||{})[F]||{})[k]};Te("uirevision",R.uirevision),K.type=ht[k]||"linear",o(J,K,Te,sr,R),g(J,K,Te,{letter:F,counterAxes:rt[F],overlayableAxes:Ge(F,j),grid:R.grid}),Te("fixedrange"),Te("modebardisable"),Oe(),K._input=J}var De=m("rangeslider","handleDefaults"),Je=m("rangeselector","handleDefaults");for(B=0;B<Q.length;B++)j=Q[B],J=A[j],K=R[j],De(A,R,j),K.type==="date"&&Je(J,K,R,ee,K.calendar),Te("fixedrange"),Te("modebardisable");for(B=0;B<ee.length;B++){j=ee[B],J=A[j],K=R[j];var de=R[L(K.anchor)],Me=m("rangeslider","isVisible")(de);Te("fixedrange",Me),Te("modebardisable")}w.handleDefaults(A,R,{axIds:bt.concat(ct).sort(b.idSort),axHasImage:X})}}),Zx=t((W,V)=>{var d=l(),i=an(),s=Mt(),f=Ra(),u=Ja();V.exports=function(h,p,v,o){var w=h._fullLayout;if(p.length===0){u.redrawComponents(h);return}function g(R){var N=R.xaxis,te=R.yaxis;w._defs.select("#"+R.clipId+"> rect").call(f.setTranslate,0,0).call(f.setScale,1,1),R.plot.call(f.setTranslate,N._offset,te._offset).call(f.setScale,1,1);var H=R.plot.selectAll(".scatterlayer .trace");H.selectAll(".point").call(f.setPointGroupScale,1,1),H.selectAll(".textpoint").call(f.setTextPointsScale,1,1),H.call(f.hideOutsideRangePoints,R)}function b(R,N){var te=R.plotinfo,H=te.xaxis,U=te.yaxis,P=H._length,re=U._length,G=!!R.xr1,Z=!!R.yr1,Y=[];if(G){var X=s.simpleMap(R.xr0,H.r2l),ne=s.simpleMap(R.xr1,H.r2l),ae=X[1]-X[0],B=ne[1]-ne[0];Y[0]=(X[0]*(1-N)+N*ne[0]-X[0])/(X[1]-X[0])*P,Y[2]=P*(1-N+N*B/ae),H.range[0]=H.l2r(X[0]*(1-N)+N*ne[0]),H.range[1]=H.l2r(X[1]*(1-N)+N*ne[1])}else Y[0]=0,Y[2]=P;if(Z){var ie=s.simpleMap(R.yr0,U.r2l),se=s.simpleMap(R.yr1,U.r2l),ye=ie[1]-ie[0],me=se[1]-se[0];Y[1]=(ie[1]*(1-N)+N*se[1]-ie[1])/(ie[0]-ie[1])*re,Y[3]=re*(1-N+N*me/ye),U.range[0]=H.l2r(ie[0]*(1-N)+N*se[0]),U.range[1]=U.l2r(ie[1]*(1-N)+N*se[1])}else Y[1]=0,Y[3]=re;u.drawOne(h,H,{skipTitle:!0}),u.drawOne(h,U,{skipTitle:!0}),u.redrawComponents(h,[H._id,U._id]);var xe=G?P/Y[2]:1,Re=Z?re/Y[3]:1,ke=G?Y[0]:0,Ie=Z?Y[1]:0,Q=G?Y[0]/Y[2]*P:0,ee=Z?Y[1]/Y[3]*re:0,D=H._offset-Q,le=U._offset-ee;te.clipRect.call(f.setTranslate,ke,Ie).call(f.setScale,1/xe,1/Re),te.plot.call(f.setTranslate,D,le).call(f.setScale,xe,Re),f.setPointGroupScale(te.zoomScalePts,1/xe,1/Re),f.setTextPointsScale(te.zoomScaleTxt,1/xe,1/Re)}var L;o&&(L=o());function S(){for(var R={},N=0;N<p.length;N++){var te=p[N],H=te.plotinfo.xaxis,U=te.plotinfo.yaxis;te.xr1&&(R[H._name+".range"]=te.xr1.slice()),te.yr1&&(R[U._name+".range"]=te.yr1.slice())}return L&&L(),i.call("relayout",h,R).then(function(){for(var P=0;P<p.length;P++)g(p[P].plotinfo)})}function M(){for(var R={},N=0;N<p.length;N++){var te=p[N],H=te.plotinfo.xaxis,U=te.plotinfo.yaxis;te.xr0&&(R[H._name+".range"]=te.xr0.slice()),te.yr0&&(R[U._name+".range"]=te.yr0.slice())}return i.call("relayout",h,R).then(function(){for(var P=0;P<p.length;P++)g(p[P].plotinfo)})}var T,C,m,y=d.ease(v.easing);h._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(m),m=null,M()});function A(){C=Date.now();for(var R=Math.min(1,(C-T)/v.duration),N=y(R),te=0;te<p.length;te++)b(p[te],N);C-T>v.duration?(S(),m=window.cancelAnimationFrame(A)):m=window.requestAnimationFrame(A)}return T=Date.now(),m=window.requestAnimationFrame(A),Promise.resolve()}}),mf=t(W=>{var V=l(),d=an(),i=Mt(),s=pn(),f=Ra(),u=yi().getModuleCalcData,h=aa(),p=kn(),v=xi(),o=i.ensureSingle;function w(C,m,y){return i.ensureSingle(C,m,y,function(A){A.datum(y)})}var g=p.zindexSeparator;W.name="cartesian",W.attr=["xaxis","yaxis"],W.idRoot=["x","y"],W.idRegex=p.idRegex,W.attrRegex=p.attrRegex,W.attributes=Wx(),W.layoutAttributes=to(),W.supplyLayoutDefaults=Xx(),W.transitionAxes=Zx(),W.finalizeSubplots=function(C,m){var y=m._subplots,A=y.xaxis,R=y.yaxis,N=y.cartesian,te=N,H={},U={},P,re,G;for(P=0;P<te.length;P++){var Z=te[P].split("y");H[Z[0]]=1,U["y"+Z[1]]=1}for(P=0;P<A.length;P++)re=A[P],H[re]||(G=(C[h.id2name(re)]||{}).anchor,p.idRegex.y.test(G)||(G="y"),N.push(re+G),te.push(re+G),U[G]||(U[G]=1,i.pushUnique(R,G)));for(P=0;P<R.length;P++)G=R[P],U[G]||(re=(C[h.id2name(G)]||{}).anchor,p.idRegex.x.test(re)||(re="x"),N.push(re+G),te.push(re+G),H[re]||(H[re]=1,i.pushUnique(A,re)));if(!te.length){re="",G="";for(var Y in C)if(p.attrRegex.test(Y)){var X=Y.charAt(0);X==="x"?(!re||+Y.substr(5)<+re.substr(5))&&(re=Y):(!G||+Y.substr(5)<+G.substr(5))&&(G=Y)}re=re?h.name2id(re):"x",G=G?h.name2id(G):"y",A.push(re),R.push(G),N.push(re+G)}},W.plot=function(C,m,y,A){var R=C._fullLayout,N=R._subplots.cartesian,te=C.calcdata,H;if(!Array.isArray(m))for(m=[],H=0;H<te.length;H++)m.push(H);for(var U=R._zindices,P=0;P<U.length;P++){var re=U[P];for(H=0;H<N.length;H++){var G=N[H],Z=R._plots[G];if(P>0){var Y=Z.id;if(Y.indexOf(g)!==-1)continue;Y+=g+(P+1),Z=i.extendFlat({},Z,{id:Y,plot:R._cartesianlayer.selectAll(".subplot").select("."+Y)})}for(var X=[],ne,ae=0;ae<te.length;ae++){var B=te[ae],ie=B[0].trace;re===(ie.zorder||0)&&ie.xaxis+ie.yaxis===G&&((m.indexOf(ie.index)!==-1||ie.carpet)&&(ne&&ne[0].trace.xaxis+ne[0].trace.yaxis===G&&["tonextx","tonexty","tonext"].indexOf(ie.fill)!==-1&&X.indexOf(ne)===-1&&X.push(ne),X.push(B)),ne=B)}b(C,Z,X,y,A)}}};function b(C,m,y,A,R){for(var N=p.traceLayerClasses,te=C._fullLayout,H=te._zindices,U=te._modules,P,re,G,Z=[],Y=[],X=0;X<H.length;X++)for(var ne=H[X],ae=0;ae<U.length;ae++){P=U[ae];var B=P.name,ie=d.modules[B].categories;if(ie.svg){var se=P.layerName||B+"layer",ye=se+(X?Number(X)+1:""),me=P.plot;re=u(y,me,ne),G=re[0],y=re[1],G.length&&Z.push({i:N.indexOf(se),zindex:X,className:ye,plotMethod:me,cdModule:G}),ie.zoomScale&&Y.push("."+ye)}}Z.sort(function(ke,Ie){return(ke.zindex||0)-(Ie.zindex||0)||ke.i-Ie.i});var xe=m.plot.selectAll("g.mlayer").data(Z,function(ke){return ke.className});if(xe.enter().append("g").attr("class",function(ke){return ke.className}).classed("mlayer",!0).classed("rangeplot",m.isRangePlot),xe.exit().remove(),xe.order(),xe.each(function(ke){var Ie=V.select(this),Q=ke.className;ke.plotMethod(C,m,ke.cdModule,Ie,A,R),p.clipOnAxisFalseQuery.indexOf("."+Q)===-1&&f.setClipUrl(Ie,m.layerClipId,C)}),te._has("scattergl")&&(P=d.getModule("scattergl"),G=u(y,P)[0],P.plot(C,m,G)),!C._context.staticPlot&&(m._hasClipOnAxisFalse&&(m.clipOnAxisFalseTraces=m.plot.selectAll(p.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),Y.length)){var Re=m.plot.selectAll(Y.join(",")).selectAll(".trace");m.zoomScalePts=Re.selectAll("path.point"),m.zoomScaleTxt=Re.selectAll(".textpoint")}}W.clean=function(C,m,y,A){var R=A._plots||{},N=m._plots||{},te=A._subplots||{},H,U,P;if(A._hasOnlyLargeSploms&&!m._hasOnlyLargeSploms)for(P in R)H=R[P],H.plotgroup&&H.plotgroup.remove();var re=A._has&&A._has("gl"),G=m._has&&m._has("gl");if(re&&!G)for(P in R)H=R[P],H._scene&&H._scene.destroy();if(te.xaxis&&te.yaxis){var Z=h.listIds({_fullLayout:A});for(U=0;U<Z.length;U++){var Y=Z[U];m[h.id2name(Y)]||A._infolayer.selectAll(".g-"+Y+"title").remove()}}var X=A._has&&A._has("cartesian"),ne=m._has&&m._has("cartesian");if(X&&!ne)M(A._cartesianlayer.selectAll(".subplot"),A),A._defs.selectAll(".axesclip").remove(),delete A._axisConstraintGroups,delete A._axisMatchGroups;else if(te.cartesian)for(U=0;U<te.cartesian.length;U++){var ae=te.cartesian[U];if(ae.indexOf(g)===-1&&!N[ae]){var B="."+ae+",."+ae+"-x,."+ae+"-y";A._cartesianlayer.selectAll(B).remove(),T(ae,A)}}},W.drawFramework=function(C){var m=C._fullLayout,y=C.calcdata,A,R={};for(A=0;A<y.length;A++){var N=y[A][0],te=N.trace,H=te.zorder||0;R[H]||(R[H]=[]),R[H].push(N)}var U=Object.keys(R).map(Number).sort(i.sorterAsc);U.length||(U=[0]),m._zindices=U;var P=L(C),re=P.length,G=[];for(A=0;A<re;A++)G[A]=P[A].slice();for(var Z=1;Z<U.length;Z++){var Y=[];for(A=0;A<re;A++)Y[A]=P[A].slice(),Y[A][0]+=g+(Z+1);G=G.concat(Y)}var X=m._cartesianlayer.selectAll(".subplot").data(G,String);X.enter().append("g").attr("class",function(ne){return"subplot "+ne[0]}),X.order(),X.exit().call(M,m),X.each(function(ne){var ae=ne[0],B=ae.indexOf(g),ie=B!==-1,se=ie?ae.slice(0,B):ae,ye=m._plots[ae];ye||(ye=i.extendFlat({},m._plots[se]),ye&&(ye.id=ae,m._plots[ae]=ye,m._subplots.cartesian.push(ae))),ye&&(ye.plotgroup=V.select(this),S(C,ye),ie||(ye.draglayer=o(m._draggers,"g",ae)))})},W.rangePlot=function(C,m,y){S(C,m),b(C,m,y),s.style(C)};function L(C){var m=C._fullLayout,y=m._zindices.length,A=m._subplots.cartesian,R=A.length,N,te,H,U,P,re,G=[],Z=[];for(N=0;N<R;N++){H=A[N],U=m._plots[H],P=U.xaxis,re=U.yaxis;var Y=P._mainAxis,X=re._mainAxis,ne=Y._id+X._id,ae=m._plots[ne];U.overlays=[],ne!==H&&ae?(U.mainplot=ne,U.mainplotinfo=ae,Z.push(H)):(U.mainplot=void 0,U.mainplotinfo=void 0,G.push(H))}for(N=0;N<Z.length;N++)H=Z[N],U=m._plots[H],U.mainplotinfo.overlays.push(U);var B=G.concat(Z),ie=[];for(N=0;N<R;N++){H=B[N],U=m._plots[H],P=U.xaxis,re=U.yaxis;for(var se=[],ye=1;ye<=y;ye++){var me="";for(ye>1&&(me+=g+ye),se.push(H+me),te=0;te<U.overlays.length;te++)se.push(U.overlays[te].id+me)}se=se.concat([P.layer,re.layer,P.overlaying||"",re.overlaying||""]),ie.push(se)}return ie}function S(C,m){var y=C._fullLayout,A=m.plotgroup,R=m.id,N=R.indexOf(g),te=N!==-1,H=p.layerValue2layerClass[m.xaxis.layer],U=p.layerValue2layerClass[m.yaxis.layer],P=y._hasOnlyLargeSploms,re=y._zindices.length>1,G=m.mainplotinfo;if(!m.mainplot||re)if(P)m.xlines=o(A,"path","xlines-above"),m.ylines=o(A,"path","ylines-above"),m.xaxislayer=o(A,"g","xaxislayer-above"),m.yaxislayer=o(A,"g","yaxislayer-above");else{if(!te){var Z=o(A,"g","layer-subplot");m.shapelayer=o(Z,"g","shapelayer"),m.imagelayer=o(Z,"g","imagelayer"),G&&re?(m.minorGridlayer=G.minorGridlayer,m.gridlayer=G.gridlayer,m.zerolinelayer=G.zerolinelayer):(m.minorGridlayer=o(A,"g","minor-gridlayer"),m.gridlayer=o(A,"g","gridlayer"),m.zerolinelayer=o(A,"g","zerolinelayer"));var Y=o(A,"g","layer-between");m.shapelayerBetween=o(Y,"g","shapelayer"),m.imagelayerBetween=o(Y,"g","imagelayer"),o(A,"path","xlines-below"),o(A,"path","ylines-below"),m.overlinesBelow=o(A,"g","overlines-below"),o(A,"g","xaxislayer-below"),o(A,"g","yaxislayer-below"),m.overaxesBelow=o(A,"g","overaxes-below")}m.overplot=o(A,"g","overplot"),m.plot=o(m.overplot,"g",R),G&&re?m.zerolinelayerAbove=G.zerolinelayerAbove:m.zerolinelayerAbove=o(A,"g","zerolinelayer-above"),te||(m.xlines=o(A,"path","xlines-above"),m.ylines=o(A,"path","ylines-above"),m.overlinesAbove=o(A,"g","overlines-above"),o(A,"g","xaxislayer-above"),o(A,"g","yaxislayer-above"),m.overaxesAbove=o(A,"g","overaxes-above"),m.xlines=A.select(".xlines-"+H),m.ylines=A.select(".ylines-"+U),m.xaxislayer=A.select(".xaxislayer-"+H),m.yaxislayer=A.select(".yaxislayer-"+U))}else{var X=G.plotgroup,ne=R+"-x",ae=R+"-y";m.minorGridlayer=G.minorGridlayer,m.gridlayer=G.gridlayer,m.zerolinelayer=G.zerolinelayer,m.zerolinelayerAbove=G.zerolinelayerAbove,o(G.overlinesBelow,"path",ne),o(G.overlinesBelow,"path",ae),o(G.overaxesBelow,"g",ne),o(G.overaxesBelow,"g",ae),m.plot=o(G.overplot,"g",R),o(G.overlinesAbove,"path",ne),o(G.overlinesAbove,"path",ae),o(G.overaxesAbove,"g",ne),o(G.overaxesAbove,"g",ae),m.xlines=X.select(".overlines-"+H).select("."+ne),m.ylines=X.select(".overlines-"+U).select("."+ae),m.xaxislayer=X.select(".overaxes-"+H).select("."+ne),m.yaxislayer=X.select(".overaxes-"+U).select("."+ae)}te||(P||(w(m.minorGridlayer,"g",m.xaxis._id),w(m.minorGridlayer,"g",m.yaxis._id),m.minorGridlayer.selectAll("g").map(function(B){return B[0]}).sort(h.idSort),w(m.gridlayer,"g",m.xaxis._id),w(m.gridlayer,"g",m.yaxis._id),m.gridlayer.selectAll("g").map(function(B){return B[0]}).sort(h.idSort)),m.xlines.style("fill","none").classed("crisp",!0),m.ylines.style("fill","none").classed("crisp",!0))}function M(C,m){if(C){var y={};C.each(function(U){var P=U[0],re=V.select(this);re.remove(),T(P,m),y[P]=!0});for(var A in m._plots)for(var R=m._plots[A],N=R.overlays||[],te=0;te<N.length;te++){var H=N[te];y[H.id]&&H.plot.selectAll(".trace").remove()}}}function T(C,m){m._draggers.selectAll("g."+C).remove(),m._defs.select("#clip"+m._uid+C+"plot").remove()}W.toSVG=function(C){var m=C._fullLayout._glimages,y=V.select(C).selectAll(".svg-container"),A=y.filter(function(N,te){return te===y.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function R(){var N=this,te=N.toDataURL("image/png"),H=m.append("svg:image");H.attr({xmlns:v.svg,"xlink:href":te,preserveAspectRatio:"none",x:0,y:0,width:N.style.width,height:N.style.height})}A.each(R)},W.updateFx=Gm().updateFx}),Qx=t((W,V)=>{var d=Ki();V.exports={hasLines:d.hasLines,hasMarkers:d.hasMarkers,hasText:d.hasText,isBubble:d.isBubble,attributes:rc(),layoutAttributes:$a(),supplyDefaults:Px(),crossTraceDefaults:Ox(),supplyLayoutDefaults:Nx(),calc:$m().calc,crossTraceCalc:zx(),arraysToCalcdata:Qm(),plot:Bx(),colorbar:t1(),formatLabels:Hx(),style:r1().style,styleOnSelect:r1().styleOnSelect,hoverPoints:Gx(),selectPoints:jx(),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:mf(),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}}),Kx=t((W,V)=>{var d=l(),i=Xt(),s=Hm(),f=Mt(),u=f.strScale,h=f.strRotate,p=f.strTranslate;V.exports=function(v,o,w){var g=v.node(),b=s[w.arrowhead||0],L=s[w.startarrowhead||0],S=(w.arrowwidth||1)*(w.arrowsize||1),M=(w.arrowwidth||1)*(w.startarrowsize||1),T=o.indexOf("start")>=0,C=o.indexOf("end")>=0,m=b.backoff*S+w.standoff,y=L.backoff*M+w.startstandoff,A,R,N,te;if(g.nodeName==="line"){A={x:+v.attr("x1"),y:+v.attr("y1")},R={x:+v.attr("x2"),y:+v.attr("y2")};var H=A.x-R.x,U=A.y-R.y;if(N=Math.atan2(U,H),te=N+Math.PI,m&&y&&m+y>Math.sqrt(H*H+U*U)){ye();return}if(m){if(m*m>H*H+U*U){ye();return}var P=m*Math.cos(N),re=m*Math.sin(N);R.x+=P,R.y+=re,v.attr({x2:R.x,y2:R.y})}if(y){if(y*y>H*H+U*U){ye();return}var G=y*Math.cos(N),Z=y*Math.sin(N);A.x-=G,A.y-=Z,v.attr({x1:A.x,y1:A.y})}}else if(g.nodeName==="path"){var Y=g.getTotalLength(),X="";if(Y<m+y){ye();return}var ne=g.getPointAtLength(0),ae=g.getPointAtLength(.1);N=Math.atan2(ne.y-ae.y,ne.x-ae.x),A=g.getPointAtLength(Math.min(y,Y)),X="0px,"+y+"px,";var B=g.getPointAtLength(Y),ie=g.getPointAtLength(Y-.1);te=Math.atan2(B.y-ie.y,B.x-ie.x),R=g.getPointAtLength(Math.max(0,Y-m));var se=X?y+m:m;X+=Y-se+"px,"+Y+"px",v.style("stroke-dasharray",X)}function ye(){v.style("stroke-dasharray","0px,100px")}function me(xe,Re,ke,Ie){xe.path&&(xe.noRotate&&(ke=0),d.select(g.parentNode).append("path").attr({class:v.attr("class"),d:xe.path,transform:p(Re.x,Re.y)+h(ke*180/Math.PI)+u(Ie)}).style({fill:i.rgb(w.arrowcolor),"stroke-width":0}))}T&&me(L,A,N,M),C&&me(b,R,te,S)}}),gf=t((W,V)=>{var d=l(),i=an(),s=pn(),f=Mt(),u=f.strTranslate,h=Ja(),p=Xt(),v=Ra(),o=ws(),w=ja(),g=ar(),b=Ot(),L=fn().arrayEditor,S=Kx();V.exports={draw:M,drawOne:T,drawRaw:m};function M(y){var A=y._fullLayout;A._infolayer.selectAll(".annotation").remove();for(var R=0;R<A.annotations.length;R++)A.annotations[R].visible&&T(y,R);return s.previousPromises(y)}function T(y,A){var R=y._fullLayout,N=R.annotations[A]||{},te=h.getFromId(y,N.xref),H=h.getFromId(y,N.yref);te&&te.setScale(),H&&H.setScale(),m(y,N,A,!1,te,H)}function C(y,A,R,N,te){var H=te[R],U=te[R+"ref"],P=R.indexOf("y")!==-1,re=h.getRefType(U)==="domain",G=P?N.h:N.w;return y?re?H+(P?-A:A)/y._length:y.p2r(y.r2p(H)+A):H+(P?-A:A)/G}function m(y,A,R,N,te,H){var U=y._fullLayout,P=y._fullLayout._size,re=y._context.edits,G,Z;N?(G="annotation-"+N,Z=N+".annotations"):(G="annotation",Z="annotations");var Y=L(y.layout,Z,A),X=Y.modifyBase,ne=Y.modifyItem,ae=Y.getUpdateObj;U._infolayer.selectAll("."+G+'[data-index="'+R+'"]').remove();var B="clip"+U._uid+"_ann"+R;if(!A._input||A.visible===!1){d.selectAll("#"+B).remove();return}var ie={x:{},y:{}},se=+A.textangle||0,ye=U._infolayer.append("g").classed(G,!0).attr("data-index",String(R)).style("opacity",A.opacity),me=ye.append("g").classed("annotation-text-g",!0),xe=re[A.showarrow?"annotationTail":"annotationPosition"],Re=A.captureevents||re.annotationText||xe;function ke(Te){var Ae={index:R,annotation:A._input,fullAnnotation:A,event:Te};return N&&(Ae.subplotId=N),Ae}var Ie=me.append("g").style("pointer-events",Re?"all":null).call(g,"pointer").on("click",function(){y._dragging=!1,y.emit("plotly_clickannotation",ke(d.event))});A.hovertext&&Ie.on("mouseover",function(){var Te=A.hoverlabel,Ae=Te.font,Fe=this.getBoundingClientRect(),Ge=y.getBoundingClientRect();o.loneHover({x0:Fe.left-Ge.left,x1:Fe.right-Ge.left,y:(Fe.top+Fe.bottom)/2-Ge.top,text:A.hovertext,color:Te.bgcolor,borderColor:Te.bordercolor,fontFamily:Ae.family,fontSize:Ae.size,fontColor:Ae.color,fontWeight:Ae.weight,fontStyle:Ae.style,fontVariant:Ae.variant,fontShadow:Ae.fontShadow,fontLineposition:Ae.fontLineposition,fontTextcase:Ae.fontTextcase},{container:U._hoverlayer.node(),outerContainer:U._paper.node(),gd:y})}).on("mouseout",function(){o.loneUnhover(U._hoverlayer.node())});var Q=A.borderwidth,ee=A.borderpad,D=Q+ee,le=Ie.append("rect").attr("class","bg").style("stroke-width",Q+"px").call(p.stroke,A.bordercolor).call(p.fill,A.bgcolor),ge=A.width||A.height,j=U._topclips.selectAll("#"+B).data(ge?[0]:[]);j.enter().append("clipPath").classed("annclip",!0).attr("id",B).append("rect"),j.exit().remove();var k=A.font,F=U._meta?f.templateString(A.text,U._meta):A.text,J=Ie.append("text").classed("annotation-text",!0).text(F);function K(Te){return Te.call(v.font,k).attr({"text-anchor":{left:"start",right:"end"}[A.align]||"middle"}),w.convertToTspans(Te,y,ve),Te}function ve(){var Te=J.selectAll("a");if(Te.size()===1&&Te.text()===J.text()){var Ae=Ie.insert("a",":first-child").attr({"xlink:xlink:href":Te.attr("xlink:href"),"xlink:xlink:show":Te.attr("xlink:show")}).style({cursor:"pointer"});Ae.node().appendChild(le.node())}var Fe=Ie.select(".annotation-text-math-group"),Ge=!Fe.empty(),rt=v.bBox((Ge?Fe:J).node()),bt=rt.width,ht=rt.height,ct=A.width||bt,Oe=A.height||ht,ze=Math.round(ct+2*D),we=Math.round(Oe+2*D);function je(wr,lr){return lr==="auto"&&(wr<1/3?lr="left":wr>2/3?lr="right":lr="center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[lr]}for(var ot=!1,vt=["x","y"],Lt=0;Lt<vt.length;Lt++){var Tt=vt[Lt],kt=A[Tt+"ref"]||Tt,Nt=A["a"+Tt+"ref"],Pt={x:te,y:H}[Tt],Wt=(se+(Tt==="x"?0:-90))*Math.PI/180,St=ze*Math.cos(Wt),Qt=we*Math.sin(Wt),rr=Math.abs(St)+Math.abs(Qt),Jt=A[Tt+"anchor"],sr=A[Tt+"shift"]*(Tt==="x"?1:-1),De=ie[Tt],Je,de,Me,Ce,Ue,He=h.getRefType(kt);if(Pt&&He!=="domain"){var et=Pt.r2fraction(A[Tt]);(et<0||et>1)&&(Nt===kt?(et=Pt.r2fraction(A["a"+Tt]),(et<0||et>1)&&(ot=!0)):ot=!0),Je=Pt._offset+Pt.r2p(A[Tt]),Ce=.5}else{var at=He==="domain";Tt==="x"?(Me=A[Tt],Je=at?Pt._offset+Pt._length*Me:Je=P.l+P.w*Me):(Me=1-A[Tt],Je=at?Pt._offset+Pt._length*Me:Je=P.t+P.h*Me),Ce=A.showarrow?.5:Me}if(A.showarrow){De.head=Je;var xt=A["a"+Tt];if(Ue=St*je(.5,A.xanchor)-Qt*je(.5,A.yanchor),Nt===kt){var mt=h.getRefType(Nt);mt==="domain"?(Tt==="y"&&(xt=1-xt),De.tail=Pt._offset+Pt._length*xt):mt==="paper"?Tt==="y"?(xt=1-xt,De.tail=P.t+P.h*xt):De.tail=P.l+P.w*xt:De.tail=Pt._offset+Pt.r2p(xt),de=Ue}else De.tail=Je+xt,de=Ue+xt;De.text=De.tail+Ue;var yt=U[Tt==="x"?"width":"height"];if(kt==="paper"&&(De.head=f.constrain(De.head,1,yt-1)),Nt==="pixel"){var It=-Math.max(De.tail-3,De.text),zt=Math.min(De.tail+3,De.text)-yt;It>0?(De.tail+=It,De.text+=It):zt>0&&(De.tail-=zt,De.text-=zt)}De.tail+=sr,De.head+=sr}else Ue=rr*je(Ce,Jt),de=Ue,De.text=Je+Ue;De.text+=sr,Ue+=sr,de+=sr,A["_"+Tt+"padplus"]=rr/2+de,A["_"+Tt+"padminus"]=rr/2-de,A["_"+Tt+"size"]=rr,A["_"+Tt+"shift"]=Ue}if(ot){Ie.remove();return}var Ut=0,or=0;if(A.align!=="left"&&(Ut=(ct-bt)*(A.align==="center"?.5:1)),A.valign!=="top"&&(or=(Oe-ht)*(A.valign==="middle"?.5:1)),Ge)Fe.select("svg").attr({x:D+Ut-1,y:D+or}).call(v.setClipUrl,ge?B:null,y);else{var xr=D+or-rt.top,zr=D+Ut-rt.left;J.call(w.positionText,zr,xr).call(v.setClipUrl,ge?B:null,y)}j.select("rect").call(v.setRect,D,D,ct,Oe),le.call(v.setRect,Q/2,Q/2,ze-Q,we-Q),Ie.call(v.setTranslate,Math.round(ie.x.text-ze/2),Math.round(ie.y.text-we/2)),me.attr({transform:"rotate("+se+","+ie.x.text+","+ie.y.text+")"});var Br=function(wr,lr){ye.selectAll(".annotation-arrow-g").remove();var Dr=ie.x.head,Hr=ie.y.head,Rr=ie.x.tail+wr,Ar=ie.y.tail+lr,Er=ie.x.text+wr,_r=ie.y.text+lr,rn=f.rotationXYMatrix(se,Er,_r),gn=f.apply2DTransform(rn),Ur=f.apply2DTransform2(rn),vn=+le.attr("width"),Cn=+le.attr("height"),Vn=Er-.5*vn,Gn=Vn+vn,sn=_r-.5*Cn,Fn=sn+Cn,Tn=[[Vn,sn,Vn,Fn],[Vn,Fn,Gn,Fn],[Gn,Fn,Gn,sn],[Gn,sn,Vn,sn]].map(Ur);if(!Tn.reduce(function(At,Rt){return At^!!f.segmentsIntersect(Dr,Hr,Dr+1e6,Hr+1e6,Rt[0],Rt[1],Rt[2],Rt[3])},!1)){Tn.forEach(function(At){var Rt=f.segmentsIntersect(Rr,Ar,Dr,Hr,At[0],At[1],At[2],At[3]);Rt&&(Rr=Rt.x,Ar=Rt.y)});var Mr=A.arrowwidth,oa=A.arrowcolor,pe=A.arrowside,he=ye.append("g").style({opacity:p.opacity(oa)}).classed("annotation-arrow-g",!0),Ye=he.append("path").attr("d","M"+Rr+","+Ar+"L"+Dr+","+Hr).style("stroke-width",Mr+"px").call(p.stroke,p.rgb(oa));if(S(Ye,pe,A),re.annotationPosition&&Ye.node().parentNode&&!N){var tt=Dr,lt=Hr;if(A.standoff){var We=Math.sqrt(Math.pow(Dr-Rr,2)+Math.pow(Hr-Ar,2));tt+=A.standoff*(Rr-Dr)/We,lt+=A.standoff*(Ar-Hr)/We}var Ze=he.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(Rr-tt)+","+(Ar-lt),transform:u(tt,lt)}).style("stroke-width",Mr+6+"px").call(p.stroke,"rgba(0,0,0,0)").call(p.fill,"rgba(0,0,0,0)"),dt,it;b.init({element:Ze.node(),gd:y,prepFn:function(){var At=v.getTranslate(Ie);dt=At.x,it=At.y,te&&te.autorange&&X(te._name+".autorange",!0),H&&H.autorange&&X(H._name+".autorange",!0)},moveFn:function(At,Rt){var Yt=gn(dt,it),pr=Yt[0]+At,fr=Yt[1]+Rt;Ie.call(v.setTranslate,pr,fr),ne("x",C(te,At,"x",P,A)),ne("y",C(H,Rt,"y",P,A)),A.axref===A.xref&&ne("ax",C(te,At,"ax",P,A)),A.ayref===A.yref&&ne("ay",C(H,Rt,"ay",P,A)),he.attr("transform",u(At,Rt)),me.attr({transform:"rotate("+se+","+pr+","+fr+")"})},doneFn:function(){i.call("_guiRelayout",y,ae());var At=document.querySelector(".js-notes-box-panel");At&&At.redraw(At.selectedObj)}})}}};if(A.showarrow&&Br(0,0),xe){var Gr;b.init({element:Ie.node(),gd:y,prepFn:function(){Gr=me.attr("transform")},moveFn:function(wr,lr){var Dr="pointer";if(A.showarrow)A.axref===A.xref?ne("ax",C(te,wr,"ax",P,A)):ne("ax",A.ax+wr),A.ayref===A.yref?ne("ay",C(H,lr,"ay",P.w,A)):ne("ay",A.ay+lr),Br(wr,lr);else{if(N)return;var Hr,Rr;if(te)Hr=C(te,wr,"x",P,A);else{var Ar=A._xsize/P.w,Er=A.x+(A._xshift-A.xshift)/P.w-Ar/2;Hr=b.align(Er+wr/P.w,Ar,0,1,A.xanchor)}if(H)Rr=C(H,lr,"y",P,A);else{var _r=A._ysize/P.h,rn=A.y-(A._yshift+A.yshift)/P.h-_r/2;Rr=b.align(rn-lr/P.h,_r,0,1,A.yanchor)}ne("x",Hr),ne("y",Rr),(!te||!H)&&(Dr=b.getCursor(te?.5:Hr,H?.5:Rr,A.xanchor,A.yanchor))}me.attr({transform:u(wr,lr)+Gr}),g(Ie,Dr)},clickFn:function(wr,lr){A.captureevents&&y.emit("plotly_clickannotation",ke(lr))},doneFn:function(){g(Ie),i.call("_guiRelayout",y,ae());var wr=document.querySelector(".js-notes-box-panel");wr&&wr.redraw(wr.selectedObj)}})}}re.annotationText?J.call(w.makeEditable,{delegate:Ie,gd:y}).call(K).on("edit",function(Te){A.text=Te,this.call(K),ne("text",Te),te&&te.autorange&&X(te._name+".autorange",!0),H&&H.autorange&&X(H._name+".autorange",!0),i.call("_guiRelayout",y,ae())}):J.call(K)}}),$x=t((W,V)=>{var d=Mt(),i=an(),s=fn().arrayEditor;V.exports={hasClickToShow:f,onClick:u};function f(v,o){var w=h(v,o);return w.on.length>0||w.explicitOff.length>0}function u(v,o){var w=h(v,o),g=w.on,b=w.off.concat(w.explicitOff),L={},S=v._fullLayout.annotations,M,T;if(g.length||b.length){for(M=0;M<g.length;M++)T=s(v.layout,"annotations",S[g[M]]),T.modifyItem("visible",!0),d.extendFlat(L,T.getUpdateObj());for(M=0;M<b.length;M++)T=s(v.layout,"annotations",S[b[M]]),T.modifyItem("visible",!1),d.extendFlat(L,T.getUpdateObj());return i.call("update",v,{},L)}}function h(v,o){var w=v._fullLayout.annotations,g=[],b=[],L=[],S=(o||[]).length,M,T,C,m,y,A,R,N;for(M=0;M<w.length;M++)if(C=w[M],m=C.clicktoshow,m){for(T=0;T<S;T++)if(y=o[T],A=y.xaxis,R=y.yaxis,A._id===C.xref&&R._id===C.yref&&A.d2r(y.x)===p(C._xclick,A)&&R.d2r(y.y)===p(C._yclick,R)){C.visible?m==="onout"?N=b:N=L:N=g,N.push(M);break}T===S&&C.visible&&m==="onout"&&b.push(M)}return{on:g,off:b,explicitOff:L}}function p(v,o){return o.type==="log"?o.l2r(v):o.d2r(v)}}),i1=t((W,V)=>{var d=Mt(),i=Xt();V.exports=function(s,f,u,h){h("opacity");var p=h("bgcolor"),v=h("bordercolor"),o=i.opacity(v);h("borderpad");var w=h("borderwidth"),g=h("showarrow");h("text",g?" ":u._dfltTitle.annotation),h("textangle"),d.coerceFont(h,"font",u.font),h("width"),h("align");var b=h("height");if(b&&h("valign"),g){var L=h("arrowside"),S,M;L.indexOf("end")!==-1&&(S=h("arrowhead"),M=h("arrowsize")),L.indexOf("start")!==-1&&(h("startarrowhead",S),h("startarrowsize",M)),h("arrowcolor",o?f.bordercolor:i.defaultLine),h("arrowwidth",(o&&w||1)*2),h("standoff"),h("startstandoff")}var T=h("hovertext"),C=u.hoverlabel||{};if(T){var m=h("hoverlabel.bgcolor",C.bgcolor||(i.opacity(p)?i.rgb(p):i.defaultLine)),y=h("hoverlabel.bordercolor",C.bordercolor||i.contrast(m)),A=d.extendFlat({},C.font);A.color||(A.color=y),d.coerceFont(h,"hoverlabel.font",A)}h("captureevents",!!T)}}),e_=t((W,V)=>{var d=Mt(),i=Ja(),s=No(),f=i1(),u=ru();V.exports=function(p,v){s(p,v,{name:"annotations",handleItemDefaults:h})};function h(p,v,o){function w(P,re){return d.coerce(p,v,u,P,re)}var g=w("visible"),b=w("clicktoshow");if(g||b){f(p,v,o,w);for(var L=v.showarrow,S=["x","y"],M=[-10,-30],T={_fullLayout:o},C=0;C<2;C++){var m=S[C],y=i.coerceRef(p,v,T,m,"","paper");if(y!=="paper"){var A=i.getFromId(T,y);A._annIndices.push(v._index)}if(i.coercePosition(v,T,w,y,m,.5),L){var R="a"+m,N=i.coerceRef(p,v,T,R,"pixel",["pixel","paper"]);N!=="pixel"&&N!==y&&(N=v[R]="pixel");var te=N==="pixel"?M[C]:.4;i.coercePosition(v,T,w,N,R,te)}w(m+"anchor"),w(m+"shift")}if(d.noneOrAll(p,v,["x","y"]),L&&d.noneOrAll(p,v,["ax","ay"]),b){var H=w("xclick"),U=w("yclick");v._xclick=H===void 0?v.x:i.cleanPosition(H,T,v.xref),v._yclick=U===void 0?v.y:i.cleanPosition(U,T,v.yref)}}}}),t_=t((W,V)=>{var d=Mt(),i=Ja(),s=gf().draw;V.exports=function(h){var p=h._fullLayout,v=d.filterVisible(p.annotations);if(v.length&&h._fullData.length)return d.syncOrAsync([s,f],h)};function f(h){var p=h._fullLayout;d.filterVisible(p.annotations).forEach(function(v){var o=i.getFromId(h,v.xref),w=i.getFromId(h,v.yref),g=i.getRefType(v.xref),b=i.getRefType(v.yref);v._extremes={},g==="range"&&u(v,o),b==="range"&&u(v,w)})}function u(h,p){var v=p._id,o=v.charAt(0),w=h[o],g=h["a"+o],b=h[o+"ref"],L=h["a"+o+"ref"],S=h["_"+o+"padplus"],M=h["_"+o+"padminus"],T={x:1,y:-1}[o]*h[o+"shift"],C=3*h.arrowsize*h.arrowwidth||0,m=C+T,y=C-T,A=3*h.startarrowsize*h.arrowwidth||0,R=A+T,N=A-T,te;if(L===b){var H=i.findExtremes(p,[p.r2c(w)],{ppadplus:m,ppadminus:y}),U=i.findExtremes(p,[p.r2c(g)],{ppadplus:Math.max(S,R),ppadminus:Math.max(M,N)});te={min:[H.min[0],U.min[0]],max:[H.max[0],U.max[0]]}}else R=g?R+g:R,N=g?N-g:N,te=i.findExtremes(p,[p.r2c(w)],{ppadplus:Math.max(S,m,R),ppadminus:Math.max(M,y,N)});h._extremes[v]=te}}),r_=t((W,V)=>{var d=q(),i=Xe();V.exports=function(s,f,u,h){f=f||{};var p=u==="log"&&f.type==="linear",v=u==="linear"&&f.type==="log";if(!(p||v))return;var o=s._fullLayout.annotations,w=f._id.charAt(0),g,b;function L(M){var T=g[M],C=null;p?C=i(T,f.range):C=Math.pow(10,T),d(C)||(C=null),h(b+M,C)}for(var S=0;S<o.length;S++)g=o[S],b="annotations["+S+"].",g[w+"ref"]===f._id&&L(w),g["a"+w+"ref"]===f._id&&L("a"+w)}}),n_=t((W,V)=>{var d=gf(),i=$x();V.exports={moduleType:"component",name:"annotations",layoutAttributes:ru(),supplyLayoutDefaults:e_(),includeBasePlot:ud()("annotations"),calcAutorange:t_(),draw:d.draw,drawOne:d.drawOne,drawRaw:d.drawRaw,hasClickToShow:i.hasClickToShow,onClick:i.onClick,convertCoords:r_()}}),vf=t((W,V)=>{var d=ru(),i=Ft().overrideAll,s=fn().templatedArray;V.exports=i(s("annotation",{visible:d.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:d.xanchor,xshift:d.xshift,yanchor:d.yanchor,yshift:d.yshift,text:d.text,textangle:d.textangle,font:d.font,width:d.width,height:d.height,opacity:d.opacity,align:d.align,valign:d.valign,bgcolor:d.bgcolor,bordercolor:d.bordercolor,borderpad:d.borderpad,borderwidth:d.borderwidth,showarrow:d.showarrow,arrowcolor:d.arrowcolor,arrowhead:d.arrowhead,startarrowhead:d.startarrowhead,arrowside:d.arrowside,arrowsize:d.arrowsize,startarrowsize:d.startarrowsize,arrowwidth:d.arrowwidth,standoff:d.standoff,startstandoff:d.startstandoff,hovertext:d.hovertext,hoverlabel:d.hoverlabel,captureevents:d.captureevents}),"calc","from-root")}),a_=t((W,V)=>{var d=Mt(),i=Ja(),s=No(),f=i1(),u=vf();V.exports=function(p,v,o){s(p,v,{name:"annotations",handleItemDefaults:h,fullLayout:o.fullLayout})};function h(p,v,o,w){function g(S,M){return d.coerce(p,v,u,S,M)}function b(S){var M=S+"axis",T={_fullLayout:{}};return T._fullLayout[M]=o[M],i.coercePosition(v,T,g,S,S,.5)}var L=g("visible");L&&(f(p,v,w.fullLayout,g),b("x"),b("y"),b("z"),d.noneOrAll(p,v,["x","y","z"]),v.xref="x",v.yref="y",v.zref="z",g("xanchor"),g("yanchor"),g("xshift"),g("yshift"),v.showarrow&&(v.axref="pixel",v.ayref="pixel",g("ax",-10),g("ay",-30),d.noneOrAll(p,v,["ax","ay"])))}}),i_=t((W,V)=>{var d=Mt(),i=Ja();V.exports=function(f){for(var u=f.fullSceneLayout,h=u.annotations,p=0;p<h.length;p++)s(h[p],f);f.fullLayout._infolayer.selectAll(".annotation-"+f.id).remove()};function s(f,u){var h=u.fullSceneLayout,p=h.domain,v=u.fullLayout._size,o={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};f._xa={},d.extendFlat(f._xa,o),i.setConvert(f._xa),f._xa._offset=v.l+p.x[0]*v.w,f._xa.l2p=function(){return .5*(1+f._pdata[0]/f._pdata[3])*v.w*(p.x[1]-p.x[0])},f._ya={},d.extendFlat(f._ya,o),i.setConvert(f._ya),f._ya._offset=v.t+(1-p.y[1])*v.h,f._ya.l2p=function(){return .5*(1-f._pdata[1]/f._pdata[3])*v.h*(p.y[1]-p.y[0])}}}),o_=t((W,V)=>{function d(s,f){var u=[0,0,0,0],h,p;for(h=0;h<4;++h)for(p=0;p<4;++p)u[p]+=s[4*h+p]*f[h];return u}function i(s,f){var u=d(s.projection,d(s.view,d(s.model,[f[0],f[1],f[2],1])));return u}V.exports=i}),s_=t((W,V)=>{var d=gf().drawRaw,i=o_(),s=["x","y","z"];V.exports=function(f){for(var u=f.fullSceneLayout,h=f.dataScale,p=u.annotations,v=0;v<p.length;v++){for(var o=p[v],w=!1,g=0;g<3;g++){var b=s[g],L=o[b],S=u[b+"axis"],M=S.r2fraction(L);if(M<0||M>1){w=!0;break}}w?f.fullLayout._infolayer.select(".annotation-"+f.id+'[data-index="'+v+'"]').remove():(o._pdata=i(f.glplot.cameraParams,[u.xaxis.r2l(o.x)*h[0],u.yaxis.r2l(o.y)*h[1],u.zaxis.r2l(o.z)*h[2]]),d(f.graphDiv,o,v,f.id,o._xa,o._ya))}}}),l_=t((W,V)=>{var d=an(),i=Mt();V.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:vf()}}},layoutAttributes:vf(),handleDefaults:a_(),includeBasePlot:s,convert:i_(),draw:s_()};function s(f,u){var h=d.subplotsRegistry.gl3d;if(h)for(var p=h.attrRegex,v=Object.keys(f),o=0;o<v.length;o++){var w=v[o];p.test(w)&&(f[w].annotations||[]).length&&(i.pushUnique(u._basePlotModules,h),i.pushUnique(u._subplots.gl3d,w))}}}),o1=t((W,V)=>{var d=ru(),i=pt(),s=rc().line,f=Wr().dash,u=gt().extendFlat,h=fn().templatedArray;cd();var p=nt(),v=jr().shapeTexttemplateAttrs,o=mr();V.exports=h("shape",{visible:u({},p.visible,{editType:"calc+arraydraw"}),showlegend:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},legend:u({},p.legend,{editType:"calc+arraydraw"}),legendgroup:u({},p.legendgroup,{editType:"calc+arraydraw"}),legendgrouptitle:{text:u({},p.legendgrouptitle.text,{editType:"calc+arraydraw"}),font:i({editType:"calc+arraydraw"}),editType:"calc+arraydraw"},legendrank:u({},p.legendrank,{editType:"calc+arraydraw"}),legendwidth:u({},p.legendwidth,{editType:"calc+arraydraw"}),type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above","between"],dflt:"above",editType:"arraydraw"},xref:u({},d.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},x0shift:{valType:"number",dflt:0,min:-1,max:1,editType:"calc"},x1shift:{valType:"number",dflt:0,min:-1,max:1,editType:"calc"},yref:u({},d.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},y0shift:{valType:"number",dflt:0,min:-1,max:1,editType:"calc"},y1shift:{valType:"number",dflt:0,min:-1,max:1,editType:"calc"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:u({},s.color,{editType:"arraydraw"}),width:u({},s.width,{editType:"calc+arraydraw"}),dash:u({},f,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},label:{text:{valType:"string",dflt:"",editType:"arraydraw"},texttemplate:v({},{keys:Object.keys(o)}),font:i({editType:"calc+arraydraw",colorEditType:"arraydraw"}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right","start","middle","end"],editType:"arraydraw"},textangle:{valType:"angle",dflt:"auto",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],editType:"calc+arraydraw"},padding:{valType:"number",dflt:3,min:0,editType:"arraydraw"},editType:"arraydraw"},editType:"arraydraw"})}),c_=t((W,V)=>{var d=Mt(),i=Ja(),s=No(),f=o1(),u=xl();V.exports=function(v,o){s(v,o,{name:"shapes",handleItemDefaults:p})};function h(v,o){return v?"bottom":o.indexOf("top")!==-1?"top":o.indexOf("bottom")!==-1?"bottom":"middle"}function p(v,o,w){function g(Q,ee){return d.coerce(v,o,f,Q,ee)}o._isShape=!0;var b=g("visible");if(b){var L=g("showlegend");L&&(g("legend"),g("legendwidth"),g("legendgroup"),g("legendgrouptitle.text"),d.coerceFont(g,"legendgrouptitle.font"),g("legendrank"));var S=g("path"),M=S?"path":"rect",T=g("type",M),C=T!=="path";C&&delete o.path,g("editable"),g("layer"),g("opacity"),g("fillcolor"),g("fillrule");var m=g("line.width");m&&(g("line.color"),g("line.dash"));for(var y=g("xsizemode"),A=g("ysizemode"),R=["x","y"],N=0;N<2;N++){var te=R[N],H=te+"anchor",U=te==="x"?y:A,P={_fullLayout:w},re,G,Z,Y=i.coerceRef(v,o,P,te,void 0,"paper"),X=i.getRefType(Y);if(X==="range"?(re=i.getFromId(P,Y),re._shapeIndices.push(o._index),Z=u.rangeToShapePosition(re),G=u.shapePositionToRange(re),(re.type==="category"||re.type==="multicategory")&&(g(te+"0shift"),g(te+"1shift"))):G=Z=d.identity,C){var ne=.25,ae=.75,B=te+"0",ie=te+"1",se=v[B],ye=v[ie];v[B]=G(v[B],!0),v[ie]=G(v[ie],!0),U==="pixel"?(g(B,0),g(ie,10)):(i.coercePosition(o,P,g,Y,B,ne),i.coercePosition(o,P,g,Y,ie,ae)),o[B]=Z(o[B]),o[ie]=Z(o[ie]),v[B]=se,v[ie]=ye}if(U==="pixel"){var me=v[H];v[H]=G(v[H],!0),i.coercePosition(o,P,g,Y,H,.25),o[H]=Z(o[H]),v[H]=me}}C&&d.noneOrAll(v,o,["x0","x1","y0","y1"]);var xe=T==="line",Re,ke;if(C&&(Re=g("label.texttemplate")),Re||(ke=g("label.text")),ke||Re){g("label.textangle");var Ie=g("label.textposition",xe?"middle":"middle center");g("label.xanchor"),g("label.yanchor",h(xe,Ie)),g("label.padding"),d.coerceFont(g,"label.font",w.font)}}}}),u_=t((W,V)=>{var d=Xt(),i=Mt();function s(f,u){return f?"bottom":u.indexOf("top")!==-1?"top":u.indexOf("bottom")!==-1?"bottom":"middle"}V.exports=function(f,u,h){h("newshape.visible"),h("newshape.name"),h("newshape.showlegend"),h("newshape.legend"),h("newshape.legendwidth"),h("newshape.legendgroup"),h("newshape.legendgrouptitle.text"),i.coerceFont(h,"newshape.legendgrouptitle.font"),h("newshape.legendrank"),h("newshape.drawdirection"),h("newshape.layer"),h("newshape.fillcolor"),h("newshape.fillrule"),h("newshape.opacity");var p=h("newshape.line.width");if(p){var v=(f||{}).plot_bgcolor||"#FFF";h("newshape.line.color",d.contrast(v)),h("newshape.line.dash")}var o=f.dragmode==="drawline",w=h("newshape.label.text"),g=h("newshape.label.texttemplate");if(w||g){h("newshape.label.textangle");var b=h("newshape.label.textposition",o?"middle":"middle center");h("newshape.label.xanchor"),h("newshape.label.yanchor",s(o,b)),h("newshape.label.padding"),i.coerceFont(h,"newshape.label.font",u.font)}h("activeshape.fillcolor"),h("activeshape.opacity")}}),d_=t((W,V)=>{var d=Mt(),i=Ja(),s=sd(),f=xl();V.exports=function(o){var w=o._fullLayout,g=d.filterVisible(w.shapes);if(!(!g.length||!o._fullData.length))for(var b=0;b<g.length;b++){var L=g[b];L._extremes={};var S,M,T=i.getRefType(L.xref),C=i.getRefType(L.yref);L.xref!=="paper"&&T!=="domain"&&(S=i.getFromId(o,L.xref),M=v(S,L,s.paramIsX),M&&(L._extremes[S._id]=i.findExtremes(S,M,u(L)))),L.yref!=="paper"&&C!=="domain"&&(S=i.getFromId(o,L.yref),M=v(S,L,s.paramIsY),M&&(L._extremes[S._id]=i.findExtremes(S,M,h(L))))}};function u(o){return p(o.line.width,o.xsizemode,o.x0,o.x1,o.path,!1)}function h(o){return p(o.line.width,o.ysizemode,o.y0,o.y1,o.path,!0)}function p(o,w,g,b,L,S){var M=o/2,T=S;if(w==="pixel"){var C=L?f.extractPathCoords(L,S?s.paramIsY:s.paramIsX):[g,b],m=d.aggNums(Math.max,null,C),y=d.aggNums(Math.min,null,C),A=y<0?Math.abs(y)+M:M,R=m>0?m+M:M;return{ppad:M,ppadplus:T?A:R,ppadminus:T?R:A}}else return{ppad:M}}function v(o,w,g){var b=o._id.charAt(0)==="x"?"x":"y",L=o.type==="category"||o.type==="multicategory",S,M,T=0,C=0,m=L?o.r2c:o.d2c,y=w[b+"sizemode"]==="scaled";if(y?(S=w[b+"0"],M=w[b+"1"],L&&(T=w[b+"0shift"],C=w[b+"1shift"])):(S=w[b+"anchor"],M=w[b+"anchor"]),S!==void 0)return[m(S)+T,m(M)+C];if(w.path){var A=1/0,R=-1/0,N=w.path.match(s.segmentRE),te,H,U,P,re;for(o.type==="date"&&(m=f.decodeDate(m)),te=0;te<N.length;te++)H=N[te],U=g[H.charAt(0)].drawn,U!==void 0&&(P=N[te].substr(1).match(s.paramRE),!(!P||P.length<U)&&(re=m(P[U]),re<A&&(A=re),re>R&&(R=re)));if(R>=A)return[A,R]}}}),h_=t((W,V)=>{var d=uf();V.exports={moduleType:"component",name:"shapes",layoutAttributes:o1(),supplyLayoutDefaults:c_(),supplyDrawNewShapeDefaults:u_(),includeBasePlot:ud()("shapes"),calcAutorange:d_(),draw:d.draw,drawOne:d.drawOne}}),s1=t((W,V)=>{var d=kn(),i=fn().templatedArray;cd(),V.exports=i("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",d.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",d.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})}),f_=t((W,V)=>{var d=Mt(),i=Ja(),s=No(),f=s1(),u="images";V.exports=function(p,v){var o={name:u,handleItemDefaults:h};s(p,v,o)};function h(p,v,o){function w(y,A){return d.coerce(p,v,f,y,A)}var g=w("source"),b=w("visible",!!g);if(!b)return v;w("layer"),w("xanchor"),w("yanchor"),w("sizex"),w("sizey"),w("sizing"),w("opacity");for(var L={_fullLayout:o},S=["x","y"],M=0;M<2;M++){var T=S[M],C=i.coerceRef(p,v,L,T,"paper",void 0);if(C!=="paper"){var m=i.getFromId(L,C);m._imgIndices.push(v._index)}i.coercePosition(v,L,w,C,T,0)}return v}}),p_=t((W,V)=>{var d=l(),i=Ra(),s=Ja(),f=aa(),u=xi();V.exports=function(h){var p=h._fullLayout,v=[],o={},w=[],g,b;for(b=0;b<p.images.length;b++){var L=p.images[b];if(L.visible)if(L.layer==="below"&&L.xref!=="paper"&&L.yref!=="paper"){g=f.ref2id(L.xref)+f.ref2id(L.yref);var S=p._plots[g];if(!S){w.push(L);continue}S.mainplot&&(g=S.mainplot.id),o[g]||(o[g]=[]),o[g].push(L)}else L.layer==="above"?v.push(L):w.push(L)}var M={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}};function T(U){var P=d.select(this);if(this._imgSrc!==U.source)if(P.attr("xmlns",u.svg),!h._context.staticPlot||U.source&&U.source.slice(0,5)==="data:")P.attr("xlink:href",U.source),this._imgSrc=U.source;else{var re=new Promise((function(G){var Z=new Image;this.img=Z,Z.setAttribute("crossOrigin","anonymous"),Z.onerror=Y,Z.onload=function(){var X=document.createElement("canvas");X.width=this.width,X.height=this.height;var ne=X.getContext("2d",{willReadFrequently:!0});ne.drawImage(this,0,0);var ae=X.toDataURL("image/png");P.attr("xlink:href",ae),G()},P.on("error",Y),Z.src=U.source,this._imgSrc=U.source;function Y(){P.remove(),G()}}).bind(this));h._promises.push(re)}}function C(U){var P=d.select(this),re=s.getFromId(h,U.xref),G=s.getFromId(h,U.yref),Z=s.getRefType(U.xref)==="domain",Y=s.getRefType(U.yref)==="domain",X=p._size,ne,ae;re!==void 0?ne=typeof U.xref=="string"&&Z?re._length*U.sizex:Math.abs(re.l2p(U.sizex)-re.l2p(0)):ne=U.sizex*X.w,G!==void 0?ae=typeof U.yref=="string"&&Y?G._length*U.sizey:Math.abs(G.l2p(U.sizey)-G.l2p(0)):ae=U.sizey*X.h;var B=ne*M.x[U.xanchor].offset,ie=ae*M.y[U.yanchor].offset,se=M.x[U.xanchor].sizing+M.y[U.yanchor].sizing,ye,me;switch(re!==void 0?ye=typeof U.xref=="string"&&Z?re._length*U.x+re._offset:re.r2p(U.x)+re._offset:ye=U.x*X.w+X.l,ye+=B,G!==void 0?me=typeof U.yref=="string"&&Y?G._length*(1-U.y)+G._offset:G.r2p(U.y)+G._offset:me=X.h-U.y*X.h+X.t,me+=ie,U.sizing){case"fill":se+=" slice";break;case"stretch":se="none";break}P.attr({x:ye,y:me,width:ne,height:ae,preserveAspectRatio:se,opacity:U.opacity});var xe=re&&s.getRefType(U.xref)!=="domain"?re._id:"",Re=G&&s.getRefType(U.yref)!=="domain"?G._id:"",ke=xe+Re;i.setClipUrl(P,ke?"clip"+p._uid+ke:null,h)}function m(U){return[U.xref,U.x,U.sizex,U.yref,U.y,U.sizey].join("_")}function y(U,P){return U._index-P._index}var A=p._imageLowerLayer.selectAll("image").data(w,m),R=p._imageUpperLayer.selectAll("image").data(v,m);A.enter().append("image"),R.enter().append("image"),A.exit().remove(),R.exit().remove(),A.each(function(U){T.bind(this)(U),C.bind(this)(U)}),R.each(function(U){T.bind(this)(U),C.bind(this)(U)}),A.sort(y),R.sort(y);var N=Object.keys(p._plots);for(b=0;b<N.length;b++){g=N[b];var te=p._plots[g];if(te.imagelayer){var H=te.imagelayer.selectAll("image").data(o[g]||[],m);H.enter().append("image"),H.exit().remove(),H.each(function(U){T.bind(this)(U),C.bind(this)(U)}),H.sort(y)}}}}),m_=t((W,V)=>{var d=q(),i=Xe();V.exports=function(s,f,u,h){f=f||{};var p=u==="log"&&f.type==="linear",v=u==="linear"&&f.type==="log";if(p||v){for(var o=s._fullLayout.images,w=f._id.charAt(0),g,b,L=0;L<o.length;L++)if(g=o[L],b="images["+L+"].",g[w+"ref"]===f._id){var S=g[w],M=g["size"+w],T=null,C=null;if(p){T=i(S,f.range);var m=M/Math.pow(10,T)/2;C=2*Math.log(m+Math.sqrt(1+m*m))/Math.LN10}else T=Math.pow(10,S),C=T*(Math.pow(10,M/2)-Math.pow(10,-M/2));d(T)?d(C)||(C=null):(T=null,C=null),h(b+w,T),h(b+"size"+w,C)}}}}),g_=t((W,V)=>{V.exports={moduleType:"component",name:"images",layoutAttributes:s1(),supplyLayoutDefaults:f_(),includeBasePlot:ud()("images"),draw:p_(),convertCoords:m_()}}),yf=t((W,V)=>{V.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"",right:"",up:"",down:""}}}),l1=t((W,V)=>{var d=pt(),i=Zt(),s=gt().extendFlat,f=Ft().overrideAll,u=nn(),h=fn().templatedArray,p=h("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});V.exports=f(h("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:p,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:s(u({editType:"arraydraw"}),{}),font:d({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:i.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")}),v_=t((W,V)=>{var d=Mt(),i=No(),s=l1(),f=yf(),u=f.name,h=s.buttons;V.exports=function(o,w){var g={name:u,handleItemDefaults:p};i(o,w,g)};function p(o,w,g){function b(M,T){return d.coerce(o,w,s,M,T)}var L=i(o,w,{name:"buttons",handleItemDefaults:v}),S=b("visible",L.length>0);S&&(b("active"),b("direction"),b("type"),b("showactive"),b("x"),b("y"),d.noneOrAll(o,w,["x","y"]),b("xanchor"),b("yanchor"),b("pad.t"),b("pad.r"),b("pad.b"),b("pad.l"),d.coerceFont(b,"font",g.font),b("bgcolor",g.paper_bgcolor),b("bordercolor"),b("borderwidth"))}function v(o,w){function g(L,S){return d.coerce(o,w,h,L,S)}var b=g("visible",o.method==="skip"||Array.isArray(o.args));b&&(g("method"),g("args"),g("args2"),g("label"),g("execute"))}}),y_=t((W,V)=>{V.exports=u;var d=l(),i=Xt(),s=Ra(),f=Mt();function u(h,p,v){this.gd=h,this.container=p,this.id=v,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}u.barWidth=2,u.barLength=20,u.barRadius=2,u.barPad=1,u.barColor="#808BA4",u.prototype.enable=function(h,p,v){var o=this.gd._fullLayout,w=o.width,g=o.height;this.position=h;var b=this.position.l,L=this.position.w,S=this.position.t,M=this.position.h,T=this.position.direction,C=T==="down",m=T==="left",y=T==="right",A=T==="up",R=L,N=M,te,H,U,P;!C&&!m&&!y&&!A&&(this.position.direction="down",C=!0);var re=C||A;re?(te=b,H=te+R,C?(U=S,P=Math.min(U+N,g),N=P-U):(P=S+N,U=Math.max(P-N,0),N=P-U)):(U=S,P=U+N,m?(H=b+R,te=Math.max(H-R,0),R=H-te):(te=b,H=Math.min(te+R,w),R=H-te)),this._box={l:te,t:U,w:R,h:N};var G=L>R,Z=u.barLength+2*u.barPad,Y=u.barWidth+2*u.barPad,X=b,ne=S+M;ne+Y>g&&(ne=g-Y);var ae=this.container.selectAll("rect.scrollbar-horizontal").data(G?[0]:[]);ae.exit().on(".drag",null).remove(),ae.enter().append("rect").classed("scrollbar-horizontal",!0).call(i.fill,u.barColor),G?(this.hbar=ae.attr({rx:u.barRadius,ry:u.barRadius,x:X,y:ne,width:Z,height:Y}),this._hbarXMin=X+Z/2,this._hbarTranslateMax=R-Z):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var B=M>N,ie=u.barWidth+2*u.barPad,se=u.barLength+2*u.barPad,ye=b+L,me=S;ye+ie>w&&(ye=w-ie);var xe=this.container.selectAll("rect.scrollbar-vertical").data(B?[0]:[]);xe.exit().on(".drag",null).remove(),xe.enter().append("rect").classed("scrollbar-vertical",!0).call(i.fill,u.barColor),B?(this.vbar=xe.attr({rx:u.barRadius,ry:u.barRadius,x:ye,y:me,width:ie,height:se}),this._vbarYMin=me+se/2,this._vbarTranslateMax=N-se):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var Re=this.id,ke=te-.5,Ie=B?H+ie+.5:H+.5,Q=U-.5,ee=G?P+Y+.5:P+.5,D=o._topdefs.selectAll("#"+Re).data(G||B?[0]:[]);if(D.exit().remove(),D.enter().append("clipPath").attr("id",Re).append("rect"),G||B?(this._clipRect=D.select("rect").attr({x:Math.floor(ke),y:Math.floor(Q),width:Math.ceil(Ie)-Math.floor(ke),height:Math.ceil(ee)-Math.floor(Q)}),this.container.call(s.setClipUrl,Re,this.gd),this.bg.attr({x:b,y:S,width:L,height:M})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(s.setClipUrl,null),delete this._clipRect),G||B){var le=d.behavior.drag().on("dragstart",function(){d.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(le);var ge=d.behavior.drag().on("dragstart",function(){d.event.sourceEvent.preventDefault(),d.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));G&&this.hbar.on(".drag",null).call(ge),B&&this.vbar.on(".drag",null).call(ge)}this.setTranslate(p,v)},u.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(s.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},u.prototype._onBoxDrag=function(){var h=this.translateX,p=this.translateY;this.hbar&&(h-=d.event.dx),this.vbar&&(p-=d.event.dy),this.setTranslate(h,p)},u.prototype._onBoxWheel=function(){var h=this.translateX,p=this.translateY;this.hbar&&(h+=d.event.deltaY),this.vbar&&(p+=d.event.deltaY),this.setTranslate(h,p)},u.prototype._onBarDrag=function(){var h=this.translateX,p=this.translateY;if(this.hbar){var v=h+this._hbarXMin,o=v+this._hbarTranslateMax,w=f.constrain(d.event.x,v,o),g=(w-v)/(o-v),b=this.position.w-this._box.w;h=g*b}if(this.vbar){var L=p+this._vbarYMin,S=L+this._vbarTranslateMax,M=f.constrain(d.event.y,L,S),T=(M-L)/(S-L),C=this.position.h-this._box.h;p=T*C}this.setTranslate(h,p)},u.prototype.setTranslate=function(h,p){var v=this.position.w-this._box.w,o=this.position.h-this._box.h;if(h=f.constrain(h||0,0,v),p=f.constrain(p||0,0,o),this.translateX=h,this.translateY=p,this.container.call(s.setTranslate,this._box.l-this.position.l-h,this._box.t-this.position.t-p),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+h-.5),y:Math.floor(this.position.t+p-.5)}),this.hbar){var w=h/v;this.hbar.call(s.setTranslate,h+w*this._hbarTranslateMax,p)}if(this.vbar){var g=p/o;this.vbar.call(s.setTranslate,h,p+g*this._vbarTranslateMax)}}}),x_=t((W,V)=>{var d=l(),i=pn(),s=Xt(),f=Ra(),u=Mt(),h=ja(),p=fn().arrayEditor,v=fi().LINE_SPACING,o=yf(),w=y_();V.exports=function(Z){var Y=Z._fullLayout,X=u.filterVisible(Y[o.name]);function ne(Re){i.autoMargin(Z,P(Re))}var ae=Y._menulayer.selectAll("g."+o.containerClassName).data(X.length>0?[0]:[]);if(ae.enter().append("g").classed(o.containerClassName,!0).style("cursor","pointer"),ae.exit().each(function(){d.select(this).selectAll("g."+o.headerGroupClassName).each(ne)}).remove(),X.length!==0){var B=ae.selectAll("g."+o.headerGroupClassName).data(X,g);B.enter().append("g").classed(o.headerGroupClassName,!0);for(var ie=u.ensureSingle(ae,"g",o.dropdownButtonGroupClassName,function(Re){Re.style("pointer-events","all")}),se=0;se<X.length;se++){var ye=X[se];U(Z,ye)}var me="updatemenus"+Y._uid,xe=new w(Z,ie,me);B.enter().size()&&(ie.node().parentNode.appendChild(ie.node()),ie.call(G)),B.exit().each(function(Re){ie.call(G),ne(Re)}).remove(),B.each(function(Re){var ke=d.select(this),Ie=Re.type==="dropdown"?ie:null;i.manageCommandObserver(Z,Re,Re.buttons,function(Q){S(Z,Re,Re.buttons[Q.index],ke,Ie,xe,Q.index,!0)}),Re.type==="dropdown"?(M(Z,ke,ie,xe,Re),L(ie,Re)&&T(Z,ke,ie,xe,Re)):T(Z,ke,null,null,Re)})}};function g(Z){return Z._index}function b(Z){return+Z.attr(o.menuIndexAttrName)==-1}function L(Z,Y){return+Z.attr(o.menuIndexAttrName)===Y._index}function S(Z,Y,X,ne,ae,B,ie,se){Y.active=ie,p(Z.layout,o.name,Y).applyUpdate("active",ie),Y.type==="buttons"?T(Z,ne,null,null,Y):Y.type==="dropdown"&&(ae.attr(o.menuIndexAttrName,"-1"),M(Z,ne,ae,B,Y),se||T(Z,ne,ae,B,Y))}function M(Z,Y,X,ne,ae){var B=u.ensureSingle(Y,"g",o.headerClassName,function(ke){ke.style("pointer-events","all")}),ie=ae._dims,se=ae.active,ye=ae.buttons[se]||o.blankHeaderOpts,me={y:ae.pad.t,yPad:0,x:ae.pad.l,xPad:0,index:0},xe={width:ie.headerWidth,height:ie.headerHeight};B.call(y,ae,ye,Z).call(re,ae,me,xe);var Re=u.ensureSingle(Y,"text",o.headerArrowClassName,function(ke){ke.attr("text-anchor","end").call(f.font,ae.font).text(o.arrowSymbol[ae.direction])});Re.attr({x:ie.headerWidth-o.arrowOffsetX+ae.pad.l,y:ie.headerHeight/2+o.textOffsetY+ae.pad.t}),B.on("click",function(){X.call(G,String(L(X,ae)?-1:ae._index)),T(Z,Y,X,ne,ae)}),B.on("mouseover",function(){B.call(te)}),B.on("mouseout",function(){B.call(H,ae)}),f.setTranslate(Y,ie.lx,ie.ly)}function T(Z,Y,X,ne,ae){X||(X=Y,X.attr("pointer-events","all"));var B=!b(X)||ae.type==="buttons"?ae.buttons:[],ie=ae.type==="dropdown"?o.dropdownButtonClassName:o.buttonClassName,se=X.selectAll("g."+ie).data(u.filterVisible(B)),ye=se.enter().append("g").classed(ie,!0),me=se.exit();ae.type==="dropdown"?(ye.attr("opacity","0").transition().attr("opacity","1"),me.transition().attr("opacity","0").remove()):me.remove();var xe=0,Re=0,ke=ae._dims,Ie=["up","down"].indexOf(ae.direction)!==-1;ae.type==="dropdown"&&(Ie?Re=ke.headerHeight+o.gapButtonHeader:xe=ke.headerWidth+o.gapButtonHeader),ae.type==="dropdown"&&ae.direction==="up"&&(Re=-o.gapButtonHeader+o.gapButton-ke.openHeight),ae.type==="dropdown"&&ae.direction==="left"&&(xe=-o.gapButtonHeader+o.gapButton-ke.openWidth);var Q={x:ke.lx+xe+ae.pad.l,y:ke.ly+Re+ae.pad.t,yPad:o.gapButton,xPad:o.gapButton,index:0},ee={l:Q.x+ae.borderwidth,t:Q.y+ae.borderwidth};se.each(function(D,le){var ge=d.select(this);ge.call(y,ae,D,Z).call(re,ae,Q),ge.on("click",function(){d.event.defaultPrevented||(D.execute&&(D.args2&&ae.active===le?(S(Z,ae,D,Y,X,ne,-1),i.executeAPICommand(Z,D.method,D.args2)):(S(Z,ae,D,Y,X,ne,le),i.executeAPICommand(Z,D.method,D.args))),Z.emit("plotly_buttonclicked",{menu:ae,button:D,active:ae.active}))}),ge.on("mouseover",function(){ge.call(te)}),ge.on("mouseout",function(){ge.call(H,ae),se.call(N,ae)})}),se.call(N,ae),Ie?(ee.w=Math.max(ke.openWidth,ke.headerWidth),ee.h=Q.y-ee.t):(ee.w=Q.x-ee.l,ee.h=Math.max(ke.openHeight,ke.headerHeight)),ee.direction=ae.direction,ne&&(se.size()?C(Z,Y,X,ne,ae,ee):m(ne))}function C(Z,Y,X,ne,ae,B){var ie=ae.direction,se=ie==="up"||ie==="down",ye=ae._dims,me=ae.active,xe,Re,ke;if(se)for(Re=0,ke=0;ke<me;ke++)Re+=ye.heights[ke]+o.gapButton;else for(xe=0,ke=0;ke<me;ke++)xe+=ye.widths[ke]+o.gapButton;ne.enable(B,xe,Re),ne.hbar&&ne.hbar.attr("opacity","0").transition().attr("opacity","1"),ne.vbar&&ne.vbar.attr("opacity","0").transition().attr("opacity","1")}function m(Z){var Y=!!Z.hbar,X=!!Z.vbar;Y&&Z.hbar.transition().attr("opacity","0").each("end",function(){Y=!1,X||Z.disable()}),X&&Z.vbar.transition().attr("opacity","0").each("end",function(){X=!1,Y||Z.disable()})}function y(Z,Y,X,ne){Z.call(A,Y).call(R,Y,X,ne)}function A(Z,Y){var X=u.ensureSingle(Z,"rect",o.itemRectClassName,function(ne){ne.attr({rx:o.rx,ry:o.ry,"shape-rendering":"crispEdges"})});X.call(s.stroke,Y.bordercolor).call(s.fill,Y.bgcolor).style("stroke-width",Y.borderwidth+"px")}function R(Z,Y,X,ne){var ae=u.ensureSingle(Z,"text",o.itemTextClassName,function(se){se.attr({"text-anchor":"start","data-notex":1})}),B=X.label,ie=ne._fullLayout._meta;ie&&(B=u.templateString(B,ie)),ae.call(f.font,Y.font).text(B).call(h.convertToTspans,ne)}function N(Z,Y){var X=Y.active;Z.each(function(ne,ae){var B=d.select(this);ae===X&&Y.showactive&&B.select("rect."+o.itemRectClassName).call(s.fill,o.activeColor)})}function te(Z){Z.select("rect."+o.itemRectClassName).call(s.fill,o.hoverColor)}function H(Z,Y){Z.select("rect."+o.itemRectClassName).call(s.fill,Y.bgcolor)}function U(Z,Y){var X=Y._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},ne=f.tester.selectAll("g."+o.dropdownButtonClassName).data(u.filterVisible(Y.buttons));ne.enter().append("g").classed(o.dropdownButtonClassName,!0);var ae=["up","down"].indexOf(Y.direction)!==-1;ne.each(function(xe,Re){var ke=d.select(this);ke.call(y,Y,xe,Z);var Ie=ke.select("."+o.itemTextClassName),Q=Ie.node()&&f.bBox(Ie.node()).width,ee=Math.max(Q+o.textPadX,o.minWidth),D=Y.font.size*v,le=h.lineCount(Ie),ge=Math.max(D*le,o.minHeight)+o.textOffsetY;ge=Math.ceil(ge),ee=Math.ceil(ee),X.widths[Re]=ee,X.heights[Re]=ge,X.height1=Math.max(X.height1,ge),X.width1=Math.max(X.width1,ee),ae?(X.totalWidth=Math.max(X.totalWidth,ee),X.openWidth=X.totalWidth,X.totalHeight+=ge+o.gapButton,X.openHeight+=ge+o.gapButton):(X.totalWidth+=ee+o.gapButton,X.openWidth+=ee+o.gapButton,X.totalHeight=Math.max(X.totalHeight,ge),X.openHeight=X.totalHeight)}),ae?X.totalHeight-=o.gapButton:X.totalWidth-=o.gapButton,X.headerWidth=X.width1+o.arrowPadX,X.headerHeight=X.height1,Y.type==="dropdown"&&(ae?(X.width1+=o.arrowPadX,X.totalHeight=X.height1):X.totalWidth=X.width1,X.totalWidth+=o.arrowPadX),ne.remove();var B=X.totalWidth+Y.pad.l+Y.pad.r,ie=X.totalHeight+Y.pad.t+Y.pad.b,se=Z._fullLayout._size;X.lx=se.l+se.w*Y.x,X.ly=se.t+se.h*(1-Y.y);var ye="left";u.isRightAnchor(Y)&&(X.lx-=B,ye="right"),u.isCenterAnchor(Y)&&(X.lx-=B/2,ye="center");var me="top";u.isBottomAnchor(Y)&&(X.ly-=ie,me="bottom"),u.isMiddleAnchor(Y)&&(X.ly-=ie/2,me="middle"),X.totalWidth=Math.ceil(X.totalWidth),X.totalHeight=Math.ceil(X.totalHeight),X.lx=Math.round(X.lx),X.ly=Math.round(X.ly),i.autoMargin(Z,P(Y),{x:Y.x,y:Y.y,l:B*({right:1,center:.5}[ye]||0),r:B*({left:1,center:.5}[ye]||0),b:ie*({top:1,middle:.5}[me]||0),t:ie*({bottom:1,middle:.5}[me]||0)})}function P(Z){return o.autoMarginIdRoot+Z._index}function re(Z,Y,X,ne){ne=ne||{};var ae=Z.select("."+o.itemRectClassName),B=Z.select("."+o.itemTextClassName),ie=Y.borderwidth,se=X.index,ye=Y._dims;f.setTranslate(Z,ie+X.x,ie+X.y);var me=["up","down"].indexOf(Y.direction)!==-1,xe=ne.height||(me?ye.heights[se]:ye.height1);ae.attr({x:0,y:0,width:ne.width||(me?ye.width1:ye.widths[se]),height:xe});var Re=Y.font.size*v,ke=h.lineCount(B),Ie=(ke-1)*Re/2;h.positionText(B,o.textOffsetX,xe/2-Ie+o.textOffsetY),me?X.y+=ye.heights[se]+X.yPad:X.x+=ye.widths[se]+X.xPad,X.index++}function G(Z,Y){Z.attr(o.menuIndexAttrName,Y||"-1").selectAll("g."+o.dropdownButtonClassName).remove()}}),__=t((W,V)=>{var d=yf();V.exports={moduleType:"component",name:d.name,layoutAttributes:l1(),supplyLayoutDefaults:v_(),draw:x_()}}),dd=t((W,V)=>{V.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}}),c1=t((W,V)=>{var d=pt(),i=nn(),s=gt().extendDeepAll,f=Ft().overrideAll,u=Xn(),h=fn().templatedArray,p=dd(),v=h("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});V.exports=f(h("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:v,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:s(i({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:u.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:d({})},font:d({}),activebgcolor:{valType:"color",dflt:p.gripBgActiveColor},bgcolor:{valType:"color",dflt:p.railBgColor},bordercolor:{valType:"color",dflt:p.railBorderColor},borderwidth:{valType:"number",min:0,dflt:p.railBorderWidth},ticklen:{valType:"number",min:0,dflt:p.tickLength},tickcolor:{valType:"color",dflt:p.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:p.minorTickLength}}),"arraydraw","from-root")}),b_=t((W,V)=>{var d=Mt(),i=No(),s=c1(),f=dd(),u=f.name,h=s.steps;V.exports=function(o,w){i(o,w,{name:u,handleItemDefaults:p})};function p(o,w,g){function b(A,R){return d.coerce(o,w,s,A,R)}for(var L=i(o,w,{name:"steps",handleItemDefaults:v}),S=0,M=0;M<L.length;M++)L[M].visible&&S++;var T;if(S<2?T=w.visible=!1:T=b("visible"),!!T){w._stepCount=S;var C=w._visibleSteps=d.filterVisible(L),m=b("active");(L[m]||{}).visible||(w.active=C[0]._index),b("x"),b("y"),d.noneOrAll(o,w,["x","y"]),b("xanchor"),b("yanchor"),b("len"),b("lenmode"),b("pad.t"),b("pad.r"),b("pad.b"),b("pad.l"),d.coerceFont(b,"font",g.font);var y=b("currentvalue.visible");y&&(b("currentvalue.xanchor"),b("currentvalue.prefix"),b("currentvalue.suffix"),b("currentvalue.offset"),d.coerceFont(b,"currentvalue.font",w.font)),b("transition.duration"),b("transition.easing"),b("bgcolor"),b("activebgcolor"),b("bordercolor"),b("borderwidth"),b("ticklen"),b("tickwidth"),b("tickcolor"),b("minorticklen")}}function v(o,w){function g(S,M){return d.coerce(o,w,h,S,M)}var b;if(o.method!=="skip"&&!Array.isArray(o.args)?b=w.visible=!1:b=g("visible"),b){g("method"),g("args");var L=g("label","step-"+w._index);g("value",L),g("execute")}}}),w_=t((W,V)=>{var d=l(),i=pn(),s=Xt(),f=Ra(),u=Mt(),h=u.strTranslate,p=ja(),v=fn().arrayEditor,o=dd(),w=fi(),g=w.LINE_SPACING,b=w.FROM_TL,L=w.FROM_BR;V.exports=function(ae){var B=ae._context.staticPlot,ie=ae._fullLayout,se=M(ie,ae),ye=ie._infolayer.selectAll("g."+o.containerClassName).data(se.length>0?[0]:[]);ye.enter().append("g").classed(o.containerClassName,!0).style("cursor",B?null:"ew-resize");function me(Ie){Ie._commandObserver&&(Ie._commandObserver.remove(),delete Ie._commandObserver),i.autoMargin(ae,S(Ie))}if(ye.exit().each(function(){d.select(this).selectAll("g."+o.groupClassName).each(me)}).remove(),se.length!==0){var xe=ye.selectAll("g."+o.groupClassName).data(se,T);xe.enter().append("g").classed(o.groupClassName,!0),xe.exit().each(me).remove();for(var Re=0;Re<se.length;Re++){var ke=se[Re];C(ae,ke)}xe.each(function(Ie){var Q=d.select(this);re(Ie),i.manageCommandObserver(ae,Ie,Ie._visibleSteps,function(ee){var D=Q.data()[0];D.active!==ee.index&&(D._dragging||H(ae,Q,D,ee.index,!1,!0))}),m(ae,d.select(this),Ie)})}};function S(ae){return o.autoMarginIdRoot+ae._index}function M(ae,B){for(var ie=ae[o.name],se=[],ye=0;ye<ie.length;ye++){var me=ie[ye];me.visible&&(me._gd=B,se.push(me))}return se}function T(ae){return ae._index}function C(ae,B){var ie=f.tester.selectAll("g."+o.labelGroupClass).data(B._visibleSteps);ie.enter().append("g").classed(o.labelGroupClass,!0);var se=0,ye=0;ie.each(function(ge){var j=d.select(this),k=R(j,{step:ge},B),F=k.node();if(F){var J=f.bBox(F);ye=Math.max(ye,J.height),se=Math.max(se,J.width)}}),ie.remove();var me=B._dims={};me.inputAreaWidth=Math.max(o.railWidth,o.gripHeight);var xe=ae._fullLayout._size;me.lx=xe.l+xe.w*B.x,me.ly=xe.t+xe.h*(1-B.y),B.lenmode==="fraction"?me.outerLength=Math.round(xe.w*B.len):me.outerLength=B.len,me.inputAreaStart=0,me.inputAreaLength=Math.round(me.outerLength-B.pad.l-B.pad.r);var Re=me.inputAreaLength-2*o.stepInset,ke=Re/(B._stepCount-1),Ie=se+o.labelPadding;if(me.labelStride=Math.max(1,Math.ceil(Ie/ke)),me.labelHeight=ye,me.currentValueMaxWidth=0,me.currentValueHeight=0,me.currentValueTotalHeight=0,me.currentValueMaxLines=1,B.currentvalue.visible){var Q=f.tester.append("g");ie.each(function(ge){var j=y(Q,B,ge.label),k=j.node()&&f.bBox(j.node())||{width:0,height:0},F=p.lineCount(j);me.currentValueMaxWidth=Math.max(me.currentValueMaxWidth,Math.ceil(k.width)),me.currentValueHeight=Math.max(me.currentValueHeight,Math.ceil(k.height)),me.currentValueMaxLines=Math.max(me.currentValueMaxLines,F)}),me.currentValueTotalHeight=me.currentValueHeight+B.currentvalue.offset,Q.remove()}me.height=me.currentValueTotalHeight+o.tickOffset+B.ticklen+o.labelOffset+me.labelHeight+B.pad.t+B.pad.b;var ee="left";u.isRightAnchor(B)&&(me.lx-=me.outerLength,ee="right"),u.isCenterAnchor(B)&&(me.lx-=me.outerLength/2,ee="center");var D="top";u.isBottomAnchor(B)&&(me.ly-=me.height,D="bottom"),u.isMiddleAnchor(B)&&(me.ly-=me.height/2,D="middle"),me.outerLength=Math.ceil(me.outerLength),me.height=Math.ceil(me.height),me.lx=Math.round(me.lx),me.ly=Math.round(me.ly);var le={y:B.y,b:me.height*L[D],t:me.height*b[D]};B.lenmode==="fraction"?(le.l=0,le.xl=B.x-B.len*b[ee],le.r=0,le.xr=B.x+B.len*L[ee]):(le.x=B.x,le.l=me.outerLength*b[ee],le.r=me.outerLength*L[ee]),i.autoMargin(ae,S(B),le)}function m(ae,B,ie){(ie.steps[ie.active]||{}).visible||(ie.active=ie._visibleSteps[0]._index),B.call(y,ie).call(ne,ie).call(N,ie).call(P,ie).call(X,ae,ie).call(A,ae,ie);var se=ie._dims;f.setTranslate(B,se.lx+ie.pad.l,se.ly+ie.pad.t),B.call(G,ie,!1),B.call(y,ie)}function y(ae,B,ie){if(B.currentvalue.visible){var se=B._dims,ye,me;switch(B.currentvalue.xanchor){case"right":ye=se.inputAreaLength-o.currentValueInset-se.currentValueMaxWidth,me="left";break;case"center":ye=se.inputAreaLength*.5,me="middle";break;default:ye=o.currentValueInset,me="left"}var xe=u.ensureSingle(ae,"text",o.labelClass,function(D){D.attr({"text-anchor":me,"data-notex":1})}),Re=B.currentvalue.prefix?B.currentvalue.prefix:"";if(typeof ie=="string")Re+=ie;else{var ke=B.steps[B.active].label,Ie=B._gd._fullLayout._meta;Ie&&(ke=u.templateString(ke,Ie)),Re+=ke}B.currentvalue.suffix&&(Re+=B.currentvalue.suffix),xe.call(f.font,B.currentvalue.font).text(Re).call(p.convertToTspans,B._gd);var Q=p.lineCount(xe),ee=(se.currentValueMaxLines+1-Q)*B.currentvalue.font.size*g;return p.positionText(xe,ye,ee),xe}}function A(ae,B,ie){var se=u.ensureSingle(ae,"rect",o.gripRectClass,function(ye){ye.call(U,B,ae,ie).style("pointer-events","all")});se.attr({width:o.gripWidth,height:o.gripHeight,rx:o.gripRadius,ry:o.gripRadius}).call(s.stroke,ie.bordercolor).call(s.fill,ie.bgcolor).style("stroke-width",ie.borderwidth+"px")}function R(ae,B,ie){var se=u.ensureSingle(ae,"text",o.labelClass,function(xe){xe.attr({"text-anchor":"middle","data-notex":1})}),ye=B.step.label,me=ie._gd._fullLayout._meta;return me&&(ye=u.templateString(ye,me)),se.call(f.font,ie.font).text(ye).call(p.convertToTspans,ie._gd),se}function N(ae,B){var ie=u.ensureSingle(ae,"g",o.labelsClass),se=B._dims,ye=ie.selectAll("g."+o.labelGroupClass).data(se.labelSteps);ye.enter().append("g").classed(o.labelGroupClass,!0),ye.exit().remove(),ye.each(function(me){var xe=d.select(this);xe.call(R,me,B),f.setTranslate(xe,Z(B,me.fraction),o.tickOffset+B.ticklen+B.font.size*g+o.labelOffset+se.currentValueTotalHeight)})}function te(ae,B,ie,se,ye){var me=Math.round(se*(ie._stepCount-1)),xe=ie._visibleSteps[me]._index;xe!==ie.active&&H(ae,B,ie,xe,!0,ye)}function H(ae,B,ie,se,ye,me){var xe=ie.active;ie.active=se,v(ae.layout,o.name,ie).applyUpdate("active",se);var Re=ie.steps[ie.active];B.call(G,ie,me),B.call(y,ie),ae.emit("plotly_sliderchange",{slider:ie,step:ie.steps[ie.active],interaction:ye,previousActive:xe}),Re&&Re.method&&ye&&(B._nextMethod?(B._nextMethod.step=Re,B._nextMethod.doCallback=ye,B._nextMethod.doTransition=me):(B._nextMethod={step:Re,doCallback:ye,doTransition:me},B._nextMethodRaf=window.requestAnimationFrame(function(){var ke=B._nextMethod.step;ke.method&&(ke.execute&&i.executeAPICommand(ae,ke.method,ke.args),B._nextMethod=null,B._nextMethodRaf=null)})))}function U(ae,B,ie){if(B._context.staticPlot)return;var se=ie.node(),ye=d.select(B);function me(){return ie.data()[0]}function xe(){var Re=me();B.emit("plotly_sliderstart",{slider:Re});var ke=ie.select("."+o.gripRectClass);d.event.stopPropagation(),d.event.preventDefault(),ke.call(s.fill,Re.activebgcolor);var Ie=Y(Re,d.mouse(se)[0]);te(B,ie,Re,Ie,!0),Re._dragging=!0;function Q(){var D=me(),le=Y(D,d.mouse(se)[0]);te(B,ie,D,le,!1)}ye.on("mousemove",Q),ye.on("touchmove",Q);function ee(){var D=me();D._dragging=!1,ke.call(s.fill,D.bgcolor),ye.on("mouseup",null),ye.on("mousemove",null),ye.on("touchend",null),ye.on("touchmove",null),B.emit("plotly_sliderend",{slider:D,step:D.steps[D.active]})}ye.on("mouseup",ee),ye.on("touchend",ee)}ae.on("mousedown",xe),ae.on("touchstart",xe)}function P(ae,B){var ie=ae.selectAll("rect."+o.tickRectClass).data(B._visibleSteps),se=B._dims;ie.enter().append("rect").classed(o.tickRectClass,!0),ie.exit().remove(),ie.attr({width:B.tickwidth+"px","shape-rendering":"crispEdges"}),ie.each(function(ye,me){var xe=me%se.labelStride===0,Re=d.select(this);Re.attr({height:xe?B.ticklen:B.minorticklen}).call(s.fill,B.tickcolor),f.setTranslate(Re,Z(B,me/(B._stepCount-1))-.5*B.tickwidth,(xe?o.tickOffset:o.minorTickOffset)+se.currentValueTotalHeight)})}function re(ae){var B=ae._dims;B.labelSteps=[];for(var ie=ae._stepCount,se=0;se<ie;se+=B.labelStride)B.labelSteps.push({fraction:se/(ie-1),step:ae._visibleSteps[se]})}function G(ae,B,ie){for(var se=ae.select("rect."+o.gripRectClass),ye=0,me=0;me<B._stepCount;me++)if(B._visibleSteps[me]._index===B.active){ye=me;break}var xe=Z(B,ye/(B._stepCount-1));if(!B._invokingCommand){var Re=se;ie&&B.transition.duration>0&&(Re=Re.transition().duration(B.transition.duration).ease(B.transition.easing)),Re.attr("transform",h(xe-o.gripWidth*.5,B._dims.currentValueTotalHeight))}}function Z(ae,B){var ie=ae._dims;return ie.inputAreaStart+o.stepInset+(ie.inputAreaLength-2*o.stepInset)*Math.min(1,Math.max(0,B))}function Y(ae,B){var ie=ae._dims;return Math.min(1,Math.max(0,(B-o.stepInset-ie.inputAreaStart)/(ie.inputAreaLength-2*o.stepInset-2*ie.inputAreaStart)))}function X(ae,B,ie){var se=ie._dims,ye=u.ensureSingle(ae,"rect",o.railTouchRectClass,function(me){me.call(U,B,ae,ie).style("pointer-events","all")});ye.attr({width:se.inputAreaLength,height:Math.max(se.inputAreaWidth,o.tickOffset+ie.ticklen+se.labelHeight)}).call(s.fill,ie.bgcolor).attr("opacity",0),f.setTranslate(ye,0,se.currentValueTotalHeight)}function ne(ae,B){var ie=B._dims,se=ie.inputAreaLength-o.railInset*2,ye=u.ensureSingle(ae,"rect",o.railRectClass);ye.attr({width:se,height:o.railWidth,rx:o.railRadius,ry:o.railRadius,"shape-rendering":"crispEdges"}).call(s.stroke,B.bordercolor).call(s.fill,B.bgcolor).style("stroke-width",B.borderwidth+"px"),f.setTranslate(ye,o.railInset,(ie.inputAreaWidth-o.railWidth)*.5+ie.currentValueTotalHeight)}}),M_=t((W,V)=>{var d=dd();V.exports={moduleType:"component",name:d.name,layoutAttributes:c1(),supplyLayoutDefaults:b_(),draw:w_()}}),xf=t((W,V)=>{var d=Zt();V.exports={bgcolor:{valType:"color",dflt:d.background,editType:"plot"},bordercolor:{valType:"color",dflt:d.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}}),u1=t((W,V)=>{V.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}}),_f=t((W,V)=>{V.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}}),T_=t(W=>{var V=aa(),d=ja(),i=_f(),s=fi().LINE_SPACING,f=i.name;function u(h){var p=h&&h[f];return p&&p.visible}W.isVisible=u,W.makeData=function(h){for(var p=V.list({_fullLayout:h},"x",!0),v=h.margin,o=[],w=0;w<p.length;w++){var g=p[w];if(u(g)){o.push(g);var b=g[f];b._id=f+g._id,b._height=(h.height-v.b-v.t)*b.thickness,b._offsetShift=Math.floor(b.borderwidth/2)}}h._rangeSliderData=o},W.autoMarginOpts=function(h,p){var v=h._fullLayout,o=p[f],w=p._id.charAt(0),g=0,b=0;if(p.side==="bottom"&&(g=p._depth,p.title.text!==v._dfltTitle[w])){b=1.5*p.title.font.size+10+o._offsetShift;var L=(p.title.text.match(d.BR_TAG_ALL)||[]).length;b+=L*p.title.font.size*s}return{x:0,y:p._counterDomainMin,l:0,r:0,t:0,b:o._height+g+Math.max(v.margin.b,b),pad:i.extraPad+o._offsetShift*2}}}),A_=t((W,V)=>{var d=Mt(),i=fn(),s=aa(),f=xf(),u=u1();V.exports=function(h,p,v){var o=h[v],w=p[v];if(!(o.rangeslider||p._requestRangeslider[w._id]))return;d.isPlainObject(o.rangeslider)||(o.rangeslider={});var g=o.rangeslider,b=i.newContainer(w,"rangeslider");function L(P,re){return d.coerce(g,b,f,P,re)}var S,M;function T(P,re){return d.coerce(S,M,u,P,re)}var C=L("visible");if(C){L("bgcolor",p.plot_bgcolor),L("bordercolor"),L("borderwidth"),L("thickness"),L("autorange",!w.isValidRange(g.range)),L("range");var m=p._subplots;if(m)for(var y=m.cartesian.filter(function(P){return P.substr(0,P.indexOf("y"))===s.name2id(v)}).map(function(P){return P.substr(P.indexOf("y"),P.length)}),A=d.simpleMap(y,s.id2name),R=0;R<A.length;R++){var N=A[R];S=g[N]||{},M=i.newContainer(b,N,"yaxis");var te=p[N],H;S.range&&te.isValidRange(S.range)&&(H="fixed");var U=T("rangemode",H);U!=="match"&&T("range",te.range.slice())}b._input=g}}}),S_=t((W,V)=>{var d=aa().list,i=is().getAutoRange,s=_f();V.exports=function(f){for(var u=d(f,"x",!0),h=0;h<u.length;h++){var p=u[h],v=p[s.name];v&&v.visible&&v.autorange&&(v._input.autorange=!0,v._input.range=v.range=i(f,p))}}}),C_=t((W,V)=>{var d=l(),i=an(),s=pn(),f=Mt(),u=f.strTranslate,h=Ra(),p=Xt(),v=Hs(),o=mf(),w=aa(),g=Ot(),b=ar(),L=_f();V.exports=function(U){for(var P=U._fullLayout,re=P._rangeSliderData,G=0;G<re.length;G++){var Z=re[G][L.name];Z._clipId=Z._id+"-"+P._uid}function Y(ne){return ne._name}var X=P._infolayer.selectAll("g."+L.containerClassName).data(re,Y);X.exit().each(function(ne){var ae=ne[L.name];P._topdefs.select("#"+ae._clipId).remove()}).remove(),re.length!==0&&(X.enter().append("g").classed(L.containerClassName,!0).attr("pointer-events","all"),X.each(function(ne){var ae=d.select(this),B=ne[L.name],ie=P[w.id2name(ne.anchor)],se=B[w.id2name(ne.anchor)];if(B.range){var ye=f.simpleMap(B.range,ne.r2l),me=f.simpleMap(ne.range,ne.r2l),xe;me[0]<me[1]?xe=[Math.min(ye[0],me[0]),Math.max(ye[1],me[1])]:xe=[Math.max(ye[0],me[0]),Math.min(ye[1],me[1])],B.range=B._input.range=f.simpleMap(xe,ne.l2r)}ne.cleanRange("rangeslider.range");var Re=P._size,ke=ne.domain;B._width=Re.w*(ke[1]-ke[0]);var Ie=Math.round(Re.l+Re.w*ke[0]),Q=Math.round(Re.t+Re.h*(1-ne._counterDomainMin)+(ne.side==="bottom"?ne._depth:0)+B._offsetShift+L.extraPad);ae.attr("transform",u(Ie,Q)),B._rl=f.simpleMap(B.range,ne.r2l);var ee=B._rl[0],D=B._rl[1],le=D-ee;if(B.p2d=function(Fe){return Fe/B._width*le+ee},B.d2p=function(Fe){return(Fe-ee)/le*B._width},ne.rangebreaks){var ge=ne.locateBreaks(ee,D);if(ge.length){var j,k,F=0;for(j=0;j<ge.length;j++)k=ge[j],F+=k.max-k.min;var J=B._width/(D-ee-F),K=[-J*ee];for(j=0;j<ge.length;j++)k=ge[j],K.push(K[K.length-1]-J*(k.max-k.min));for(B.d2p=function(Fe){for(var Ge=K[0],rt=0;rt<ge.length;rt++){var bt=ge[rt];if(Fe>=bt.max)Ge=K[rt+1];else if(Fe<bt.min)break}return Ge+J*Fe},j=0;j<ge.length;j++)k=ge[j],k.pmin=B.d2p(k.min),k.pmax=B.d2p(k.max);B.p2d=function(Fe){for(var Ge=K[0],rt=0;rt<ge.length;rt++){var bt=ge[rt];if(Fe>=bt.pmax)Ge=K[rt+1];else if(Fe<bt.pmin)break}return(Fe-Ge)/J}}}if(se.rangemode!=="match"){var ve=ie.r2l(se.range[0]),Te=ie.r2l(se.range[1]),Ae=Te-ve;B.d2pOppAxis=function(Fe){return(Fe-ve)/Ae*B._height}}ae.call(m,U,ne,B).call(y,U,ne,B).call(A,U,ne,B).call(N,U,ne,B,se).call(te,U,ne,B).call(H,U,ne,B),M(ae,U,ne,B),C(ae,U,ne,B,ie,se),ne.side==="bottom"&&v.draw(U,ne._id+"title",{propContainer:ne,propName:ne._name+".title.text",placeholder:P._dfltTitle.x,attributes:{x:ne._offset+ne._length/2,y:Q+B._height+B._offsetShift+10+1.5*ne.title.font.size,"text-anchor":"middle"}})}))};function S(U){return typeof U.clientX=="number"?U.clientX:U.touches&&U.touches.length>0?U.touches[0].clientX:0}function M(U,P,re,G){if(P._context.staticPlot)return;var Z=U.select("rect."+L.slideBoxClassName).node(),Y=U.select("rect."+L.grabAreaMinClassName).node(),X=U.select("rect."+L.grabAreaMaxClassName).node();function ne(){var ae=d.event,B=ae.target,ie=S(ae),se=ie-U.node().getBoundingClientRect().left,ye=G.d2p(re._rl[0]),me=G.d2p(re._rl[1]),xe=g.coverSlip();this.addEventListener("touchmove",Re),this.addEventListener("touchend",ke),xe.addEventListener("mousemove",Re),xe.addEventListener("mouseup",ke);function Re(Ie){var Q=S(Ie),ee=+Q-ie,D,le,ge;switch(B){case Z:if(ge="ew-resize",ye+ee>re._length||me+ee<0)return;D=ye+ee,le=me+ee;break;case Y:if(ge="col-resize",ye+ee>re._length)return;D=ye+ee,le=me;break;case X:if(ge="col-resize",me+ee<0)return;D=ye,le=me+ee;break;default:ge="ew-resize",D=se,le=se+ee;break}if(le<D){var j=le;le=D,D=j}G._pixelMin=D,G._pixelMax=le,b(d.select(xe),ge),T(U,P,re,G)}function ke(){xe.removeEventListener("mousemove",Re),xe.removeEventListener("mouseup",ke),this.removeEventListener("touchmove",Re),this.removeEventListener("touchend",ke),f.removeElement(xe)}}U.on("mousedown",ne),U.on("touchstart",ne)}function T(U,P,re,G){function Z(ne){return re.l2r(f.constrain(ne,G._rl[0],G._rl[1]))}var Y=Z(G.p2d(G._pixelMin)),X=Z(G.p2d(G._pixelMax));window.requestAnimationFrame(function(){i.call("_guiRelayout",P,re._name+".range",[Y,X])})}function C(U,P,re,G,Z,Y){var X=L.handleWidth/2;function ne(Ie){return f.constrain(Ie,0,G._width)}function ae(Ie){return f.constrain(Ie,0,G._height)}function B(Ie){return f.constrain(Ie,-X,G._width+X)}var ie=ne(G.d2p(re._rl[0])),se=ne(G.d2p(re._rl[1]));if(U.select("rect."+L.slideBoxClassName).attr("x",ie).attr("width",se-ie),U.select("rect."+L.maskMinClassName).attr("width",ie),U.select("rect."+L.maskMaxClassName).attr("x",se).attr("width",G._width-se),Y.rangemode!=="match"){var ye=G._height-ae(G.d2pOppAxis(Z._rl[1])),me=G._height-ae(G.d2pOppAxis(Z._rl[0]));U.select("rect."+L.maskMinOppAxisClassName).attr("x",ie).attr("height",ye).attr("width",se-ie),U.select("rect."+L.maskMaxOppAxisClassName).attr("x",ie).attr("y",me).attr("height",G._height-me).attr("width",se-ie),U.select("rect."+L.slideBoxClassName).attr("y",ye).attr("height",me-ye)}var xe=.5,Re=Math.round(B(ie-X))-xe,ke=Math.round(B(se-X))+xe;U.select("g."+L.grabberMinClassName).attr("transform",u(Re,xe)),U.select("g."+L.grabberMaxClassName).attr("transform",u(ke,xe))}function m(U,P,re,G){var Z=f.ensureSingle(U,"rect",L.bgClassName,function(ae){ae.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),Y=G.borderwidth%2===0?G.borderwidth:G.borderwidth-1,X=-G._offsetShift,ne=h.crispRound(P,G.borderwidth);Z.attr({width:G._width+Y,height:G._height+Y,transform:u(X,X),"stroke-width":ne}).call(p.stroke,G.bordercolor).call(p.fill,G.bgcolor)}function y(U,P,re,G){var Z=P._fullLayout,Y=f.ensureSingleById(Z._topdefs,"clipPath",G._clipId,function(X){X.append("rect").attr({x:0,y:0})});Y.select("rect").attr({width:G._width,height:G._height})}function A(U,P,re,G){var Z=P.calcdata,Y=U.selectAll("g."+L.rangePlotClassName).data(re._subplotsWith,f.identity);Y.enter().append("g").attr("class",function(ne){return L.rangePlotClassName+" "+ne}).call(h.setClipUrl,G._clipId,P),Y.order(),Y.exit().remove();var X;Y.each(function(ne,ae){var B=d.select(this),ie=ae===0,se=w.getFromId(P,ne,"y"),ye=se._name,me=G[ye],xe={data:[],layout:{xaxis:{type:re.type,domain:[0,1],range:G.range.slice(),calendar:re.calendar},width:G._width,height:G._height,margin:{t:0,b:0,l:0,r:0}},_context:P._context};re.rangebreaks&&(xe.layout.xaxis.rangebreaks=re.rangebreaks),xe.layout[ye]={type:se.type,domain:[0,1],range:me.rangemode!=="match"?me.range.slice():se.range.slice(),calendar:se.calendar},se.rangebreaks&&(xe.layout[ye].rangebreaks=se.rangebreaks),s.supplyDefaults(xe);var Re=xe._fullLayout.xaxis,ke=xe._fullLayout[ye];Re.clearCalc(),Re.setScale(),ke.clearCalc(),ke.setScale();var Ie={id:ne,plotgroup:B,xaxis:Re,yaxis:ke,isRangePlot:!0};ie?X=Ie:(Ie.mainplot="xy",Ie.mainplotinfo=X),o.rangePlot(P,Ie,R(Z,ne))})}function R(U,P){for(var re=[],G=0;G<U.length;G++){var Z=U[G],Y=Z[0].trace;Y.xaxis+Y.yaxis===P&&re.push(Z)}return re}function N(U,P,re,G,Z){var Y=f.ensureSingle(U,"rect",L.maskMinClassName,function(B){B.attr({x:0,y:0,"shape-rendering":"crispEdges"})});Y.attr("height",G._height).call(p.fill,L.maskColor);var X=f.ensureSingle(U,"rect",L.maskMaxClassName,function(B){B.attr({y:0,"shape-rendering":"crispEdges"})});if(X.attr("height",G._height).call(p.fill,L.maskColor),Z.rangemode!=="match"){var ne=f.ensureSingle(U,"rect",L.maskMinOppAxisClassName,function(B){B.attr({y:0,"shape-rendering":"crispEdges"})});ne.attr("width",G._width).call(p.fill,L.maskOppAxisColor);var ae=f.ensureSingle(U,"rect",L.maskMaxOppAxisClassName,function(B){B.attr({y:0,"shape-rendering":"crispEdges"})});ae.attr("width",G._width).style("border-top",L.maskOppBorder).call(p.fill,L.maskOppAxisColor)}}function te(U,P,re,G){if(!P._context.staticPlot){var Z=f.ensureSingle(U,"rect",L.slideBoxClassName,function(Y){Y.attr({y:0,cursor:L.slideBoxCursor,"shape-rendering":"crispEdges"})});Z.attr({height:G._height,fill:L.slideBoxFill})}}function H(U,P,re,G){var Z=f.ensureSingle(U,"g",L.grabberMinClassName),Y=f.ensureSingle(U,"g",L.grabberMaxClassName),X={x:0,width:L.handleWidth,rx:L.handleRadius,fill:p.background,stroke:p.defaultLine,"stroke-width":L.handleStrokeWidth,"shape-rendering":"crispEdges"},ne={y:Math.round(G._height/4),height:Math.round(G._height/2)},ae=f.ensureSingle(Z,"rect",L.handleMinClassName,function(me){me.attr(X)});ae.attr(ne);var B=f.ensureSingle(Y,"rect",L.handleMaxClassName,function(me){me.attr(X)});B.attr(ne);var ie={width:L.grabAreaWidth,x:0,y:0,fill:L.grabAreaFill,cursor:P._context.staticPlot?void 0:L.grabAreaCursor},se=f.ensureSingle(Z,"rect",L.grabAreaMinClassName,function(me){me.attr(ie)});se.attr("height",G._height);var ye=f.ensureSingle(Y,"rect",L.grabAreaMaxClassName,function(me){me.attr(ie)});ye.attr("height",G._height)}}),E_=t((W,V)=>{var d=Mt(),i=xf(),s=u1(),f=T_();V.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:d.extendFlat({},i,{yaxis:s})}}},layoutAttributes:xf(),handleDefaults:A_(),calcAutorange:S_(),draw:C_(),isVisible:f.isVisible,makeData:f.makeData,autoMarginOpts:f.autoMarginOpts}}),bf=t((W,V)=>{var d=pt(),i=Zt(),s=fn().templatedArray,f=s("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});V.exports={visible:{valType:"boolean",editType:"plot"},buttons:f,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:d({editType:"plot"}),bgcolor:{valType:"color",dflt:i.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:i.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}}),d1=t((W,V)=>{V.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}}),L_=t((W,V)=>{var d=Mt(),i=Xt(),s=fn(),f=No(),u=bf(),h=d1();V.exports=function(o,w,g,b,L){var S=o.rangeselector||{},M=s.newContainer(w,"rangeselector");function T(R,N){return d.coerce(S,M,u,R,N)}var C=f(S,M,{name:"buttons",handleItemDefaults:p,calendar:L}),m=T("visible",C.length>0);if(m){var y=v(w,g,b);T("x",y[0]),T("y",y[1]),d.noneOrAll(o,w,["x","y"]),T("xanchor"),T("yanchor"),d.coerceFont(T,"font",g.font);var A=T("bgcolor");T("activecolor",i.contrast(A,h.lightAmount,h.darkAmount)),T("bordercolor"),T("borderwidth")}};function p(o,w,g,b){var L=b.calendar;function S(C,m){return d.coerce(o,w,u.buttons,C,m)}var M=S("visible");if(M){var T=S("step");T!=="all"&&(L&&L!=="gregorian"&&(T==="month"||T==="year")?w.stepmode="backward":S("stepmode"),S("count")),S("label")}}function v(o,w,g){for(var b=g.filter(function(T){return w[T].anchor===o._id}),L=0,S=0;S<b.length;S++){var M=w[b[S]].domain;M&&(L=Math.max(M[1],L))}return[o.domain[0],L+h.yPad]}}),R_=t((W,V)=>{var d=x(),i=Mt().titleCase;V.exports=function(f,u){var h=f._name,p={};if(u.step==="all")p[h+".autorange"]=!0;else{var v=s(f,u);p[h+".range[0]"]=v[0],p[h+".range[1]"]=v[1]}return p};function s(f,u){var h=f.range,p=new Date(f.r2l(h[1])),v=u.step,o=d["utc"+i(v)],w=u.count,g;switch(u.stepmode){case"backward":g=f.l2r(+o.offset(p,-w));break;case"todate":var b=o.offset(p,-w);g=f.l2r(+o.ceil(b));break}var L=h[1];return[g,L]}}),k_=t((W,V)=>{var d=l(),i=an(),s=pn(),f=Xt(),u=Ra(),h=Mt(),p=h.strTranslate,v=ja(),o=aa(),w=fi(),g=w.LINE_SPACING,b=w.FROM_TL,L=w.FROM_BR,S=d1(),M=R_();V.exports=function(H){var U=H._fullLayout,P=U._infolayer.selectAll(".rangeselector").data(T(H),C);P.enter().append("g").classed("rangeselector",!0),P.exit().remove(),P.style({cursor:"pointer","pointer-events":"all"}),P.each(function(re){var G=d.select(this),Z=re,Y=Z.rangeselector,X=G.selectAll("g.button").data(h.filterVisible(Y.buttons));X.enter().append("g").classed("button",!0),X.exit().remove(),X.each(function(ne){var ae=d.select(this),B=M(Z,ne);ne._isActive=m(Z,ne,B),ae.call(y,Y,ne),ae.call(R,Y,ne,H),ae.on("click",function(){H._dragged||i.call("_guiRelayout",H,B)}),ae.on("mouseover",function(){ne._isHovered=!0,ae.call(y,Y,ne)}),ae.on("mouseout",function(){ne._isHovered=!1,ae.call(y,Y,ne)})}),te(H,X,Y,Z._name,G)})};function T(H){for(var U=o.list(H,"x",!0),P=[],re=0;re<U.length;re++){var G=U[re];G.rangeselector&&G.rangeselector.visible&&P.push(G)}return P}function C(H){return H._id}function m(H,U,P){if(U.step==="all")return H.autorange===!0;var re=Object.keys(P);return H.range[0]===P[re[0]]&&H.range[1]===P[re[1]]}function y(H,U,P){var re=h.ensureSingle(H,"rect","selector-rect",function(G){G.attr("shape-rendering","crispEdges")});re.attr({rx:S.rx,ry:S.ry}),re.call(f.stroke,U.bordercolor).call(f.fill,A(U,P)).style("stroke-width",U.borderwidth+"px")}function A(H,U){return U._isActive||U._isHovered?H.activecolor:H.bgcolor}function R(H,U,P,re){function G(Y){v.convertToTspans(Y,re)}var Z=h.ensureSingle(H,"text","selector-text",function(Y){Y.attr("text-anchor","middle")});Z.call(u.font,U.font).text(N(P,re._fullLayout._meta)).call(G)}function N(H,U){return H.label?U?h.templateString(H.label,U):H.label:H.step==="all"?"all":H.count+H.step.charAt(0)}function te(H,U,P,re,G){var Z=0,Y=0,X=P.borderwidth;U.each(function(){var ye=d.select(this),me=ye.select(".selector-text"),xe=P.font.size*g,Re=Math.max(xe*v.lineCount(me),16)+3;Y=Math.max(Y,Re)}),U.each(function(){var ye=d.select(this),me=ye.select(".selector-rect"),xe=ye.select(".selector-text"),Re=xe.node()&&u.bBox(xe.node()).width,ke=P.font.size*g,Ie=v.lineCount(xe),Q=Math.max(Re+10,S.minButtonWidth);ye.attr("transform",p(X+Z,X)),me.attr({x:0,y:0,width:Q,height:Y}),v.positionText(xe,Q/2,Y/2-(Ie-1)*ke/2+3),Z+=Q+5});var ne=H._fullLayout._size,ae=ne.l+ne.w*P.x,B=ne.t+ne.h*(1-P.y),ie="left";h.isRightAnchor(P)&&(ae-=Z,ie="right"),h.isCenterAnchor(P)&&(ae-=Z/2,ie="center");var se="top";h.isBottomAnchor(P)&&(B-=Y,se="bottom"),h.isMiddleAnchor(P)&&(B-=Y/2,se="middle"),Z=Math.ceil(Z),Y=Math.ceil(Y),ae=Math.round(ae),B=Math.round(B),s.autoMargin(H,re+"-range-selector",{x:P.x,y:P.y,l:Z*b[ie],r:Z*L[ie],b:Y*L[se],t:Y*b[se]}),G.attr("transform",p(ae,B))}}),P_=t((W,V)=>{V.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:bf()}}},layoutAttributes:bf(),handleDefaults:L_(),draw:k_()}}),wf=t(W=>{var V=gt().extendFlat;W.attributes=function(d,i){d=d||{},i=i||{};var s={valType:"info_array",editType:d.editType,items:[{valType:"number",min:0,max:1,editType:d.editType},{valType:"number",min:0,max:1,editType:d.editType}],dflt:[0,1]};d.name&&d.name+"",d.trace,i.description&&""+i.description;var f={x:V({},s,{}),y:V({},s,{}),editType:d.editType};return d.noGridCell||(f.row={valType:"integer",min:0,dflt:0,editType:d.editType},f.column={valType:"integer",min:0,dflt:0,editType:d.editType}),f},W.defaults=function(d,i,s,f){var u=f&&f.x||[0,1],h=f&&f.y||[0,1],p=i.grid;if(p){var v=s("domain.column");v!==void 0&&(v<p.columns?u=p._domains.x[v]:delete d.domain.column);var o=s("domain.row");o!==void 0&&(o<p.rows?h=p._domains.y[o]:delete d.domain.row)}var w=s("domain.x",u),g=s("domain.y",h);w[0]<w[1]||(d.domain.x=u.slice()),g[0]<g[1]||(d.domain.y=h.slice())}}),O_=t((W,V)=>{var d=Mt(),i=cr().counter,s=wf().attributes,f=kn().idRegex,u=fn(),h={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[i("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[f.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[f.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:s({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function p(b,L,S){var M=L[S+"axes"],T=Object.keys((b._splomAxes||{})[S]||{});if(Array.isArray(M))return M;if(T.length)return T}function v(b,L){var S=b.grid||{},M=p(L,S,"x"),T=p(L,S,"y");if(!b.grid&&!M&&!T)return;var C=Array.isArray(S.subplots)&&Array.isArray(S.subplots[0]),m=Array.isArray(M),y=Array.isArray(T),A=m&&M!==S.xaxes&&y&&T!==S.yaxes,R,N;C?(R=S.subplots.length,N=S.subplots[0].length):(y&&(R=T.length),m&&(N=M.length));var te=u.newContainer(L,"grid");function H(B,ie){return d.coerce(S,te,h,B,ie)}var U=H("rows",R),P=H("columns",N);if(!(U*P>1)){delete L.grid;return}if(!C&&!m&&!y){var re=H("pattern")==="independent";re&&(C=!0)}te._hasSubplotGrid=C;var G=H("roworder"),Z=G==="top to bottom",Y=C?.2:.1,X=C?.3:.1,ne,ae;A&&L._splomGridDflt&&(ne=L._splomGridDflt.xside,ae=L._splomGridDflt.yside),te._domains={x:o("x",H,Y,ne,P),y:o("y",H,X,ae,U,Z)}}function o(b,L,S,M,T,C){var m=L(b+"gap",S),y=L("domain."+b);L(b+"side",M);for(var A=new Array(T),R=y[0],N=(y[1]-R)/(T-m),te=N*(1-m),H=0;H<T;H++){var U=R+N*H;A[C?T-1-H:H]=[U,U+te]}return A}function w(b,L){var S=L.grid;if(!(!S||!S._domains)){var M=b.grid||{},T=L._subplots,C=S._hasSubplotGrid,m=S.rows,y=S.columns,A=S.pattern==="independent",R,N,te,H,U,P,re,G=S._axisMap={};if(C){var Z=M.subplots||[];P=S.subplots=new Array(m);var Y=1;for(R=0;R<m;R++){var X=P[R]=new Array(y),ne=Z[R]||[];for(N=0;N<y;N++)if(A?(U=Y===1?"xy":"x"+Y+"y"+Y,Y++):U=ne[N],X[N]="",T.cartesian.indexOf(U)!==-1){if(re=U.indexOf("y"),te=U.slice(0,re),H=U.slice(re),G[te]!==void 0&&G[te]!==N||G[H]!==void 0&&G[H]!==R)continue;X[N]=U,G[te]=N,G[H]=R}}}else{var ae=p(L,M,"x"),B=p(L,M,"y");S.xaxes=g(ae,T.xaxis,y,G,"x"),S.yaxes=g(B,T.yaxis,m,G,"y")}var ie=S._anchors={},se=S.roworder==="top to bottom";for(var ye in G){var me=ye.charAt(0),xe=S[me+"side"],Re,ke,Ie;if(xe.length<8)ie[ye]="free";else if(me==="x"){if(xe.charAt(0)==="t"===se?(Re=0,ke=1,Ie=m):(Re=m-1,ke=-1,Ie=-1),C){var Q=G[ye];for(R=Re;R!==Ie;R+=ke)if(U=P[R][Q],!!U&&(re=U.indexOf("y"),U.slice(0,re)===ye)){ie[ye]=U.slice(re);break}}else for(R=Re;R!==Ie;R+=ke)if(H=S.yaxes[R],T.cartesian.indexOf(ye+H)!==-1){ie[ye]=H;break}}else if(xe.charAt(0)==="l"?(Re=0,ke=1,Ie=y):(Re=y-1,ke=-1,Ie=-1),C){var ee=G[ye];for(R=Re;R!==Ie;R+=ke)if(U=P[ee][R],!!U&&(re=U.indexOf("y"),U.slice(re)===ye)){ie[ye]=U.slice(0,re);break}}else for(R=Re;R!==Ie;R+=ke)if(te=S.xaxes[R],T.cartesian.indexOf(te+ye)!==-1){ie[ye]=te;break}}}}function g(b,L,S,M,T){var C=new Array(S),m;function y(A,R){L.indexOf(R)!==-1&&M[R]===void 0?(C[A]=R,M[R]=A):C[A]=""}if(Array.isArray(b))for(m=0;m<S;m++)y(m,b[m]);else for(y(0,T),m=1;m<S;m++)y(m,T+(m+1));return C}V.exports={moduleType:"component",name:"grid",schema:{layout:{grid:h}},layoutAttributes:h,sizeDefaults:v,contentDefaults:w}}),h1=t((W,V)=>{V.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc"}}),N_=t((W,V)=>{var d=q(),i=an(),s=Mt(),f=fn(),u=h1();V.exports=function(h,p,v,o){var w="error_"+o.axis,g=f.newContainer(p,w),b=h[w]||{};function L(A,R){return s.coerce(b,g,u,A,R)}var S=b.array!==void 0||b.value!==void 0||b.type==="sqrt",M=L("visible",S);if(M!==!1){var T=L("type","array"in b?"data":"percent"),C=!0;T!=="sqrt"&&(C=L("symmetric",!((T==="data"?"arrayminus":"valueminus")in b))),T==="data"?(L("array"),L("traceref"),C||(L("arrayminus"),L("tracerefminus"))):(T==="percent"||T==="constant")&&(L("value"),C||L("valueminus"));var m="copy_"+o.inherit+"style";if(o.inherit){var y=p["error_"+o.inherit];(y||{}).visible&&L(m,!(b.color||d(b.thickness)||d(b.width)))}(!o.inherit||!g[m])&&(L("color",v),L("thickness"),L("width",i.traceIs(p,"gl3d")?0:4))}}}),f1=t((W,V)=>{V.exports=function(i){var s=i.type,f=i.symmetric;if(s==="data"){var u=i.array||[];if(f)return function(o,w){var g=+u[w];return[g,g]};var h=i.arrayminus||[];return function(o,w){var g=+u[w],b=+h[w];return!isNaN(g)||!isNaN(b)?[b||0,g||0]:[NaN,NaN]}}else{var p=d(s,i.value),v=d(s,i.valueminus);return f||i.valueminus===void 0?function(o){var w=p(o);return[w,w]}:function(o){return[v(o),p(o)]}}};function d(i,s){if(i==="percent")return function(f){return Math.abs(f*s/100)};if(i==="constant")return function(){return Math.abs(s)};if(i==="sqrt")return function(f){return Math.sqrt(Math.abs(f))}}}),D_=t((W,V)=>{var d=q(),i=an(),s=Ja(),f=Mt(),u=f1();V.exports=function(p){for(var v=p.calcdata,o=0;o<v.length;o++){var w=v[o],g=w[0].trace;if(g.visible===!0&&i.traceIs(g,"errorBarsOK")){var b=s.getFromId(p,g.xaxis),L=s.getFromId(p,g.yaxis);h(w,g,b,"x"),h(w,g,L,"y")}}};function h(p,v,o,w){var g=v["error_"+w]||{},b=g.visible&&["linear","log"].indexOf(o.type)!==-1,L=[];if(b){for(var S=u(g),M=0;M<p.length;M++){var T=p[M],C=T.i;if(C===void 0)C=M;else if(C===null)continue;var m=T[w];if(d(o.c2l(m))){var y=S(m,C);if(d(y[0])&&d(y[1])){var A=T[w+"s"]=m-y[0],R=T[w+"h"]=m+y[1];L.push(A,R)}}}var N=o._id,te=v._extremes[N],H=s.findExtremes(o,L,f.extendFlat({tozero:te.opts.tozero},{padded:!0}));te.min=te.min.concat(H.min),te.max=te.max.concat(H.max)}}}),I_=t((W,V)=>{var d=l(),i=q(),s=Ra(),f=Ki();V.exports=function(h,p,v,o){var w,g=v.xaxis,b=v.yaxis,L=o&&o.duration>0,S=h._context.staticPlot;p.each(function(M){var T=M[0].trace,C=T.error_x||{},m=T.error_y||{},y;T.ids&&(y=function(te){return te.id});var A=f.hasMarkers(T)&&T.marker.maxdisplayed>0;!m.visible&&!C.visible&&(M=[]);var R=d.select(this).selectAll("g.errorbar").data(M,y);if(R.exit().remove(),!!M.length){C.visible||R.selectAll("path.xerror").remove(),m.visible||R.selectAll("path.yerror").remove(),R.style("opacity",1);var N=R.enter().append("g").classed("errorbar",!0);L&&N.style("opacity",0).transition().duration(o.duration).style("opacity",1),s.setClipUrl(R,v.layerClipId,h),R.each(function(te){var H=d.select(this),U=u(te,g,b);if(!(A&&!te.vis)){var P,re=H.select("path.yerror");if(m.visible&&i(U.x)&&i(U.yh)&&i(U.ys)){var G=m.width;P="M"+(U.x-G)+","+U.yh+"h"+2*G+"m-"+G+",0V"+U.ys,U.noYS||(P+="m-"+G+",0h"+2*G),w=!re.size(),w?re=H.append("path").style("vector-effect",S?"none":"non-scaling-stroke").classed("yerror",!0):L&&(re=re.transition().duration(o.duration).ease(o.easing)),re.attr("d",P)}else re.remove();var Z=H.select("path.xerror");if(C.visible&&i(U.y)&&i(U.xh)&&i(U.xs)){var Y=(C.copy_ystyle?m:C).width;P="M"+U.xh+","+(U.y-Y)+"v"+2*Y+"m0,-"+Y+"H"+U.xs,U.noXS||(P+="m0,-"+Y+"v"+2*Y),w=!Z.size(),w?Z=H.append("path").style("vector-effect",S?"none":"non-scaling-stroke").classed("xerror",!0):L&&(Z=Z.transition().duration(o.duration).ease(o.easing)),Z.attr("d",P)}else Z.remove()}})}})};function u(h,p,v){var o={x:p.c2p(h.x),y:v.c2p(h.y)};return h.yh!==void 0&&(o.yh=v.c2p(h.yh),o.ys=v.c2p(h.ys),i(o.ys)||(o.noYS=!0,o.ys=v.c2p(h.ys,!0))),h.xh!==void 0&&(o.xh=p.c2p(h.xh),o.xs=p.c2p(h.xs),i(o.xs)||(o.noXS=!0,o.xs=p.c2p(h.xs,!0))),o}}),z_=t((W,V)=>{var d=l(),i=Xt();V.exports=function(s){s.each(function(f){var u=f[0].trace,h=u.error_y||{},p=u.error_x||{},v=d.select(this);v.selectAll("path.yerror").style("stroke-width",h.thickness+"px").call(i.stroke,h.color),p.copy_ystyle&&(p=h),v.selectAll("path.xerror").style("stroke-width",p.thickness+"px").call(i.stroke,p.color)})}}),F_=t((W,V)=>{var d=Mt(),i=Ft().overrideAll,s=h1(),f={error_x:d.extendFlat({},s),error_y:d.extendFlat({},s)};delete f.error_x.copy_zstyle,delete f.error_y.copy_zstyle,delete f.error_y.copy_ystyle;var u={error_x:d.extendFlat({},s),error_y:d.extendFlat({},s),error_z:d.extendFlat({},s)};delete u.error_x.copy_ystyle,delete u.error_y.copy_ystyle,delete u.error_z.copy_ystyle,delete u.error_z.copy_zstyle,V.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:f,bar:f,histogram:f,scatter3d:i(u,"calc","nested"),scattergl:i(f,"calc","nested")}},supplyDefaults:N_(),calc:D_(),makeComputeError:f1(),plot:I_(),style:z_(),hoverInfo:h};function h(p,v,o){(v.error_y||{}).visible&&(o.yerr=p.yh-p.y,v.error_y.symmetric||(o.yerrneg=p.y-p.ys)),(v.error_x||{}).visible&&(o.xerr=p.xh-p.x,v.error_x.symmetric||(o.xerrneg=p.x-p.xs))}}),U_=t((W,V)=>{V.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}}),B_=t((W,V)=>{var d=l(),i=ft(),s=pn(),f=an(),u=Ja(),h=Ot(),p=Mt(),v=p.strTranslate,o=gt().extendFlat,w=ar(),g=Ra(),b=Xt(),L=Hs(),S=ja(),M=Di().flipScale,T=n1(),C=a1(),m=to(),y=fi(),A=y.LINE_SPACING,R=y.FROM_TL,N=y.FROM_BR,te=U_().cn;function H(Y){var X=Y._fullLayout,ne=X._infolayer.selectAll("g."+te.colorbar).data(U(Y),function(ae){return ae._id});ne.enter().append("g").attr("class",function(ae){return ae._id}).classed(te.colorbar,!0),ne.each(function(ae){var B=d.select(this);p.ensureSingle(B,"rect",te.cbbg),p.ensureSingle(B,"g",te.cbfills),p.ensureSingle(B,"g",te.cblines),p.ensureSingle(B,"g",te.cbaxis,function(se){se.classed(te.crisp,!0)}),p.ensureSingle(B,"g",te.cbtitleunshift,function(se){se.append("g").classed(te.cbtitle,!0)}),p.ensureSingle(B,"rect",te.cboutline);var ie=P(B,ae,Y);ie&&ie.then&&(Y._promises||[]).push(ie),Y._context.edits.colorbarPosition&&re(B,ae,Y)}),ne.exit().each(function(ae){s.autoMargin(Y,ae._id)}).remove(),ne.order()}function U(Y){var X=Y._fullLayout,ne=Y.calcdata,ae=[],B,ie,se,ye;function me(k){return o(k,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function xe(){typeof ye.calc=="function"?ye.calc(Y,se,B):(B._fillgradient=ie.reversescale?M(ie.colorscale):ie.colorscale,B._zrange=[ie[ye.min],ie[ye.max]])}for(var Re=0;Re<ne.length;Re++){var ke=ne[Re];if(se=ke[0].trace,!!se._module){var Ie=se._module.colorbar;if(se.visible===!0&&Ie)for(var Q=Array.isArray(Ie),ee=Q?Ie:[Ie],D=0;D<ee.length;D++){ye=ee[D];var le=ye.container;ie=le?se[le]:se,ie&&ie.showscale&&(B=me(ie.colorbar),B._id="cb"+se.uid+(Q&&le?"-"+le:""),B._traceIndex=se.index,B._propPrefix=(le?le+".":"")+"colorbar.",B._meta=se._meta,xe(),ae.push(B))}}}for(var ge in X._colorAxes)if(ie=X[ge],ie.showscale){var j=X._colorAxes[ge];B=me(ie.colorbar),B._id="cb"+ge,B._propPrefix=ge+".colorbar.",B._meta=X._meta,ye={min:"cmin",max:"cmax"},j[0]!=="heatmap"&&(se=j[1],ye.calc=se._module.colorbar.calc),xe(),ae.push(B)}return ae}function P(Y,X,ne){var ae=X.orientation==="v",B=X.len,ie=X.lenmode,se=X.thickness,ye=X.thicknessmode,me=X.outlinewidth,xe=X.borderwidth,Re=X.bgcolor,ke=X.xanchor,Ie=X.yanchor,Q=X.xpad,ee=X.ypad,D=X.x,le=ae?X.y:1-X.y,ge=X.yref==="paper",j=X.xref==="paper",k=ne._fullLayout,F=k._size,J=X._fillcolor,K=X._line,ve=X.title,Te=ve.side,Ae=X._zrange||d.extent((typeof J=="function"?J:K.color).domain()),Fe=typeof K.color=="function"?K.color:function(){return K.color},Ge=typeof J=="function"?J:function(){return J},rt=X._levels,bt=G(ne,X,Ae),ht=bt.fill,ct=bt.line,Oe=Math.round(se*(ye==="fraction"?ae?F.w:F.h:1)),ze=Oe/(ae?F.w:F.h),we=Math.round(B*(ie==="fraction"?ae?F.h:F.w:1)),je=we/(ae?F.h:F.w),ot=j?F.w:ne._fullLayout.width,vt=ge?F.h:ne._fullLayout.height,Lt=Math.round(ae?D*ot+Q:le*vt+ee),Tt={center:.5,right:1}[ke]||0,kt={top:1,middle:.5}[Ie]||0,Nt=ae?D-Tt*ze:le-kt*ze,Pt=ae?le-kt*je:D-Tt*je,Wt=Math.round(ae?vt*(1-Pt):ot*Pt);X._lenFrac=je,X._thickFrac=ze,X._uFrac=Nt,X._vFrac=Pt;var St=X._axis=Z(ne,X,Ae);St.position=ze+(ae?D+Q/F.w:le+ee/F.h);var Qt=["top","bottom"].indexOf(Te)!==-1;if(ae&&Qt&&(St.title.side=Te,St.titlex=D+Q/F.w,St.titley=Pt+(ve.side==="top"?je-ee/F.h:ee/F.h)),!ae&&!Qt&&(St.title.side=Te,St.titley=le+ee/F.h,St.titlex=Pt+Q/F.w),K.color&&X.tickmode==="auto"){St.tickmode="linear",St.tick0=rt.start;var rr=rt.size,Jt=p.constrain(we/50,4,15)+1,sr=(Ae[1]-Ae[0])/((X.nticks||Jt)*rr);if(sr>1){var De=Math.pow(10,Math.floor(Math.log(sr)/Math.LN10));rr*=De*p.roundUp(sr/De,[2,5,10]),(Math.abs(rt.start)/rt.size+1e-6)%1<2e-6&&(St.tick0=0)}St.dtick=rr}St.domain=ae?[Pt+ee/F.h,Pt+je-ee/F.h]:[Pt+Q/F.w,Pt+je-Q/F.w],St.setScale(),Y.attr("transform",v(Math.round(F.l),Math.round(F.t)));var Je=Y.select("."+te.cbtitleunshift).attr("transform",v(-Math.round(F.l),-Math.round(F.t))),de=St.ticklabelposition,Me=St.title.font.size,Ce=Y.select("."+te.cbaxis),Ue,He=0,et=0;function at(zt,Ut){var or={propContainer:St,propName:X._propPrefix+"title.text",traceIndex:X._traceIndex,_meta:X._meta,placeholder:k._dfltTitle.colorbar,containerGroup:Y.select("."+te.cbtitle)},xr=zt.charAt(0)==="h"?zt.substr(1):"h"+zt;Y.selectAll("."+xr+",."+xr+"-math-group").remove(),L.draw(ne,zt,o(or,Ut||{}))}function xt(){if(ae&&Qt||!ae&&!Qt){var zt,Ut;Te==="top"&&(zt=Q+F.l+ot*D,Ut=ee+F.t+vt*(1-Pt-je)+3+Me*.75),Te==="bottom"&&(zt=Q+F.l+ot*D,Ut=ee+F.t+vt*(1-Pt)-3-Me*.25),Te==="right"&&(Ut=ee+F.t+vt*le+3+Me*.75,zt=Q+F.l+ot*Pt),at(St._id+"title",{attributes:{x:zt,y:Ut,"text-anchor":ae?"start":"middle"}})}}function mt(){if(ae&&!Qt||!ae&&Qt){var zt=St.position||0,Ut=St._offset+St._length/2,or,xr;if(Te==="right")xr=Ut,or=F.l+ot*zt+10+Me*(St.showticklabels?1:.5);else if(or=Ut,Te==="bottom"&&(xr=F.t+vt*zt+10+(de.indexOf("inside")===-1?St.tickfont.size:0)+(St.ticks!=="inside"&&X.ticklen||0)),Te==="top"){var zr=ve.text.split("<br>").length;xr=F.t+vt*zt+10-Oe-A*Me*zr}at((ae?"h":"v")+St._id+"title",{avoid:{selection:d.select(ne).selectAll("g."+St._id+"tick"),side:Te,offsetTop:ae?0:F.t,offsetLeft:ae?F.l:0,maxShift:ae?k.width:k.height},attributes:{x:or,y:xr,"text-anchor":"middle"},transform:{rotate:ae?-90:0,offset:0}})}}function yt(){if(!ae&&!Qt||ae&&Qt){var zt=Y.select("."+te.cbtitle),Ut=zt.select("text"),or=[-me/2,me/2],xr=zt.select(".h"+St._id+"title-math-group").node(),zr=15.6;Ut.node()&&(zr=parseInt(Ut.node().style.fontSize,10)*A);var Br;if(xr?(Br=g.bBox(xr),et=Br.width,He=Br.height,He>zr&&(or[1]-=(He-zr)/2)):Ut.node()&&!Ut.classed(te.jsPlaceholder)&&(Br=g.bBox(Ut.node()),et=Br.width,He=Br.height),ae){if(He){if(He+=5,Te==="top")St.domain[1]-=He/F.h,or[1]*=-1;else{St.domain[0]+=He/F.h;var Gr=S.lineCount(Ut);or[1]+=(1-Gr)*zr}zt.attr("transform",v(or[0],or[1])),St.setScale()}}else et&&(Te==="right"&&(St.domain[0]+=(et+Me/2)/F.w),zt.attr("transform",v(or[0],or[1])),St.setScale())}Y.selectAll("."+te.cbfills+",."+te.cblines).attr("transform",ae?v(0,Math.round(F.h*(1-St.domain[1]))):v(Math.round(F.w*St.domain[0]),0)),Ce.attr("transform",ae?v(0,Math.round(-F.t)):v(Math.round(-F.l),0));var wr=Y.select("."+te.cbfills).selectAll("rect."+te.cbfill).attr("style","").data(ht);wr.enter().append("rect").classed(te.cbfill,!0).attr("style",""),wr.exit().remove();var lr=Ae.map(St.c2p).map(Math.round).sort(function(Er,_r){return Er-_r});wr.each(function(Er,_r){var rn=[_r===0?Ae[0]:(ht[_r]+ht[_r-1])/2,_r===ht.length-1?Ae[1]:(ht[_r]+ht[_r+1])/2].map(St.c2p).map(Math.round);ae&&(rn[1]=p.constrain(rn[1]+(rn[1]>rn[0])?1:-1,lr[0],lr[1]));var gn=d.select(this).attr(ae?"x":"y",Lt).attr(ae?"y":"x",d.min(rn)).attr(ae?"width":"height",Math.max(Oe,2)).attr(ae?"height":"width",Math.max(d.max(rn)-d.min(rn),2));if(X._fillgradient)g.gradient(gn,ne,X._id,ae?"vertical":"horizontalreversed",X._fillgradient,"fill");else{var Ur=Ge(Er).replace("e-","");gn.attr("fill",i(Ur).toHexString())}});var Dr=Y.select("."+te.cblines).selectAll("path."+te.cbline).data(K.color&&K.width?ct:[]);Dr.enter().append("path").classed(te.cbline,!0),Dr.exit().remove(),Dr.each(function(Er){var _r=Lt,rn=Math.round(St.c2p(Er))+K.width/2%1;d.select(this).attr("d","M"+(ae?_r+","+rn:rn+","+_r)+(ae?"h":"v")+Oe).call(g.lineGroupStyle,K.width,Fe(Er),K.dash)}),Ce.selectAll("g."+St._id+"tick,path").remove();var Hr=Lt+Oe+(me||0)/2-(X.ticks==="outside"?1:0),Rr=u.calcTicks(St),Ar=u.getTickSigns(St)[2];return u.drawTicks(ne,St,{vals:St.ticks==="inside"?u.clipEnds(St,Rr):Rr,layer:Ce,path:u.makeTickPath(St,Hr,Ar),transFn:u.makeTransTickFn(St)}),u.drawLabels(ne,St,{vals:Rr,layer:Ce,transFn:u.makeTransTickLabelFn(St),labelFns:u.makeLabelFns(St,Hr)})}function It(){var zt,Ut=Oe+me/2;de.indexOf("inside")===-1&&(zt=g.bBox(Ce.node()),Ut+=ae?zt.width:zt.height),Ue=Je.select("text");var or=0,xr=ae&&Te==="top",zr=!ae&&Te==="right",Br=0;if(Ue.node()&&!Ue.classed(te.jsPlaceholder)){var Gr,wr=Je.select(".h"+St._id+"title-math-group").node();wr&&(ae&&Qt||!ae&&!Qt)?(zt=g.bBox(wr),or=zt.width,Gr=zt.height):(zt=g.bBox(Je.node()),or=zt.right-F.l-(ae?Lt:Wt),Gr=zt.bottom-F.t-(ae?Wt:Lt),!ae&&Te==="top"&&(Ut+=zt.height,Br=zt.height)),zr&&(Ue.attr("transform",v(or/2+Me/2,0)),or*=2),Ut=Math.max(Ut,ae?or:Gr)}var lr=(ae?Q:ee)*2+Ut+xe+me/2,Dr=0;!ae&&ve.text&&Ie==="bottom"&&le<=0&&(Dr=lr/2,lr+=Dr,Br+=Dr),k._hColorbarMoveTitle=Dr,k._hColorbarMoveCBTitle=Br;var Hr=xe+me,Rr=(ae?Lt:Wt)-Hr/2-(ae?Q:0),Ar=(ae?Wt:Lt)-(ae?we:ee+Br-Dr);Y.select("."+te.cbbg).attr("x",Rr).attr("y",Ar).attr(ae?"width":"height",Math.max(lr-Dr,2)).attr(ae?"height":"width",Math.max(we+Hr,2)).call(b.fill,Re).call(b.stroke,X.bordercolor).style("stroke-width",xe);var Er=zr?Math.max(or-10,0):0;Y.selectAll("."+te.cboutline).attr("x",(ae?Lt:Wt+Q)+Er).attr("y",(ae?Wt+ee-we:Lt)+(xr?He:0)).attr(ae?"width":"height",Math.max(Oe,2)).attr(ae?"height":"width",Math.max(we-(ae?2*ee+He:2*Q+Er),2)).call(b.stroke,X.outlinecolor).style({fill:"none","stroke-width":me});var _r=ae?Tt*lr:0,rn=ae?0:(1-kt)*lr-Br;if(_r=j?F.l-_r:-_r,rn=ge?F.t-rn:-rn,Y.attr("transform",v(_r,rn)),!ae&&(xe||i(Re).getAlpha()&&!i.equals(k.paper_bgcolor,Re))){var gn=Ce.selectAll("text"),Ur=gn[0].length,vn=Y.select("."+te.cbbg).node(),Cn=g.bBox(vn),Vn=g.getTranslate(Y),Gn=2;gn.each(function(lt,We){var Ze=0,dt=Ur-1;if(We===Ze||We===dt){var it=g.bBox(this),At=g.getTranslate(this),Rt;if(We===dt){var Yt=it.right+At.x,pr=Cn.right+Vn.x+Wt-xe-Gn+D;Rt=pr-Yt,Rt>0&&(Rt=0)}else if(We===Ze){var fr=it.left+At.x,Sr=Cn.left+Vn.x+Wt+xe+Gn;Rt=Sr-fr,Rt<0&&(Rt=0)}Rt&&(Ur<3?this.setAttribute("transform","translate("+Rt+",0) "+this.getAttribute("transform")):this.setAttribute("visibility","hidden"))}})}var sn={},Fn=R[ke],Tn=N[ke],Mr=R[Ie],oa=N[Ie],pe=lr-Oe;ae?(ie==="pixels"?(sn.y=le,sn.t=we*Mr,sn.b=we*oa):(sn.t=sn.b=0,sn.yt=le+B*Mr,sn.yb=le-B*oa),ye==="pixels"?(sn.x=D,sn.l=lr*Fn,sn.r=lr*Tn):(sn.l=pe*Fn,sn.r=pe*Tn,sn.xl=D-se*Fn,sn.xr=D+se*Tn)):(ie==="pixels"?(sn.x=D,sn.l=we*Fn,sn.r=we*Tn):(sn.l=sn.r=0,sn.xl=D+B*Fn,sn.xr=D-B*Tn),ye==="pixels"?(sn.y=1-le,sn.t=lr*Mr,sn.b=lr*oa):(sn.t=pe*Mr,sn.b=pe*oa,sn.yt=le-se*Mr,sn.yb=le+se*oa));var he=X.y<.5?"b":"t",Ye=X.x<.5?"l":"r";ne._fullLayout._reservedMargin[X._id]={};var tt={r:k.width-Rr-_r,l:Rr+sn.r,b:k.height-Ar-rn,t:Ar+sn.b};j&&ge?s.autoMargin(ne,X._id,sn):j?ne._fullLayout._reservedMargin[X._id][he]=tt[he]:ge||ae?ne._fullLayout._reservedMargin[X._id][Ye]=tt[Ye]:ne._fullLayout._reservedMargin[X._id][he]=tt[he]}return p.syncOrAsync([s.previousPromises,xt,yt,mt,s.previousPromises,It],ne)}function re(Y,X,ne){var ae=X.orientation==="v",B=ne._fullLayout,ie=B._size,se,ye,me;h.init({element:Y.node(),gd:ne,prepFn:function(){se=Y.attr("transform"),w(Y)},moveFn:function(xe,Re){Y.attr("transform",se+v(xe,Re)),ye=h.align((ae?X._uFrac:X._vFrac)+xe/ie.w,ae?X._thickFrac:X._lenFrac,0,1,X.xanchor),me=h.align((ae?X._vFrac:1-X._uFrac)-Re/ie.h,ae?X._lenFrac:X._thickFrac,0,1,X.yanchor);var ke=h.getCursor(ye,me,X.xanchor,X.yanchor);w(Y,ke)},doneFn:function(){if(w(Y),ye!==void 0&&me!==void 0){var xe={};xe[X._propPrefix+"x"]=ye,xe[X._propPrefix+"y"]=me,X._traceIndex!==void 0?f.call("_guiRestyle",ne,xe,X._traceIndex):f.call("_guiRelayout",ne,xe)}}})}function G(Y,X,ne){var ae=X._levels,B=[],ie=[],se,ye,me=ae.end+ae.size/100,xe=ae.size,Re=1.001*ne[0]-.001*ne[1],ke=1.001*ne[1]-.001*ne[0];for(ye=0;ye<1e5&&(se=ae.start+ye*xe,!(xe>0?se>=me:se<=me));ye++)se>Re&&se<ke&&B.push(se);if(X._fillgradient)ie=[0];else if(typeof X._fillcolor=="function"){var Ie=X._filllevels;if(Ie)for(me=Ie.end+Ie.size/100,xe=Ie.size,ye=0;ye<1e5&&(se=Ie.start+ye*xe,!(xe>0?se>=me:se<=me));ye++)se>ne[0]&&se<ne[1]&&ie.push(se);else ie=B.map(function(Q){return Q-ae.size/2}),ie.push(ie[ie.length-1]+ae.size)}else X._fillcolor&&typeof X._fillcolor=="string"&&(ie=[0]);return ae.size<0&&(B.reverse(),ie.reverse()),{line:B,fill:ie}}function Z(Y,X,ne){var ae=Y._fullLayout,B=X.orientation==="v",ie={type:"linear",range:ne,tickmode:X.tickmode,nticks:X.nticks,tick0:X.tick0,dtick:X.dtick,tickvals:X.tickvals,ticktext:X.ticktext,ticks:X.ticks,ticklen:X.ticklen,tickwidth:X.tickwidth,tickcolor:X.tickcolor,showticklabels:X.showticklabels,labelalias:X.labelalias,ticklabelposition:X.ticklabelposition,ticklabeloverflow:X.ticklabeloverflow,ticklabelstep:X.ticklabelstep,tickfont:X.tickfont,tickangle:X.tickangle,tickformat:X.tickformat,exponentformat:X.exponentformat,minexponent:X.minexponent,separatethousands:X.separatethousands,showexponent:X.showexponent,showtickprefix:X.showtickprefix,tickprefix:X.tickprefix,showticksuffix:X.showticksuffix,ticksuffix:X.ticksuffix,title:X.title,showline:!0,anchor:"free",side:B?"right":"bottom",position:1},se=B?"y":"x",ye={type:"linear",_id:se+X._id},me={letter:se,font:ae.font,noAutotickangles:se==="y",noHover:!0,noTickson:!0,noTicklabelmode:!0,noInsideRange:!0,calendar:ae.calendar};function xe(Re,ke){return p.coerce(ie,ye,m,Re,ke)}return T(ie,ye,xe,me,ae),C(ie,ye,xe,me),ye}V.exports={draw:H}}),H_=t((W,V)=>{V.exports={moduleType:"component",name:"colorbar",attributes:ri(),supplyDefaults:ed(),draw:B_().draw,hasColorbar:Qi()}}),V_=t((W,V)=>{V.exports={moduleType:"component",name:"legend",layoutAttributes:On(),supplyLayoutDefaults:Xa(),draw:tc(),style:ec()}}),G_=t((W,V)=>{V.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}}),j_=t((W,V)=>{V.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}}),p1=t((W,V)=>{var d=an(),i=Mt(),s=i.extendFlat,f=i.extendDeep;function u(p){var v;switch(p){case"themes__thumb":v={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":v={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:v={}}return v}function h(p){var v=["xaxis","yaxis","zaxis"];return v.indexOf(p.slice(0,5))>-1}V.exports=function(p,v){var o,w=p.data,g=p.layout,b=f([],w),L=f({},g,u(v.tileClass)),S=p._context||{};if(v.width&&(L.width=v.width),v.height&&(L.height=v.height),v.tileClass==="thumbnail"||v.tileClass==="themes__thumb"){L.annotations=[];var M=Object.keys(L);for(o=0;o<M.length;o++)h(M[o])&&(L[M[o]].title={text:""});for(o=0;o<b.length;o++){var T=b[o];T.showscale=!1,T.marker&&(T.marker.showscale=!1),d.traceIs(T,"pie-like")&&(T.textposition="none")}}if(Array.isArray(v.annotations))for(o=0;o<v.annotations.length;o++)L.annotations.push(v.annotations[o]);var C=Object.keys(L).filter(function(N){return N.match(/^scene\d*$/)});if(C.length){var m={};for(v.tileClass==="thumbnail"&&(m={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),o=0;o<C.length;o++){var y=L[C[o]];y.xaxis||(y.xaxis={}),y.yaxis||(y.yaxis={}),y.zaxis||(y.zaxis={}),s(y.xaxis,m),s(y.yaxis,m),s(y.zaxis,m),y._scene=null}}var A=document.createElement("div");v.tileClass&&(A.className=v.tileClass);var R={gd:A,td:A,layout:L,data:b,config:{staticPlot:v.staticPlot===void 0?!0:v.staticPlot,plotGlPixelRatio:v.plotGlPixelRatio===void 0?2:v.plotGlPixelRatio,displaylogo:v.displaylogo||!1,showLink:v.showLink||!1,showTips:v.showTips||!1,mapboxAccessToken:S.mapboxAccessToken}};return v.setBackground!=="transparent"&&(R.config.setBackground=v.setBackground||"opaque"),R.gd.defaultLayout=u(v.tileClass),R}}),W_=t((W,V)=>{var d=Zr().EventEmitter,i=an(),s=Mt(),f=nc(),u=p1(),h=ff(),p=pf();function v(o,w){var g=new d,b=u(o,{format:"png"}),L=b.gd;L.style.position="absolute",L.style.left="-5000px",document.body.appendChild(L);function S(){var T=f.getDelay(L._fullLayout);setTimeout(function(){var C=h(L),m=document.createElement("canvas");m.id=s.randstr(),g=p({format:w.format,width:L._fullLayout.width,height:L._fullLayout.height,canvas:m,emitter:g,svg:C}),g.clean=function(){L&&document.body.removeChild(L)}},T)}var M=f.getRedrawFunc(L);return i.call("_doPlot",L,b.data,b.layout,b.config).then(M).then(S).catch(function(T){g.emit("error",T)}),g}V.exports=v}),Y_=t((W,V)=>{var d=nc(),i={getDelay:d.getDelay,getRedrawFunc:d.getRedrawFunc,clone:p1(),toSVG:ff(),svgToImg:pf(),toImage:W_(),downloadImage:Ym()};V.exports=i}),q_=t(W=>{W.version=r().version,a(),gr();var V=an(),d=W.register=V.register,i=Ax(),s=Object.keys(i);for(u=0;u<s.length;u++)f=s[u],f.charAt(0)!=="_"&&(W[f]=i[f]),d({moduleType:"apiMethod",name:f,fn:i[f]});var f,u;d(Qx()),d([n_(),l_(),nu(),h_(),g_(),__(),M_(),E_(),P_(),O_(),F_(),td(),H_(),V_(),ws(),zm()]),d([G_(),j_()]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(d(window.PlotlyLocales),delete window.PlotlyLocales),W.Icons=af();var h=ws(),p=pn();W.Plots={resize:p.resize,graphJson:p.graphJson,sendDataToCloud:p.sendDataToCloud},W.Fx={hover:h.hover,unhover:h.unhover,loneHover:h.loneHover,loneUnhover:h.loneUnhover},W.Snapshot=Y_(),W.PlotSchema=Hn()}),J_=t((W,V)=>{V.exports=q_()}),Mf=t((W,V)=>{V.exports={TEXTPAD:3,eventDataKeys:["value","label"]}}),hd=t((W,V)=>{var d=rc(),i=Fi().axisHoverFormat,s=jr().hovertemplateAttrs,f=jr().texttemplateAttrs,u=Wi(),h=pt(),p=Mf(),v=Wr().pattern,o=gt().extendFlat,w=h({editType:"calc",arrayOk:!0,colorEditType:"style"}),g=d.marker,b=g.line,L=o({},b.width,{dflt:0}),S=o({width:L,editType:"calc"},u("marker.line")),M=o({line:S,editType:"calc"},u("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:v,cornerradius:{valType:"any",editType:"calc"}});V.exports={x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,xperiod:d.xperiod,yperiod:d.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:d.xperiodalignment,yperiodalignment:d.yperiodalignment,xhoverformat:i("x"),yhoverformat:i("y"),text:d.text,texttemplate:f({editType:"plot"},{keys:p.eventDataKeys}),hovertext:d.hovertext,hovertemplate:s({},{keys:p.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:o({},w,{}),insidetextfont:o({},w,{}),outsidetextfont:o({},w,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:o({},d.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:M,offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup,selected:{marker:{opacity:d.selected.marker.opacity,color:d.selected.marker.color,editType:"style"},textfont:d.selected.textfont,editType:"style"},unselected:{marker:{opacity:d.unselected.marker.opacity,color:d.unselected.marker.color,editType:"style"},textfont:d.unselected.textfont,editType:"style"},zorder:d.zorder}}),m1=t((W,V)=>{V.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},barcornerradius:{valType:"any",editType:"calc"}}}),X_=t((W,V)=>{var d=Xt(),i=Di().hasColorscale,s=vl(),f=Mt().coercePattern;V.exports=function(u,h,p,v,o){var w=p("marker.color",v),g=i(u,"marker");g&&s(u,h,o,p,{prefix:"marker.",cLetter:"c"}),p("marker.line.color",d.defaultLine),i(u,"marker.line")&&s(u,h,o,p,{prefix:"marker.line.",cLetter:"c"}),p("marker.line.width"),p("marker.opacity"),f(p,"marker.pattern",w,g),p("selected.marker.color"),p("unselected.marker.color")}}),fd=t((W,V)=>{var d=q(),i=Mt(),s=Xt(),f=an(),u=qm(),h=Jm(),p=X_(),v=Xm(),o=hd(),w=i.coerceFont;function g(M,T,C,m){function y(H,U){return i.coerce(M,T,o,H,U)}var A=u(M,T,m,y);if(!A){T.visible=!1;return}h(M,T,m,y),y("xhoverformat"),y("yhoverformat"),y("zorder"),y("orientation",T.x&&!T.y?"h":"v"),y("base"),y("offset"),y("width"),y("text"),y("hovertext"),y("hovertemplate");var R=y("textposition");S(M,T,m,y,R,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),p(M,T,y,C,m);var N=(T.marker.line||{}).color,te=f.getComponentMethod("errorbars","supplyDefaults");te(M,T,N||s.defaultLine,{axis:"y"}),te(M,T,N||s.defaultLine,{axis:"x",inherit:"y"}),i.coerceSelectionMarkerOpacity(T,y)}function b(M,T){var C,m;function y(N,te){return i.coerce(m._input,m,o,N,te)}for(var A=0;A<M.length;A++)if(m=M[A],m.type==="bar"){C=m._input;var R=y("marker.cornerradius",T.barcornerradius);m.marker&&(m.marker.cornerradius=L(R)),v(C,m,T,y,T.barmode)}}function L(M){if(d(M)){if(M=+M,M>=0)return M}else if(typeof M=="string"&&(M=M.trim(),M.slice(-1)==="%"&&d(M.slice(0,-1))&&(M=+M.slice(0,-1),M>=0)))return M+"%"}function S(M,T,C,m,y,A){A=A||{};var R=A.moduleHasSelected!==!1,N=A.moduleHasUnselected!==!1,te=A.moduleHasConstrain!==!1,H=A.moduleHasCliponaxis!==!1,U=A.moduleHasTextangle!==!1,P=A.moduleHasInsideanchor!==!1,re=!!A.hasPathbar,G=Array.isArray(y)||y==="auto",Z=G||y==="inside",Y=G||y==="outside";if(Z||Y){var X=w(m,"textfont",C.font),ne=i.extendFlat({},X),ae=M.textfont&&M.textfont.color,B=!ae;if(B&&delete ne.color,w(m,"insidetextfont",ne),re){var ie=i.extendFlat({},X);B&&delete ie.color,w(m,"pathbar.textfont",ie)}Y&&w(m,"outsidetextfont",X),R&&m("selected.textfont.color"),N&&m("unselected.textfont.color"),te&&m("constraintext"),H&&m("cliponaxis"),U&&m("textangle"),m("texttemplate")}Z&&P&&m("insidetextanchor")}V.exports={supplyDefaults:g,crossTraceDefaults:b,handleText:S,validateCornerradius:L}}),Z_=t((W,V)=>{var d=an(),i=Ja(),s=Mt(),f=m1(),u=fd().validateCornerradius;V.exports=function(h,p,v){function o(R,N){return s.coerce(h,p,f,R,N)}for(var w=!1,g=!1,b=!1,L={},S=o("barmode"),M=S==="group",T=0;T<v.length;T++){var C=v[T];if(d.traceIs(C,"bar")&&C.visible)w=!0;else continue;var m=C.xaxis+C.yaxis;if(M?(L[m]&&(b=!0),L[m]=!0):(m+=C._input.offsetgroup,L.length>0&&!L[m]&&(b=!0),L[m]=!0),C.visible&&C.type==="histogram"){var y=i.getFromId({_fullLayout:p},C[C.orientation==="v"?"xaxis":"yaxis"]);y.type!=="category"&&(g=!0)}}if(!w){delete p.barmode;return}S!=="overlay"&&o("barnorm"),o("bargap",g&&!b?0:.2),o("bargroupgap");var A=o("barcornerradius");p.barcornerradius=u(A)}}),g1=t((W,V)=>{var d=Mt();V.exports=function(i,s){for(var f=0;f<i.length;f++)i[f].i=f;d.mergeArray(s.text,i,"tx"),d.mergeArray(s.hovertext,i,"htx");var u=s.marker;if(u){d.mergeArray(u.opacity,i,"mo",!0),d.mergeArray(u.color,i,"mc");var h=u.line;h&&(d.mergeArray(h.color,i,"mlc"),d.mergeArrayCastPositive(h.width,i,"mlw"))}}}),Q_=t((W,V)=>{var d=Ja(),i=Zm(),s=Di().hasColorscale,f=Kc(),u=g1(),h=Km();V.exports=function(p,v){var o=d.getFromId(p,v.xaxis||"x"),w=d.getFromId(p,v.yaxis||"y"),g,b,L,S,M,T,C={msUTC:!!(v.base||v.base===0)};v.orientation==="h"?(g=o.makeCalcdata(v,"x",C),L=w.makeCalcdata(v,"y"),S=i(v,w,"y",L),M=!!v.yperiodalignment,T="y"):(g=w.makeCalcdata(v,"y",C),L=o.makeCalcdata(v,"x"),S=i(v,o,"x",L),M=!!v.xperiodalignment,T="x"),b=S.vals;for(var m=Math.min(b.length,g.length),y=new Array(m),A=0;A<m;A++)y[A]={p:b[A],s:g[A]},M&&(y[A].orig_p=L[A],y[A][T+"End"]=S.ends[A],y[A][T+"Start"]=S.starts[A]),v.ids&&(y[A].id=String(v.ids[A]));return s(v,"marker")&&f(p,v,{vals:v.marker.color,containerStr:"marker",cLetter:"c"}),s(v,"marker.line")&&f(p,v,{vals:v.marker.line.color,containerStr:"marker.line",cLetter:"c"}),u(y,v),h(y,v),y}}),pd=t((W,V)=>{var d=l(),i=Mt();function s(p,v,o){var w=p._fullLayout,g=w["_"+o+"Text_minsize"];if(g){var b=w.uniformtext.mode==="hide",L;switch(o){case"funnelarea":case"pie":case"sunburst":L="g.slice";break;case"treemap":case"icicle":L="g.slice, g.pathbar";break;default:L="g.points > g.point"}v.selectAll(L).each(function(S){var M=S.transform;if(M){M.scale=b&&M.hide?0:g/M.fontSize;var T=d.select(this).select("text");i.setTransormAndDisplay(T,M)}})}}function f(p,v,o){if(o.uniformtext.mode){var w=h(p),g=o.uniformtext.minsize,b=v.scale*v.fontSize;v.hide=b<g,o[w]=o[w]||1/0,v.hide||(o[w]=Math.min(o[w],Math.max(b,g)))}}function u(p,v){var o=h(p);v[o]=void 0}function h(p){return"_"+p+"Text_minsize"}V.exports={recordMinTextSize:f,clearMinTextSize:u,resizeText:s}}),Tf=t(W=>{var V=q(),d=ft(),i=Mt().isArrayOrTypedArray;W.coerceString=function(s,f,u){if(typeof f=="string"){if(f||!s.noBlank)return f}else if((typeof f=="number"||f===!0)&&!s.strict)return String(f);return u!==void 0?u:s.dflt},W.coerceNumber=function(s,f,u){if(V(f)){f=+f;var h=s.min,p=s.max,v=h!==void 0&&f<h||p!==void 0&&f>p;if(!v)return f}return u!==void 0?u:s.dflt},W.coerceColor=function(s,f,u){return d(f).isValid()?f:u!==void 0?u:s.dflt},W.coerceEnumerated=function(s,f,u){return s.coerceNumber&&(f=+f),s.values.indexOf(f)!==-1?f:u!==void 0?u:s.dflt},W.getValue=function(s,f){var u;return i(s)?f<s.length&&(u=s[f]):u=s,u},W.getLineWidth=function(s,f){var u=0<f.mlw?f.mlw:i(s.marker.line.width)?0:s.marker.line.width;return u}}),Af=t((W,V)=>{var d=l(),i=Xt(),s=Ra(),f=Mt(),u=an(),h=pd().resizeText,p=hd(),v=p.textfont,o=p.insidetextfont,w=p.outsidetextfont,g=Tf();function b(H){var U=d.select(H).selectAll('g[class^="barlayer"]').selectAll("g.trace");h(H,U,"bar");var P=U.size(),re=H._fullLayout;U.style("opacity",function(G){return G[0].trace.opacity}).each(function(G){(re.barmode==="stack"&&P>1||re.bargap===0&&re.bargroupgap===0&&!G[0].trace.marker.line.width)&&d.select(this).attr("shape-rendering","crispEdges")}),U.selectAll("g.points").each(function(G){var Z=d.select(this),Y=G[0].trace;L(Z,Y,H)}),u.getComponentMethod("errorbars","style")(U)}function L(H,U,P){s.pointStyle(H.selectAll("path"),U,P),S(H,U,P)}function S(H,U,P){H.selectAll("text").each(function(re){var G=d.select(this),Z=f.ensureUniformFontSize(P,m(G,re,U,P));s.font(G,Z)})}function M(H,U,P){var re=U[0].trace;re.selectedpoints?T(P,re,H):(L(P,re,H),u.getComponentMethod("errorbars","style")(P))}function T(H,U,P){s.selectedPointStyle(H.selectAll("path"),U),C(H.selectAll("text"),U,P)}function C(H,U,P){H.each(function(re){var G=d.select(this),Z;if(re.selected){Z=f.ensureUniformFontSize(P,m(G,re,U,P));var Y=U.selected.textfont&&U.selected.textfont.color;Y&&(Z.color=Y),s.font(G,Z)}else s.selectedTextStyle(G,U)})}function m(H,U,P,re){var G=re._fullLayout.font,Z=P.textfont;if(H.classed("bartext-inside")){var Y=te(U,P);Z=A(P,U.i,G,Y)}else H.classed("bartext-outside")&&(Z=R(P,U.i,G));return Z}function y(H,U,P){return N(v,H.textfont,U,P)}function A(H,U,P,re){var G=y(H,U,P),Z=H._input.textfont===void 0||H._input.textfont.color===void 0||Array.isArray(H.textfont.color)&&H.textfont.color[U]===void 0;return Z&&(G={color:i.contrast(re),family:G.family,size:G.size,weight:G.weight,style:G.style,variant:G.variant,textcase:G.textcase,lineposition:G.lineposition,shadow:G.shadow}),N(o,H.insidetextfont,U,G)}function R(H,U,P){var re=y(H,U,P);return N(w,H.outsidetextfont,U,re)}function N(H,U,P,re){U=U||{};var G=g.getValue(U.family,P),Z=g.getValue(U.size,P),Y=g.getValue(U.color,P),X=g.getValue(U.weight,P),ne=g.getValue(U.style,P),ae=g.getValue(U.variant,P),B=g.getValue(U.textcase,P),ie=g.getValue(U.lineposition,P),se=g.getValue(U.shadow,P);return{family:g.coerceString(H.family,G,re.family),size:g.coerceNumber(H.size,Z,re.size),color:g.coerceColor(H.color,Y,re.color),weight:g.coerceString(H.weight,X,re.weight),style:g.coerceString(H.style,ne,re.style),variant:g.coerceString(H.variant,ae,re.variant),textcase:g.coerceString(H.variant,B,re.textcase),lineposition:g.coerceString(H.variant,ie,re.lineposition),shadow:g.coerceString(H.variant,se,re.shadow)}}function te(H,U){return U.type==="waterfall"?U[H.dir].marker.color:H.mcc||H.mc||U.marker.color}V.exports={style:b,styleTextPoints:S,styleOnSelect:M,getInsideTextFont:A,getOutsideTextFont:R,getBarColor:te,resizeText:h}}),K_=t((W,V)=>{var d=l(),i=q(),s=Mt(),f=ja(),u=Xt(),h=Ra(),p=an(),v=Ja().tickText,o=pd(),w=o.recordMinTextSize,g=o.clearMinTextSize,b=Af(),L=Tf(),S=Mf(),M=hd(),T=M.text,C=M.textposition,m=So().appendArrayPointValue,y=S.TEXTPAD;function A(xe){return xe.id}function R(xe){if(xe.ids)return A}function N(xe){return(xe>0)-(xe<0)}function te(xe,Re){return xe<Re?1:-1}function H(xe,Re,ke,Ie){var Q=[],ee=[],D=Ie?Re:ke,le=Ie?ke:Re;return Q[0]=D.c2p(xe.s0,!0),ee[0]=le.c2p(xe.p0,!0),Q[1]=D.c2p(xe.s1,!0),ee[1]=le.c2p(xe.p1,!0),Ie?[Q,ee]:[ee,Q]}function U(xe,Re,ke,Ie){if(!Re.uniformtext.mode&&P(ke)){var Q;return Ie&&(Q=Ie()),xe.transition().duration(ke.duration).ease(ke.easing).each("end",function(){Q&&Q()}).each("interrupt",function(){Q&&Q()})}else return xe}function P(xe){return xe&&xe.duration>0}function re(xe,Re,ke,Ie,Q,ee){var D=Re.xaxis,le=Re.yaxis,ge=xe._fullLayout,j=xe._context.staticPlot;Q||(Q={mode:ge.barmode,norm:ge.barmode,gap:ge.bargap,groupgap:ge.bargroupgap},g("bar",ge));var k=s.makeTraceGroups(Ie,ke,"trace bars").each(function(F){var J=d.select(this),K=F[0].trace,ve=F[0].t,Te=K.type==="waterfall",Ae=K.type==="funnel",Fe=K.type==="histogram",Ge=K.type==="bar",rt=Ge||Ae,bt=0;Te&&K.connector.visible&&K.connector.mode==="between"&&(bt=K.connector.line.width/2);var ht=K.orientation==="h",ct=P(Q),Oe=s.ensureSingle(J,"g","points"),ze=R(K),we=Oe.selectAll("g.point").data(s.identity,ze);we.enter().append("g").classed("point",!0),we.exit().remove(),we.each(function(ot,vt){var Lt=d.select(this),Tt=H(ot,D,le,ht),kt=Tt[0][0],Nt=Tt[0][1],Pt=Tt[1][0],Wt=Tt[1][1],St=(ht?Nt-kt:Wt-Pt)===0;St&&rt&&L.getLineWidth(K,ot)&&(St=!1),St||(St=!i(kt)||!i(Nt)||!i(Pt)||!i(Wt)),ot.isBlank=St,St&&(ht?Nt=kt:Wt=Pt),bt&&!St&&(ht?(kt-=te(kt,Nt)*bt,Nt+=te(kt,Nt)*bt):(Pt-=te(Pt,Wt)*bt,Wt+=te(Pt,Wt)*bt));var Qt,rr;if(K.type==="waterfall"){if(!St){var Jt=K[ot.dir].marker;Qt=Jt.line.width,rr=Jt.color}}else Qt=L.getLineWidth(K,ot),rr=ot.mc||K.marker.color;function sr(Hr){var Rr=d.round(Qt/2%1,2);return Q.gap===0&&Q.groupgap===0?d.round(Math.round(Hr)-Rr,2):Hr}function De(Hr,Rr,Ar){return Ar&&Hr===Rr?Hr:Math.abs(Hr-Rr)>=2?sr(Hr):Hr>Rr?Math.ceil(Hr):Math.floor(Hr)}var Je=u.opacity(rr),de=Je<1||Qt>.01?sr:De;xe._context.staticPlot||(kt=de(kt,Nt,ht),Nt=de(Nt,kt,ht),Pt=de(Pt,Wt,!ht),Wt=de(Wt,Pt,!ht));var Me=ht?D.c2p:le.c2p,Ce;ot.s0>0?Ce=ot._sMax:ot.s0<0?Ce=ot._sMin:Ce=ot.s1>0?ot._sMax:ot._sMin;function Ue(Hr,Rr){if(!Hr)return 0;var Ar=Math.abs(ht?Wt-Pt:Nt-kt),Er=Math.abs(ht?Nt-kt:Wt-Pt),_r=de(Math.abs(Me(Ce,!0)-Me(0,!0))),rn=ot.hasB?Math.min(Ar/2,Er/2):Math.min(Ar/2,_r),gn;if(Rr==="%"){var Ur=Math.min(50,Hr);gn=Ar*(Ur/100)}else gn=Hr;return de(Math.max(Math.min(gn,rn),0))}var He=Ge||Fe?Ue(ve.cornerradiusvalue,ve.cornerradiusform):0,et,at,xt="M"+kt+","+Pt+"V"+Wt+"H"+Nt+"V"+Pt+"Z",mt=0;if(He&&ot.s){var yt=N(ot.s0)===0||N(ot.s)===N(ot.s0)?ot.s1:ot.s0;if(mt=de(ot.hasB?0:Math.abs(Me(Ce,!0)-Me(yt,!0))),mt<He){var It=te(kt,Nt),zt=te(Pt,Wt),Ut=It===-zt?1:0;if(ht)if(ot.hasB)et="M"+(kt+He*It)+","+Pt+"A "+He+","+He+" 0 0 "+Ut+" "+kt+","+(Pt+He*zt)+"V"+(Wt-He*zt)+"A "+He+","+He+" 0 0 "+Ut+" "+(kt+He*It)+","+Wt+"H"+(Nt-He*It)+"A "+He+","+He+" 0 0 "+Ut+" "+Nt+","+(Wt-He*zt)+"V"+(Pt+He*zt)+"A "+He+","+He+" 0 0 "+Ut+" "+(Nt-He*It)+","+Pt+"Z";else{at=Math.abs(Nt-kt)+mt;var or=at<He?He-Math.sqrt(at*(2*He-at)):0,xr=mt>0?Math.sqrt(mt*(2*He-mt)):0,zr=It>0?Math.max:Math.min;et="M"+kt+","+Pt+"V"+(Wt-or*zt)+"H"+zr(Nt-(He-mt)*It,kt)+"A "+He+","+He+" 0 0 "+Ut+" "+Nt+","+(Wt-He*zt-xr)+"V"+(Pt+He*zt+xr)+"A "+He+","+He+" 0 0 "+Ut+" "+zr(Nt-(He-mt)*It,kt)+","+(Pt+or*zt)+"Z"}else if(ot.hasB)et="M"+(kt+He*It)+","+Pt+"A "+He+","+He+" 0 0 "+Ut+" "+kt+","+(Pt+He*zt)+"V"+(Wt-He*zt)+"A "+He+","+He+" 0 0 "+Ut+" "+(kt+He*It)+","+Wt+"H"+(Nt-He*It)+"A "+He+","+He+" 0 0 "+Ut+" "+Nt+","+(Wt-He*zt)+"V"+(Pt+He*zt)+"A "+He+","+He+" 0 0 "+Ut+" "+(Nt-He*It)+","+Pt+"Z";else{at=Math.abs(Wt-Pt)+mt;var Br=at<He?He-Math.sqrt(at*(2*He-at)):0,Gr=mt>0?Math.sqrt(mt*(2*He-mt)):0,wr=zt>0?Math.max:Math.min;et="M"+(kt+Br*It)+","+Pt+"V"+wr(Wt-(He-mt)*zt,Pt)+"A "+He+","+He+" 0 0 "+Ut+" "+(kt+He*It-Gr)+","+Wt+"H"+(Nt-He*It+Gr)+"A "+He+","+He+" 0 0 "+Ut+" "+(Nt-Br*It)+","+wr(Wt-(He-mt)*zt,Pt)+"V"+Pt+"Z"}}else et=xt}else et=xt;var lr=U(s.ensureSingle(Lt,"path"),ge,Q,ee);if(lr.style("vector-effect",j?"none":"non-scaling-stroke").attr("d",isNaN((Nt-kt)*(Wt-Pt))||St&&xe._context.staticPlot?"M0,0Z":et).call(h.setClipUrl,Re.layerClipId,xe),!ge.uniformtext.mode&&ct){var Dr=h.makePointStyleFns(K);h.singlePointStyle(ot,lr,K,Dr,xe)}G(xe,Re,Lt,F,vt,kt,Nt,Pt,Wt,He,mt,Q,ee),Re.layerClipId&&h.hideOutsideRangePoint(ot,Lt.select("text"),D,le,K.xcalendar,K.ycalendar)});var je=K.cliponaxis===!1;h.setClipUrl(J,je?null:Re.layerClipId,xe)});p.getComponentMethod("errorbars","plot")(xe,k,Re,Q)}function G(xe,Re,ke,Ie,Q,ee,D,le,ge,j,k,F,J){var K=Re.xaxis,ve=Re.yaxis,Te=xe._fullLayout,Ae;function Fe(at,xt,mt){var yt=s.ensureSingle(at,"text").text(xt).attr({class:"bartext bartext-"+Ae,"text-anchor":"middle","data-notex":1}).call(h.font,mt).call(f.convertToTspans,xe);return yt}var Ge=Ie[0].trace,rt=Ge.orientation==="h",bt=ie(Te,Ie,Q,K,ve);Ae=se(Ge,Q);var ht=F.mode==="stack"||F.mode==="relative",ct=Ie[Q],Oe=!ht||ct._outmost,ze=ct.hasB,we=j&&j-k>y;if(!bt||Ae==="none"||(ct.isBlank||ee===D||le===ge)&&(Ae==="auto"||Ae==="inside")){ke.select("text").remove();return}var je=Te.font,ot=b.getBarColor(Ie[Q],Ge),vt=b.getInsideTextFont(Ge,Q,je,ot),Lt=b.getOutsideTextFont(Ge,Q,je),Tt=Ge.insidetextanchor||"end",kt=ke.datum();rt?K.type==="log"&&kt.s0<=0&&(K.range[0]<K.range[1]?ee=0:ee=K._length):ve.type==="log"&&kt.s0<=0&&(ve.range[0]<ve.range[1]?le=ve._length:le=0);var Nt=Math.abs(D-ee),Pt=Math.abs(ge-le),Wt=Nt-2*y,St=Pt-2*y,Qt,rr,Jt,sr,De;if(Ae==="outside"&&!Oe&&!ct.hasB&&(Ae="inside"),Ae==="auto")if(Oe){Ae="inside",De=s.ensureUniformFontSize(xe,vt),Qt=Fe(ke,bt,De),rr=h.bBox(Qt.node()),Jt=rr.width,sr=rr.height;var Je=Jt>0&&sr>0,de;we?ze?de=Z(Wt-2*j,St,Jt,sr,rt)||Z(Wt,St-2*j,Jt,sr,rt):rt?de=Z(Wt-(j-k),St,Jt,sr,rt)||Z(Wt,St-2*(j-k),Jt,sr,rt):de=Z(Wt,St-(j-k),Jt,sr,rt)||Z(Wt-2*(j-k),St,Jt,sr,rt):de=Z(Wt,St,Jt,sr,rt),Je&&de?Ae="inside":(Ae="outside",Qt.remove(),Qt=null)}else Ae="inside";if(!Qt){De=s.ensureUniformFontSize(xe,Ae==="outside"?Lt:vt),Qt=Fe(ke,bt,De);var Me=Qt.attr("transform");if(Qt.attr("transform",""),rr=h.bBox(Qt.node()),Jt=rr.width,sr=rr.height,Qt.attr("transform",Me),Jt<=0||sr<=0){Qt.remove();return}}var Ce=Ge.textangle,Ue,He;Ae==="outside"?(He=Ge.constraintext==="both"||Ge.constraintext==="outside",Ue=B(ee,D,le,ge,rr,{isHorizontal:rt,constrained:He,angle:Ce})):(He=Ge.constraintext==="both"||Ge.constraintext==="inside",Ue=ne(ee,D,le,ge,rr,{isHorizontal:rt,constrained:He,angle:Ce,anchor:Tt,hasB:ze,r:j,overhead:k})),Ue.fontSize=De.size,w(Ge.type==="histogram"?"bar":Ge.type,Ue,Te),ct.transform=Ue;var et=U(Qt,Te,F,J);s.setTransormAndDisplay(et,Ue)}function Z(xe,Re,ke,Ie,Q){if(xe<0||Re<0)return!1;var ee=ke<=xe&&Ie<=Re,D=ke<=Re&&Ie<=xe,le=Q?xe>=ke*(Re/Ie):Re>=Ie*(xe/ke);return ee||D||le}function Y(xe){return xe==="auto"?0:xe}function X(xe,Re){var ke=Math.PI/180*Re,Ie=Math.abs(Math.sin(ke)),Q=Math.abs(Math.cos(ke));return{x:xe.width*Q+xe.height*Ie,y:xe.width*Ie+xe.height*Q}}function ne(xe,Re,ke,Ie,Q,ee){var D=!!ee.isHorizontal,le=!!ee.constrained,ge=ee.angle||0,j=ee.anchor,k=j==="end",F=j==="start",J=ee.leftToRight||0,K=(J+1)/2,ve=1-K,Te=ee.hasB,Ae=ee.r,Fe=ee.overhead,Ge=Q.width,rt=Q.height,bt=Math.abs(Re-xe),ht=Math.abs(Ie-ke),ct=bt>2*y&&ht>2*y?y:0;bt-=2*ct,ht-=2*ct;var Oe=Y(ge);ge==="auto"&&!(Ge<=bt&&rt<=ht)&&(Ge>bt||rt>ht)&&(!(Ge>ht||rt>bt)||Ge<rt!=bt<ht)&&(Oe+=90);var ze=X(Q,Oe),we,je;if(Ae&&Ae-Fe>y){var ot=ae(xe,Re,ke,Ie,ze,Ae,Fe,D,Te);we=ot.scale,je=ot.pad}else we=1,le&&(we=Math.min(1,bt/ze.x,ht/ze.y)),je=0;var vt=Q.left*ve+Q.right*K,Lt=(Q.top+Q.bottom)/2,Tt=(xe+y)*ve+(Re-y)*K,kt=(ke+Ie)/2,Nt=0,Pt=0;if(F||k){var Wt=(D?ze.x:ze.y)/2;Ae&&(k||Te)&&(ct+=je);var St=D?te(xe,Re):te(ke,Ie);D?F?(Tt=xe+St*ct,Nt=-St*Wt):(Tt=Re-St*ct,Nt=St*Wt):F?(kt=ke+St*ct,Pt=-St*Wt):(kt=Ie-St*ct,Pt=St*Wt)}return{textX:vt,textY:Lt,targetX:Tt,targetY:kt,anchorX:Nt,anchorY:Pt,scale:we,rotate:Oe}}function ae(xe,Re,ke,Ie,Q,ee,D,le,ge){var j=Math.max(0,Math.abs(Re-xe)-2*y),k=Math.max(0,Math.abs(Ie-ke)-2*y),F=ee-y,J=D?F-Math.sqrt(F*F-(F-D)*(F-D)):F,K=ge?F*2:le?F-D:2*J,ve=ge?F*2:le?2*J:F-D,Te,Ae,Fe,Ge,rt;return Q.y/Q.x>=k/(j-K)?Ge=k/Q.y:Q.y/Q.x<=(k-ve)/j?Ge=j/Q.x:!ge&&le?(Te=Q.x*Q.x+Q.y*Q.y/4,Ae=-2*Q.x*(j-F)-Q.y*(k/2-F),Fe=(j-F)*(j-F)+(k/2-F)*(k/2-F)-F*F,Ge=(-Ae+Math.sqrt(Ae*Ae-4*Te*Fe))/(2*Te)):ge?(Te=(Q.x*Q.x+Q.y*Q.y)/4,Ae=-Q.x*(j/2-F)-Q.y*(k/2-F),Fe=(j/2-F)*(j/2-F)+(k/2-F)*(k/2-F)-F*F,Ge=(-Ae+Math.sqrt(Ae*Ae-4*Te*Fe))/(2*Te)):(Te=Q.x*Q.x/4+Q.y*Q.y,Ae=-Q.x*(j/2-F)-2*Q.y*(k-F),Fe=(j/2-F)*(j/2-F)+(k-F)*(k-F)-F*F,Ge=(-Ae+Math.sqrt(Ae*Ae-4*Te*Fe))/(2*Te)),Ge=Math.min(1,Ge),le?rt=Math.max(0,F-Math.sqrt(Math.max(0,F*F-(F-(k-Q.y*Ge)/2)*(F-(k-Q.y*Ge)/2)))-D):rt=Math.max(0,F-Math.sqrt(Math.max(0,F*F-(F-(j-Q.x*Ge)/2)*(F-(j-Q.x*Ge)/2)))-D),{scale:Ge,pad:rt}}function B(xe,Re,ke,Ie,Q,ee){var D=!!ee.isHorizontal,le=!!ee.constrained,ge=ee.angle||0,j=Q.width,k=Q.height,F=Math.abs(Re-xe),J=Math.abs(Ie-ke),K;D?K=J>2*y?y:0:K=F>2*y?y:0;var ve=1;le&&(ve=D?Math.min(1,J/k):Math.min(1,F/j));var Te=Y(ge),Ae=X(Q,Te),Fe=(D?Ae.x:Ae.y)/2,Ge=(Q.left+Q.right)/2,rt=(Q.top+Q.bottom)/2,bt=(xe+Re)/2,ht=(ke+Ie)/2,ct=0,Oe=0,ze=D?te(Re,xe):te(ke,Ie);return D?(bt=Re-ze*K,ct=ze*Fe):(ht=Ie+ze*K,Oe=-ze*Fe),{textX:Ge,textY:rt,targetX:bt,targetY:ht,anchorX:ct,anchorY:Oe,scale:ve,rotate:Te}}function ie(xe,Re,ke,Ie,Q){var ee=Re[0].trace,D=ee.texttemplate,le;return D?le=ye(xe,Re,ke,Ie,Q):ee.textinfo?le=me(Re,ke,Ie,Q):le=L.getValue(ee.text,ke),L.coerceString(T,le)}function se(xe,Re){var ke=L.getValue(xe.textposition,Re);return L.coerceEnumerated(C,ke)}function ye(xe,Re,ke,Ie,Q){var ee=Re[0].trace,D=s.castOption(ee,ke,"texttemplate");if(!D)return"";var le=ee.type==="histogram",ge=ee.type==="waterfall",j=ee.type==="funnel",k=ee.orientation==="h",F,J,K,ve;k?(F="y",J=Q,K="x",ve=Ie):(F="x",J=Ie,K="y",ve=Q);function Te(ct){return v(J,J.c2l(ct),!0).text}function Ae(ct){return v(ve,ve.c2l(ct),!0).text}var Fe=Re[ke],Ge={};Ge.label=Fe.p,Ge.labelLabel=Ge[F+"Label"]=Te(Fe.p);var rt=s.castOption(ee,Fe.i,"text");(rt===0||rt)&&(Ge.text=rt),Ge.value=Fe.s,Ge.valueLabel=Ge[K+"Label"]=Ae(Fe.s);var bt={};m(bt,ee,Fe.i),(le||bt.x===void 0)&&(bt.x=k?Ge.value:Ge.label),(le||bt.y===void 0)&&(bt.y=k?Ge.label:Ge.value),(le||bt.xLabel===void 0)&&(bt.xLabel=k?Ge.valueLabel:Ge.labelLabel),(le||bt.yLabel===void 0)&&(bt.yLabel=k?Ge.labelLabel:Ge.valueLabel),ge&&(Ge.delta=+Fe.rawS||Fe.s,Ge.deltaLabel=Ae(Ge.delta),Ge.final=Fe.v,Ge.finalLabel=Ae(Ge.final),Ge.initial=Ge.final-Ge.delta,Ge.initialLabel=Ae(Ge.initial)),j&&(Ge.value=Fe.s,Ge.valueLabel=Ae(Ge.value),Ge.percentInitial=Fe.begR,Ge.percentInitialLabel=s.formatPercent(Fe.begR),Ge.percentPrevious=Fe.difR,Ge.percentPreviousLabel=s.formatPercent(Fe.difR),Ge.percentTotal=Fe.sumR,Ge.percenTotalLabel=s.formatPercent(Fe.sumR));var ht=s.castOption(ee,Fe.i,"customdata");return ht&&(Ge.customdata=ht),s.texttemplateString(D,Ge,xe._d3locale,bt,Ge,ee._meta||{})}function me(xe,Re,ke,Ie){var Q=xe[0].trace,ee=Q.orientation==="h",D=Q.type==="waterfall",le=Q.type==="funnel";function ge(ht){var ct=ee?Ie:ke;return v(ct,ht,!0).text}function j(ht){var ct=ee?ke:Ie;return v(ct,+ht,!0).text}var k=Q.textinfo,F=xe[Re],J=k.split("+"),K=[],ve,Te=function(ht){return J.indexOf(ht)!==-1};if(Te("label")&&K.push(ge(xe[Re].p)),Te("text")&&(ve=s.castOption(Q,F.i,"text"),(ve===0||ve)&&K.push(ve)),D){var Ae=+F.rawS||F.s,Fe=F.v,Ge=Fe-Ae;Te("initial")&&K.push(j(Ge)),Te("delta")&&K.push(j(Ae)),Te("final")&&K.push(j(Fe))}if(le){Te("value")&&K.push(j(F.s));var rt=0;Te("percent initial")&&rt++,Te("percent previous")&&rt++,Te("percent total")&&rt++;var bt=rt>1;Te("percent initial")&&(ve=s.formatPercent(F.begR),bt&&(ve+=" of initial"),K.push(ve)),Te("percent previous")&&(ve=s.formatPercent(F.difR),bt&&(ve+=" of previous"),K.push(ve)),Te("percent total")&&(ve=s.formatPercent(F.sumR),bt&&(ve+=" of total"),K.push(ve))}return K.join("<br>")}V.exports={plot:re,toMoveInsideBar:ne}}),$_=t((W,V)=>{var d=ws(),i=an(),s=Xt(),f=Mt().fillText,u=Tf().getLineWidth,h=Ja().hoverLabelText,p=oe().BADNUM;function v(g,b,L,S,M){var T=o(g,b,L,S,M);if(T){var C=T.cd,m=C[0].trace,y=C[T.index];return T.color=w(m,y),i.getComponentMethod("errorbars","hoverInfo")(y,m,T),[T]}}function o(g,b,L,S,M){var T=g.cd,C=T[0].trace,m=T[0].t,y=S==="closest",A=C.type==="waterfall",R=g.maxHoverDistance,N=g.maxSpikeDistance,te,H,U,P,re,G,Z;C.orientation==="h"?(te=L,H=b,U="y",P="x",re=Ie,G=xe):(te=b,H=L,U="x",P="y",G=Ie,re=xe);var Y=C[U+"period"],X=y||Y;function ne(ve){return B(ve,-1)}function ae(ve){return B(ve,1)}function B(ve,Te){var Ae=ve.w;return ve[U]+Te*Ae/2}function ie(ve){return ve[U+"End"]-ve[U+"Start"]}var se=y?ne:Y?function(ve){return ve.p-ie(ve)/2}:function(ve){return Math.min(ne(ve),ve.p-m.bardelta/2)},ye=y?ae:Y?function(ve){return ve.p+ie(ve)/2}:function(ve){return Math.max(ae(ve),ve.p+m.bardelta/2)};function me(ve,Te,Ae){return M.finiteRange&&(Ae=0),d.inbox(ve-te,Te-te,Ae+Math.min(1,Math.abs(Te-ve)/Z)-1)}function xe(ve){return me(se(ve),ye(ve),R)}function Re(ve){return me(ne(ve),ae(ve),N)}function ke(ve){var Te=ve[P];if(A){var Ae=Math.abs(ve.rawS)||0;H>0?Te+=Ae:H<0&&(Te-=Ae)}return Te}function Ie(ve){var Te=H,Ae=ve.b,Fe=ke(ve);return d.inbox(Ae-Te,Fe-Te,R+(Fe-Te)/(Fe-Ae)-1)}function Q(ve){var Te=H,Ae=ve.b,Fe=ke(ve);return d.inbox(Ae-Te,Fe-Te,N+(Fe-Te)/(Fe-Ae)-1)}var ee=g[U+"a"],D=g[P+"a"];Z=Math.abs(ee.r2c(ee.range[1])-ee.r2c(ee.range[0]));function le(ve){return(re(ve)+G(ve))/2}var ge=d.getDistanceFunction(S,re,G,le);if(d.getClosest(T,ge,g),g.index!==!1&&T[g.index].p!==p){X||(se=function(ve){return Math.min(ne(ve),ve.p-m.bargroupwidth/2)},ye=function(ve){return Math.max(ae(ve),ve.p+m.bargroupwidth/2)});var j=g.index,k=T[j],F=C.base?k.b+k.s:k.s;g[P+"0"]=g[P+"1"]=D.c2p(k[P],!0),g[P+"LabelVal"]=F;var J=m.extents[m.extents.round(k.p)];g[U+"0"]=ee.c2p(y?se(k):J[0],!0),g[U+"1"]=ee.c2p(y?ye(k):J[1],!0);var K=k.orig_p!==void 0;return g[U+"LabelVal"]=K?k.orig_p:k.p,g.labelLabel=h(ee,g[U+"LabelVal"],C[U+"hoverformat"]),g.valueLabel=h(D,g[P+"LabelVal"],C[P+"hoverformat"]),g.baseLabel=h(D,k.b,C[P+"hoverformat"]),g.spikeDistance=(Q(k)+Re(k))/2,g[U+"Spike"]=ee.c2p(k.p,!0),f(k,C,g),g.hovertemplate=C.hovertemplate,g}}function w(g,b){var L=b.mcc||g.marker.color,S=b.mlcc||g.marker.line.color,M=u(g,b);if(s.opacity(L))return L;if(s.opacity(S)&&M)return S}V.exports={hoverPoints:v,hoverOnBars:o,getTraceColor:w}}),eb=t((W,V)=>{V.exports=function(d,i,s){return d.x="xVal"in i?i.xVal:i.x,d.y="yVal"in i?i.yVal:i.y,i.xa&&(d.xaxis=i.xa),i.ya&&(d.yaxis=i.ya),s.orientation==="h"?(d.label=d.y,d.value=d.x):(d.label=d.x,d.value=d.y),d}}),tb=t((W,V)=>{V.exports=function(i,s){var f=i.cd,u=i.xaxis,h=i.yaxis,p=f[0].trace,v=p.type==="funnel",o=p.orientation==="h",w=[],g;if(s===!1)for(g=0;g<f.length;g++)f[g].selected=0;else for(g=0;g<f.length;g++){var b=f[g],L="ct"in b?b.ct:d(b,u,h,o,v);s.contains(L,!1,g,i)?(w.push({pointNumber:g,x:u.c2d(b.x),y:h.c2d(b.y)}),b.selected=1):b.selected=0}return w};function d(i,s,f,u,h){var p=s.c2p(u?i.s0:i.p0,!0),v=s.c2p(u?i.s1:i.p1,!0),o=f.c2p(u?i.p0:i.s0,!0),w=f.c2p(u?i.p1:i.s1,!0);return h?[(p+v)/2,(o+w)/2]:u?[v,(o+w)/2]:[(p+v)/2,w]}}),rb=t((W,V)=>{V.exports={attributes:hd(),layoutAttributes:m1(),supplyDefaults:fd().supplyDefaults,crossTraceDefaults:fd().crossTraceDefaults,supplyLayoutDefaults:Z_(),calc:Q_(),crossTraceCalc:e1().crossTraceCalc,colorbar:t1(),arraysToCalcdata:g1(),plot:K_().plot,style:Af().style,styleOnSelect:Af().styleOnSelect,hoverPoints:$_().hoverPoints,eventData:eb(),selectPoints:tb(),moduleType:"trace",name:"bar",basePlotModule:mf(),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}}),nb=t((W,V)=>{V.exports=rb()}),v1=t((W,V)=>{var d=nt(),i=wf().attributes,s=pt(),f=Zt(),u=jr().hovertemplateAttrs,h=jr().texttemplateAttrs,p=gt().extendFlat,v=Wr().pattern,o=s({editType:"plot",arrayOk:!0,colorEditType:"plot"});V.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:f.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},pattern:v,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:p({},d.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:u({},{keys:["label","color","value","percent","text"]}),texttemplate:h({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:p({},o,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:p({},o,{}),outsidetextfont:p({},o,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:p({},o,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:i({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"}}}),ab=t((W,V)=>{var d=q(),i=Mt(),s=v1(),f=wf().defaults,u=fd().handleText,h=Mt().coercePattern;function p(w,g){var b=i.isArrayOrTypedArray(w),L=i.isArrayOrTypedArray(g),S=Math.min(b?w.length:1/0,L?g.length:1/0);if(isFinite(S)||(S=0),S&&L){for(var M,T=0;T<S;T++){var C=g[T];if(d(C)&&C>0){M=!0;break}}M||(S=0)}return{hasLabels:b,hasValues:L,len:S}}function v(w,g,b,L,S){var M=L("marker.line.width");M&&L("marker.line.color",S?void 0:b.paper_bgcolor);var T=L("marker.colors");h(L,"marker.pattern",T),w.marker&&!g.marker.pattern.fgcolor&&(g.marker.pattern.fgcolor=w.marker.colors),g.marker.pattern.bgcolor||(g.marker.pattern.bgcolor=b.paper_bgcolor)}function o(w,g,b,L){function S(G,Z){return i.coerce(w,g,s,G,Z)}var M=S("labels"),T=S("values"),C=p(M,T),m=C.len;if(g._hasLabels=C.hasLabels,g._hasValues=C.hasValues,!g._hasLabels&&g._hasValues&&(S("label0"),S("dlabel")),!m){g.visible=!1;return}g._length=m,v(w,g,L,S,!0),S("scalegroup");var y=S("text"),A=S("texttemplate"),R;if(A||(R=S("textinfo",i.isArrayOrTypedArray(y)?"text+percent":"percent")),S("hovertext"),S("hovertemplate"),A||R&&R!=="none"){var N=S("textposition");u(w,g,L,S,N,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1});var te=Array.isArray(N)||N==="auto",H=te||N==="outside";H&&S("automargin"),(N==="inside"||N==="auto"||Array.isArray(N))&&S("insidetextorientation")}else R==="none"&&S("textposition","none");f(g,L,S);var U=S("hole"),P=S("title.text");if(P){var re=S("title.position",U?"middle center":"top center");!U&&re==="middle center"&&(g.title.position="top center"),i.coerceFont(S,"title.font",L.font)}S("sort"),S("direction"),S("rotation"),S("pull")}V.exports={handleLabelsAndValues:p,handleMarkerDefaults:v,supplyDefaults:o}}),y1=t((W,V)=>{V.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}}),ib=t((W,V)=>{var d=Mt(),i=y1();V.exports=function(s,f){function u(h,p){return d.coerce(s,f,i,h,p)}u("hiddenlabels"),u("piecolorway",f.colorway),u("extendpiecolors")}}),x1=t((W,V)=>{var d=q(),i=ft(),s=Xt(),f={};function u(o,w){var g=[],b=o._fullLayout,L=b.hiddenlabels||[],S=w.labels,M=w.marker.colors||[],T=w.values,C=w._length,m=w._hasValues&&C,y,A;if(w.dlabel)for(S=new Array(C),y=0;y<C;y++)S[y]=String(w.label0+y*w.dlabel);var R={},N=h(b["_"+w.type+"colormap"]),te=0,H=!1;for(y=0;y<C;y++){var U,P,re;if(m){if(U=T[y],!d(U))continue;U=+U}else U=1;P=S[y],(P===void 0||P==="")&&(P=y),P=String(P);var G=R[P];G===void 0?(R[P]=g.length,re=L.indexOf(P)!==-1,re||(te+=U),g.push({v:U,label:P,color:N(M[y],P),i:y,pts:[y],hidden:re})):(H=!0,A=g[G],A.v+=U,A.pts.push(y),A.hidden||(te+=U),A.color===!1&&M[y]&&(A.color=N(M[y],P)))}g=g.filter(function(Y){return Y.v>=0});var Z=w.type==="funnelarea"?H:w.sort;return Z&&g.sort(function(Y,X){return X.v-Y.v}),g[0]&&(g[0].vTotal=te),g}function h(o){return function(w,g){return!w||(w=i(w),!w.isValid())?!1:(w=s.addOpacity(w,w.getAlpha()),o[g]||(o[g]=w),w)}}function p(o,w){var g=(w||{}).type;g||(g="pie");var b=o._fullLayout,L=o.calcdata,S=b[g+"colorway"],M=b["_"+g+"colormap"];b["extend"+g+"colors"]&&(S=v(S,f));for(var T=0,C=0;C<L.length;C++){var m=L[C],y=m[0].trace.type;if(y===g)for(var A=0;A<m.length;A++){var R=m[A];R.color===!1&&(M[R.label]?R.color=M[R.label]:(M[R.label]=R.color=S[T%S.length],T++))}}}function v(o,w){var g,b=JSON.stringify(o),L=w[b];if(!L){for(L=o.slice(),g=0;g<o.length;g++)L.push(i(o[g]).lighten(20).toHexString());for(g=0;g<o.length;g++)L.push(i(o[g]).darken(20).toHexString());w[b]=L}return L}V.exports={calc:u,crossTraceCalc:p,makePullColorFn:h,generateExtendedColors:v}}),ob=t((W,V)=>{var d=So().appendArrayMultiPointValues;V.exports=function(i,s){var f={curveNumber:s.index,pointNumbers:i.pts,data:s._input,fullData:s,label:i.label,color:i.color,value:i.v,percent:i.percent,text:i.text,bbox:i.bbox,v:i.v};return i.pts.length===1&&(f.pointNumber=f.i=i.pts[0]),d(f,s,i.pts),s.type==="funnelarea"&&(delete f.v,delete f.i),f}}),sb=t((W,V)=>{var d=l(),i=pn(),s=ws(),f=Xt(),u=Ra(),h=Mt(),p=h.strScale,v=h.strTranslate,o=ja(),w=pd(),g=w.recordMinTextSize,b=w.clearMinTextSize,L=Mf().TEXTPAD,S=ho(),M=ob(),T=Mt().isValidTextValue;function C(ee,D){var le=ee._context.staticPlot,ge=ee._fullLayout,j=ge._size;b("pie",ge),N(D,ee),me(D,j);var k=h.makeTraceGroups(ge._pielayer,D,"trace").each(function(F){var J=d.select(this),K=F[0],ve=K.trace;Re(F),J.attr("stroke-linejoin","round"),J.each(function(){var Te=d.select(this).selectAll("g.slice").data(F);Te.enter().append("g").classed("slice",!0),Te.exit().remove();var Ae=[[[],[]],[[],[]]],Fe=!1;Te.each(function(we,je){if(we.hidden){d.select(this).selectAll("path,g").remove();return}we.pointNumber=we.i,we.curveNumber=ve.index,Ae[we.pxmid[1]<0?0:1][we.pxmid[0]<0?0:1].push(we);var ot=K.cx,vt=K.cy,Lt=d.select(this),Tt=Lt.selectAll("path.surface").data([we]);if(Tt.enter().append("path").classed("surface",!0).style({"pointer-events":le?"none":"all"}),Lt.call(y,ee,F),ve.pull){var kt=+S.castOption(ve.pull,we.pts)||0;kt>0&&(ot+=kt*we.pxmid[0],vt+=kt*we.pxmid[1])}we.cxFinal=ot,we.cyFinal=vt;function Nt(sr,De,Je,de){var Me=de*(De[0]-sr[0]),Ce=de*(De[1]-sr[1]);return"a"+de*K.r+","+de*K.r+" 0 "+we.largeArc+(Je?" 1 ":" 0 ")+Me+","+Ce}var Pt=ve.hole;if(we.v===K.vTotal){var Wt="M"+(ot+we.px0[0])+","+(vt+we.px0[1])+Nt(we.px0,we.pxmid,!0,1)+Nt(we.pxmid,we.px0,!0,1)+"Z";Pt?Tt.attr("d","M"+(ot+Pt*we.px0[0])+","+(vt+Pt*we.px0[1])+Nt(we.px0,we.pxmid,!1,Pt)+Nt(we.pxmid,we.px0,!1,Pt)+"Z"+Wt):Tt.attr("d",Wt)}else{var St=Nt(we.px0,we.px1,!0,1);if(Pt){var Qt=1-Pt;Tt.attr("d","M"+(ot+Pt*we.px1[0])+","+(vt+Pt*we.px1[1])+Nt(we.px1,we.px0,!1,Pt)+"l"+Qt*we.px0[0]+","+Qt*we.px0[1]+St+"Z")}else Tt.attr("d","M"+ot+","+vt+"l"+we.px0[0]+","+we.px0[1]+St+"Z")}Ie(ee,we,K);var rr=S.castOption(ve.textposition,we.pts),Jt=Lt.selectAll("g.slicetext").data(we.text&&rr!=="none"?[0]:[]);Jt.enter().append("g").classed("slicetext",!0),Jt.exit().remove(),Jt.each(function(){var sr=h.ensureSingle(d.select(this),"text","",function(et){et.attr("data-notex",1)}),De=h.ensureUniformFontSize(ee,rr==="outside"?A(ve,we,ge.font):R(ve,we,ge.font));sr.text(we.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(u.font,De).call(o.convertToTspans,ee);var Je=u.bBox(sr.node()),de;if(rr==="outside")de=X(Je,we);else if(de=te(Je,we,K),rr==="auto"&&de.scale<1){var Me=h.ensureUniformFontSize(ee,ve.outsidetextfont);sr.call(u.font,Me),Je=u.bBox(sr.node()),de=X(Je,we)}var Ce=de.textPosAngle,Ue=Ce===void 0?we.pxmid:ke(K.r,Ce);if(de.targetX=ot+Ue[0]*de.rCenter+(de.x||0),de.targetY=vt+Ue[1]*de.rCenter+(de.y||0),Q(de,Je),de.outside){var He=de.targetY;we.yLabelMin=He-Je.height/2,we.yLabelMid=He,we.yLabelMax=He+Je.height/2,we.labelExtraX=0,we.labelExtraY=0,Fe=!0}de.fontSize=De.size,g(ve.type,de,ge),F[je].transform=de,h.setTransormAndDisplay(sr,de)})});var Ge=d.select(this).selectAll("g.titletext").data(ve.title.text?[0]:[]);if(Ge.enter().append("g").classed("titletext",!0),Ge.exit().remove(),Ge.each(function(){var we=h.ensureSingle(d.select(this),"text","",function(vt){vt.attr("data-notex",1)}),je=ve.title.text;ve._meta&&(je=h.templateString(je,ve._meta)),we.text(je).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(u.font,ve.title.font).call(o.convertToTspans,ee);var ot;ve.title.position==="middle center"?ot=ne(K):ot=ae(K,j),we.attr("transform",v(ot.x,ot.y)+p(Math.min(1,ot.scale))+v(ot.tx,ot.ty))}),Fe&&ye(Ae,ve),m(Te,ve),Fe&&ve.automargin){var rt=u.bBox(J.node()),bt=ve.domain,ht=j.w*(bt.x[1]-bt.x[0]),ct=j.h*(bt.y[1]-bt.y[0]),Oe=(.5*ht-K.r)/j.w,ze=(.5*ct-K.r)/j.h;i.autoMargin(ee,"pie."+ve.uid+".automargin",{xl:bt.x[0]-Oe,xr:bt.x[1]+Oe,yb:bt.y[0]-ze,yt:bt.y[1]+ze,l:Math.max(K.cx-K.r-rt.left,0),r:Math.max(rt.right-(K.cx+K.r),0),b:Math.max(rt.bottom-(K.cy+K.r),0),t:Math.max(K.cy-K.r-rt.top,0),pad:5})}})});setTimeout(function(){k.selectAll("tspan").each(function(){var F=d.select(this);F.attr("dy")&&F.attr("dy",F.attr("dy"))})},0)}function m(ee,D){ee.each(function(le){var ge=d.select(this);if(!le.labelExtraX&&!le.labelExtraY){ge.select("path.textline").remove();return}var j=ge.select("g.slicetext text");le.transform.targetX+=le.labelExtraX,le.transform.targetY+=le.labelExtraY,h.setTransormAndDisplay(j,le.transform);var k=le.cxFinal+le.pxmid[0],F=le.cyFinal+le.pxmid[1],J="M"+k+","+F,K=(le.yLabelMax-le.yLabelMin)*(le.pxmid[0]<0?-1:1)/4;if(le.labelExtraX){var ve=le.labelExtraX*le.pxmid[1]/le.pxmid[0],Te=le.yLabelMid+le.labelExtraY-(le.cyFinal+le.pxmid[1]);Math.abs(ve)>Math.abs(Te)?J+="l"+Te*le.pxmid[0]/le.pxmid[1]+","+Te+"H"+(k+le.labelExtraX+K):J+="l"+le.labelExtraX+","+ve+"v"+(Te-ve)+"h"+K}else J+="V"+(le.yLabelMid+le.labelExtraY)+"h"+K;h.ensureSingle(ge,"path","textline").call(f.stroke,D.outsidetextfont.color).attr({"stroke-width":Math.min(2,D.outsidetextfont.size/8),d:J,fill:"none"})})}function y(ee,D,le){var ge=le[0],j=ge.cx,k=ge.cy,F=ge.trace,J=F.type==="funnelarea";"_hasHoverLabel"in F||(F._hasHoverLabel=!1),"_hasHoverEvent"in F||(F._hasHoverEvent=!1),ee.on("mouseover",function(K){var ve=D._fullLayout,Te=D._fullData[F.index];if(!(D._dragging||ve.hovermode===!1)){var Ae=Te.hoverinfo;if(Array.isArray(Ae)&&(Ae=s.castHoverinfo({hoverinfo:[S.castOption(Ae,K.pts)],_module:F._module},ve,0)),Ae==="all"&&(Ae="label+text+value+percent+name"),Te.hovertemplate||Ae!=="none"&&Ae!=="skip"&&Ae){var Fe=K.rInscribed||0,Ge=j+K.pxmid[0]*(1-Fe),rt=k+K.pxmid[1]*(1-Fe),bt=ve.separators,ht=[];if(Ae&&Ae.indexOf("label")!==-1&&ht.push(K.label),K.text=S.castOption(Te.hovertext||Te.text,K.pts),Ae&&Ae.indexOf("text")!==-1){var ct=K.text;h.isValidTextValue(ct)&&ht.push(ct)}K.value=K.v,K.valueLabel=S.formatPieValue(K.v,bt),Ae&&Ae.indexOf("value")!==-1&&ht.push(K.valueLabel),K.percent=K.v/ge.vTotal,K.percentLabel=S.formatPiePercent(K.percent,bt),Ae&&Ae.indexOf("percent")!==-1&&ht.push(K.percentLabel);var Oe=Te.hoverlabel,ze=Oe.font,we=[];s.loneHover({trace:F,x0:Ge-Fe*ge.r,x1:Ge+Fe*ge.r,y:rt,_x0:J?j+K.TL[0]:Ge-Fe*ge.r,_x1:J?j+K.TR[0]:Ge+Fe*ge.r,_y0:J?k+K.TL[1]:rt-Fe*ge.r,_y1:J?k+K.BL[1]:rt+Fe*ge.r,text:ht.join("<br>"),name:Te.hovertemplate||Ae.indexOf("name")!==-1?Te.name:void 0,idealAlign:K.pxmid[0]<0?"left":"right",color:S.castOption(Oe.bgcolor,K.pts)||K.color,borderColor:S.castOption(Oe.bordercolor,K.pts),fontFamily:S.castOption(ze.family,K.pts),fontSize:S.castOption(ze.size,K.pts),fontColor:S.castOption(ze.color,K.pts),nameLength:S.castOption(Oe.namelength,K.pts),textAlign:S.castOption(Oe.align,K.pts),hovertemplate:S.castOption(Te.hovertemplate,K.pts),hovertemplateLabels:K,eventData:[M(K,Te)]},{container:ve._hoverlayer.node(),outerContainer:ve._paper.node(),gd:D,inOut_bbox:we}),K.bbox=we[0],F._hasHoverLabel=!0}F._hasHoverEvent=!0,D.emit("plotly_hover",{points:[M(K,Te)],event:d.event})}}),ee.on("mouseout",function(K){var ve=D._fullLayout,Te=D._fullData[F.index],Ae=d.select(this).datum();F._hasHoverEvent&&(K.originalEvent=d.event,D.emit("plotly_unhover",{points:[M(Ae,Te)],event:d.event}),F._hasHoverEvent=!1),F._hasHoverLabel&&(s.loneUnhover(ve._hoverlayer.node()),F._hasHoverLabel=!1)}),ee.on("click",function(K){var ve=D._fullLayout,Te=D._fullData[F.index];D._dragging||ve.hovermode===!1||(D._hoverdata=[M(K,Te)],s.click(D,d.event))})}function A(ee,D,le){var ge=S.castOption(ee.outsidetextfont.color,D.pts)||S.castOption(ee.textfont.color,D.pts)||le.color,j=S.castOption(ee.outsidetextfont.family,D.pts)||S.castOption(ee.textfont.family,D.pts)||le.family,k=S.castOption(ee.outsidetextfont.size,D.pts)||S.castOption(ee.textfont.size,D.pts)||le.size,F=S.castOption(ee.outsidetextfont.weight,D.pts)||S.castOption(ee.textfont.weight,D.pts)||le.weight,J=S.castOption(ee.outsidetextfont.style,D.pts)||S.castOption(ee.textfont.style,D.pts)||le.style,K=S.castOption(ee.outsidetextfont.variant,D.pts)||S.castOption(ee.textfont.variant,D.pts)||le.variant,ve=S.castOption(ee.outsidetextfont.textcase,D.pts)||S.castOption(ee.textfont.textcase,D.pts)||le.textcase,Te=S.castOption(ee.outsidetextfont.lineposition,D.pts)||S.castOption(ee.textfont.lineposition,D.pts)||le.lineposition,Ae=S.castOption(ee.outsidetextfont.shadow,D.pts)||S.castOption(ee.textfont.shadow,D.pts)||le.shadow;return{color:ge,family:j,size:k,weight:F,style:J,variant:K,textcase:ve,lineposition:Te,shadow:Ae}}function R(ee,D,le){var ge=S.castOption(ee.insidetextfont.color,D.pts);!ge&&ee._input.textfont&&(ge=S.castOption(ee._input.textfont.color,D.pts));var j=S.castOption(ee.insidetextfont.family,D.pts)||S.castOption(ee.textfont.family,D.pts)||le.family,k=S.castOption(ee.insidetextfont.size,D.pts)||S.castOption(ee.textfont.size,D.pts)||le.size,F=S.castOption(ee.insidetextfont.weight,D.pts)||S.castOption(ee.textfont.weight,D.pts)||le.weight,J=S.castOption(ee.insidetextfont.style,D.pts)||S.castOption(ee.textfont.style,D.pts)||le.style,K=S.castOption(ee.insidetextfont.variant,D.pts)||S.castOption(ee.textfont.variant,D.pts)||le.variant,ve=S.castOption(ee.insidetextfont.textcase,D.pts)||S.castOption(ee.textfont.textcase,D.pts)||le.textcase,Te=S.castOption(ee.insidetextfont.lineposition,D.pts)||S.castOption(ee.textfont.lineposition,D.pts)||le.lineposition,Ae=S.castOption(ee.insidetextfont.shadow,D.pts)||S.castOption(ee.textfont.shadow,D.pts)||le.shadow;return{color:ge||f.contrast(D.color),family:j,size:k,weight:F,style:J,variant:K,textcase:ve,lineposition:Te,shadow:Ae}}function N(ee,D){for(var le,ge,j=0;j<ee.length;j++)if(le=ee[j][0],ge=le.trace,ge.title.text){var k=ge.title.text;ge._meta&&(k=h.templateString(k,ge._meta));var F=u.tester.append("text").attr("data-notex",1).text(k).call(u.font,ge.title.font).call(o.convertToTspans,D),J=u.bBox(F.node(),!0);le.titleBox={width:J.width,height:J.height},F.remove()}}function te(ee,D,le){var ge=le.r||D.rpx1,j=D.rInscribed,k=D.startangle===D.stopangle;if(k)return{rCenter:1-j,scale:0,rotate:0,textPosAngle:0};var F=D.ring,J=F===1&&Math.abs(D.startangle-D.stopangle)===Math.PI*2,K=D.halfangle,ve=D.midangle,Te=le.trace.insidetextorientation,Ae=Te==="horizontal",Fe=Te==="tangential",Ge=Te==="radial",rt=Te==="auto",bt=[],ht;if(!rt){var ct=function(Lt,Tt){if(H(D,Lt)){var kt=Math.abs(Lt-D.startangle),Nt=Math.abs(Lt-D.stopangle),Pt=kt<Nt?kt:Nt;Tt==="tan"?ht=P(ee,ge,F,Pt,0):ht=U(ee,ge,F,Pt,Math.PI/2),ht.textPosAngle=Lt,bt.push(ht)}},Oe;if(Ae||Fe){for(Oe=4;Oe>=-4;Oe-=2)ct(Math.PI*Oe,"tan");for(Oe=4;Oe>=-4;Oe-=2)ct(Math.PI*(Oe+1),"tan")}if(Ae||Ge){for(Oe=4;Oe>=-4;Oe-=2)ct(Math.PI*(Oe+1.5),"rad");for(Oe=4;Oe>=-4;Oe-=2)ct(Math.PI*(Oe+.5),"rad")}}if(J||rt||Ae){var ze=Math.sqrt(ee.width*ee.width+ee.height*ee.height);if(ht={scale:j*ge*2/ze,rCenter:1-j,rotate:0},ht.textPosAngle=(D.startangle+D.stopangle)/2,ht.scale>=1)return ht;bt.push(ht)}(rt||Ge)&&(ht=U(ee,ge,F,K,ve),ht.textPosAngle=(D.startangle+D.stopangle)/2,bt.push(ht)),(rt||Fe)&&(ht=P(ee,ge,F,K,ve),ht.textPosAngle=(D.startangle+D.stopangle)/2,bt.push(ht));for(var we=0,je=0,ot=0;ot<bt.length;ot++){var vt=bt[ot].scale;if(je<vt&&(je=vt,we=ot),!rt&&je>=1)break}return bt[we]}function H(ee,D){var le=ee.startangle,ge=ee.stopangle;return le>D&&D>ge||le<D&&D<ge}function U(ee,D,le,ge,j){D=Math.max(0,D-2*L);var k=ee.width/ee.height,F=Z(k,ge,D,le);return{scale:F*2/ee.height,rCenter:re(k,F/D),rotate:G(j)}}function P(ee,D,le,ge,j){D=Math.max(0,D-2*L);var k=ee.height/ee.width,F=Z(k,ge,D,le);return{scale:F*2/ee.width,rCenter:re(k,F/D),rotate:G(j+Math.PI/2)}}function re(ee,D){return Math.cos(D)-ee*D}function G(ee){return(180/Math.PI*ee+720)%180-90}function Z(ee,D,le,ge){var j=ee+1/(2*Math.tan(D));return le*Math.min(1/(Math.sqrt(j*j+.5)+j),ge/(Math.sqrt(ee*ee+ge/2)+ee))}function Y(ee,D){return ee.v===D.vTotal&&!D.trace.hole?1:Math.min(1/(1+1/Math.sin(ee.halfangle)),ee.ring/2)}function X(ee,D){var le=D.pxmid[0],ge=D.pxmid[1],j=ee.width/2,k=ee.height/2;return le<0&&(j*=-1),ge<0&&(k*=-1),{scale:1,rCenter:1,rotate:0,x:j+Math.abs(k)*(j>0?1:-1)/2,y:k/(1+le*le/(ge*ge)),outside:!0}}function ne(ee){var D=Math.sqrt(ee.titleBox.width*ee.titleBox.width+ee.titleBox.height*ee.titleBox.height);return{x:ee.cx,y:ee.cy,scale:ee.trace.hole*ee.r*2/D,tx:0,ty:-ee.titleBox.height/2+ee.trace.title.font.size}}function ae(ee,D){var le=1,ge=1,j,k=ee.trace,F={x:ee.cx,y:ee.cy},J={tx:0,ty:0};J.ty+=k.title.font.size,j=se(k),k.title.position.indexOf("top")!==-1?(F.y-=(1+j)*ee.r,J.ty-=ee.titleBox.height):k.title.position.indexOf("bottom")!==-1&&(F.y+=(1+j)*ee.r);var K=B(ee.r,ee.trace.aspectratio),ve=D.w*(k.domain.x[1]-k.domain.x[0])/2;return k.title.position.indexOf("left")!==-1?(ve=ve+K,F.x-=(1+j)*K,J.tx+=ee.titleBox.width/2):k.title.position.indexOf("center")!==-1?ve*=2:k.title.position.indexOf("right")!==-1&&(ve=ve+K,F.x+=(1+j)*K,J.tx-=ee.titleBox.width/2),le=ve/ee.titleBox.width,ge=ie(ee,D)/ee.titleBox.height,{x:F.x,y:F.y,scale:Math.min(le,ge),tx:J.tx,ty:J.ty}}function B(ee,D){return ee/(D===void 0?1:D)}function ie(ee,D){var le=ee.trace,ge=D.h*(le.domain.y[1]-le.domain.y[0]);return Math.min(ee.titleBox.height,ge/2)}function se(ee){var D=ee.pull;if(!D)return 0;var le;if(h.isArrayOrTypedArray(D))for(D=0,le=0;le<ee.pull.length;le++)ee.pull[le]>D&&(D=ee.pull[le]);return D}function ye(ee,D){var le,ge,j,k,F,J,K,ve,Te,Ae,Fe,Ge,rt;function bt(ze,we){return ze.pxmid[1]-we.pxmid[1]}function ht(ze,we){return we.pxmid[1]-ze.pxmid[1]}function ct(ze,we){we||(we={});var je=we.labelExtraY+(ge?we.yLabelMax:we.yLabelMin),ot=ge?ze.yLabelMin:ze.yLabelMax,vt=ge?ze.yLabelMax:ze.yLabelMin,Lt=ze.cyFinal+F(ze.px0[1],ze.px1[1]),Tt=je-ot,kt,Nt,Pt,Wt,St,Qt;if(Tt*K>0&&(ze.labelExtraY=Tt),!!h.isArrayOrTypedArray(D.pull))for(Nt=0;Nt<Ae.length;Nt++)Pt=Ae[Nt],!(Pt===ze||(S.castOption(D.pull,ze.pts)||0)>=(S.castOption(D.pull,Pt.pts)||0))&&((ze.pxmid[1]-Pt.pxmid[1])*K>0?(Wt=Pt.cyFinal+F(Pt.px0[1],Pt.px1[1]),Tt=Wt-ot-ze.labelExtraY,Tt*K>0&&(ze.labelExtraY+=Tt)):(vt+ze.labelExtraY-Lt)*K>0&&(kt=3*J*Math.abs(Nt-Ae.indexOf(ze)),St=Pt.cxFinal+k(Pt.px0[0],Pt.px1[0]),Qt=St+kt-(ze.cxFinal+ze.pxmid[0])-ze.labelExtraX,Qt*J>0&&(ze.labelExtraX+=Qt)))}for(ge=0;ge<2;ge++)for(j=ge?bt:ht,F=ge?Math.max:Math.min,K=ge?1:-1,le=0;le<2;le++){for(k=le?Math.max:Math.min,J=le?1:-1,ve=ee[ge][le],ve.sort(j),Te=ee[1-ge][le],Ae=Te.concat(ve),Ge=[],Fe=0;Fe<ve.length;Fe++)ve[Fe].yLabelMid!==void 0&&Ge.push(ve[Fe]);for(rt=!1,Fe=0;ge&&Fe<Te.length;Fe++)if(Te[Fe].yLabelMid!==void 0){rt=Te[Fe];break}for(Fe=0;Fe<Ge.length;Fe++){var Oe=Fe&&Ge[Fe-1];rt&&!Fe&&(Oe=rt),ct(Ge[Fe],Oe)}}}function me(ee,D){for(var le=[],ge=0;ge<ee.length;ge++){var j=ee[ge][0],k=j.trace,F=k.domain,J=D.w*(F.x[1]-F.x[0]),K=D.h*(F.y[1]-F.y[0]);k.title.text&&k.title.position!=="middle center"&&(K-=ie(j,D));var ve=J/2,Te=K/2;k.type==="funnelarea"&&!k.scalegroup&&(Te/=k.aspectratio),j.r=Math.min(ve,Te)/(1+se(k)),j.cx=D.l+D.w*(k.domain.x[1]+k.domain.x[0])/2,j.cy=D.t+D.h*(1-k.domain.y[0])-K/2,k.title.text&&k.title.position.indexOf("bottom")!==-1&&(j.cy-=ie(j,D)),k.scalegroup&&le.indexOf(k.scalegroup)===-1&&le.push(k.scalegroup)}xe(ee,le)}function xe(ee,D){for(var le,ge,j,k=0;k<D.length;k++){var F=1/0,J=D[k];for(ge=0;ge<ee.length;ge++)if(le=ee[ge][0],j=le.trace,j.scalegroup===J){var K;if(j.type==="pie")K=le.r*le.r;else if(j.type==="funnelarea"){var ve,Te;j.aspectratio>1?(ve=le.r,Te=ve/j.aspectratio):(Te=le.r,ve=Te*j.aspectratio),ve*=(1+j.baseratio)/2,K=ve*Te}F=Math.min(F,K/le.vTotal)}for(ge=0;ge<ee.length;ge++)if(le=ee[ge][0],j=le.trace,j.scalegroup===J){var Ae=F*le.vTotal;j.type==="funnelarea"&&(Ae/=(1+j.baseratio)/2,Ae/=j.aspectratio),le.r=Math.sqrt(Ae)}}}function Re(ee){var D=ee[0],le=D.r,ge=D.trace,j=S.getRotationAngle(ge.rotation),k=2*Math.PI/D.vTotal,F="px0",J="px1",K,ve,Te;if(ge.direction==="counterclockwise"){for(K=0;K<ee.length&&ee[K].hidden;K++);if(K===ee.length)return;j+=k*ee[K].v,k*=-1,F="px1",J="px0"}for(Te=ke(le,j),K=0;K<ee.length;K++)ve=ee[K],!ve.hidden&&(ve[F]=Te,ve.startangle=j,j+=k*ve.v/2,ve.pxmid=ke(le,j),ve.midangle=j,j+=k*ve.v/2,Te=ke(le,j),ve.stopangle=j,ve[J]=Te,ve.largeArc=ve.v>D.vTotal/2?1:0,ve.halfangle=Math.PI*Math.min(ve.v/D.vTotal,.5),ve.ring=1-ge.hole,ve.rInscribed=Y(ve,D))}function ke(ee,D){return[ee*Math.sin(D),-ee*Math.cos(D)]}function Ie(ee,D,le){var ge=ee._fullLayout,j=le.trace,k=j.texttemplate,F=j.textinfo;if(!k&&F&&F!=="none"){var J=F.split("+"),K=function(we){return J.indexOf(we)!==-1},ve=K("label"),Te=K("text"),Ae=K("value"),Fe=K("percent"),Ge=ge.separators,rt;if(rt=ve?[D.label]:[],Te){var bt=S.getFirstFilled(j.text,D.pts);T(bt)&&rt.push(bt)}Ae&&rt.push(S.formatPieValue(D.v,Ge)),Fe&&rt.push(S.formatPiePercent(D.v/le.vTotal,Ge)),D.text=rt.join("<br>")}function ht(we){return{label:we.label,value:we.v,valueLabel:S.formatPieValue(we.v,ge.separators),percent:we.v/le.vTotal,percentLabel:S.formatPiePercent(we.v/le.vTotal,ge.separators),color:we.color,text:we.text,customdata:h.castOption(j,we.i,"customdata")}}if(k){var ct=h.castOption(j,D.i,"texttemplate");if(!ct)D.text="";else{var Oe=ht(D),ze=S.getFirstFilled(j.text,D.pts);(T(ze)||ze==="")&&(Oe.text=ze),D.text=h.texttemplateString(ct,Oe,ee._fullLayout._d3locale,Oe,j._meta||{})}}}function Q(ee,D){var le=ee.rotate*Math.PI/180,ge=Math.cos(le),j=Math.sin(le),k=(D.left+D.right)/2,F=(D.top+D.bottom)/2;ee.textX=k*ge-F*j,ee.textY=k*j+F*ge,ee.noCenter=!0}V.exports={plot:C,formatSliceLabel:Ie,transformInsideText:te,determineInsideTextFont:R,positionTitleOutside:ae,prerenderTitles:N,layoutAreas:me,attachFxHandlers:y,computeTransform:Q}}),lb=t((W,V)=>{var d=l(),i=bs(),s=pd().resizeText;V.exports=function(f){var u=f._fullLayout._pielayer.selectAll(".trace");s(f,u,"pie"),u.each(function(h){var p=h[0],v=p.trace,o=d.select(this);o.style({opacity:v.opacity}),o.selectAll("path.surface").each(function(w){d.select(this).call(i,w,v,f)})})}}),cb=t(W=>{var V=pn();W.name="pie",W.plot=function(d,i,s,f){V.plotBasePlot(W.name,d,i,s,f)},W.clean=function(d,i,s,f){V.cleanBasePlot(W.name,d,i,s,f)}}),ub=t((W,V)=>{V.exports={attributes:v1(),supplyDefaults:ab().supplyDefaults,supplyLayoutDefaults:ib(),layoutAttributes:y1(),calc:x1().calc,crossTraceCalc:x1().crossTraceCalc,plot:sb().plot,style:lb(),styleOne:bs(),moduleType:"trace",name:"pie",basePlotModule:cb(),categories:["pie-like","pie","showLegend"],meta:{}}}),db=t((W,V)=>{V.exports=ub()}),ro=t((W,V)=>{var d=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function f(h){if(h==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(h)}function u(){try{if(!Object.assign)return!1;var h=new String("abc");if(h[5]="de",Object.getOwnPropertyNames(h)[0]==="5")return!1;for(var p={},v=0;v<10;v++)p["_"+String.fromCharCode(v)]=v;var o=Object.getOwnPropertyNames(p).map(function(g){return p[g]});if(o.join("")!=="0123456789")return!1;var w={};return"abcdefghijklmnopqrst".split("").forEach(function(g){w[g]=g}),Object.keys(Object.assign({},w)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}V.exports=u()?Object.assign:function(h,p){for(var v,o=f(h),w,g=1;g<arguments.length;g++){v=Object(arguments[g]);for(var b in v)i.call(v,b)&&(o[b]=v[b]);if(d){w=d(v);for(var L=0;L<w.length;L++)s.call(v,w[L])&&(o[w[L]]=v[w[L]])}}return o}}),no=t((W,V)=>{var d=ro();function i(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}d(i.prototype,{instance:function(v,o){v=(v||"gregorian").toLowerCase(),o=o||"";var w=this._localCals[v+"-"+o];if(!w&&this.calendars[v]&&(w=new this.calendars[v](o),this._localCals[v+"-"+o]=w),!w)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,v);return w},newDate:function(v,o,w,g,b){return g=(v!=null&&v.year?v.calendar():typeof g=="string"?this.instance(g,b):g)||this.instance(),g.newDate(v,o,w)},substituteDigits:function(v){return function(o){return(o+"").replace(/[0-9]/g,function(w){return v[w]})}},substituteChineseDigits:function(v,o){return function(w){for(var g="",b=0;w>0;){var L=w%10;g=(L===0?"":v[L]+o[b])+g,b++,w=Math.floor(w/10)}return g.indexOf(v[1]+o[1])===0&&(g=g.substr(1)),g||v[0]}}});function s(v,o,w,g){if(this._calendar=v,this._year=o,this._month=w,this._day=g,this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day))throw(p.local.invalidDate||p.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function f(v,o){return v=""+v,"000000".substring(0,o-v.length)+v}d(s.prototype,{newDate:function(v,o,w){return this._calendar.newDate(v??this,o,w)},year:function(v){return arguments.length===0?this._year:this.set(v,"y")},month:function(v){return arguments.length===0?this._month:this.set(v,"m")},day:function(v){return arguments.length===0?this._day:this.set(v,"d")},date:function(v,o,w){if(!this._calendar.isValid(v,o,w))throw(p.local.invalidDate||p.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=v,this._month=o,this._day=w,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(v,o){return this._calendar.add(this,v,o)},set:function(v,o){return this._calendar.set(this,v,o)},compareTo:function(v){if(this._calendar.name!==v._calendar.name)throw(p.local.differentCalendars||p.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,v._calendar.local.name);var o=this._year!==v._year?this._year-v._year:this._month!==v._month?this.monthOfYear()-v.monthOfYear():this._day-v._day;return o===0?0:o<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(v){return this._calendar.fromJD(v)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(v){return this._calendar.fromJSDate(v)},toString:function(){return(this.year()<0?"-":"")+f(Math.abs(this.year()),4)+"-"+f(this.month(),2)+"-"+f(this.day(),2)}});function u(){this.shortYearCutoff="+10"}d(u.prototype,{_validateLevel:0,newDate:function(v,o,w){return v==null?this.today():(v.year&&(this._validate(v,o,w,p.local.invalidDate||p.regionalOptions[""].invalidDate),w=v.day(),o=v.month(),v=v.year()),new s(this,v,o,w))},today:function(){return this.fromJSDate(new Date)},epoch:function(v){var o=this._validate(v,this.minMonth,this.minDay,p.local.invalidYear||p.regionalOptions[""].invalidYear);return o.year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(v){var o=this._validate(v,this.minMonth,this.minDay,p.local.invalidYear||p.regionalOptions[""].invalidYear);return(o.year()<0?"-":"")+f(Math.abs(o.year()),4)},monthsInYear:function(v){return this._validate(v,this.minMonth,this.minDay,p.local.invalidYear||p.regionalOptions[""].invalidYear),12},monthOfYear:function(v,o){var w=this._validate(v,o,this.minDay,p.local.invalidMonth||p.regionalOptions[""].invalidMonth);return(w.month()+this.monthsInYear(w)-this.firstMonth)%this.monthsInYear(w)+this.minMonth},fromMonthOfYear:function(v,o){var w=(o+this.firstMonth-2*this.minMonth)%this.monthsInYear(v)+this.minMonth;return this._validate(v,w,this.minDay,p.local.invalidMonth||p.regionalOptions[""].invalidMonth),w},daysInYear:function(v){var o=this._validate(v,this.minMonth,this.minDay,p.local.invalidYear||p.regionalOptions[""].invalidYear);return this.leapYear(o)?366:365},dayOfYear:function(v,o,w){var g=this._validate(v,o,w,p.local.invalidDate||p.regionalOptions[""].invalidDate);return g.toJD()-this.newDate(g.year(),this.fromMonthOfYear(g.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(v,o,w){var g=this._validate(v,o,w,p.local.invalidDate||p.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(g))+2)%this.daysInWeek()},extraInfo:function(v,o,w){return this._validate(v,o,w,p.local.invalidDate||p.regionalOptions[""].invalidDate),{}},add:function(v,o,w){return this._validate(v,this.minMonth,this.minDay,p.local.invalidDate||p.regionalOptions[""].invalidDate),this._correctAdd(v,this._add(v,o,w),o,w)},_add:function(v,o,w){if(this._validateLevel++,w==="d"||w==="w"){var g=v.toJD()+o*(w==="w"?this.daysInWeek():1),b=v.calendar().fromJD(g);return this._validateLevel--,[b.year(),b.month(),b.day()]}try{var L=v.year()+(w==="y"?o:0),S=v.monthOfYear()+(w==="m"?o:0),b=v.day(),M=function(m){for(;S<m.minMonth;)L--,S+=m.monthsInYear(L);for(var y=m.monthsInYear(L);S>y-1+m.minMonth;)L++,S-=y,y=m.monthsInYear(L)};w==="y"?(v.month()!==this.fromMonthOfYear(L,S)&&(S=this.newDate(L,v.month(),this.minDay).monthOfYear()),S=Math.min(S,this.monthsInYear(L)),b=Math.min(b,this.daysInMonth(L,this.fromMonthOfYear(L,S)))):w==="m"&&(M(this),b=Math.min(b,this.daysInMonth(L,this.fromMonthOfYear(L,S))));var T=[L,this.fromMonthOfYear(L,S),b];return this._validateLevel--,T}catch(C){throw this._validateLevel--,C}},_correctAdd:function(v,o,w,g){if(!this.hasYearZero&&(g==="y"||g==="m")&&(o[0]===0||v.year()>0!=o[0]>0)){var b={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[g],L=w<0?-1:1;o=this._add(v,w*b[0]+L*b[1],b[2])}return v.date(o[0],o[1],o[2])},set:function(v,o,w){this._validate(v,this.minMonth,this.minDay,p.local.invalidDate||p.regionalOptions[""].invalidDate);var g=w==="y"?o:v.year(),b=w==="m"?o:v.month(),L=w==="d"?o:v.day();return(w==="y"||w==="m")&&(L=Math.min(L,this.daysInMonth(g,b))),v.date(g,b,L)},isValid:function(v,o,w){this._validateLevel++;var g=this.hasYearZero||v!==0;if(g){var b=this.newDate(v,o,this.minDay);g=o>=this.minMonth&&o-this.minMonth<this.monthsInYear(b)&&w>=this.minDay&&w-this.minDay<this.daysInMonth(b)}return this._validateLevel--,g},toJSDate:function(v,o,w){var g=this._validate(v,o,w,p.local.invalidDate||p.regionalOptions[""].invalidDate);return p.instance().fromJD(this.toJD(g)).toJSDate()},fromJSDate:function(v){return this.fromJD(p.instance().fromJSDate(v).toJD())},_validate:function(v,o,w,g){if(v.year){if(this._validateLevel===0&&this.name!==v.calendar().name)throw(p.local.differentCalendars||p.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,v.calendar().local.name);return v}try{if(this._validateLevel++,this._validateLevel===1&&!this.isValid(v,o,w))throw g.replace(/\{0\}/,this.local.name);var b=this.newDate(v,o,w);return this._validateLevel--,b}catch(L){throw this._validateLevel--,L}}});function h(v){this.local=this.regionalOptions[v]||this.regionalOptions[""]}h.prototype=new u,d(h.prototype,{name:"Gregorian",jdEpoch:17214255e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(w){var o=this._validate(w,this.minMonth,this.minDay,p.local.invalidYear||p.regionalOptions[""].invalidYear),w=o.year()+(o.year()<0?1:0);return w%4===0&&(w%100!==0||w%400===0)},weekOfYear:function(v,o,w){var g=this.newDate(v,o,w);return g.add(4-(g.dayOfWeek()||7),"d"),Math.floor((g.dayOfYear()-1)/7)+1},daysInMonth:function(v,o){var w=this._validate(v,o,this.minDay,p.local.invalidMonth||p.regionalOptions[""].invalidMonth);return this.daysPerMonth[w.month()-1]+(w.month()===2&&this.leapYear(w.year())?1:0)},weekDay:function(v,o,w){return(this.dayOfWeek(v,o,w)||7)<6},toJD:function(v,o,w){var g=this._validate(v,o,w,p.local.invalidDate||p.regionalOptions[""].invalidDate);v=g.year(),o=g.month(),w=g.day(),v<0&&v++,o<3&&(o+=12,v--);var b=Math.floor(v/100),L=2-b+Math.floor(b/4);return Math.floor(365.25*(v+4716))+Math.floor(30.6001*(o+1))+w+L-1524.5},fromJD:function(v){var o=Math.floor(v+.5),w=Math.floor((o-186721625e-2)/36524.25);w=o+1+w-Math.floor(w/4);var g=w+1524,b=Math.floor((g-122.1)/365.25),L=Math.floor(365.25*b),S=Math.floor((g-L)/30.6001),M=g-L-Math.floor(S*30.6001),T=S-(S>13.5?13:1),C=b-(T>2.5?4716:4715);return C<=0&&C--,this.newDate(C,T,M)},toJSDate:function(v,o,w){var g=this._validate(v,o,w,p.local.invalidDate||p.regionalOptions[""].invalidDate),b=new Date(g.year(),g.month()-1,g.day());return b.setHours(0),b.setMinutes(0),b.setSeconds(0),b.setMilliseconds(0),b.setHours(b.getHours()>12?b.getHours()+2:0),b},fromJSDate:function(v){return this.newDate(v.getFullYear(),v.getMonth()+1,v.getDate())}});var p=V.exports=new i;p.cdate=s,p.baseCalendar=u,p.calendars.gregorian=h}),hb=t(()=>{var W=ro(),V=no();W(V.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),V.local=V.regionalOptions[""],W(V.cdate.prototype,{formatDate:function(d,i){return typeof d!="string"&&(i=d,d=""),this._calendar.formatDate(d||"",this,i)}}),W(V.baseCalendar.prototype,{UNIX_EPOCH:V.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:1440*60,TICKS_EPOCH:V.instance().jdEpoch,TICKS_PER_DAY:1440*60*1e7,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(d,i,s){if(typeof d!="string"&&(s=i,i=d,d=""),!i)return"";if(i.calendar()!==this)throw V.local.invalidFormat||V.regionalOptions[""].invalidFormat;d=d||this.local.dateFormat,s=s||{};for(var f=s.dayNamesShort||this.local.dayNamesShort,u=s.dayNames||this.local.dayNames,h=s.monthNumbers||this.local.monthNumbers,p=s.monthNamesShort||this.local.monthNamesShort,v=s.monthNames||this.local.monthNames,o=s.calculateWeek||this.local.calculateWeek,w=function(R,N){for(var te=1;A+te<d.length&&d.charAt(A+te)===R;)te++;return A+=te-1,Math.floor(te/(N||1))>1},g=function(R,N,te,H){var U=""+N;if(w(R,H))for(;U.length<te;)U="0"+U;return U},b=function(R,N,te,H){return w(R)?H[N]:te[N]},L=this,S=function(R){return typeof h=="function"?h.call(L,R,w("m")):C(g("m",R.month(),2))},M=function(R,N){return N?typeof v=="function"?v.call(L,R):v[R.month()-L.minMonth]:typeof p=="function"?p.call(L,R):p[R.month()-L.minMonth]},T=this.local.digits,C=function(R){return s.localNumbers&&T?T(R):R},m="",y=!1,A=0;A<d.length;A++)if(y)d.charAt(A)==="'"&&!w("'")?y=!1:m+=d.charAt(A);else switch(d.charAt(A)){case"d":m+=C(g("d",i.day(),2));break;case"D":m+=b("D",i.dayOfWeek(),f,u);break;case"o":m+=g("o",i.dayOfYear(),3);break;case"w":m+=g("w",i.weekOfYear(),2);break;case"m":m+=S(i);break;case"M":m+=M(i,w("M"));break;case"y":m+=w("y",2)?i.year():(i.year()%100<10?"0":"")+i.year()%100;break;case"Y":w("Y",2),m+=i.formatYear();break;case"J":m+=i.toJD();break;case"@":m+=(i.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":m+=(i.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":w("'")?m+="'":y=!0;break;default:m+=d.charAt(A)}return m},parseDate:function(d,i,s){if(i==null)throw V.local.invalidArguments||V.regionalOptions[""].invalidArguments;if(i=typeof i=="object"?i.toString():i+"",i==="")return null;d=d||this.local.dateFormat,s=s||{};var f=s.shortYearCutoff||this.shortYearCutoff;f=typeof f!="string"?f:this.today().year()%100+parseInt(f,10);for(var u=s.dayNamesShort||this.local.dayNamesShort,h=s.dayNames||this.local.dayNames,p=s.parseMonth||this.local.parseMonth,v=s.monthNumbers||this.local.monthNumbers,o=s.monthNamesShort||this.local.monthNamesShort,w=s.monthNames||this.local.monthNames,g=-1,b=-1,L=-1,S=-1,M=-1,T=!1,C=!1,m=function(Z,Y){for(var X=1;P+X<d.length&&d.charAt(P+X)===Z;)X++;return P+=X-1,Math.floor(X/(Y||1))>1},y=function(Z,Y){var X=m(Z,Y),ne=[2,3,X?4:2,X?4:2,10,11,20]["oyYJ@!".indexOf(Z)+1],ae=new RegExp("^-?\\d{1,"+ne+"}"),B=i.substring(U).match(ae);if(!B)throw(V.local.missingNumberAt||V.regionalOptions[""].missingNumberAt).replace(/\{0\}/,U);return U+=B[0].length,parseInt(B[0],10)},A=this,R=function(){if(typeof v=="function"){m("m");var Z=v.call(A,i.substring(U));return U+=Z.length,Z}return y("m")},N=function(Z,Y,X,ne){for(var ae=m(Z,ne)?X:Y,B=0;B<ae.length;B++)if(i.substr(U,ae[B].length).toLowerCase()===ae[B].toLowerCase())return U+=ae[B].length,B+A.minMonth;throw(V.local.unknownNameAt||V.regionalOptions[""].unknownNameAt).replace(/\{0\}/,U)},te=function(){if(typeof w=="function"){var Z=m("M")?w.call(A,i.substring(U)):o.call(A,i.substring(U));return U+=Z.length,Z}return N("M",o,w)},H=function(){if(i.charAt(U)!==d.charAt(P))throw(V.local.unexpectedLiteralAt||V.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,U);U++},U=0,P=0;P<d.length;P++)if(C)d.charAt(P)==="'"&&!m("'")?C=!1:H();else switch(d.charAt(P)){case"d":S=y("d");break;case"D":N("D",u,h);break;case"o":M=y("o");break;case"w":y("w");break;case"m":L=R();break;case"M":L=te();break;case"y":var re=P;T=!m("y",2),P=re,b=y("y",2);break;case"Y":b=y("Y",2);break;case"J":g=y("J")+.5,i.charAt(U)==="."&&(U++,y("J"));break;case"@":g=y("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":g=y("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":U=i.length;break;case"'":m("'")?H():C=!0;break;default:H()}if(U<i.length)throw V.local.unexpectedText||V.regionalOptions[""].unexpectedText;if(b===-1?b=this.today().year():b<100&&T&&(b+=f===-1?1900:this.today().year()-this.today().year()%100-(b<=f?0:100)),typeof L=="string"&&(L=p.call(this,b,L)),M>-1){L=1,S=M;for(var G=this.daysInMonth(b,L);S>G;G=this.daysInMonth(b,L))L++,S-=G}return g>-1?this.fromJD(g):this.newDate(b,L,S)},determineDate:function(d,i,s,f,u){s&&typeof s!="object"&&(u=f,f=s,s=null),typeof f!="string"&&(u=f,f="");var h=this,p=function(v){try{return h.parseDate(f,v,u)}catch{}v=v.toLowerCase();for(var o=(v.match(/^c/)&&s?s.newDate():null)||h.today(),w=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,g=w.exec(v);g;)o.add(parseInt(g[1],10),g[2]||"d"),g=w.exec(v);return o};return i=i?i.newDate():null,d=d==null?i:typeof d=="string"?p(d):typeof d=="number"?isNaN(d)||d===1/0||d===-1/0?i:h.today().add(d,"d"):h.newDate(d),d}})}),fb=t(()=>{var W=no(),V=ro(),d=W.instance();function i(g){this.local=this.regionalOptions[g||""]||this.regionalOptions[""]}i.prototype=new W.baseCalendar,V(i.prototype,{name:"Chinese",jdEpoch:17214255e-1,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(g,b){if(typeof g=="string"){var L=g.match(f);return L?L[0]:""}var S=this._validateYear(g),M=g.month(),T=""+this.toChineseMonth(S,M);return b&&T.length<2&&(T="0"+T),this.isIntercalaryMonth(S,M)&&(T+="i"),T},monthNames:function(g){if(typeof g=="string"){var b=g.match(u);return b?b[0]:""}var L=this._validateYear(g),S=g.month(),M=this.toChineseMonth(L,S),T=["","","","","","","","","","","",""][M-1];return this.isIntercalaryMonth(L,S)&&(T=""+T),T},monthNamesShort:function(g){if(typeof g=="string"){var b=g.match(h);return b?b[0]:""}var L=this._validateYear(g),S=g.month(),M=this.toChineseMonth(L,S),T=["","","","","","","","","","","",""][M-1];return this.isIntercalaryMonth(L,S)&&(T=""+T),T},parseMonth:function(g,b){g=this._validateYear(g);var L=parseInt(b),S;if(isNaN(L))b[0]===""&&(S=!0,b=b.substring(1)),b[b.length-1]===""&&(b=b.substring(0,b.length-1)),L=1+["","","","","","","","","","","",""].indexOf(b);else{var M=b[b.length-1];S=M==="i"||M==="I"}var T=this.toMonthIndex(g,L,S);return T},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(g,b){if(g.year&&(g=g.year()),typeof g!="number"||g<1888||g>2111)throw b.replace(/\{0\}/,this.local.name);return g},toMonthIndex:function(g,b,L){var S=this.intercalaryMonth(g),M=L&&b!==S;if(M||b<1||b>12)throw W.local.invalidMonth.replace(/\{0\}/,this.local.name);var T;return S?!L&&b<=S?T=b-1:T=b:T=b-1,T},toChineseMonth:function(g,b){g.year&&(g=g.year(),b=g.month());var L=this.intercalaryMonth(g),S=L?12:11;if(b<0||b>S)throw W.local.invalidMonth.replace(/\{0\}/,this.local.name);var M;return L?b<L?M=b+1:M=b:M=b+1,M},intercalaryMonth:function(g){g=this._validateYear(g);var b=p[g-p[0]],L=b>>13;return L},isIntercalaryMonth:function(g,b){g.year&&(g=g.year(),b=g.month());var L=this.intercalaryMonth(g);return!!L&&L===b},leapYear:function(g){return this.intercalaryMonth(g)!==0},weekOfYear:function(g,b,L){var S=this._validateYear(g,W.local.invalidyear),M=v[S-v[0]],T=M>>9&4095,C=M>>5&15,m=M&31,y;y=d.newDate(T,C,m),y.add(4-(y.dayOfWeek()||7),"d");var A=this.toJD(g,b,L)-y.toJD();return 1+Math.floor(A/7)},monthsInYear:function(g){return this.leapYear(g)?13:12},daysInMonth:function(g,b){g.year&&(b=g.month(),g=g.year()),g=this._validateYear(g);var L=p[g-p[0]],S=L>>13,M=S?12:11;if(b>M)throw W.local.invalidMonth.replace(/\{0\}/,this.local.name);var T=L&1<<12-b?30:29;return T},weekDay:function(g,b,L){return(this.dayOfWeek(g,b,L)||7)<6},toJD:function(g,b,L){var S=this._validate(g,T,L,W.local.invalidDate);g=this._validateYear(S.year()),b=S.month(),L=S.day();var M=this.isIntercalaryMonth(g,b),T=this.toChineseMonth(g,b),C=w(g,T,L,M);return d.toJD(C.year,C.month,C.day)},fromJD:function(g){var b=d.fromJD(g),L=o(b.year(),b.month(),b.day()),S=this.toMonthIndex(L.year,L.month,L.isIntercalary);return this.newDate(L.year,S,L.day)},fromString:function(g){var b=g.match(s),L=this._validateYear(+b[1]),S=+b[2],M=!!b[3],T=this.toMonthIndex(L,S,M),C=+b[4];return this.newDate(L,T,C)},add:function(g,b,L){var S=g.year(),M=g.month(),T=this.isIntercalaryMonth(S,M),C=this.toChineseMonth(S,M),m=Object.getPrototypeOf(i.prototype).add.call(this,g,b,L);if(L==="y"){var y=m.year(),A=m.month(),R=this.isIntercalaryMonth(y,C),N=T&&R?this.toMonthIndex(y,C,!0):this.toMonthIndex(y,C,!1);N!==A&&m.month(N)}return m}});var s=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,f=/^\d?\d[iI]?/m,u=/^??[]?/m,h=/^??[]?/m;W.calendars.chinese=i;var p=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],v=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904];function o(g,b,L,S){var M,T;if(typeof g=="object")M=g,T=b||{};else{var C=typeof g=="number"&&g>=1888&&g<=2111;if(!C)throw new Error("Solar year outside range 1888-2111");var m=typeof b=="number"&&b>=1&&b<=12;if(!m)throw new Error("Solar month outside range 1 - 12");var y=typeof L=="number"&&L>=1&&L<=31;if(!y)throw new Error("Solar day outside range 1 - 31");M={year:g,month:b,day:L},T={}}var A=v[M.year-v[0]],R=M.year<<9|M.month<<5|M.day;T.year=R>=A?M.year:M.year-1,A=v[T.year-v[0]];var N=A>>9&4095,te=A>>5&15,H=A&31,U,P=new Date(N,te-1,H),re=new Date(M.year,M.month-1,M.day);U=Math.round((re-P)/(24*3600*1e3));var G=p[T.year-p[0]],Z;for(Z=0;Z<13;Z++){var Y=G&1<<12-Z?30:29;if(U<Y)break;U-=Y}var X=G>>13;return!X||Z<X?(T.isIntercalary=!1,T.month=1+Z):Z===X?(T.isIntercalary=!0,T.month=Z):(T.isIntercalary=!1,T.month=Z),T.day=1+U,T}function w(g,b,L,S,M){var T,C;if(typeof g=="object")C=g,T=b||{};else{var m=typeof g=="number"&&g>=1888&&g<=2111;if(!m)throw new Error("Lunar year outside range 1888-2111");var y=typeof b=="number"&&b>=1&&b<=12;if(!y)throw new Error("Lunar month outside range 1 - 12");var A=typeof L=="number"&&L>=1&&L<=30;if(!A)throw new Error("Lunar day outside range 1 - 30");var R;typeof S=="object"?(R=!1,T=S):(R=!!S,T={}),C={year:g,month:b,day:L,isIntercalary:R}}var N;N=C.day-1;var te=p[C.year-p[0]],H=te>>13,U;H&&(C.month>H||C.isIntercalary)?U=C.month:U=C.month-1;for(var P=0;P<U;P++){var re=te&1<<12-P?30:29;N+=re}var G=v[C.year-v[0]],Z=G>>9&4095,Y=G>>5&15,X=G&31,ne=new Date(Z,Y-1,X+N);return T.year=ne.getFullYear(),T.month=1+ne.getMonth(),T.day=ne.getDate(),T}}),pb=t(()=>{var W=no(),V=ro();function d(i){this.local=this.regionalOptions[i||""]||this.regionalOptions[""]}d.prototype=new W.baseCalendar,V(d.prototype,{name:"Coptic",jdEpoch:18250295e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(f){var s=this._validate(f,this.minMonth,this.minDay,W.local.invalidYear),f=s.year()+(s.year()<0?1:0);return f%4===3||f%4===-1},monthsInYear:function(i){return this._validate(i,this.minMonth,this.minDay,W.local.invalidYear||W.regionalOptions[""].invalidYear),13},weekOfYear:function(i,s,f){var u=this.newDate(i,s,f);return u.add(-u.dayOfWeek(),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInMonth:function(i,s){var f=this._validate(i,s,this.minDay,W.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===13&&this.leapYear(f.year())?1:0)},weekDay:function(i,s,f){return(this.dayOfWeek(i,s,f)||7)<6},toJD:function(i,s,f){var u=this._validate(i,s,f,W.local.invalidDate);return i=u.year(),i<0&&i++,u.day()+(u.month()-1)*30+(i-1)*365+Math.floor(i/4)+this.jdEpoch-1},fromJD:function(i){var s=Math.floor(i)+.5-this.jdEpoch,f=Math.floor((s-Math.floor((s+366)/1461))/365)+1;f<=0&&f--,s=Math.floor(i)+.5-this.newDate(f,1,1).toJD();var u=Math.floor(s/30)+1,h=s-(u-1)*30+1;return this.newDate(f,u,h)}}),W.calendars.coptic=d}),mb=t(()=>{var W=no(),V=ro();function d(s){this.local=this.regionalOptions[s||""]||this.regionalOptions[""]}d.prototype=new W.baseCalendar,V(d.prototype,{name:"Discworld",jdEpoch:17214255e-1,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(s){return this._validate(s,this.minMonth,this.minDay,W.local.invalidYear),!1},monthsInYear:function(s){return this._validate(s,this.minMonth,this.minDay,W.local.invalidYear),13},daysInYear:function(s){return this._validate(s,this.minMonth,this.minDay,W.local.invalidYear),400},weekOfYear:function(s,f,u){var h=this.newDate(s,f,u);return h.add(-h.dayOfWeek(),"d"),Math.floor((h.dayOfYear()-1)/8)+1},daysInMonth:function(s,f){var u=this._validate(s,f,this.minDay,W.local.invalidMonth);return this.daysPerMonth[u.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(s,f,u){var h=this._validate(s,f,u,W.local.invalidDate);return(h.day()+1)%8},weekDay:function(s,f,u){var h=this.dayOfWeek(s,f,u);return h>=2&&h<=6},extraInfo:function(s,f,u){var h=this._validate(s,f,u,W.local.invalidDate);return{century:i[Math.floor((h.year()-1)/100)+1]||""}},toJD:function(s,f,u){var h=this._validate(s,f,u,W.local.invalidDate);return s=h.year()+(h.year()<0?1:0),f=h.month(),u=h.day(),u+(f>1?16:0)+(f>2?(f-2)*32:0)+(s-1)*400+this.jdEpoch-1},fromJD:function(s){s=Math.floor(s+.5)-Math.floor(this.jdEpoch)-1;var f=Math.floor(s/400)+1;s-=(f-1)*400,s+=s>15?16:0;var u=Math.floor(s/32)+1,h=s-(u-1)*32+1;return this.newDate(f<=0?f-1:f,u,h)}});var i={20:"Fruitbat",21:"Anchovy"};W.calendars.discworld=d}),gb=t(()=>{var W=no(),V=ro();function d(i){this.local=this.regionalOptions[i||""]||this.regionalOptions[""]}d.prototype=new W.baseCalendar,V(d.prototype,{name:"Ethiopian",jdEpoch:17242205e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(f){var s=this._validate(f,this.minMonth,this.minDay,W.local.invalidYear),f=s.year()+(s.year()<0?1:0);return f%4===3||f%4===-1},monthsInYear:function(i){return this._validate(i,this.minMonth,this.minDay,W.local.invalidYear||W.regionalOptions[""].invalidYear),13},weekOfYear:function(i,s,f){var u=this.newDate(i,s,f);return u.add(-u.dayOfWeek(),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInMonth:function(i,s){var f=this._validate(i,s,this.minDay,W.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===13&&this.leapYear(f.year())?1:0)},weekDay:function(i,s,f){return(this.dayOfWeek(i,s,f)||7)<6},toJD:function(i,s,f){var u=this._validate(i,s,f,W.local.invalidDate);return i=u.year(),i<0&&i++,u.day()+(u.month()-1)*30+(i-1)*365+Math.floor(i/4)+this.jdEpoch-1},fromJD:function(i){var s=Math.floor(i)+.5-this.jdEpoch,f=Math.floor((s-Math.floor((s+366)/1461))/365)+1;f<=0&&f--,s=Math.floor(i)+.5-this.newDate(f,1,1).toJD();var u=Math.floor(s/30)+1,h=s-(u-1)*30+1;return this.newDate(f,u,h)}}),W.calendars.ethiopian=d}),vb=t(()=>{var W=no(),V=ro();function d(s){this.local=this.regionalOptions[s||""]||this.regionalOptions[""]}d.prototype=new W.baseCalendar,V(d.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(s){var f=this._validate(s,this.minMonth,this.minDay,W.local.invalidYear);return this._leapYear(f.year())},_leapYear:function(s){return s=s<0?s+1:s,i(s*7+1,19)<7},monthsInYear:function(s){return this._validate(s,this.minMonth,this.minDay,W.local.invalidYear),this._leapYear(s.year?s.year():s)?13:12},weekOfYear:function(s,f,u){var h=this.newDate(s,f,u);return h.add(-h.dayOfWeek(),"d"),Math.floor((h.dayOfYear()-1)/7)+1},daysInYear:function(s){var f=this._validate(s,this.minMonth,this.minDay,W.local.invalidYear);return s=f.year(),this.toJD(s===-1?1:s+1,7,1)-this.toJD(s,7,1)},daysInMonth:function(s,f){return s.year&&(f=s.month(),s=s.year()),this._validate(s,f,this.minDay,W.local.invalidMonth),f===12&&this.leapYear(s)||f===8&&i(this.daysInYear(s),10)===5?30:f===9&&i(this.daysInYear(s),10)===3?29:this.daysPerMonth[f-1]},weekDay:function(s,f,u){return this.dayOfWeek(s,f,u)!==6},extraInfo:function(s,f,u){var h=this._validate(s,f,u,W.local.invalidDate);return{yearType:(this.leapYear(h)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(h)%10-3]}},toJD:function(s,f,u){var h=this._validate(s,f,u,W.local.invalidDate);s=h.year(),f=h.month(),u=h.day();var p=s<=0?s+1:s,v=this.jdEpoch+this._delay1(p)+this._delay2(p)+u+1;if(f<7){for(var o=7;o<=this.monthsInYear(s);o++)v+=this.daysInMonth(s,o);for(var o=1;o<f;o++)v+=this.daysInMonth(s,o)}else for(var o=7;o<f;o++)v+=this.daysInMonth(s,o);return v},_delay1:function(s){var f=Math.floor((235*s-234)/19),u=12084+13753*f,h=f*29+Math.floor(u/25920);return i(3*(h+1),7)<3&&h++,h},_delay2:function(s){var f=this._delay1(s-1),u=this._delay1(s),h=this._delay1(s+1);return h-u===356?2:u-f===382?1:0},fromJD:function(s){s=Math.floor(s)+.5;for(var f=Math.floor((s-this.jdEpoch)*98496/35975351)-1;s>=this.toJD(f===-1?1:f+1,7,1);)f++;for(var u=s<this.toJD(f,1,1)?7:1;s>this.toJD(f,u,this.daysInMonth(f,u));)u++;var h=s-this.toJD(f,u,1)+1;return this.newDate(f,u,h)}});function i(s,f){return s-f*Math.floor(s/f)}W.calendars.hebrew=d}),yb=t(()=>{var W=no(),V=ro();function d(i){this.local=this.regionalOptions[i||""]||this.regionalOptions[""]}d.prototype=new W.baseCalendar,V(d.prototype,{name:"Islamic",jdEpoch:19484395e-1,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-khams","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(i){var s=this._validate(i,this.minMonth,this.minDay,W.local.invalidYear);return(s.year()*11+14)%30<11},weekOfYear:function(i,s,f){var u=this.newDate(i,s,f);return u.add(-u.dayOfWeek(),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInYear:function(i){return this.leapYear(i)?355:354},daysInMonth:function(i,s){var f=this._validate(i,s,this.minDay,W.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===12&&this.leapYear(f.year())?1:0)},weekDay:function(i,s,f){return this.dayOfWeek(i,s,f)!==5},toJD:function(i,s,f){var u=this._validate(i,s,f,W.local.invalidDate);return i=u.year(),s=u.month(),f=u.day(),i=i<=0?i+1:i,f+Math.ceil(29.5*(s-1))+(i-1)*354+Math.floor((3+11*i)/30)+this.jdEpoch-1},fromJD:function(i){i=Math.floor(i)+.5;var s=Math.floor((30*(i-this.jdEpoch)+10646)/10631);s=s<=0?s-1:s;var f=Math.min(12,Math.ceil((i-29-this.toJD(s,1,1))/29.5)+1),u=i-this.toJD(s,f,1)+1;return this.newDate(s,f,u)}}),W.calendars.islamic=d}),xb=t(()=>{var W=no(),V=ro();function d(i){this.local=this.regionalOptions[i||""]||this.regionalOptions[""]}d.prototype=new W.baseCalendar,V(d.prototype,{name:"Julian",jdEpoch:17214235e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(f){var s=this._validate(f,this.minMonth,this.minDay,W.local.invalidYear),f=s.year()<0?s.year()+1:s.year();return f%4===0},weekOfYear:function(i,s,f){var u=this.newDate(i,s,f);return u.add(4-(u.dayOfWeek()||7),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInMonth:function(i,s){var f=this._validate(i,s,this.minDay,W.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===2&&this.leapYear(f.year())?1:0)},weekDay:function(i,s,f){return(this.dayOfWeek(i,s,f)||7)<6},toJD:function(i,s,f){var u=this._validate(i,s,f,W.local.invalidDate);return i=u.year(),s=u.month(),f=u.day(),i<0&&i++,s<=2&&(i--,s+=12),Math.floor(365.25*(i+4716))+Math.floor(30.6001*(s+1))+f-1524.5},fromJD:function(i){var s=Math.floor(i+.5),f=s+1524,u=Math.floor((f-122.1)/365.25),h=Math.floor(365.25*u),p=Math.floor((f-h)/30.6001),v=p-Math.floor(p<14?1:13),o=u-Math.floor(v>2?4716:4715),w=f-h-Math.floor(30.6001*p);return o<=0&&o--,this.newDate(o,v,w)}}),W.calendars.julian=d}),_b=t(()=>{var W=no(),V=ro();function d(f){this.local=this.regionalOptions[f||""]||this.regionalOptions[""]}d.prototype=new W.baseCalendar,V(d.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(f){return this._validate(f,this.minMonth,this.minDay,W.local.invalidYear),!1},formatYear:function(f){var u=this._validate(f,this.minMonth,this.minDay,W.local.invalidYear);f=u.year();var h=Math.floor(f/400);f=f%400,f+=f<0?400:0;var p=Math.floor(f/20);return h+"."+p+"."+f%20},forYear:function(f){if(f=f.split("."),f.length<3)throw"Invalid Mayan year";for(var u=0,h=0;h<f.length;h++){var p=parseInt(f[h],10);if(Math.abs(p)>19||h>0&&p<0)throw"Invalid Mayan year";u=u*20+p}return u},monthsInYear:function(f){return this._validate(f,this.minMonth,this.minDay,W.local.invalidYear),18},weekOfYear:function(f,u,h){return this._validate(f,u,h,W.local.invalidDate),0},daysInYear:function(f){return this._validate(f,this.minMonth,this.minDay,W.local.invalidYear),360},daysInMonth:function(f,u){return this._validate(f,u,this.minDay,W.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(f,u,h){var p=this._validate(f,u,h,W.local.invalidDate);return p.day()},weekDay:function(f,u,h){return this._validate(f,u,h,W.local.invalidDate),!0},extraInfo:function(f,u,h){var p=this._validate(f,u,h,W.local.invalidDate),v=p.toJD(),o=this._toHaab(v),w=this._toTzolkin(v);return{haabMonthName:this.local.haabMonths[o[0]-1],haabMonth:o[0],haabDay:o[1],tzolkinDayName:this.local.tzolkinMonths[w[0]-1],tzolkinDay:w[0],tzolkinTrecena:w[1]}},_toHaab:function(f){f-=this.jdEpoch;var u=i(f+8+340,365);return[Math.floor(u/20)+1,i(u,20)]},_toTzolkin:function(f){return f-=this.jdEpoch,[s(f+20,20),s(f+4,13)]},toJD:function(f,u,h){var p=this._validate(f,u,h,W.local.invalidDate);return p.day()+p.month()*20+p.year()*360+this.jdEpoch},fromJD:function(f){f=Math.floor(f)+.5-this.jdEpoch;var u=Math.floor(f/360);f=f%360,f+=f<0?360:0;var h=Math.floor(f/20),p=f%20;return this.newDate(u,h,p)}});function i(f,u){return f-u*Math.floor(f/u)}function s(f,u){return i(f-1,u)+1}W.calendars.mayan=d}),bb=t(()=>{var W=no(),V=ro();function d(s){this.local=this.regionalOptions[s||""]||this.regionalOptions[""]}d.prototype=new W.baseCalendar;var i=W.instance("gregorian");V(d.prototype,{name:"Nanakshahi",jdEpoch:22576735e-1,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(s){var f=this._validate(s,this.minMonth,this.minDay,W.local.invalidYear||W.regionalOptions[""].invalidYear);return i.leapYear(f.year()+(f.year()<1?1:0)+1469)},weekOfYear:function(s,f,u){var h=this.newDate(s,f,u);return h.add(1-(h.dayOfWeek()||7),"d"),Math.floor((h.dayOfYear()-1)/7)+1},daysInMonth:function(s,f){var u=this._validate(s,f,this.minDay,W.local.invalidMonth);return this.daysPerMonth[u.month()-1]+(u.month()===12&&this.leapYear(u.year())?1:0)},weekDay:function(s,f,u){return(this.dayOfWeek(s,f,u)||7)<6},toJD:function(p,f,u){var h=this._validate(p,f,u,W.local.invalidMonth),p=h.year();p<0&&p++;for(var v=h.day(),o=1;o<h.month();o++)v+=this.daysPerMonth[o-1];return v+i.toJD(p+1468,3,13)},fromJD:function(s){s=Math.floor(s+.5);for(var f=Math.floor((s-(this.jdEpoch-1))/366);s>=this.toJD(f+1,1,1);)f++;for(var u=s-Math.floor(this.toJD(f,1,1)+.5)+1,h=1;u>this.daysInMonth(f,h);)u-=this.daysInMonth(f,h),h++;return this.newDate(f,h,u)}}),W.calendars.nanakshahi=d}),wb=t(()=>{var W=no(),V=ro();function d(i){this.local=this.regionalOptions[i||""]||this.regionalOptions[""]}d.prototype=new W.baseCalendar,V(d.prototype,{name:"Nepali",jdEpoch:17007095e-1,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(i){return this.daysInYear(i)!==this.daysPerYear},weekOfYear:function(i,s,f){var u=this.newDate(i,s,f);return u.add(-u.dayOfWeek(),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInYear:function(i){var s=this._validate(i,this.minMonth,this.minDay,W.local.invalidYear);if(i=s.year(),typeof this.NEPALI_CALENDAR_DATA[i]>"u")return this.daysPerYear;for(var f=0,u=this.minMonth;u<=12;u++)f+=this.NEPALI_CALENDAR_DATA[i][u];return f},daysInMonth:function(i,s){return i.year&&(s=i.month(),i=i.year()),this._validate(i,s,this.minDay,W.local.invalidMonth),typeof this.NEPALI_CALENDAR_DATA[i]>"u"?this.daysPerMonth[s-1]:this.NEPALI_CALENDAR_DATA[i][s]},weekDay:function(i,s,f){return this.dayOfWeek(i,s,f)!==6},toJD:function(i,s,f){var u=this._validate(i,s,f,W.local.invalidDate);i=u.year(),s=u.month(),f=u.day();var h=W.instance(),p=0,v=s,o=i;this._createMissingCalendarData(i);var w=i-(v>9||v===9&&f>=this.NEPALI_CALENDAR_DATA[o][0]?56:57);for(s!==9&&(p=f,v--);v!==9;)v<=0&&(v=12,o--),p+=this.NEPALI_CALENDAR_DATA[o][v],v--;return s===9?(p+=f-this.NEPALI_CALENDAR_DATA[o][0],p<0&&(p+=h.daysInYear(w))):p+=this.NEPALI_CALENDAR_DATA[o][9]-this.NEPALI_CALENDAR_DATA[o][0],h.newDate(w,1,1).add(p,"d").toJD()},fromJD:function(i){var s=W.instance(),f=s.fromJD(i),u=f.year(),h=f.dayOfYear(),p=u+56;this._createMissingCalendarData(p);for(var v=9,o=this.NEPALI_CALENDAR_DATA[p][0],w=this.NEPALI_CALENDAR_DATA[p][v]-o+1;h>w;)v++,v>12&&(v=1,p++),w+=this.NEPALI_CALENDAR_DATA[p][v];var g=this.NEPALI_CALENDAR_DATA[p][v]-(w-h);return this.newDate(p,v,g)},_createMissingCalendarData:function(i){var s=this.daysPerMonth.slice(0);s.unshift(17);for(var f=i-1;f<i+2;f++)typeof this.NEPALI_CALENDAR_DATA[f]>"u"&&(this.NEPALI_CALENDAR_DATA[f]=s)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),W.calendars.nepali=d}),Mb=t(()=>{var W=no(),V=ro();function d(s){this.local=this.regionalOptions[s||""]||this.regionalOptions[""]}function i(s){var f=s-475;s<0&&f++;var u=.242197,h=u*f,p=u*(f+1),v=h-Math.floor(h),o=p-Math.floor(p);return v>o}d.prototype=new W.baseCalendar,V(d.prototype,{name:"Persian",jdEpoch:19483205e-1,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Dey","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Dey","Bah","Esf"],dayNames:["Yekshanbeh","Doshanbeh","Seshanbeh","Chahrshanbeh","Panjshanbeh","Jom'eh","Shanbeh"],dayNamesShort:["Yek","Do","Se","Cha","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(s){var f=this._validate(s,this.minMonth,this.minDay,W.local.invalidYear);return i(f.year())},weekOfYear:function(s,f,u){var h=this.newDate(s,f,u);return h.add(-((h.dayOfWeek()+1)%7),"d"),Math.floor((h.dayOfYear()-1)/7)+1},daysInMonth:function(s,f){var u=this._validate(s,f,this.minDay,W.local.invalidMonth);return this.daysPerMonth[u.month()-1]+(u.month()===12&&this.leapYear(u.year())?1:0)},weekDay:function(s,f,u){return this.dayOfWeek(s,f,u)!==5},toJD:function(s,f,u){var h=this._validate(s,f,u,W.local.invalidDate);s=h.year(),f=h.month(),u=h.day();var p=0;if(s>0)for(var v=1;v<s;v++)i(v)&&p++;else if(s<0)for(var v=s;v<0;v++)i(v)&&p--;return u+(f<=7?(f-1)*31:(f-1)*30+6)+(s>0?s-1:s)*365+p+this.jdEpoch-1},fromJD:function(s){s=Math.floor(s)+.5;var f=475+(s-this.toJD(475,1,1))/365.242197,u=Math.floor(f);u<=0&&u--,s>this.toJD(u,12,i(u)?30:29)&&(u++,u===0&&u++);var h=s-this.toJD(u,1,1)+1,p=h<=186?Math.ceil(h/31):Math.ceil((h-6)/30),v=s-this.toJD(u,p,1)+1;return this.newDate(u,p,v)}}),W.calendars.persian=d,W.calendars.jalali=d}),Tb=t(()=>{var W=no(),V=ro(),d=W.instance();function i(s){this.local=this.regionalOptions[s||""]||this.regionalOptions[""]}i.prototype=new W.baseCalendar,V(i.prototype,{name:"Taiwan",jdEpoch:24194025e-1,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(u){var f=this._validate(u,this.minMonth,this.minDay,W.local.invalidYear),u=this._t2gYear(f.year());return d.leapYear(u)},weekOfYear:function(p,f,u){var h=this._validate(p,this.minMonth,this.minDay,W.local.invalidYear),p=this._t2gYear(h.year());return d.weekOfYear(p,h.month(),h.day())},daysInMonth:function(s,f){var u=this._validate(s,f,this.minDay,W.local.invalidMonth);return this.daysPerMonth[u.month()-1]+(u.month()===2&&this.leapYear(u.year())?1:0)},weekDay:function(s,f,u){return(this.dayOfWeek(s,f,u)||7)<6},toJD:function(p,f,u){var h=this._validate(p,f,u,W.local.invalidDate),p=this._t2gYear(h.year());return d.toJD(p,h.month(),h.day())},fromJD:function(s){var f=d.fromJD(s),u=this._g2tYear(f.year());return this.newDate(u,f.month(),f.day())},_t2gYear:function(s){return s+this.yearsOffset+(s>=-this.yearsOffset&&s<=-1?1:0)},_g2tYear:function(s){return s-this.yearsOffset-(s>=1&&s<=this.yearsOffset?1:0)}}),W.calendars.taiwan=i}),Ab=t(()=>{var W=no(),V=ro(),d=W.instance();function i(s){this.local=this.regionalOptions[s||""]||this.regionalOptions[""]}i.prototype=new W.baseCalendar,V(i.prototype,{name:"Thai",jdEpoch:15230985e-1,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(u){var f=this._validate(u,this.minMonth,this.minDay,W.local.invalidYear),u=this._t2gYear(f.year());return d.leapYear(u)},weekOfYear:function(p,f,u){var h=this._validate(p,this.minMonth,this.minDay,W.local.invalidYear),p=this._t2gYear(h.year());return d.weekOfYear(p,h.month(),h.day())},daysInMonth:function(s,f){var u=this._validate(s,f,this.minDay,W.local.invalidMonth);return this.daysPerMonth[u.month()-1]+(u.month()===2&&this.leapYear(u.year())?1:0)},weekDay:function(s,f,u){return(this.dayOfWeek(s,f,u)||7)<6},toJD:function(p,f,u){var h=this._validate(p,f,u,W.local.invalidDate),p=this._t2gYear(h.year());return d.toJD(p,h.month(),h.day())},fromJD:function(s){var f=d.fromJD(s),u=this._g2tYear(f.year());return this.newDate(u,f.month(),f.day())},_t2gYear:function(s){return s-this.yearsOffset-(s>=1&&s<=this.yearsOffset?1:0)},_g2tYear:function(s){return s+this.yearsOffset+(s>=-this.yearsOffset&&s<=-1?1:0)}}),W.calendars.thai=i}),Sb=t(()=>{var W=no(),V=ro();function d(s){this.local=this.regionalOptions[s||""]||this.regionalOptions[""]}d.prototype=new W.baseCalendar,V(d.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thalth","Yawm al-Arba","Yawm al-Khams","Yawm al-Juma","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(s){var f=this._validate(s,this.minMonth,this.minDay,W.local.invalidYear);return this.daysInYear(f.year())===355},weekOfYear:function(s,f,u){var h=this.newDate(s,f,u);return h.add(-h.dayOfWeek(),"d"),Math.floor((h.dayOfYear()-1)/7)+1},daysInYear:function(s){for(var f=0,u=1;u<=12;u++)f+=this.daysInMonth(s,u);return f},daysInMonth:function(s,f){for(var u=this._validate(s,f,this.minDay,W.local.invalidMonth),h=u.toJD()-24e5+.5,p=0,v=0;v<i.length;v++){if(i[v]>h)return i[p]-i[p-1];p++}return 30},weekDay:function(s,f,u){return this.dayOfWeek(s,f,u)!==5},toJD:function(s,f,u){var h=this._validate(s,f,u,W.local.invalidDate),p=12*(h.year()-1)+h.month()-15292,v=h.day()+i[p-1]-1;return v+24e5-.5},fromJD:function(s){for(var f=s-24e5+.5,u=0,h=0;h<i.length&&!(i[h]>f);h++)u++;var p=u+15292,v=Math.floor((p-1)/12),o=v+1,w=p-12*v,g=f-i[u-1]+1;return this.newDate(o,w,g)},isValid:function(s,f,u){var h=W.baseCalendar.prototype.isValid.apply(this,arguments);return h&&(s=s.year!=null?s.year:s,h=s>=1276&&s<=1500),h},_validate:function(s,f,u,h){var p=W.baseCalendar.prototype._validate.apply(this,arguments);if(p.year<1276||p.year>1500)throw h.replace(/\{0\}/,this.local.name);return p}}),W.calendars.ummalqura=d;var i=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]}),Cb=t((W,V)=>{V.exports=no(),hb(),fb(),pb(),mb(),gb(),vb(),yb(),xb(),_b(),bb(),wb(),Mb(),Tb(),Ab(),Sb()}),Eb=t((W,V)=>{var d=Cb(),i=Mt(),s=oe(),f=s.EPOCHJD,u=s.ONEDAY,h={valType:"enumerated",values:i.sortObjectKeys(d.calendars),editType:"calc",dflt:"gregorian"},p=function(te,H,U,P){var re={};return re[U]=h,i.coerce(te,H,re,U,P)},v=function(te,H,U,P){for(var re=0;re<U.length;re++)p(te,H,U[re]+"calendar",P.calendar)},o={chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},w={chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},g={chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},b="##",L={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:b,w:b,c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}};function S(te,H,U){for(var P=Math.floor((H+.05)/u)+f,re=T(U).fromJD(P),G=0,Z,Y,X,ne,ae;(G=te.indexOf("%",G))!==-1;)Z=te.charAt(G+1),Z==="0"||Z==="-"||Z==="_"?(X=3,Y=te.charAt(G+2),Z==="_"&&(Z="-")):(Y=Z,Z="0",X=2),ne=L[Y],ne?(ne===b?ae=b:ae=re.formatDate(ne[Z]),te=te.substr(0,G)+ae+te.substr(G+X),G+=ae.length):G+=X;return te}var M={};function T(te){var H=M[te];return H||(H=M[te]=d.instance(te),H)}function C(te){return i.extendFlat({},h,{description:te})}function m(te){return"Sets the calendar system to use with `"+te+"` date data."}var y={xcalendar:C(m("x"))},A=i.extendFlat({},y,{ycalendar:C(m("y"))}),R=i.extendFlat({},A,{zcalendar:C(m("z"))}),N=C(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));V.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:A,bar:A,box:A,heatmap:A,contour:A,histogram:A,histogram2d:A,histogram2dcontour:A,scatter3d:R,surface:R,mesh3d:R,scattergl:A,ohlc:y,candlestick:y},layout:{calendar:C(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:N},yaxis:{calendar:N},scene:{xaxis:{calendar:N},yaxis:{calendar:N},zaxis:{calendar:N}},polar:{radialaxis:{calendar:N}}}},layoutAttributes:h,handleDefaults:p,handleTraceDefaults:v,CANONICAL_SUNDAY:w,CANONICAL_TICK:o,DFLTRANGE:g,getCal:T,worldCalFmt:S}}),Lb=t((W,V)=>{V.exports=Eb()}),Rb=t((W,V)=>{var d=J_();d.register([nb(),db(),Lb()]),V.exports=d});return Rb()})();/*! Bundled license information:

	native-promise-only/lib/npo.src.js:
	  (*! Native Promise Only
	      v0.8.1 (c) Kyle Simpson
	      MIT License: http://getify.mit-license.org
	  *)

	polybooljs/index.js:
	  (*
	   * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
	   * @license MIT
	   * @preserve Project Home: https://github.com/voidqk/polybooljs
	   *)

	object-assign/index.js:
	  (*
	  object-assign
	  (c) Sindre Sorhus
	  @license MIT
	  *)
	*/return window.Plotly=e,e})})(Wy);var T5=Wy.exports;const Yy=rm(T5);var qy={},Jy={exports:{}},qf,bg;function A5(){if(bg)return qf;bg=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return qf=n,qf}var Jf,wg;function S5(){if(wg)return Jf;wg=1;var n=A5();function e(){}function t(){}return t.resetWarningCache=e,Jf=function(){function r(x,_,O,z,q,oe){if(oe!==n){var ue=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw ue.name="Invariant Violation",ue}}r.isRequired=r;function a(){return r}var l={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:t,resetWarningCache:e};return l.PropTypes=l,l},Jf}Jy.exports=S5()();var C5=Jy.exports;(function(n){function e(ft){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(gt){return typeof gt}:function(gt){return gt&&typeof Symbol=="function"&&gt.constructor===Symbol&&gt!==Symbol.prototype?"symbol":typeof gt},e(ft)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=$e;var t=x(Oy),r=a(C5);function a(ft){return ft&&ft.__esModule?ft:{default:ft}}function l(ft){if(typeof WeakMap!="function")return null;var gt=new WeakMap,pt=new WeakMap;return(l=function(Ht){return Ht?pt:gt})(ft)}function x(ft,gt){if(ft&&ft.__esModule)return ft;if(ft===null||e(ft)!=="object"&&typeof ft!="function")return{default:ft};var pt=l(gt);if(pt&&pt.has(ft))return pt.get(ft);var Ht={},ur=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ve in ft)if(Ve!=="default"&&Object.prototype.hasOwnProperty.call(ft,Ve)){var nt=ur?Object.getOwnPropertyDescriptor(ft,Ve):null;nt&&(nt.get||nt.set)?Object.defineProperty(Ht,Ve,nt):Ht[Ve]=ft[Ve]}return Ht.default=ft,pt&&pt.set(ft,Ht),Ht}function _(ft,gt){if(!(ft instanceof gt))throw new TypeError("Cannot call a class as a function")}function O(ft,gt){for(var pt=0;pt<gt.length;pt++){var Ht=gt[pt];Ht.enumerable=Ht.enumerable||!1,Ht.configurable=!0,"value"in Ht&&(Ht.writable=!0),Object.defineProperty(ft,Ht.key,Ht)}}function z(ft,gt,pt){return gt&&O(ft.prototype,gt),Object.defineProperty(ft,"prototype",{writable:!1}),ft}function q(ft,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");ft.prototype=Object.create(gt&&gt.prototype,{constructor:{value:ft,writable:!0,configurable:!0}}),Object.defineProperty(ft,"prototype",{writable:!1}),gt&&oe(ft,gt)}function oe(ft,gt){return oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(pt,Ht){return pt.__proto__=Ht,pt},oe(ft,gt)}function ue(ft){var gt=Pe();return function(){var pt=Se(ft),Ht;if(gt){var ur=Se(this).constructor;Ht=Reflect.construct(pt,arguments,ur)}else Ht=pt.apply(this,arguments);return _e(this,Ht)}}function _e(ft,gt){if(gt&&(e(gt)==="object"||typeof gt=="function"))return gt;if(gt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return be(ft)}function be(ft){if(ft===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ft}function Pe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Se(ft){return Se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(gt){return gt.__proto__||Object.getPrototypeOf(gt)},Se(ft)}var Ee=["AfterExport","AfterPlot","Animated","AnimatingFrame","AnimationInterrupted","AutoSize","BeforeExport","BeforeHover","ButtonClicked","Click","ClickAnnotation","Deselect","DoubleClick","Framework","Hover","LegendClick","LegendDoubleClick","Relayout","Relayouting","Restyle","Redraw","Selected","Selecting","SliderChange","SliderEnd","SliderStart","SunburstClick","Transitioning","TransitionInterrupted","Unhover","WebGlContextLost"],Xe=["plotly_restyle","plotly_redraw","plotly_relayout","plotly_relayouting","plotly_doubleclick","plotly_animated","plotly_sunburstclick"],qe=typeof window<"u";function $e(ft){var gt=(function(pt){q(ur,pt);var Ht=ue(ur);function ur(Ve){var nt;return _(this,ur),nt=Ht.call(this,Ve),nt.p=Promise.resolve(),nt.resizeHandler=null,nt.handlers={},nt.syncWindowResize=nt.syncWindowResize.bind(be(nt)),nt.syncEventHandlers=nt.syncEventHandlers.bind(be(nt)),nt.attachUpdateEvents=nt.attachUpdateEvents.bind(be(nt)),nt.getRef=nt.getRef.bind(be(nt)),nt.handleUpdate=nt.handleUpdate.bind(be(nt)),nt.figureCallback=nt.figureCallback.bind(be(nt)),nt.updatePlotly=nt.updatePlotly.bind(be(nt)),nt}return z(ur,[{key:"updatePlotly",value:function(Ve,nt,nr){var Zt=this;this.p=this.p.then(function(){if(!Zt.unmounting){if(!Zt.el)throw new Error("Missing element reference");return ft.react(Zt.el,{data:Zt.props.data,layout:Zt.props.layout,config:Zt.props.config,frames:Zt.props.frames})}}).then(function(){Zt.unmounting||(Zt.syncWindowResize(Ve),Zt.syncEventHandlers(),Zt.figureCallback(nt),nr&&Zt.attachUpdateEvents())}).catch(function(Xt){Zt.props.onError&&Zt.props.onError(Xt)})}},{key:"componentDidMount",value:function(){this.unmounting=!1,this.updatePlotly(!0,this.props.onInitialized,!0)}},{key:"componentDidUpdate",value:function(Ve){this.unmounting=!1;var nt=Ve.frames&&Ve.frames.length?Ve.frames.length:0,nr=this.props.frames&&this.props.frames.length?this.props.frames.length:0,Zt=!(Ve.layout===this.props.layout&&Ve.data===this.props.data&&Ve.config===this.props.config&&nr===nt),Xt=Ve.revision!==void 0,Pr=Ve.revision!==this.props.revision;!Zt&&(!Xt||Xt&&!Pr)||this.updatePlotly(!1,this.props.onUpdate,!1)}},{key:"componentWillUnmount",value:function(){this.unmounting=!0,this.figureCallback(this.props.onPurge),this.resizeHandler&&qe&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null),this.removeUpdateEvents(),ft.purge(this.el)}},{key:"attachUpdateEvents",value:function(){var Ve=this;!this.el||!this.el.removeListener||Xe.forEach(function(nt){Ve.el.on(nt,Ve.handleUpdate)})}},{key:"removeUpdateEvents",value:function(){var Ve=this;!this.el||!this.el.removeListener||Xe.forEach(function(nt){Ve.el.removeListener(nt,Ve.handleUpdate)})}},{key:"handleUpdate",value:function(){this.figureCallback(this.props.onUpdate)}},{key:"figureCallback",value:function(Ve){if(typeof Ve=="function"){var nt=this.el,nr=nt.data,Zt=nt.layout,Xt=this.el._transitionData?this.el._transitionData._frames:null,Pr={data:nr,layout:Zt,frames:Xt};Ve(Pr,this.el)}}},{key:"syncWindowResize",value:function(Ve){var nt=this;qe&&(this.props.useResizeHandler&&!this.resizeHandler?(this.resizeHandler=function(){return ft.Plots.resize(nt.el)},window.addEventListener("resize",this.resizeHandler),Ve&&this.resizeHandler()):!this.props.useResizeHandler&&this.resizeHandler&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null))}},{key:"getRef",value:function(Ve){this.el=Ve,this.props.debug&&qe&&(window.gd=this.el)}},{key:"syncEventHandlers",value:function(){var Ve=this;Ee.forEach(function(nt){var nr=Ve.props["on"+nt],Zt=Ve.handlers[nt],Xt=!!Zt;nr&&!Xt?Ve.addEventHandler(nt,nr):!nr&&Xt?Ve.removeEventHandler(nt):nr&&Xt&&nr!==Zt&&(Ve.removeEventHandler(nt),Ve.addEventHandler(nt,nr))})}},{key:"addEventHandler",value:function(Ve,nt){this.handlers[Ve]=nt,this.el.on(this.getPlotlyEventName(Ve),this.handlers[Ve])}},{key:"removeEventHandler",value:function(Ve){this.el.removeListener(this.getPlotlyEventName(Ve),this.handlers[Ve]),delete this.handlers[Ve]}},{key:"getPlotlyEventName",value:function(Ve){return"plotly_"+Ve.toLowerCase()}},{key:"render",value:function(){return t.default.createElement("div",{id:this.props.divId,style:this.props.style,ref:this.getRef,className:this.props.className})}}]),ur})(t.Component);return gt.propTypes={data:r.default.arrayOf(r.default.object),config:r.default.object,layout:r.default.object,frames:r.default.arrayOf(r.default.object),revision:r.default.number,onInitialized:r.default.func,onPurge:r.default.func,onError:r.default.func,onUpdate:r.default.func,debug:r.default.bool,style:r.default.object,className:r.default.string,useResizeHandler:r.default.bool,divId:r.default.string},Ee.forEach(function(pt){gt.propTypes["on"+pt]=r.default.func}),gt.defaultProps={debug:!1,useResizeHandler:!1,data:[],style:{position:"relative",display:"inline-block"}},gt}})(qy);const Xy=rm(qy);var Sh={exports:{}};Sh.exports;(function(n,e){var t=200,r="__lodash_hash_undefined__",a=800,l=16,x=9007199254740991,_="[object Arguments]",O="[object Array]",z="[object AsyncFunction]",q="[object Boolean]",oe="[object Date]",ue="[object Error]",_e="[object Function]",be="[object GeneratorFunction]",Pe="[object Map]",Se="[object Number]",Ee="[object Null]",Xe="[object Object]",qe="[object Proxy]",$e="[object RegExp]",ft="[object Set]",gt="[object String]",pt="[object Undefined]",Ht="[object WeakMap]",ur="[object ArrayBuffer]",Ve="[object DataView]",nt="[object Float32Array]",nr="[object Float64Array]",Zt="[object Int8Array]",Xt="[object Int16Array]",Pr="[object Int32Array]",cr="[object Uint8Array]",Qr="[object Uint8ClampedArray]",Tr="[object Uint16Array]",ln="[object Uint32Array]",Sn=/[\\^$.*+?()[\]{}|]/g,Wn=/^\[object .+?Constructor\]$/,Ma=/^(?:0|[1-9]\d*)$/,zn={};zn[nt]=zn[nr]=zn[Zt]=zn[Xt]=zn[Pr]=zn[cr]=zn[Qr]=zn[Tr]=zn[ln]=!0,zn[_]=zn[O]=zn[ur]=zn[q]=zn[Ve]=zn[oe]=zn[ue]=zn[_e]=zn[Pe]=zn[Se]=zn[Xe]=zn[$e]=zn[ft]=zn[gt]=zn[Ht]=!1;var Or=typeof ku=="object"&&ku&&ku.Object===Object&&ku,$r=typeof self=="object"&&self&&self.Object===Object&&self,En=Or||$r||Function("return this")(),Ln=e&&!e.nodeType&&e,ta=Ln&&!0&&n&&!n.nodeType&&n,Jn=ta&&ta.exports===Ln,da=Jn&&Or.process,La=(function(){try{var Ot=ta&&ta.require&&ta.require("util").types;return Ot||da&&da.binding&&da.binding("util")}catch{}})(),ga=La&&La.isTypedArray;function tr(Ot,ar,br){switch(br.length){case 0:return Ot.call(ar);case 1:return Ot.call(ar,br[0]);case 2:return Ot.call(ar,br[0],br[1]);case 3:return Ot.call(ar,br[0],br[1],br[2])}return Ot.apply(ar,br)}function Ni(Ot,ar){for(var br=-1,On=Array(Ot);++br<Ot;)On[br]=ar(br);return On}function fa(Ot){return function(ar){return Ot(ar)}}function ya(Ot,ar){return Ot?.[ar]}function ra(Ot,ar){return function(br){return Ot(ar(br))}}var Ga=Array.prototype,na=Function.prototype,Dt=Object.prototype,ut=En["__core-js_shared__"],dr=na.toString,kr=Dt.hasOwnProperty,qr=(function(){var Ot=/[^.]+$/.exec(ut&&ut.keys&&ut.keys.IE_PROTO||"");return Ot?"Symbol(src)_1."+Ot:""})(),Ir=Dt.toString,Nn=dr.call(Object),hn=RegExp("^"+dr.call(kr).replace(Sn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),wn=Jn?En.Buffer:void 0,pa=En.Symbol,en=En.Uint8Array;wn&&wn.allocUnsafe;var Rn=ra(Object.getPrototypeOf,Object),Kn=Object.create,$n=Dt.propertyIsEnumerable,Mn=Ga.splice,Xn=pa?pa.toStringTag:void 0,Ft=(function(){try{var Ot=ns(Object,"defineProperty");return Ot({},"",{}),Ot}catch{}})(),Wr=wn?wn.isBuffer:void 0,qt=Math.max,jr=Date.now,mr=ns(En,"Map"),Nr=ns(Object,"create"),cn=(function(){function Ot(){}return function(ar){if(!as(ar))return{};if(Kn)return Kn(ar);Ot.prototype=ar;var br=new Ot;return Ot.prototype=void 0,br}})();function nn(Ot){var ar=-1,br=Ot==null?0:Ot.length;for(this.clear();++ar<br;){var On=Ot[ar];this.set(On[0],On[1])}}function Sa(){this.__data__=Nr?Nr(null):{},this.size=0}function Ia(Ot){var ar=this.has(Ot)&&delete this.__data__[Ot];return this.size-=ar?1:0,ar}function an(Ot){var ar=this.__data__;if(Nr){var br=ar[Ot];return br===r?void 0:br}return kr.call(ar,Ot)?ar[Ot]:void 0}function xa(Ot){var ar=this.__data__;return Nr?ar[Ot]!==void 0:kr.call(ar,Ot)}function hi(Ot,ar){var br=this.__data__;return this.size+=this.has(Ot)?0:1,br[Ot]=Nr&&ar===void 0?r:ar,this}nn.prototype.clear=Sa,nn.prototype.delete=Ia,nn.prototype.get=an,nn.prototype.has=xa,nn.prototype.set=hi;function Ka(Ot){var ar=-1,br=Ot==null?0:Ot.length;for(this.clear();++ar<br;){var On=Ot[ar];this.set(On[0],On[1])}}function Oo(){this.__data__=[],this.size=0}function ql(Ot){var ar=this.__data__,br=xn(ar,Ot);if(br<0)return!1;var On=ar.length-1;return br==On?ar.pop():Mn.call(ar,br,1),--this.size,!0}function Go(Ot){var ar=this.__data__,br=xn(ar,Ot);return br<0?void 0:ar[br][1]}function pl(Ot){return xn(this.__data__,Ot)>-1}function Jl(Ot,ar){var br=this.__data__,On=xn(br,Ot);return On<0?(++this.size,br.push([Ot,ar])):br[On][1]=ar,this}Ka.prototype.clear=Oo,Ka.prototype.delete=ql,Ka.prototype.get=Go,Ka.prototype.has=pl,Ka.prototype.set=Jl;function Ao(Ot){var ar=-1,br=Ot==null?0:Ot.length;for(this.clear();++ar<br;){var On=Ot[ar];this.set(On[0],On[1])}}function Fs(){this.size=0,this.__data__={hash:new nn,map:new(mr||Ka),string:new nn}}function Xl(Ot){var ar=Wi(this,Ot).delete(Ot);return this.size-=ar?1:0,ar}function Us(Ot){return Wi(this,Ot).get(Ot)}function Zl(Ot){return Wi(this,Ot).has(Ot)}function Ql(Ot,ar){var br=Wi(this,Ot),On=br.size;return br.set(Ot,ar),this.size+=br.size==On?0:1,this}Ao.prototype.clear=Fs,Ao.prototype.delete=Xl,Ao.prototype.get=Us,Ao.prototype.has=Zl,Ao.prototype.set=Ql;function rs(Ot){var ar=this.__data__=new Ka(Ot);this.size=ar.size}function Jc(){this.__data__=new Ka,this.size=0}function Xc(Ot){var ar=this.__data__,br=ar.delete(Ot);return this.size=ar.size,br}function _t(Ot){return this.__data__.get(Ot)}function Mt(Ot){return this.__data__.has(Ot)}function gr(Ot,ar){var br=this.__data__;if(br instanceof Ka){var On=br.__data__;if(!mr||On.length<t-1)return On.push([Ot,ar]),this.size=++br.size,this;br=this.__data__=new Ao(On)}return br.set(Ot,ar),this.size=br.size,this}rs.prototype.clear=Jc,rs.prototype.delete=Xc,rs.prototype.get=_t,rs.prototype.has=Mt,rs.prototype.set=gr;function vr(Ot,ar){var br=So(Ot),On=!br&&$c(Ot),Ta=!br&&!On&&Ra(Ot),Xa=!br&&!On&&!Ta&&rd(Ot),ni=br||On||Ta||Xa,za=ni?Ni(Ot.length,String):[],ai=za.length;for(var ho in Ot)ni&&(ho=="length"||Ta&&(ho=="offset"||ho=="parent")||Xa&&(ho=="buffer"||ho=="byteLength"||ho=="byteOffset")||ml(ho,ai))||za.push(ho);return za}function ir(Ot,ar,br){(br!==void 0&&!Ki(Ot[ar],br)||br===void 0&&!(ar in Ot))&&Pn(Ot,ar,br)}function Zr(Ot,ar,br){var On=Ot[ar];(!(kr.call(Ot,ar)&&Ki(On,br))||br===void 0&&!(ar in Ot))&&Pn(Ot,ar,br)}function xn(Ot,ar){for(var br=Ot.length;br--;)if(Ki(Ot[br][0],ar))return br;return-1}function Pn(Ot,ar,br){ar=="__proto__"&&Ft?Ft(Ot,ar,{configurable:!0,enumerable:!0,value:br,writable:!0}):Ot[ar]=br}var Dn=ri();function Hn(Ot){return Ot==null?Ot===void 0?pt:Ee:Xn&&Xn in Object(Ot)?Qi(Ot):ed(Ot)}function fn(Ot){return is(Ot)&&Hn(Ot)==_}function kn(Ot){if(!as(Ot)||No(Ot))return!1;var ar=Hs(Ot)?hn:Wn;return ar.test(td(Ot))}function aa(Ot){return is(Ot)&&$l(Ot.length)&&!!zn[Hn(Ot)]}function Ha(Ot){if(!as(Ot))return $u(Ot);var ar=Zc(Ot),br=[];for(var On in Ot)On=="constructor"&&(ar||!kr.call(Ot,On))||br.push(On);return br}function $a(Ot,ar,br,On,Ta){Ot!==ar&&Dn(ar,function(Xa,ni){if(Ta||(Ta=new rs),as(Xa))yi(Ot,ar,ni,br,$a,On,Ta);else{var za=On?On(Qc(Ot,ni),Xa,ni+"",Ot,ar,Ta):void 0;za===void 0&&(za=Xa),ir(Ot,ni,za)}},ad)}function yi(Ot,ar,br,On,Ta,Xa,ni){var za=Qc(Ot,br),ai=Qc(ar,br),ho=ni.get(ai);if(ho){ir(Ot,br,ho);return}var fo=Xa?Xa(za,ai,br+"",Ot,ar,ni):void 0,bs=fo===void 0;if(bs){var ec=So(ai),tc=!ec&&Ra(ai),eu=!ec&&!tc&&rd(ai);fo=ai,ec||tc||eu?So(za)?fo=za:$h(za)?fo=Di(za):tc?(bs=!1,fo=xi(ai)):eu?(bs=!1,fo=ja(ai)):fo=[]:Ja(ai)||$c(ai)?(fo=za,$c(za)?fo=nd(za):(!as(za)||Hs(za))&&(fo=Bs(ai))):bs=!1}bs&&(ni.set(ai,fo),Ta(fo,ai,On,Xa,ni),ni.delete(ai)),ir(Ot,br,fo)}function ei(Ot,ar){return Kh(vl(Ot,ar,od),Ot+"")}var pn=Ft?function(Ot,ar){return Ft(Ot,"toString",{configurable:!0,enumerable:!1,value:ef(ar),writable:!0})}:od;function xi(Ot,ar){return Ot.slice()}function fi(Ot){var ar=new Ot.constructor(Ot.byteLength);return new en(ar).set(new en(Ot)),ar}function ja(Ot,ar){var br=fi(Ot.buffer);return new Ot.constructor(br,Ot.byteOffset,Ot.length)}function Di(Ot,ar){var br=-1,On=Ot.length;for(ar||(ar=Array(On));++br<On;)ar[br]=Ot[br];return ar}function Fi(Ot,ar,br,On){var Ta=!br;br||(br={});for(var Xa=-1,ni=ar.length;++Xa<ni;){var za=ar[Xa],ai=void 0;ai===void 0&&(ai=Ot[za]),Ta?Pn(br,za,ai):Zr(br,za,ai)}return br}function to(Ot){return ei(function(ar,br){var On=-1,Ta=br.length,Xa=Ta>1?br[Ta-1]:void 0,ni=Ta>2?br[2]:void 0;for(Xa=Ot.length>3&&typeof Xa=="function"?(Ta--,Xa):void 0,ni&&gl(br[0],br[1],ni)&&(Xa=Ta<3?void 0:Xa,Ta=1),ar=Object(ar);++On<Ta;){var za=br[On];za&&Ot(ar,za,On,Xa)}return ar})}function ri(Ot){return function(ar,br,On){for(var Ta=-1,Xa=Object(ar),ni=On(ar),za=ni.length;za--;){var ai=ni[++Ta];if(br(Xa[ai],ai,Xa)===!1)break}return ar}}function Wi(Ot,ar){var br=Ot.__data__;return Ku(ar)?br[typeof ar=="string"?"string":"hash"]:br.map}function ns(Ot,ar){var br=ya(Ot,ar);return kn(br)?br:void 0}function Qi(Ot){var ar=kr.call(Ot,Xn),br=Ot[Xn];try{Ot[Xn]=void 0;var On=!0}catch{}var Ta=Ir.call(Ot);return On&&(ar?Ot[Xn]=br:delete Ot[Xn]),Ta}function Bs(Ot){return typeof Ot.constructor=="function"&&!Zc(Ot)?cn(Rn(Ot)):{}}function ml(Ot,ar){var br=typeof Ot;return ar=ar??x,!!ar&&(br=="number"||br!="symbol"&&Ma.test(Ot))&&Ot>-1&&Ot%1==0&&Ot<ar}function gl(Ot,ar,br){if(!as(br))return!1;var On=typeof ar;return(On=="number"?Kl(br)&&ml(ar,br.length):On=="string"&&ar in br)?Ki(br[ar],Ot):!1}function Ku(Ot){var ar=typeof Ot;return ar=="string"||ar=="number"||ar=="symbol"||ar=="boolean"?Ot!=="__proto__":Ot===null}function No(Ot){return!!qr&&qr in Ot}function Zc(Ot){var ar=Ot&&Ot.constructor,br=typeof ar=="function"&&ar.prototype||Dt;return Ot===br}function $u(Ot){var ar=[];if(Ot!=null)for(var br in Object(Ot))ar.push(br);return ar}function ed(Ot){return Ir.call(Ot)}function vl(Ot,ar,br){return ar=qt(ar===void 0?Ot.length-1:ar,0),function(){for(var On=arguments,Ta=-1,Xa=qt(On.length-ar,0),ni=Array(Xa);++Ta<Xa;)ni[Ta]=On[ar+Ta];Ta=-1;for(var za=Array(ar+1);++Ta<ar;)za[Ta]=On[Ta];return za[ar]=br(ni),tr(Ot,this,za)}}function Qc(Ot,ar){if(!(ar==="constructor"&&typeof Ot[ar]=="function")&&ar!="__proto__")return Ot[ar]}var Kh=Kc(pn);function Kc(Ot){var ar=0,br=0;return function(){var On=jr(),Ta=l-(On-br);if(br=On,Ta>0){if(++ar>=a)return arguments[0]}else ar=0;return Ot.apply(void 0,arguments)}}function td(Ot){if(Ot!=null){try{return dr.call(Ot)}catch{}try{return Ot+""}catch{}}return""}function Ki(Ot,ar){return Ot===ar||Ot!==Ot&&ar!==ar}var $c=fn((function(){return arguments})())?fn:function(Ot){return is(Ot)&&kr.call(Ot,"callee")&&!$n.call(Ot,"callee")},So=Array.isArray;function Kl(Ot){return Ot!=null&&$l(Ot.length)&&!Hs(Ot)}function $h(Ot){return is(Ot)&&Kl(Ot)}var Ra=Wr||tf;function Hs(Ot){if(!as(Ot))return!1;var ar=Hn(Ot);return ar==_e||ar==be||ar==z||ar==qe}function $l(Ot){return typeof Ot=="number"&&Ot>-1&&Ot%1==0&&Ot<=x}function as(Ot){var ar=typeof Ot;return Ot!=null&&(ar=="object"||ar=="function")}function is(Ot){return Ot!=null&&typeof Ot=="object"}function Ja(Ot){if(!is(Ot)||Hn(Ot)!=Xe)return!1;var ar=Rn(Ot);if(ar===null)return!0;var br=kr.call(ar,"constructor")&&ar.constructor;return typeof br=="function"&&br instanceof br&&dr.call(br)==Nn}var rd=ga?fa(ga):aa;function nd(Ot){return Fi(Ot,ad(Ot))}function ad(Ot){return Kl(Ot)?vr(Ot):Ha(Ot)}var id=to(function(Ot,ar,br){$a(Ot,ar,br)});function ef(Ot){return function(){return Ot}}function od(Ot){return Ot}function tf(){return!1}n.exports=id})(Sh,Sh.exports);var E5=Sh.exports;const gh=rm(E5);function Zy(n,e,t,r,a=[],l=[],x=[]){const _=gh({},n,a[e]);return t?.curveNumber===e&&gh(_,l[e]),r?.curveNumber===e&&gh(_,x[e]),_}function Qy(n,e){return gh({},n,e??{})}const L5=Xy(Yy),Bp={l:55,r:10,b:25,t:40},R5={size:6,color:"blue",shadow:"0px 0px 0px 8px rgba(173,216,230,0.5)",borderRadius:"50%"};function k5(n,e){var t;if(!((t=e?._fullLayout)!=null&&t._size))return null;const r=e._fullLayout,a=e.getBoundingClientRect(),l=r.margin.l,x=r.margin.t,_=a.width-r.margin.l-r.margin.r,O=a.height-r.margin.t-r.margin.b,z=n.xaxis||r.xaxis,q=n.yaxis||r.yaxis;if(!(z!=null&&z.range)||!(q!=null&&q.range))return null;const oe=(n.x-z.range[0])/(z.range[1]-z.range[0]),ue=(n.y-q.range[0])/(q.range[1]-q.range[0]),_e=l+oe*_,be=x-ue*O-Bp.b-Bp.t;return{px:_e,py:be}}function Mg(n,e){if(!n)return;if(!e){n.style.display="none";return}const{size:t,color:r,shadow:a,borderRadius:l}=R5;n.style.display="block",n.style.width=`${t}px`,n.style.height=`${t}px`,n.style.borderRadius=l,n.style.background=r,n.style.boxShadow=a,n.style.transform=`translate(${e.px-t/2}px, ${e.py-t/2}px)`}const P5=({distances:n,highSymPoints:e,eigenvalues:t,updateMode:r,plotlyLayoutFormat:a,plotlyTraceFormat:l,plotlyHoverTraceFormat:x,plotlySelectedTraceFormat:_})=>{const[O,z]=Yn.useState(null),q=Yn.useRef(null),oe=Yn.useRef(null),ue=Yn.useMemo(()=>t[0].map((qe,$e)=>t.map(ft=>ft[$e])),[t]),_e=Yn.useMemo(()=>Qy(N5(e,n,t),a),[e,n,t,a]),be=Yn.useMemo(()=>O5(ue,n,null,O,l,x,_),[ue,n,O,l,x,_]),Pe=Yn.useMemo(()=>({scrollZoom:!1,displayModeBar:!0,displaylogo:!1,modeBarButtons:[["toImage","resetScale2d"]]}),[]),Se=qe=>{r(qe),z(qe.points[0])},Ee=qe=>{var $e;const ft=($e=qe.points)==null?void 0:$e[0];if(!ft||!q.current||!oe.current)return;const gt=k5(ft,q.current);gt&&Mg(oe.current,gt)},Xe=()=>{Mg(oe.current,null)};return mn.jsxs(Ho,{children:[mn.jsx(Ho.Header,{children:"Phonon band structure (select phonon)"}),mn.jsxs(Ho.Body,{style:{position:"relative",height:"420px"},children:[mn.jsx(L5,{data:be,layout:_e,config:Pe,onClick:Se,onHover:Ee,onUnhover:Xe,onInitialized:(qe,$e)=>{q.current=$e},useResizeHandler:!0,style:{width:"100%",height:"100%"}}),mn.jsx("div",{ref:oe,style:{position:"absolute",pointerEvents:"none",willChange:"transform",display:"none"}})]})]})},O5=(n,e,t,r,a,l,x)=>n.map((_,O)=>{const z=oe=>r?.x===e[oe]&&r?.y===_[oe],q={x:e,y:_,mode:"lines+markers",hoverinfo:"none",line:{color:"#1f77b4",width:2},marker:{size:_.map((oe,ue)=>z(ue)?10:0),color:_.map((oe,ue)=>z(ue)?"red":"#1f77b4"),line:{width:_.map((oe,ue)=>z(ue)?1:0),color:_.map((oe,ue)=>z(ue)?"black":"transparent")}}};return a||l||x?Zy(q,O,null,r,a,l,x):q}),N5=(n,e,t)=>({showlegend:!1,hovermode:"closest",xaxis:{linewidth:0,linecolor:"transparent",tickvals:n.map(([r])=>e[r]),ticktext:n.map(([,r])=>r),range:[Math.min(...e.flat()),Math.max(...e.flat())]},yaxis:{title:"Frequency (cm-1)",linewidth:0,linecolor:"transparent",ticklen:5,range:[Math.min(...t.flat()),Math.max(...t.flat())]},shapes:n.map(([r])=>({type:"line",yref:"paper",x0:e[r],y0:0,x1:e[r],y1:1,line:{width:.5}})),dragmode:"zoom",autosize:!0,margin:Bp}),D5=Yn.memo(P5),I5=Xy(Yy),z5=({distances:n,highSymPoints:e,eigenvalues:t,updateMode:r,plotlyLayoutFormat:a,plotlyTraceFormat:l,plotlyHoverTraceFormat:x,plotlySelectedTraceFormat:_})=>{const[O,z]=Yn.useState(null),[q,oe]=Yn.useState(null),ue=Yn.useMemo(()=>t[0].map((Se,Ee)=>t.map(Xe=>Xe[Ee])),[t]),[_e,be]=Yn.useState({data:Tg(ue,n,O,q,l,x,_),layout:Qy(F5(e,n,t),a),frames:[],config:{scrollZoom:!1,displayModeBar:!0,displaylogo:!1,modeBarButtons:[["toImage","resetScale2d"]]}});Yn.useEffect(()=>{be(Se=>({...Se,data:Tg(ue,n,O,q,l,x,_)}))},[O,q,l,x,_]);const Pe=Se=>{r(Se),oe(Se.points[0])};return mn.jsxs(Ho,{children:[mn.jsx(Ho.Header,{children:"Phonon band structure (select phonon)"}),mn.jsx(Ho.Body,{children:mn.jsx(I5,{data:_e.data,layout:_e.layout,config:_e.config,onClick:Pe,onHover:Se=>{z(Se.points[0])},onUnhover:()=>{z(null)},useResizeHandler:!0,style:{width:"100%",height:"100%"}})})]})},Tg=(n,e,t,r,a,l,x)=>n.map((_,O)=>{const z=ue=>t?.x===e[ue]&&t?.y===_[ue],q=ue=>r?.x===e[ue]&&r?.y===_[ue],oe={x:e,y:_,mode:"lines+markers",hoverinfo:"none",line:{color:"#1f77b4",width:t?.curveNumber===O?4:2},marker:{size:_.map((ue,_e)=>q(_e)?10:z(_e)?14:0),color:_.map((ue,_e)=>q(_e)?"red":z(_e)?"blue":"#1f77b4"),line:{width:_.map((ue,_e)=>q(_e)?1:z(_e)?8:0),color:_.map((ue,_e)=>q(_e)?"black":z(_e)?"lightblue":"transparent")}}};return a||l||x?Zy(oe,O,t,r,a,l,x):oe}),F5=(n,e,t)=>({showlegend:!1,hovermode:"closest",xaxis:{linewidth:0,linecolor:"transparent",tickvals:n.map(([r])=>e[r]),ticktext:n.map(([,r])=>r),range:[Math.min(...e.flat()),Math.max(...e.flat())]},yaxis:{title:"Frequency (cm-1)",linewidth:0,linecolor:"transparent",ticklen:5,range:[Math.min(...t.flat()),Math.max(...t.flat())]},shapes:n.map(([r])=>({type:"line",yref:"paper",x0:e[r],y0:0,x1:e[r],y1:1,line:{width:.5}})),dragmode:"zoom",autosize:!0,margin:{l:55,r:10,b:25,t:40}}),U5=Yn.memo(z5);/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const am="169",oc={ROTATE:0,DOLLY:1,PAN:2},sc={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},B5=0,Ag=1,H5=2,Ky=1,V5=2,Ps=3,rl=0,_o=1,co=2,el=0,Dc=1,Sg=2,Cg=3,Eg=4,G5=5,kl=100,j5=101,W5=102,Y5=103,q5=104,J5=200,X5=201,Z5=202,Q5=203,Hp=204,Vp=205,K5=206,$5=207,ew=208,tw=209,rw=210,nw=211,aw=212,iw=213,ow=214,Gp=0,jp=1,Wp=2,Fc=3,Yp=4,qp=5,Jp=6,Xp=7,im=0,sw=1,lw=2,tl=0,cw=1,uw=2,dw=3,hw=4,fw=5,pw=6,mw=7,$y=300,Uc=301,Bc=302,Zp=303,Qp=304,jh=306,Kp=1e3,Ol=1001,$p=1002,To=1003,gw=1004,kd=1005,xo=1006,Xf=1007,Nl=1008,Is=1009,e2=1010,t2=1011,Gu=1012,om=1013,Il=1014,ms=1015,Zu=1016,sm=1017,lm=1018,Hc=1020,r2=35902,n2=1021,a2=1022,Uo=1023,i2=1024,o2=1025,Ic=1026,Vc=1027,cm=1028,um=1029,s2=1030,dm=1031,hm=1033,vh=33776,yh=33777,xh=33778,_h=33779,e0=35840,t0=35841,r0=35842,n0=35843,a0=36196,i0=37492,o0=37496,s0=37808,l0=37809,c0=37810,u0=37811,d0=37812,h0=37813,f0=37814,p0=37815,m0=37816,g0=37817,v0=37818,y0=37819,x0=37820,_0=37821,bh=36492,b0=36494,w0=36495,l2=36283,M0=36284,T0=36285,A0=36286,vw=3200,yw=3201,fm=0,xw=1,$s="",hs="srgb",ol="srgb-linear",pm="display-p3",Wh="display-p3-linear",Ch="linear",gi="srgb",Eh="rec709",Lh="p3",lc=7680,Lg=519,_w=512,bw=513,ww=514,c2=515,Mw=516,Tw=517,Aw=518,Sw=519,S0=35044,Rg="300 es",Ns=2e3,Rh=2001;class Hl{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const a=r.indexOf(t);a!==-1&&r.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const t=this._listeners[e.type];if(t!==void 0){e.target=this;const r=t.slice(0);for(let a=0,l=r.length;a<l;a++)r[a].call(this,e);e.target=null}}}const so=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let kg=1234567;const Du=Math.PI/180,ju=180/Math.PI;function vs(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(so[n&255]+so[n>>8&255]+so[n>>16&255]+so[n>>24&255]+"-"+so[e&255]+so[e>>8&255]+"-"+so[e>>16&15|64]+so[e>>24&255]+"-"+so[t&63|128]+so[t>>8&255]+"-"+so[t>>16&255]+so[t>>24&255]+so[r&255]+so[r>>8&255]+so[r>>16&255]+so[r>>24&255]).toLowerCase()}function Vi(n,e,t){return Math.max(e,Math.min(t,n))}function mm(n,e){return(n%e+e)%e}function Cw(n,e,t,r,a){return r+(n-e)*(a-r)/(t-e)}function Ew(n,e,t){return n!==e?(t-n)/(e-n):0}function Iu(n,e,t){return(1-t)*n+t*e}function Lw(n,e,t,r){return Iu(n,e,1-Math.exp(-t*r))}function Rw(n,e=1){return e-Math.abs(mm(n,e*2)-e)}function kw(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function Pw(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function Ow(n,e){return n+Math.floor(Math.random()*(e-n+1))}function Nw(n,e){return n+Math.random()*(e-n)}function Dw(n){return n*(.5-Math.random())}function Iw(n){n!==void 0&&(kg=n);let e=kg+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function zw(n){return n*Du}function Fw(n){return n*ju}function Uw(n){return(n&n-1)===0&&n!==0}function Bw(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Hw(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Vw(n,e,t,r,a){const l=Math.cos,x=Math.sin,_=l(t/2),O=x(t/2),z=l((e+r)/2),q=x((e+r)/2),oe=l((e-r)/2),ue=x((e-r)/2),_e=l((r-e)/2),be=x((r-e)/2);switch(a){case"XYX":n.set(_*q,O*oe,O*ue,_*z);break;case"YZY":n.set(O*ue,_*q,O*oe,_*z);break;case"ZXZ":n.set(O*oe,O*ue,_*q,_*z);break;case"XZX":n.set(_*q,O*be,O*_e,_*z);break;case"YXY":n.set(O*_e,_*q,O*be,_*z);break;case"ZYZ":n.set(O*be,O*_e,_*q,_*z);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+a)}}function Qo(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Qa(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const zl={DEG2RAD:Du,RAD2DEG:ju,generateUUID:vs,clamp:Vi,euclideanModulo:mm,mapLinear:Cw,inverseLerp:Ew,lerp:Iu,damp:Lw,pingpong:Rw,smoothstep:kw,smootherstep:Pw,randInt:Ow,randFloat:Nw,randFloatSpread:Dw,seededRandom:Iw,degToRad:zw,radToDeg:Fw,isPowerOfTwo:Uw,ceilPowerOfTwo:Bw,floorPowerOfTwo:Hw,setQuaternionFromProperEuler:Vw,normalize:Qa,denormalize:Qo};class Jr{constructor(e=0,t=0){Jr.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,a=e.elements;return this.x=a[0]*t+a[3]*r+a[6],this.y=a[1]*t+a[4]*r+a[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Vi(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),a=Math.sin(t),l=this.x-e.x,x=this.y-e.y;return this.x=l*r-x*a+e.x,this.y=l*a+x*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ma{constructor(e,t,r,a,l,x,_,O,z){ma.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,a,l,x,_,O,z)}set(e,t,r,a,l,x,_,O,z){const q=this.elements;return q[0]=e,q[1]=a,q[2]=_,q[3]=t,q[4]=l,q[5]=O,q[6]=r,q[7]=x,q[8]=z,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,a=t.elements,l=this.elements,x=r[0],_=r[3],O=r[6],z=r[1],q=r[4],oe=r[7],ue=r[2],_e=r[5],be=r[8],Pe=a[0],Se=a[3],Ee=a[6],Xe=a[1],qe=a[4],$e=a[7],ft=a[2],gt=a[5],pt=a[8];return l[0]=x*Pe+_*Xe+O*ft,l[3]=x*Se+_*qe+O*gt,l[6]=x*Ee+_*$e+O*pt,l[1]=z*Pe+q*Xe+oe*ft,l[4]=z*Se+q*qe+oe*gt,l[7]=z*Ee+q*$e+oe*pt,l[2]=ue*Pe+_e*Xe+be*ft,l[5]=ue*Se+_e*qe+be*gt,l[8]=ue*Ee+_e*$e+be*pt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],a=e[2],l=e[3],x=e[4],_=e[5],O=e[6],z=e[7],q=e[8];return t*x*q-t*_*z-r*l*q+r*_*O+a*l*z-a*x*O}invert(){const e=this.elements,t=e[0],r=e[1],a=e[2],l=e[3],x=e[4],_=e[5],O=e[6],z=e[7],q=e[8],oe=q*x-_*z,ue=_*O-q*l,_e=z*l-x*O,be=t*oe+r*ue+a*_e;if(be===0)return this.set(0,0,0,0,0,0,0,0,0);const Pe=1/be;return e[0]=oe*Pe,e[1]=(a*z-q*r)*Pe,e[2]=(_*r-a*x)*Pe,e[3]=ue*Pe,e[4]=(q*t-a*O)*Pe,e[5]=(a*l-_*t)*Pe,e[6]=_e*Pe,e[7]=(r*O-z*t)*Pe,e[8]=(x*t-r*l)*Pe,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,a,l,x,_){const O=Math.cos(l),z=Math.sin(l);return this.set(r*O,r*z,-r*(O*x+z*_)+x+e,-a*z,a*O,-a*(-z*x+O*_)+_+t,0,0,1),this}scale(e,t){return this.premultiply(Zf.makeScale(e,t)),this}rotate(e){return this.premultiply(Zf.makeRotation(-e)),this}translate(e,t){return this.premultiply(Zf.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let a=0;a<9;a++)if(t[a]!==r[a])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Zf=new ma;function u2(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function kh(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function Gw(){const n=kh("canvas");return n.style.display="block",n}const Pg={};function wh(n){n in Pg||(Pg[n]=!0,console.warn(n))}function jw(n,e,t){return new Promise(function(r,a){function l(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:a();break;case n.TIMEOUT_EXPIRED:setTimeout(l,t);break;default:r()}}setTimeout(l,t)})}function Ww(n){const e=n.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function Yw(n){const e=n.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const Og=new ma().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Ng=new ma().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),uu={[ol]:{transfer:Ch,primaries:Eh,luminanceCoefficients:[.2126,.7152,.0722],toReference:n=>n,fromReference:n=>n},[hs]:{transfer:gi,primaries:Eh,luminanceCoefficients:[.2126,.7152,.0722],toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[Wh]:{transfer:Ch,primaries:Lh,luminanceCoefficients:[.2289,.6917,.0793],toReference:n=>n.applyMatrix3(Ng),fromReference:n=>n.applyMatrix3(Og)},[pm]:{transfer:gi,primaries:Lh,luminanceCoefficients:[.2289,.6917,.0793],toReference:n=>n.convertSRGBToLinear().applyMatrix3(Ng),fromReference:n=>n.applyMatrix3(Og).convertLinearToSRGB()}},qw=new Set([ol,Wh]),Ya={enabled:!0,_workingColorSpace:ol,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!qw.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const r=uu[e].toReference,a=uu[t].fromReference;return a(r(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return uu[n].primaries},getTransfer:function(n){return n===$s?Ch:uu[n].transfer},getLuminanceCoefficients:function(n,e=this._workingColorSpace){return n.fromArray(uu[e].luminanceCoefficients)}};function zc(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Qf(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let cc;class Jw{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{cc===void 0&&(cc=kh("canvas")),cc.width=e.width,cc.height=e.height;const r=cc.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=cc}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=kh("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const a=r.getImageData(0,0,e.width,e.height),l=a.data;for(let x=0;x<l.length;x++)l[x]=zc(l[x]/255)*255;return r.putImageData(a,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(zc(t[r]/255)*255):t[r]=zc(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Xw=0;class d2{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Xw++}),this.uuid=vs(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},a=this.data;if(a!==null){let l;if(Array.isArray(a)){l=[];for(let x=0,_=a.length;x<_;x++)a[x].isDataTexture?l.push(Kf(a[x].image)):l.push(Kf(a[x]))}else l=Kf(a);r.url=l}return t||(e.images[this.uuid]=r),r}}function Kf(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Jw.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Zw=0;class uo extends Hl{constructor(e=uo.DEFAULT_IMAGE,t=uo.DEFAULT_MAPPING,r=Ol,a=Ol,l=xo,x=Nl,_=Uo,O=Is,z=uo.DEFAULT_ANISOTROPY,q=$s){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Zw++}),this.uuid=vs(),this.name="",this.source=new d2(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=a,this.magFilter=l,this.minFilter=x,this.anisotropy=z,this.format=_,this.internalFormat=null,this.type=O,this.offset=new Jr(0,0),this.repeat=new Jr(1,1),this.center=new Jr(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ma,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=q,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==$y)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Kp:e.x=e.x-Math.floor(e.x);break;case Ol:e.x=e.x<0?0:1;break;case $p:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Kp:e.y=e.y-Math.floor(e.y);break;case Ol:e.y=e.y<0?0:1;break;case $p:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}uo.DEFAULT_IMAGE=null;uo.DEFAULT_MAPPING=$y;uo.DEFAULT_ANISOTROPY=1;class Si{constructor(e=0,t=0,r=0,a=1){Si.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=a}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,a){return this.x=e,this.y=t,this.z=r,this.w=a,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,a=this.z,l=this.w,x=e.elements;return this.x=x[0]*t+x[4]*r+x[8]*a+x[12]*l,this.y=x[1]*t+x[5]*r+x[9]*a+x[13]*l,this.z=x[2]*t+x[6]*r+x[10]*a+x[14]*l,this.w=x[3]*t+x[7]*r+x[11]*a+x[15]*l,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,a,l;const x=e.elements,_=x[0],O=x[4],z=x[8],q=x[1],oe=x[5],ue=x[9],_e=x[2],be=x[6],Pe=x[10];if(Math.abs(O-q)<.01&&Math.abs(z-_e)<.01&&Math.abs(ue-be)<.01){if(Math.abs(O+q)<.1&&Math.abs(z+_e)<.1&&Math.abs(ue+be)<.1&&Math.abs(_+oe+Pe-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const Ee=(_+1)/2,Xe=(oe+1)/2,qe=(Pe+1)/2,$e=(O+q)/4,ft=(z+_e)/4,gt=(ue+be)/4;return Ee>Xe&&Ee>qe?Ee<.01?(r=0,a=.707106781,l=.707106781):(r=Math.sqrt(Ee),a=$e/r,l=ft/r):Xe>qe?Xe<.01?(r=.707106781,a=0,l=.707106781):(a=Math.sqrt(Xe),r=$e/a,l=gt/a):qe<.01?(r=.707106781,a=.707106781,l=0):(l=Math.sqrt(qe),r=ft/l,a=gt/l),this.set(r,a,l,t),this}let Se=Math.sqrt((be-ue)*(be-ue)+(z-_e)*(z-_e)+(q-O)*(q-O));return Math.abs(Se)<.001&&(Se=1),this.x=(be-ue)/Se,this.y=(z-_e)/Se,this.z=(q-O)/Se,this.w=Math.acos((_+oe+Pe-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Qw extends Hl{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Si(0,0,e,t),this.scissorTest=!1,this.viewport=new Si(0,0,e,t);const a={width:e,height:t,depth:1};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:xo,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},r);const l=new uo(a,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);l.flipY=!1,l.generateMipmaps=r.generateMipmaps,l.internalFormat=r.internalFormat,this.textures=[];const x=r.count;for(let _=0;_<x;_++)this.textures[_]=l.clone(),this.textures[_].isRenderTargetTexture=!0;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let a=0,l=this.textures.length;a<l;a++)this.textures[a].image.width=e,this.textures[a].image.height=t,this.textures[a].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let r=0,a=e.textures.length;r<a;r++)this.textures[r]=e.textures[r].clone(),this.textures[r].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new d2(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Fl extends Qw{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class h2 extends uo{constructor(e=null,t=1,r=1,a=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:a},this.magFilter=To,this.minFilter=To,this.wrapR=Ol,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Kw extends uo{constructor(e=null,t=1,r=1,a=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:a},this.magFilter=To,this.minFilter=To,this.wrapR=Ol,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Oi{constructor(e=0,t=0,r=0,a=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=a}static slerpFlat(e,t,r,a,l,x,_){let O=r[a+0],z=r[a+1],q=r[a+2],oe=r[a+3];const ue=l[x+0],_e=l[x+1],be=l[x+2],Pe=l[x+3];if(_===0){e[t+0]=O,e[t+1]=z,e[t+2]=q,e[t+3]=oe;return}if(_===1){e[t+0]=ue,e[t+1]=_e,e[t+2]=be,e[t+3]=Pe;return}if(oe!==Pe||O!==ue||z!==_e||q!==be){let Se=1-_;const Ee=O*ue+z*_e+q*be+oe*Pe,Xe=Ee>=0?1:-1,qe=1-Ee*Ee;if(qe>Number.EPSILON){const ft=Math.sqrt(qe),gt=Math.atan2(ft,Ee*Xe);Se=Math.sin(Se*gt)/ft,_=Math.sin(_*gt)/ft}const $e=_*Xe;if(O=O*Se+ue*$e,z=z*Se+_e*$e,q=q*Se+be*$e,oe=oe*Se+Pe*$e,Se===1-_){const ft=1/Math.sqrt(O*O+z*z+q*q+oe*oe);O*=ft,z*=ft,q*=ft,oe*=ft}}e[t]=O,e[t+1]=z,e[t+2]=q,e[t+3]=oe}static multiplyQuaternionsFlat(e,t,r,a,l,x){const _=r[a],O=r[a+1],z=r[a+2],q=r[a+3],oe=l[x],ue=l[x+1],_e=l[x+2],be=l[x+3];return e[t]=_*be+q*oe+O*_e-z*ue,e[t+1]=O*be+q*ue+z*oe-_*_e,e[t+2]=z*be+q*_e+_*ue-O*oe,e[t+3]=q*be-_*oe-O*ue-z*_e,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,a){return this._x=e,this._y=t,this._z=r,this._w=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,a=e._y,l=e._z,x=e._order,_=Math.cos,O=Math.sin,z=_(r/2),q=_(a/2),oe=_(l/2),ue=O(r/2),_e=O(a/2),be=O(l/2);switch(x){case"XYZ":this._x=ue*q*oe+z*_e*be,this._y=z*_e*oe-ue*q*be,this._z=z*q*be+ue*_e*oe,this._w=z*q*oe-ue*_e*be;break;case"YXZ":this._x=ue*q*oe+z*_e*be,this._y=z*_e*oe-ue*q*be,this._z=z*q*be-ue*_e*oe,this._w=z*q*oe+ue*_e*be;break;case"ZXY":this._x=ue*q*oe-z*_e*be,this._y=z*_e*oe+ue*q*be,this._z=z*q*be+ue*_e*oe,this._w=z*q*oe-ue*_e*be;break;case"ZYX":this._x=ue*q*oe-z*_e*be,this._y=z*_e*oe+ue*q*be,this._z=z*q*be-ue*_e*oe,this._w=z*q*oe+ue*_e*be;break;case"YZX":this._x=ue*q*oe+z*_e*be,this._y=z*_e*oe+ue*q*be,this._z=z*q*be-ue*_e*oe,this._w=z*q*oe-ue*_e*be;break;case"XZY":this._x=ue*q*oe-z*_e*be,this._y=z*_e*oe-ue*q*be,this._z=z*q*be+ue*_e*oe,this._w=z*q*oe+ue*_e*be;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+x)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,a=Math.sin(r);return this._x=e.x*a,this._y=e.y*a,this._z=e.z*a,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],a=t[4],l=t[8],x=t[1],_=t[5],O=t[9],z=t[2],q=t[6],oe=t[10],ue=r+_+oe;if(ue>0){const _e=.5/Math.sqrt(ue+1);this._w=.25/_e,this._x=(q-O)*_e,this._y=(l-z)*_e,this._z=(x-a)*_e}else if(r>_&&r>oe){const _e=2*Math.sqrt(1+r-_-oe);this._w=(q-O)/_e,this._x=.25*_e,this._y=(a+x)/_e,this._z=(l+z)/_e}else if(_>oe){const _e=2*Math.sqrt(1+_-r-oe);this._w=(l-z)/_e,this._x=(a+x)/_e,this._y=.25*_e,this._z=(O+q)/_e}else{const _e=2*Math.sqrt(1+oe-r-_);this._w=(x-a)/_e,this._x=(l+z)/_e,this._y=(O+q)/_e,this._z=.25*_e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Vi(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const a=Math.min(1,t/r);return this.slerp(e,a),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,a=e._y,l=e._z,x=e._w,_=t._x,O=t._y,z=t._z,q=t._w;return this._x=r*q+x*_+a*z-l*O,this._y=a*q+x*O+l*_-r*z,this._z=l*q+x*z+r*O-a*_,this._w=x*q-r*_-a*O-l*z,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,a=this._y,l=this._z,x=this._w;let _=x*e._w+r*e._x+a*e._y+l*e._z;if(_<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,_=-_):this.copy(e),_>=1)return this._w=x,this._x=r,this._y=a,this._z=l,this;const O=1-_*_;if(O<=Number.EPSILON){const _e=1-t;return this._w=_e*x+t*this._w,this._x=_e*r+t*this._x,this._y=_e*a+t*this._y,this._z=_e*l+t*this._z,this.normalize(),this}const z=Math.sqrt(O),q=Math.atan2(z,_),oe=Math.sin((1-t)*q)/z,ue=Math.sin(t*q)/z;return this._w=x*oe+this._w*ue,this._x=r*oe+this._x*ue,this._y=a*oe+this._y*ue,this._z=l*oe+this._z*ue,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),a=Math.sqrt(1-r),l=Math.sqrt(r);return this.set(a*Math.sin(e),a*Math.cos(e),l*Math.sin(t),l*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class st{constructor(e=0,t=0,r=0){st.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Dg.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Dg.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,a=this.z,l=e.elements;return this.x=l[0]*t+l[3]*r+l[6]*a,this.y=l[1]*t+l[4]*r+l[7]*a,this.z=l[2]*t+l[5]*r+l[8]*a,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,a=this.z,l=e.elements,x=1/(l[3]*t+l[7]*r+l[11]*a+l[15]);return this.x=(l[0]*t+l[4]*r+l[8]*a+l[12])*x,this.y=(l[1]*t+l[5]*r+l[9]*a+l[13])*x,this.z=(l[2]*t+l[6]*r+l[10]*a+l[14])*x,this}applyQuaternion(e){const t=this.x,r=this.y,a=this.z,l=e.x,x=e.y,_=e.z,O=e.w,z=2*(x*a-_*r),q=2*(_*t-l*a),oe=2*(l*r-x*t);return this.x=t+O*z+x*oe-_*q,this.y=r+O*q+_*z-l*oe,this.z=a+O*oe+l*q-x*z,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,a=this.z,l=e.elements;return this.x=l[0]*t+l[4]*r+l[8]*a,this.y=l[1]*t+l[5]*r+l[9]*a,this.z=l[2]*t+l[6]*r+l[10]*a,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,a=e.y,l=e.z,x=t.x,_=t.y,O=t.z;return this.x=a*O-l*_,this.y=l*x-r*O,this.z=r*_-a*x,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return $f.copy(this).projectOnVector(e),this.sub($f)}reflect(e){return this.sub($f.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Vi(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,a=this.z-e.z;return t*t+r*r+a*a}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const a=Math.sin(t)*e;return this.x=a*Math.sin(r),this.y=Math.cos(t)*e,this.z=a*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),a=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=a,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const $f=new st,Dg=new Oi;class ys{constructor(e=new st(1/0,1/0,1/0),t=new st(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(Yo.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(Yo.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Yo.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const l=r.getAttribute("position");if(t===!0&&l!==void 0&&e.isInstancedMesh!==!0)for(let x=0,_=l.count;x<_;x++)e.isMesh===!0?e.getVertexPosition(x,Yo):Yo.fromBufferAttribute(l,x),Yo.applyMatrix4(e.matrixWorld),this.expandByPoint(Yo);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Pd.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),Pd.copy(r.boundingBox)),Pd.applyMatrix4(e.matrixWorld),this.union(Pd)}const a=e.children;for(let l=0,x=a.length;l<x;l++)this.expandByObject(a[l],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Yo),Yo.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(du),Od.subVectors(this.max,du),uc.subVectors(e.a,du),dc.subVectors(e.b,du),hc.subVectors(e.c,du),Ys.subVectors(dc,uc),qs.subVectors(hc,dc),Tl.subVectors(uc,hc);let t=[0,-Ys.z,Ys.y,0,-qs.z,qs.y,0,-Tl.z,Tl.y,Ys.z,0,-Ys.x,qs.z,0,-qs.x,Tl.z,0,-Tl.x,-Ys.y,Ys.x,0,-qs.y,qs.x,0,-Tl.y,Tl.x,0];return!ep(t,uc,dc,hc,Od)||(t=[1,0,0,0,1,0,0,0,1],!ep(t,uc,dc,hc,Od))?!1:(Nd.crossVectors(Ys,qs),t=[Nd.x,Nd.y,Nd.z],ep(t,uc,dc,hc,Od))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Yo).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Yo).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Ts[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ts[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ts[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ts[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ts[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ts[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ts[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ts[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ts),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ts=[new st,new st,new st,new st,new st,new st,new st,new st],Yo=new st,Pd=new ys,uc=new st,dc=new st,hc=new st,Ys=new st,qs=new st,Tl=new st,du=new st,Od=new st,Nd=new st,Al=new st;function ep(n,e,t,r,a){for(let l=0,x=n.length-3;l<=x;l+=3){Al.fromArray(n,l);const _=a.x*Math.abs(Al.x)+a.y*Math.abs(Al.y)+a.z*Math.abs(Al.z),O=e.dot(Al),z=t.dot(Al),q=r.dot(Al);if(Math.max(-Math.max(O,z,q),Math.min(O,z,q))>_)return!1}return!0}const $w=new ys,hu=new st,tp=new st;class Vl{constructor(e=new st,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):$w.setFromPoints(e).getCenter(r);let a=0;for(let l=0,x=e.length;l<x;l++)a=Math.max(a,r.distanceToSquared(e[l]));return this.radius=Math.sqrt(a),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;hu.subVectors(e,this.center);const t=hu.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),a=(r-this.radius)*.5;this.center.addScaledVector(hu,a/r),this.radius+=a}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(tp.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(hu.copy(e.center).add(tp)),this.expandByPoint(hu.copy(e.center).sub(tp))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const As=new st,rp=new st,Dd=new st,Js=new st,np=new st,Id=new st,ap=new st;class Qu{constructor(e=new st,t=new st(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,As)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=As.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(As.copy(this.origin).addScaledVector(this.direction,t),As.distanceToSquared(e))}distanceSqToSegment(e,t,r,a){rp.copy(e).add(t).multiplyScalar(.5),Dd.copy(t).sub(e).normalize(),Js.copy(this.origin).sub(rp);const l=e.distanceTo(t)*.5,x=-this.direction.dot(Dd),_=Js.dot(this.direction),O=-Js.dot(Dd),z=Js.lengthSq(),q=Math.abs(1-x*x);let oe,ue,_e,be;if(q>0)if(oe=x*O-_,ue=x*_-O,be=l*q,oe>=0)if(ue>=-be)if(ue<=be){const Pe=1/q;oe*=Pe,ue*=Pe,_e=oe*(oe+x*ue+2*_)+ue*(x*oe+ue+2*O)+z}else ue=l,oe=Math.max(0,-(x*ue+_)),_e=-oe*oe+ue*(ue+2*O)+z;else ue=-l,oe=Math.max(0,-(x*ue+_)),_e=-oe*oe+ue*(ue+2*O)+z;else ue<=-be?(oe=Math.max(0,-(-x*l+_)),ue=oe>0?-l:Math.min(Math.max(-l,-O),l),_e=-oe*oe+ue*(ue+2*O)+z):ue<=be?(oe=0,ue=Math.min(Math.max(-l,-O),l),_e=ue*(ue+2*O)+z):(oe=Math.max(0,-(x*l+_)),ue=oe>0?l:Math.min(Math.max(-l,-O),l),_e=-oe*oe+ue*(ue+2*O)+z);else ue=x>0?-l:l,oe=Math.max(0,-(x*ue+_)),_e=-oe*oe+ue*(ue+2*O)+z;return r&&r.copy(this.origin).addScaledVector(this.direction,oe),a&&a.copy(rp).addScaledVector(Dd,ue),_e}intersectSphere(e,t){As.subVectors(e.center,this.origin);const r=As.dot(this.direction),a=As.dot(As)-r*r,l=e.radius*e.radius;if(a>l)return null;const x=Math.sqrt(l-a),_=r-x,O=r+x;return O<0?null:_<0?this.at(O,t):this.at(_,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,a,l,x,_,O;const z=1/this.direction.x,q=1/this.direction.y,oe=1/this.direction.z,ue=this.origin;return z>=0?(r=(e.min.x-ue.x)*z,a=(e.max.x-ue.x)*z):(r=(e.max.x-ue.x)*z,a=(e.min.x-ue.x)*z),q>=0?(l=(e.min.y-ue.y)*q,x=(e.max.y-ue.y)*q):(l=(e.max.y-ue.y)*q,x=(e.min.y-ue.y)*q),r>x||l>a||((l>r||isNaN(r))&&(r=l),(x<a||isNaN(a))&&(a=x),oe>=0?(_=(e.min.z-ue.z)*oe,O=(e.max.z-ue.z)*oe):(_=(e.max.z-ue.z)*oe,O=(e.min.z-ue.z)*oe),r>O||_>a)||((_>r||r!==r)&&(r=_),(O<a||a!==a)&&(a=O),a<0)?null:this.at(r>=0?r:a,t)}intersectsBox(e){return this.intersectBox(e,As)!==null}intersectTriangle(e,t,r,a,l){np.subVectors(t,e),Id.subVectors(r,e),ap.crossVectors(np,Id);let x=this.direction.dot(ap),_;if(x>0){if(a)return null;_=1}else if(x<0)_=-1,x=-x;else return null;Js.subVectors(this.origin,e);const O=_*this.direction.dot(Id.crossVectors(Js,Id));if(O<0)return null;const z=_*this.direction.dot(np.cross(Js));if(z<0||O+z>x)return null;const q=-_*Js.dot(ap);return q<0?null:this.at(q/x,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class jn{constructor(e,t,r,a,l,x,_,O,z,q,oe,ue,_e,be,Pe,Se){jn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,a,l,x,_,O,z,q,oe,ue,_e,be,Pe,Se)}set(e,t,r,a,l,x,_,O,z,q,oe,ue,_e,be,Pe,Se){const Ee=this.elements;return Ee[0]=e,Ee[4]=t,Ee[8]=r,Ee[12]=a,Ee[1]=l,Ee[5]=x,Ee[9]=_,Ee[13]=O,Ee[2]=z,Ee[6]=q,Ee[10]=oe,Ee[14]=ue,Ee[3]=_e,Ee[7]=be,Ee[11]=Pe,Ee[15]=Se,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new jn().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,a=1/fc.setFromMatrixColumn(e,0).length(),l=1/fc.setFromMatrixColumn(e,1).length(),x=1/fc.setFromMatrixColumn(e,2).length();return t[0]=r[0]*a,t[1]=r[1]*a,t[2]=r[2]*a,t[3]=0,t[4]=r[4]*l,t[5]=r[5]*l,t[6]=r[6]*l,t[7]=0,t[8]=r[8]*x,t[9]=r[9]*x,t[10]=r[10]*x,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,a=e.y,l=e.z,x=Math.cos(r),_=Math.sin(r),O=Math.cos(a),z=Math.sin(a),q=Math.cos(l),oe=Math.sin(l);if(e.order==="XYZ"){const ue=x*q,_e=x*oe,be=_*q,Pe=_*oe;t[0]=O*q,t[4]=-O*oe,t[8]=z,t[1]=_e+be*z,t[5]=ue-Pe*z,t[9]=-_*O,t[2]=Pe-ue*z,t[6]=be+_e*z,t[10]=x*O}else if(e.order==="YXZ"){const ue=O*q,_e=O*oe,be=z*q,Pe=z*oe;t[0]=ue+Pe*_,t[4]=be*_-_e,t[8]=x*z,t[1]=x*oe,t[5]=x*q,t[9]=-_,t[2]=_e*_-be,t[6]=Pe+ue*_,t[10]=x*O}else if(e.order==="ZXY"){const ue=O*q,_e=O*oe,be=z*q,Pe=z*oe;t[0]=ue-Pe*_,t[4]=-x*oe,t[8]=be+_e*_,t[1]=_e+be*_,t[5]=x*q,t[9]=Pe-ue*_,t[2]=-x*z,t[6]=_,t[10]=x*O}else if(e.order==="ZYX"){const ue=x*q,_e=x*oe,be=_*q,Pe=_*oe;t[0]=O*q,t[4]=be*z-_e,t[8]=ue*z+Pe,t[1]=O*oe,t[5]=Pe*z+ue,t[9]=_e*z-be,t[2]=-z,t[6]=_*O,t[10]=x*O}else if(e.order==="YZX"){const ue=x*O,_e=x*z,be=_*O,Pe=_*z;t[0]=O*q,t[4]=Pe-ue*oe,t[8]=be*oe+_e,t[1]=oe,t[5]=x*q,t[9]=-_*q,t[2]=-z*q,t[6]=_e*oe+be,t[10]=ue-Pe*oe}else if(e.order==="XZY"){const ue=x*O,_e=x*z,be=_*O,Pe=_*z;t[0]=O*q,t[4]=-oe,t[8]=z*q,t[1]=ue*oe+Pe,t[5]=x*q,t[9]=_e*oe-be,t[2]=be*oe-_e,t[6]=_*q,t[10]=Pe*oe+ue}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(eM,e,tM)}lookAt(e,t,r){const a=this.elements;return Eo.subVectors(e,t),Eo.lengthSq()===0&&(Eo.z=1),Eo.normalize(),Xs.crossVectors(r,Eo),Xs.lengthSq()===0&&(Math.abs(r.z)===1?Eo.x+=1e-4:Eo.z+=1e-4,Eo.normalize(),Xs.crossVectors(r,Eo)),Xs.normalize(),zd.crossVectors(Eo,Xs),a[0]=Xs.x,a[4]=zd.x,a[8]=Eo.x,a[1]=Xs.y,a[5]=zd.y,a[9]=Eo.y,a[2]=Xs.z,a[6]=zd.z,a[10]=Eo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,a=t.elements,l=this.elements,x=r[0],_=r[4],O=r[8],z=r[12],q=r[1],oe=r[5],ue=r[9],_e=r[13],be=r[2],Pe=r[6],Se=r[10],Ee=r[14],Xe=r[3],qe=r[7],$e=r[11],ft=r[15],gt=a[0],pt=a[4],Ht=a[8],ur=a[12],Ve=a[1],nt=a[5],nr=a[9],Zt=a[13],Xt=a[2],Pr=a[6],cr=a[10],Qr=a[14],Tr=a[3],ln=a[7],Sn=a[11],Wn=a[15];return l[0]=x*gt+_*Ve+O*Xt+z*Tr,l[4]=x*pt+_*nt+O*Pr+z*ln,l[8]=x*Ht+_*nr+O*cr+z*Sn,l[12]=x*ur+_*Zt+O*Qr+z*Wn,l[1]=q*gt+oe*Ve+ue*Xt+_e*Tr,l[5]=q*pt+oe*nt+ue*Pr+_e*ln,l[9]=q*Ht+oe*nr+ue*cr+_e*Sn,l[13]=q*ur+oe*Zt+ue*Qr+_e*Wn,l[2]=be*gt+Pe*Ve+Se*Xt+Ee*Tr,l[6]=be*pt+Pe*nt+Se*Pr+Ee*ln,l[10]=be*Ht+Pe*nr+Se*cr+Ee*Sn,l[14]=be*ur+Pe*Zt+Se*Qr+Ee*Wn,l[3]=Xe*gt+qe*Ve+$e*Xt+ft*Tr,l[7]=Xe*pt+qe*nt+$e*Pr+ft*ln,l[11]=Xe*Ht+qe*nr+$e*cr+ft*Sn,l[15]=Xe*ur+qe*Zt+$e*Qr+ft*Wn,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],a=e[8],l=e[12],x=e[1],_=e[5],O=e[9],z=e[13],q=e[2],oe=e[6],ue=e[10],_e=e[14],be=e[3],Pe=e[7],Se=e[11],Ee=e[15];return be*(+l*O*oe-a*z*oe-l*_*ue+r*z*ue+a*_*_e-r*O*_e)+Pe*(+t*O*_e-t*z*ue+l*x*ue-a*x*_e+a*z*q-l*O*q)+Se*(+t*z*oe-t*_*_e-l*x*oe+r*x*_e+l*_*q-r*z*q)+Ee*(-a*_*q-t*O*oe+t*_*ue+a*x*oe-r*x*ue+r*O*q)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const a=this.elements;return e.isVector3?(a[12]=e.x,a[13]=e.y,a[14]=e.z):(a[12]=e,a[13]=t,a[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],a=e[2],l=e[3],x=e[4],_=e[5],O=e[6],z=e[7],q=e[8],oe=e[9],ue=e[10],_e=e[11],be=e[12],Pe=e[13],Se=e[14],Ee=e[15],Xe=oe*Se*z-Pe*ue*z+Pe*O*_e-_*Se*_e-oe*O*Ee+_*ue*Ee,qe=be*ue*z-q*Se*z-be*O*_e+x*Se*_e+q*O*Ee-x*ue*Ee,$e=q*Pe*z-be*oe*z+be*_*_e-x*Pe*_e-q*_*Ee+x*oe*Ee,ft=be*oe*O-q*Pe*O-be*_*ue+x*Pe*ue+q*_*Se-x*oe*Se,gt=t*Xe+r*qe+a*$e+l*ft;if(gt===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const pt=1/gt;return e[0]=Xe*pt,e[1]=(Pe*ue*l-oe*Se*l-Pe*a*_e+r*Se*_e+oe*a*Ee-r*ue*Ee)*pt,e[2]=(_*Se*l-Pe*O*l+Pe*a*z-r*Se*z-_*a*Ee+r*O*Ee)*pt,e[3]=(oe*O*l-_*ue*l-oe*a*z+r*ue*z+_*a*_e-r*O*_e)*pt,e[4]=qe*pt,e[5]=(q*Se*l-be*ue*l+be*a*_e-t*Se*_e-q*a*Ee+t*ue*Ee)*pt,e[6]=(be*O*l-x*Se*l-be*a*z+t*Se*z+x*a*Ee-t*O*Ee)*pt,e[7]=(x*ue*l-q*O*l+q*a*z-t*ue*z-x*a*_e+t*O*_e)*pt,e[8]=$e*pt,e[9]=(be*oe*l-q*Pe*l-be*r*_e+t*Pe*_e+q*r*Ee-t*oe*Ee)*pt,e[10]=(x*Pe*l-be*_*l+be*r*z-t*Pe*z-x*r*Ee+t*_*Ee)*pt,e[11]=(q*_*l-x*oe*l-q*r*z+t*oe*z+x*r*_e-t*_*_e)*pt,e[12]=ft*pt,e[13]=(q*Pe*a-be*oe*a+be*r*ue-t*Pe*ue-q*r*Se+t*oe*Se)*pt,e[14]=(be*_*a-x*Pe*a-be*r*O+t*Pe*O+x*r*Se-t*_*Se)*pt,e[15]=(x*oe*a-q*_*a+q*r*O-t*oe*O-x*r*ue+t*_*ue)*pt,this}scale(e){const t=this.elements,r=e.x,a=e.y,l=e.z;return t[0]*=r,t[4]*=a,t[8]*=l,t[1]*=r,t[5]*=a,t[9]*=l,t[2]*=r,t[6]*=a,t[10]*=l,t[3]*=r,t[7]*=a,t[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],a=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,a))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),a=Math.sin(t),l=1-r,x=e.x,_=e.y,O=e.z,z=l*x,q=l*_;return this.set(z*x+r,z*_-a*O,z*O+a*_,0,z*_+a*O,q*_+r,q*O-a*x,0,z*O-a*_,q*O+a*x,l*O*O+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,a,l,x){return this.set(1,r,l,0,e,1,x,0,t,a,1,0,0,0,0,1),this}compose(e,t,r){const a=this.elements,l=t._x,x=t._y,_=t._z,O=t._w,z=l+l,q=x+x,oe=_+_,ue=l*z,_e=l*q,be=l*oe,Pe=x*q,Se=x*oe,Ee=_*oe,Xe=O*z,qe=O*q,$e=O*oe,ft=r.x,gt=r.y,pt=r.z;return a[0]=(1-(Pe+Ee))*ft,a[1]=(_e+$e)*ft,a[2]=(be-qe)*ft,a[3]=0,a[4]=(_e-$e)*gt,a[5]=(1-(ue+Ee))*gt,a[6]=(Se+Xe)*gt,a[7]=0,a[8]=(be+qe)*pt,a[9]=(Se-Xe)*pt,a[10]=(1-(ue+Pe))*pt,a[11]=0,a[12]=e.x,a[13]=e.y,a[14]=e.z,a[15]=1,this}decompose(e,t,r){const a=this.elements;let l=fc.set(a[0],a[1],a[2]).length();const x=fc.set(a[4],a[5],a[6]).length(),_=fc.set(a[8],a[9],a[10]).length();this.determinant()<0&&(l=-l),e.x=a[12],e.y=a[13],e.z=a[14],qo.copy(this);const O=1/l,z=1/x,q=1/_;return qo.elements[0]*=O,qo.elements[1]*=O,qo.elements[2]*=O,qo.elements[4]*=z,qo.elements[5]*=z,qo.elements[6]*=z,qo.elements[8]*=q,qo.elements[9]*=q,qo.elements[10]*=q,t.setFromRotationMatrix(qo),r.x=l,r.y=x,r.z=_,this}makePerspective(e,t,r,a,l,x,_=Ns){const O=this.elements,z=2*l/(t-e),q=2*l/(r-a),oe=(t+e)/(t-e),ue=(r+a)/(r-a);let _e,be;if(_===Ns)_e=-(x+l)/(x-l),be=-2*x*l/(x-l);else if(_===Rh)_e=-x/(x-l),be=-x*l/(x-l);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+_);return O[0]=z,O[4]=0,O[8]=oe,O[12]=0,O[1]=0,O[5]=q,O[9]=ue,O[13]=0,O[2]=0,O[6]=0,O[10]=_e,O[14]=be,O[3]=0,O[7]=0,O[11]=-1,O[15]=0,this}makeOrthographic(e,t,r,a,l,x,_=Ns){const O=this.elements,z=1/(t-e),q=1/(r-a),oe=1/(x-l),ue=(t+e)*z,_e=(r+a)*q;let be,Pe;if(_===Ns)be=(x+l)*oe,Pe=-2*oe;else if(_===Rh)be=l*oe,Pe=-1*oe;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+_);return O[0]=2*z,O[4]=0,O[8]=0,O[12]=-ue,O[1]=0,O[5]=2*q,O[9]=0,O[13]=-_e,O[2]=0,O[6]=0,O[10]=Pe,O[14]=-be,O[3]=0,O[7]=0,O[11]=0,O[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let a=0;a<16;a++)if(t[a]!==r[a])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const fc=new st,qo=new jn,eM=new st(0,0,0),tM=new st(1,1,1),Xs=new st,zd=new st,Eo=new st,Ig=new jn,zg=new Oi;class Ko{constructor(e=0,t=0,r=0,a=Ko.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=a}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,a=this._order){return this._x=e,this._y=t,this._z=r,this._order=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const a=e.elements,l=a[0],x=a[4],_=a[8],O=a[1],z=a[5],q=a[9],oe=a[2],ue=a[6],_e=a[10];switch(t){case"XYZ":this._y=Math.asin(Vi(_,-1,1)),Math.abs(_)<.9999999?(this._x=Math.atan2(-q,_e),this._z=Math.atan2(-x,l)):(this._x=Math.atan2(ue,z),this._z=0);break;case"YXZ":this._x=Math.asin(-Vi(q,-1,1)),Math.abs(q)<.9999999?(this._y=Math.atan2(_,_e),this._z=Math.atan2(O,z)):(this._y=Math.atan2(-oe,l),this._z=0);break;case"ZXY":this._x=Math.asin(Vi(ue,-1,1)),Math.abs(ue)<.9999999?(this._y=Math.atan2(-oe,_e),this._z=Math.atan2(-x,z)):(this._y=0,this._z=Math.atan2(O,l));break;case"ZYX":this._y=Math.asin(-Vi(oe,-1,1)),Math.abs(oe)<.9999999?(this._x=Math.atan2(ue,_e),this._z=Math.atan2(O,l)):(this._x=0,this._z=Math.atan2(-x,z));break;case"YZX":this._z=Math.asin(Vi(O,-1,1)),Math.abs(O)<.9999999?(this._x=Math.atan2(-q,z),this._y=Math.atan2(-oe,l)):(this._x=0,this._y=Math.atan2(_,_e));break;case"XZY":this._z=Math.asin(-Vi(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(ue,z),this._y=Math.atan2(_,l)):(this._x=Math.atan2(-q,_e),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return Ig.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Ig,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return zg.setFromEuler(this),this.setFromQuaternion(zg,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Ko.DEFAULT_ORDER="XYZ";class gm{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let rM=0;const Fg=new st,pc=new Oi,Ss=new jn,Fd=new st,fu=new st,nM=new st,aM=new Oi,Ug=new st(1,0,0),Bg=new st(0,1,0),Hg=new st(0,0,1),Vg={type:"added"},iM={type:"removed"},mc={type:"childadded",child:null},ip={type:"childremoved",child:null};class Ei extends Hl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:rM++}),this.uuid=vs(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ei.DEFAULT_UP.clone();const e=new st,t=new Ko,r=new Oi,a=new st(1,1,1);function l(){r.setFromEuler(t,!1)}function x(){t.setFromQuaternion(r,void 0,!1)}t._onChange(l),r._onChange(x),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new jn},normalMatrix:{value:new ma}}),this.matrix=new jn,this.matrixWorld=new jn,this.matrixAutoUpdate=Ei.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Ei.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new gm,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return pc.setFromAxisAngle(e,t),this.quaternion.multiply(pc),this}rotateOnWorldAxis(e,t){return pc.setFromAxisAngle(e,t),this.quaternion.premultiply(pc),this}rotateX(e){return this.rotateOnAxis(Ug,e)}rotateY(e){return this.rotateOnAxis(Bg,e)}rotateZ(e){return this.rotateOnAxis(Hg,e)}translateOnAxis(e,t){return Fg.copy(e).applyQuaternion(this.quaternion),this.position.add(Fg.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Ug,e)}translateY(e){return this.translateOnAxis(Bg,e)}translateZ(e){return this.translateOnAxis(Hg,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Ss.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?Fd.copy(e):Fd.set(e,t,r);const a=this.parent;this.updateWorldMatrix(!0,!1),fu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ss.lookAt(fu,Fd,this.up):Ss.lookAt(Fd,fu,this.up),this.quaternion.setFromRotationMatrix(Ss),a&&(Ss.extractRotation(a.matrixWorld),pc.setFromRotationMatrix(Ss),this.quaternion.premultiply(pc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Vg),mc.child=e,this.dispatchEvent(mc),mc.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(iM),ip.child=e,this.dispatchEvent(ip),ip.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Ss.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ss.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ss),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Vg),mc.child=e,this.dispatchEvent(mc),mc.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,a=this.children.length;r<a;r++){const l=this.children[r].getObjectByProperty(e,t);if(l!==void 0)return l}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const a=this.children;for(let l=0,x=a.length;l<x;l++)a[l].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fu,e,nM),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fu,aM,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,a=t.length;r<a;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,a=t.length;r<a;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,a=t.length;r<a;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const a=this.children;for(let l=0,x=a.length;l<x;l++)a[l].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const a={};a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),this.castShadow===!0&&(a.castShadow=!0),this.receiveShadow===!0&&(a.receiveShadow=!0),this.visible===!1&&(a.visible=!1),this.frustumCulled===!1&&(a.frustumCulled=!1),this.renderOrder!==0&&(a.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),a.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(a.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(a.type="BatchedMesh",a.perObjectFrustumCulled=this.perObjectFrustumCulled,a.sortObjects=this.sortObjects,a.drawRanges=this._drawRanges,a.reservedRanges=this._reservedRanges,a.visibility=this._visibility,a.active=this._active,a.bounds=this._bounds.map(_=>({boxInitialized:_.boxInitialized,boxMin:_.box.min.toArray(),boxMax:_.box.max.toArray(),sphereInitialized:_.sphereInitialized,sphereRadius:_.sphere.radius,sphereCenter:_.sphere.center.toArray()})),a.maxInstanceCount=this._maxInstanceCount,a.maxVertexCount=this._maxVertexCount,a.maxIndexCount=this._maxIndexCount,a.geometryInitialized=this._geometryInitialized,a.geometryCount=this._geometryCount,a.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(a.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(a.boundingSphere={center:a.boundingSphere.center.toArray(),radius:a.boundingSphere.radius}),this.boundingBox!==null&&(a.boundingBox={min:a.boundingBox.min.toArray(),max:a.boundingBox.max.toArray()}));function l(_,O){return _[O.uuid]===void 0&&(_[O.uuid]=O.toJSON(e)),O.uuid}if(this.isScene)this.background&&(this.background.isColor?a.background=this.background.toJSON():this.background.isTexture&&(a.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(a.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){a.geometry=l(e.geometries,this.geometry);const _=this.geometry.parameters;if(_!==void 0&&_.shapes!==void 0){const O=_.shapes;if(Array.isArray(O))for(let z=0,q=O.length;z<q;z++){const oe=O[z];l(e.shapes,oe)}else l(e.shapes,O)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(l(e.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const _=[];for(let O=0,z=this.material.length;O<z;O++)_.push(l(e.materials,this.material[O]));a.material=_}else a.material=l(e.materials,this.material);if(this.children.length>0){a.children=[];for(let _=0;_<this.children.length;_++)a.children.push(this.children[_].toJSON(e).object)}if(this.animations.length>0){a.animations=[];for(let _=0;_<this.animations.length;_++){const O=this.animations[_];a.animations.push(l(e.animations,O))}}if(t){const _=x(e.geometries),O=x(e.materials),z=x(e.textures),q=x(e.images),oe=x(e.shapes),ue=x(e.skeletons),_e=x(e.animations),be=x(e.nodes);_.length>0&&(r.geometries=_),O.length>0&&(r.materials=O),z.length>0&&(r.textures=z),q.length>0&&(r.images=q),oe.length>0&&(r.shapes=oe),ue.length>0&&(r.skeletons=ue),_e.length>0&&(r.animations=_e),be.length>0&&(r.nodes=be)}return r.object=a,r;function x(_){const O=[];for(const z in _){const q=_[z];delete q.metadata,O.push(q)}return O}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const a=e.children[r];this.add(a.clone())}return this}}Ei.DEFAULT_UP=new st(0,1,0);Ei.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ei.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Jo=new st,Cs=new st,op=new st,Es=new st,gc=new st,vc=new st,Gg=new st,sp=new st,lp=new st,cp=new st,up=new Si,dp=new Si,hp=new Si;class ko{constructor(e=new st,t=new st,r=new st){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,a){a.subVectors(r,t),Jo.subVectors(e,t),a.cross(Jo);const l=a.lengthSq();return l>0?a.multiplyScalar(1/Math.sqrt(l)):a.set(0,0,0)}static getBarycoord(e,t,r,a,l){Jo.subVectors(a,t),Cs.subVectors(r,t),op.subVectors(e,t);const x=Jo.dot(Jo),_=Jo.dot(Cs),O=Jo.dot(op),z=Cs.dot(Cs),q=Cs.dot(op),oe=x*z-_*_;if(oe===0)return l.set(0,0,0),null;const ue=1/oe,_e=(z*O-_*q)*ue,be=(x*q-_*O)*ue;return l.set(1-_e-be,be,_e)}static containsPoint(e,t,r,a){return this.getBarycoord(e,t,r,a,Es)===null?!1:Es.x>=0&&Es.y>=0&&Es.x+Es.y<=1}static getInterpolation(e,t,r,a,l,x,_,O){return this.getBarycoord(e,t,r,a,Es)===null?(O.x=0,O.y=0,"z"in O&&(O.z=0),"w"in O&&(O.w=0),null):(O.setScalar(0),O.addScaledVector(l,Es.x),O.addScaledVector(x,Es.y),O.addScaledVector(_,Es.z),O)}static getInterpolatedAttribute(e,t,r,a,l,x){return up.setScalar(0),dp.setScalar(0),hp.setScalar(0),up.fromBufferAttribute(e,t),dp.fromBufferAttribute(e,r),hp.fromBufferAttribute(e,a),x.setScalar(0),x.addScaledVector(up,l.x),x.addScaledVector(dp,l.y),x.addScaledVector(hp,l.z),x}static isFrontFacing(e,t,r,a){return Jo.subVectors(r,t),Cs.subVectors(e,t),Jo.cross(Cs).dot(a)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,a){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[a]),this}setFromAttributeAndIndices(e,t,r,a){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,a),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Jo.subVectors(this.c,this.b),Cs.subVectors(this.a,this.b),Jo.cross(Cs).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ko.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ko.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,a,l){return ko.getInterpolation(e,this.a,this.b,this.c,t,r,a,l)}containsPoint(e){return ko.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ko.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,a=this.b,l=this.c;let x,_;gc.subVectors(a,r),vc.subVectors(l,r),sp.subVectors(e,r);const O=gc.dot(sp),z=vc.dot(sp);if(O<=0&&z<=0)return t.copy(r);lp.subVectors(e,a);const q=gc.dot(lp),oe=vc.dot(lp);if(q>=0&&oe<=q)return t.copy(a);const ue=O*oe-q*z;if(ue<=0&&O>=0&&q<=0)return x=O/(O-q),t.copy(r).addScaledVector(gc,x);cp.subVectors(e,l);const _e=gc.dot(cp),be=vc.dot(cp);if(be>=0&&_e<=be)return t.copy(l);const Pe=_e*z-O*be;if(Pe<=0&&z>=0&&be<=0)return _=z/(z-be),t.copy(r).addScaledVector(vc,_);const Se=q*be-_e*oe;if(Se<=0&&oe-q>=0&&_e-be>=0)return Gg.subVectors(l,a),_=(oe-q)/(oe-q+(_e-be)),t.copy(a).addScaledVector(Gg,_);const Ee=1/(Se+Pe+ue);return x=Pe*Ee,_=ue*Ee,t.copy(r).addScaledVector(gc,x).addScaledVector(vc,_)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const f2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Zs={h:0,s:0,l:0},Ud={h:0,s:0,l:0};function fp(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}let qn=class{constructor(n,e,t){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(n,e,t)}set(n,e,t){if(e===void 0&&t===void 0){const r=n;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(n,e,t);return this}setScalar(n){return this.r=n,this.g=n,this.b=n,this}setHex(n,e=hs){return n=Math.floor(n),this.r=(n>>16&255)/255,this.g=(n>>8&255)/255,this.b=(n&255)/255,Ya.toWorkingColorSpace(this,e),this}setRGB(n,e,t,r=Ya.workingColorSpace){return this.r=n,this.g=e,this.b=t,Ya.toWorkingColorSpace(this,r),this}setHSL(n,e,t,r=Ya.workingColorSpace){if(n=mm(n,1),e=Vi(e,0,1),t=Vi(t,0,1),e===0)this.r=this.g=this.b=t;else{const a=t<=.5?t*(1+e):t+e-t*e,l=2*t-a;this.r=fp(l,a,n+1/3),this.g=fp(l,a,n),this.b=fp(l,a,n-1/3)}return Ya.toWorkingColorSpace(this,r),this}setStyle(n,e=hs){function t(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+n+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(n)){let a;const l=r[1],x=r[2];switch(l){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(x))return t(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,e);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(x))return t(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,e);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(x))return t(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,e);break;default:console.warn("THREE.Color: Unknown color model "+n)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(n)){const a=r[1],l=a.length;if(l===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,e);if(l===6)return this.setHex(parseInt(a,16),e);console.warn("THREE.Color: Invalid hex color "+n)}else if(n&&n.length>0)return this.setColorName(n,e);return this}setColorName(n,e=hs){const t=f2[n.toLowerCase()];return t!==void 0?this.setHex(t,e):console.warn("THREE.Color: Unknown color "+n),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(n){return this.r=n.r,this.g=n.g,this.b=n.b,this}copySRGBToLinear(n){return this.r=zc(n.r),this.g=zc(n.g),this.b=zc(n.b),this}copyLinearToSRGB(n){return this.r=Qf(n.r),this.g=Qf(n.g),this.b=Qf(n.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(n=hs){return Ya.fromWorkingColorSpace(lo.copy(this),n),Math.round(Vi(lo.r*255,0,255))*65536+Math.round(Vi(lo.g*255,0,255))*256+Math.round(Vi(lo.b*255,0,255))}getHexString(n=hs){return("000000"+this.getHex(n).toString(16)).slice(-6)}getHSL(n,e=Ya.workingColorSpace){Ya.fromWorkingColorSpace(lo.copy(this),e);const t=lo.r,r=lo.g,a=lo.b,l=Math.max(t,r,a),x=Math.min(t,r,a);let _,O;const z=(x+l)/2;if(x===l)_=0,O=0;else{const q=l-x;switch(O=z<=.5?q/(l+x):q/(2-l-x),l){case t:_=(r-a)/q+(r<a?6:0);break;case r:_=(a-t)/q+2;break;case a:_=(t-r)/q+4;break}_/=6}return n.h=_,n.s=O,n.l=z,n}getRGB(n,e=Ya.workingColorSpace){return Ya.fromWorkingColorSpace(lo.copy(this),e),n.r=lo.r,n.g=lo.g,n.b=lo.b,n}getStyle(n=hs){Ya.fromWorkingColorSpace(lo.copy(this),n);const e=lo.r,t=lo.g,r=lo.b;return n!==hs?`color(${n} ${e.toFixed(3)} ${t.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(e*255)},${Math.round(t*255)},${Math.round(r*255)})`}offsetHSL(n,e,t){return this.getHSL(Zs),this.setHSL(Zs.h+n,Zs.s+e,Zs.l+t)}add(n){return this.r+=n.r,this.g+=n.g,this.b+=n.b,this}addColors(n,e){return this.r=n.r+e.r,this.g=n.g+e.g,this.b=n.b+e.b,this}addScalar(n){return this.r+=n,this.g+=n,this.b+=n,this}sub(n){return this.r=Math.max(0,this.r-n.r),this.g=Math.max(0,this.g-n.g),this.b=Math.max(0,this.b-n.b),this}multiply(n){return this.r*=n.r,this.g*=n.g,this.b*=n.b,this}multiplyScalar(n){return this.r*=n,this.g*=n,this.b*=n,this}lerp(n,e){return this.r+=(n.r-this.r)*e,this.g+=(n.g-this.g)*e,this.b+=(n.b-this.b)*e,this}lerpColors(n,e,t){return this.r=n.r+(e.r-n.r)*t,this.g=n.g+(e.g-n.g)*t,this.b=n.b+(e.b-n.b)*t,this}lerpHSL(n,e){this.getHSL(Zs),n.getHSL(Ud);const t=Iu(Zs.h,Ud.h,e),r=Iu(Zs.s,Ud.s,e),a=Iu(Zs.l,Ud.l,e);return this.setHSL(t,r,a),this}setFromVector3(n){return this.r=n.x,this.g=n.y,this.b=n.z,this}applyMatrix3(n){const e=this.r,t=this.g,r=this.b,a=n.elements;return this.r=a[0]*e+a[3]*t+a[6]*r,this.g=a[1]*e+a[4]*t+a[7]*r,this.b=a[2]*e+a[5]*t+a[8]*r,this}equals(n){return n.r===this.r&&n.g===this.g&&n.b===this.b}fromArray(n,e=0){return this.r=n[e],this.g=n[e+1],this.b=n[e+2],this}toArray(n=[],e=0){return n[e]=this.r,n[e+1]=this.g,n[e+2]=this.b,n}fromBufferAttribute(n,e){return this.r=n.getX(e),this.g=n.getY(e),this.b=n.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const lo=new qn;qn.NAMES=f2;let oM=0;class zs extends Hl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:oM++}),this.uuid=vs(),this.name="",this.type="Material",this.blending=Dc,this.side=rl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Hp,this.blendDst=Vp,this.blendEquation=kl,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new qn(0,0,0),this.blendAlpha=0,this.depthFunc=Fc,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Lg,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=lc,this.stencilZFail=lc,this.stencilZPass=lc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const a=this[t];if(a===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}a&&a.isColor?a.set(r):a&&a.isVector3&&r&&r.isVector3?a.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Dc&&(r.blending=this.blending),this.side!==rl&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==Hp&&(r.blendSrc=this.blendSrc),this.blendDst!==Vp&&(r.blendDst=this.blendDst),this.blendEquation!==kl&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==Fc&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Lg&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==lc&&(r.stencilFail=this.stencilFail),this.stencilZFail!==lc&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==lc&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function a(l){const x=[];for(const _ in l){const O=l[_];delete O.metadata,x.push(O)}return x}if(t){const l=a(e.textures),x=a(e.images);l.length>0&&(r.textures=l),x.length>0&&(r.images=x)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const a=t.length;r=new Array(a);for(let l=0;l!==a;++l)r[l]=t[l].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class Gl extends zs{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new qn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ko,this.combine=im,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const zi=new st,Bd=new Jr;class Xi{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=S0,this.updateRanges=[],this.gpuType=ms,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let a=0,l=this.itemSize;a<l;a++)this.array[e+a]=t.array[r+a];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)Bd.fromBufferAttribute(this,t),Bd.applyMatrix3(e),this.setXY(t,Bd.x,Bd.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)zi.fromBufferAttribute(this,t),zi.applyMatrix3(e),this.setXYZ(t,zi.x,zi.y,zi.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)zi.fromBufferAttribute(this,t),zi.applyMatrix4(e),this.setXYZ(t,zi.x,zi.y,zi.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)zi.fromBufferAttribute(this,t),zi.applyNormalMatrix(e),this.setXYZ(t,zi.x,zi.y,zi.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)zi.fromBufferAttribute(this,t),zi.transformDirection(e),this.setXYZ(t,zi.x,zi.y,zi.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=Qo(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Qa(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Qo(t,this.array)),t}setX(e,t){return this.normalized&&(t=Qa(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Qo(t,this.array)),t}setY(e,t){return this.normalized&&(t=Qa(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Qo(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Qa(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Qo(t,this.array)),t}setW(e,t){return this.normalized&&(t=Qa(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Qa(t,this.array),r=Qa(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,a){return e*=this.itemSize,this.normalized&&(t=Qa(t,this.array),r=Qa(r,this.array),a=Qa(a,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=a,this}setXYZW(e,t,r,a,l){return e*=this.itemSize,this.normalized&&(t=Qa(t,this.array),r=Qa(r,this.array),a=Qa(a,this.array),l=Qa(l,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=a,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==S0&&(e.usage=this.usage),e}}class p2 extends Xi{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class m2 extends Xi{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class qa extends Xi{constructor(e,t,r){super(new Float32Array(e),t,r)}}let sM=0;const Fo=new jn,pp=new Ei,yc=new st,Lo=new ys,pu=new ys,Ji=new st;class di extends Hl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:sM++}),this.uuid=vs(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(u2(e)?m2:p2)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const l=new ma().getNormalMatrix(e);r.applyNormalMatrix(l),r.needsUpdate=!0}const a=this.attributes.tangent;return a!==void 0&&(a.transformDirection(e),a.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Fo.makeRotationFromQuaternion(e),this.applyMatrix4(Fo),this}rotateX(e){return Fo.makeRotationX(e),this.applyMatrix4(Fo),this}rotateY(e){return Fo.makeRotationY(e),this.applyMatrix4(Fo),this}rotateZ(e){return Fo.makeRotationZ(e),this.applyMatrix4(Fo),this}translate(e,t,r){return Fo.makeTranslation(e,t,r),this.applyMatrix4(Fo),this}scale(e,t,r){return Fo.makeScale(e,t,r),this.applyMatrix4(Fo),this}lookAt(e){return pp.lookAt(e),pp.updateMatrix(),this.applyMatrix4(pp.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(yc).negate(),this.translate(yc.x,yc.y,yc.z),this}setFromPoints(e){const t=[];for(let r=0,a=e.length;r<a;r++){const l=e[r];t.push(l.x,l.y,l.z||0)}return this.setAttribute("position",new qa(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ys);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new st(-1/0,-1/0,-1/0),new st(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,a=t.length;r<a;r++){const l=t[r];Lo.setFromBufferAttribute(l),this.morphTargetsRelative?(Ji.addVectors(this.boundingBox.min,Lo.min),this.boundingBox.expandByPoint(Ji),Ji.addVectors(this.boundingBox.max,Lo.max),this.boundingBox.expandByPoint(Ji)):(this.boundingBox.expandByPoint(Lo.min),this.boundingBox.expandByPoint(Lo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Vl);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new st,1/0);return}if(e){const r=this.boundingSphere.center;if(Lo.setFromBufferAttribute(e),t)for(let l=0,x=t.length;l<x;l++){const _=t[l];pu.setFromBufferAttribute(_),this.morphTargetsRelative?(Ji.addVectors(Lo.min,pu.min),Lo.expandByPoint(Ji),Ji.addVectors(Lo.max,pu.max),Lo.expandByPoint(Ji)):(Lo.expandByPoint(pu.min),Lo.expandByPoint(pu.max))}Lo.getCenter(r);let a=0;for(let l=0,x=e.count;l<x;l++)Ji.fromBufferAttribute(e,l),a=Math.max(a,r.distanceToSquared(Ji));if(t)for(let l=0,x=t.length;l<x;l++){const _=t[l],O=this.morphTargetsRelative;for(let z=0,q=_.count;z<q;z++)Ji.fromBufferAttribute(_,z),O&&(yc.fromBufferAttribute(e,z),Ji.add(yc)),a=Math.max(a,r.distanceToSquared(Ji))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=t.position,a=t.normal,l=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Xi(new Float32Array(4*r.count),4));const x=this.getAttribute("tangent"),_=[],O=[];for(let Ht=0;Ht<r.count;Ht++)_[Ht]=new st,O[Ht]=new st;const z=new st,q=new st,oe=new st,ue=new Jr,_e=new Jr,be=new Jr,Pe=new st,Se=new st;function Ee(Ht,ur,Ve){z.fromBufferAttribute(r,Ht),q.fromBufferAttribute(r,ur),oe.fromBufferAttribute(r,Ve),ue.fromBufferAttribute(l,Ht),_e.fromBufferAttribute(l,ur),be.fromBufferAttribute(l,Ve),q.sub(z),oe.sub(z),_e.sub(ue),be.sub(ue);const nt=1/(_e.x*be.y-be.x*_e.y);isFinite(nt)&&(Pe.copy(q).multiplyScalar(be.y).addScaledVector(oe,-_e.y).multiplyScalar(nt),Se.copy(oe).multiplyScalar(_e.x).addScaledVector(q,-be.x).multiplyScalar(nt),_[Ht].add(Pe),_[ur].add(Pe),_[Ve].add(Pe),O[Ht].add(Se),O[ur].add(Se),O[Ve].add(Se))}let Xe=this.groups;Xe.length===0&&(Xe=[{start:0,count:e.count}]);for(let Ht=0,ur=Xe.length;Ht<ur;++Ht){const Ve=Xe[Ht],nt=Ve.start,nr=Ve.count;for(let Zt=nt,Xt=nt+nr;Zt<Xt;Zt+=3)Ee(e.getX(Zt+0),e.getX(Zt+1),e.getX(Zt+2))}const qe=new st,$e=new st,ft=new st,gt=new st;function pt(Ht){ft.fromBufferAttribute(a,Ht),gt.copy(ft);const ur=_[Ht];qe.copy(ur),qe.sub(ft.multiplyScalar(ft.dot(ur))).normalize(),$e.crossVectors(gt,ur);const Ve=$e.dot(O[Ht])<0?-1:1;x.setXYZW(Ht,qe.x,qe.y,qe.z,Ve)}for(let Ht=0,ur=Xe.length;Ht<ur;++Ht){const Ve=Xe[Ht],nt=Ve.start,nr=Ve.count;for(let Zt=nt,Xt=nt+nr;Zt<Xt;Zt+=3)pt(e.getX(Zt+0)),pt(e.getX(Zt+1)),pt(e.getX(Zt+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Xi(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let ue=0,_e=r.count;ue<_e;ue++)r.setXYZ(ue,0,0,0);const a=new st,l=new st,x=new st,_=new st,O=new st,z=new st,q=new st,oe=new st;if(e)for(let ue=0,_e=e.count;ue<_e;ue+=3){const be=e.getX(ue+0),Pe=e.getX(ue+1),Se=e.getX(ue+2);a.fromBufferAttribute(t,be),l.fromBufferAttribute(t,Pe),x.fromBufferAttribute(t,Se),q.subVectors(x,l),oe.subVectors(a,l),q.cross(oe),_.fromBufferAttribute(r,be),O.fromBufferAttribute(r,Pe),z.fromBufferAttribute(r,Se),_.add(q),O.add(q),z.add(q),r.setXYZ(be,_.x,_.y,_.z),r.setXYZ(Pe,O.x,O.y,O.z),r.setXYZ(Se,z.x,z.y,z.z)}else for(let ue=0,_e=t.count;ue<_e;ue+=3)a.fromBufferAttribute(t,ue+0),l.fromBufferAttribute(t,ue+1),x.fromBufferAttribute(t,ue+2),q.subVectors(x,l),oe.subVectors(a,l),q.cross(oe),r.setXYZ(ue+0,q.x,q.y,q.z),r.setXYZ(ue+1,q.x,q.y,q.z),r.setXYZ(ue+2,q.x,q.y,q.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Ji.fromBufferAttribute(e,t),Ji.normalize(),e.setXYZ(t,Ji.x,Ji.y,Ji.z)}toNonIndexed(){function e(_,O){const z=_.array,q=_.itemSize,oe=_.normalized,ue=new z.constructor(O.length*q);let _e=0,be=0;for(let Pe=0,Se=O.length;Pe<Se;Pe++){_.isInterleavedBufferAttribute?_e=O[Pe]*_.data.stride+_.offset:_e=O[Pe]*q;for(let Ee=0;Ee<q;Ee++)ue[be++]=z[_e++]}return new Xi(ue,q,oe)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new di,r=this.index.array,a=this.attributes;for(const _ in a){const O=a[_],z=e(O,r);t.setAttribute(_,z)}const l=this.morphAttributes;for(const _ in l){const O=[],z=l[_];for(let q=0,oe=z.length;q<oe;q++){const ue=z[q],_e=e(ue,r);O.push(_e)}t.morphAttributes[_]=O}t.morphTargetsRelative=this.morphTargetsRelative;const x=this.groups;for(let _=0,O=x.length;_<O;_++){const z=x[_];t.addGroup(z.start,z.count,z.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const O=this.parameters;for(const z in O)O[z]!==void 0&&(e[z]=O[z]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const O in r){const z=r[O];e.data.attributes[O]=z.toJSON(e.data)}const a={};let l=!1;for(const O in this.morphAttributes){const z=this.morphAttributes[O],q=[];for(let oe=0,ue=z.length;oe<ue;oe++){const _e=z[oe];q.push(_e.toJSON(e.data))}q.length>0&&(a[O]=q,l=!0)}l&&(e.data.morphAttributes=a,e.data.morphTargetsRelative=this.morphTargetsRelative);const x=this.groups;x.length>0&&(e.data.groups=JSON.parse(JSON.stringify(x)));const _=this.boundingSphere;return _!==null&&(e.data.boundingSphere={center:_.center.toArray(),radius:_.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const a=e.attributes;for(const z in a){const q=a[z];this.setAttribute(z,q.clone(t))}const l=e.morphAttributes;for(const z in l){const q=[],oe=l[z];for(let ue=0,_e=oe.length;ue<_e;ue++)q.push(oe[ue].clone(t));this.morphAttributes[z]=q}this.morphTargetsRelative=e.morphTargetsRelative;const x=e.groups;for(let z=0,q=x.length;z<q;z++){const oe=x[z];this.addGroup(oe.start,oe.count,oe.materialIndex)}const _=e.boundingBox;_!==null&&(this.boundingBox=_.clone());const O=e.boundingSphere;return O!==null&&(this.boundingSphere=O.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const jg=new jn,Sl=new Qu,Hd=new Vl,Wg=new st,Vd=new st,Gd=new st,jd=new st,mp=new st,Wd=new st,Yg=new st,Yd=new st;class Ci extends Ei{constructor(e=new di,t=new Gl){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,l=r.length;a<l;a++){const x=r[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[x]=a}}}}getVertexPosition(e,t){const r=this.geometry,a=r.attributes.position,l=r.morphAttributes.position,x=r.morphTargetsRelative;t.fromBufferAttribute(a,e);const _=this.morphTargetInfluences;if(l&&_){Wd.set(0,0,0);for(let O=0,z=l.length;O<z;O++){const q=_[O],oe=l[O];q!==0&&(mp.fromBufferAttribute(oe,e),x?Wd.addScaledVector(mp,q):Wd.addScaledVector(mp.sub(t),q))}t.add(Wd)}return t}raycast(e,t){const r=this.geometry,a=this.material,l=this.matrixWorld;a!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),Hd.copy(r.boundingSphere),Hd.applyMatrix4(l),Sl.copy(e.ray).recast(e.near),!(Hd.containsPoint(Sl.origin)===!1&&(Sl.intersectSphere(Hd,Wg)===null||Sl.origin.distanceToSquared(Wg)>(e.far-e.near)**2))&&(jg.copy(l).invert(),Sl.copy(e.ray).applyMatrix4(jg),!(r.boundingBox!==null&&Sl.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,Sl)))}_computeIntersections(e,t,r){let a;const l=this.geometry,x=this.material,_=l.index,O=l.attributes.position,z=l.attributes.uv,q=l.attributes.uv1,oe=l.attributes.normal,ue=l.groups,_e=l.drawRange;if(_!==null)if(Array.isArray(x))for(let be=0,Pe=ue.length;be<Pe;be++){const Se=ue[be],Ee=x[Se.materialIndex],Xe=Math.max(Se.start,_e.start),qe=Math.min(_.count,Math.min(Se.start+Se.count,_e.start+_e.count));for(let $e=Xe,ft=qe;$e<ft;$e+=3){const gt=_.getX($e),pt=_.getX($e+1),Ht=_.getX($e+2);a=qd(this,Ee,e,r,z,q,oe,gt,pt,Ht),a&&(a.faceIndex=Math.floor($e/3),a.face.materialIndex=Se.materialIndex,t.push(a))}}else{const be=Math.max(0,_e.start),Pe=Math.min(_.count,_e.start+_e.count);for(let Se=be,Ee=Pe;Se<Ee;Se+=3){const Xe=_.getX(Se),qe=_.getX(Se+1),$e=_.getX(Se+2);a=qd(this,x,e,r,z,q,oe,Xe,qe,$e),a&&(a.faceIndex=Math.floor(Se/3),t.push(a))}}else if(O!==void 0)if(Array.isArray(x))for(let be=0,Pe=ue.length;be<Pe;be++){const Se=ue[be],Ee=x[Se.materialIndex],Xe=Math.max(Se.start,_e.start),qe=Math.min(O.count,Math.min(Se.start+Se.count,_e.start+_e.count));for(let $e=Xe,ft=qe;$e<ft;$e+=3){const gt=$e,pt=$e+1,Ht=$e+2;a=qd(this,Ee,e,r,z,q,oe,gt,pt,Ht),a&&(a.faceIndex=Math.floor($e/3),a.face.materialIndex=Se.materialIndex,t.push(a))}}else{const be=Math.max(0,_e.start),Pe=Math.min(O.count,_e.start+_e.count);for(let Se=be,Ee=Pe;Se<Ee;Se+=3){const Xe=Se,qe=Se+1,$e=Se+2;a=qd(this,x,e,r,z,q,oe,Xe,qe,$e),a&&(a.faceIndex=Math.floor(Se/3),t.push(a))}}}}function lM(n,e,t,r,a,l,x,_){let O;if(e.side===_o?O=r.intersectTriangle(x,l,a,!0,_):O=r.intersectTriangle(a,l,x,e.side===rl,_),O===null)return null;Yd.copy(_),Yd.applyMatrix4(n.matrixWorld);const z=t.ray.origin.distanceTo(Yd);return z<t.near||z>t.far?null:{distance:z,point:Yd.clone(),object:n}}function qd(n,e,t,r,a,l,x,_,O,z){n.getVertexPosition(_,Vd),n.getVertexPosition(O,Gd),n.getVertexPosition(z,jd);const q=lM(n,e,t,r,Vd,Gd,jd,Yg);if(q){const oe=new st;ko.getBarycoord(Yg,Vd,Gd,jd,oe),a&&(q.uv=ko.getInterpolatedAttribute(a,_,O,z,oe,new Jr)),l&&(q.uv1=ko.getInterpolatedAttribute(l,_,O,z,oe,new Jr)),x&&(q.normal=ko.getInterpolatedAttribute(x,_,O,z,oe,new st),q.normal.dot(r.direction)>0&&q.normal.multiplyScalar(-1));const ue={a:_,b:O,c:z,normal:new st,materialIndex:0};ko.getNormal(Vd,Gd,jd,ue.normal),q.face=ue,q.barycoord=oe}return q}class sl extends di{constructor(e=1,t=1,r=1,a=1,l=1,x=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:a,heightSegments:l,depthSegments:x};const _=this;a=Math.floor(a),l=Math.floor(l),x=Math.floor(x);const O=[],z=[],q=[],oe=[];let ue=0,_e=0;be("z","y","x",-1,-1,r,t,e,x,l,0),be("z","y","x",1,-1,r,t,-e,x,l,1),be("x","z","y",1,1,e,r,t,a,x,2),be("x","z","y",1,-1,e,r,-t,a,x,3),be("x","y","z",1,-1,e,t,r,a,l,4),be("x","y","z",-1,-1,e,t,-r,a,l,5),this.setIndex(O),this.setAttribute("position",new qa(z,3)),this.setAttribute("normal",new qa(q,3)),this.setAttribute("uv",new qa(oe,2));function be(Pe,Se,Ee,Xe,qe,$e,ft,gt,pt,Ht,ur){const Ve=$e/pt,nt=ft/Ht,nr=$e/2,Zt=ft/2,Xt=gt/2,Pr=pt+1,cr=Ht+1;let Qr=0,Tr=0;const ln=new st;for(let Sn=0;Sn<cr;Sn++){const Wn=Sn*nt-Zt;for(let Ma=0;Ma<Pr;Ma++){const zn=Ma*Ve-nr;ln[Pe]=zn*Xe,ln[Se]=Wn*qe,ln[Ee]=Xt,z.push(ln.x,ln.y,ln.z),ln[Pe]=0,ln[Se]=0,ln[Ee]=gt>0?1:-1,q.push(ln.x,ln.y,ln.z),oe.push(Ma/pt),oe.push(1-Sn/Ht),Qr+=1}}for(let Sn=0;Sn<Ht;Sn++)for(let Wn=0;Wn<pt;Wn++){const Ma=ue+Wn+Pr*Sn,zn=ue+Wn+Pr*(Sn+1),Or=ue+(Wn+1)+Pr*(Sn+1),$r=ue+(Wn+1)+Pr*Sn;O.push(Ma,zn,$r),O.push(zn,Or,$r),Tr+=6}_.addGroup(_e,Tr,ur),_e+=Tr,ue+=Qr}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sl(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Gc(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const a=n[t][r];a&&(a.isColor||a.isMatrix3||a.isMatrix4||a.isVector2||a.isVector3||a.isVector4||a.isTexture||a.isQuaternion)?a.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=a.clone():Array.isArray(a)?e[t][r]=a.slice():e[t][r]=a}}return e}function vo(n){const e={};for(let t=0;t<n.length;t++){const r=Gc(n[t]);for(const a in r)e[a]=r[a]}return e}function cM(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function g2(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Ya.workingColorSpace}const uM={clone:Gc,merge:vo};var dM=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,hM=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class nl extends zs{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=dM,this.fragmentShader=hM,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Gc(e.uniforms),this.uniformsGroups=cM(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const a in this.uniforms){const l=this.uniforms[a].value;l&&l.isTexture?t.uniforms[a]={type:"t",value:l.toJSON(e).uuid}:l&&l.isColor?t.uniforms[a]={type:"c",value:l.getHex()}:l&&l.isVector2?t.uniforms[a]={type:"v2",value:l.toArray()}:l&&l.isVector3?t.uniforms[a]={type:"v3",value:l.toArray()}:l&&l.isVector4?t.uniforms[a]={type:"v4",value:l.toArray()}:l&&l.isMatrix3?t.uniforms[a]={type:"m3",value:l.toArray()}:l&&l.isMatrix4?t.uniforms[a]={type:"m4",value:l.toArray()}:t.uniforms[a]={value:l}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const a in this.extensions)this.extensions[a]===!0&&(r[a]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class vm extends Ei{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new jn,this.projectionMatrix=new jn,this.projectionMatrixInverse=new jn,this.coordinateSystem=Ns}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Qs=new st,qg=new Jr,Jg=new Jr;class Ro extends vm{constructor(e=50,t=1,r=.1,a=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=a,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=ju*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Du*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return ju*2*Math.atan(Math.tan(Du*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){Qs.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Qs.x,Qs.y).multiplyScalar(-e/Qs.z),Qs.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(Qs.x,Qs.y).multiplyScalar(-e/Qs.z)}getViewSize(e,t){return this.getViewBounds(e,qg,Jg),t.subVectors(Jg,qg)}setViewOffset(e,t,r,a,l,x){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=a,this.view.width=l,this.view.height=x,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Du*.5*this.fov)/this.zoom,r=2*t,a=this.aspect*r,l=-.5*a;const x=this.view;if(this.view!==null&&this.view.enabled){const O=x.fullWidth,z=x.fullHeight;l+=x.offsetX*a/O,t-=x.offsetY*r/z,a*=x.width/O,r*=x.height/z}const _=this.filmOffset;_!==0&&(l+=e*_/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+a,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const xc=-90,_c=1;class fM extends Ei{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const a=new Ro(xc,_c,e,t);a.layers=this.layers,this.add(a);const l=new Ro(xc,_c,e,t);l.layers=this.layers,this.add(l);const x=new Ro(xc,_c,e,t);x.layers=this.layers,this.add(x);const _=new Ro(xc,_c,e,t);_.layers=this.layers,this.add(_);const O=new Ro(xc,_c,e,t);O.layers=this.layers,this.add(O);const z=new Ro(xc,_c,e,t);z.layers=this.layers,this.add(z)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,a,l,x,_,O]=t;for(const z of t)this.remove(z);if(e===Ns)r.up.set(0,1,0),r.lookAt(1,0,0),a.up.set(0,1,0),a.lookAt(-1,0,0),l.up.set(0,0,-1),l.lookAt(0,1,0),x.up.set(0,0,1),x.lookAt(0,-1,0),_.up.set(0,1,0),_.lookAt(0,0,1),O.up.set(0,1,0),O.lookAt(0,0,-1);else if(e===Rh)r.up.set(0,-1,0),r.lookAt(-1,0,0),a.up.set(0,-1,0),a.lookAt(1,0,0),l.up.set(0,0,1),l.lookAt(0,1,0),x.up.set(0,0,-1),x.lookAt(0,-1,0),_.up.set(0,-1,0),_.lookAt(0,0,1),O.up.set(0,-1,0),O.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const z of t)this.add(z),z.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:a}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[l,x,_,O,z,q]=this.children,oe=e.getRenderTarget(),ue=e.getActiveCubeFace(),_e=e.getActiveMipmapLevel(),be=e.xr.enabled;e.xr.enabled=!1;const Pe=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,a),e.render(t,l),e.setRenderTarget(r,1,a),e.render(t,x),e.setRenderTarget(r,2,a),e.render(t,_),e.setRenderTarget(r,3,a),e.render(t,O),e.setRenderTarget(r,4,a),e.render(t,z),r.texture.generateMipmaps=Pe,e.setRenderTarget(r,5,a),e.render(t,q),e.setRenderTarget(oe,ue,_e),e.xr.enabled=be,r.texture.needsPMREMUpdate=!0}}class v2 extends uo{constructor(e,t,r,a,l,x,_,O,z,q){e=e!==void 0?e:[],t=t!==void 0?t:Uc,super(e,t,r,a,l,x,_,O,z,q),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class pM extends Fl{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},a=[r,r,r,r,r,r];this.texture=new v2(a,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:xo}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},a=new sl(5,5,5),l=new nl({name:"CubemapFromEquirect",uniforms:Gc(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:_o,blending:el});l.uniforms.tEquirect.value=t;const x=new Ci(a,l),_=t.minFilter;return t.minFilter===Nl&&(t.minFilter=xo),new fM(1,10,this).update(e,x),t.minFilter=_,x.geometry.dispose(),x.material.dispose(),this}clear(e,t,r,a){const l=e.getRenderTarget();for(let x=0;x<6;x++)e.setRenderTarget(this,x),e.clear(t,r,a);e.setRenderTarget(l)}}const gp=new st,mM=new st,gM=new ma;class fs{constructor(e=new st(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,a){return this.normal.set(e,t,r),this.constant=a,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const a=gp.subVectors(r,t).cross(mM.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(a,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(gp),a=this.normal.dot(r);if(a===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/a;return l<0||l>1?null:t.copy(e.start).addScaledVector(r,l)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||gM.getNormalMatrix(e),a=this.coplanarPoint(gp).applyMatrix4(e),l=this.normal.applyMatrix3(r).normalize();return this.constant=-a.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Cl=new Vl,Jd=new st;class Yh{constructor(e=new fs,t=new fs,r=new fs,a=new fs,l=new fs,x=new fs){this.planes=[e,t,r,a,l,x]}set(e,t,r,a,l,x){const _=this.planes;return _[0].copy(e),_[1].copy(t),_[2].copy(r),_[3].copy(a),_[4].copy(l),_[5].copy(x),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=Ns){const r=this.planes,a=e.elements,l=a[0],x=a[1],_=a[2],O=a[3],z=a[4],q=a[5],oe=a[6],ue=a[7],_e=a[8],be=a[9],Pe=a[10],Se=a[11],Ee=a[12],Xe=a[13],qe=a[14],$e=a[15];if(r[0].setComponents(O-l,ue-z,Se-_e,$e-Ee).normalize(),r[1].setComponents(O+l,ue+z,Se+_e,$e+Ee).normalize(),r[2].setComponents(O+x,ue+q,Se+be,$e+Xe).normalize(),r[3].setComponents(O-x,ue-q,Se-be,$e-Xe).normalize(),r[4].setComponents(O-_,ue-oe,Se-Pe,$e-qe).normalize(),t===Ns)r[5].setComponents(O+_,ue+oe,Se+Pe,$e+qe).normalize();else if(t===Rh)r[5].setComponents(_,oe,Pe,qe).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Cl.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Cl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Cl)}intersectsSprite(e){return Cl.center.set(0,0,0),Cl.radius=.7071067811865476,Cl.applyMatrix4(e.matrixWorld),this.intersectsSphere(Cl)}intersectsSphere(e){const t=this.planes,r=e.center,a=-e.radius;for(let l=0;l<6;l++)if(t[l].distanceToPoint(r)<a)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const a=t[r];if(Jd.x=a.normal.x>0?e.max.x:e.min.x,Jd.y=a.normal.y>0?e.max.y:e.min.y,Jd.z=a.normal.z>0?e.max.z:e.min.z,a.distanceToPoint(Jd)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function y2(){let n=null,e=!1,t=null,r=null;function a(l,x){t(l,x),r=n.requestAnimationFrame(a)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(a),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(l){t=l},setContext:function(l){n=l}}}function vM(n){const e=new WeakMap;function t(_,O){const z=_.array,q=_.usage,oe=z.byteLength,ue=n.createBuffer();n.bindBuffer(O,ue),n.bufferData(O,z,q),_.onUploadCallback();let _e;if(z instanceof Float32Array)_e=n.FLOAT;else if(z instanceof Uint16Array)_.isFloat16BufferAttribute?_e=n.HALF_FLOAT:_e=n.UNSIGNED_SHORT;else if(z instanceof Int16Array)_e=n.SHORT;else if(z instanceof Uint32Array)_e=n.UNSIGNED_INT;else if(z instanceof Int32Array)_e=n.INT;else if(z instanceof Int8Array)_e=n.BYTE;else if(z instanceof Uint8Array)_e=n.UNSIGNED_BYTE;else if(z instanceof Uint8ClampedArray)_e=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+z);return{buffer:ue,type:_e,bytesPerElement:z.BYTES_PER_ELEMENT,version:_.version,size:oe}}function r(_,O,z){const q=O.array,oe=O.updateRanges;if(n.bindBuffer(z,_),oe.length===0)n.bufferSubData(z,0,q);else{oe.sort((_e,be)=>_e.start-be.start);let ue=0;for(let _e=1;_e<oe.length;_e++){const be=oe[ue],Pe=oe[_e];Pe.start<=be.start+be.count+1?be.count=Math.max(be.count,Pe.start+Pe.count-be.start):(++ue,oe[ue]=Pe)}oe.length=ue+1;for(let _e=0,be=oe.length;_e<be;_e++){const Pe=oe[_e];n.bufferSubData(z,Pe.start*q.BYTES_PER_ELEMENT,q,Pe.start,Pe.count)}O.clearUpdateRanges()}O.onUploadCallback()}function a(_){return _.isInterleavedBufferAttribute&&(_=_.data),e.get(_)}function l(_){_.isInterleavedBufferAttribute&&(_=_.data);const O=e.get(_);O&&(n.deleteBuffer(O.buffer),e.delete(_))}function x(_,O){if(_.isInterleavedBufferAttribute&&(_=_.data),_.isGLBufferAttribute){const q=e.get(_);(!q||q.version<_.version)&&e.set(_,{buffer:_.buffer,type:_.type,bytesPerElement:_.elementSize,version:_.version});return}const z=e.get(_);if(z===void 0)e.set(_,t(_,O));else if(z.version<_.version){if(z.size!==_.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(z.buffer,_,O),z.version=_.version}}return{get:a,remove:l,update:x}}class Wc extends di{constructor(e=1,t=1,r=1,a=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:a};const l=e/2,x=t/2,_=Math.floor(r),O=Math.floor(a),z=_+1,q=O+1,oe=e/_,ue=t/O,_e=[],be=[],Pe=[],Se=[];for(let Ee=0;Ee<q;Ee++){const Xe=Ee*ue-x;for(let qe=0;qe<z;qe++){const $e=qe*oe-l;be.push($e,-Xe,0),Pe.push(0,0,1),Se.push(qe/_),Se.push(1-Ee/O)}}for(let Ee=0;Ee<O;Ee++)for(let Xe=0;Xe<_;Xe++){const qe=Xe+z*Ee,$e=Xe+z*(Ee+1),ft=Xe+1+z*(Ee+1),gt=Xe+1+z*Ee;_e.push(qe,$e,gt),_e.push($e,ft,gt)}this.setIndex(_e),this.setAttribute("position",new qa(be,3)),this.setAttribute("normal",new qa(Pe,3)),this.setAttribute("uv",new qa(Se,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Wc(e.width,e.height,e.widthSegments,e.heightSegments)}}var yM=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,xM=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,_M=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,bM=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,wM=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,MM=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,TM=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,AM=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,SM=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,CM=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,EM=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,LM=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,RM=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,kM=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,PM=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,OM=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,NM=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,DM=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,IM=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,zM=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,FM=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,UM=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,BM=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,HM=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,VM=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,GM=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,jM=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,WM=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,YM=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,qM=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,JM="gl_FragColor = linearToOutputTexel( gl_FragColor );",XM=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,ZM=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,QM=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,KM=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,$M=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,e4=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,t4=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,r4=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,n4=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,a4=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,i4=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,o4=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,s4=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,l4=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,c4=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,u4=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,d4=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,h4=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,f4=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,p4=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,m4=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,g4=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,v4=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,y4=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,x4=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,_4=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,b4=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,w4=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,M4=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,T4=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,A4=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,S4=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,C4=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,E4=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,L4=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,R4=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,k4=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,P4=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,O4=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,N4=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,D4=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,I4=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,z4=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,F4=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,U4=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,B4=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,H4=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,V4=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,G4=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,j4=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,W4=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Y4=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,q4=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,J4=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,X4=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Z4=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Q4=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,K4=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,$4=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,eT=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,tT=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,rT=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,nT=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,aT=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,iT=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,oT=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,sT=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,lT=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,cT=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,uT=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,dT=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,hT=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,fT=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,pT=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,mT=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,gT=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vT=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,yT=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,xT=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,_T=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,bT=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,wT=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,MT=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,TT=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,AT=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,ST=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,CT=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,ET=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,LT=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,RT=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,kT=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,PT=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,OT=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,NT=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,DT=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,IT=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zT=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,FT=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,UT=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,BT=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,HT=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,VT=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,GT=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,jT=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,WT=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,YT=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,qT=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,JT=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,XT=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ZT=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,va={alphahash_fragment:yM,alphahash_pars_fragment:xM,alphamap_fragment:_M,alphamap_pars_fragment:bM,alphatest_fragment:wM,alphatest_pars_fragment:MM,aomap_fragment:TM,aomap_pars_fragment:AM,batching_pars_vertex:SM,batching_vertex:CM,begin_vertex:EM,beginnormal_vertex:LM,bsdfs:RM,iridescence_fragment:kM,bumpmap_pars_fragment:PM,clipping_planes_fragment:OM,clipping_planes_pars_fragment:NM,clipping_planes_pars_vertex:DM,clipping_planes_vertex:IM,color_fragment:zM,color_pars_fragment:FM,color_pars_vertex:UM,color_vertex:BM,common:HM,cube_uv_reflection_fragment:VM,defaultnormal_vertex:GM,displacementmap_pars_vertex:jM,displacementmap_vertex:WM,emissivemap_fragment:YM,emissivemap_pars_fragment:qM,colorspace_fragment:JM,colorspace_pars_fragment:XM,envmap_fragment:ZM,envmap_common_pars_fragment:QM,envmap_pars_fragment:KM,envmap_pars_vertex:$M,envmap_physical_pars_fragment:u4,envmap_vertex:e4,fog_vertex:t4,fog_pars_vertex:r4,fog_fragment:n4,fog_pars_fragment:a4,gradientmap_pars_fragment:i4,lightmap_pars_fragment:o4,lights_lambert_fragment:s4,lights_lambert_pars_fragment:l4,lights_pars_begin:c4,lights_toon_fragment:d4,lights_toon_pars_fragment:h4,lights_phong_fragment:f4,lights_phong_pars_fragment:p4,lights_physical_fragment:m4,lights_physical_pars_fragment:g4,lights_fragment_begin:v4,lights_fragment_maps:y4,lights_fragment_end:x4,logdepthbuf_fragment:_4,logdepthbuf_pars_fragment:b4,logdepthbuf_pars_vertex:w4,logdepthbuf_vertex:M4,map_fragment:T4,map_pars_fragment:A4,map_particle_fragment:S4,map_particle_pars_fragment:C4,metalnessmap_fragment:E4,metalnessmap_pars_fragment:L4,morphinstance_vertex:R4,morphcolor_vertex:k4,morphnormal_vertex:P4,morphtarget_pars_vertex:O4,morphtarget_vertex:N4,normal_fragment_begin:D4,normal_fragment_maps:I4,normal_pars_fragment:z4,normal_pars_vertex:F4,normal_vertex:U4,normalmap_pars_fragment:B4,clearcoat_normal_fragment_begin:H4,clearcoat_normal_fragment_maps:V4,clearcoat_pars_fragment:G4,iridescence_pars_fragment:j4,opaque_fragment:W4,packing:Y4,premultiplied_alpha_fragment:q4,project_vertex:J4,dithering_fragment:X4,dithering_pars_fragment:Z4,roughnessmap_fragment:Q4,roughnessmap_pars_fragment:K4,shadowmap_pars_fragment:$4,shadowmap_pars_vertex:eT,shadowmap_vertex:tT,shadowmask_pars_fragment:rT,skinbase_vertex:nT,skinning_pars_vertex:aT,skinning_vertex:iT,skinnormal_vertex:oT,specularmap_fragment:sT,specularmap_pars_fragment:lT,tonemapping_fragment:cT,tonemapping_pars_fragment:uT,transmission_fragment:dT,transmission_pars_fragment:hT,uv_pars_fragment:fT,uv_pars_vertex:pT,uv_vertex:mT,worldpos_vertex:gT,background_vert:vT,background_frag:yT,backgroundCube_vert:xT,backgroundCube_frag:_T,cube_vert:bT,cube_frag:wT,depth_vert:MT,depth_frag:TT,distanceRGBA_vert:AT,distanceRGBA_frag:ST,equirect_vert:CT,equirect_frag:ET,linedashed_vert:LT,linedashed_frag:RT,meshbasic_vert:kT,meshbasic_frag:PT,meshlambert_vert:OT,meshlambert_frag:NT,meshmatcap_vert:DT,meshmatcap_frag:IT,meshnormal_vert:zT,meshnormal_frag:FT,meshphong_vert:UT,meshphong_frag:BT,meshphysical_vert:HT,meshphysical_frag:VT,meshtoon_vert:GT,meshtoon_frag:jT,points_vert:WT,points_frag:YT,shadow_vert:qT,shadow_frag:JT,sprite_vert:XT,sprite_frag:ZT},_n={common:{diffuse:{value:new qn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ma},alphaMap:{value:null},alphaMapTransform:{value:new ma},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ma}},envmap:{envMap:{value:null},envMapRotation:{value:new ma},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ma}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ma}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ma},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ma},normalScale:{value:new Jr(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ma},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ma}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ma}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ma}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new qn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new qn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ma},alphaTest:{value:0},uvTransform:{value:new ma}},sprite:{diffuse:{value:new qn(16777215)},opacity:{value:1},center:{value:new Jr(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ma},alphaMap:{value:null},alphaMapTransform:{value:new ma},alphaTest:{value:0}}},ps={basic:{uniforms:vo([_n.common,_n.specularmap,_n.envmap,_n.aomap,_n.lightmap,_n.fog]),vertexShader:va.meshbasic_vert,fragmentShader:va.meshbasic_frag},lambert:{uniforms:vo([_n.common,_n.specularmap,_n.envmap,_n.aomap,_n.lightmap,_n.emissivemap,_n.bumpmap,_n.normalmap,_n.displacementmap,_n.fog,_n.lights,{emissive:{value:new qn(0)}}]),vertexShader:va.meshlambert_vert,fragmentShader:va.meshlambert_frag},phong:{uniforms:vo([_n.common,_n.specularmap,_n.envmap,_n.aomap,_n.lightmap,_n.emissivemap,_n.bumpmap,_n.normalmap,_n.displacementmap,_n.fog,_n.lights,{emissive:{value:new qn(0)},specular:{value:new qn(1118481)},shininess:{value:30}}]),vertexShader:va.meshphong_vert,fragmentShader:va.meshphong_frag},standard:{uniforms:vo([_n.common,_n.envmap,_n.aomap,_n.lightmap,_n.emissivemap,_n.bumpmap,_n.normalmap,_n.displacementmap,_n.roughnessmap,_n.metalnessmap,_n.fog,_n.lights,{emissive:{value:new qn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:va.meshphysical_vert,fragmentShader:va.meshphysical_frag},toon:{uniforms:vo([_n.common,_n.aomap,_n.lightmap,_n.emissivemap,_n.bumpmap,_n.normalmap,_n.displacementmap,_n.gradientmap,_n.fog,_n.lights,{emissive:{value:new qn(0)}}]),vertexShader:va.meshtoon_vert,fragmentShader:va.meshtoon_frag},matcap:{uniforms:vo([_n.common,_n.bumpmap,_n.normalmap,_n.displacementmap,_n.fog,{matcap:{value:null}}]),vertexShader:va.meshmatcap_vert,fragmentShader:va.meshmatcap_frag},points:{uniforms:vo([_n.points,_n.fog]),vertexShader:va.points_vert,fragmentShader:va.points_frag},dashed:{uniforms:vo([_n.common,_n.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:va.linedashed_vert,fragmentShader:va.linedashed_frag},depth:{uniforms:vo([_n.common,_n.displacementmap]),vertexShader:va.depth_vert,fragmentShader:va.depth_frag},normal:{uniforms:vo([_n.common,_n.bumpmap,_n.normalmap,_n.displacementmap,{opacity:{value:1}}]),vertexShader:va.meshnormal_vert,fragmentShader:va.meshnormal_frag},sprite:{uniforms:vo([_n.sprite,_n.fog]),vertexShader:va.sprite_vert,fragmentShader:va.sprite_frag},background:{uniforms:{uvTransform:{value:new ma},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:va.background_vert,fragmentShader:va.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new ma}},vertexShader:va.backgroundCube_vert,fragmentShader:va.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:va.cube_vert,fragmentShader:va.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:va.equirect_vert,fragmentShader:va.equirect_frag},distanceRGBA:{uniforms:vo([_n.common,_n.displacementmap,{referencePosition:{value:new st},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:va.distanceRGBA_vert,fragmentShader:va.distanceRGBA_frag},shadow:{uniforms:vo([_n.lights,_n.fog,{color:{value:new qn(0)},opacity:{value:1}}]),vertexShader:va.shadow_vert,fragmentShader:va.shadow_frag}};ps.physical={uniforms:vo([ps.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ma},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ma},clearcoatNormalScale:{value:new Jr(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ma},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ma},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ma},sheen:{value:0},sheenColor:{value:new qn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ma},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ma},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ma},transmissionSamplerSize:{value:new Jr},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ma},attenuationDistance:{value:0},attenuationColor:{value:new qn(0)},specularColor:{value:new qn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ma},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ma},anisotropyVector:{value:new Jr},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ma}}]),vertexShader:va.meshphysical_vert,fragmentShader:va.meshphysical_frag};const Xd={r:0,b:0,g:0},El=new Ko,QT=new jn;function KT(n,e,t,r,a,l,x){const _=new qn(0);let O=l===!0?0:1,z,q,oe=null,ue=0,_e=null;function be(Xe){let qe=Xe.isScene===!0?Xe.background:null;return qe&&qe.isTexture&&(qe=(Xe.backgroundBlurriness>0?t:e).get(qe)),qe}function Pe(Xe){let qe=!1;const $e=be(Xe);$e===null?Ee(_,O):$e&&$e.isColor&&(Ee($e,1),qe=!0);const ft=n.xr.getEnvironmentBlendMode();ft==="additive"?r.buffers.color.setClear(0,0,0,1,x):ft==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,x),(n.autoClear||qe)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function Se(Xe,qe){const $e=be(qe);$e&&($e.isCubeTexture||$e.mapping===jh)?(q===void 0&&(q=new Ci(new sl(1,1,1),new nl({name:"BackgroundCubeMaterial",uniforms:Gc(ps.backgroundCube.uniforms),vertexShader:ps.backgroundCube.vertexShader,fragmentShader:ps.backgroundCube.fragmentShader,side:_o,depthTest:!1,depthWrite:!1,fog:!1})),q.geometry.deleteAttribute("normal"),q.geometry.deleteAttribute("uv"),q.onBeforeRender=function(ft,gt,pt){this.matrixWorld.copyPosition(pt.matrixWorld)},Object.defineProperty(q.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(q)),El.copy(qe.backgroundRotation),El.x*=-1,El.y*=-1,El.z*=-1,$e.isCubeTexture&&$e.isRenderTargetTexture===!1&&(El.y*=-1,El.z*=-1),q.material.uniforms.envMap.value=$e,q.material.uniforms.flipEnvMap.value=$e.isCubeTexture&&$e.isRenderTargetTexture===!1?-1:1,q.material.uniforms.backgroundBlurriness.value=qe.backgroundBlurriness,q.material.uniforms.backgroundIntensity.value=qe.backgroundIntensity,q.material.uniforms.backgroundRotation.value.setFromMatrix4(QT.makeRotationFromEuler(El)),q.material.toneMapped=Ya.getTransfer($e.colorSpace)!==gi,(oe!==$e||ue!==$e.version||_e!==n.toneMapping)&&(q.material.needsUpdate=!0,oe=$e,ue=$e.version,_e=n.toneMapping),q.layers.enableAll(),Xe.unshift(q,q.geometry,q.material,0,0,null)):$e&&$e.isTexture&&(z===void 0&&(z=new Ci(new Wc(2,2),new nl({name:"BackgroundMaterial",uniforms:Gc(ps.background.uniforms),vertexShader:ps.background.vertexShader,fragmentShader:ps.background.fragmentShader,side:rl,depthTest:!1,depthWrite:!1,fog:!1})),z.geometry.deleteAttribute("normal"),Object.defineProperty(z.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(z)),z.material.uniforms.t2D.value=$e,z.material.uniforms.backgroundIntensity.value=qe.backgroundIntensity,z.material.toneMapped=Ya.getTransfer($e.colorSpace)!==gi,$e.matrixAutoUpdate===!0&&$e.updateMatrix(),z.material.uniforms.uvTransform.value.copy($e.matrix),(oe!==$e||ue!==$e.version||_e!==n.toneMapping)&&(z.material.needsUpdate=!0,oe=$e,ue=$e.version,_e=n.toneMapping),z.layers.enableAll(),Xe.unshift(z,z.geometry,z.material,0,0,null))}function Ee(Xe,qe){Xe.getRGB(Xd,g2(n)),r.buffers.color.setClear(Xd.r,Xd.g,Xd.b,qe,x)}return{getClearColor:function(){return _},setClearColor:function(Xe,qe=1){_.set(Xe),O=qe,Ee(_,O)},getClearAlpha:function(){return O},setClearAlpha:function(Xe){O=Xe,Ee(_,O)},render:Pe,addToRenderList:Se}}function $T(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),r={},a=ue(null);let l=a,x=!1;function _(Ve,nt,nr,Zt,Xt){let Pr=!1;const cr=oe(Zt,nr,nt);l!==cr&&(l=cr,z(l.object)),Pr=_e(Ve,Zt,nr,Xt),Pr&&be(Ve,Zt,nr,Xt),Xt!==null&&e.update(Xt,n.ELEMENT_ARRAY_BUFFER),(Pr||x)&&(x=!1,$e(Ve,nt,nr,Zt),Xt!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(Xt).buffer))}function O(){return n.createVertexArray()}function z(Ve){return n.bindVertexArray(Ve)}function q(Ve){return n.deleteVertexArray(Ve)}function oe(Ve,nt,nr){const Zt=nr.wireframe===!0;let Xt=r[Ve.id];Xt===void 0&&(Xt={},r[Ve.id]=Xt);let Pr=Xt[nt.id];Pr===void 0&&(Pr={},Xt[nt.id]=Pr);let cr=Pr[Zt];return cr===void 0&&(cr=ue(O()),Pr[Zt]=cr),cr}function ue(Ve){const nt=[],nr=[],Zt=[];for(let Xt=0;Xt<t;Xt++)nt[Xt]=0,nr[Xt]=0,Zt[Xt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:nt,enabledAttributes:nr,attributeDivisors:Zt,object:Ve,attributes:{},index:null}}function _e(Ve,nt,nr,Zt){const Xt=l.attributes,Pr=nt.attributes;let cr=0;const Qr=nr.getAttributes();for(const Tr in Qr)if(Qr[Tr].location>=0){const ln=Xt[Tr];let Sn=Pr[Tr];if(Sn===void 0&&(Tr==="instanceMatrix"&&Ve.instanceMatrix&&(Sn=Ve.instanceMatrix),Tr==="instanceColor"&&Ve.instanceColor&&(Sn=Ve.instanceColor)),ln===void 0||ln.attribute!==Sn||Sn&&ln.data!==Sn.data)return!0;cr++}return l.attributesNum!==cr||l.index!==Zt}function be(Ve,nt,nr,Zt){const Xt={},Pr=nt.attributes;let cr=0;const Qr=nr.getAttributes();for(const Tr in Qr)if(Qr[Tr].location>=0){let ln=Pr[Tr];ln===void 0&&(Tr==="instanceMatrix"&&Ve.instanceMatrix&&(ln=Ve.instanceMatrix),Tr==="instanceColor"&&Ve.instanceColor&&(ln=Ve.instanceColor));const Sn={};Sn.attribute=ln,ln&&ln.data&&(Sn.data=ln.data),Xt[Tr]=Sn,cr++}l.attributes=Xt,l.attributesNum=cr,l.index=Zt}function Pe(){const Ve=l.newAttributes;for(let nt=0,nr=Ve.length;nt<nr;nt++)Ve[nt]=0}function Se(Ve){Ee(Ve,0)}function Ee(Ve,nt){const nr=l.newAttributes,Zt=l.enabledAttributes,Xt=l.attributeDivisors;nr[Ve]=1,Zt[Ve]===0&&(n.enableVertexAttribArray(Ve),Zt[Ve]=1),Xt[Ve]!==nt&&(n.vertexAttribDivisor(Ve,nt),Xt[Ve]=nt)}function Xe(){const Ve=l.newAttributes,nt=l.enabledAttributes;for(let nr=0,Zt=nt.length;nr<Zt;nr++)nt[nr]!==Ve[nr]&&(n.disableVertexAttribArray(nr),nt[nr]=0)}function qe(Ve,nt,nr,Zt,Xt,Pr,cr){cr===!0?n.vertexAttribIPointer(Ve,nt,nr,Xt,Pr):n.vertexAttribPointer(Ve,nt,nr,Zt,Xt,Pr)}function $e(Ve,nt,nr,Zt){Pe();const Xt=Zt.attributes,Pr=nr.getAttributes(),cr=nt.defaultAttributeValues;for(const Qr in Pr){const Tr=Pr[Qr];if(Tr.location>=0){let ln=Xt[Qr];if(ln===void 0&&(Qr==="instanceMatrix"&&Ve.instanceMatrix&&(ln=Ve.instanceMatrix),Qr==="instanceColor"&&Ve.instanceColor&&(ln=Ve.instanceColor)),ln!==void 0){const Sn=ln.normalized,Wn=ln.itemSize,Ma=e.get(ln);if(Ma===void 0)continue;const zn=Ma.buffer,Or=Ma.type,$r=Ma.bytesPerElement,En=Or===n.INT||Or===n.UNSIGNED_INT||ln.gpuType===om;if(ln.isInterleavedBufferAttribute){const Ln=ln.data,ta=Ln.stride,Jn=ln.offset;if(Ln.isInstancedInterleavedBuffer){for(let da=0;da<Tr.locationSize;da++)Ee(Tr.location+da,Ln.meshPerAttribute);Ve.isInstancedMesh!==!0&&Zt._maxInstanceCount===void 0&&(Zt._maxInstanceCount=Ln.meshPerAttribute*Ln.count)}else for(let da=0;da<Tr.locationSize;da++)Se(Tr.location+da);n.bindBuffer(n.ARRAY_BUFFER,zn);for(let da=0;da<Tr.locationSize;da++)qe(Tr.location+da,Wn/Tr.locationSize,Or,Sn,ta*$r,(Jn+Wn/Tr.locationSize*da)*$r,En)}else{if(ln.isInstancedBufferAttribute){for(let Ln=0;Ln<Tr.locationSize;Ln++)Ee(Tr.location+Ln,ln.meshPerAttribute);Ve.isInstancedMesh!==!0&&Zt._maxInstanceCount===void 0&&(Zt._maxInstanceCount=ln.meshPerAttribute*ln.count)}else for(let Ln=0;Ln<Tr.locationSize;Ln++)Se(Tr.location+Ln);n.bindBuffer(n.ARRAY_BUFFER,zn);for(let Ln=0;Ln<Tr.locationSize;Ln++)qe(Tr.location+Ln,Wn/Tr.locationSize,Or,Sn,Wn*$r,Wn/Tr.locationSize*Ln*$r,En)}}else if(cr!==void 0){const Sn=cr[Qr];if(Sn!==void 0)switch(Sn.length){case 2:n.vertexAttrib2fv(Tr.location,Sn);break;case 3:n.vertexAttrib3fv(Tr.location,Sn);break;case 4:n.vertexAttrib4fv(Tr.location,Sn);break;default:n.vertexAttrib1fv(Tr.location,Sn)}}}}Xe()}function ft(){Ht();for(const Ve in r){const nt=r[Ve];for(const nr in nt){const Zt=nt[nr];for(const Xt in Zt)q(Zt[Xt].object),delete Zt[Xt];delete nt[nr]}delete r[Ve]}}function gt(Ve){if(r[Ve.id]===void 0)return;const nt=r[Ve.id];for(const nr in nt){const Zt=nt[nr];for(const Xt in Zt)q(Zt[Xt].object),delete Zt[Xt];delete nt[nr]}delete r[Ve.id]}function pt(Ve){for(const nt in r){const nr=r[nt];if(nr[Ve.id]===void 0)continue;const Zt=nr[Ve.id];for(const Xt in Zt)q(Zt[Xt].object),delete Zt[Xt];delete nr[Ve.id]}}function Ht(){ur(),x=!0,l!==a&&(l=a,z(l.object))}function ur(){a.geometry=null,a.program=null,a.wireframe=!1}return{setup:_,reset:Ht,resetDefaultState:ur,dispose:ft,releaseStatesOfGeometry:gt,releaseStatesOfProgram:pt,initAttributes:Pe,enableAttribute:Se,disableUnusedAttributes:Xe}}function e6(n,e,t){let r;function a(z){r=z}function l(z,q){n.drawArrays(r,z,q),t.update(q,r,1)}function x(z,q,oe){oe!==0&&(n.drawArraysInstanced(r,z,q,oe),t.update(q,r,oe))}function _(z,q,oe){if(oe===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,z,0,q,0,oe);let ue=0;for(let _e=0;_e<oe;_e++)ue+=q[_e];t.update(ue,r,1)}function O(z,q,oe,ue){if(oe===0)return;const _e=e.get("WEBGL_multi_draw");if(_e===null)for(let be=0;be<z.length;be++)x(z[be],q[be],ue[be]);else{_e.multiDrawArraysInstancedWEBGL(r,z,0,q,0,ue,0,oe);let be=0;for(let Pe=0;Pe<oe;Pe++)be+=q[Pe];for(let Pe=0;Pe<ue.length;Pe++)t.update(be,r,ue[Pe])}}this.setMode=a,this.render=l,this.renderInstances=x,this.renderMultiDraw=_,this.renderMultiDrawInstances=O}function t6(n,e,t,r){let a;function l(){if(a!==void 0)return a;if(e.has("EXT_texture_filter_anisotropic")===!0){const pt=e.get("EXT_texture_filter_anisotropic");a=n.getParameter(pt.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else a=0;return a}function x(pt){return!(pt!==Uo&&r.convert(pt)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function _(pt){const Ht=pt===Zu&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(pt!==Is&&r.convert(pt)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&pt!==ms&&!Ht)}function O(pt){if(pt==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";pt="mediump"}return pt==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let z=t.precision!==void 0?t.precision:"highp";const q=O(z);q!==z&&(console.warn("THREE.WebGLRenderer:",z,"not supported, using",q,"instead."),z=q);const oe=t.logarithmicDepthBuffer===!0,ue=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control");if(ue===!0){const pt=e.get("EXT_clip_control");pt.clipControlEXT(pt.LOWER_LEFT_EXT,pt.ZERO_TO_ONE_EXT)}const _e=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),be=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Pe=n.getParameter(n.MAX_TEXTURE_SIZE),Se=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),Ee=n.getParameter(n.MAX_VERTEX_ATTRIBS),Xe=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),qe=n.getParameter(n.MAX_VARYING_VECTORS),$e=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),ft=be>0,gt=n.getParameter(n.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:l,getMaxPrecision:O,textureFormatReadable:x,textureTypeReadable:_,precision:z,logarithmicDepthBuffer:oe,reverseDepthBuffer:ue,maxTextures:_e,maxVertexTextures:be,maxTextureSize:Pe,maxCubemapSize:Se,maxAttributes:Ee,maxVertexUniforms:Xe,maxVaryings:qe,maxFragmentUniforms:$e,vertexTextures:ft,maxSamples:gt}}function r6(n){const e=this;let t=null,r=0,a=!1,l=!1;const x=new fs,_=new ma,O={value:null,needsUpdate:!1};this.uniform=O,this.numPlanes=0,this.numIntersection=0,this.init=function(oe,ue){const _e=oe.length!==0||ue||r!==0||a;return a=ue,r=oe.length,_e},this.beginShadows=function(){l=!0,q(null)},this.endShadows=function(){l=!1},this.setGlobalState=function(oe,ue){t=q(oe,ue,0)},this.setState=function(oe,ue,_e){const be=oe.clippingPlanes,Pe=oe.clipIntersection,Se=oe.clipShadows,Ee=n.get(oe);if(!a||be===null||be.length===0||l&&!Se)l?q(null):z();else{const Xe=l?0:r,qe=Xe*4;let $e=Ee.clippingState||null;O.value=$e,$e=q(be,ue,qe,_e);for(let ft=0;ft!==qe;++ft)$e[ft]=t[ft];Ee.clippingState=$e,this.numIntersection=Pe?this.numPlanes:0,this.numPlanes+=Xe}};function z(){O.value!==t&&(O.value=t,O.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function q(oe,ue,_e,be){const Pe=oe!==null?oe.length:0;let Se=null;if(Pe!==0){if(Se=O.value,be!==!0||Se===null){const Ee=_e+Pe*4,Xe=ue.matrixWorldInverse;_.getNormalMatrix(Xe),(Se===null||Se.length<Ee)&&(Se=new Float32Array(Ee));for(let qe=0,$e=_e;qe!==Pe;++qe,$e+=4)x.copy(oe[qe]).applyMatrix4(Xe,_),x.normal.toArray(Se,$e),Se[$e+3]=x.constant}O.value=Se,O.needsUpdate=!0}return e.numPlanes=Pe,e.numIntersection=0,Se}}function n6(n){let e=new WeakMap;function t(x,_){return _===Zp?x.mapping=Uc:_===Qp&&(x.mapping=Bc),x}function r(x){if(x&&x.isTexture){const _=x.mapping;if(_===Zp||_===Qp)if(e.has(x)){const O=e.get(x).texture;return t(O,x.mapping)}else{const O=x.image;if(O&&O.height>0){const z=new pM(O.height);return z.fromEquirectangularTexture(n,x),e.set(x,z),x.addEventListener("dispose",a),t(z.texture,x.mapping)}else return null}}return x}function a(x){const _=x.target;_.removeEventListener("dispose",a);const O=e.get(_);O!==void 0&&(e.delete(_),O.dispose())}function l(){e=new WeakMap}return{get:r,dispose:l}}let Wu=class extends vm{constructor(n=-1,e=1,t=1,r=-1,a=.1,l=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=n,this.right=e,this.top=t,this.bottom=r,this.near=a,this.far=l,this.updateProjectionMatrix()}copy(n,e){return super.copy(n,e),this.left=n.left,this.right=n.right,this.top=n.top,this.bottom=n.bottom,this.near=n.near,this.far=n.far,this.zoom=n.zoom,this.view=n.view===null?null:Object.assign({},n.view),this}setViewOffset(n,e,t,r,a,l){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=n,this.view.fullHeight=e,this.view.offsetX=t,this.view.offsetY=r,this.view.width=a,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const n=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),t=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let a=t-n,l=t+n,x=r+e,_=r-e;if(this.view!==null&&this.view.enabled){const O=(this.right-this.left)/this.view.fullWidth/this.zoom,z=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=O*this.view.offsetX,l=a+O*this.view.width,x-=z*this.view.offsetY,_=x-z*this.view.height}this.projectionMatrix.makeOrthographic(a,l,x,_,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(n){const e=super.toJSON(n);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}};const Pc=4,Xg=[.125,.215,.35,.446,.526,.582],Pl=20,vp=new Wu,Zg=new qn;let yp=null,xp=0,_p=0,bp=!1;const Rl=(1+Math.sqrt(5))/2,bc=1/Rl,Qg=[new st(-Rl,bc,0),new st(Rl,bc,0),new st(-bc,0,Rl),new st(bc,0,Rl),new st(0,Rl,-bc),new st(0,Rl,bc),new st(-1,1,-1),new st(1,1,-1),new st(-1,1,1),new st(1,1,1)];class Kg{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,a=100){yp=this._renderer.getRenderTarget(),xp=this._renderer.getActiveCubeFace(),_p=this._renderer.getActiveMipmapLevel(),bp=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,r,a,l),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=tv(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=ev(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(yp,xp,_p),this._renderer.xr.enabled=bp,e.scissorTest=!1,Zd(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Uc||e.mapping===Bc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),yp=this._renderer.getRenderTarget(),xp=this._renderer.getActiveCubeFace(),_p=this._renderer.getActiveMipmapLevel(),bp=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:xo,minFilter:xo,generateMipmaps:!1,type:Zu,format:Uo,colorSpace:ol,depthBuffer:!1},a=$g(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=$g(e,t,r);const{_lodMax:l}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=a6(l)),this._blurMaterial=i6(l,e,t)}return a}_compileMaterial(e){const t=new Ci(this._lodPlanes[0],e);this._renderer.compile(t,vp)}_sceneToCubeUV(e,t,r,a){const l=new Ro(90,1,t,r),x=[1,-1,1,1,1,1],_=[1,1,1,-1,-1,-1],O=this._renderer,z=O.autoClear,q=O.toneMapping;O.getClearColor(Zg),O.toneMapping=tl,O.autoClear=!1;const oe=new Gl({name:"PMREM.Background",side:_o,depthWrite:!1,depthTest:!1}),ue=new Ci(new sl,oe);let _e=!1;const be=e.background;be?be.isColor&&(oe.color.copy(be),e.background=null,_e=!0):(oe.color.copy(Zg),_e=!0);for(let Pe=0;Pe<6;Pe++){const Se=Pe%3;Se===0?(l.up.set(0,x[Pe],0),l.lookAt(_[Pe],0,0)):Se===1?(l.up.set(0,0,x[Pe]),l.lookAt(0,_[Pe],0)):(l.up.set(0,x[Pe],0),l.lookAt(0,0,_[Pe]));const Ee=this._cubeSize;Zd(a,Se*Ee,Pe>2?Ee:0,Ee,Ee),O.setRenderTarget(a),_e&&O.render(ue,l),O.render(e,l)}ue.geometry.dispose(),ue.material.dispose(),O.toneMapping=q,O.autoClear=z,e.background=be}_textureToCubeUV(e,t){const r=this._renderer,a=e.mapping===Uc||e.mapping===Bc;a?(this._cubemapMaterial===null&&(this._cubemapMaterial=tv()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=ev());const l=a?this._cubemapMaterial:this._equirectMaterial,x=new Ci(this._lodPlanes[0],l),_=l.uniforms;_.envMap.value=e;const O=this._cubeSize;Zd(t,0,0,3*O,2*O),r.setRenderTarget(t),r.render(x,vp)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;const a=this._lodPlanes.length;for(let l=1;l<a;l++){const x=Math.sqrt(this._sigmas[l]*this._sigmas[l]-this._sigmas[l-1]*this._sigmas[l-1]),_=Qg[(a-l-1)%Qg.length];this._blur(e,l-1,l,x,_)}t.autoClear=r}_blur(e,t,r,a,l){const x=this._pingPongRenderTarget;this._halfBlur(e,x,t,r,a,"latitudinal",l),this._halfBlur(x,e,r,r,a,"longitudinal",l)}_halfBlur(e,t,r,a,l,x,_){const O=this._renderer,z=this._blurMaterial;x!=="latitudinal"&&x!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const q=3,oe=new Ci(this._lodPlanes[a],z),ue=z.uniforms,_e=this._sizeLods[r]-1,be=isFinite(l)?Math.PI/(2*_e):2*Math.PI/(2*Pl-1),Pe=l/be,Se=isFinite(l)?1+Math.floor(q*Pe):Pl;Se>Pl&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${Se} samples when the maximum is set to ${Pl}`);const Ee=[];let Xe=0;for(let pt=0;pt<Pl;++pt){const Ht=pt/Pe,ur=Math.exp(-Ht*Ht/2);Ee.push(ur),pt===0?Xe+=ur:pt<Se&&(Xe+=2*ur)}for(let pt=0;pt<Ee.length;pt++)Ee[pt]=Ee[pt]/Xe;ue.envMap.value=e.texture,ue.samples.value=Se,ue.weights.value=Ee,ue.latitudinal.value=x==="latitudinal",_&&(ue.poleAxis.value=_);const{_lodMax:qe}=this;ue.dTheta.value=be,ue.mipInt.value=qe-r;const $e=this._sizeLods[a],ft=3*$e*(a>qe-Pc?a-qe+Pc:0),gt=4*(this._cubeSize-$e);Zd(t,ft,gt,3*$e,2*$e),O.setRenderTarget(t),O.render(oe,vp)}}function a6(n){const e=[],t=[],r=[];let a=n;const l=n-Pc+1+Xg.length;for(let x=0;x<l;x++){const _=Math.pow(2,a);t.push(_);let O=1/_;x>n-Pc?O=Xg[x-n+Pc-1]:x===0&&(O=0),r.push(O);const z=1/(_-2),q=-z,oe=1+z,ue=[q,q,oe,q,oe,oe,q,q,oe,oe,q,oe],_e=6,be=6,Pe=3,Se=2,Ee=1,Xe=new Float32Array(Pe*be*_e),qe=new Float32Array(Se*be*_e),$e=new Float32Array(Ee*be*_e);for(let gt=0;gt<_e;gt++){const pt=gt%3*2/3-1,Ht=gt>2?0:-1,ur=[pt,Ht,0,pt+2/3,Ht,0,pt+2/3,Ht+1,0,pt,Ht,0,pt+2/3,Ht+1,0,pt,Ht+1,0];Xe.set(ur,Pe*be*gt),qe.set(ue,Se*be*gt);const Ve=[gt,gt,gt,gt,gt,gt];$e.set(Ve,Ee*be*gt)}const ft=new di;ft.setAttribute("position",new Xi(Xe,Pe)),ft.setAttribute("uv",new Xi(qe,Se)),ft.setAttribute("faceIndex",new Xi($e,Ee)),e.push(ft),a>Pc&&a--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function $g(n,e,t){const r=new Fl(n,e,t);return r.texture.mapping=jh,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Zd(n,e,t,r,a){n.viewport.set(e,t,r,a),n.scissor.set(e,t,r,a)}function i6(n,e,t){const r=new Float32Array(Pl),a=new st(0,1,0);return new nl({name:"SphericalGaussianBlur",defines:{n:Pl,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:a}},vertexShader:ym(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:el,depthTest:!1,depthWrite:!1})}function ev(){return new nl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:ym(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:el,depthTest:!1,depthWrite:!1})}function tv(){return new nl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:ym(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:el,depthTest:!1,depthWrite:!1})}function ym(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function o6(n){let e=new WeakMap,t=null;function r(_){if(_&&_.isTexture){const O=_.mapping,z=O===Zp||O===Qp,q=O===Uc||O===Bc;if(z||q){let oe=e.get(_);const ue=oe!==void 0?oe.texture.pmremVersion:0;if(_.isRenderTargetTexture&&_.pmremVersion!==ue)return t===null&&(t=new Kg(n)),oe=z?t.fromEquirectangular(_,oe):t.fromCubemap(_,oe),oe.texture.pmremVersion=_.pmremVersion,e.set(_,oe),oe.texture;if(oe!==void 0)return oe.texture;{const _e=_.image;return z&&_e&&_e.height>0||q&&_e&&a(_e)?(t===null&&(t=new Kg(n)),oe=z?t.fromEquirectangular(_):t.fromCubemap(_),oe.texture.pmremVersion=_.pmremVersion,e.set(_,oe),_.addEventListener("dispose",l),oe.texture):null}}}return _}function a(_){let O=0;const z=6;for(let q=0;q<z;q++)_[q]!==void 0&&O++;return O===z}function l(_){const O=_.target;O.removeEventListener("dispose",l);const z=e.get(O);z!==void 0&&(e.delete(O),z.dispose())}function x(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:x}}function s6(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let a;switch(r){case"WEBGL_depth_texture":a=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":a=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":a=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":a=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:a=n.getExtension(r)}return e[r]=a,a}return{has:function(r){return t(r)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(r){const a=t(r);return a===null&&wh("THREE.WebGLRenderer: "+r+" extension not supported."),a}}}function l6(n,e,t,r){const a={},l=new WeakMap;function x(oe){const ue=oe.target;ue.index!==null&&e.remove(ue.index);for(const be in ue.attributes)e.remove(ue.attributes[be]);for(const be in ue.morphAttributes){const Pe=ue.morphAttributes[be];for(let Se=0,Ee=Pe.length;Se<Ee;Se++)e.remove(Pe[Se])}ue.removeEventListener("dispose",x),delete a[ue.id];const _e=l.get(ue);_e&&(e.remove(_e),l.delete(ue)),r.releaseStatesOfGeometry(ue),ue.isInstancedBufferGeometry===!0&&delete ue._maxInstanceCount,t.memory.geometries--}function _(oe,ue){return a[ue.id]===!0||(ue.addEventListener("dispose",x),a[ue.id]=!0,t.memory.geometries++),ue}function O(oe){const ue=oe.attributes;for(const be in ue)e.update(ue[be],n.ARRAY_BUFFER);const _e=oe.morphAttributes;for(const be in _e){const Pe=_e[be];for(let Se=0,Ee=Pe.length;Se<Ee;Se++)e.update(Pe[Se],n.ARRAY_BUFFER)}}function z(oe){const ue=[],_e=oe.index,be=oe.attributes.position;let Pe=0;if(_e!==null){const Xe=_e.array;Pe=_e.version;for(let qe=0,$e=Xe.length;qe<$e;qe+=3){const ft=Xe[qe+0],gt=Xe[qe+1],pt=Xe[qe+2];ue.push(ft,gt,gt,pt,pt,ft)}}else if(be!==void 0){const Xe=be.array;Pe=be.version;for(let qe=0,$e=Xe.length/3-1;qe<$e;qe+=3){const ft=qe+0,gt=qe+1,pt=qe+2;ue.push(ft,gt,gt,pt,pt,ft)}}else return;const Se=new(u2(ue)?m2:p2)(ue,1);Se.version=Pe;const Ee=l.get(oe);Ee&&e.remove(Ee),l.set(oe,Se)}function q(oe){const ue=l.get(oe);if(ue){const _e=oe.index;_e!==null&&ue.version<_e.version&&z(oe)}else z(oe);return l.get(oe)}return{get:_,update:O,getWireframeAttribute:q}}function c6(n,e,t){let r;function a(ue){r=ue}let l,x;function _(ue){l=ue.type,x=ue.bytesPerElement}function O(ue,_e){n.drawElements(r,_e,l,ue*x),t.update(_e,r,1)}function z(ue,_e,be){be!==0&&(n.drawElementsInstanced(r,_e,l,ue*x,be),t.update(_e,r,be))}function q(ue,_e,be){if(be===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,_e,0,l,ue,0,be);let Pe=0;for(let Se=0;Se<be;Se++)Pe+=_e[Se];t.update(Pe,r,1)}function oe(ue,_e,be,Pe){if(be===0)return;const Se=e.get("WEBGL_multi_draw");if(Se===null)for(let Ee=0;Ee<ue.length;Ee++)z(ue[Ee]/x,_e[Ee],Pe[Ee]);else{Se.multiDrawElementsInstancedWEBGL(r,_e,0,l,ue,0,Pe,0,be);let Ee=0;for(let Xe=0;Xe<be;Xe++)Ee+=_e[Xe];for(let Xe=0;Xe<Pe.length;Xe++)t.update(Ee,r,Pe[Xe])}}this.setMode=a,this.setIndex=_,this.render=O,this.renderInstances=z,this.renderMultiDraw=q,this.renderMultiDrawInstances=oe}function u6(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(l,x,_){switch(t.calls++,x){case n.TRIANGLES:t.triangles+=_*(l/3);break;case n.LINES:t.lines+=_*(l/2);break;case n.LINE_STRIP:t.lines+=_*(l-1);break;case n.LINE_LOOP:t.lines+=_*l;break;case n.POINTS:t.points+=_*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",x);break}}function a(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:a,update:r}}function d6(n,e,t){const r=new WeakMap,a=new Si;function l(x,_,O){const z=x.morphTargetInfluences,q=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,oe=q!==void 0?q.length:0;let ue=r.get(_);if(ue===void 0||ue.count!==oe){let _e=function(){Ht.dispose(),r.delete(_),_.removeEventListener("dispose",_e)};ue!==void 0&&ue.texture.dispose();const be=_.morphAttributes.position!==void 0,Pe=_.morphAttributes.normal!==void 0,Se=_.morphAttributes.color!==void 0,Ee=_.morphAttributes.position||[],Xe=_.morphAttributes.normal||[],qe=_.morphAttributes.color||[];let $e=0;be===!0&&($e=1),Pe===!0&&($e=2),Se===!0&&($e=3);let ft=_.attributes.position.count*$e,gt=1;ft>e.maxTextureSize&&(gt=Math.ceil(ft/e.maxTextureSize),ft=e.maxTextureSize);const pt=new Float32Array(ft*gt*4*oe),Ht=new h2(pt,ft,gt,oe);Ht.type=ms,Ht.needsUpdate=!0;const ur=$e*4;for(let Ve=0;Ve<oe;Ve++){const nt=Ee[Ve],nr=Xe[Ve],Zt=qe[Ve],Xt=ft*gt*4*Ve;for(let Pr=0;Pr<nt.count;Pr++){const cr=Pr*ur;be===!0&&(a.fromBufferAttribute(nt,Pr),pt[Xt+cr+0]=a.x,pt[Xt+cr+1]=a.y,pt[Xt+cr+2]=a.z,pt[Xt+cr+3]=0),Pe===!0&&(a.fromBufferAttribute(nr,Pr),pt[Xt+cr+4]=a.x,pt[Xt+cr+5]=a.y,pt[Xt+cr+6]=a.z,pt[Xt+cr+7]=0),Se===!0&&(a.fromBufferAttribute(Zt,Pr),pt[Xt+cr+8]=a.x,pt[Xt+cr+9]=a.y,pt[Xt+cr+10]=a.z,pt[Xt+cr+11]=Zt.itemSize===4?a.w:1)}}ue={count:oe,texture:Ht,size:new Jr(ft,gt)},r.set(_,ue),_.addEventListener("dispose",_e)}if(x.isInstancedMesh===!0&&x.morphTexture!==null)O.getUniforms().setValue(n,"morphTexture",x.morphTexture,t);else{let _e=0;for(let Pe=0;Pe<z.length;Pe++)_e+=z[Pe];const be=_.morphTargetsRelative?1:1-_e;O.getUniforms().setValue(n,"morphTargetBaseInfluence",be),O.getUniforms().setValue(n,"morphTargetInfluences",z)}O.getUniforms().setValue(n,"morphTargetsTexture",ue.texture,t),O.getUniforms().setValue(n,"morphTargetsTextureSize",ue.size)}return{update:l}}function h6(n,e,t,r){let a=new WeakMap;function l(O){const z=r.render.frame,q=O.geometry,oe=e.get(O,q);if(a.get(oe)!==z&&(e.update(oe),a.set(oe,z)),O.isInstancedMesh&&(O.hasEventListener("dispose",_)===!1&&O.addEventListener("dispose",_),a.get(O)!==z&&(t.update(O.instanceMatrix,n.ARRAY_BUFFER),O.instanceColor!==null&&t.update(O.instanceColor,n.ARRAY_BUFFER),a.set(O,z))),O.isSkinnedMesh){const ue=O.skeleton;a.get(ue)!==z&&(ue.update(),a.set(ue,z))}return oe}function x(){a=new WeakMap}function _(O){const z=O.target;z.removeEventListener("dispose",_),t.remove(z.instanceMatrix),z.instanceColor!==null&&t.remove(z.instanceColor)}return{update:l,dispose:x}}class x2 extends uo{constructor(e,t,r,a,l,x,_,O,z,q=Ic){if(q!==Ic&&q!==Vc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&q===Ic&&(r=Il),r===void 0&&q===Vc&&(r=Hc),super(null,a,l,x,_,O,q,r,z),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=_!==void 0?_:To,this.minFilter=O!==void 0?O:To,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const _2=new uo,rv=new x2(1,1),b2=new h2,w2=new Kw,M2=new v2,nv=[],av=[],iv=new Float32Array(16),ov=new Float32Array(9),sv=new Float32Array(4);function Yc(n,e,t){const r=n[0];if(r<=0||r>0)return n;const a=e*t;let l=nv[a];if(l===void 0&&(l=new Float32Array(a),nv[a]=l),e!==0){r.toArray(l,0);for(let x=1,_=0;x!==e;++x)_+=t,n[x].toArray(l,_)}return l}function Gi(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function ji(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function qh(n,e){let t=av[e];t===void 0&&(t=new Int32Array(e),av[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function f6(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function p6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Gi(t,e))return;n.uniform2fv(this.addr,e),ji(t,e)}}function m6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Gi(t,e))return;n.uniform3fv(this.addr,e),ji(t,e)}}function g6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Gi(t,e))return;n.uniform4fv(this.addr,e),ji(t,e)}}function v6(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Gi(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),ji(t,e)}else{if(Gi(t,r))return;sv.set(r),n.uniformMatrix2fv(this.addr,!1,sv),ji(t,r)}}function y6(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Gi(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),ji(t,e)}else{if(Gi(t,r))return;ov.set(r),n.uniformMatrix3fv(this.addr,!1,ov),ji(t,r)}}function x6(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Gi(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),ji(t,e)}else{if(Gi(t,r))return;iv.set(r),n.uniformMatrix4fv(this.addr,!1,iv),ji(t,r)}}function _6(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function b6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Gi(t,e))return;n.uniform2iv(this.addr,e),ji(t,e)}}function w6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Gi(t,e))return;n.uniform3iv(this.addr,e),ji(t,e)}}function M6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Gi(t,e))return;n.uniform4iv(this.addr,e),ji(t,e)}}function T6(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function A6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Gi(t,e))return;n.uniform2uiv(this.addr,e),ji(t,e)}}function S6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Gi(t,e))return;n.uniform3uiv(this.addr,e),ji(t,e)}}function C6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Gi(t,e))return;n.uniform4uiv(this.addr,e),ji(t,e)}}function E6(n,e,t){const r=this.cache,a=t.allocateTextureUnit();r[0]!==a&&(n.uniform1i(this.addr,a),r[0]=a);let l;this.type===n.SAMPLER_2D_SHADOW?(rv.compareFunction=c2,l=rv):l=_2,t.setTexture2D(e||l,a)}function L6(n,e,t){const r=this.cache,a=t.allocateTextureUnit();r[0]!==a&&(n.uniform1i(this.addr,a),r[0]=a),t.setTexture3D(e||w2,a)}function R6(n,e,t){const r=this.cache,a=t.allocateTextureUnit();r[0]!==a&&(n.uniform1i(this.addr,a),r[0]=a),t.setTextureCube(e||M2,a)}function k6(n,e,t){const r=this.cache,a=t.allocateTextureUnit();r[0]!==a&&(n.uniform1i(this.addr,a),r[0]=a),t.setTexture2DArray(e||b2,a)}function P6(n){switch(n){case 5126:return f6;case 35664:return p6;case 35665:return m6;case 35666:return g6;case 35674:return v6;case 35675:return y6;case 35676:return x6;case 5124:case 35670:return _6;case 35667:case 35671:return b6;case 35668:case 35672:return w6;case 35669:case 35673:return M6;case 5125:return T6;case 36294:return A6;case 36295:return S6;case 36296:return C6;case 35678:case 36198:case 36298:case 36306:case 35682:return E6;case 35679:case 36299:case 36307:return L6;case 35680:case 36300:case 36308:case 36293:return R6;case 36289:case 36303:case 36311:case 36292:return k6}}function O6(n,e){n.uniform1fv(this.addr,e)}function N6(n,e){const t=Yc(e,this.size,2);n.uniform2fv(this.addr,t)}function D6(n,e){const t=Yc(e,this.size,3);n.uniform3fv(this.addr,t)}function I6(n,e){const t=Yc(e,this.size,4);n.uniform4fv(this.addr,t)}function z6(n,e){const t=Yc(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function F6(n,e){const t=Yc(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function U6(n,e){const t=Yc(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function B6(n,e){n.uniform1iv(this.addr,e)}function H6(n,e){n.uniform2iv(this.addr,e)}function V6(n,e){n.uniform3iv(this.addr,e)}function G6(n,e){n.uniform4iv(this.addr,e)}function j6(n,e){n.uniform1uiv(this.addr,e)}function W6(n,e){n.uniform2uiv(this.addr,e)}function Y6(n,e){n.uniform3uiv(this.addr,e)}function q6(n,e){n.uniform4uiv(this.addr,e)}function J6(n,e,t){const r=this.cache,a=e.length,l=qh(t,a);Gi(r,l)||(n.uniform1iv(this.addr,l),ji(r,l));for(let x=0;x!==a;++x)t.setTexture2D(e[x]||_2,l[x])}function X6(n,e,t){const r=this.cache,a=e.length,l=qh(t,a);Gi(r,l)||(n.uniform1iv(this.addr,l),ji(r,l));for(let x=0;x!==a;++x)t.setTexture3D(e[x]||w2,l[x])}function Z6(n,e,t){const r=this.cache,a=e.length,l=qh(t,a);Gi(r,l)||(n.uniform1iv(this.addr,l),ji(r,l));for(let x=0;x!==a;++x)t.setTextureCube(e[x]||M2,l[x])}function Q6(n,e,t){const r=this.cache,a=e.length,l=qh(t,a);Gi(r,l)||(n.uniform1iv(this.addr,l),ji(r,l));for(let x=0;x!==a;++x)t.setTexture2DArray(e[x]||b2,l[x])}function K6(n){switch(n){case 5126:return O6;case 35664:return N6;case 35665:return D6;case 35666:return I6;case 35674:return z6;case 35675:return F6;case 35676:return U6;case 5124:case 35670:return B6;case 35667:case 35671:return H6;case 35668:case 35672:return V6;case 35669:case 35673:return G6;case 5125:return j6;case 36294:return W6;case 36295:return Y6;case 36296:return q6;case 35678:case 36198:case 36298:case 36306:case 35682:return J6;case 35679:case 36299:case 36307:return X6;case 35680:case 36300:case 36308:case 36293:return Z6;case 36289:case 36303:case 36311:case 36292:return Q6}}class $6{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=P6(t.type)}}class eA{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=K6(t.type)}}class tA{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const a=this.seq;for(let l=0,x=a.length;l!==x;++l){const _=a[l];_.setValue(e,t[_.id],r)}}}const wp=/(\w+)(\])?(\[|\.)?/g;function lv(n,e){n.seq.push(e),n.map[e.id]=e}function rA(n,e,t){const r=n.name,a=r.length;for(wp.lastIndex=0;;){const l=wp.exec(r),x=wp.lastIndex;let _=l[1];const O=l[2]==="]",z=l[3];if(O&&(_=_|0),z===void 0||z==="["&&x+2===a){lv(t,z===void 0?new $6(_,n,e):new eA(_,n,e));break}else{let q=t.map[_];q===void 0&&(q=new tA(_),lv(t,q)),t=q}}}class Mh{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<r;++a){const l=e.getActiveUniform(t,a),x=e.getUniformLocation(t,l.name);rA(l,x,this)}}setValue(e,t,r,a){const l=this.map[t];l!==void 0&&l.setValue(e,r,a)}setOptional(e,t,r){const a=t[r];a!==void 0&&this.setValue(e,r,a)}static upload(e,t,r,a){for(let l=0,x=t.length;l!==x;++l){const _=t[l],O=r[_.id];O.needsUpdate!==!1&&_.setValue(e,O.value,a)}}static seqWithValue(e,t){const r=[];for(let a=0,l=e.length;a!==l;++a){const x=e[a];x.id in t&&r.push(x)}return r}}function cv(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const nA=37297;let aA=0;function iA(n,e){const t=n.split(`
`),r=[],a=Math.max(e-6,0),l=Math.min(e+6,t.length);for(let x=a;x<l;x++){const _=x+1;r.push(`${_===e?">":" "} ${_}: ${t[x]}`)}return r.join(`
`)}function oA(n){const e=Ya.getPrimaries(Ya.workingColorSpace),t=Ya.getPrimaries(n);let r;switch(e===t?r="":e===Lh&&t===Eh?r="LinearDisplayP3ToLinearSRGB":e===Eh&&t===Lh&&(r="LinearSRGBToLinearDisplayP3"),n){case ol:case Wh:return[r,"LinearTransferOETF"];case hs:case pm:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[r,"LinearTransferOETF"]}}function uv(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),a=n.getShaderInfoLog(e).trim();if(r&&a==="")return"";const l=/ERROR: 0:(\d+)/.exec(a);if(l){const x=parseInt(l[1]);return t.toUpperCase()+`

`+a+`

`+iA(n.getShaderSource(e),x)}else return a}function sA(n,e){const t=oA(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function lA(n,e){let t;switch(e){case cw:t="Linear";break;case uw:t="Reinhard";break;case dw:t="Cineon";break;case hw:t="ACESFilmic";break;case pw:t="AgX";break;case mw:t="Neutral";break;case fw:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Qd=new st;function cA(){Ya.getLuminanceCoefficients(Qd);const n=Qd.x.toFixed(4),e=Qd.y.toFixed(4),t=Qd.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function uA(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Pu).join(`
`)}function dA(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function hA(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let a=0;a<r;a++){const l=n.getActiveAttrib(e,a),x=l.name;let _=1;l.type===n.FLOAT_MAT2&&(_=2),l.type===n.FLOAT_MAT3&&(_=3),l.type===n.FLOAT_MAT4&&(_=4),t[x]={type:l.type,location:n.getAttribLocation(e,x),locationSize:_}}return t}function Pu(n){return n!==""}function dv(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function hv(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const fA=/^[ \t]*#include +<([\w\d./]+)>/gm;function C0(n){return n.replace(fA,mA)}const pA=new Map;function mA(n,e){let t=va[e];if(t===void 0){const r=pA.get(e);if(r!==void 0)t=va[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return C0(t)}const gA=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function fv(n){return n.replace(gA,vA)}function vA(n,e,t,r){let a="";for(let l=parseInt(e);l<parseInt(t);l++)a+=r.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return a}function pv(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function yA(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===Ky?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===V5?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Ps&&(e="SHADOWMAP_TYPE_VSM"),e}function xA(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Uc:case Bc:e="ENVMAP_TYPE_CUBE";break;case jh:e="ENVMAP_TYPE_CUBE_UV";break}return e}function _A(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Bc:e="ENVMAP_MODE_REFRACTION";break}return e}function bA(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case im:e="ENVMAP_BLENDING_MULTIPLY";break;case sw:e="ENVMAP_BLENDING_MIX";break;case lw:e="ENVMAP_BLENDING_ADD";break}return e}function wA(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:r,maxMip:t}}function MA(n,e,t,r){const a=n.getContext(),l=t.defines;let x=t.vertexShader,_=t.fragmentShader;const O=yA(t),z=xA(t),q=_A(t),oe=bA(t),ue=wA(t),_e=uA(t),be=dA(l),Pe=a.createProgram();let Se,Ee,Xe=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(Se=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,be].filter(Pu).join(`
`),Se.length>0&&(Se+=`
`),Ee=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,be].filter(Pu).join(`
`),Ee.length>0&&(Ee+=`
`)):(Se=[pv(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,be,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+q:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+O:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Pu).join(`
`),Ee=[pv(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,be,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+z:"",t.envMap?"#define "+q:"",t.envMap?"#define "+oe:"",ue?"#define CUBEUV_TEXEL_WIDTH "+ue.texelWidth:"",ue?"#define CUBEUV_TEXEL_HEIGHT "+ue.texelHeight:"",ue?"#define CUBEUV_MAX_MIP "+ue.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+O:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==tl?"#define TONE_MAPPING":"",t.toneMapping!==tl?va.tonemapping_pars_fragment:"",t.toneMapping!==tl?lA("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",va.colorspace_pars_fragment,sA("linearToOutputTexel",t.outputColorSpace),cA(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Pu).join(`
`)),x=C0(x),x=dv(x,t),x=hv(x,t),_=C0(_),_=dv(_,t),_=hv(_,t),x=fv(x),_=fv(_),t.isRawShaderMaterial!==!0&&(Xe=`#version 300 es
`,Se=[_e,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+Se,Ee=["#define varying in",t.glslVersion===Rg?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Rg?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+Ee);const qe=Xe+Se+x,$e=Xe+Ee+_,ft=cv(a,a.VERTEX_SHADER,qe),gt=cv(a,a.FRAGMENT_SHADER,$e);a.attachShader(Pe,ft),a.attachShader(Pe,gt),t.index0AttributeName!==void 0?a.bindAttribLocation(Pe,0,t.index0AttributeName):t.morphTargets===!0&&a.bindAttribLocation(Pe,0,"position"),a.linkProgram(Pe);function pt(nt){if(n.debug.checkShaderErrors){const nr=a.getProgramInfoLog(Pe).trim(),Zt=a.getShaderInfoLog(ft).trim(),Xt=a.getShaderInfoLog(gt).trim();let Pr=!0,cr=!0;if(a.getProgramParameter(Pe,a.LINK_STATUS)===!1)if(Pr=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(a,Pe,ft,gt);else{const Qr=uv(a,ft,"vertex"),Tr=uv(a,gt,"fragment");console.error("THREE.WebGLProgram: Shader Error "+a.getError()+" - VALIDATE_STATUS "+a.getProgramParameter(Pe,a.VALIDATE_STATUS)+`

Material Name: `+nt.name+`
Material Type: `+nt.type+`

Program Info Log: `+nr+`
`+Qr+`
`+Tr)}else nr!==""?console.warn("THREE.WebGLProgram: Program Info Log:",nr):(Zt===""||Xt==="")&&(cr=!1);cr&&(nt.diagnostics={runnable:Pr,programLog:nr,vertexShader:{log:Zt,prefix:Se},fragmentShader:{log:Xt,prefix:Ee}})}a.deleteShader(ft),a.deleteShader(gt),Ht=new Mh(a,Pe),ur=hA(a,Pe)}let Ht;this.getUniforms=function(){return Ht===void 0&&pt(this),Ht};let ur;this.getAttributes=function(){return ur===void 0&&pt(this),ur};let Ve=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return Ve===!1&&(Ve=a.getProgramParameter(Pe,nA)),Ve},this.destroy=function(){r.releaseStatesOfProgram(this),a.deleteProgram(Pe),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=aA++,this.cacheKey=e,this.usedTimes=1,this.program=Pe,this.vertexShader=ft,this.fragmentShader=gt,this}let TA=0;class AA{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,a=this._getShaderStage(t),l=this._getShaderStage(r),x=this._getShaderCacheForMaterial(e);return x.has(a)===!1&&(x.add(a),a.usedTimes++),x.has(l)===!1&&(x.add(l),l.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new SA(e),t.set(e,r)),r}}class SA{constructor(e){this.id=TA++,this.code=e,this.usedTimes=0}}function CA(n,e,t,r,a,l,x){const _=new gm,O=new AA,z=new Set,q=[],oe=a.logarithmicDepthBuffer,ue=a.reverseDepthBuffer,_e=a.vertexTextures;let be=a.precision;const Pe={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function Se(Ve){return z.add(Ve),Ve===0?"uv":`uv${Ve}`}function Ee(Ve,nt,nr,Zt,Xt){const Pr=Zt.fog,cr=Xt.geometry,Qr=Ve.isMeshStandardMaterial?Zt.environment:null,Tr=(Ve.isMeshStandardMaterial?t:e).get(Ve.envMap||Qr),ln=Tr&&Tr.mapping===jh?Tr.image.height:null,Sn=Pe[Ve.type];Ve.precision!==null&&(be=a.getMaxPrecision(Ve.precision),be!==Ve.precision&&console.warn("THREE.WebGLProgram.getParameters:",Ve.precision,"not supported, using",be,"instead."));const Wn=cr.morphAttributes.position||cr.morphAttributes.normal||cr.morphAttributes.color,Ma=Wn!==void 0?Wn.length:0;let zn=0;cr.morphAttributes.position!==void 0&&(zn=1),cr.morphAttributes.normal!==void 0&&(zn=2),cr.morphAttributes.color!==void 0&&(zn=3);let Or,$r,En,Ln;if(Sn){const hi=ps[Sn];Or=hi.vertexShader,$r=hi.fragmentShader}else Or=Ve.vertexShader,$r=Ve.fragmentShader,O.update(Ve),En=O.getVertexShaderID(Ve),Ln=O.getFragmentShaderID(Ve);const ta=n.getRenderTarget(),Jn=Xt.isInstancedMesh===!0,da=Xt.isBatchedMesh===!0,La=!!Ve.map,ga=!!Ve.matcap,tr=!!Tr,Ni=!!Ve.aoMap,fa=!!Ve.lightMap,ya=!!Ve.bumpMap,ra=!!Ve.normalMap,Ga=!!Ve.displacementMap,na=!!Ve.emissiveMap,Dt=!!Ve.metalnessMap,ut=!!Ve.roughnessMap,dr=Ve.anisotropy>0,kr=Ve.clearcoat>0,qr=Ve.dispersion>0,Ir=Ve.iridescence>0,Nn=Ve.sheen>0,hn=Ve.transmission>0,wn=dr&&!!Ve.anisotropyMap,pa=kr&&!!Ve.clearcoatMap,en=kr&&!!Ve.clearcoatNormalMap,Rn=kr&&!!Ve.clearcoatRoughnessMap,Kn=Ir&&!!Ve.iridescenceMap,$n=Ir&&!!Ve.iridescenceThicknessMap,Mn=Nn&&!!Ve.sheenColorMap,Xn=Nn&&!!Ve.sheenRoughnessMap,Ft=!!Ve.specularMap,Wr=!!Ve.specularColorMap,qt=!!Ve.specularIntensityMap,jr=hn&&!!Ve.transmissionMap,mr=hn&&!!Ve.thicknessMap,Nr=!!Ve.gradientMap,cn=!!Ve.alphaMap,nn=Ve.alphaTest>0,Sa=!!Ve.alphaHash,Ia=!!Ve.extensions;let an=tl;Ve.toneMapped&&(ta===null||ta.isXRRenderTarget===!0)&&(an=n.toneMapping);const xa={shaderID:Sn,shaderType:Ve.type,shaderName:Ve.name,vertexShader:Or,fragmentShader:$r,defines:Ve.defines,customVertexShaderID:En,customFragmentShaderID:Ln,isRawShaderMaterial:Ve.isRawShaderMaterial===!0,glslVersion:Ve.glslVersion,precision:be,batching:da,batchingColor:da&&Xt._colorsTexture!==null,instancing:Jn,instancingColor:Jn&&Xt.instanceColor!==null,instancingMorph:Jn&&Xt.morphTexture!==null,supportsVertexTextures:_e,outputColorSpace:ta===null?n.outputColorSpace:ta.isXRRenderTarget===!0?ta.texture.colorSpace:ol,alphaToCoverage:!!Ve.alphaToCoverage,map:La,matcap:ga,envMap:tr,envMapMode:tr&&Tr.mapping,envMapCubeUVHeight:ln,aoMap:Ni,lightMap:fa,bumpMap:ya,normalMap:ra,displacementMap:_e&&Ga,emissiveMap:na,normalMapObjectSpace:ra&&Ve.normalMapType===xw,normalMapTangentSpace:ra&&Ve.normalMapType===fm,metalnessMap:Dt,roughnessMap:ut,anisotropy:dr,anisotropyMap:wn,clearcoat:kr,clearcoatMap:pa,clearcoatNormalMap:en,clearcoatRoughnessMap:Rn,dispersion:qr,iridescence:Ir,iridescenceMap:Kn,iridescenceThicknessMap:$n,sheen:Nn,sheenColorMap:Mn,sheenRoughnessMap:Xn,specularMap:Ft,specularColorMap:Wr,specularIntensityMap:qt,transmission:hn,transmissionMap:jr,thicknessMap:mr,gradientMap:Nr,opaque:Ve.transparent===!1&&Ve.blending===Dc&&Ve.alphaToCoverage===!1,alphaMap:cn,alphaTest:nn,alphaHash:Sa,combine:Ve.combine,mapUv:La&&Se(Ve.map.channel),aoMapUv:Ni&&Se(Ve.aoMap.channel),lightMapUv:fa&&Se(Ve.lightMap.channel),bumpMapUv:ya&&Se(Ve.bumpMap.channel),normalMapUv:ra&&Se(Ve.normalMap.channel),displacementMapUv:Ga&&Se(Ve.displacementMap.channel),emissiveMapUv:na&&Se(Ve.emissiveMap.channel),metalnessMapUv:Dt&&Se(Ve.metalnessMap.channel),roughnessMapUv:ut&&Se(Ve.roughnessMap.channel),anisotropyMapUv:wn&&Se(Ve.anisotropyMap.channel),clearcoatMapUv:pa&&Se(Ve.clearcoatMap.channel),clearcoatNormalMapUv:en&&Se(Ve.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Rn&&Se(Ve.clearcoatRoughnessMap.channel),iridescenceMapUv:Kn&&Se(Ve.iridescenceMap.channel),iridescenceThicknessMapUv:$n&&Se(Ve.iridescenceThicknessMap.channel),sheenColorMapUv:Mn&&Se(Ve.sheenColorMap.channel),sheenRoughnessMapUv:Xn&&Se(Ve.sheenRoughnessMap.channel),specularMapUv:Ft&&Se(Ve.specularMap.channel),specularColorMapUv:Wr&&Se(Ve.specularColorMap.channel),specularIntensityMapUv:qt&&Se(Ve.specularIntensityMap.channel),transmissionMapUv:jr&&Se(Ve.transmissionMap.channel),thicknessMapUv:mr&&Se(Ve.thicknessMap.channel),alphaMapUv:cn&&Se(Ve.alphaMap.channel),vertexTangents:!!cr.attributes.tangent&&(ra||dr),vertexColors:Ve.vertexColors,vertexAlphas:Ve.vertexColors===!0&&!!cr.attributes.color&&cr.attributes.color.itemSize===4,pointsUvs:Xt.isPoints===!0&&!!cr.attributes.uv&&(La||cn),fog:!!Pr,useFog:Ve.fog===!0,fogExp2:!!Pr&&Pr.isFogExp2,flatShading:Ve.flatShading===!0,sizeAttenuation:Ve.sizeAttenuation===!0,logarithmicDepthBuffer:oe,reverseDepthBuffer:ue,skinning:Xt.isSkinnedMesh===!0,morphTargets:cr.morphAttributes.position!==void 0,morphNormals:cr.morphAttributes.normal!==void 0,morphColors:cr.morphAttributes.color!==void 0,morphTargetsCount:Ma,morphTextureStride:zn,numDirLights:nt.directional.length,numPointLights:nt.point.length,numSpotLights:nt.spot.length,numSpotLightMaps:nt.spotLightMap.length,numRectAreaLights:nt.rectArea.length,numHemiLights:nt.hemi.length,numDirLightShadows:nt.directionalShadowMap.length,numPointLightShadows:nt.pointShadowMap.length,numSpotLightShadows:nt.spotShadowMap.length,numSpotLightShadowsWithMaps:nt.numSpotLightShadowsWithMaps,numLightProbes:nt.numLightProbes,numClippingPlanes:x.numPlanes,numClipIntersection:x.numIntersection,dithering:Ve.dithering,shadowMapEnabled:n.shadowMap.enabled&&nr.length>0,shadowMapType:n.shadowMap.type,toneMapping:an,decodeVideoTexture:La&&Ve.map.isVideoTexture===!0&&Ya.getTransfer(Ve.map.colorSpace)===gi,premultipliedAlpha:Ve.premultipliedAlpha,doubleSided:Ve.side===co,flipSided:Ve.side===_o,useDepthPacking:Ve.depthPacking>=0,depthPacking:Ve.depthPacking||0,index0AttributeName:Ve.index0AttributeName,extensionClipCullDistance:Ia&&Ve.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ia&&Ve.extensions.multiDraw===!0||da)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:Ve.customProgramCacheKey()};return xa.vertexUv1s=z.has(1),xa.vertexUv2s=z.has(2),xa.vertexUv3s=z.has(3),z.clear(),xa}function Xe(Ve){const nt=[];if(Ve.shaderID?nt.push(Ve.shaderID):(nt.push(Ve.customVertexShaderID),nt.push(Ve.customFragmentShaderID)),Ve.defines!==void 0)for(const nr in Ve.defines)nt.push(nr),nt.push(Ve.defines[nr]);return Ve.isRawShaderMaterial===!1&&(qe(nt,Ve),$e(nt,Ve),nt.push(n.outputColorSpace)),nt.push(Ve.customProgramCacheKey),nt.join()}function qe(Ve,nt){Ve.push(nt.precision),Ve.push(nt.outputColorSpace),Ve.push(nt.envMapMode),Ve.push(nt.envMapCubeUVHeight),Ve.push(nt.mapUv),Ve.push(nt.alphaMapUv),Ve.push(nt.lightMapUv),Ve.push(nt.aoMapUv),Ve.push(nt.bumpMapUv),Ve.push(nt.normalMapUv),Ve.push(nt.displacementMapUv),Ve.push(nt.emissiveMapUv),Ve.push(nt.metalnessMapUv),Ve.push(nt.roughnessMapUv),Ve.push(nt.anisotropyMapUv),Ve.push(nt.clearcoatMapUv),Ve.push(nt.clearcoatNormalMapUv),Ve.push(nt.clearcoatRoughnessMapUv),Ve.push(nt.iridescenceMapUv),Ve.push(nt.iridescenceThicknessMapUv),Ve.push(nt.sheenColorMapUv),Ve.push(nt.sheenRoughnessMapUv),Ve.push(nt.specularMapUv),Ve.push(nt.specularColorMapUv),Ve.push(nt.specularIntensityMapUv),Ve.push(nt.transmissionMapUv),Ve.push(nt.thicknessMapUv),Ve.push(nt.combine),Ve.push(nt.fogExp2),Ve.push(nt.sizeAttenuation),Ve.push(nt.morphTargetsCount),Ve.push(nt.morphAttributeCount),Ve.push(nt.numDirLights),Ve.push(nt.numPointLights),Ve.push(nt.numSpotLights),Ve.push(nt.numSpotLightMaps),Ve.push(nt.numHemiLights),Ve.push(nt.numRectAreaLights),Ve.push(nt.numDirLightShadows),Ve.push(nt.numPointLightShadows),Ve.push(nt.numSpotLightShadows),Ve.push(nt.numSpotLightShadowsWithMaps),Ve.push(nt.numLightProbes),Ve.push(nt.shadowMapType),Ve.push(nt.toneMapping),Ve.push(nt.numClippingPlanes),Ve.push(nt.numClipIntersection),Ve.push(nt.depthPacking)}function $e(Ve,nt){_.disableAll(),nt.supportsVertexTextures&&_.enable(0),nt.instancing&&_.enable(1),nt.instancingColor&&_.enable(2),nt.instancingMorph&&_.enable(3),nt.matcap&&_.enable(4),nt.envMap&&_.enable(5),nt.normalMapObjectSpace&&_.enable(6),nt.normalMapTangentSpace&&_.enable(7),nt.clearcoat&&_.enable(8),nt.iridescence&&_.enable(9),nt.alphaTest&&_.enable(10),nt.vertexColors&&_.enable(11),nt.vertexAlphas&&_.enable(12),nt.vertexUv1s&&_.enable(13),nt.vertexUv2s&&_.enable(14),nt.vertexUv3s&&_.enable(15),nt.vertexTangents&&_.enable(16),nt.anisotropy&&_.enable(17),nt.alphaHash&&_.enable(18),nt.batching&&_.enable(19),nt.dispersion&&_.enable(20),nt.batchingColor&&_.enable(21),Ve.push(_.mask),_.disableAll(),nt.fog&&_.enable(0),nt.useFog&&_.enable(1),nt.flatShading&&_.enable(2),nt.logarithmicDepthBuffer&&_.enable(3),nt.reverseDepthBuffer&&_.enable(4),nt.skinning&&_.enable(5),nt.morphTargets&&_.enable(6),nt.morphNormals&&_.enable(7),nt.morphColors&&_.enable(8),nt.premultipliedAlpha&&_.enable(9),nt.shadowMapEnabled&&_.enable(10),nt.doubleSided&&_.enable(11),nt.flipSided&&_.enable(12),nt.useDepthPacking&&_.enable(13),nt.dithering&&_.enable(14),nt.transmission&&_.enable(15),nt.sheen&&_.enable(16),nt.opaque&&_.enable(17),nt.pointsUvs&&_.enable(18),nt.decodeVideoTexture&&_.enable(19),nt.alphaToCoverage&&_.enable(20),Ve.push(_.mask)}function ft(Ve){const nt=Pe[Ve.type];let nr;if(nt){const Zt=ps[nt];nr=uM.clone(Zt.uniforms)}else nr=Ve.uniforms;return nr}function gt(Ve,nt){let nr;for(let Zt=0,Xt=q.length;Zt<Xt;Zt++){const Pr=q[Zt];if(Pr.cacheKey===nt){nr=Pr,++nr.usedTimes;break}}return nr===void 0&&(nr=new MA(n,nt,Ve,l),q.push(nr)),nr}function pt(Ve){if(--Ve.usedTimes===0){const nt=q.indexOf(Ve);q[nt]=q[q.length-1],q.pop(),Ve.destroy()}}function Ht(Ve){O.remove(Ve)}function ur(){O.dispose()}return{getParameters:Ee,getProgramCacheKey:Xe,getUniforms:ft,acquireProgram:gt,releaseProgram:pt,releaseShaderCache:Ht,programs:q,dispose:ur}}function EA(){let n=new WeakMap;function e(x){return n.has(x)}function t(x){let _=n.get(x);return _===void 0&&(_={},n.set(x,_)),_}function r(x){n.delete(x)}function a(x,_,O){n.get(x)[_]=O}function l(){n=new WeakMap}return{has:e,get:t,remove:r,update:a,dispose:l}}function LA(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function mv(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function gv(){const n=[];let e=0;const t=[],r=[],a=[];function l(){e=0,t.length=0,r.length=0,a.length=0}function x(oe,ue,_e,be,Pe,Se){let Ee=n[e];return Ee===void 0?(Ee={id:oe.id,object:oe,geometry:ue,material:_e,groupOrder:be,renderOrder:oe.renderOrder,z:Pe,group:Se},n[e]=Ee):(Ee.id=oe.id,Ee.object=oe,Ee.geometry=ue,Ee.material=_e,Ee.groupOrder=be,Ee.renderOrder=oe.renderOrder,Ee.z=Pe,Ee.group=Se),e++,Ee}function _(oe,ue,_e,be,Pe,Se){const Ee=x(oe,ue,_e,be,Pe,Se);_e.transmission>0?r.push(Ee):_e.transparent===!0?a.push(Ee):t.push(Ee)}function O(oe,ue,_e,be,Pe,Se){const Ee=x(oe,ue,_e,be,Pe,Se);_e.transmission>0?r.unshift(Ee):_e.transparent===!0?a.unshift(Ee):t.unshift(Ee)}function z(oe,ue){t.length>1&&t.sort(oe||LA),r.length>1&&r.sort(ue||mv),a.length>1&&a.sort(ue||mv)}function q(){for(let oe=e,ue=n.length;oe<ue;oe++){const _e=n[oe];if(_e.id===null)break;_e.id=null,_e.object=null,_e.geometry=null,_e.material=null,_e.group=null}}return{opaque:t,transmissive:r,transparent:a,init:l,push:_,unshift:O,finish:q,sort:z}}function RA(){let n=new WeakMap;function e(r,a){const l=n.get(r);let x;return l===void 0?(x=new gv,n.set(r,[x])):a>=l.length?(x=new gv,l.push(x)):x=l[a],x}function t(){n=new WeakMap}return{get:e,dispose:t}}function kA(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new st,color:new qn};break;case"SpotLight":t={position:new st,direction:new st,color:new qn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new st,color:new qn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new st,skyColor:new qn,groundColor:new qn};break;case"RectAreaLight":t={color:new qn,position:new st,halfWidth:new st,halfHeight:new st};break}return n[e.id]=t,t}}}function PA(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jr};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jr};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jr,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let OA=0;function NA(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function DA(n){const e=new kA,t=PA(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let z=0;z<9;z++)r.probe.push(new st);const a=new st,l=new jn,x=new jn;function _(z){let q=0,oe=0,ue=0;for(let ur=0;ur<9;ur++)r.probe[ur].set(0,0,0);let _e=0,be=0,Pe=0,Se=0,Ee=0,Xe=0,qe=0,$e=0,ft=0,gt=0,pt=0;z.sort(NA);for(let ur=0,Ve=z.length;ur<Ve;ur++){const nt=z[ur],nr=nt.color,Zt=nt.intensity,Xt=nt.distance,Pr=nt.shadow&&nt.shadow.map?nt.shadow.map.texture:null;if(nt.isAmbientLight)q+=nr.r*Zt,oe+=nr.g*Zt,ue+=nr.b*Zt;else if(nt.isLightProbe){for(let cr=0;cr<9;cr++)r.probe[cr].addScaledVector(nt.sh.coefficients[cr],Zt);pt++}else if(nt.isDirectionalLight){const cr=e.get(nt);if(cr.color.copy(nt.color).multiplyScalar(nt.intensity),nt.castShadow){const Qr=nt.shadow,Tr=t.get(nt);Tr.shadowIntensity=Qr.intensity,Tr.shadowBias=Qr.bias,Tr.shadowNormalBias=Qr.normalBias,Tr.shadowRadius=Qr.radius,Tr.shadowMapSize=Qr.mapSize,r.directionalShadow[_e]=Tr,r.directionalShadowMap[_e]=Pr,r.directionalShadowMatrix[_e]=nt.shadow.matrix,Xe++}r.directional[_e]=cr,_e++}else if(nt.isSpotLight){const cr=e.get(nt);cr.position.setFromMatrixPosition(nt.matrixWorld),cr.color.copy(nr).multiplyScalar(Zt),cr.distance=Xt,cr.coneCos=Math.cos(nt.angle),cr.penumbraCos=Math.cos(nt.angle*(1-nt.penumbra)),cr.decay=nt.decay,r.spot[Pe]=cr;const Qr=nt.shadow;if(nt.map&&(r.spotLightMap[ft]=nt.map,ft++,Qr.updateMatrices(nt),nt.castShadow&&gt++),r.spotLightMatrix[Pe]=Qr.matrix,nt.castShadow){const Tr=t.get(nt);Tr.shadowIntensity=Qr.intensity,Tr.shadowBias=Qr.bias,Tr.shadowNormalBias=Qr.normalBias,Tr.shadowRadius=Qr.radius,Tr.shadowMapSize=Qr.mapSize,r.spotShadow[Pe]=Tr,r.spotShadowMap[Pe]=Pr,$e++}Pe++}else if(nt.isRectAreaLight){const cr=e.get(nt);cr.color.copy(nr).multiplyScalar(Zt),cr.halfWidth.set(nt.width*.5,0,0),cr.halfHeight.set(0,nt.height*.5,0),r.rectArea[Se]=cr,Se++}else if(nt.isPointLight){const cr=e.get(nt);if(cr.color.copy(nt.color).multiplyScalar(nt.intensity),cr.distance=nt.distance,cr.decay=nt.decay,nt.castShadow){const Qr=nt.shadow,Tr=t.get(nt);Tr.shadowIntensity=Qr.intensity,Tr.shadowBias=Qr.bias,Tr.shadowNormalBias=Qr.normalBias,Tr.shadowRadius=Qr.radius,Tr.shadowMapSize=Qr.mapSize,Tr.shadowCameraNear=Qr.camera.near,Tr.shadowCameraFar=Qr.camera.far,r.pointShadow[be]=Tr,r.pointShadowMap[be]=Pr,r.pointShadowMatrix[be]=nt.shadow.matrix,qe++}r.point[be]=cr,be++}else if(nt.isHemisphereLight){const cr=e.get(nt);cr.skyColor.copy(nt.color).multiplyScalar(Zt),cr.groundColor.copy(nt.groundColor).multiplyScalar(Zt),r.hemi[Ee]=cr,Ee++}}Se>0&&(n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=_n.LTC_FLOAT_1,r.rectAreaLTC2=_n.LTC_FLOAT_2):(r.rectAreaLTC1=_n.LTC_HALF_1,r.rectAreaLTC2=_n.LTC_HALF_2)),r.ambient[0]=q,r.ambient[1]=oe,r.ambient[2]=ue;const Ht=r.hash;(Ht.directionalLength!==_e||Ht.pointLength!==be||Ht.spotLength!==Pe||Ht.rectAreaLength!==Se||Ht.hemiLength!==Ee||Ht.numDirectionalShadows!==Xe||Ht.numPointShadows!==qe||Ht.numSpotShadows!==$e||Ht.numSpotMaps!==ft||Ht.numLightProbes!==pt)&&(r.directional.length=_e,r.spot.length=Pe,r.rectArea.length=Se,r.point.length=be,r.hemi.length=Ee,r.directionalShadow.length=Xe,r.directionalShadowMap.length=Xe,r.pointShadow.length=qe,r.pointShadowMap.length=qe,r.spotShadow.length=$e,r.spotShadowMap.length=$e,r.directionalShadowMatrix.length=Xe,r.pointShadowMatrix.length=qe,r.spotLightMatrix.length=$e+ft-gt,r.spotLightMap.length=ft,r.numSpotLightShadowsWithMaps=gt,r.numLightProbes=pt,Ht.directionalLength=_e,Ht.pointLength=be,Ht.spotLength=Pe,Ht.rectAreaLength=Se,Ht.hemiLength=Ee,Ht.numDirectionalShadows=Xe,Ht.numPointShadows=qe,Ht.numSpotShadows=$e,Ht.numSpotMaps=ft,Ht.numLightProbes=pt,r.version=OA++)}function O(z,q){let oe=0,ue=0,_e=0,be=0,Pe=0;const Se=q.matrixWorldInverse;for(let Ee=0,Xe=z.length;Ee<Xe;Ee++){const qe=z[Ee];if(qe.isDirectionalLight){const $e=r.directional[oe];$e.direction.setFromMatrixPosition(qe.matrixWorld),a.setFromMatrixPosition(qe.target.matrixWorld),$e.direction.sub(a),$e.direction.transformDirection(Se),oe++}else if(qe.isSpotLight){const $e=r.spot[_e];$e.position.setFromMatrixPosition(qe.matrixWorld),$e.position.applyMatrix4(Se),$e.direction.setFromMatrixPosition(qe.matrixWorld),a.setFromMatrixPosition(qe.target.matrixWorld),$e.direction.sub(a),$e.direction.transformDirection(Se),_e++}else if(qe.isRectAreaLight){const $e=r.rectArea[be];$e.position.setFromMatrixPosition(qe.matrixWorld),$e.position.applyMatrix4(Se),x.identity(),l.copy(qe.matrixWorld),l.premultiply(Se),x.extractRotation(l),$e.halfWidth.set(qe.width*.5,0,0),$e.halfHeight.set(0,qe.height*.5,0),$e.halfWidth.applyMatrix4(x),$e.halfHeight.applyMatrix4(x),be++}else if(qe.isPointLight){const $e=r.point[ue];$e.position.setFromMatrixPosition(qe.matrixWorld),$e.position.applyMatrix4(Se),ue++}else if(qe.isHemisphereLight){const $e=r.hemi[Pe];$e.direction.setFromMatrixPosition(qe.matrixWorld),$e.direction.transformDirection(Se),Pe++}}}return{setup:_,setupView:O,state:r}}function vv(n){const e=new DA(n),t=[],r=[];function a(q){z.camera=q,t.length=0,r.length=0}function l(q){t.push(q)}function x(q){r.push(q)}function _(){e.setup(t)}function O(q){e.setupView(t,q)}const z={lightsArray:t,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:a,state:z,setupLights:_,setupLightsView:O,pushLight:l,pushShadow:x}}function IA(n){let e=new WeakMap;function t(a,l=0){const x=e.get(a);let _;return x===void 0?(_=new vv(n),e.set(a,[_])):l>=x.length?(_=new vv(n),x.push(_)):_=x[l],_}function r(){e=new WeakMap}return{get:t,dispose:r}}class zA extends zs{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=vw,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class FA extends zs{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const UA=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,BA=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function HA(n,e,t){let r=new Yh;const a=new Jr,l=new Jr,x=new Si,_=new zA({depthPacking:yw}),O=new FA,z={},q=t.maxTextureSize,oe={[rl]:_o,[_o]:rl,[co]:co},ue=new nl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Jr},radius:{value:4}},vertexShader:UA,fragmentShader:BA}),_e=ue.clone();_e.defines.HORIZONTAL_PASS=1;const be=new di;be.setAttribute("position",new Xi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const Pe=new Ci(be,ue),Se=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Ky;let Ee=this.type;this.render=function(gt,pt,Ht){if(Se.enabled===!1||Se.autoUpdate===!1&&Se.needsUpdate===!1||gt.length===0)return;const ur=n.getRenderTarget(),Ve=n.getActiveCubeFace(),nt=n.getActiveMipmapLevel(),nr=n.state;nr.setBlending(el),nr.buffers.color.setClear(1,1,1,1),nr.buffers.depth.setTest(!0),nr.setScissorTest(!1);const Zt=Ee!==Ps&&this.type===Ps,Xt=Ee===Ps&&this.type!==Ps;for(let Pr=0,cr=gt.length;Pr<cr;Pr++){const Qr=gt[Pr],Tr=Qr.shadow;if(Tr===void 0){console.warn("THREE.WebGLShadowMap:",Qr,"has no shadow.");continue}if(Tr.autoUpdate===!1&&Tr.needsUpdate===!1)continue;a.copy(Tr.mapSize);const ln=Tr.getFrameExtents();if(a.multiply(ln),l.copy(Tr.mapSize),(a.x>q||a.y>q)&&(a.x>q&&(l.x=Math.floor(q/ln.x),a.x=l.x*ln.x,Tr.mapSize.x=l.x),a.y>q&&(l.y=Math.floor(q/ln.y),a.y=l.y*ln.y,Tr.mapSize.y=l.y)),Tr.map===null||Zt===!0||Xt===!0){const Wn=this.type!==Ps?{minFilter:To,magFilter:To}:{};Tr.map!==null&&Tr.map.dispose(),Tr.map=new Fl(a.x,a.y,Wn),Tr.map.texture.name=Qr.name+".shadowMap",Tr.camera.updateProjectionMatrix()}n.setRenderTarget(Tr.map),n.clear();const Sn=Tr.getViewportCount();for(let Wn=0;Wn<Sn;Wn++){const Ma=Tr.getViewport(Wn);x.set(l.x*Ma.x,l.y*Ma.y,l.x*Ma.z,l.y*Ma.w),nr.viewport(x),Tr.updateMatrices(Qr,Wn),r=Tr.getFrustum(),$e(pt,Ht,Tr.camera,Qr,this.type)}Tr.isPointLightShadow!==!0&&this.type===Ps&&Xe(Tr,Ht),Tr.needsUpdate=!1}Ee=this.type,Se.needsUpdate=!1,n.setRenderTarget(ur,Ve,nt)};function Xe(gt,pt){const Ht=e.update(Pe);ue.defines.VSM_SAMPLES!==gt.blurSamples&&(ue.defines.VSM_SAMPLES=gt.blurSamples,_e.defines.VSM_SAMPLES=gt.blurSamples,ue.needsUpdate=!0,_e.needsUpdate=!0),gt.mapPass===null&&(gt.mapPass=new Fl(a.x,a.y)),ue.uniforms.shadow_pass.value=gt.map.texture,ue.uniforms.resolution.value=gt.mapSize,ue.uniforms.radius.value=gt.radius,n.setRenderTarget(gt.mapPass),n.clear(),n.renderBufferDirect(pt,null,Ht,ue,Pe,null),_e.uniforms.shadow_pass.value=gt.mapPass.texture,_e.uniforms.resolution.value=gt.mapSize,_e.uniforms.radius.value=gt.radius,n.setRenderTarget(gt.map),n.clear(),n.renderBufferDirect(pt,null,Ht,_e,Pe,null)}function qe(gt,pt,Ht,ur){let Ve=null;const nt=Ht.isPointLight===!0?gt.customDistanceMaterial:gt.customDepthMaterial;if(nt!==void 0)Ve=nt;else if(Ve=Ht.isPointLight===!0?O:_,n.localClippingEnabled&&pt.clipShadows===!0&&Array.isArray(pt.clippingPlanes)&&pt.clippingPlanes.length!==0||pt.displacementMap&&pt.displacementScale!==0||pt.alphaMap&&pt.alphaTest>0||pt.map&&pt.alphaTest>0){const nr=Ve.uuid,Zt=pt.uuid;let Xt=z[nr];Xt===void 0&&(Xt={},z[nr]=Xt);let Pr=Xt[Zt];Pr===void 0&&(Pr=Ve.clone(),Xt[Zt]=Pr,pt.addEventListener("dispose",ft)),Ve=Pr}if(Ve.visible=pt.visible,Ve.wireframe=pt.wireframe,ur===Ps?Ve.side=pt.shadowSide!==null?pt.shadowSide:pt.side:Ve.side=pt.shadowSide!==null?pt.shadowSide:oe[pt.side],Ve.alphaMap=pt.alphaMap,Ve.alphaTest=pt.alphaTest,Ve.map=pt.map,Ve.clipShadows=pt.clipShadows,Ve.clippingPlanes=pt.clippingPlanes,Ve.clipIntersection=pt.clipIntersection,Ve.displacementMap=pt.displacementMap,Ve.displacementScale=pt.displacementScale,Ve.displacementBias=pt.displacementBias,Ve.wireframeLinewidth=pt.wireframeLinewidth,Ve.linewidth=pt.linewidth,Ht.isPointLight===!0&&Ve.isMeshDistanceMaterial===!0){const nr=n.properties.get(Ve);nr.light=Ht}return Ve}function $e(gt,pt,Ht,ur,Ve){if(gt.visible===!1)return;if(gt.layers.test(pt.layers)&&(gt.isMesh||gt.isLine||gt.isPoints)&&(gt.castShadow||gt.receiveShadow&&Ve===Ps)&&(!gt.frustumCulled||r.intersectsObject(gt))){gt.modelViewMatrix.multiplyMatrices(Ht.matrixWorldInverse,gt.matrixWorld);const nr=e.update(gt),Zt=gt.material;if(Array.isArray(Zt)){const Xt=nr.groups;for(let Pr=0,cr=Xt.length;Pr<cr;Pr++){const Qr=Xt[Pr],Tr=Zt[Qr.materialIndex];if(Tr&&Tr.visible){const ln=qe(gt,Tr,ur,Ve);gt.onBeforeShadow(n,gt,pt,Ht,nr,ln,Qr),n.renderBufferDirect(Ht,null,nr,ln,gt,Qr),gt.onAfterShadow(n,gt,pt,Ht,nr,ln,Qr)}}}else if(Zt.visible){const Xt=qe(gt,Zt,ur,Ve);gt.onBeforeShadow(n,gt,pt,Ht,nr,Xt,null),n.renderBufferDirect(Ht,null,nr,Xt,gt,null),gt.onAfterShadow(n,gt,pt,Ht,nr,Xt,null)}}const nt=gt.children;for(let nr=0,Zt=nt.length;nr<Zt;nr++)$e(nt[nr],pt,Ht,ur,Ve)}function ft(gt){gt.target.removeEventListener("dispose",ft);for(const pt in z){const Ht=z[pt],ur=gt.target.uuid;ur in Ht&&(Ht[ur].dispose(),delete Ht[ur])}}}const VA={[Gp]:jp,[Wp]:Jp,[Yp]:Xp,[Fc]:qp,[jp]:Gp,[Jp]:Wp,[Xp]:Yp,[qp]:Fc};function GA(n){function e(){let qt=!1;const jr=new Si;let mr=null;const Nr=new Si(0,0,0,0);return{setMask:function(cn){mr!==cn&&!qt&&(n.colorMask(cn,cn,cn,cn),mr=cn)},setLocked:function(cn){qt=cn},setClear:function(cn,nn,Sa,Ia,an){an===!0&&(cn*=Ia,nn*=Ia,Sa*=Ia),jr.set(cn,nn,Sa,Ia),Nr.equals(jr)===!1&&(n.clearColor(cn,nn,Sa,Ia),Nr.copy(jr))},reset:function(){qt=!1,mr=null,Nr.set(-1,0,0,0)}}}function t(){let qt=!1,jr=!1,mr=null,Nr=null,cn=null;return{setReversed:function(nn){jr=nn},setTest:function(nn){nn?En(n.DEPTH_TEST):Ln(n.DEPTH_TEST)},setMask:function(nn){mr!==nn&&!qt&&(n.depthMask(nn),mr=nn)},setFunc:function(nn){if(jr&&(nn=VA[nn]),Nr!==nn){switch(nn){case Gp:n.depthFunc(n.NEVER);break;case jp:n.depthFunc(n.ALWAYS);break;case Wp:n.depthFunc(n.LESS);break;case Fc:n.depthFunc(n.LEQUAL);break;case Yp:n.depthFunc(n.EQUAL);break;case qp:n.depthFunc(n.GEQUAL);break;case Jp:n.depthFunc(n.GREATER);break;case Xp:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Nr=nn}},setLocked:function(nn){qt=nn},setClear:function(nn){cn!==nn&&(n.clearDepth(nn),cn=nn)},reset:function(){qt=!1,mr=null,Nr=null,cn=null}}}function r(){let qt=!1,jr=null,mr=null,Nr=null,cn=null,nn=null,Sa=null,Ia=null,an=null;return{setTest:function(xa){qt||(xa?En(n.STENCIL_TEST):Ln(n.STENCIL_TEST))},setMask:function(xa){jr!==xa&&!qt&&(n.stencilMask(xa),jr=xa)},setFunc:function(xa,hi,Ka){(mr!==xa||Nr!==hi||cn!==Ka)&&(n.stencilFunc(xa,hi,Ka),mr=xa,Nr=hi,cn=Ka)},setOp:function(xa,hi,Ka){(nn!==xa||Sa!==hi||Ia!==Ka)&&(n.stencilOp(xa,hi,Ka),nn=xa,Sa=hi,Ia=Ka)},setLocked:function(xa){qt=xa},setClear:function(xa){an!==xa&&(n.clearStencil(xa),an=xa)},reset:function(){qt=!1,jr=null,mr=null,Nr=null,cn=null,nn=null,Sa=null,Ia=null,an=null}}}const a=new e,l=new t,x=new r,_=new WeakMap,O=new WeakMap;let z={},q={},oe=new WeakMap,ue=[],_e=null,be=!1,Pe=null,Se=null,Ee=null,Xe=null,qe=null,$e=null,ft=null,gt=new qn(0,0,0),pt=0,Ht=!1,ur=null,Ve=null,nt=null,nr=null,Zt=null;const Xt=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Pr=!1,cr=0;const Qr=n.getParameter(n.VERSION);Qr.indexOf("WebGL")!==-1?(cr=parseFloat(/^WebGL (\d)/.exec(Qr)[1]),Pr=cr>=1):Qr.indexOf("OpenGL ES")!==-1&&(cr=parseFloat(/^OpenGL ES (\d)/.exec(Qr)[1]),Pr=cr>=2);let Tr=null,ln={};const Sn=n.getParameter(n.SCISSOR_BOX),Wn=n.getParameter(n.VIEWPORT),Ma=new Si().fromArray(Sn),zn=new Si().fromArray(Wn);function Or(qt,jr,mr,Nr){const cn=new Uint8Array(4),nn=n.createTexture();n.bindTexture(qt,nn),n.texParameteri(qt,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(qt,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Sa=0;Sa<mr;Sa++)qt===n.TEXTURE_3D||qt===n.TEXTURE_2D_ARRAY?n.texImage3D(jr,0,n.RGBA,1,1,Nr,0,n.RGBA,n.UNSIGNED_BYTE,cn):n.texImage2D(jr+Sa,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,cn);return nn}const $r={};$r[n.TEXTURE_2D]=Or(n.TEXTURE_2D,n.TEXTURE_2D,1),$r[n.TEXTURE_CUBE_MAP]=Or(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),$r[n.TEXTURE_2D_ARRAY]=Or(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),$r[n.TEXTURE_3D]=Or(n.TEXTURE_3D,n.TEXTURE_3D,1,1),a.setClear(0,0,0,1),l.setClear(1),x.setClear(0),En(n.DEPTH_TEST),l.setFunc(Fc),fa(!1),ya(Ag),En(n.CULL_FACE),tr(el);function En(qt){z[qt]!==!0&&(n.enable(qt),z[qt]=!0)}function Ln(qt){z[qt]!==!1&&(n.disable(qt),z[qt]=!1)}function ta(qt,jr){return q[qt]!==jr?(n.bindFramebuffer(qt,jr),q[qt]=jr,qt===n.DRAW_FRAMEBUFFER&&(q[n.FRAMEBUFFER]=jr),qt===n.FRAMEBUFFER&&(q[n.DRAW_FRAMEBUFFER]=jr),!0):!1}function Jn(qt,jr){let mr=ue,Nr=!1;if(qt){mr=oe.get(jr),mr===void 0&&(mr=[],oe.set(jr,mr));const cn=qt.textures;if(mr.length!==cn.length||mr[0]!==n.COLOR_ATTACHMENT0){for(let nn=0,Sa=cn.length;nn<Sa;nn++)mr[nn]=n.COLOR_ATTACHMENT0+nn;mr.length=cn.length,Nr=!0}}else mr[0]!==n.BACK&&(mr[0]=n.BACK,Nr=!0);Nr&&n.drawBuffers(mr)}function da(qt){return _e!==qt?(n.useProgram(qt),_e=qt,!0):!1}const La={[kl]:n.FUNC_ADD,[j5]:n.FUNC_SUBTRACT,[W5]:n.FUNC_REVERSE_SUBTRACT};La[Y5]=n.MIN,La[q5]=n.MAX;const ga={[J5]:n.ZERO,[X5]:n.ONE,[Z5]:n.SRC_COLOR,[Hp]:n.SRC_ALPHA,[rw]:n.SRC_ALPHA_SATURATE,[ew]:n.DST_COLOR,[K5]:n.DST_ALPHA,[Q5]:n.ONE_MINUS_SRC_COLOR,[Vp]:n.ONE_MINUS_SRC_ALPHA,[tw]:n.ONE_MINUS_DST_COLOR,[$5]:n.ONE_MINUS_DST_ALPHA,[nw]:n.CONSTANT_COLOR,[aw]:n.ONE_MINUS_CONSTANT_COLOR,[iw]:n.CONSTANT_ALPHA,[ow]:n.ONE_MINUS_CONSTANT_ALPHA};function tr(qt,jr,mr,Nr,cn,nn,Sa,Ia,an,xa){if(qt===el){be===!0&&(Ln(n.BLEND),be=!1);return}if(be===!1&&(En(n.BLEND),be=!0),qt!==G5){if(qt!==Pe||xa!==Ht){if((Se!==kl||qe!==kl)&&(n.blendEquation(n.FUNC_ADD),Se=kl,qe=kl),xa)switch(qt){case Dc:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Sg:n.blendFunc(n.ONE,n.ONE);break;case Cg:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case Eg:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",qt);break}else switch(qt){case Dc:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Sg:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case Cg:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case Eg:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",qt);break}Ee=null,Xe=null,$e=null,ft=null,gt.set(0,0,0),pt=0,Pe=qt,Ht=xa}return}cn=cn||jr,nn=nn||mr,Sa=Sa||Nr,(jr!==Se||cn!==qe)&&(n.blendEquationSeparate(La[jr],La[cn]),Se=jr,qe=cn),(mr!==Ee||Nr!==Xe||nn!==$e||Sa!==ft)&&(n.blendFuncSeparate(ga[mr],ga[Nr],ga[nn],ga[Sa]),Ee=mr,Xe=Nr,$e=nn,ft=Sa),(Ia.equals(gt)===!1||an!==pt)&&(n.blendColor(Ia.r,Ia.g,Ia.b,an),gt.copy(Ia),pt=an),Pe=qt,Ht=!1}function Ni(qt,jr){qt.side===co?Ln(n.CULL_FACE):En(n.CULL_FACE);let mr=qt.side===_o;jr&&(mr=!mr),fa(mr),qt.blending===Dc&&qt.transparent===!1?tr(el):tr(qt.blending,qt.blendEquation,qt.blendSrc,qt.blendDst,qt.blendEquationAlpha,qt.blendSrcAlpha,qt.blendDstAlpha,qt.blendColor,qt.blendAlpha,qt.premultipliedAlpha),l.setFunc(qt.depthFunc),l.setTest(qt.depthTest),l.setMask(qt.depthWrite),a.setMask(qt.colorWrite);const Nr=qt.stencilWrite;x.setTest(Nr),Nr&&(x.setMask(qt.stencilWriteMask),x.setFunc(qt.stencilFunc,qt.stencilRef,qt.stencilFuncMask),x.setOp(qt.stencilFail,qt.stencilZFail,qt.stencilZPass)),Ga(qt.polygonOffset,qt.polygonOffsetFactor,qt.polygonOffsetUnits),qt.alphaToCoverage===!0?En(n.SAMPLE_ALPHA_TO_COVERAGE):Ln(n.SAMPLE_ALPHA_TO_COVERAGE)}function fa(qt){ur!==qt&&(qt?n.frontFace(n.CW):n.frontFace(n.CCW),ur=qt)}function ya(qt){qt!==B5?(En(n.CULL_FACE),qt!==Ve&&(qt===Ag?n.cullFace(n.BACK):qt===H5?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Ln(n.CULL_FACE),Ve=qt}function ra(qt){qt!==nt&&(Pr&&n.lineWidth(qt),nt=qt)}function Ga(qt,jr,mr){qt?(En(n.POLYGON_OFFSET_FILL),(nr!==jr||Zt!==mr)&&(n.polygonOffset(jr,mr),nr=jr,Zt=mr)):Ln(n.POLYGON_OFFSET_FILL)}function na(qt){qt?En(n.SCISSOR_TEST):Ln(n.SCISSOR_TEST)}function Dt(qt){qt===void 0&&(qt=n.TEXTURE0+Xt-1),Tr!==qt&&(n.activeTexture(qt),Tr=qt)}function ut(qt,jr,mr){mr===void 0&&(Tr===null?mr=n.TEXTURE0+Xt-1:mr=Tr);let Nr=ln[mr];Nr===void 0&&(Nr={type:void 0,texture:void 0},ln[mr]=Nr),(Nr.type!==qt||Nr.texture!==jr)&&(Tr!==mr&&(n.activeTexture(mr),Tr=mr),n.bindTexture(qt,jr||$r[qt]),Nr.type=qt,Nr.texture=jr)}function dr(){const qt=ln[Tr];qt!==void 0&&qt.type!==void 0&&(n.bindTexture(qt.type,null),qt.type=void 0,qt.texture=void 0)}function kr(){try{n.compressedTexImage2D.apply(n,arguments)}catch(qt){console.error("THREE.WebGLState:",qt)}}function qr(){try{n.compressedTexImage3D.apply(n,arguments)}catch(qt){console.error("THREE.WebGLState:",qt)}}function Ir(){try{n.texSubImage2D.apply(n,arguments)}catch(qt){console.error("THREE.WebGLState:",qt)}}function Nn(){try{n.texSubImage3D.apply(n,arguments)}catch(qt){console.error("THREE.WebGLState:",qt)}}function hn(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(qt){console.error("THREE.WebGLState:",qt)}}function wn(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(qt){console.error("THREE.WebGLState:",qt)}}function pa(){try{n.texStorage2D.apply(n,arguments)}catch(qt){console.error("THREE.WebGLState:",qt)}}function en(){try{n.texStorage3D.apply(n,arguments)}catch(qt){console.error("THREE.WebGLState:",qt)}}function Rn(){try{n.texImage2D.apply(n,arguments)}catch(qt){console.error("THREE.WebGLState:",qt)}}function Kn(){try{n.texImage3D.apply(n,arguments)}catch(qt){console.error("THREE.WebGLState:",qt)}}function $n(qt){Ma.equals(qt)===!1&&(n.scissor(qt.x,qt.y,qt.z,qt.w),Ma.copy(qt))}function Mn(qt){zn.equals(qt)===!1&&(n.viewport(qt.x,qt.y,qt.z,qt.w),zn.copy(qt))}function Xn(qt,jr){let mr=O.get(jr);mr===void 0&&(mr=new WeakMap,O.set(jr,mr));let Nr=mr.get(qt);Nr===void 0&&(Nr=n.getUniformBlockIndex(jr,qt.name),mr.set(qt,Nr))}function Ft(qt,jr){const mr=O.get(jr).get(qt);_.get(jr)!==mr&&(n.uniformBlockBinding(jr,mr,qt.__bindingPointIndex),_.set(jr,mr))}function Wr(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),z={},Tr=null,ln={},q={},oe=new WeakMap,ue=[],_e=null,be=!1,Pe=null,Se=null,Ee=null,Xe=null,qe=null,$e=null,ft=null,gt=new qn(0,0,0),pt=0,Ht=!1,ur=null,Ve=null,nt=null,nr=null,Zt=null,Ma.set(0,0,n.canvas.width,n.canvas.height),zn.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),x.reset()}return{buffers:{color:a,depth:l,stencil:x},enable:En,disable:Ln,bindFramebuffer:ta,drawBuffers:Jn,useProgram:da,setBlending:tr,setMaterial:Ni,setFlipSided:fa,setCullFace:ya,setLineWidth:ra,setPolygonOffset:Ga,setScissorTest:na,activeTexture:Dt,bindTexture:ut,unbindTexture:dr,compressedTexImage2D:kr,compressedTexImage3D:qr,texImage2D:Rn,texImage3D:Kn,updateUBOMapping:Xn,uniformBlockBinding:Ft,texStorage2D:pa,texStorage3D:en,texSubImage2D:Ir,texSubImage3D:Nn,compressedTexSubImage2D:hn,compressedTexSubImage3D:wn,scissor:$n,viewport:Mn,reset:Wr}}function yv(n,e,t,r){const a=jA(r);switch(t){case n2:return n*e;case i2:return n*e;case o2:return n*e*2;case cm:return n*e/a.components*a.byteLength;case um:return n*e/a.components*a.byteLength;case s2:return n*e*2/a.components*a.byteLength;case dm:return n*e*2/a.components*a.byteLength;case a2:return n*e*3/a.components*a.byteLength;case Uo:return n*e*4/a.components*a.byteLength;case hm:return n*e*4/a.components*a.byteLength;case vh:case yh:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case xh:case _h:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case t0:case n0:return Math.max(n,16)*Math.max(e,8)/4;case e0:case r0:return Math.max(n,8)*Math.max(e,8)/2;case a0:case i0:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case o0:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case s0:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case l0:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case c0:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case u0:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case d0:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case h0:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case f0:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case p0:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case m0:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case g0:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case v0:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case y0:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case x0:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case _0:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case bh:case b0:case w0:return Math.ceil(n/4)*Math.ceil(e/4)*16;case l2:case M0:return Math.ceil(n/4)*Math.ceil(e/4)*8;case T0:case A0:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function jA(n){switch(n){case Is:case e2:return{byteLength:1,components:1};case Gu:case t2:case Zu:return{byteLength:2,components:1};case sm:case lm:return{byteLength:2,components:4};case Il:case om:case ms:return{byteLength:4,components:1};case r2:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}function WA(n,e,t,r,a,l,x){const _=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,O=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),z=new Jr,q=new WeakMap;let oe;const ue=new WeakMap;let _e=!1;try{_e=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function be(Dt,ut){return _e?new OffscreenCanvas(Dt,ut):kh("canvas")}function Pe(Dt,ut,dr){let kr=1;const qr=na(Dt);if((qr.width>dr||qr.height>dr)&&(kr=dr/Math.max(qr.width,qr.height)),kr<1)if(typeof HTMLImageElement<"u"&&Dt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Dt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Dt instanceof ImageBitmap||typeof VideoFrame<"u"&&Dt instanceof VideoFrame){const Ir=Math.floor(kr*qr.width),Nn=Math.floor(kr*qr.height);oe===void 0&&(oe=be(Ir,Nn));const hn=ut?be(Ir,Nn):oe;return hn.width=Ir,hn.height=Nn,hn.getContext("2d").drawImage(Dt,0,0,Ir,Nn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+qr.width+"x"+qr.height+") to ("+Ir+"x"+Nn+")."),hn}else return"data"in Dt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+qr.width+"x"+qr.height+")."),Dt;return Dt}function Se(Dt){return Dt.generateMipmaps&&Dt.minFilter!==To&&Dt.minFilter!==xo}function Ee(Dt){n.generateMipmap(Dt)}function Xe(Dt,ut,dr,kr,qr=!1){if(Dt!==null){if(n[Dt]!==void 0)return n[Dt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Dt+"'")}let Ir=ut;if(ut===n.RED&&(dr===n.FLOAT&&(Ir=n.R32F),dr===n.HALF_FLOAT&&(Ir=n.R16F),dr===n.UNSIGNED_BYTE&&(Ir=n.R8)),ut===n.RED_INTEGER&&(dr===n.UNSIGNED_BYTE&&(Ir=n.R8UI),dr===n.UNSIGNED_SHORT&&(Ir=n.R16UI),dr===n.UNSIGNED_INT&&(Ir=n.R32UI),dr===n.BYTE&&(Ir=n.R8I),dr===n.SHORT&&(Ir=n.R16I),dr===n.INT&&(Ir=n.R32I)),ut===n.RG&&(dr===n.FLOAT&&(Ir=n.RG32F),dr===n.HALF_FLOAT&&(Ir=n.RG16F),dr===n.UNSIGNED_BYTE&&(Ir=n.RG8)),ut===n.RG_INTEGER&&(dr===n.UNSIGNED_BYTE&&(Ir=n.RG8UI),dr===n.UNSIGNED_SHORT&&(Ir=n.RG16UI),dr===n.UNSIGNED_INT&&(Ir=n.RG32UI),dr===n.BYTE&&(Ir=n.RG8I),dr===n.SHORT&&(Ir=n.RG16I),dr===n.INT&&(Ir=n.RG32I)),ut===n.RGB_INTEGER&&(dr===n.UNSIGNED_BYTE&&(Ir=n.RGB8UI),dr===n.UNSIGNED_SHORT&&(Ir=n.RGB16UI),dr===n.UNSIGNED_INT&&(Ir=n.RGB32UI),dr===n.BYTE&&(Ir=n.RGB8I),dr===n.SHORT&&(Ir=n.RGB16I),dr===n.INT&&(Ir=n.RGB32I)),ut===n.RGBA_INTEGER&&(dr===n.UNSIGNED_BYTE&&(Ir=n.RGBA8UI),dr===n.UNSIGNED_SHORT&&(Ir=n.RGBA16UI),dr===n.UNSIGNED_INT&&(Ir=n.RGBA32UI),dr===n.BYTE&&(Ir=n.RGBA8I),dr===n.SHORT&&(Ir=n.RGBA16I),dr===n.INT&&(Ir=n.RGBA32I)),ut===n.RGB&&dr===n.UNSIGNED_INT_5_9_9_9_REV&&(Ir=n.RGB9_E5),ut===n.RGBA){const Nn=qr?Ch:Ya.getTransfer(kr);dr===n.FLOAT&&(Ir=n.RGBA32F),dr===n.HALF_FLOAT&&(Ir=n.RGBA16F),dr===n.UNSIGNED_BYTE&&(Ir=Nn===gi?n.SRGB8_ALPHA8:n.RGBA8),dr===n.UNSIGNED_SHORT_4_4_4_4&&(Ir=n.RGBA4),dr===n.UNSIGNED_SHORT_5_5_5_1&&(Ir=n.RGB5_A1)}return(Ir===n.R16F||Ir===n.R32F||Ir===n.RG16F||Ir===n.RG32F||Ir===n.RGBA16F||Ir===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Ir}function qe(Dt,ut){let dr;return Dt?ut===null||ut===Il||ut===Hc?dr=n.DEPTH24_STENCIL8:ut===ms?dr=n.DEPTH32F_STENCIL8:ut===Gu&&(dr=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):ut===null||ut===Il||ut===Hc?dr=n.DEPTH_COMPONENT24:ut===ms?dr=n.DEPTH_COMPONENT32F:ut===Gu&&(dr=n.DEPTH_COMPONENT16),dr}function $e(Dt,ut){return Se(Dt)===!0||Dt.isFramebufferTexture&&Dt.minFilter!==To&&Dt.minFilter!==xo?Math.log2(Math.max(ut.width,ut.height))+1:Dt.mipmaps!==void 0&&Dt.mipmaps.length>0?Dt.mipmaps.length:Dt.isCompressedTexture&&Array.isArray(Dt.image)?ut.mipmaps.length:1}function ft(Dt){const ut=Dt.target;ut.removeEventListener("dispose",ft),pt(ut),ut.isVideoTexture&&q.delete(ut)}function gt(Dt){const ut=Dt.target;ut.removeEventListener("dispose",gt),ur(ut)}function pt(Dt){const ut=r.get(Dt);if(ut.__webglInit===void 0)return;const dr=Dt.source,kr=ue.get(dr);if(kr){const qr=kr[ut.__cacheKey];qr.usedTimes--,qr.usedTimes===0&&Ht(Dt),Object.keys(kr).length===0&&ue.delete(dr)}r.remove(Dt)}function Ht(Dt){const ut=r.get(Dt);n.deleteTexture(ut.__webglTexture);const dr=Dt.source,kr=ue.get(dr);delete kr[ut.__cacheKey],x.memory.textures--}function ur(Dt){const ut=r.get(Dt);if(Dt.depthTexture&&Dt.depthTexture.dispose(),Dt.isWebGLCubeRenderTarget)for(let kr=0;kr<6;kr++){if(Array.isArray(ut.__webglFramebuffer[kr]))for(let qr=0;qr<ut.__webglFramebuffer[kr].length;qr++)n.deleteFramebuffer(ut.__webglFramebuffer[kr][qr]);else n.deleteFramebuffer(ut.__webglFramebuffer[kr]);ut.__webglDepthbuffer&&n.deleteRenderbuffer(ut.__webglDepthbuffer[kr])}else{if(Array.isArray(ut.__webglFramebuffer))for(let kr=0;kr<ut.__webglFramebuffer.length;kr++)n.deleteFramebuffer(ut.__webglFramebuffer[kr]);else n.deleteFramebuffer(ut.__webglFramebuffer);if(ut.__webglDepthbuffer&&n.deleteRenderbuffer(ut.__webglDepthbuffer),ut.__webglMultisampledFramebuffer&&n.deleteFramebuffer(ut.__webglMultisampledFramebuffer),ut.__webglColorRenderbuffer)for(let kr=0;kr<ut.__webglColorRenderbuffer.length;kr++)ut.__webglColorRenderbuffer[kr]&&n.deleteRenderbuffer(ut.__webglColorRenderbuffer[kr]);ut.__webglDepthRenderbuffer&&n.deleteRenderbuffer(ut.__webglDepthRenderbuffer)}const dr=Dt.textures;for(let kr=0,qr=dr.length;kr<qr;kr++){const Ir=r.get(dr[kr]);Ir.__webglTexture&&(n.deleteTexture(Ir.__webglTexture),x.memory.textures--),r.remove(dr[kr])}r.remove(Dt)}let Ve=0;function nt(){Ve=0}function nr(){const Dt=Ve;return Dt>=a.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Dt+" texture units while this GPU supports only "+a.maxTextures),Ve+=1,Dt}function Zt(Dt){const ut=[];return ut.push(Dt.wrapS),ut.push(Dt.wrapT),ut.push(Dt.wrapR||0),ut.push(Dt.magFilter),ut.push(Dt.minFilter),ut.push(Dt.anisotropy),ut.push(Dt.internalFormat),ut.push(Dt.format),ut.push(Dt.type),ut.push(Dt.generateMipmaps),ut.push(Dt.premultiplyAlpha),ut.push(Dt.flipY),ut.push(Dt.unpackAlignment),ut.push(Dt.colorSpace),ut.join()}function Xt(Dt,ut){const dr=r.get(Dt);if(Dt.isVideoTexture&&ra(Dt),Dt.isRenderTargetTexture===!1&&Dt.version>0&&dr.__version!==Dt.version){const kr=Dt.image;if(kr===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(kr.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{zn(dr,Dt,ut);return}}t.bindTexture(n.TEXTURE_2D,dr.__webglTexture,n.TEXTURE0+ut)}function Pr(Dt,ut){const dr=r.get(Dt);if(Dt.version>0&&dr.__version!==Dt.version){zn(dr,Dt,ut);return}t.bindTexture(n.TEXTURE_2D_ARRAY,dr.__webglTexture,n.TEXTURE0+ut)}function cr(Dt,ut){const dr=r.get(Dt);if(Dt.version>0&&dr.__version!==Dt.version){zn(dr,Dt,ut);return}t.bindTexture(n.TEXTURE_3D,dr.__webglTexture,n.TEXTURE0+ut)}function Qr(Dt,ut){const dr=r.get(Dt);if(Dt.version>0&&dr.__version!==Dt.version){Or(dr,Dt,ut);return}t.bindTexture(n.TEXTURE_CUBE_MAP,dr.__webglTexture,n.TEXTURE0+ut)}const Tr={[Kp]:n.REPEAT,[Ol]:n.CLAMP_TO_EDGE,[$p]:n.MIRRORED_REPEAT},ln={[To]:n.NEAREST,[gw]:n.NEAREST_MIPMAP_NEAREST,[kd]:n.NEAREST_MIPMAP_LINEAR,[xo]:n.LINEAR,[Xf]:n.LINEAR_MIPMAP_NEAREST,[Nl]:n.LINEAR_MIPMAP_LINEAR},Sn={[_w]:n.NEVER,[Sw]:n.ALWAYS,[bw]:n.LESS,[c2]:n.LEQUAL,[ww]:n.EQUAL,[Aw]:n.GEQUAL,[Mw]:n.GREATER,[Tw]:n.NOTEQUAL};function Wn(Dt,ut){if(ut.type===ms&&e.has("OES_texture_float_linear")===!1&&(ut.magFilter===xo||ut.magFilter===Xf||ut.magFilter===kd||ut.magFilter===Nl||ut.minFilter===xo||ut.minFilter===Xf||ut.minFilter===kd||ut.minFilter===Nl)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(Dt,n.TEXTURE_WRAP_S,Tr[ut.wrapS]),n.texParameteri(Dt,n.TEXTURE_WRAP_T,Tr[ut.wrapT]),(Dt===n.TEXTURE_3D||Dt===n.TEXTURE_2D_ARRAY)&&n.texParameteri(Dt,n.TEXTURE_WRAP_R,Tr[ut.wrapR]),n.texParameteri(Dt,n.TEXTURE_MAG_FILTER,ln[ut.magFilter]),n.texParameteri(Dt,n.TEXTURE_MIN_FILTER,ln[ut.minFilter]),ut.compareFunction&&(n.texParameteri(Dt,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(Dt,n.TEXTURE_COMPARE_FUNC,Sn[ut.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(ut.magFilter===To||ut.minFilter!==kd&&ut.minFilter!==Nl||ut.type===ms&&e.has("OES_texture_float_linear")===!1)return;if(ut.anisotropy>1||r.get(ut).__currentAnisotropy){const dr=e.get("EXT_texture_filter_anisotropic");n.texParameterf(Dt,dr.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ut.anisotropy,a.getMaxAnisotropy())),r.get(ut).__currentAnisotropy=ut.anisotropy}}}function Ma(Dt,ut){let dr=!1;Dt.__webglInit===void 0&&(Dt.__webglInit=!0,ut.addEventListener("dispose",ft));const kr=ut.source;let qr=ue.get(kr);qr===void 0&&(qr={},ue.set(kr,qr));const Ir=Zt(ut);if(Ir!==Dt.__cacheKey){qr[Ir]===void 0&&(qr[Ir]={texture:n.createTexture(),usedTimes:0},x.memory.textures++,dr=!0),qr[Ir].usedTimes++;const Nn=qr[Dt.__cacheKey];Nn!==void 0&&(qr[Dt.__cacheKey].usedTimes--,Nn.usedTimes===0&&Ht(ut)),Dt.__cacheKey=Ir,Dt.__webglTexture=qr[Ir].texture}return dr}function zn(Dt,ut,dr){let kr=n.TEXTURE_2D;(ut.isDataArrayTexture||ut.isCompressedArrayTexture)&&(kr=n.TEXTURE_2D_ARRAY),ut.isData3DTexture&&(kr=n.TEXTURE_3D);const qr=Ma(Dt,ut),Ir=ut.source;t.bindTexture(kr,Dt.__webglTexture,n.TEXTURE0+dr);const Nn=r.get(Ir);if(Ir.version!==Nn.__version||qr===!0){t.activeTexture(n.TEXTURE0+dr);const hn=Ya.getPrimaries(Ya.workingColorSpace),wn=ut.colorSpace===$s?null:Ya.getPrimaries(ut.colorSpace),pa=ut.colorSpace===$s||hn===wn?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,ut.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ut.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,ut.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,pa);let en=Pe(ut.image,!1,a.maxTextureSize);en=Ga(ut,en);const Rn=l.convert(ut.format,ut.colorSpace),Kn=l.convert(ut.type);let $n=Xe(ut.internalFormat,Rn,Kn,ut.colorSpace,ut.isVideoTexture);Wn(kr,ut);let Mn;const Xn=ut.mipmaps,Ft=ut.isVideoTexture!==!0,Wr=Nn.__version===void 0||qr===!0,qt=Ir.dataReady,jr=$e(ut,en);if(ut.isDepthTexture)$n=qe(ut.format===Vc,ut.type),Wr&&(Ft?t.texStorage2D(n.TEXTURE_2D,1,$n,en.width,en.height):t.texImage2D(n.TEXTURE_2D,0,$n,en.width,en.height,0,Rn,Kn,null));else if(ut.isDataTexture)if(Xn.length>0){Ft&&Wr&&t.texStorage2D(n.TEXTURE_2D,jr,$n,Xn[0].width,Xn[0].height);for(let mr=0,Nr=Xn.length;mr<Nr;mr++)Mn=Xn[mr],Ft?qt&&t.texSubImage2D(n.TEXTURE_2D,mr,0,0,Mn.width,Mn.height,Rn,Kn,Mn.data):t.texImage2D(n.TEXTURE_2D,mr,$n,Mn.width,Mn.height,0,Rn,Kn,Mn.data);ut.generateMipmaps=!1}else Ft?(Wr&&t.texStorage2D(n.TEXTURE_2D,jr,$n,en.width,en.height),qt&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,en.width,en.height,Rn,Kn,en.data)):t.texImage2D(n.TEXTURE_2D,0,$n,en.width,en.height,0,Rn,Kn,en.data);else if(ut.isCompressedTexture)if(ut.isCompressedArrayTexture){Ft&&Wr&&t.texStorage3D(n.TEXTURE_2D_ARRAY,jr,$n,Xn[0].width,Xn[0].height,en.depth);for(let mr=0,Nr=Xn.length;mr<Nr;mr++)if(Mn=Xn[mr],ut.format!==Uo)if(Rn!==null)if(Ft){if(qt)if(ut.layerUpdates.size>0){const cn=yv(Mn.width,Mn.height,ut.format,ut.type);for(const nn of ut.layerUpdates){const Sa=Mn.data.subarray(nn*cn/Mn.data.BYTES_PER_ELEMENT,(nn+1)*cn/Mn.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,mr,0,0,nn,Mn.width,Mn.height,1,Rn,Sa,0,0)}ut.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,mr,0,0,0,Mn.width,Mn.height,en.depth,Rn,Mn.data,0,0)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,mr,$n,Mn.width,Mn.height,en.depth,0,Mn.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Ft?qt&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,mr,0,0,0,Mn.width,Mn.height,en.depth,Rn,Kn,Mn.data):t.texImage3D(n.TEXTURE_2D_ARRAY,mr,$n,Mn.width,Mn.height,en.depth,0,Rn,Kn,Mn.data)}else{Ft&&Wr&&t.texStorage2D(n.TEXTURE_2D,jr,$n,Xn[0].width,Xn[0].height);for(let mr=0,Nr=Xn.length;mr<Nr;mr++)Mn=Xn[mr],ut.format!==Uo?Rn!==null?Ft?qt&&t.compressedTexSubImage2D(n.TEXTURE_2D,mr,0,0,Mn.width,Mn.height,Rn,Mn.data):t.compressedTexImage2D(n.TEXTURE_2D,mr,$n,Mn.width,Mn.height,0,Mn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ft?qt&&t.texSubImage2D(n.TEXTURE_2D,mr,0,0,Mn.width,Mn.height,Rn,Kn,Mn.data):t.texImage2D(n.TEXTURE_2D,mr,$n,Mn.width,Mn.height,0,Rn,Kn,Mn.data)}else if(ut.isDataArrayTexture)if(Ft){if(Wr&&t.texStorage3D(n.TEXTURE_2D_ARRAY,jr,$n,en.width,en.height,en.depth),qt)if(ut.layerUpdates.size>0){const mr=yv(en.width,en.height,ut.format,ut.type);for(const Nr of ut.layerUpdates){const cn=en.data.subarray(Nr*mr/en.data.BYTES_PER_ELEMENT,(Nr+1)*mr/en.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,Nr,en.width,en.height,1,Rn,Kn,cn)}ut.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,en.width,en.height,en.depth,Rn,Kn,en.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,$n,en.width,en.height,en.depth,0,Rn,Kn,en.data);else if(ut.isData3DTexture)Ft?(Wr&&t.texStorage3D(n.TEXTURE_3D,jr,$n,en.width,en.height,en.depth),qt&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,en.width,en.height,en.depth,Rn,Kn,en.data)):t.texImage3D(n.TEXTURE_3D,0,$n,en.width,en.height,en.depth,0,Rn,Kn,en.data);else if(ut.isFramebufferTexture){if(Wr)if(Ft)t.texStorage2D(n.TEXTURE_2D,jr,$n,en.width,en.height);else{let mr=en.width,Nr=en.height;for(let cn=0;cn<jr;cn++)t.texImage2D(n.TEXTURE_2D,cn,$n,mr,Nr,0,Rn,Kn,null),mr>>=1,Nr>>=1}}else if(Xn.length>0){if(Ft&&Wr){const mr=na(Xn[0]);t.texStorage2D(n.TEXTURE_2D,jr,$n,mr.width,mr.height)}for(let mr=0,Nr=Xn.length;mr<Nr;mr++)Mn=Xn[mr],Ft?qt&&t.texSubImage2D(n.TEXTURE_2D,mr,0,0,Rn,Kn,Mn):t.texImage2D(n.TEXTURE_2D,mr,$n,Rn,Kn,Mn);ut.generateMipmaps=!1}else if(Ft){if(Wr){const mr=na(en);t.texStorage2D(n.TEXTURE_2D,jr,$n,mr.width,mr.height)}qt&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Rn,Kn,en)}else t.texImage2D(n.TEXTURE_2D,0,$n,Rn,Kn,en);Se(ut)&&Ee(kr),Nn.__version=Ir.version,ut.onUpdate&&ut.onUpdate(ut)}Dt.__version=ut.version}function Or(Dt,ut,dr){if(ut.image.length!==6)return;const kr=Ma(Dt,ut),qr=ut.source;t.bindTexture(n.TEXTURE_CUBE_MAP,Dt.__webglTexture,n.TEXTURE0+dr);const Ir=r.get(qr);if(qr.version!==Ir.__version||kr===!0){t.activeTexture(n.TEXTURE0+dr);const Nn=Ya.getPrimaries(Ya.workingColorSpace),hn=ut.colorSpace===$s?null:Ya.getPrimaries(ut.colorSpace),wn=ut.colorSpace===$s||Nn===hn?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,ut.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ut.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,ut.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,wn);const pa=ut.isCompressedTexture||ut.image[0].isCompressedTexture,en=ut.image[0]&&ut.image[0].isDataTexture,Rn=[];for(let Nr=0;Nr<6;Nr++)!pa&&!en?Rn[Nr]=Pe(ut.image[Nr],!0,a.maxCubemapSize):Rn[Nr]=en?ut.image[Nr].image:ut.image[Nr],Rn[Nr]=Ga(ut,Rn[Nr]);const Kn=Rn[0],$n=l.convert(ut.format,ut.colorSpace),Mn=l.convert(ut.type),Xn=Xe(ut.internalFormat,$n,Mn,ut.colorSpace),Ft=ut.isVideoTexture!==!0,Wr=Ir.__version===void 0||kr===!0,qt=qr.dataReady;let jr=$e(ut,Kn);Wn(n.TEXTURE_CUBE_MAP,ut);let mr;if(pa){Ft&&Wr&&t.texStorage2D(n.TEXTURE_CUBE_MAP,jr,Xn,Kn.width,Kn.height);for(let Nr=0;Nr<6;Nr++){mr=Rn[Nr].mipmaps;for(let cn=0;cn<mr.length;cn++){const nn=mr[cn];ut.format!==Uo?$n!==null?Ft?qt&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Nr,cn,0,0,nn.width,nn.height,$n,nn.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Nr,cn,Xn,nn.width,nn.height,0,nn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ft?qt&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Nr,cn,0,0,nn.width,nn.height,$n,Mn,nn.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Nr,cn,Xn,nn.width,nn.height,0,$n,Mn,nn.data)}}}else{if(mr=ut.mipmaps,Ft&&Wr){mr.length>0&&jr++;const Nr=na(Rn[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,jr,Xn,Nr.width,Nr.height)}for(let Nr=0;Nr<6;Nr++)if(en){Ft?qt&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Nr,0,0,0,Rn[Nr].width,Rn[Nr].height,$n,Mn,Rn[Nr].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Nr,0,Xn,Rn[Nr].width,Rn[Nr].height,0,$n,Mn,Rn[Nr].data);for(let cn=0;cn<mr.length;cn++){const nn=mr[cn].image[Nr].image;Ft?qt&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Nr,cn+1,0,0,nn.width,nn.height,$n,Mn,nn.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Nr,cn+1,Xn,nn.width,nn.height,0,$n,Mn,nn.data)}}else{Ft?qt&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Nr,0,0,0,$n,Mn,Rn[Nr]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Nr,0,Xn,$n,Mn,Rn[Nr]);for(let cn=0;cn<mr.length;cn++){const nn=mr[cn];Ft?qt&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Nr,cn+1,0,0,$n,Mn,nn.image[Nr]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Nr,cn+1,Xn,$n,Mn,nn.image[Nr])}}}Se(ut)&&Ee(n.TEXTURE_CUBE_MAP),Ir.__version=qr.version,ut.onUpdate&&ut.onUpdate(ut)}Dt.__version=ut.version}function $r(Dt,ut,dr,kr,qr,Ir){const Nn=l.convert(dr.format,dr.colorSpace),hn=l.convert(dr.type),wn=Xe(dr.internalFormat,Nn,hn,dr.colorSpace);if(!r.get(ut).__hasExternalTextures){const pa=Math.max(1,ut.width>>Ir),en=Math.max(1,ut.height>>Ir);qr===n.TEXTURE_3D||qr===n.TEXTURE_2D_ARRAY?t.texImage3D(qr,Ir,wn,pa,en,ut.depth,0,Nn,hn,null):t.texImage2D(qr,Ir,wn,pa,en,0,Nn,hn,null)}t.bindFramebuffer(n.FRAMEBUFFER,Dt),ya(ut)?_.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,kr,qr,r.get(dr).__webglTexture,0,fa(ut)):(qr===n.TEXTURE_2D||qr>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&qr<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,kr,qr,r.get(dr).__webglTexture,Ir),t.bindFramebuffer(n.FRAMEBUFFER,null)}function En(Dt,ut,dr){if(n.bindRenderbuffer(n.RENDERBUFFER,Dt),ut.depthBuffer){const kr=ut.depthTexture,qr=kr&&kr.isDepthTexture?kr.type:null,Ir=qe(ut.stencilBuffer,qr),Nn=ut.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,hn=fa(ut);ya(ut)?_.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,hn,Ir,ut.width,ut.height):dr?n.renderbufferStorageMultisample(n.RENDERBUFFER,hn,Ir,ut.width,ut.height):n.renderbufferStorage(n.RENDERBUFFER,Ir,ut.width,ut.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,Nn,n.RENDERBUFFER,Dt)}else{const kr=ut.textures;for(let qr=0;qr<kr.length;qr++){const Ir=kr[qr],Nn=l.convert(Ir.format,Ir.colorSpace),hn=l.convert(Ir.type),wn=Xe(Ir.internalFormat,Nn,hn,Ir.colorSpace),pa=fa(ut);dr&&ya(ut)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,pa,wn,ut.width,ut.height):ya(ut)?_.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,pa,wn,ut.width,ut.height):n.renderbufferStorage(n.RENDERBUFFER,wn,ut.width,ut.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Ln(Dt,ut){if(ut&&ut.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,Dt),!(ut.depthTexture&&ut.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(ut.depthTexture).__webglTexture||ut.depthTexture.image.width!==ut.width||ut.depthTexture.image.height!==ut.height)&&(ut.depthTexture.image.width=ut.width,ut.depthTexture.image.height=ut.height,ut.depthTexture.needsUpdate=!0),Xt(ut.depthTexture,0);const dr=r.get(ut.depthTexture).__webglTexture,kr=fa(ut);if(ut.depthTexture.format===Ic)ya(ut)?_.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,dr,0,kr):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,dr,0);else if(ut.depthTexture.format===Vc)ya(ut)?_.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,dr,0,kr):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,dr,0);else throw new Error("Unknown depthTexture format")}function ta(Dt){const ut=r.get(Dt),dr=Dt.isWebGLCubeRenderTarget===!0;if(ut.__boundDepthTexture!==Dt.depthTexture){const kr=Dt.depthTexture;if(ut.__depthDisposeCallback&&ut.__depthDisposeCallback(),kr){const qr=()=>{delete ut.__boundDepthTexture,delete ut.__depthDisposeCallback,kr.removeEventListener("dispose",qr)};kr.addEventListener("dispose",qr),ut.__depthDisposeCallback=qr}ut.__boundDepthTexture=kr}if(Dt.depthTexture&&!ut.__autoAllocateDepthBuffer){if(dr)throw new Error("target.depthTexture not supported in Cube render targets");Ln(ut.__webglFramebuffer,Dt)}else if(dr){ut.__webglDepthbuffer=[];for(let kr=0;kr<6;kr++)if(t.bindFramebuffer(n.FRAMEBUFFER,ut.__webglFramebuffer[kr]),ut.__webglDepthbuffer[kr]===void 0)ut.__webglDepthbuffer[kr]=n.createRenderbuffer(),En(ut.__webglDepthbuffer[kr],Dt,!1);else{const qr=Dt.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ir=ut.__webglDepthbuffer[kr];n.bindRenderbuffer(n.RENDERBUFFER,Ir),n.framebufferRenderbuffer(n.FRAMEBUFFER,qr,n.RENDERBUFFER,Ir)}}else if(t.bindFramebuffer(n.FRAMEBUFFER,ut.__webglFramebuffer),ut.__webglDepthbuffer===void 0)ut.__webglDepthbuffer=n.createRenderbuffer(),En(ut.__webglDepthbuffer,Dt,!1);else{const kr=Dt.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,qr=ut.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,qr),n.framebufferRenderbuffer(n.FRAMEBUFFER,kr,n.RENDERBUFFER,qr)}t.bindFramebuffer(n.FRAMEBUFFER,null)}function Jn(Dt,ut,dr){const kr=r.get(Dt);ut!==void 0&&$r(kr.__webglFramebuffer,Dt,Dt.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),dr!==void 0&&ta(Dt)}function da(Dt){const ut=Dt.texture,dr=r.get(Dt),kr=r.get(ut);Dt.addEventListener("dispose",gt);const qr=Dt.textures,Ir=Dt.isWebGLCubeRenderTarget===!0,Nn=qr.length>1;if(Nn||(kr.__webglTexture===void 0&&(kr.__webglTexture=n.createTexture()),kr.__version=ut.version,x.memory.textures++),Ir){dr.__webglFramebuffer=[];for(let hn=0;hn<6;hn++)if(ut.mipmaps&&ut.mipmaps.length>0){dr.__webglFramebuffer[hn]=[];for(let wn=0;wn<ut.mipmaps.length;wn++)dr.__webglFramebuffer[hn][wn]=n.createFramebuffer()}else dr.__webglFramebuffer[hn]=n.createFramebuffer()}else{if(ut.mipmaps&&ut.mipmaps.length>0){dr.__webglFramebuffer=[];for(let hn=0;hn<ut.mipmaps.length;hn++)dr.__webglFramebuffer[hn]=n.createFramebuffer()}else dr.__webglFramebuffer=n.createFramebuffer();if(Nn)for(let hn=0,wn=qr.length;hn<wn;hn++){const pa=r.get(qr[hn]);pa.__webglTexture===void 0&&(pa.__webglTexture=n.createTexture(),x.memory.textures++)}if(Dt.samples>0&&ya(Dt)===!1){dr.__webglMultisampledFramebuffer=n.createFramebuffer(),dr.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,dr.__webglMultisampledFramebuffer);for(let hn=0;hn<qr.length;hn++){const wn=qr[hn];dr.__webglColorRenderbuffer[hn]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,dr.__webglColorRenderbuffer[hn]);const pa=l.convert(wn.format,wn.colorSpace),en=l.convert(wn.type),Rn=Xe(wn.internalFormat,pa,en,wn.colorSpace,Dt.isXRRenderTarget===!0),Kn=fa(Dt);n.renderbufferStorageMultisample(n.RENDERBUFFER,Kn,Rn,Dt.width,Dt.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+hn,n.RENDERBUFFER,dr.__webglColorRenderbuffer[hn])}n.bindRenderbuffer(n.RENDERBUFFER,null),Dt.depthBuffer&&(dr.__webglDepthRenderbuffer=n.createRenderbuffer(),En(dr.__webglDepthRenderbuffer,Dt,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Ir){t.bindTexture(n.TEXTURE_CUBE_MAP,kr.__webglTexture),Wn(n.TEXTURE_CUBE_MAP,ut);for(let hn=0;hn<6;hn++)if(ut.mipmaps&&ut.mipmaps.length>0)for(let wn=0;wn<ut.mipmaps.length;wn++)$r(dr.__webglFramebuffer[hn][wn],Dt,ut,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+hn,wn);else $r(dr.__webglFramebuffer[hn],Dt,ut,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+hn,0);Se(ut)&&Ee(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Nn){for(let hn=0,wn=qr.length;hn<wn;hn++){const pa=qr[hn],en=r.get(pa);t.bindTexture(n.TEXTURE_2D,en.__webglTexture),Wn(n.TEXTURE_2D,pa),$r(dr.__webglFramebuffer,Dt,pa,n.COLOR_ATTACHMENT0+hn,n.TEXTURE_2D,0),Se(pa)&&Ee(n.TEXTURE_2D)}t.unbindTexture()}else{let hn=n.TEXTURE_2D;if((Dt.isWebGL3DRenderTarget||Dt.isWebGLArrayRenderTarget)&&(hn=Dt.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(hn,kr.__webglTexture),Wn(hn,ut),ut.mipmaps&&ut.mipmaps.length>0)for(let wn=0;wn<ut.mipmaps.length;wn++)$r(dr.__webglFramebuffer[wn],Dt,ut,n.COLOR_ATTACHMENT0,hn,wn);else $r(dr.__webglFramebuffer,Dt,ut,n.COLOR_ATTACHMENT0,hn,0);Se(ut)&&Ee(hn),t.unbindTexture()}Dt.depthBuffer&&ta(Dt)}function La(Dt){const ut=Dt.textures;for(let dr=0,kr=ut.length;dr<kr;dr++){const qr=ut[dr];if(Se(qr)){const Ir=Dt.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Nn=r.get(qr).__webglTexture;t.bindTexture(Ir,Nn),Ee(Ir),t.unbindTexture()}}}const ga=[],tr=[];function Ni(Dt){if(Dt.samples>0){if(ya(Dt)===!1){const ut=Dt.textures,dr=Dt.width,kr=Dt.height;let qr=n.COLOR_BUFFER_BIT;const Ir=Dt.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Nn=r.get(Dt),hn=ut.length>1;if(hn)for(let wn=0;wn<ut.length;wn++)t.bindFramebuffer(n.FRAMEBUFFER,Nn.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+wn,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Nn.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+wn,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Nn.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Nn.__webglFramebuffer);for(let wn=0;wn<ut.length;wn++){if(Dt.resolveDepthBuffer&&(Dt.depthBuffer&&(qr|=n.DEPTH_BUFFER_BIT),Dt.stencilBuffer&&Dt.resolveStencilBuffer&&(qr|=n.STENCIL_BUFFER_BIT)),hn){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Nn.__webglColorRenderbuffer[wn]);const pa=r.get(ut[wn]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,pa,0)}n.blitFramebuffer(0,0,dr,kr,0,0,dr,kr,qr,n.NEAREST),O===!0&&(ga.length=0,tr.length=0,ga.push(n.COLOR_ATTACHMENT0+wn),Dt.depthBuffer&&Dt.resolveDepthBuffer===!1&&(ga.push(Ir),tr.push(Ir),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,tr)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,ga))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),hn)for(let wn=0;wn<ut.length;wn++){t.bindFramebuffer(n.FRAMEBUFFER,Nn.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+wn,n.RENDERBUFFER,Nn.__webglColorRenderbuffer[wn]);const pa=r.get(ut[wn]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Nn.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+wn,n.TEXTURE_2D,pa,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Nn.__webglMultisampledFramebuffer)}else if(Dt.depthBuffer&&Dt.resolveDepthBuffer===!1&&O){const ut=Dt.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[ut])}}}function fa(Dt){return Math.min(a.maxSamples,Dt.samples)}function ya(Dt){const ut=r.get(Dt);return Dt.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ut.__useRenderToTexture!==!1}function ra(Dt){const ut=x.render.frame;q.get(Dt)!==ut&&(q.set(Dt,ut),Dt.update())}function Ga(Dt,ut){const dr=Dt.colorSpace,kr=Dt.format,qr=Dt.type;return Dt.isCompressedTexture===!0||Dt.isVideoTexture===!0||dr!==ol&&dr!==$s&&(Ya.getTransfer(dr)===gi?(kr!==Uo||qr!==Is)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",dr)),ut}function na(Dt){return typeof HTMLImageElement<"u"&&Dt instanceof HTMLImageElement?(z.width=Dt.naturalWidth||Dt.width,z.height=Dt.naturalHeight||Dt.height):typeof VideoFrame<"u"&&Dt instanceof VideoFrame?(z.width=Dt.displayWidth,z.height=Dt.displayHeight):(z.width=Dt.width,z.height=Dt.height),z}this.allocateTextureUnit=nr,this.resetTextureUnits=nt,this.setTexture2D=Xt,this.setTexture2DArray=Pr,this.setTexture3D=cr,this.setTextureCube=Qr,this.rebindTextures=Jn,this.setupRenderTarget=da,this.updateRenderTargetMipmap=La,this.updateMultisampleRenderTarget=Ni,this.setupDepthRenderbuffer=ta,this.setupFrameBufferTexture=$r,this.useMultisampledRTT=ya}function YA(n,e){function t(r,a=$s){let l;const x=Ya.getTransfer(a);if(r===Is)return n.UNSIGNED_BYTE;if(r===sm)return n.UNSIGNED_SHORT_4_4_4_4;if(r===lm)return n.UNSIGNED_SHORT_5_5_5_1;if(r===r2)return n.UNSIGNED_INT_5_9_9_9_REV;if(r===e2)return n.BYTE;if(r===t2)return n.SHORT;if(r===Gu)return n.UNSIGNED_SHORT;if(r===om)return n.INT;if(r===Il)return n.UNSIGNED_INT;if(r===ms)return n.FLOAT;if(r===Zu)return n.HALF_FLOAT;if(r===n2)return n.ALPHA;if(r===a2)return n.RGB;if(r===Uo)return n.RGBA;if(r===i2)return n.LUMINANCE;if(r===o2)return n.LUMINANCE_ALPHA;if(r===Ic)return n.DEPTH_COMPONENT;if(r===Vc)return n.DEPTH_STENCIL;if(r===cm)return n.RED;if(r===um)return n.RED_INTEGER;if(r===s2)return n.RG;if(r===dm)return n.RG_INTEGER;if(r===hm)return n.RGBA_INTEGER;if(r===vh||r===yh||r===xh||r===_h)if(x===gi)if(l=e.get("WEBGL_compressed_texture_s3tc_srgb"),l!==null){if(r===vh)return l.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===yh)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===xh)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===_h)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(l=e.get("WEBGL_compressed_texture_s3tc"),l!==null){if(r===vh)return l.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===yh)return l.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===xh)return l.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===_h)return l.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===e0||r===t0||r===r0||r===n0)if(l=e.get("WEBGL_compressed_texture_pvrtc"),l!==null){if(r===e0)return l.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===t0)return l.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===r0)return l.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===n0)return l.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===a0||r===i0||r===o0)if(l=e.get("WEBGL_compressed_texture_etc"),l!==null){if(r===a0||r===i0)return x===gi?l.COMPRESSED_SRGB8_ETC2:l.COMPRESSED_RGB8_ETC2;if(r===o0)return x===gi?l.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:l.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(r===s0||r===l0||r===c0||r===u0||r===d0||r===h0||r===f0||r===p0||r===m0||r===g0||r===v0||r===y0||r===x0||r===_0)if(l=e.get("WEBGL_compressed_texture_astc"),l!==null){if(r===s0)return x===gi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:l.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===l0)return x===gi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:l.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===c0)return x===gi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:l.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===u0)return x===gi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:l.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===d0)return x===gi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:l.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===h0)return x===gi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:l.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===f0)return x===gi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:l.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===p0)return x===gi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:l.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===m0)return x===gi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:l.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===g0)return x===gi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:l.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===v0)return x===gi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:l.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===y0)return x===gi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:l.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===x0)return x===gi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:l.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===_0)return x===gi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:l.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===bh||r===b0||r===w0)if(l=e.get("EXT_texture_compression_bptc"),l!==null){if(r===bh)return x===gi?l.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:l.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===b0)return l.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===w0)return l.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===l2||r===M0||r===T0||r===A0)if(l=e.get("EXT_texture_compression_rgtc"),l!==null){if(r===bh)return l.COMPRESSED_RED_RGTC1_EXT;if(r===M0)return l.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===T0)return l.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===A0)return l.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===Hc?n.UNSIGNED_INT_24_8:n[r]!==void 0?n[r]:null}return{convert:t}}class qA extends Ro{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class gs extends Ei{constructor(){super(),this.isGroup=!0,this.type="Group"}}const JA={type:"move"};class Mp{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new gs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new gs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new st,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new st),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new gs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new st,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new st),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let a=null,l=null,x=null;const _=this._targetRay,O=this._grip,z=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(z&&e.hand){x=!0;for(const Pe of e.hand.values()){const Se=t.getJointPose(Pe,r),Ee=this._getHandJoint(z,Pe);Se!==null&&(Ee.matrix.fromArray(Se.transform.matrix),Ee.matrix.decompose(Ee.position,Ee.rotation,Ee.scale),Ee.matrixWorldNeedsUpdate=!0,Ee.jointRadius=Se.radius),Ee.visible=Se!==null}const q=z.joints["index-finger-tip"],oe=z.joints["thumb-tip"],ue=q.position.distanceTo(oe.position),_e=.02,be=.005;z.inputState.pinching&&ue>_e+be?(z.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!z.inputState.pinching&&ue<=_e-be&&(z.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else O!==null&&e.gripSpace&&(l=t.getPose(e.gripSpace,r),l!==null&&(O.matrix.fromArray(l.transform.matrix),O.matrix.decompose(O.position,O.rotation,O.scale),O.matrixWorldNeedsUpdate=!0,l.linearVelocity?(O.hasLinearVelocity=!0,O.linearVelocity.copy(l.linearVelocity)):O.hasLinearVelocity=!1,l.angularVelocity?(O.hasAngularVelocity=!0,O.angularVelocity.copy(l.angularVelocity)):O.hasAngularVelocity=!1));_!==null&&(a=t.getPose(e.targetRaySpace,r),a===null&&l!==null&&(a=l),a!==null&&(_.matrix.fromArray(a.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),_.matrixWorldNeedsUpdate=!0,a.linearVelocity?(_.hasLinearVelocity=!0,_.linearVelocity.copy(a.linearVelocity)):_.hasLinearVelocity=!1,a.angularVelocity?(_.hasAngularVelocity=!0,_.angularVelocity.copy(a.angularVelocity)):_.hasAngularVelocity=!1,this.dispatchEvent(JA)))}return _!==null&&(_.visible=a!==null),O!==null&&(O.visible=l!==null),z!==null&&(z.visible=x!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new gs;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}const XA=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,ZA=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class QA{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,r){if(this.texture===null){const a=new uo,l=e.properties.get(a);l.__webglTexture=t.texture,(t.depthNear!=r.depthNear||t.depthFar!=r.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=a}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,r=new nl({vertexShader:XA,fragmentShader:ZA,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Ci(new Wc(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class KA extends Hl{constructor(e,t){super();const r=this;let a=null,l=1,x=null,_="local-floor",O=1,z=null,q=null,oe=null,ue=null,_e=null,be=null;const Pe=new QA,Se=t.getContextAttributes();let Ee=null,Xe=null;const qe=[],$e=[],ft=new Jr;let gt=null;const pt=new Ro;pt.layers.enable(1),pt.viewport=new Si;const Ht=new Ro;Ht.layers.enable(2),Ht.viewport=new Si;const ur=[pt,Ht],Ve=new qA;Ve.layers.enable(1),Ve.layers.enable(2);let nt=null,nr=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Or){let $r=qe[Or];return $r===void 0&&($r=new Mp,qe[Or]=$r),$r.getTargetRaySpace()},this.getControllerGrip=function(Or){let $r=qe[Or];return $r===void 0&&($r=new Mp,qe[Or]=$r),$r.getGripSpace()},this.getHand=function(Or){let $r=qe[Or];return $r===void 0&&($r=new Mp,qe[Or]=$r),$r.getHandSpace()};function Zt(Or){const $r=$e.indexOf(Or.inputSource);if($r===-1)return;const En=qe[$r];En!==void 0&&(En.update(Or.inputSource,Or.frame,z||x),En.dispatchEvent({type:Or.type,data:Or.inputSource}))}function Xt(){a.removeEventListener("select",Zt),a.removeEventListener("selectstart",Zt),a.removeEventListener("selectend",Zt),a.removeEventListener("squeeze",Zt),a.removeEventListener("squeezestart",Zt),a.removeEventListener("squeezeend",Zt),a.removeEventListener("end",Xt),a.removeEventListener("inputsourceschange",Pr);for(let Or=0;Or<qe.length;Or++){const $r=$e[Or];$r!==null&&($e[Or]=null,qe[Or].disconnect($r))}nt=null,nr=null,Pe.reset(),e.setRenderTarget(Ee),_e=null,ue=null,oe=null,a=null,Xe=null,zn.stop(),r.isPresenting=!1,e.setPixelRatio(gt),e.setSize(ft.width,ft.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Or){l=Or,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Or){_=Or,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return z||x},this.setReferenceSpace=function(Or){z=Or},this.getBaseLayer=function(){return ue!==null?ue:_e},this.getBinding=function(){return oe},this.getFrame=function(){return be},this.getSession=function(){return a},this.setSession=async function(Or){if(a=Or,a!==null){if(Ee=e.getRenderTarget(),a.addEventListener("select",Zt),a.addEventListener("selectstart",Zt),a.addEventListener("selectend",Zt),a.addEventListener("squeeze",Zt),a.addEventListener("squeezestart",Zt),a.addEventListener("squeezeend",Zt),a.addEventListener("end",Xt),a.addEventListener("inputsourceschange",Pr),Se.xrCompatible!==!0&&await t.makeXRCompatible(),gt=e.getPixelRatio(),e.getSize(ft),a.renderState.layers===void 0){const $r={antialias:Se.antialias,alpha:!0,depth:Se.depth,stencil:Se.stencil,framebufferScaleFactor:l};_e=new XRWebGLLayer(a,t,$r),a.updateRenderState({baseLayer:_e}),e.setPixelRatio(1),e.setSize(_e.framebufferWidth,_e.framebufferHeight,!1),Xe=new Fl(_e.framebufferWidth,_e.framebufferHeight,{format:Uo,type:Is,colorSpace:e.outputColorSpace,stencilBuffer:Se.stencil})}else{let $r=null,En=null,Ln=null;Se.depth&&(Ln=Se.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,$r=Se.stencil?Vc:Ic,En=Se.stencil?Hc:Il);const ta={colorFormat:t.RGBA8,depthFormat:Ln,scaleFactor:l};oe=new XRWebGLBinding(a,t),ue=oe.createProjectionLayer(ta),a.updateRenderState({layers:[ue]}),e.setPixelRatio(1),e.setSize(ue.textureWidth,ue.textureHeight,!1),Xe=new Fl(ue.textureWidth,ue.textureHeight,{format:Uo,type:Is,depthTexture:new x2(ue.textureWidth,ue.textureHeight,En,void 0,void 0,void 0,void 0,void 0,void 0,$r),stencilBuffer:Se.stencil,colorSpace:e.outputColorSpace,samples:Se.antialias?4:0,resolveDepthBuffer:ue.ignoreDepthValues===!1})}Xe.isXRRenderTarget=!0,this.setFoveation(O),z=null,x=await a.requestReferenceSpace(_),zn.setContext(a),zn.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(a!==null)return a.environmentBlendMode},this.getDepthTexture=function(){return Pe.getDepthTexture()};function Pr(Or){for(let $r=0;$r<Or.removed.length;$r++){const En=Or.removed[$r],Ln=$e.indexOf(En);Ln>=0&&($e[Ln]=null,qe[Ln].disconnect(En))}for(let $r=0;$r<Or.added.length;$r++){const En=Or.added[$r];let Ln=$e.indexOf(En);if(Ln===-1){for(let Jn=0;Jn<qe.length;Jn++)if(Jn>=$e.length){$e.push(En),Ln=Jn;break}else if($e[Jn]===null){$e[Jn]=En,Ln=Jn;break}if(Ln===-1)break}const ta=qe[Ln];ta&&ta.connect(En)}}const cr=new st,Qr=new st;function Tr(Or,$r,En){cr.setFromMatrixPosition($r.matrixWorld),Qr.setFromMatrixPosition(En.matrixWorld);const Ln=cr.distanceTo(Qr),ta=$r.projectionMatrix.elements,Jn=En.projectionMatrix.elements,da=ta[14]/(ta[10]-1),La=ta[14]/(ta[10]+1),ga=(ta[9]+1)/ta[5],tr=(ta[9]-1)/ta[5],Ni=(ta[8]-1)/ta[0],fa=(Jn[8]+1)/Jn[0],ya=da*Ni,ra=da*fa,Ga=Ln/(-Ni+fa),na=Ga*-Ni;if($r.matrixWorld.decompose(Or.position,Or.quaternion,Or.scale),Or.translateX(na),Or.translateZ(Ga),Or.matrixWorld.compose(Or.position,Or.quaternion,Or.scale),Or.matrixWorldInverse.copy(Or.matrixWorld).invert(),ta[10]===-1)Or.projectionMatrix.copy($r.projectionMatrix),Or.projectionMatrixInverse.copy($r.projectionMatrixInverse);else{const Dt=da+Ga,ut=La+Ga,dr=ya-na,kr=ra+(Ln-na),qr=ga*La/ut*Dt,Ir=tr*La/ut*Dt;Or.projectionMatrix.makePerspective(dr,kr,qr,Ir,Dt,ut),Or.projectionMatrixInverse.copy(Or.projectionMatrix).invert()}}function ln(Or,$r){$r===null?Or.matrixWorld.copy(Or.matrix):Or.matrixWorld.multiplyMatrices($r.matrixWorld,Or.matrix),Or.matrixWorldInverse.copy(Or.matrixWorld).invert()}this.updateCamera=function(Or){if(a===null)return;let $r=Or.near,En=Or.far;Pe.texture!==null&&(Pe.depthNear>0&&($r=Pe.depthNear),Pe.depthFar>0&&(En=Pe.depthFar)),Ve.near=Ht.near=pt.near=$r,Ve.far=Ht.far=pt.far=En,(nt!==Ve.near||nr!==Ve.far)&&(a.updateRenderState({depthNear:Ve.near,depthFar:Ve.far}),nt=Ve.near,nr=Ve.far);const Ln=Or.parent,ta=Ve.cameras;ln(Ve,Ln);for(let Jn=0;Jn<ta.length;Jn++)ln(ta[Jn],Ln);ta.length===2?Tr(Ve,pt,Ht):Ve.projectionMatrix.copy(pt.projectionMatrix),Sn(Or,Ve,Ln)};function Sn(Or,$r,En){En===null?Or.matrix.copy($r.matrixWorld):(Or.matrix.copy(En.matrixWorld),Or.matrix.invert(),Or.matrix.multiply($r.matrixWorld)),Or.matrix.decompose(Or.position,Or.quaternion,Or.scale),Or.updateMatrixWorld(!0),Or.projectionMatrix.copy($r.projectionMatrix),Or.projectionMatrixInverse.copy($r.projectionMatrixInverse),Or.isPerspectiveCamera&&(Or.fov=ju*2*Math.atan(1/Or.projectionMatrix.elements[5]),Or.zoom=1)}this.getCamera=function(){return Ve},this.getFoveation=function(){if(!(ue===null&&_e===null))return O},this.setFoveation=function(Or){O=Or,ue!==null&&(ue.fixedFoveation=Or),_e!==null&&_e.fixedFoveation!==void 0&&(_e.fixedFoveation=Or)},this.hasDepthSensing=function(){return Pe.texture!==null},this.getDepthSensingMesh=function(){return Pe.getMesh(Ve)};let Wn=null;function Ma(Or,$r){if(q=$r.getViewerPose(z||x),be=$r,q!==null){const En=q.views;_e!==null&&(e.setRenderTargetFramebuffer(Xe,_e.framebuffer),e.setRenderTarget(Xe));let Ln=!1;En.length!==Ve.cameras.length&&(Ve.cameras.length=0,Ln=!0);for(let Jn=0;Jn<En.length;Jn++){const da=En[Jn];let La=null;if(_e!==null)La=_e.getViewport(da);else{const tr=oe.getViewSubImage(ue,da);La=tr.viewport,Jn===0&&(e.setRenderTargetTextures(Xe,tr.colorTexture,ue.ignoreDepthValues?void 0:tr.depthStencilTexture),e.setRenderTarget(Xe))}let ga=ur[Jn];ga===void 0&&(ga=new Ro,ga.layers.enable(Jn),ga.viewport=new Si,ur[Jn]=ga),ga.matrix.fromArray(da.transform.matrix),ga.matrix.decompose(ga.position,ga.quaternion,ga.scale),ga.projectionMatrix.fromArray(da.projectionMatrix),ga.projectionMatrixInverse.copy(ga.projectionMatrix).invert(),ga.viewport.set(La.x,La.y,La.width,La.height),Jn===0&&(Ve.matrix.copy(ga.matrix),Ve.matrix.decompose(Ve.position,Ve.quaternion,Ve.scale)),Ln===!0&&Ve.cameras.push(ga)}const ta=a.enabledFeatures;if(ta&&ta.includes("depth-sensing")){const Jn=oe.getDepthInformation(En[0]);Jn&&Jn.isValid&&Jn.texture&&Pe.init(e,Jn,a.renderState)}}for(let En=0;En<qe.length;En++){const Ln=$e[En],ta=qe[En];Ln!==null&&ta!==void 0&&ta.update(Ln,$r,z||x)}Wn&&Wn(Or,$r),$r.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:$r}),be=null}const zn=new y2;zn.setAnimationLoop(Ma),this.setAnimationLoop=function(Or){Wn=Or},this.dispose=function(){}}}const Ll=new Ko,$A=new jn;function eS(n,e){function t(Se,Ee){Se.matrixAutoUpdate===!0&&Se.updateMatrix(),Ee.value.copy(Se.matrix)}function r(Se,Ee){Ee.color.getRGB(Se.fogColor.value,g2(n)),Ee.isFog?(Se.fogNear.value=Ee.near,Se.fogFar.value=Ee.far):Ee.isFogExp2&&(Se.fogDensity.value=Ee.density)}function a(Se,Ee,Xe,qe,$e){Ee.isMeshBasicMaterial||Ee.isMeshLambertMaterial?l(Se,Ee):Ee.isMeshToonMaterial?(l(Se,Ee),oe(Se,Ee)):Ee.isMeshPhongMaterial?(l(Se,Ee),q(Se,Ee)):Ee.isMeshStandardMaterial?(l(Se,Ee),ue(Se,Ee),Ee.isMeshPhysicalMaterial&&_e(Se,Ee,$e)):Ee.isMeshMatcapMaterial?(l(Se,Ee),be(Se,Ee)):Ee.isMeshDepthMaterial?l(Se,Ee):Ee.isMeshDistanceMaterial?(l(Se,Ee),Pe(Se,Ee)):Ee.isMeshNormalMaterial?l(Se,Ee):Ee.isLineBasicMaterial?(x(Se,Ee),Ee.isLineDashedMaterial&&_(Se,Ee)):Ee.isPointsMaterial?O(Se,Ee,Xe,qe):Ee.isSpriteMaterial?z(Se,Ee):Ee.isShadowMaterial?(Se.color.value.copy(Ee.color),Se.opacity.value=Ee.opacity):Ee.isShaderMaterial&&(Ee.uniformsNeedUpdate=!1)}function l(Se,Ee){Se.opacity.value=Ee.opacity,Ee.color&&Se.diffuse.value.copy(Ee.color),Ee.emissive&&Se.emissive.value.copy(Ee.emissive).multiplyScalar(Ee.emissiveIntensity),Ee.map&&(Se.map.value=Ee.map,t(Ee.map,Se.mapTransform)),Ee.alphaMap&&(Se.alphaMap.value=Ee.alphaMap,t(Ee.alphaMap,Se.alphaMapTransform)),Ee.bumpMap&&(Se.bumpMap.value=Ee.bumpMap,t(Ee.bumpMap,Se.bumpMapTransform),Se.bumpScale.value=Ee.bumpScale,Ee.side===_o&&(Se.bumpScale.value*=-1)),Ee.normalMap&&(Se.normalMap.value=Ee.normalMap,t(Ee.normalMap,Se.normalMapTransform),Se.normalScale.value.copy(Ee.normalScale),Ee.side===_o&&Se.normalScale.value.negate()),Ee.displacementMap&&(Se.displacementMap.value=Ee.displacementMap,t(Ee.displacementMap,Se.displacementMapTransform),Se.displacementScale.value=Ee.displacementScale,Se.displacementBias.value=Ee.displacementBias),Ee.emissiveMap&&(Se.emissiveMap.value=Ee.emissiveMap,t(Ee.emissiveMap,Se.emissiveMapTransform)),Ee.specularMap&&(Se.specularMap.value=Ee.specularMap,t(Ee.specularMap,Se.specularMapTransform)),Ee.alphaTest>0&&(Se.alphaTest.value=Ee.alphaTest);const Xe=e.get(Ee),qe=Xe.envMap,$e=Xe.envMapRotation;qe&&(Se.envMap.value=qe,Ll.copy($e),Ll.x*=-1,Ll.y*=-1,Ll.z*=-1,qe.isCubeTexture&&qe.isRenderTargetTexture===!1&&(Ll.y*=-1,Ll.z*=-1),Se.envMapRotation.value.setFromMatrix4($A.makeRotationFromEuler(Ll)),Se.flipEnvMap.value=qe.isCubeTexture&&qe.isRenderTargetTexture===!1?-1:1,Se.reflectivity.value=Ee.reflectivity,Se.ior.value=Ee.ior,Se.refractionRatio.value=Ee.refractionRatio),Ee.lightMap&&(Se.lightMap.value=Ee.lightMap,Se.lightMapIntensity.value=Ee.lightMapIntensity,t(Ee.lightMap,Se.lightMapTransform)),Ee.aoMap&&(Se.aoMap.value=Ee.aoMap,Se.aoMapIntensity.value=Ee.aoMapIntensity,t(Ee.aoMap,Se.aoMapTransform))}function x(Se,Ee){Se.diffuse.value.copy(Ee.color),Se.opacity.value=Ee.opacity,Ee.map&&(Se.map.value=Ee.map,t(Ee.map,Se.mapTransform))}function _(Se,Ee){Se.dashSize.value=Ee.dashSize,Se.totalSize.value=Ee.dashSize+Ee.gapSize,Se.scale.value=Ee.scale}function O(Se,Ee,Xe,qe){Se.diffuse.value.copy(Ee.color),Se.opacity.value=Ee.opacity,Se.size.value=Ee.size*Xe,Se.scale.value=qe*.5,Ee.map&&(Se.map.value=Ee.map,t(Ee.map,Se.uvTransform)),Ee.alphaMap&&(Se.alphaMap.value=Ee.alphaMap,t(Ee.alphaMap,Se.alphaMapTransform)),Ee.alphaTest>0&&(Se.alphaTest.value=Ee.alphaTest)}function z(Se,Ee){Se.diffuse.value.copy(Ee.color),Se.opacity.value=Ee.opacity,Se.rotation.value=Ee.rotation,Ee.map&&(Se.map.value=Ee.map,t(Ee.map,Se.mapTransform)),Ee.alphaMap&&(Se.alphaMap.value=Ee.alphaMap,t(Ee.alphaMap,Se.alphaMapTransform)),Ee.alphaTest>0&&(Se.alphaTest.value=Ee.alphaTest)}function q(Se,Ee){Se.specular.value.copy(Ee.specular),Se.shininess.value=Math.max(Ee.shininess,1e-4)}function oe(Se,Ee){Ee.gradientMap&&(Se.gradientMap.value=Ee.gradientMap)}function ue(Se,Ee){Se.metalness.value=Ee.metalness,Ee.metalnessMap&&(Se.metalnessMap.value=Ee.metalnessMap,t(Ee.metalnessMap,Se.metalnessMapTransform)),Se.roughness.value=Ee.roughness,Ee.roughnessMap&&(Se.roughnessMap.value=Ee.roughnessMap,t(Ee.roughnessMap,Se.roughnessMapTransform)),Ee.envMap&&(Se.envMapIntensity.value=Ee.envMapIntensity)}function _e(Se,Ee,Xe){Se.ior.value=Ee.ior,Ee.sheen>0&&(Se.sheenColor.value.copy(Ee.sheenColor).multiplyScalar(Ee.sheen),Se.sheenRoughness.value=Ee.sheenRoughness,Ee.sheenColorMap&&(Se.sheenColorMap.value=Ee.sheenColorMap,t(Ee.sheenColorMap,Se.sheenColorMapTransform)),Ee.sheenRoughnessMap&&(Se.sheenRoughnessMap.value=Ee.sheenRoughnessMap,t(Ee.sheenRoughnessMap,Se.sheenRoughnessMapTransform))),Ee.clearcoat>0&&(Se.clearcoat.value=Ee.clearcoat,Se.clearcoatRoughness.value=Ee.clearcoatRoughness,Ee.clearcoatMap&&(Se.clearcoatMap.value=Ee.clearcoatMap,t(Ee.clearcoatMap,Se.clearcoatMapTransform)),Ee.clearcoatRoughnessMap&&(Se.clearcoatRoughnessMap.value=Ee.clearcoatRoughnessMap,t(Ee.clearcoatRoughnessMap,Se.clearcoatRoughnessMapTransform)),Ee.clearcoatNormalMap&&(Se.clearcoatNormalMap.value=Ee.clearcoatNormalMap,t(Ee.clearcoatNormalMap,Se.clearcoatNormalMapTransform),Se.clearcoatNormalScale.value.copy(Ee.clearcoatNormalScale),Ee.side===_o&&Se.clearcoatNormalScale.value.negate())),Ee.dispersion>0&&(Se.dispersion.value=Ee.dispersion),Ee.iridescence>0&&(Se.iridescence.value=Ee.iridescence,Se.iridescenceIOR.value=Ee.iridescenceIOR,Se.iridescenceThicknessMinimum.value=Ee.iridescenceThicknessRange[0],Se.iridescenceThicknessMaximum.value=Ee.iridescenceThicknessRange[1],Ee.iridescenceMap&&(Se.iridescenceMap.value=Ee.iridescenceMap,t(Ee.iridescenceMap,Se.iridescenceMapTransform)),Ee.iridescenceThicknessMap&&(Se.iridescenceThicknessMap.value=Ee.iridescenceThicknessMap,t(Ee.iridescenceThicknessMap,Se.iridescenceThicknessMapTransform))),Ee.transmission>0&&(Se.transmission.value=Ee.transmission,Se.transmissionSamplerMap.value=Xe.texture,Se.transmissionSamplerSize.value.set(Xe.width,Xe.height),Ee.transmissionMap&&(Se.transmissionMap.value=Ee.transmissionMap,t(Ee.transmissionMap,Se.transmissionMapTransform)),Se.thickness.value=Ee.thickness,Ee.thicknessMap&&(Se.thicknessMap.value=Ee.thicknessMap,t(Ee.thicknessMap,Se.thicknessMapTransform)),Se.attenuationDistance.value=Ee.attenuationDistance,Se.attenuationColor.value.copy(Ee.attenuationColor)),Ee.anisotropy>0&&(Se.anisotropyVector.value.set(Ee.anisotropy*Math.cos(Ee.anisotropyRotation),Ee.anisotropy*Math.sin(Ee.anisotropyRotation)),Ee.anisotropyMap&&(Se.anisotropyMap.value=Ee.anisotropyMap,t(Ee.anisotropyMap,Se.anisotropyMapTransform))),Se.specularIntensity.value=Ee.specularIntensity,Se.specularColor.value.copy(Ee.specularColor),Ee.specularColorMap&&(Se.specularColorMap.value=Ee.specularColorMap,t(Ee.specularColorMap,Se.specularColorMapTransform)),Ee.specularIntensityMap&&(Se.specularIntensityMap.value=Ee.specularIntensityMap,t(Ee.specularIntensityMap,Se.specularIntensityMapTransform))}function be(Se,Ee){Ee.matcap&&(Se.matcap.value=Ee.matcap)}function Pe(Se,Ee){const Xe=e.get(Ee).light;Se.referencePosition.value.setFromMatrixPosition(Xe.matrixWorld),Se.nearDistance.value=Xe.shadow.camera.near,Se.farDistance.value=Xe.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:a}}function tS(n,e,t,r){let a={},l={},x=[];const _=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function O(Xe,qe){const $e=qe.program;r.uniformBlockBinding(Xe,$e)}function z(Xe,qe){let $e=a[Xe.id];$e===void 0&&(be(Xe),$e=q(Xe),a[Xe.id]=$e,Xe.addEventListener("dispose",Se));const ft=qe.program;r.updateUBOMapping(Xe,ft);const gt=e.render.frame;l[Xe.id]!==gt&&(ue(Xe),l[Xe.id]=gt)}function q(Xe){const qe=oe();Xe.__bindingPointIndex=qe;const $e=n.createBuffer(),ft=Xe.__size,gt=Xe.usage;return n.bindBuffer(n.UNIFORM_BUFFER,$e),n.bufferData(n.UNIFORM_BUFFER,ft,gt),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,qe,$e),$e}function oe(){for(let Xe=0;Xe<_;Xe++)if(x.indexOf(Xe)===-1)return x.push(Xe),Xe;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function ue(Xe){const qe=a[Xe.id],$e=Xe.uniforms,ft=Xe.__cache;n.bindBuffer(n.UNIFORM_BUFFER,qe);for(let gt=0,pt=$e.length;gt<pt;gt++){const Ht=Array.isArray($e[gt])?$e[gt]:[$e[gt]];for(let ur=0,Ve=Ht.length;ur<Ve;ur++){const nt=Ht[ur];if(_e(nt,gt,ur,ft)===!0){const nr=nt.__offset,Zt=Array.isArray(nt.value)?nt.value:[nt.value];let Xt=0;for(let Pr=0;Pr<Zt.length;Pr++){const cr=Zt[Pr],Qr=Pe(cr);typeof cr=="number"||typeof cr=="boolean"?(nt.__data[0]=cr,n.bufferSubData(n.UNIFORM_BUFFER,nr+Xt,nt.__data)):cr.isMatrix3?(nt.__data[0]=cr.elements[0],nt.__data[1]=cr.elements[1],nt.__data[2]=cr.elements[2],nt.__data[3]=0,nt.__data[4]=cr.elements[3],nt.__data[5]=cr.elements[4],nt.__data[6]=cr.elements[5],nt.__data[7]=0,nt.__data[8]=cr.elements[6],nt.__data[9]=cr.elements[7],nt.__data[10]=cr.elements[8],nt.__data[11]=0):(cr.toArray(nt.__data,Xt),Xt+=Qr.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,nr,nt.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function _e(Xe,qe,$e,ft){const gt=Xe.value,pt=qe+"_"+$e;if(ft[pt]===void 0)return typeof gt=="number"||typeof gt=="boolean"?ft[pt]=gt:ft[pt]=gt.clone(),!0;{const Ht=ft[pt];if(typeof gt=="number"||typeof gt=="boolean"){if(Ht!==gt)return ft[pt]=gt,!0}else if(Ht.equals(gt)===!1)return Ht.copy(gt),!0}return!1}function be(Xe){const qe=Xe.uniforms;let $e=0;const ft=16;for(let pt=0,Ht=qe.length;pt<Ht;pt++){const ur=Array.isArray(qe[pt])?qe[pt]:[qe[pt]];for(let Ve=0,nt=ur.length;Ve<nt;Ve++){const nr=ur[Ve],Zt=Array.isArray(nr.value)?nr.value:[nr.value];for(let Xt=0,Pr=Zt.length;Xt<Pr;Xt++){const cr=Zt[Xt],Qr=Pe(cr),Tr=$e%ft,ln=Tr%Qr.boundary,Sn=Tr+ln;$e+=ln,Sn!==0&&ft-Sn<Qr.storage&&($e+=ft-Sn),nr.__data=new Float32Array(Qr.storage/Float32Array.BYTES_PER_ELEMENT),nr.__offset=$e,$e+=Qr.storage}}}const gt=$e%ft;return gt>0&&($e+=ft-gt),Xe.__size=$e,Xe.__cache={},this}function Pe(Xe){const qe={boundary:0,storage:0};return typeof Xe=="number"||typeof Xe=="boolean"?(qe.boundary=4,qe.storage=4):Xe.isVector2?(qe.boundary=8,qe.storage=8):Xe.isVector3||Xe.isColor?(qe.boundary=16,qe.storage=12):Xe.isVector4?(qe.boundary=16,qe.storage=16):Xe.isMatrix3?(qe.boundary=48,qe.storage=48):Xe.isMatrix4?(qe.boundary=64,qe.storage=64):Xe.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",Xe),qe}function Se(Xe){const qe=Xe.target;qe.removeEventListener("dispose",Se);const $e=x.indexOf(qe.__bindingPointIndex);x.splice($e,1),n.deleteBuffer(a[qe.id]),delete a[qe.id],delete l[qe.id]}function Ee(){for(const Xe in a)n.deleteBuffer(a[Xe]);x=[],a={},l={}}return{bind:O,update:z,dispose:Ee}}class rS{constructor(e={}){const{canvas:t=Gw(),context:r=null,depth:a=!0,stencil:l=!1,alpha:x=!1,antialias:_=!1,premultipliedAlpha:O=!0,preserveDrawingBuffer:z=!1,powerPreference:q="default",failIfMajorPerformanceCaveat:oe=!1}=e;this.isWebGLRenderer=!0;let ue;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");ue=r.getContextAttributes().alpha}else ue=x;const _e=new Uint32Array(4),be=new Int32Array(4);let Pe=null,Se=null;const Ee=[],Xe=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=hs,this.toneMapping=tl,this.toneMappingExposure=1;const qe=this;let $e=!1,ft=0,gt=0,pt=null,Ht=-1,ur=null;const Ve=new Si,nt=new Si;let nr=null;const Zt=new qn(0);let Xt=0,Pr=t.width,cr=t.height,Qr=1,Tr=null,ln=null;const Sn=new Si(0,0,Pr,cr),Wn=new Si(0,0,Pr,cr);let Ma=!1;const zn=new Yh;let Or=!1,$r=!1;const En=new jn,Ln=new jn,ta=new st,Jn=new Si,da={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let La=!1;function ga(){return pt===null?Qr:1}let tr=r;function Ni(_t,Mt){return t.getContext(_t,Mt)}try{const _t={alpha:!0,depth:a,stencil:l,antialias:_,premultipliedAlpha:O,preserveDrawingBuffer:z,powerPreference:q,failIfMajorPerformanceCaveat:oe};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${am}`),t.addEventListener("webglcontextlost",Nr,!1),t.addEventListener("webglcontextrestored",cn,!1),t.addEventListener("webglcontextcreationerror",nn,!1),tr===null){const Mt="webgl2";if(tr=Ni(Mt,_t),tr===null)throw Ni(Mt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(_t){throw console.error("THREE.WebGLRenderer: "+_t.message),_t}let fa,ya,ra,Ga,na,Dt,ut,dr,kr,qr,Ir,Nn,hn,wn,pa,en,Rn,Kn,$n,Mn,Xn,Ft,Wr,qt;function jr(){fa=new s6(tr),fa.init(),Ft=new YA(tr,fa),ya=new t6(tr,fa,e,Ft),ra=new GA(tr),ya.reverseDepthBuffer&&ra.buffers.depth.setReversed(!0),Ga=new u6(tr),na=new EA,Dt=new WA(tr,fa,ra,na,ya,Ft,Ga),ut=new n6(qe),dr=new o6(qe),kr=new vM(tr),Wr=new $T(tr,kr),qr=new l6(tr,kr,Ga,Wr),Ir=new h6(tr,qr,kr,Ga),$n=new d6(tr,ya,Dt),en=new r6(na),Nn=new CA(qe,ut,dr,fa,ya,Wr,en),hn=new eS(qe,na),wn=new RA,pa=new IA(fa),Kn=new KT(qe,ut,dr,ra,Ir,ue,O),Rn=new HA(qe,Ir,ya),qt=new tS(tr,Ga,ya,ra),Mn=new e6(tr,fa,Ga),Xn=new c6(tr,fa,Ga),Ga.programs=Nn.programs,qe.capabilities=ya,qe.extensions=fa,qe.properties=na,qe.renderLists=wn,qe.shadowMap=Rn,qe.state=ra,qe.info=Ga}jr();const mr=new KA(qe,tr);this.xr=mr,this.getContext=function(){return tr},this.getContextAttributes=function(){return tr.getContextAttributes()},this.forceContextLoss=function(){const _t=fa.get("WEBGL_lose_context");_t&&_t.loseContext()},this.forceContextRestore=function(){const _t=fa.get("WEBGL_lose_context");_t&&_t.restoreContext()},this.getPixelRatio=function(){return Qr},this.setPixelRatio=function(_t){_t!==void 0&&(Qr=_t,this.setSize(Pr,cr,!1))},this.getSize=function(_t){return _t.set(Pr,cr)},this.setSize=function(_t,Mt,gr=!0){if(mr.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Pr=_t,cr=Mt,t.width=Math.floor(_t*Qr),t.height=Math.floor(Mt*Qr),gr===!0&&(t.style.width=_t+"px",t.style.height=Mt+"px"),this.setViewport(0,0,_t,Mt)},this.getDrawingBufferSize=function(_t){return _t.set(Pr*Qr,cr*Qr).floor()},this.setDrawingBufferSize=function(_t,Mt,gr){Pr=_t,cr=Mt,Qr=gr,t.width=Math.floor(_t*gr),t.height=Math.floor(Mt*gr),this.setViewport(0,0,_t,Mt)},this.getCurrentViewport=function(_t){return _t.copy(Ve)},this.getViewport=function(_t){return _t.copy(Sn)},this.setViewport=function(_t,Mt,gr,vr){_t.isVector4?Sn.set(_t.x,_t.y,_t.z,_t.w):Sn.set(_t,Mt,gr,vr),ra.viewport(Ve.copy(Sn).multiplyScalar(Qr).round())},this.getScissor=function(_t){return _t.copy(Wn)},this.setScissor=function(_t,Mt,gr,vr){_t.isVector4?Wn.set(_t.x,_t.y,_t.z,_t.w):Wn.set(_t,Mt,gr,vr),ra.scissor(nt.copy(Wn).multiplyScalar(Qr).round())},this.getScissorTest=function(){return Ma},this.setScissorTest=function(_t){ra.setScissorTest(Ma=_t)},this.setOpaqueSort=function(_t){Tr=_t},this.setTransparentSort=function(_t){ln=_t},this.getClearColor=function(_t){return _t.copy(Kn.getClearColor())},this.setClearColor=function(){Kn.setClearColor.apply(Kn,arguments)},this.getClearAlpha=function(){return Kn.getClearAlpha()},this.setClearAlpha=function(){Kn.setClearAlpha.apply(Kn,arguments)},this.clear=function(_t=!0,Mt=!0,gr=!0){let vr=0;if(_t){let ir=!1;if(pt!==null){const Zr=pt.texture.format;ir=Zr===hm||Zr===dm||Zr===um}if(ir){const Zr=pt.texture.type,xn=Zr===Is||Zr===Il||Zr===Gu||Zr===Hc||Zr===sm||Zr===lm,Pn=Kn.getClearColor(),Dn=Kn.getClearAlpha(),Hn=Pn.r,fn=Pn.g,kn=Pn.b;xn?(_e[0]=Hn,_e[1]=fn,_e[2]=kn,_e[3]=Dn,tr.clearBufferuiv(tr.COLOR,0,_e)):(be[0]=Hn,be[1]=fn,be[2]=kn,be[3]=Dn,tr.clearBufferiv(tr.COLOR,0,be))}else vr|=tr.COLOR_BUFFER_BIT}Mt&&(vr|=tr.DEPTH_BUFFER_BIT,tr.clearDepth(this.capabilities.reverseDepthBuffer?0:1)),gr&&(vr|=tr.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),tr.clear(vr)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Nr,!1),t.removeEventListener("webglcontextrestored",cn,!1),t.removeEventListener("webglcontextcreationerror",nn,!1),wn.dispose(),pa.dispose(),na.dispose(),ut.dispose(),dr.dispose(),Ir.dispose(),Wr.dispose(),qt.dispose(),Nn.dispose(),mr.dispose(),mr.removeEventListener("sessionstart",Oo),mr.removeEventListener("sessionend",ql),Go.stop()};function Nr(_t){_t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),$e=!0}function cn(){console.log("THREE.WebGLRenderer: Context Restored."),$e=!1;const _t=Ga.autoReset,Mt=Rn.enabled,gr=Rn.autoUpdate,vr=Rn.needsUpdate,ir=Rn.type;jr(),Ga.autoReset=_t,Rn.enabled=Mt,Rn.autoUpdate=gr,Rn.needsUpdate=vr,Rn.type=ir}function nn(_t){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",_t.statusMessage)}function Sa(_t){const Mt=_t.target;Mt.removeEventListener("dispose",Sa),Ia(Mt)}function Ia(_t){an(_t),na.remove(_t)}function an(_t){const Mt=na.get(_t).programs;Mt!==void 0&&(Mt.forEach(function(gr){Nn.releaseProgram(gr)}),_t.isShaderMaterial&&Nn.releaseShaderCache(_t))}this.renderBufferDirect=function(_t,Mt,gr,vr,ir,Zr){Mt===null&&(Mt=da);const xn=ir.isMesh&&ir.matrixWorld.determinant()<0,Pn=rs(_t,Mt,gr,vr,ir);ra.setMaterial(vr,xn);let Dn=gr.index,Hn=1;if(vr.wireframe===!0){if(Dn=qr.getWireframeAttribute(gr),Dn===void 0)return;Hn=2}const fn=gr.drawRange,kn=gr.attributes.position;let aa=fn.start*Hn,Ha=(fn.start+fn.count)*Hn;Zr!==null&&(aa=Math.max(aa,Zr.start*Hn),Ha=Math.min(Ha,(Zr.start+Zr.count)*Hn)),Dn!==null?(aa=Math.max(aa,0),Ha=Math.min(Ha,Dn.count)):kn!=null&&(aa=Math.max(aa,0),Ha=Math.min(Ha,kn.count));const $a=Ha-aa;if($a<0||$a===1/0)return;Wr.setup(ir,vr,Pn,gr,Dn);let yi,ei=Mn;if(Dn!==null&&(yi=kr.get(Dn),ei=Xn,ei.setIndex(yi)),ir.isMesh)vr.wireframe===!0?(ra.setLineWidth(vr.wireframeLinewidth*ga()),ei.setMode(tr.LINES)):ei.setMode(tr.TRIANGLES);else if(ir.isLine){let pn=vr.linewidth;pn===void 0&&(pn=1),ra.setLineWidth(pn*ga()),ir.isLineSegments?ei.setMode(tr.LINES):ir.isLineLoop?ei.setMode(tr.LINE_LOOP):ei.setMode(tr.LINE_STRIP)}else ir.isPoints?ei.setMode(tr.POINTS):ir.isSprite&&ei.setMode(tr.TRIANGLES);if(ir.isBatchedMesh)if(ir._multiDrawInstances!==null)ei.renderMultiDrawInstances(ir._multiDrawStarts,ir._multiDrawCounts,ir._multiDrawCount,ir._multiDrawInstances);else if(fa.get("WEBGL_multi_draw"))ei.renderMultiDraw(ir._multiDrawStarts,ir._multiDrawCounts,ir._multiDrawCount);else{const pn=ir._multiDrawStarts,xi=ir._multiDrawCounts,fi=ir._multiDrawCount,ja=Dn?kr.get(Dn).bytesPerElement:1,Di=na.get(vr).currentProgram.getUniforms();for(let Fi=0;Fi<fi;Fi++)Di.setValue(tr,"_gl_DrawID",Fi),ei.render(pn[Fi]/ja,xi[Fi])}else if(ir.isInstancedMesh)ei.renderInstances(aa,$a,ir.count);else if(gr.isInstancedBufferGeometry){const pn=gr._maxInstanceCount!==void 0?gr._maxInstanceCount:1/0,xi=Math.min(gr.instanceCount,pn);ei.renderInstances(aa,$a,xi)}else ei.render(aa,$a)};function xa(_t,Mt,gr){_t.transparent===!0&&_t.side===co&&_t.forceSinglePass===!1?(_t.side=_o,_t.needsUpdate=!0,Us(_t,Mt,gr),_t.side=rl,_t.needsUpdate=!0,Us(_t,Mt,gr),_t.side=co):Us(_t,Mt,gr)}this.compile=function(_t,Mt,gr=null){gr===null&&(gr=_t),Se=pa.get(gr),Se.init(Mt),Xe.push(Se),gr.traverseVisible(function(ir){ir.isLight&&ir.layers.test(Mt.layers)&&(Se.pushLight(ir),ir.castShadow&&Se.pushShadow(ir))}),_t!==gr&&_t.traverseVisible(function(ir){ir.isLight&&ir.layers.test(Mt.layers)&&(Se.pushLight(ir),ir.castShadow&&Se.pushShadow(ir))}),Se.setupLights();const vr=new Set;return _t.traverse(function(ir){if(!(ir.isMesh||ir.isPoints||ir.isLine||ir.isSprite))return;const Zr=ir.material;if(Zr)if(Array.isArray(Zr))for(let xn=0;xn<Zr.length;xn++){const Pn=Zr[xn];xa(Pn,gr,ir),vr.add(Pn)}else xa(Zr,gr,ir),vr.add(Zr)}),Xe.pop(),Se=null,vr},this.compileAsync=function(_t,Mt,gr=null){const vr=this.compile(_t,Mt,gr);return new Promise(ir=>{function Zr(){if(vr.forEach(function(xn){na.get(xn).currentProgram.isReady()&&vr.delete(xn)}),vr.size===0){ir(_t);return}setTimeout(Zr,10)}fa.get("KHR_parallel_shader_compile")!==null?Zr():setTimeout(Zr,10)})};let hi=null;function Ka(_t){hi&&hi(_t)}function Oo(){Go.stop()}function ql(){Go.start()}const Go=new y2;Go.setAnimationLoop(Ka),typeof self<"u"&&Go.setContext(self),this.setAnimationLoop=function(_t){hi=_t,mr.setAnimationLoop(_t),_t===null?Go.stop():Go.start()},mr.addEventListener("sessionstart",Oo),mr.addEventListener("sessionend",ql),this.render=function(_t,Mt){if(Mt!==void 0&&Mt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if($e===!0)return;if(_t.matrixWorldAutoUpdate===!0&&_t.updateMatrixWorld(),Mt.parent===null&&Mt.matrixWorldAutoUpdate===!0&&Mt.updateMatrixWorld(),mr.enabled===!0&&mr.isPresenting===!0&&(mr.cameraAutoUpdate===!0&&mr.updateCamera(Mt),Mt=mr.getCamera()),_t.isScene===!0&&_t.onBeforeRender(qe,_t,Mt,pt),Se=pa.get(_t,Xe.length),Se.init(Mt),Xe.push(Se),Ln.multiplyMatrices(Mt.projectionMatrix,Mt.matrixWorldInverse),zn.setFromProjectionMatrix(Ln),$r=this.localClippingEnabled,Or=en.init(this.clippingPlanes,$r),Pe=wn.get(_t,Ee.length),Pe.init(),Ee.push(Pe),mr.enabled===!0&&mr.isPresenting===!0){const Zr=qe.xr.getDepthSensingMesh();Zr!==null&&pl(Zr,Mt,-1/0,qe.sortObjects)}pl(_t,Mt,0,qe.sortObjects),Pe.finish(),qe.sortObjects===!0&&Pe.sort(Tr,ln),La=mr.enabled===!1||mr.isPresenting===!1||mr.hasDepthSensing()===!1,La&&Kn.addToRenderList(Pe,_t),this.info.render.frame++,Or===!0&&en.beginShadows();const gr=Se.state.shadowsArray;Rn.render(gr,_t,Mt),Or===!0&&en.endShadows(),this.info.autoReset===!0&&this.info.reset();const vr=Pe.opaque,ir=Pe.transmissive;if(Se.setupLights(),Mt.isArrayCamera){const Zr=Mt.cameras;if(ir.length>0)for(let xn=0,Pn=Zr.length;xn<Pn;xn++){const Dn=Zr[xn];Ao(vr,ir,_t,Dn)}La&&Kn.render(_t);for(let xn=0,Pn=Zr.length;xn<Pn;xn++){const Dn=Zr[xn];Jl(Pe,_t,Dn,Dn.viewport)}}else ir.length>0&&Ao(vr,ir,_t,Mt),La&&Kn.render(_t),Jl(Pe,_t,Mt);pt!==null&&(Dt.updateMultisampleRenderTarget(pt),Dt.updateRenderTargetMipmap(pt)),_t.isScene===!0&&_t.onAfterRender(qe,_t,Mt),Wr.resetDefaultState(),Ht=-1,ur=null,Xe.pop(),Xe.length>0?(Se=Xe[Xe.length-1],Or===!0&&en.setGlobalState(qe.clippingPlanes,Se.state.camera)):Se=null,Ee.pop(),Ee.length>0?Pe=Ee[Ee.length-1]:Pe=null};function pl(_t,Mt,gr,vr){if(_t.visible===!1)return;if(_t.layers.test(Mt.layers)){if(_t.isGroup)gr=_t.renderOrder;else if(_t.isLOD)_t.autoUpdate===!0&&_t.update(Mt);else if(_t.isLight)Se.pushLight(_t),_t.castShadow&&Se.pushShadow(_t);else if(_t.isSprite){if(!_t.frustumCulled||zn.intersectsSprite(_t)){vr&&Jn.setFromMatrixPosition(_t.matrixWorld).applyMatrix4(Ln);const Zr=Ir.update(_t),xn=_t.material;xn.visible&&Pe.push(_t,Zr,xn,gr,Jn.z,null)}}else if((_t.isMesh||_t.isLine||_t.isPoints)&&(!_t.frustumCulled||zn.intersectsObject(_t))){const Zr=Ir.update(_t),xn=_t.material;if(vr&&(_t.boundingSphere!==void 0?(_t.boundingSphere===null&&_t.computeBoundingSphere(),Jn.copy(_t.boundingSphere.center)):(Zr.boundingSphere===null&&Zr.computeBoundingSphere(),Jn.copy(Zr.boundingSphere.center)),Jn.applyMatrix4(_t.matrixWorld).applyMatrix4(Ln)),Array.isArray(xn)){const Pn=Zr.groups;for(let Dn=0,Hn=Pn.length;Dn<Hn;Dn++){const fn=Pn[Dn],kn=xn[fn.materialIndex];kn&&kn.visible&&Pe.push(_t,Zr,kn,gr,Jn.z,fn)}}else xn.visible&&Pe.push(_t,Zr,xn,gr,Jn.z,null)}}const ir=_t.children;for(let Zr=0,xn=ir.length;Zr<xn;Zr++)pl(ir[Zr],Mt,gr,vr)}function Jl(_t,Mt,gr,vr){const ir=_t.opaque,Zr=_t.transmissive,xn=_t.transparent;Se.setupLightsView(gr),Or===!0&&en.setGlobalState(qe.clippingPlanes,gr),vr&&ra.viewport(Ve.copy(vr)),ir.length>0&&Fs(ir,Mt,gr),Zr.length>0&&Fs(Zr,Mt,gr),xn.length>0&&Fs(xn,Mt,gr),ra.buffers.depth.setTest(!0),ra.buffers.depth.setMask(!0),ra.buffers.color.setMask(!0),ra.setPolygonOffset(!1)}function Ao(_t,Mt,gr,vr){if((gr.isScene===!0?gr.overrideMaterial:null)!==null)return;Se.state.transmissionRenderTarget[vr.id]===void 0&&(Se.state.transmissionRenderTarget[vr.id]=new Fl(1,1,{generateMipmaps:!0,type:fa.has("EXT_color_buffer_half_float")||fa.has("EXT_color_buffer_float")?Zu:Is,minFilter:Nl,samples:4,stencilBuffer:l,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Ya.workingColorSpace}));const ir=Se.state.transmissionRenderTarget[vr.id],Zr=vr.viewport||Ve;ir.setSize(Zr.z,Zr.w);const xn=qe.getRenderTarget();qe.setRenderTarget(ir),qe.getClearColor(Zt),Xt=qe.getClearAlpha(),Xt<1&&qe.setClearColor(16777215,.5),qe.clear(),La&&Kn.render(gr);const Pn=qe.toneMapping;qe.toneMapping=tl;const Dn=vr.viewport;if(vr.viewport!==void 0&&(vr.viewport=void 0),Se.setupLightsView(vr),Or===!0&&en.setGlobalState(qe.clippingPlanes,vr),Fs(_t,gr,vr),Dt.updateMultisampleRenderTarget(ir),Dt.updateRenderTargetMipmap(ir),fa.has("WEBGL_multisampled_render_to_texture")===!1){let Hn=!1;for(let fn=0,kn=Mt.length;fn<kn;fn++){const aa=Mt[fn],Ha=aa.object,$a=aa.geometry,yi=aa.material,ei=aa.group;if(yi.side===co&&Ha.layers.test(vr.layers)){const pn=yi.side;yi.side=_o,yi.needsUpdate=!0,Xl(Ha,gr,vr,$a,yi,ei),yi.side=pn,yi.needsUpdate=!0,Hn=!0}}Hn===!0&&(Dt.updateMultisampleRenderTarget(ir),Dt.updateRenderTargetMipmap(ir))}qe.setRenderTarget(xn),qe.setClearColor(Zt,Xt),Dn!==void 0&&(vr.viewport=Dn),qe.toneMapping=Pn}function Fs(_t,Mt,gr){const vr=Mt.isScene===!0?Mt.overrideMaterial:null;for(let ir=0,Zr=_t.length;ir<Zr;ir++){const xn=_t[ir],Pn=xn.object,Dn=xn.geometry,Hn=vr===null?xn.material:vr,fn=xn.group;Pn.layers.test(gr.layers)&&Xl(Pn,Mt,gr,Dn,Hn,fn)}}function Xl(_t,Mt,gr,vr,ir,Zr){_t.onBeforeRender(qe,Mt,gr,vr,ir,Zr),_t.modelViewMatrix.multiplyMatrices(gr.matrixWorldInverse,_t.matrixWorld),_t.normalMatrix.getNormalMatrix(_t.modelViewMatrix),ir.onBeforeRender(qe,Mt,gr,vr,_t,Zr),ir.transparent===!0&&ir.side===co&&ir.forceSinglePass===!1?(ir.side=_o,ir.needsUpdate=!0,qe.renderBufferDirect(gr,Mt,vr,ir,_t,Zr),ir.side=rl,ir.needsUpdate=!0,qe.renderBufferDirect(gr,Mt,vr,ir,_t,Zr),ir.side=co):qe.renderBufferDirect(gr,Mt,vr,ir,_t,Zr),_t.onAfterRender(qe,Mt,gr,vr,ir,Zr)}function Us(_t,Mt,gr){Mt.isScene!==!0&&(Mt=da);const vr=na.get(_t),ir=Se.state.lights,Zr=Se.state.shadowsArray,xn=ir.state.version,Pn=Nn.getParameters(_t,ir.state,Zr,Mt,gr),Dn=Nn.getProgramCacheKey(Pn);let Hn=vr.programs;vr.environment=_t.isMeshStandardMaterial?Mt.environment:null,vr.fog=Mt.fog,vr.envMap=(_t.isMeshStandardMaterial?dr:ut).get(_t.envMap||vr.environment),vr.envMapRotation=vr.environment!==null&&_t.envMap===null?Mt.environmentRotation:_t.envMapRotation,Hn===void 0&&(_t.addEventListener("dispose",Sa),Hn=new Map,vr.programs=Hn);let fn=Hn.get(Dn);if(fn!==void 0){if(vr.currentProgram===fn&&vr.lightsStateVersion===xn)return Ql(_t,Pn),fn}else Pn.uniforms=Nn.getUniforms(_t),_t.onBeforeCompile(Pn,qe),fn=Nn.acquireProgram(Pn,Dn),Hn.set(Dn,fn),vr.uniforms=Pn.uniforms;const kn=vr.uniforms;return(!_t.isShaderMaterial&&!_t.isRawShaderMaterial||_t.clipping===!0)&&(kn.clippingPlanes=en.uniform),Ql(_t,Pn),vr.needsLights=Xc(_t),vr.lightsStateVersion=xn,vr.needsLights&&(kn.ambientLightColor.value=ir.state.ambient,kn.lightProbe.value=ir.state.probe,kn.directionalLights.value=ir.state.directional,kn.directionalLightShadows.value=ir.state.directionalShadow,kn.spotLights.value=ir.state.spot,kn.spotLightShadows.value=ir.state.spotShadow,kn.rectAreaLights.value=ir.state.rectArea,kn.ltc_1.value=ir.state.rectAreaLTC1,kn.ltc_2.value=ir.state.rectAreaLTC2,kn.pointLights.value=ir.state.point,kn.pointLightShadows.value=ir.state.pointShadow,kn.hemisphereLights.value=ir.state.hemi,kn.directionalShadowMap.value=ir.state.directionalShadowMap,kn.directionalShadowMatrix.value=ir.state.directionalShadowMatrix,kn.spotShadowMap.value=ir.state.spotShadowMap,kn.spotLightMatrix.value=ir.state.spotLightMatrix,kn.spotLightMap.value=ir.state.spotLightMap,kn.pointShadowMap.value=ir.state.pointShadowMap,kn.pointShadowMatrix.value=ir.state.pointShadowMatrix),vr.currentProgram=fn,vr.uniformsList=null,fn}function Zl(_t){if(_t.uniformsList===null){const Mt=_t.currentProgram.getUniforms();_t.uniformsList=Mh.seqWithValue(Mt.seq,_t.uniforms)}return _t.uniformsList}function Ql(_t,Mt){const gr=na.get(_t);gr.outputColorSpace=Mt.outputColorSpace,gr.batching=Mt.batching,gr.batchingColor=Mt.batchingColor,gr.instancing=Mt.instancing,gr.instancingColor=Mt.instancingColor,gr.instancingMorph=Mt.instancingMorph,gr.skinning=Mt.skinning,gr.morphTargets=Mt.morphTargets,gr.morphNormals=Mt.morphNormals,gr.morphColors=Mt.morphColors,gr.morphTargetsCount=Mt.morphTargetsCount,gr.numClippingPlanes=Mt.numClippingPlanes,gr.numIntersection=Mt.numClipIntersection,gr.vertexAlphas=Mt.vertexAlphas,gr.vertexTangents=Mt.vertexTangents,gr.toneMapping=Mt.toneMapping}function rs(_t,Mt,gr,vr,ir){Mt.isScene!==!0&&(Mt=da),Dt.resetTextureUnits();const Zr=Mt.fog,xn=vr.isMeshStandardMaterial?Mt.environment:null,Pn=pt===null?qe.outputColorSpace:pt.isXRRenderTarget===!0?pt.texture.colorSpace:ol,Dn=(vr.isMeshStandardMaterial?dr:ut).get(vr.envMap||xn),Hn=vr.vertexColors===!0&&!!gr.attributes.color&&gr.attributes.color.itemSize===4,fn=!!gr.attributes.tangent&&(!!vr.normalMap||vr.anisotropy>0),kn=!!gr.morphAttributes.position,aa=!!gr.morphAttributes.normal,Ha=!!gr.morphAttributes.color;let $a=tl;vr.toneMapped&&(pt===null||pt.isXRRenderTarget===!0)&&($a=qe.toneMapping);const yi=gr.morphAttributes.position||gr.morphAttributes.normal||gr.morphAttributes.color,ei=yi!==void 0?yi.length:0,pn=na.get(vr),xi=Se.state.lights;if(Or===!0&&($r===!0||_t!==ur)){const Qi=_t===ur&&vr.id===Ht;en.setState(vr,_t,Qi)}let fi=!1;vr.version===pn.__version?(pn.needsLights&&pn.lightsStateVersion!==xi.state.version||pn.outputColorSpace!==Pn||ir.isBatchedMesh&&pn.batching===!1||!ir.isBatchedMesh&&pn.batching===!0||ir.isBatchedMesh&&pn.batchingColor===!0&&ir.colorTexture===null||ir.isBatchedMesh&&pn.batchingColor===!1&&ir.colorTexture!==null||ir.isInstancedMesh&&pn.instancing===!1||!ir.isInstancedMesh&&pn.instancing===!0||ir.isSkinnedMesh&&pn.skinning===!1||!ir.isSkinnedMesh&&pn.skinning===!0||ir.isInstancedMesh&&pn.instancingColor===!0&&ir.instanceColor===null||ir.isInstancedMesh&&pn.instancingColor===!1&&ir.instanceColor!==null||ir.isInstancedMesh&&pn.instancingMorph===!0&&ir.morphTexture===null||ir.isInstancedMesh&&pn.instancingMorph===!1&&ir.morphTexture!==null||pn.envMap!==Dn||vr.fog===!0&&pn.fog!==Zr||pn.numClippingPlanes!==void 0&&(pn.numClippingPlanes!==en.numPlanes||pn.numIntersection!==en.numIntersection)||pn.vertexAlphas!==Hn||pn.vertexTangents!==fn||pn.morphTargets!==kn||pn.morphNormals!==aa||pn.morphColors!==Ha||pn.toneMapping!==$a||pn.morphTargetsCount!==ei)&&(fi=!0):(fi=!0,pn.__version=vr.version);let ja=pn.currentProgram;fi===!0&&(ja=Us(vr,Mt,ir));let Di=!1,Fi=!1,to=!1;const ri=ja.getUniforms(),Wi=pn.uniforms;if(ra.useProgram(ja.program)&&(Di=!0,Fi=!0,to=!0),vr.id!==Ht&&(Ht=vr.id,Fi=!0),Di||ur!==_t){ya.reverseDepthBuffer?(En.copy(_t.projectionMatrix),Ww(En),Yw(En),ri.setValue(tr,"projectionMatrix",En)):ri.setValue(tr,"projectionMatrix",_t.projectionMatrix),ri.setValue(tr,"viewMatrix",_t.matrixWorldInverse);const Qi=ri.map.cameraPosition;Qi!==void 0&&Qi.setValue(tr,ta.setFromMatrixPosition(_t.matrixWorld)),ya.logarithmicDepthBuffer&&ri.setValue(tr,"logDepthBufFC",2/(Math.log(_t.far+1)/Math.LN2)),(vr.isMeshPhongMaterial||vr.isMeshToonMaterial||vr.isMeshLambertMaterial||vr.isMeshBasicMaterial||vr.isMeshStandardMaterial||vr.isShaderMaterial)&&ri.setValue(tr,"isOrthographic",_t.isOrthographicCamera===!0),ur!==_t&&(ur=_t,Fi=!0,to=!0)}if(ir.isSkinnedMesh){ri.setOptional(tr,ir,"bindMatrix"),ri.setOptional(tr,ir,"bindMatrixInverse");const Qi=ir.skeleton;Qi&&(Qi.boneTexture===null&&Qi.computeBoneTexture(),ri.setValue(tr,"boneTexture",Qi.boneTexture,Dt))}ir.isBatchedMesh&&(ri.setOptional(tr,ir,"batchingTexture"),ri.setValue(tr,"batchingTexture",ir._matricesTexture,Dt),ri.setOptional(tr,ir,"batchingIdTexture"),ri.setValue(tr,"batchingIdTexture",ir._indirectTexture,Dt),ri.setOptional(tr,ir,"batchingColorTexture"),ir._colorsTexture!==null&&ri.setValue(tr,"batchingColorTexture",ir._colorsTexture,Dt));const ns=gr.morphAttributes;if((ns.position!==void 0||ns.normal!==void 0||ns.color!==void 0)&&$n.update(ir,gr,ja),(Fi||pn.receiveShadow!==ir.receiveShadow)&&(pn.receiveShadow=ir.receiveShadow,ri.setValue(tr,"receiveShadow",ir.receiveShadow)),vr.isMeshGouraudMaterial&&vr.envMap!==null&&(Wi.envMap.value=Dn,Wi.flipEnvMap.value=Dn.isCubeTexture&&Dn.isRenderTargetTexture===!1?-1:1),vr.isMeshStandardMaterial&&vr.envMap===null&&Mt.environment!==null&&(Wi.envMapIntensity.value=Mt.environmentIntensity),Fi&&(ri.setValue(tr,"toneMappingExposure",qe.toneMappingExposure),pn.needsLights&&Jc(Wi,to),Zr&&vr.fog===!0&&hn.refreshFogUniforms(Wi,Zr),hn.refreshMaterialUniforms(Wi,vr,Qr,cr,Se.state.transmissionRenderTarget[_t.id]),Mh.upload(tr,Zl(pn),Wi,Dt)),vr.isShaderMaterial&&vr.uniformsNeedUpdate===!0&&(Mh.upload(tr,Zl(pn),Wi,Dt),vr.uniformsNeedUpdate=!1),vr.isSpriteMaterial&&ri.setValue(tr,"center",ir.center),ri.setValue(tr,"modelViewMatrix",ir.modelViewMatrix),ri.setValue(tr,"normalMatrix",ir.normalMatrix),ri.setValue(tr,"modelMatrix",ir.matrixWorld),vr.isShaderMaterial||vr.isRawShaderMaterial){const Qi=vr.uniformsGroups;for(let Bs=0,ml=Qi.length;Bs<ml;Bs++){const gl=Qi[Bs];qt.update(gl,ja),qt.bind(gl,ja)}}return ja}function Jc(_t,Mt){_t.ambientLightColor.needsUpdate=Mt,_t.lightProbe.needsUpdate=Mt,_t.directionalLights.needsUpdate=Mt,_t.directionalLightShadows.needsUpdate=Mt,_t.pointLights.needsUpdate=Mt,_t.pointLightShadows.needsUpdate=Mt,_t.spotLights.needsUpdate=Mt,_t.spotLightShadows.needsUpdate=Mt,_t.rectAreaLights.needsUpdate=Mt,_t.hemisphereLights.needsUpdate=Mt}function Xc(_t){return _t.isMeshLambertMaterial||_t.isMeshToonMaterial||_t.isMeshPhongMaterial||_t.isMeshStandardMaterial||_t.isShadowMaterial||_t.isShaderMaterial&&_t.lights===!0}this.getActiveCubeFace=function(){return ft},this.getActiveMipmapLevel=function(){return gt},this.getRenderTarget=function(){return pt},this.setRenderTargetTextures=function(_t,Mt,gr){na.get(_t.texture).__webglTexture=Mt,na.get(_t.depthTexture).__webglTexture=gr;const vr=na.get(_t);vr.__hasExternalTextures=!0,vr.__autoAllocateDepthBuffer=gr===void 0,vr.__autoAllocateDepthBuffer||fa.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),vr.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(_t,Mt){const gr=na.get(_t);gr.__webglFramebuffer=Mt,gr.__useDefaultFramebuffer=Mt===void 0},this.setRenderTarget=function(_t,Mt=0,gr=0){pt=_t,ft=Mt,gt=gr;let vr=!0,ir=null,Zr=!1,xn=!1;if(_t){const Pn=na.get(_t);if(Pn.__useDefaultFramebuffer!==void 0)ra.bindFramebuffer(tr.FRAMEBUFFER,null),vr=!1;else if(Pn.__webglFramebuffer===void 0)Dt.setupRenderTarget(_t);else if(Pn.__hasExternalTextures)Dt.rebindTextures(_t,na.get(_t.texture).__webglTexture,na.get(_t.depthTexture).__webglTexture);else if(_t.depthBuffer){const fn=_t.depthTexture;if(Pn.__boundDepthTexture!==fn){if(fn!==null&&na.has(fn)&&(_t.width!==fn.image.width||_t.height!==fn.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Dt.setupDepthRenderbuffer(_t)}}const Dn=_t.texture;(Dn.isData3DTexture||Dn.isDataArrayTexture||Dn.isCompressedArrayTexture)&&(xn=!0);const Hn=na.get(_t).__webglFramebuffer;_t.isWebGLCubeRenderTarget?(Array.isArray(Hn[Mt])?ir=Hn[Mt][gr]:ir=Hn[Mt],Zr=!0):_t.samples>0&&Dt.useMultisampledRTT(_t)===!1?ir=na.get(_t).__webglMultisampledFramebuffer:Array.isArray(Hn)?ir=Hn[gr]:ir=Hn,Ve.copy(_t.viewport),nt.copy(_t.scissor),nr=_t.scissorTest}else Ve.copy(Sn).multiplyScalar(Qr).floor(),nt.copy(Wn).multiplyScalar(Qr).floor(),nr=Ma;if(ra.bindFramebuffer(tr.FRAMEBUFFER,ir)&&vr&&ra.drawBuffers(_t,ir),ra.viewport(Ve),ra.scissor(nt),ra.setScissorTest(nr),Zr){const Pn=na.get(_t.texture);tr.framebufferTexture2D(tr.FRAMEBUFFER,tr.COLOR_ATTACHMENT0,tr.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,Pn.__webglTexture,gr)}else if(xn){const Pn=na.get(_t.texture),Dn=Mt||0;tr.framebufferTextureLayer(tr.FRAMEBUFFER,tr.COLOR_ATTACHMENT0,Pn.__webglTexture,gr||0,Dn)}Ht=-1},this.readRenderTargetPixels=function(_t,Mt,gr,vr,ir,Zr,xn){if(!(_t&&_t.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Pn=na.get(_t).__webglFramebuffer;if(_t.isWebGLCubeRenderTarget&&xn!==void 0&&(Pn=Pn[xn]),Pn){ra.bindFramebuffer(tr.FRAMEBUFFER,Pn);try{const Dn=_t.texture,Hn=Dn.format,fn=Dn.type;if(!ya.textureFormatReadable(Hn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!ya.textureTypeReadable(fn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Mt>=0&&Mt<=_t.width-vr&&gr>=0&&gr<=_t.height-ir&&tr.readPixels(Mt,gr,vr,ir,Ft.convert(Hn),Ft.convert(fn),Zr)}finally{const Dn=pt!==null?na.get(pt).__webglFramebuffer:null;ra.bindFramebuffer(tr.FRAMEBUFFER,Dn)}}},this.readRenderTargetPixelsAsync=async function(_t,Mt,gr,vr,ir,Zr,xn){if(!(_t&&_t.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Pn=na.get(_t).__webglFramebuffer;if(_t.isWebGLCubeRenderTarget&&xn!==void 0&&(Pn=Pn[xn]),Pn){const Dn=_t.texture,Hn=Dn.format,fn=Dn.type;if(!ya.textureFormatReadable(Hn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!ya.textureTypeReadable(fn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(Mt>=0&&Mt<=_t.width-vr&&gr>=0&&gr<=_t.height-ir){ra.bindFramebuffer(tr.FRAMEBUFFER,Pn);const kn=tr.createBuffer();tr.bindBuffer(tr.PIXEL_PACK_BUFFER,kn),tr.bufferData(tr.PIXEL_PACK_BUFFER,Zr.byteLength,tr.STREAM_READ),tr.readPixels(Mt,gr,vr,ir,Ft.convert(Hn),Ft.convert(fn),0);const aa=pt!==null?na.get(pt).__webglFramebuffer:null;ra.bindFramebuffer(tr.FRAMEBUFFER,aa);const Ha=tr.fenceSync(tr.SYNC_GPU_COMMANDS_COMPLETE,0);return tr.flush(),await jw(tr,Ha,4),tr.bindBuffer(tr.PIXEL_PACK_BUFFER,kn),tr.getBufferSubData(tr.PIXEL_PACK_BUFFER,0,Zr),tr.deleteBuffer(kn),tr.deleteSync(Ha),Zr}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(_t,Mt=null,gr=0){_t.isTexture!==!0&&(wh("WebGLRenderer: copyFramebufferToTexture function signature has changed."),Mt=arguments[0]||null,_t=arguments[1]);const vr=Math.pow(2,-gr),ir=Math.floor(_t.image.width*vr),Zr=Math.floor(_t.image.height*vr),xn=Mt!==null?Mt.x:0,Pn=Mt!==null?Mt.y:0;Dt.setTexture2D(_t,0),tr.copyTexSubImage2D(tr.TEXTURE_2D,gr,0,0,xn,Pn,ir,Zr),ra.unbindTexture()},this.copyTextureToTexture=function(_t,Mt,gr=null,vr=null,ir=0){_t.isTexture!==!0&&(wh("WebGLRenderer: copyTextureToTexture function signature has changed."),vr=arguments[0]||null,_t=arguments[1],Mt=arguments[2],ir=arguments[3]||0,gr=null);let Zr,xn,Pn,Dn,Hn,fn;gr!==null?(Zr=gr.max.x-gr.min.x,xn=gr.max.y-gr.min.y,Pn=gr.min.x,Dn=gr.min.y):(Zr=_t.image.width,xn=_t.image.height,Pn=0,Dn=0),vr!==null?(Hn=vr.x,fn=vr.y):(Hn=0,fn=0);const kn=Ft.convert(Mt.format),aa=Ft.convert(Mt.type);Dt.setTexture2D(Mt,0),tr.pixelStorei(tr.UNPACK_FLIP_Y_WEBGL,Mt.flipY),tr.pixelStorei(tr.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Mt.premultiplyAlpha),tr.pixelStorei(tr.UNPACK_ALIGNMENT,Mt.unpackAlignment);const Ha=tr.getParameter(tr.UNPACK_ROW_LENGTH),$a=tr.getParameter(tr.UNPACK_IMAGE_HEIGHT),yi=tr.getParameter(tr.UNPACK_SKIP_PIXELS),ei=tr.getParameter(tr.UNPACK_SKIP_ROWS),pn=tr.getParameter(tr.UNPACK_SKIP_IMAGES),xi=_t.isCompressedTexture?_t.mipmaps[ir]:_t.image;tr.pixelStorei(tr.UNPACK_ROW_LENGTH,xi.width),tr.pixelStorei(tr.UNPACK_IMAGE_HEIGHT,xi.height),tr.pixelStorei(tr.UNPACK_SKIP_PIXELS,Pn),tr.pixelStorei(tr.UNPACK_SKIP_ROWS,Dn),_t.isDataTexture?tr.texSubImage2D(tr.TEXTURE_2D,ir,Hn,fn,Zr,xn,kn,aa,xi.data):_t.isCompressedTexture?tr.compressedTexSubImage2D(tr.TEXTURE_2D,ir,Hn,fn,xi.width,xi.height,kn,xi.data):tr.texSubImage2D(tr.TEXTURE_2D,ir,Hn,fn,Zr,xn,kn,aa,xi),tr.pixelStorei(tr.UNPACK_ROW_LENGTH,Ha),tr.pixelStorei(tr.UNPACK_IMAGE_HEIGHT,$a),tr.pixelStorei(tr.UNPACK_SKIP_PIXELS,yi),tr.pixelStorei(tr.UNPACK_SKIP_ROWS,ei),tr.pixelStorei(tr.UNPACK_SKIP_IMAGES,pn),ir===0&&Mt.generateMipmaps&&tr.generateMipmap(tr.TEXTURE_2D),ra.unbindTexture()},this.copyTextureToTexture3D=function(_t,Mt,gr=null,vr=null,ir=0){_t.isTexture!==!0&&(wh("WebGLRenderer: copyTextureToTexture3D function signature has changed."),gr=arguments[0]||null,vr=arguments[1]||null,_t=arguments[2],Mt=arguments[3],ir=arguments[4]||0);let Zr,xn,Pn,Dn,Hn,fn,kn,aa,Ha;const $a=_t.isCompressedTexture?_t.mipmaps[ir]:_t.image;gr!==null?(Zr=gr.max.x-gr.min.x,xn=gr.max.y-gr.min.y,Pn=gr.max.z-gr.min.z,Dn=gr.min.x,Hn=gr.min.y,fn=gr.min.z):(Zr=$a.width,xn=$a.height,Pn=$a.depth,Dn=0,Hn=0,fn=0),vr!==null?(kn=vr.x,aa=vr.y,Ha=vr.z):(kn=0,aa=0,Ha=0);const yi=Ft.convert(Mt.format),ei=Ft.convert(Mt.type);let pn;if(Mt.isData3DTexture)Dt.setTexture3D(Mt,0),pn=tr.TEXTURE_3D;else if(Mt.isDataArrayTexture||Mt.isCompressedArrayTexture)Dt.setTexture2DArray(Mt,0),pn=tr.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}tr.pixelStorei(tr.UNPACK_FLIP_Y_WEBGL,Mt.flipY),tr.pixelStorei(tr.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Mt.premultiplyAlpha),tr.pixelStorei(tr.UNPACK_ALIGNMENT,Mt.unpackAlignment);const xi=tr.getParameter(tr.UNPACK_ROW_LENGTH),fi=tr.getParameter(tr.UNPACK_IMAGE_HEIGHT),ja=tr.getParameter(tr.UNPACK_SKIP_PIXELS),Di=tr.getParameter(tr.UNPACK_SKIP_ROWS),Fi=tr.getParameter(tr.UNPACK_SKIP_IMAGES);tr.pixelStorei(tr.UNPACK_ROW_LENGTH,$a.width),tr.pixelStorei(tr.UNPACK_IMAGE_HEIGHT,$a.height),tr.pixelStorei(tr.UNPACK_SKIP_PIXELS,Dn),tr.pixelStorei(tr.UNPACK_SKIP_ROWS,Hn),tr.pixelStorei(tr.UNPACK_SKIP_IMAGES,fn),_t.isDataTexture||_t.isData3DTexture?tr.texSubImage3D(pn,ir,kn,aa,Ha,Zr,xn,Pn,yi,ei,$a.data):Mt.isCompressedArrayTexture?tr.compressedTexSubImage3D(pn,ir,kn,aa,Ha,Zr,xn,Pn,yi,$a.data):tr.texSubImage3D(pn,ir,kn,aa,Ha,Zr,xn,Pn,yi,ei,$a),tr.pixelStorei(tr.UNPACK_ROW_LENGTH,xi),tr.pixelStorei(tr.UNPACK_IMAGE_HEIGHT,fi),tr.pixelStorei(tr.UNPACK_SKIP_PIXELS,ja),tr.pixelStorei(tr.UNPACK_SKIP_ROWS,Di),tr.pixelStorei(tr.UNPACK_SKIP_IMAGES,Fi),ir===0&&Mt.generateMipmaps&&tr.generateMipmap(pn),ra.unbindTexture()},this.initRenderTarget=function(_t){na.get(_t).__webglFramebuffer===void 0&&Dt.setupRenderTarget(_t)},this.initTexture=function(_t){_t.isCubeTexture?Dt.setTextureCube(_t,0):_t.isData3DTexture?Dt.setTexture3D(_t,0):_t.isDataArrayTexture||_t.isCompressedArrayTexture?Dt.setTexture2DArray(_t,0):Dt.setTexture2D(_t,0),ra.unbindTexture()},this.resetState=function(){ft=0,gt=0,pt=null,ra.reset(),Wr.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ns}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===pm?"display-p3":"srgb",t.unpackColorSpace=Ya.workingColorSpace===Wh?"display-p3":"srgb"}}class E0 extends Ei{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Ko,this.environmentIntensity=1,this.environmentRotation=new Ko,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class nS{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=S0,this.updateRanges=[],this.version=0,this.uuid=vs()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let a=0,l=this.stride;a<l;a++)this.array[e+a]=t.array[r+a];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=vs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=vs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const go=new st;class Ph{constructor(e,t,r,a=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=a}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)go.fromBufferAttribute(this,t),go.applyMatrix4(e),this.setXYZ(t,go.x,go.y,go.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)go.fromBufferAttribute(this,t),go.applyNormalMatrix(e),this.setXYZ(t,go.x,go.y,go.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)go.fromBufferAttribute(this,t),go.transformDirection(e),this.setXYZ(t,go.x,go.y,go.z);return this}getComponent(e,t){let r=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(r=Qo(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Qa(r,this.array)),this.data.array[e*this.data.stride+this.offset+t]=r,this}setX(e,t){return this.normalized&&(t=Qa(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Qa(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Qa(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Qa(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Qo(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Qo(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Qo(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Qo(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Qa(t,this.array),r=Qa(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=Qa(t,this.array),r=Qa(r,this.array),a=Qa(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=a,this}setXYZW(e,t,r,a,l){return e=e*this.data.stride+this.offset,this.normalized&&(t=Qa(t,this.array),r=Qa(r,this.array),a=Qa(a,this.array),l=Qa(l,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=a,this.data.array[e+3]=l,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const a=r*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[a+l])}return new Xi(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ph(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const a=r*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[a+l])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Jh extends zs{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new qn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let wc;const mu=new st,Mc=new st,Tc=new st,Ac=new Jr,gu=new Jr,T2=new jn,Kd=new st,vu=new st,$d=new st,xv=new Jr,Tp=new Jr,_v=new Jr;class xm extends Ei{constructor(e=new Jh){if(super(),this.isSprite=!0,this.type="Sprite",wc===void 0){wc=new di;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new nS(t,5);wc.setIndex([0,1,2,0,2,3]),wc.setAttribute("position",new Ph(r,3,0,!1)),wc.setAttribute("uv",new Ph(r,2,3,!1))}this.geometry=wc,this.material=e,this.center=new Jr(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Mc.setFromMatrixScale(this.matrixWorld),T2.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Tc.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Mc.multiplyScalar(-Tc.z);const r=this.material.rotation;let a,l;r!==0&&(l=Math.cos(r),a=Math.sin(r));const x=this.center;eh(Kd.set(-.5,-.5,0),Tc,x,Mc,a,l),eh(vu.set(.5,-.5,0),Tc,x,Mc,a,l),eh($d.set(.5,.5,0),Tc,x,Mc,a,l),xv.set(0,0),Tp.set(1,0),_v.set(1,1);let _=e.ray.intersectTriangle(Kd,vu,$d,!1,mu);if(_===null&&(eh(vu.set(-.5,.5,0),Tc,x,Mc,a,l),Tp.set(0,1),_=e.ray.intersectTriangle(Kd,$d,vu,!1,mu),_===null))return;const O=e.ray.origin.distanceTo(mu);O<e.near||O>e.far||t.push({distance:O,point:mu.clone(),uv:ko.getInterpolation(mu,Kd,vu,$d,xv,Tp,_v,new Jr),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function eh(n,e,t,r,a,l){Ac.subVectors(n,t).addScalar(.5).multiply(r),a!==void 0?(gu.x=l*Ac.x-a*Ac.y,gu.y=a*Ac.x+l*Ac.y):gu.copy(Ac),n.copy(e),n.x+=gu.x,n.y+=gu.y,n.applyMatrix4(T2)}class A2 extends uo{constructor(e=null,t=1,r=1,a,l,x,_,O,z=To,q=To,oe,ue){super(null,x,_,O,z,q,a,l,oe,ue),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class bv extends Xi{constructor(e,t,r,a=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=a}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Sc=new jn,wv=new jn,th=[],Mv=new ys,aS=new jn,yu=new Ci,xu=new Vl;class Ul extends Ci{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new bv(new Float32Array(r*16),16),this.instanceColor=null,this.morphTexture=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let a=0;a<r;a++)this.setMatrixAt(a,aS)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new ys),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,Sc),Mv.copy(e.boundingBox).applyMatrix4(Sc),this.boundingBox.union(Mv)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Vl),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,Sc),xu.copy(e.boundingSphere).applyMatrix4(Sc),this.boundingSphere.union(xu)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const r=t.morphTargetInfluences,a=this.morphTexture.source.data.data,l=r.length+1,x=e*l+1;for(let _=0;_<r.length;_++)r[_]=a[x+_]}raycast(e,t){const r=this.matrixWorld,a=this.count;if(yu.geometry=this.geometry,yu.material=this.material,yu.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),xu.copy(this.boundingSphere),xu.applyMatrix4(r),e.ray.intersectsSphere(xu)!==!1))for(let l=0;l<a;l++){this.getMatrixAt(l,Sc),wv.multiplyMatrices(r,Sc),yu.matrixWorld=wv,yu.raycast(e,th);for(let x=0,_=th.length;x<_;x++){const O=th[x];O.instanceId=l,O.object=this,t.push(O)}th.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new bv(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const r=t.morphTargetInfluences,a=r.length+1;this.morphTexture===null&&(this.morphTexture=new A2(new Float32Array(a*this.count),a,this.count,cm,ms));const l=this.morphTexture.source.data.data;let x=0;for(let z=0;z<r.length;z++)x+=r[z];const _=this.geometry.morphTargetsRelative?1:1-x,O=a*e;l[O]=_,l.set(r,O+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}class jc extends zs{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new qn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Oh=new st,Nh=new st,Tv=new jn,_u=new Qu,rh=new Vl,Ap=new st,Av=new st;class iS extends Ei{constructor(e=new di,t=new jc){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let a=1,l=t.count;a<l;a++)Oh.fromBufferAttribute(t,a-1),Nh.fromBufferAttribute(t,a),r[a]=r[a-1],r[a]+=Oh.distanceTo(Nh);e.setAttribute("lineDistance",new qa(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,a=this.matrixWorld,l=e.params.Line.threshold,x=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),rh.copy(r.boundingSphere),rh.applyMatrix4(a),rh.radius+=l,e.ray.intersectsSphere(rh)===!1)return;Tv.copy(a).invert(),_u.copy(e.ray).applyMatrix4(Tv);const _=l/((this.scale.x+this.scale.y+this.scale.z)/3),O=_*_,z=this.isLineSegments?2:1,q=r.index,oe=r.attributes.position;if(q!==null){const ue=Math.max(0,x.start),_e=Math.min(q.count,x.start+x.count);for(let be=ue,Pe=_e-1;be<Pe;be+=z){const Se=q.getX(be),Ee=q.getX(be+1),Xe=nh(this,e,_u,O,Se,Ee);Xe&&t.push(Xe)}if(this.isLineLoop){const be=q.getX(_e-1),Pe=q.getX(ue),Se=nh(this,e,_u,O,be,Pe);Se&&t.push(Se)}}else{const ue=Math.max(0,x.start),_e=Math.min(oe.count,x.start+x.count);for(let be=ue,Pe=_e-1;be<Pe;be+=z){const Se=nh(this,e,_u,O,be,be+1);Se&&t.push(Se)}if(this.isLineLoop){const be=nh(this,e,_u,O,_e-1,ue);be&&t.push(be)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,l=r.length;a<l;a++){const x=r[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[x]=a}}}}}function nh(n,e,t,r,a,l){const x=n.geometry.attributes.position;if(Oh.fromBufferAttribute(x,a),Nh.fromBufferAttribute(x,l),t.distanceSqToSegment(Oh,Nh,Ap,Av)>r)return;Ap.applyMatrix4(n.matrixWorld);const _=e.ray.origin.distanceTo(Ap);if(!(_<e.near||_>e.far))return{distance:_,point:Av.clone().applyMatrix4(n.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:n}}const Sv=new st,Cv=new st;class zu extends iS{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let a=0,l=t.count;a<l;a+=2)Sv.fromBufferAttribute(t,a),Cv.fromBufferAttribute(t,a+1),r[a]=a===0?0:r[a-1],r[a+1]=r[a]+Sv.distanceTo(Cv);e.setAttribute("lineDistance",new qa(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class S2 extends zs{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new qn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Ev=new jn,L0=new Qu,ah=new Vl,ih=new st;class oS extends Ei{constructor(e=new di,t=new S2){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,a=this.matrixWorld,l=e.params.Points.threshold,x=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),ah.copy(r.boundingSphere),ah.applyMatrix4(a),ah.radius+=l,e.ray.intersectsSphere(ah)===!1)return;Ev.copy(a).invert(),L0.copy(e.ray).applyMatrix4(Ev);const _=l/((this.scale.x+this.scale.y+this.scale.z)/3),O=_*_,z=r.index,q=r.attributes.position;if(z!==null){const oe=Math.max(0,x.start),ue=Math.min(z.count,x.start+x.count);for(let _e=oe,be=ue;_e<be;_e++){const Pe=z.getX(_e);ih.fromBufferAttribute(q,Pe),Lv(ih,Pe,O,a,e,t,this)}}else{const oe=Math.max(0,x.start),ue=Math.min(q.count,x.start+x.count);for(let _e=oe,be=ue;_e<be;_e++)ih.fromBufferAttribute(q,_e),Lv(ih,_e,O,a,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,l=r.length;a<l;a++){const x=r[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[x]=a}}}}}function Lv(n,e,t,r,a,l,x){const _=L0.distanceSqToPoint(n);if(_<t){const O=new st;L0.closestPointToPoint(n,O),O.applyMatrix4(r);const z=a.ray.origin.distanceTo(O);if(z<a.near||z>a.far)return;l.push({distance:z,distanceToRay:Math.sqrt(_),point:O,index:e,face:null,faceIndex:null,barycoord:null,object:x})}}class _m extends uo{constructor(e,t,r,a,l,x,_,O,z){super(e,t,r,a,l,x,_,O,z),this.isCanvasTexture=!0,this.needsUpdate=!0}}class _s{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,a=this.getPoint(0),l=0;t.push(0);for(let x=1;x<=e;x++)r=this.getPoint(x/e),l+=r.distanceTo(a),t.push(l),a=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const r=this.getLengths();let a=0;const l=r.length;let x;t?x=t:x=e*r[l-1];let _=0,O=l-1,z;for(;_<=O;)if(a=Math.floor(_+(O-_)/2),z=r[a]-x,z<0)_=a+1;else if(z>0)O=a-1;else{O=a;break}if(a=O,r[a]===x)return a/(l-1);const q=r[a],oe=r[a+1]-q,ue=(x-q)/oe;return(a+ue)/(l-1)}getTangent(e,t){let r=e-1e-4,a=e+1e-4;r<0&&(r=0),a>1&&(a=1);const l=this.getPoint(r),x=this.getPoint(a),_=t||(l.isVector2?new Jr:new st);return _.copy(x).sub(l).normalize(),_}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){const r=new st,a=[],l=[],x=[],_=new st,O=new jn;for(let _e=0;_e<=e;_e++){const be=_e/e;a[_e]=this.getTangentAt(be,new st)}l[0]=new st,x[0]=new st;let z=Number.MAX_VALUE;const q=Math.abs(a[0].x),oe=Math.abs(a[0].y),ue=Math.abs(a[0].z);q<=z&&(z=q,r.set(1,0,0)),oe<=z&&(z=oe,r.set(0,1,0)),ue<=z&&r.set(0,0,1),_.crossVectors(a[0],r).normalize(),l[0].crossVectors(a[0],_),x[0].crossVectors(a[0],l[0]);for(let _e=1;_e<=e;_e++){if(l[_e]=l[_e-1].clone(),x[_e]=x[_e-1].clone(),_.crossVectors(a[_e-1],a[_e]),_.length()>Number.EPSILON){_.normalize();const be=Math.acos(Vi(a[_e-1].dot(a[_e]),-1,1));l[_e].applyMatrix4(O.makeRotationAxis(_,be))}x[_e].crossVectors(a[_e],l[_e])}if(t===!0){let _e=Math.acos(Vi(l[0].dot(l[e]),-1,1));_e/=e,a[0].dot(_.crossVectors(l[0],l[e]))>0&&(_e=-_e);for(let be=1;be<=e;be++)l[be].applyMatrix4(O.makeRotationAxis(a[be],_e*be)),x[be].crossVectors(a[be],l[be])}return{tangents:a,normals:l,binormals:x}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class bm extends _s{constructor(e=0,t=0,r=1,a=1,l=0,x=Math.PI*2,_=!1,O=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=a,this.aStartAngle=l,this.aEndAngle=x,this.aClockwise=_,this.aRotation=O}getPoint(e,t=new Jr){const r=t,a=Math.PI*2;let l=this.aEndAngle-this.aStartAngle;const x=Math.abs(l)<Number.EPSILON;for(;l<0;)l+=a;for(;l>a;)l-=a;l<Number.EPSILON&&(x?l=0:l=a),this.aClockwise===!0&&!x&&(l===a?l=-a:l=l-a);const _=this.aStartAngle+e*l;let O=this.aX+this.xRadius*Math.cos(_),z=this.aY+this.yRadius*Math.sin(_);if(this.aRotation!==0){const q=Math.cos(this.aRotation),oe=Math.sin(this.aRotation),ue=O-this.aX,_e=z-this.aY;O=ue*q-_e*oe+this.aX,z=ue*oe+_e*q+this.aY}return r.set(O,z)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class sS extends bm{constructor(e,t,r,a,l,x){super(e,t,r,r,a,l,x),this.isArcCurve=!0,this.type="ArcCurve"}}function wm(){let n=0,e=0,t=0,r=0;function a(l,x,_,O){n=l,e=_,t=-3*l+3*x-2*_-O,r=2*l-2*x+_+O}return{initCatmullRom:function(l,x,_,O,z){a(x,_,z*(_-l),z*(O-x))},initNonuniformCatmullRom:function(l,x,_,O,z,q,oe){let ue=(x-l)/z-(_-l)/(z+q)+(_-x)/q,_e=(_-x)/q-(O-x)/(q+oe)+(O-_)/oe;ue*=q,_e*=q,a(x,_,ue,_e)},calc:function(l){const x=l*l,_=x*l;return n+e*l+t*x+r*_}}}const oh=new st,Sp=new wm,Cp=new wm,Ep=new wm;class lS extends _s{constructor(e=[],t=!1,r="centripetal",a=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=a}getPoint(e,t=new st){const r=t,a=this.points,l=a.length,x=(l-(this.closed?0:1))*e;let _=Math.floor(x),O=x-_;this.closed?_+=_>0?0:(Math.floor(Math.abs(_)/l)+1)*l:O===0&&_===l-1&&(_=l-2,O=1);let z,q;this.closed||_>0?z=a[(_-1)%l]:(oh.subVectors(a[0],a[1]).add(a[0]),z=oh);const oe=a[_%l],ue=a[(_+1)%l];if(this.closed||_+2<l?q=a[(_+2)%l]:(oh.subVectors(a[l-1],a[l-2]).add(a[l-1]),q=oh),this.curveType==="centripetal"||this.curveType==="chordal"){const _e=this.curveType==="chordal"?.5:.25;let be=Math.pow(z.distanceToSquared(oe),_e),Pe=Math.pow(oe.distanceToSquared(ue),_e),Se=Math.pow(ue.distanceToSquared(q),_e);Pe<1e-4&&(Pe=1),be<1e-4&&(be=Pe),Se<1e-4&&(Se=Pe),Sp.initNonuniformCatmullRom(z.x,oe.x,ue.x,q.x,be,Pe,Se),Cp.initNonuniformCatmullRom(z.y,oe.y,ue.y,q.y,be,Pe,Se),Ep.initNonuniformCatmullRom(z.z,oe.z,ue.z,q.z,be,Pe,Se)}else this.curveType==="catmullrom"&&(Sp.initCatmullRom(z.x,oe.x,ue.x,q.x,this.tension),Cp.initCatmullRom(z.y,oe.y,ue.y,q.y,this.tension),Ep.initCatmullRom(z.z,oe.z,ue.z,q.z,this.tension));return r.set(Sp.calc(O),Cp.calc(O),Ep.calc(O)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const a=e.points[t];this.points.push(a.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const a=this.points[t];e.points.push(a.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const a=e.points[t];this.points.push(new st().fromArray(a))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Rv(n,e,t,r,a){const l=(r-e)*.5,x=(a-t)*.5,_=n*n,O=n*_;return(2*t-2*r+l+x)*O+(-3*t+3*r-2*l-x)*_+l*n+t}function cS(n,e){const t=1-n;return t*t*e}function uS(n,e){return 2*(1-n)*n*e}function dS(n,e){return n*n*e}function Fu(n,e,t,r){return cS(n,e)+uS(n,t)+dS(n,r)}function hS(n,e){const t=1-n;return t*t*t*e}function fS(n,e){const t=1-n;return 3*t*t*n*e}function pS(n,e){return 3*(1-n)*n*n*e}function mS(n,e){return n*n*n*e}function Uu(n,e,t,r,a){return hS(n,e)+fS(n,t)+pS(n,r)+mS(n,a)}class C2 extends _s{constructor(e=new Jr,t=new Jr,r=new Jr,a=new Jr){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=a}getPoint(e,t=new Jr){const r=t,a=this.v0,l=this.v1,x=this.v2,_=this.v3;return r.set(Uu(e,a.x,l.x,x.x,_.x),Uu(e,a.y,l.y,x.y,_.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class gS extends _s{constructor(e=new st,t=new st,r=new st,a=new st){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=a}getPoint(e,t=new st){const r=t,a=this.v0,l=this.v1,x=this.v2,_=this.v3;return r.set(Uu(e,a.x,l.x,x.x,_.x),Uu(e,a.y,l.y,x.y,_.y),Uu(e,a.z,l.z,x.z,_.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class E2 extends _s{constructor(e=new Jr,t=new Jr){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Jr){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Jr){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class vS extends _s{constructor(e=new st,t=new st){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new st){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new st){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class L2 extends _s{constructor(e=new Jr,t=new Jr,r=new Jr){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Jr){const r=t,a=this.v0,l=this.v1,x=this.v2;return r.set(Fu(e,a.x,l.x,x.x),Fu(e,a.y,l.y,x.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class yS extends _s{constructor(e=new st,t=new st,r=new st){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new st){const r=t,a=this.v0,l=this.v1,x=this.v2;return r.set(Fu(e,a.x,l.x,x.x),Fu(e,a.y,l.y,x.y),Fu(e,a.z,l.z,x.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class R2 extends _s{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Jr){const r=t,a=this.points,l=(a.length-1)*e,x=Math.floor(l),_=l-x,O=a[x===0?x:x-1],z=a[x],q=a[x>a.length-2?a.length-1:x+1],oe=a[x>a.length-3?a.length-1:x+2];return r.set(Rv(_,O.x,z.x,q.x,oe.x),Rv(_,O.y,z.y,q.y,oe.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const a=e.points[t];this.points.push(a.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const a=this.points[t];e.points.push(a.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const a=e.points[t];this.points.push(new Jr().fromArray(a))}return this}}var kv=Object.freeze({__proto__:null,ArcCurve:sS,CatmullRomCurve3:lS,CubicBezierCurve:C2,CubicBezierCurve3:gS,EllipseCurve:bm,LineCurve:E2,LineCurve3:vS,QuadraticBezierCurve:L2,QuadraticBezierCurve3:yS,SplineCurve:R2});class xS extends _s{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new kv[r](t,e))}return this}getPoint(e,t){const r=e*this.getLength(),a=this.getCurveLengths();let l=0;for(;l<a.length;){if(a[l]>=r){const x=a[l]-r,_=this.curves[l],O=_.getLength(),z=O===0?0:1-x/O;return _.getPointAt(z,t)}l++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,a=this.curves.length;r<a;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let a=0,l=this.curves;a<l.length;a++){const x=l[a],_=x.isEllipseCurve?e*2:x.isLineCurve||x.isLineCurve3?1:x.isSplineCurve?e*x.points.length:e,O=x.getPoints(_);for(let z=0;z<O.length;z++){const q=O[z];r&&r.equals(q)||(t.push(q),r=q)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const a=e.curves[t];this.curves.push(a.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const a=this.curves[t];e.curves.push(a.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const a=e.curves[t];this.curves.push(new kv[a.type]().fromJSON(a))}return this}}class Pv extends xS{constructor(e){super(),this.type="Path",this.currentPoint=new Jr,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new E2(this.currentPoint.clone(),new Jr(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,a){const l=new L2(this.currentPoint.clone(),new Jr(e,t),new Jr(r,a));return this.curves.push(l),this.currentPoint.set(r,a),this}bezierCurveTo(e,t,r,a,l,x){const _=new C2(this.currentPoint.clone(),new Jr(e,t),new Jr(r,a),new Jr(l,x));return this.curves.push(_),this.currentPoint.set(l,x),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new R2(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,a,l,x){const _=this.currentPoint.x,O=this.currentPoint.y;return this.absarc(e+_,t+O,r,a,l,x),this}absarc(e,t,r,a,l,x){return this.absellipse(e,t,r,r,a,l,x),this}ellipse(e,t,r,a,l,x,_,O){const z=this.currentPoint.x,q=this.currentPoint.y;return this.absellipse(e+z,t+q,r,a,l,x,_,O),this}absellipse(e,t,r,a,l,x,_,O){const z=new bm(e,t,r,a,l,x,_,O);if(this.curves.length>0){const oe=z.getPoint(0);oe.equals(this.currentPoint)||this.lineTo(oe.x,oe.y)}this.curves.push(z);const q=z.getPoint(1);return this.currentPoint.copy(q),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class ll extends di{constructor(e=1,t=1,r=1,a=32,l=1,x=!1,_=0,O=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:a,heightSegments:l,openEnded:x,thetaStart:_,thetaLength:O};const z=this;a=Math.floor(a),l=Math.floor(l);const q=[],oe=[],ue=[],_e=[];let be=0;const Pe=[],Se=r/2;let Ee=0;Xe(),x===!1&&(e>0&&qe(!0),t>0&&qe(!1)),this.setIndex(q),this.setAttribute("position",new qa(oe,3)),this.setAttribute("normal",new qa(ue,3)),this.setAttribute("uv",new qa(_e,2));function Xe(){const $e=new st,ft=new st;let gt=0;const pt=(t-e)/r;for(let Ht=0;Ht<=l;Ht++){const ur=[],Ve=Ht/l,nt=Ve*(t-e)+e;for(let nr=0;nr<=a;nr++){const Zt=nr/a,Xt=Zt*O+_,Pr=Math.sin(Xt),cr=Math.cos(Xt);ft.x=nt*Pr,ft.y=-Ve*r+Se,ft.z=nt*cr,oe.push(ft.x,ft.y,ft.z),$e.set(Pr,pt,cr).normalize(),ue.push($e.x,$e.y,$e.z),_e.push(Zt,1-Ve),ur.push(be++)}Pe.push(ur)}for(let Ht=0;Ht<a;Ht++)for(let ur=0;ur<l;ur++){const Ve=Pe[ur][Ht],nt=Pe[ur+1][Ht],nr=Pe[ur+1][Ht+1],Zt=Pe[ur][Ht+1];e>0&&(q.push(Ve,nt,Zt),gt+=3),t>0&&(q.push(nt,nr,Zt),gt+=3)}z.addGroup(Ee,gt,0),Ee+=gt}function qe($e){const ft=be,gt=new Jr,pt=new st;let Ht=0;const ur=$e===!0?e:t,Ve=$e===!0?1:-1;for(let nr=1;nr<=a;nr++)oe.push(0,Se*Ve,0),ue.push(0,Ve,0),_e.push(.5,.5),be++;const nt=be;for(let nr=0;nr<=a;nr++){const Zt=nr/a*O+_,Xt=Math.cos(Zt),Pr=Math.sin(Zt);pt.x=ur*Pr,pt.y=Se*Ve,pt.z=ur*Xt,oe.push(pt.x,pt.y,pt.z),ue.push(0,Ve,0),gt.x=Xt*.5+.5,gt.y=Pr*.5*Ve+.5,_e.push(gt.x,gt.y),be++}for(let nr=0;nr<a;nr++){const Zt=ft+nr,Xt=nt+nr;$e===!0?q.push(Xt,Xt+1,Zt):q.push(Xt+1,Xt,Zt),Ht+=3}z.addGroup(Ee,Ht,$e===!0?1:2),Ee+=Ht}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ll(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class qc extends ll{constructor(e=1,t=1,r=32,a=1,l=!1,x=0,_=Math.PI*2){super(0,e,t,r,a,l,x,_),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:a,openEnded:l,thetaStart:x,thetaLength:_}}static fromJSON(e){return new qc(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Mm extends di{constructor(e=[],t=[],r=1,a=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:a};const l=[],x=[];_(a),z(r),q(),this.setAttribute("position",new qa(l,3)),this.setAttribute("normal",new qa(l.slice(),3)),this.setAttribute("uv",new qa(x,2)),a===0?this.computeVertexNormals():this.normalizeNormals();function _(Xe){const qe=new st,$e=new st,ft=new st;for(let gt=0;gt<t.length;gt+=3)_e(t[gt+0],qe),_e(t[gt+1],$e),_e(t[gt+2],ft),O(qe,$e,ft,Xe)}function O(Xe,qe,$e,ft){const gt=ft+1,pt=[];for(let Ht=0;Ht<=gt;Ht++){pt[Ht]=[];const ur=Xe.clone().lerp($e,Ht/gt),Ve=qe.clone().lerp($e,Ht/gt),nt=gt-Ht;for(let nr=0;nr<=nt;nr++)nr===0&&Ht===gt?pt[Ht][nr]=ur:pt[Ht][nr]=ur.clone().lerp(Ve,nr/nt)}for(let Ht=0;Ht<gt;Ht++)for(let ur=0;ur<2*(gt-Ht)-1;ur++){const Ve=Math.floor(ur/2);ur%2===0?(ue(pt[Ht][Ve+1]),ue(pt[Ht+1][Ve]),ue(pt[Ht][Ve])):(ue(pt[Ht][Ve+1]),ue(pt[Ht+1][Ve+1]),ue(pt[Ht+1][Ve]))}}function z(Xe){const qe=new st;for(let $e=0;$e<l.length;$e+=3)qe.x=l[$e+0],qe.y=l[$e+1],qe.z=l[$e+2],qe.normalize().multiplyScalar(Xe),l[$e+0]=qe.x,l[$e+1]=qe.y,l[$e+2]=qe.z}function q(){const Xe=new st;for(let qe=0;qe<l.length;qe+=3){Xe.x=l[qe+0],Xe.y=l[qe+1],Xe.z=l[qe+2];const $e=Se(Xe)/2/Math.PI+.5,ft=Ee(Xe)/Math.PI+.5;x.push($e,1-ft)}be(),oe()}function oe(){for(let Xe=0;Xe<x.length;Xe+=6){const qe=x[Xe+0],$e=x[Xe+2],ft=x[Xe+4],gt=Math.max(qe,$e,ft),pt=Math.min(qe,$e,ft);gt>.9&&pt<.1&&(qe<.2&&(x[Xe+0]+=1),$e<.2&&(x[Xe+2]+=1),ft<.2&&(x[Xe+4]+=1))}}function ue(Xe){l.push(Xe.x,Xe.y,Xe.z)}function _e(Xe,qe){const $e=Xe*3;qe.x=e[$e+0],qe.y=e[$e+1],qe.z=e[$e+2]}function be(){const Xe=new st,qe=new st,$e=new st,ft=new st,gt=new Jr,pt=new Jr,Ht=new Jr;for(let ur=0,Ve=0;ur<l.length;ur+=9,Ve+=6){Xe.set(l[ur+0],l[ur+1],l[ur+2]),qe.set(l[ur+3],l[ur+4],l[ur+5]),$e.set(l[ur+6],l[ur+7],l[ur+8]),gt.set(x[Ve+0],x[Ve+1]),pt.set(x[Ve+2],x[Ve+3]),Ht.set(x[Ve+4],x[Ve+5]),ft.copy(Xe).add(qe).add($e).divideScalar(3);const nt=Se(ft);Pe(gt,Ve+0,Xe,nt),Pe(pt,Ve+2,qe,nt),Pe(Ht,Ve+4,$e,nt)}}function Pe(Xe,qe,$e,ft){ft<0&&Xe.x===1&&(x[qe]=Xe.x-1),$e.x===0&&$e.z===0&&(x[qe]=ft/2/Math.PI+.5)}function Se(Xe){return Math.atan2(Xe.z,-Xe.x)}function Ee(Xe){return Math.atan2(-Xe.y,Math.sqrt(Xe.x*Xe.x+Xe.z*Xe.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Mm(e.vertices,e.indices,e.radius,e.details)}}class k2 extends Pv{constructor(e){super(e),this.uuid=vs(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,a=this.holes.length;r<a;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const a=e.holes[t];this.holes.push(a.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const a=this.holes[t];e.holes.push(a.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const a=e.holes[t];this.holes.push(new Pv().fromJSON(a))}return this}}const _S={triangulate:function(n,e,t=2){const r=e&&e.length,a=r?e[0]*t:n.length;let l=P2(n,0,a,t,!0);const x=[];if(!l||l.next===l.prev)return x;let _,O,z,q,oe,ue,_e;if(r&&(l=AS(n,e,l,t)),n.length>80*t){_=z=n[0],O=q=n[1];for(let be=t;be<a;be+=t)oe=n[be],ue=n[be+1],oe<_&&(_=oe),ue<O&&(O=ue),oe>z&&(z=oe),ue>q&&(q=ue);_e=Math.max(z-_,q-O),_e=_e!==0?32767/_e:0}return Yu(l,x,t,_,O,_e,0),x}};function P2(n,e,t,r,a){let l,x;if(a===IS(n,e,t,r)>0)for(l=e;l<t;l+=r)x=Ov(l,n[l],n[l+1],x);else for(l=t-r;l>=e;l-=r)x=Ov(l,n[l],n[l+1],x);return x&&Xh(x,x.next)&&(Ju(x),x=x.next),x}function Bl(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(Xh(t,t.next)||Ai(t.prev,t,t.next)===0)){if(Ju(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function Yu(n,e,t,r,a,l,x){if(!n)return;!x&&l&&RS(n,r,a,l);let _=n,O,z;for(;n.prev!==n.next;){if(O=n.prev,z=n.next,l?wS(n,r,a,l):bS(n)){e.push(O.i/t|0),e.push(n.i/t|0),e.push(z.i/t|0),Ju(n),n=z.next,_=z.next;continue}if(n=z,n===_){x?x===1?(n=MS(Bl(n),e,t),Yu(n,e,t,r,a,l,2)):x===2&&TS(n,e,t,r,a,l):Yu(Bl(n),e,t,r,a,l,1);break}}}function bS(n){const e=n.prev,t=n,r=n.next;if(Ai(e,t,r)>=0)return!1;const a=e.x,l=t.x,x=r.x,_=e.y,O=t.y,z=r.y,q=a<l?a<x?a:x:l<x?l:x,oe=_<O?_<z?_:z:O<z?O:z,ue=a>l?a>x?a:x:l>x?l:x,_e=_>O?_>z?_:z:O>z?O:z;let be=r.next;for(;be!==e;){if(be.x>=q&&be.x<=ue&&be.y>=oe&&be.y<=_e&&Oc(a,_,l,O,x,z,be.x,be.y)&&Ai(be.prev,be,be.next)>=0)return!1;be=be.next}return!0}function wS(n,e,t,r){const a=n.prev,l=n,x=n.next;if(Ai(a,l,x)>=0)return!1;const _=a.x,O=l.x,z=x.x,q=a.y,oe=l.y,ue=x.y,_e=_<O?_<z?_:z:O<z?O:z,be=q<oe?q<ue?q:ue:oe<ue?oe:ue,Pe=_>O?_>z?_:z:O>z?O:z,Se=q>oe?q>ue?q:ue:oe>ue?oe:ue,Ee=R0(_e,be,e,t,r),Xe=R0(Pe,Se,e,t,r);let qe=n.prevZ,$e=n.nextZ;for(;qe&&qe.z>=Ee&&$e&&$e.z<=Xe;){if(qe.x>=_e&&qe.x<=Pe&&qe.y>=be&&qe.y<=Se&&qe!==a&&qe!==x&&Oc(_,q,O,oe,z,ue,qe.x,qe.y)&&Ai(qe.prev,qe,qe.next)>=0||(qe=qe.prevZ,$e.x>=_e&&$e.x<=Pe&&$e.y>=be&&$e.y<=Se&&$e!==a&&$e!==x&&Oc(_,q,O,oe,z,ue,$e.x,$e.y)&&Ai($e.prev,$e,$e.next)>=0))return!1;$e=$e.nextZ}for(;qe&&qe.z>=Ee;){if(qe.x>=_e&&qe.x<=Pe&&qe.y>=be&&qe.y<=Se&&qe!==a&&qe!==x&&Oc(_,q,O,oe,z,ue,qe.x,qe.y)&&Ai(qe.prev,qe,qe.next)>=0)return!1;qe=qe.prevZ}for(;$e&&$e.z<=Xe;){if($e.x>=_e&&$e.x<=Pe&&$e.y>=be&&$e.y<=Se&&$e!==a&&$e!==x&&Oc(_,q,O,oe,z,ue,$e.x,$e.y)&&Ai($e.prev,$e,$e.next)>=0)return!1;$e=$e.nextZ}return!0}function MS(n,e,t){let r=n;do{const a=r.prev,l=r.next.next;!Xh(a,l)&&O2(a,r,r.next,l)&&qu(a,l)&&qu(l,a)&&(e.push(a.i/t|0),e.push(r.i/t|0),e.push(l.i/t|0),Ju(r),Ju(r.next),r=n=l),r=r.next}while(r!==n);return Bl(r)}function TS(n,e,t,r,a,l){let x=n;do{let _=x.next.next;for(;_!==x.prev;){if(x.i!==_.i&&OS(x,_)){let O=N2(x,_);x=Bl(x,x.next),O=Bl(O,O.next),Yu(x,e,t,r,a,l,0),Yu(O,e,t,r,a,l,0);return}_=_.next}x=x.next}while(x!==n)}function AS(n,e,t,r){const a=[];let l,x,_,O,z;for(l=0,x=e.length;l<x;l++)_=e[l]*r,O=l<x-1?e[l+1]*r:n.length,z=P2(n,_,O,r,!1),z===z.next&&(z.steiner=!0),a.push(PS(z));for(a.sort(SS),l=0;l<a.length;l++)t=CS(a[l],t);return t}function SS(n,e){return n.x-e.x}function CS(n,e){const t=ES(n,e);if(!t)return e;const r=N2(t,n);return Bl(r,r.next),Bl(t,t.next)}function ES(n,e){let t=e,r=-1/0,a;const l=n.x,x=n.y;do{if(x<=t.y&&x>=t.next.y&&t.next.y!==t.y){const ue=t.x+(x-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(ue<=l&&ue>r&&(r=ue,a=t.x<t.next.x?t:t.next,ue===l))return a}t=t.next}while(t!==e);if(!a)return null;const _=a,O=a.x,z=a.y;let q=1/0,oe;t=a;do l>=t.x&&t.x>=O&&l!==t.x&&Oc(x<z?l:r,x,O,z,x<z?r:l,x,t.x,t.y)&&(oe=Math.abs(x-t.y)/(l-t.x),qu(t,n)&&(oe<q||oe===q&&(t.x>a.x||t.x===a.x&&LS(a,t)))&&(a=t,q=oe)),t=t.next;while(t!==_);return a}function LS(n,e){return Ai(n.prev,n,e.prev)<0&&Ai(e.next,n,n.next)<0}function RS(n,e,t,r){let a=n;do a.z===0&&(a.z=R0(a.x,a.y,e,t,r)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==n);a.prevZ.nextZ=null,a.prevZ=null,kS(a)}function kS(n){let e,t,r,a,l,x,_,O,z=1;do{for(t=n,n=null,l=null,x=0;t;){for(x++,r=t,_=0,e=0;e<z&&(_++,r=r.nextZ,!!r);e++);for(O=z;_>0||O>0&&r;)_!==0&&(O===0||!r||t.z<=r.z)?(a=t,t=t.nextZ,_--):(a=r,r=r.nextZ,O--),l?l.nextZ=a:n=a,a.prevZ=l,l=a;t=r}l.nextZ=null,z*=2}while(x>1);return n}function R0(n,e,t,r,a){return n=(n-t)*a|0,e=(e-r)*a|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function PS(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Oc(n,e,t,r,a,l,x,_){return(a-x)*(e-_)>=(n-x)*(l-_)&&(n-x)*(r-_)>=(t-x)*(e-_)&&(t-x)*(l-_)>=(a-x)*(r-_)}function OS(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!NS(n,e)&&(qu(n,e)&&qu(e,n)&&DS(n,e)&&(Ai(n.prev,n,e.prev)||Ai(n,e.prev,e))||Xh(n,e)&&Ai(n.prev,n,n.next)>0&&Ai(e.prev,e,e.next)>0)}function Ai(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Xh(n,e){return n.x===e.x&&n.y===e.y}function O2(n,e,t,r){const a=lh(Ai(n,e,t)),l=lh(Ai(n,e,r)),x=lh(Ai(t,r,n)),_=lh(Ai(t,r,e));return!!(a!==l&&x!==_||a===0&&sh(n,t,e)||l===0&&sh(n,r,e)||x===0&&sh(t,n,r)||_===0&&sh(t,e,r))}function sh(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function lh(n){return n>0?1:n<0?-1:0}function NS(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&O2(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function qu(n,e){return Ai(n.prev,n,n.next)<0?Ai(n,e,n.next)>=0&&Ai(n,n.prev,e)>=0:Ai(n,e,n.prev)<0||Ai(n,n.next,e)<0}function DS(n,e){let t=n,r=!1;const a=(n.x+e.x)/2,l=(n.y+e.y)/2;do t.y>l!=t.next.y>l&&t.next.y!==t.y&&a<(t.next.x-t.x)*(l-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function N2(n,e){const t=new k0(n.i,n.x,n.y),r=new k0(e.i,e.x,e.y),a=n.next,l=e.prev;return n.next=e,e.prev=n,t.next=a,a.prev=t,r.next=t,t.prev=r,l.next=r,r.prev=l,r}function Ov(n,e,t,r){const a=new k0(n,e,t);return r?(a.next=r.next,a.prev=r,r.next.prev=a,r.next=a):(a.prev=a,a.next=a),a}function Ju(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function k0(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function IS(n,e,t,r){let a=0;for(let l=e,x=t-r;l<t;l+=r)a+=(n[x]-n[l])*(n[l+1]+n[x+1]),x=l;return a}class Bu{static area(e){const t=e.length;let r=0;for(let a=t-1,l=0;l<t;a=l++)r+=e[a].x*e[l].y-e[l].x*e[a].y;return r*.5}static isClockWise(e){return Bu.area(e)<0}static triangulateShape(e,t){const r=[],a=[],l=[];Nv(e),Dv(r,e);let x=e.length;t.forEach(Nv);for(let O=0;O<t.length;O++)a.push(x),x+=t[O].length,Dv(r,t[O]);const _=_S.triangulate(r,a);for(let O=0;O<_.length;O+=3)l.push(_.slice(O,O+3));return l}}function Nv(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function Dv(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class Zh extends Mm{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,a=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],l=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(a,l,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Zh(e.radius,e.detail)}}class Tm extends di{constructor(e=new k2([new Jr(0,.5),new Jr(-.5,-.5),new Jr(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],a=[],l=[],x=[];let _=0,O=0;if(Array.isArray(e)===!1)z(e);else for(let q=0;q<e.length;q++)z(e[q]),this.addGroup(_,O,q),_+=O,O=0;this.setIndex(r),this.setAttribute("position",new qa(a,3)),this.setAttribute("normal",new qa(l,3)),this.setAttribute("uv",new qa(x,2));function z(q){const oe=a.length/3,ue=q.extractPoints(t);let _e=ue.shape;const be=ue.holes;Bu.isClockWise(_e)===!1&&(_e=_e.reverse());for(let Se=0,Ee=be.length;Se<Ee;Se++){const Xe=be[Se];Bu.isClockWise(Xe)===!0&&(be[Se]=Xe.reverse())}const Pe=Bu.triangulateShape(_e,be);for(let Se=0,Ee=be.length;Se<Ee;Se++){const Xe=be[Se];_e=_e.concat(Xe)}for(let Se=0,Ee=_e.length;Se<Ee;Se++){const Xe=_e[Se];a.push(Xe.x,Xe.y,0),l.push(0,0,1),x.push(Xe.x,Xe.y)}for(let Se=0,Ee=Pe.length;Se<Ee;Se++){const Xe=Pe[Se],qe=Xe[0]+oe,$e=Xe[1]+oe,ft=Xe[2]+oe;r.push(qe,$e,ft),O+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return zS(t,e)}static fromJSON(e,t){const r=[];for(let a=0,l=e.shapes.length;a<l;a++){const x=t[e.shapes[a]];r.push(x)}return new Tm(r,e.curveSegments)}}function zS(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const a=n[t];e.shapes.push(a.uuid)}else e.shapes.push(n.uuid);return e}class cl extends di{constructor(e=1,t=32,r=16,a=0,l=Math.PI*2,x=0,_=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:a,phiLength:l,thetaStart:x,thetaLength:_},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const O=Math.min(x+_,Math.PI);let z=0;const q=[],oe=new st,ue=new st,_e=[],be=[],Pe=[],Se=[];for(let Ee=0;Ee<=r;Ee++){const Xe=[],qe=Ee/r;let $e=0;Ee===0&&x===0?$e=.5/t:Ee===r&&O===Math.PI&&($e=-.5/t);for(let ft=0;ft<=t;ft++){const gt=ft/t;oe.x=-e*Math.cos(a+gt*l)*Math.sin(x+qe*_),oe.y=e*Math.cos(x+qe*_),oe.z=e*Math.sin(a+gt*l)*Math.sin(x+qe*_),be.push(oe.x,oe.y,oe.z),ue.copy(oe).normalize(),Pe.push(ue.x,ue.y,ue.z),Se.push(gt+$e,1-qe),Xe.push(z++)}q.push(Xe)}for(let Ee=0;Ee<r;Ee++)for(let Xe=0;Xe<t;Xe++){const qe=q[Ee][Xe+1],$e=q[Ee][Xe],ft=q[Ee+1][Xe],gt=q[Ee+1][Xe+1];(Ee!==0||x>0)&&_e.push(qe,$e,gt),(Ee!==r-1||O<Math.PI)&&_e.push($e,ft,gt)}this.setIndex(_e),this.setAttribute("position",new qa(be,3)),this.setAttribute("normal",new qa(Pe,3)),this.setAttribute("uv",new qa(Se,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cl(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Dl extends di{constructor(e=1,t=.4,r=12,a=48,l=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:a,arc:l},r=Math.floor(r),a=Math.floor(a);const x=[],_=[],O=[],z=[],q=new st,oe=new st,ue=new st;for(let _e=0;_e<=r;_e++)for(let be=0;be<=a;be++){const Pe=be/a*l,Se=_e/r*Math.PI*2;oe.x=(e+t*Math.cos(Se))*Math.cos(Pe),oe.y=(e+t*Math.cos(Se))*Math.sin(Pe),oe.z=t*Math.sin(Se),_.push(oe.x,oe.y,oe.z),q.x=e*Math.cos(Pe),q.y=e*Math.sin(Pe),ue.subVectors(oe,q).normalize(),O.push(ue.x,ue.y,ue.z),z.push(be/a),z.push(_e/r)}for(let _e=1;_e<=r;_e++)for(let be=1;be<=a;be++){const Pe=(a+1)*_e+be-1,Se=(a+1)*(_e-1)+be-1,Ee=(a+1)*(_e-1)+be,Xe=(a+1)*_e+be;x.push(Pe,Se,Xe),x.push(Se,Ee,Xe)}this.setIndex(x),this.setAttribute("position",new qa(_,3)),this.setAttribute("normal",new qa(O,3)),this.setAttribute("uv",new qa(z,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Dl(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Dh extends zs{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new qn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fm,this.normalScale=new Jr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ko,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class FS extends zs{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new qn(16777215),this.specular=new qn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fm,this.normalScale=new Jr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ko,this.combine=im,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class US extends jc{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}class Am extends Ei{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new qn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}const Lp=new jn,Iv=new st,zv=new st;class BS{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Jr(512,512),this.map=null,this.mapPass=null,this.matrix=new jn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Yh,this._frameExtents=new Jr(1,1),this._viewportCount=1,this._viewports=[new Si(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;Iv.setFromMatrixPosition(e.matrixWorld),t.position.copy(Iv),zv.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(zv),t.updateMatrixWorld(),Lp.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Lp),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(Lp)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class HS extends BS{constructor(){super(new Wu(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Fv extends Am{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ei.DEFAULT_UP),this.updateMatrix(),this.target=new Ei,this.shadow=new HS}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Uv extends Am{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}const Bv=new jn;class Sm{constructor(e,t,r=0,a=1/0){this.ray=new Qu(e,t),this.near=r,this.far=a,this.camera=null,this.layers=new gm,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return Bv.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(Bv),this}intersectObject(e,t=!0,r=[]){return P0(e,this,r,t),r.sort(Hv),r}intersectObjects(e,t=!0,r=[]){for(let a=0,l=e.length;a<l;a++)P0(e[a],this,r,t);return r.sort(Hv),r}}function Hv(n,e){return n.distance-e.distance}function P0(n,e,t,r){let a=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(a=!1),a===!0&&r===!0){const l=n.children;for(let x=0,_=l.length;x<_;x++)P0(l[x],e,t,!0)}}class Vv{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Vi(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}const Gv=new st,ch=new st;class VS{constructor(e=new st,t=new st){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Gv.subVectors(e,this.start),ch.subVectors(this.end,this.start);const r=ch.dot(ch);let a=ch.dot(Gv)/r;return t&&(a=Vi(a,0,1)),a}closestPointToPoint(e,t,r){const a=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(a).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:am}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=am);const jv={type:"change"},Rp={type:"start"},Wv={type:"end"},uh=new Qu,Yv=new fs,GS=Math.cos(70*zl.DEG2RAD);class qv extends Hl{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new st,this.cursor=new st,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:oc.ROTATE,MIDDLE:oc.DOLLY,RIGHT:oc.PAN},this.touches={ONE:sc.ROTATE,TWO:sc.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return _.phi},this.getAzimuthalAngle=function(){return _.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(Ft){Ft.addEventListener("keydown",wn),this._domElementKeyEvents=Ft},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",wn),this._domElementKeyEvents=null},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(jv),r.update(),l=a.NONE},this.update=(function(){const Ft=new st,Wr=new Oi().setFromUnitVectors(e.up,new st(0,1,0)),qt=Wr.clone().invert(),jr=new st,mr=new Oi,Nr=new st,cn=2*Math.PI;return function(nn=null){const Sa=r.object.position;Ft.copy(Sa).sub(r.target),Ft.applyQuaternion(Wr),_.setFromVector3(Ft),r.autoRotate&&l===a.NONE&&nr(Ve(nn)),r.enableDamping?(_.theta+=O.theta*r.dampingFactor,_.phi+=O.phi*r.dampingFactor):(_.theta+=O.theta,_.phi+=O.phi);let Ia=r.minAzimuthAngle,an=r.maxAzimuthAngle;isFinite(Ia)&&isFinite(an)&&(Ia<-Math.PI?Ia+=cn:Ia>Math.PI&&(Ia-=cn),an<-Math.PI?an+=cn:an>Math.PI&&(an-=cn),Ia<=an?_.theta=Math.max(Ia,Math.min(an,_.theta)):_.theta=_.theta>(Ia+an)/2?Math.max(Ia,_.theta):Math.min(an,_.theta)),_.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,_.phi)),_.makeSafe(),r.enableDamping===!0?r.target.addScaledVector(q,r.dampingFactor):r.target.add(q),r.target.sub(r.cursor),r.target.clampLength(r.minTargetRadius,r.maxTargetRadius),r.target.add(r.cursor),r.zoomToCursor&&gt||r.object.isOrthographicCamera?_.radius=Sn(_.radius):_.radius=Sn(_.radius*z),Ft.setFromSpherical(_),Ft.applyQuaternion(qt),Sa.copy(r.target).add(Ft),r.object.lookAt(r.target),r.enableDamping===!0?(O.theta*=1-r.dampingFactor,O.phi*=1-r.dampingFactor,q.multiplyScalar(1-r.dampingFactor)):(O.set(0,0,0),q.set(0,0,0));let xa=!1;if(r.zoomToCursor&&gt){let hi=null;if(r.object.isPerspectiveCamera){const Ka=Ft.length();hi=Sn(Ka*z);const Oo=Ka-hi;r.object.position.addScaledVector($e,Oo),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){const Ka=new st(ft.x,ft.y,0);Ka.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/z)),r.object.updateProjectionMatrix(),xa=!0;const Oo=new st(ft.x,ft.y,0);Oo.unproject(r.object),r.object.position.sub(Oo).add(Ka),r.object.updateMatrixWorld(),hi=Ft.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;hi!==null&&(this.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(hi).add(r.object.position):(uh.origin.copy(r.object.position),uh.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(uh.direction))<GS?e.lookAt(r.target):(Yv.setFromNormalAndCoplanarPoint(r.object.up,r.target),uh.intersectPlane(Yv,r.target))))}else r.object.isOrthographicCamera&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/z)),r.object.updateProjectionMatrix(),xa=!0);return z=1,gt=!1,xa||jr.distanceToSquared(r.object.position)>x||8*(1-mr.dot(r.object.quaternion))>x||Nr.distanceToSquared(r.target)>0?(r.dispatchEvent(jv),jr.copy(r.object.position),mr.copy(r.object.quaternion),Nr.copy(r.target),!0):!1}})(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",Rn),r.domElement.removeEventListener("pointerdown",na),r.domElement.removeEventListener("pointercancel",ut),r.domElement.removeEventListener("wheel",qr),r.domElement.removeEventListener("pointermove",Dt),r.domElement.removeEventListener("pointerup",ut),r._domElementKeyEvents!==null&&(r._domElementKeyEvents.removeEventListener("keydown",wn),r._domElementKeyEvents=null)};const r=this,a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const x=1e-6,_=new Vv,O=new Vv;let z=1;const q=new st,oe=new Jr,ue=new Jr,_e=new Jr,be=new Jr,Pe=new Jr,Se=new Jr,Ee=new Jr,Xe=new Jr,qe=new Jr,$e=new st,ft=new Jr;let gt=!1;const pt=[],Ht={};let ur=!1;function Ve(Ft){return Ft!==null?2*Math.PI/60*r.autoRotateSpeed*Ft:2*Math.PI/60/60*r.autoRotateSpeed}function nt(Ft){const Wr=Math.abs(Ft*.01);return Math.pow(.95,r.zoomSpeed*Wr)}function nr(Ft){O.theta-=Ft}function Zt(Ft){O.phi-=Ft}const Xt=(function(){const Ft=new st;return function(Wr,qt){Ft.setFromMatrixColumn(qt,0),Ft.multiplyScalar(-Wr),q.add(Ft)}})(),Pr=(function(){const Ft=new st;return function(Wr,qt){r.screenSpacePanning===!0?Ft.setFromMatrixColumn(qt,1):(Ft.setFromMatrixColumn(qt,0),Ft.crossVectors(r.object.up,Ft)),Ft.multiplyScalar(Wr),q.add(Ft)}})(),cr=(function(){const Ft=new st;return function(Wr,qt){const jr=r.domElement;if(r.object.isPerspectiveCamera){const mr=r.object.position;Ft.copy(mr).sub(r.target);let Nr=Ft.length();Nr*=Math.tan(r.object.fov/2*Math.PI/180),Xt(2*Wr*Nr/jr.clientHeight,r.object.matrix),Pr(2*qt*Nr/jr.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(Xt(Wr*(r.object.right-r.object.left)/r.object.zoom/jr.clientWidth,r.object.matrix),Pr(qt*(r.object.top-r.object.bottom)/r.object.zoom/jr.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}})();function Qr(Ft){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?z/=Ft:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function Tr(Ft){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?z*=Ft:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function ln(Ft,Wr){if(!r.zoomToCursor)return;gt=!0;const qt=r.domElement.getBoundingClientRect(),jr=Ft-qt.left,mr=Wr-qt.top,Nr=qt.width,cn=qt.height;ft.x=jr/Nr*2-1,ft.y=-(mr/cn)*2+1,$e.set(ft.x,ft.y,1).unproject(r.object).sub(r.object.position).normalize()}function Sn(Ft){return Math.max(r.minDistance,Math.min(r.maxDistance,Ft))}function Wn(Ft){oe.set(Ft.clientX,Ft.clientY)}function Ma(Ft){ln(Ft.clientX,Ft.clientX),Ee.set(Ft.clientX,Ft.clientY)}function zn(Ft){be.set(Ft.clientX,Ft.clientY)}function Or(Ft){ue.set(Ft.clientX,Ft.clientY),_e.subVectors(ue,oe).multiplyScalar(r.rotateSpeed);const Wr=r.domElement;nr(2*Math.PI*_e.x/Wr.clientHeight),Zt(2*Math.PI*_e.y/Wr.clientHeight),oe.copy(ue),r.update()}function $r(Ft){Xe.set(Ft.clientX,Ft.clientY),qe.subVectors(Xe,Ee),qe.y>0?Qr(nt(qe.y)):qe.y<0&&Tr(nt(qe.y)),Ee.copy(Xe),r.update()}function En(Ft){Pe.set(Ft.clientX,Ft.clientY),Se.subVectors(Pe,be).multiplyScalar(r.panSpeed),cr(Se.x,Se.y),be.copy(Pe),r.update()}function Ln(Ft){ln(Ft.clientX,Ft.clientY),Ft.deltaY<0?Tr(nt(Ft.deltaY)):Ft.deltaY>0&&Qr(nt(Ft.deltaY)),r.update()}function ta(Ft){let Wr=!1;switch(Ft.code){case r.keys.UP:Ft.ctrlKey||Ft.metaKey||Ft.shiftKey?Zt(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):cr(0,r.keyPanSpeed),Wr=!0;break;case r.keys.BOTTOM:Ft.ctrlKey||Ft.metaKey||Ft.shiftKey?Zt(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):cr(0,-r.keyPanSpeed),Wr=!0;break;case r.keys.LEFT:Ft.ctrlKey||Ft.metaKey||Ft.shiftKey?nr(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):cr(r.keyPanSpeed,0),Wr=!0;break;case r.keys.RIGHT:Ft.ctrlKey||Ft.metaKey||Ft.shiftKey?nr(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):cr(-r.keyPanSpeed,0),Wr=!0;break}Wr&&(Ft.preventDefault(),r.update())}function Jn(Ft){if(pt.length===1)oe.set(Ft.pageX,Ft.pageY);else{const Wr=Xn(Ft),qt=.5*(Ft.pageX+Wr.x),jr=.5*(Ft.pageY+Wr.y);oe.set(qt,jr)}}function da(Ft){if(pt.length===1)be.set(Ft.pageX,Ft.pageY);else{const Wr=Xn(Ft),qt=.5*(Ft.pageX+Wr.x),jr=.5*(Ft.pageY+Wr.y);be.set(qt,jr)}}function La(Ft){const Wr=Xn(Ft),qt=Ft.pageX-Wr.x,jr=Ft.pageY-Wr.y,mr=Math.sqrt(qt*qt+jr*jr);Ee.set(0,mr)}function ga(Ft){r.enableZoom&&La(Ft),r.enablePan&&da(Ft)}function tr(Ft){r.enableZoom&&La(Ft),r.enableRotate&&Jn(Ft)}function Ni(Ft){if(pt.length==1)ue.set(Ft.pageX,Ft.pageY);else{const qt=Xn(Ft),jr=.5*(Ft.pageX+qt.x),mr=.5*(Ft.pageY+qt.y);ue.set(jr,mr)}_e.subVectors(ue,oe).multiplyScalar(r.rotateSpeed);const Wr=r.domElement;nr(2*Math.PI*_e.x/Wr.clientHeight),Zt(2*Math.PI*_e.y/Wr.clientHeight),oe.copy(ue)}function fa(Ft){if(pt.length===1)Pe.set(Ft.pageX,Ft.pageY);else{const Wr=Xn(Ft),qt=.5*(Ft.pageX+Wr.x),jr=.5*(Ft.pageY+Wr.y);Pe.set(qt,jr)}Se.subVectors(Pe,be).multiplyScalar(r.panSpeed),cr(Se.x,Se.y),be.copy(Pe)}function ya(Ft){const Wr=Xn(Ft),qt=Ft.pageX-Wr.x,jr=Ft.pageY-Wr.y,mr=Math.sqrt(qt*qt+jr*jr);Xe.set(0,mr),qe.set(0,Math.pow(Xe.y/Ee.y,r.zoomSpeed)),Qr(qe.y),Ee.copy(Xe);const Nr=(Ft.pageX+Wr.x)*.5,cn=(Ft.pageY+Wr.y)*.5;ln(Nr,cn)}function ra(Ft){r.enableZoom&&ya(Ft),r.enablePan&&fa(Ft)}function Ga(Ft){r.enableZoom&&ya(Ft),r.enableRotate&&Ni(Ft)}function na(Ft){r.enabled!==!1&&(pt.length===0&&(r.domElement.setPointerCapture(Ft.pointerId),r.domElement.addEventListener("pointermove",Dt),r.domElement.addEventListener("pointerup",ut)),Kn(Ft),Ft.pointerType==="touch"?pa(Ft):dr(Ft))}function Dt(Ft){r.enabled!==!1&&(Ft.pointerType==="touch"?en(Ft):kr(Ft))}function ut(Ft){$n(Ft),pt.length===0&&(r.domElement.releasePointerCapture(Ft.pointerId),r.domElement.removeEventListener("pointermove",Dt),r.domElement.removeEventListener("pointerup",ut)),r.dispatchEvent(Wv),l=a.NONE}function dr(Ft){let Wr;switch(Ft.button){case 0:Wr=r.mouseButtons.LEFT;break;case 1:Wr=r.mouseButtons.MIDDLE;break;case 2:Wr=r.mouseButtons.RIGHT;break;default:Wr=-1}switch(Wr){case oc.DOLLY:if(r.enableZoom===!1)return;Ma(Ft),l=a.DOLLY;break;case oc.ROTATE:if(Ft.ctrlKey||Ft.metaKey||Ft.shiftKey){if(r.enablePan===!1)return;zn(Ft),l=a.NONE}else{if(r.enableRotate===!1)return;Wn(Ft),l=a.ROTATE}break;case oc.PAN:if(Ft.ctrlKey||Ft.metaKey||Ft.shiftKey){if(r.enableRotate===!1)return;Wn(Ft),l=a.NONE}else{if(r.enablePan===!1)return;zn(Ft),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(Rp)}function kr(Ft){switch(l){case a.ROTATE:if(r.enableRotate===!1)return;Or(Ft);break;case a.DOLLY:if(r.enableZoom===!1)return;$r(Ft);break;case a.PAN:if(r.enablePan===!1)return;En(Ft);break}}function qr(Ft){r.enabled===!1||r.enableZoom===!1||l!==a.NONE||(Ft.preventDefault(),r.dispatchEvent(Rp),Ln(Ir(Ft)),r.dispatchEvent(Wv))}function Ir(Ft){const Wr=Ft.deltaMode,qt={clientX:Ft.clientX,clientY:Ft.clientY,deltaY:Ft.deltaY};switch(Wr){case 1:qt.deltaY*=16;break;case 2:qt.deltaY*=100;break}return Ft.ctrlKey&&!ur&&(qt.deltaY*=10),qt}function Nn(Ft){Ft.key==="Control"&&(ur=!0,document.addEventListener("keyup",hn,{passive:!0,capture:!0}))}function hn(Ft){Ft.key==="Control"&&(ur=!1,document.removeEventListener("keyup",hn,{passive:!0,capture:!0}))}function wn(Ft){r.enabled===!1||r.enablePan===!1||ta(Ft)}function pa(Ft){switch(Mn(Ft),pt.length){case 1:switch(r.touches.ONE){case sc.ROTATE:if(r.enableRotate===!1)return;Jn(Ft),l=a.TOUCH_ROTATE;break;case sc.PAN:if(r.enablePan===!1)return;da(Ft),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(r.touches.TWO){case sc.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;ga(Ft),l=a.TOUCH_DOLLY_PAN;break;case sc.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;tr(Ft),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(Rp)}function en(Ft){switch(Mn(Ft),l){case a.TOUCH_ROTATE:if(r.enableRotate===!1)return;Ni(Ft),r.update();break;case a.TOUCH_PAN:if(r.enablePan===!1)return;fa(Ft),r.update();break;case a.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;ra(Ft),r.update();break;case a.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;Ga(Ft),r.update();break;default:l=a.NONE}}function Rn(Ft){r.enabled!==!1&&Ft.preventDefault()}function Kn(Ft){pt.push(Ft.pointerId)}function $n(Ft){delete Ht[Ft.pointerId];for(let Wr=0;Wr<pt.length;Wr++)if(pt[Wr]==Ft.pointerId){pt.splice(Wr,1);return}}function Mn(Ft){let Wr=Ht[Ft.pointerId];Wr===void 0&&(Wr=new Jr,Ht[Ft.pointerId]=Wr),Wr.set(Ft.pageX,Ft.pageY)}function Xn(Ft){const Wr=Ft.pointerId===pt[0]?pt[1]:pt[0];return Ht[Wr]}r.domElement.addEventListener("contextmenu",Rn),r.domElement.addEventListener("pointerdown",na),r.domElement.addEventListener("pointercancel",ut),r.domElement.addEventListener("wheel",qr,{passive:!1}),document.addEventListener("keydown",Nn,{passive:!0,capture:!0}),this.update()}}class jS extends Ei{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new Jr(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof Element&&t.element.parentNode!==null&&t.element.parentNode.removeChild(t.element)})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const Cc=new st,Jv=new jn,Xv=new jn,Zv=new st,Qv=new st;class WS{constructor(e={}){const t=this;let r,a,l,x;const _={objects:new WeakMap},O=e.element!==void 0?e.element:document.createElement("div");O.style.overflow="hidden",this.domElement=O,this.getSize=function(){return{width:r,height:a}},this.render=function(be,Pe){be.matrixWorldAutoUpdate===!0&&be.updateMatrixWorld(),Pe.parent===null&&Pe.matrixWorldAutoUpdate===!0&&Pe.updateMatrixWorld(),Jv.copy(Pe.matrixWorldInverse),Xv.multiplyMatrices(Pe.projectionMatrix,Jv),q(be,be,Pe),_e(be)},this.setSize=function(be,Pe){r=be,a=Pe,l=r/2,x=a/2,O.style.width=be+"px",O.style.height=Pe+"px"};function z(be){be.isCSS2DObject&&(be.element.style.display="none");for(let Pe=0,Se=be.children.length;Pe<Se;Pe++)z(be.children[Pe])}function q(be,Pe,Se){if(be.visible===!1){z(be);return}if(be.isCSS2DObject){Cc.setFromMatrixPosition(be.matrixWorld),Cc.applyMatrix4(Xv);const Ee=Cc.z>=-1&&Cc.z<=1&&be.layers.test(Se.layers)===!0,Xe=be.element;Xe.style.display=Ee===!0?"":"none",Ee===!0&&(be.onBeforeRender(t,Pe,Se),Xe.style.transform="translate("+-100*be.center.x+"%,"+-100*be.center.y+"%)translate("+(Cc.x*l+l)+"px,"+(-Cc.y*x+x)+"px)",Xe.parentNode!==O&&O.appendChild(Xe),be.onAfterRender(t,Pe,Se));const qe={distanceToCameraSquared:oe(Se,be)};_.objects.set(be,qe)}for(let Ee=0,Xe=be.children.length;Ee<Xe;Ee++)q(be.children[Ee],Pe,Se)}function oe(be,Pe){return Zv.setFromMatrixPosition(be.matrixWorld),Qv.setFromMatrixPosition(Pe.matrixWorld),Zv.distanceToSquared(Qv)}function ue(be){const Pe=[];return be.traverseVisible(function(Se){Se.isCSS2DObject&&Pe.push(Se)}),Pe}function _e(be){const Pe=ue(be).sort(function(Ee,Xe){if(Ee.renderOrder!==Xe.renderOrder)return Xe.renderOrder-Ee.renderOrder;const qe=_.objects.get(Ee).distanceToCameraSquared,$e=_.objects.get(Xe).distanceToCameraSquared;return qe-$e}),Se=Pe.length;for(let Ee=0,Xe=Pe.length;Ee<Xe;Ee++)Pe[Ee].element.style.zIndex=Se-Ee}}}function D2(n,e=null){[...n.children].forEach(t=>{e!==null&&(!t.userData||t.userData.uuid!==e)||(t instanceof gs?I2(n,t):!(t instanceof vm)&&!(t instanceof Am)&&Po(n,t))})}function I2(n,e){e.children.forEach(t=>{t instanceof gs?I2(n,t):Po(n,t)})}function Po(n,e){e.children&&e.remove(...e.children),e.geometry&&e.geometry.dispose(),e.material&&(Array.isArray(e.material)?e.material.forEach(t=>t.dispose()):e.material.dispose()),n.remove(e)}function Kv(n,e,t){const r=new Sm;r.setFromCamera(e,n);const a=new st;return r.ray.intersectPlane(t,a),a}function $v(n){const[e,t,r,a,l,x]=n,_=a*Math.PI/180,O=l*Math.PI/180,z=x*Math.PI/180,q=e,oe=0,ue=0,_e=t*Math.cos(z),be=t*Math.sin(z),Pe=0,Se=r*Math.cos(O),Ee=r*(Math.cos(_)-Math.cos(O)*Math.cos(z))/Math.sin(z),Xe=Math.sqrt(r*r-Se*Se-Ee*Ee);return[[q,oe,ue],[_e,be,Pe],[Se,Ee,Xe]]}function Bo(n,e){return n=n[0].map((t,r)=>n.map(a=>a[r])),YS(n,e)}function YS(n,e){const t=[];for(let r=0;r<n.length;r++){let a=0;for(let l=0;l<n[r].length;l++)a+=n[r][l]*e[l];t.push(a)}return t}function qS(n){const e=n[0][0]*(n[1][1]*n[2][2]-n[1][2]*n[2][1])-n[0][1]*(n[1][0]*n[2][2]-n[1][2]*n[2][0])+n[0][2]*(n[1][0]*n[2][1]-n[1][1]*n[2][0]);if(e===0)throw new Error("Matrix has zero determinant, cannot calculate inverse.");const t=1/e;return[[(n[1][1]*n[2][2]-n[1][2]*n[2][1])*t,(n[0][2]*n[2][1]-n[0][1]*n[2][2])*t,(n[0][1]*n[1][2]-n[0][2]*n[1][1])*t],[(n[1][2]*n[2][0]-n[1][0]*n[2][2])*t,(n[0][0]*n[2][2]-n[0][2]*n[2][0])*t,(n[0][2]*n[1][0]-n[0][0]*n[1][2])*t],[(n[1][0]*n[2][1]-n[1][1]*n[2][0])*t,(n[0][1]*n[2][0]-n[0][0]*n[2][1])*t,(n[0][0]*n[1][1]-n[0][1]*n[1][0])*t]]}function Cm(n,e){const t=new jn().lookAt(n,e,new Ei().up),r=new Oi().setFromRotationMatrix(t),a=new Oi().setFromAxisAngle(new st(1,0,0),Math.PI/2);return r.multiply(a),r}function Ou(n,e,t="black",r="14px"){const a=document.createElement("div");a.className="axis-label",a.textContent=e,a.style.color=t,a.style.fontSize=r;const l=new jS(a);return l.position.copy(n),l}class JS extends E0{constructor(e){super(),this.tjs=e}add(e){super.add(e),this.dispatchObjectEvent({data:e.toJSON(),action:"add",catalog:"object"})}remove(e){if(typeof e=="string"&&(e=this.getObjectByProperty("uuid",e),!e)){console.warn("Object not found");return}super.remove(e),this.dispatchObjectEvent({data:e.toJSON(),action:"remove",catalog:"object"})}dispatchObjectEvent(e){const t=new CustomEvent("weas",{detail:e});this.tjs.containerElement.dispatchEvent(t)}clear(){D2(this)}}class XS extends Wu{constructor(e,t,r,a,l,x,_=null){super(e,t,r,a,l,x),this.tjs=_}updateZoom(e){this.zoom!==e&&(this.zoom=e,this.updateProjectionMatrix(),this.dispatchObjectEvent({data:e,action:"zoom",catalog:"camera"}))}updatePosition(e,t,r){const a=new st(e,t,r);this.position.equals(a)||(this.position.copy(a),this.updateProjectionMatrix(),this.dispatchObjectEvent({data:[e,t,r],action:"position",catalog:"camera"}))}dispatchObjectEvent(e){const t=new CustomEvent("weas",{detail:e});this.tjs.containerElement.dispatchEvent(t),this.tjs.render()}}class ZS{constructor(e,t,r){this.name=e,this.geometry=t,this.material=r,this.object3D=new Ci(t,r)}}class QS{constructor(e,t){this.name=e,this.material=t}}class KS{constructor(e,t){this.name=e,this.geometry=t}}class $S{constructor(e,t){this.name=e,this.light=t}}class e7{constructor(e,t){this.name=e,this.renderer=t}}class t7{constructor(e){this.containerElement=e,this.scene=new JS(this),this.objects={},this.materials={},this.meshes={},this.lights={},this.renderers={},this._cameraType="Orthographic",this.sceneView={left:0,bottom:0,width:1,height:1},this.init()}createCoordScene(){this.coordScene=new E0;const e=.3;this.coordSceneView={left:0,bottom:0,width:this.sceneView.width*e,height:this.sceneView.height*e},this.coordCamera=new Wu(this.orthographicCamera.left,this.orthographicCamera.right,this.orthographicCamera.top,this.orthographicCamera.bottom,1,2e3),this.coordCamera.position.copy(this.camera.position);const t=new Uv(16777215,2);this.coordScene.add(t);const r=new Fv(16777215,2);r.position.set(10,10,10),this.coordScene.add(r)}createLegendScene(){this.legendScene=new E0;const e=.3;this.legendSceneView={left:.8,bottom:0,width:this.sceneView.width*e,height:this.sceneView.height*e},this.legendCamera=new Wu(this.orthographicCamera.left,this.orthographicCamera.right,this.orthographicCamera.top,this.orthographicCamera.bottom,1,2e3),this.legendCamera.position.set(0,0,100)}get cameraType(){return this._cameraType}set cameraType(e){this._cameraType=e,this.controls=new qv(this.camera,this.renderers.MainRenderer.renderer.domElement),this.updateCameraAndControls({})}get camera(){return this._cameraType==="Orthographic"?this.orthographicCamera:this.perspectiveCamera}init(){this.scene.background=new qn(16777215);const e=new rS({alpha:!0});e.autoClear=!1;const{width:t,height:r}=kp(this.containerElement);e.setSize(t,r),e.setPixelRatio(window.devicePixelRatio),this.addRenderer("MainRenderer",e);const a=new WS;a.setSize(t,r),a.domElement.style.position="absolute",a.domElement.style.top="0px",a.domElement.style.pointerEvents="none",this.addRenderer("LabelRenderer",a),this.perspectiveCamera=new Ro(50,t/r,1,500),this.perspectiveCamera.layers.enable(1);const l=20,x=t/r,_=l/2,O=_*x;this.orthographicCamera=new XS(-O,O,_,-_,1,2e3,this),this.orthographicCamera.layers.enable(1),this.camera.position.set(0,-100,0),this.camera.lookAt(0,0,0),this.scene.add(this.camera);const z=new Fv(16777215,2);z.position.set(50,50,100),this.addLight("MainLight",z),this.camera.add(z);const q=new Uv(4210752,20);this.addLight("AmbientLight",q),this.controls=new qv(this.camera,e.domElement),this.viewerRect=this.containerElement.getBoundingClientRect(),window.addEventListener("resize",this.onWindowResize.bind(this),!1),this.containerElement.addEventListener("mousemove",this.render.bind(this)),this.containerElement.addEventListener("pointerup",this.render.bind(this)),this.containerElement.addEventListener("pointerdown",this.render.bind(this)),this.containerElement.addEventListener("click",this.render.bind(this)),this.containerElement.addEventListener("wheel",this.render.bind(this)),this.containerElement.addEventListener("atomsUpdated",this.render.bind(this)),this.createCoordScene(),this.createLegendScene()}addObject(e,t,r){const a=new ZS(e,t,r);return this.objects[e]=a,this.scene.add(a.object3D),a}addMaterial(e,t){const r=new QS(e,t);return this.materials[e]=r,r}addMesh(e,t){const r=new KS(e,t);return this.meshes[e]=r,r}addLight(e,t){const r=new $S(e,t);return this.lights[e]=r,this.scene.add(r.light),r}addRenderer(e,t){this.containerElement.appendChild(t.domElement);const r=new e7(e,t);return this.renderers[e]=r,r}onWindowResize(){const{width:e,height:t}=kp(this.containerElement);if(this.camera.isOrthographicCamera){const _=e/t,O=this.camera.top-this.camera.bottom;this.camera.left=-O*_/2,this.camera.right=O*_/2,this.coordCamera.left=this.camera.left,this.coordCamera.right=this.camera.right}else this.camera.aspect=e/t,this.coordCamera.aspect=this.camera.aspect;this.camera.updateProjectionMatrix(),this.coordCamera.updateProjectionMatrix();const r=e*this.legendSceneView.width,a=t*this.legendSceneView.height,l=r/a,x=this.legendCamera.top-this.legendCamera.bottom;this.legendCamera.left=-x*l/2,this.legendCamera.right=x*l/2,this.legendCamera.updateProjectionMatrix(),Object.values(this.renderers).forEach(_=>{_.renderer.setSize(e,t)}),this.viewerRect=this.containerElement.getBoundingClientRect(),this.render()}updateCameraAndControls({lookAt:e=null,direction:t=[0,0,1],distance:r=null,zoom:a=1,fov:l=50}){const{width:x,height:_}=kp(this.containerElement);t=new st(...t).normalize();const O=this.getSceneBoundingBox();e===null?e=O.getCenter(new st):e=new st(...e);const z=r7(O,t);let q;this.camera.isOrthographicCamera?q=x/_:q=this.camera.aspect;let oe=10,ue=Math.max(z.x,z.y*q)+oe,_e=ue/q;this.camera.left=-ue/2,this.camera.right=ue/2,this.camera.top=_e/2,this.camera.bottom=-_e/2,this.coordCamera.left=this.camera.left,this.coordCamera.right=this.camera.right,this.coordCamera.top=this.camera.top,this.coordCamera.bottom=this.camera.bottom,r===null&&(r=z.z+oe);let be=e.clone().add(t.multiplyScalar(r));this.camera.position.set(be.x,be.y,be.z),this.camera.lookAt(e),this.camera.isOrthographicCamera?this.camera.updateZoom(a):this.camera.fov=l,this.camera.updateProjectionMatrix(),this.controls.target.set(e.x,e.y,e.z),this.render()}getSceneBoundingBox(){let e=new ys;return this.scene.traverse(function(t){if(t.isMesh||t.isLineSegments||t.isInstancedMesh){let r;if(t.isInstancedMesh){if(t.count===0)return;t.computeBoundingBox(),r=t.boundingBox}else t.geometry.computeBoundingBox(),r=t.geometry.boundingBox;if(r=new ys().copy(r).applyMatrix4(t.matrixWorld),isNaN(r.min.x)||isNaN(r.min.y)||isNaN(r.min.z))return;e.union(r)}}),e.isEmpty()&&(e=new ys(new st(-10,-10,-10),new st(10,10,10))),e}renderSceneInfo(e,t,r,a,l,x,_){const O=_.getSize(new Jr);var z=Math.floor(O.width*r),q=Math.floor(O.height*a),oe=Math.floor(O.width*l),ue=Math.floor(O.height*x);_.setViewport(z,q,oe,ue),_.setScissor(z,q,oe,ue),_.setScissorTest(!1),_.render(e,t)}render(){this.renderers.MainRenderer.renderer.clear(),this.renderers.LabelRenderer.renderer.render(this.scene,this.camera),this.renderSceneInfo(this.scene,this.camera,this.sceneView.left,this.sceneView.bottom,this.sceneView.width,this.sceneView.height,this.renderers.MainRenderer.renderer),this.coordCamera.position.copy(this.camera.position),this.coordCamera.position.sub(this.controls.target),this.coordCamera.lookAt(this.coordScene.position),this.renderSceneInfo(this.coordScene,this.coordCamera,this.coordSceneView.left,this.coordSceneView.bottom,this.coordSceneView.width,this.coordSceneView.height,this.renderers.MainRenderer.renderer),this.renderSceneInfo(this.legendScene,this.legendCamera,this.legendSceneView.left,this.legendSceneView.bottom,this.legendSceneView.width,this.legendSceneView.height,this.renderers.MainRenderer.renderer),this.controls.update()}exportImage(e=2){console.log("Exporting image"),e=Math.min(e,3);const t=this.renderers.MainRenderer.renderer,r=t.getPixelRatio(),a=e;t.setPixelRatio(a),this.render();var l=t.domElement.toDataURL("image/png");return t.setPixelRatio(r),this.render(),l}downloadImage(e="atomistic-model.png"){console.log("Downloading image");var t=this.exportImage(),r=document.createElement("a");r.href=t,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r)}}function r7(n,e){let t=new st,r=new st(1/0,1/0,1/0),a=new st(-1/0,-1/0,-1/0),l=new jn;return l.lookAt(e,new st(0,0,0),new st(0,1,0)),n.corners=[new st(n.min.x,n.min.y,n.min.z),new st(n.min.x,n.min.y,n.max.z),new st(n.min.x,n.max.y,n.min.z),new st(n.min.x,n.max.y,n.max.z),new st(n.max.x,n.min.y,n.min.z),new st(n.max.x,n.min.y,n.max.z),new st(n.max.x,n.max.y,n.min.z),new st(n.max.x,n.max.y,n.max.z)],n.corners.forEach(x=>{let _=x.clone().applyMatrix4(l);r.x=Math.min(r.x,_.x),r.y=Math.min(r.y,_.y),a.x=Math.max(a.x,_.x),a.y=Math.max(a.y,_.y),r.z=Math.min(r.z,_.z),a.z=Math.max(a.z,_.z)}),t.x=a.x-r.x,t.y=a.y-r.y,t.z=a.z-r.z,t}function kp(n,e=600,t=400){const r=getComputedStyle(n),a=n.clientWidth||parseInt(r.width,10)||e,l=n.clientHeight||parseInt(r.height,10)||t;return{width:a,height:l}}function n7(n){if(!(typeof window>"u")){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=n,document.head.appendChild(e),n}}function Nc(n,e){var t=n.__state.conversionName.toString(),r=Math.round(n.r),a=Math.round(n.g),l=Math.round(n.b),x=n.a,_=Math.round(n.h),O=n.s.toFixed(1),z=n.v.toFixed(1);if(e||t==="THREE_CHAR_HEX"||t==="SIX_CHAR_HEX"){for(var q=n.hex.toString(16);q.length<6;)q="0"+q;return"#"+q}else{if(t==="CSS_RGB")return"rgb("+r+","+a+","+l+")";if(t==="CSS_RGBA")return"rgba("+r+","+a+","+l+","+x+")";if(t==="HEX")return"0x"+n.hex.toString(16);if(t==="RGB_ARRAY")return"["+r+","+a+","+l+"]";if(t==="RGBA_ARRAY")return"["+r+","+a+","+l+","+x+"]";if(t==="RGB_OBJ")return"{r:"+r+",g:"+a+",b:"+l+"}";if(t==="RGBA_OBJ")return"{r:"+r+",g:"+a+",b:"+l+",a:"+x+"}";if(t==="HSV_OBJ")return"{h:"+_+",s:"+O+",v:"+z+"}";if(t==="HSVA_OBJ")return"{h:"+_+",s:"+O+",v:"+z+",a:"+x+"}"}return"unknown format"}var ey=Array.prototype.forEach,bu=Array.prototype.slice,Vr={BREAK:{},extend:function(n){return this.each(bu.call(arguments,1),function(e){var t=this.isObject(e)?Object.keys(e):[];t.forEach((function(r){this.isUndefined(e[r])||(n[r]=e[r])}).bind(this))},this),n},defaults:function(n){return this.each(bu.call(arguments,1),function(e){var t=this.isObject(e)?Object.keys(e):[];t.forEach((function(r){this.isUndefined(n[r])&&(n[r]=e[r])}).bind(this))},this),n},compose:function(){var n=bu.call(arguments);return function(){for(var e=bu.call(arguments),t=n.length-1;t>=0;t--)e=[n[t].apply(this,e)];return e[0]}},each:function(n,e,t){if(n){if(ey&&n.forEach&&n.forEach===ey)n.forEach(e,t);else if(n.length===n.length+0){var r=void 0,a=void 0;for(r=0,a=n.length;r<a;r++)if(r in n&&e.call(t,n[r],r)===this.BREAK)return}else for(var l in n)if(e.call(t,n[l],l)===this.BREAK)return}},defer:function(n){setTimeout(n,0)},debounce:function(n,e,t){var r=void 0;return function(){var a=this,l=arguments;function x(){r=null,t||n.apply(a,l)}var _=t||!r;clearTimeout(r),r=setTimeout(x,e),_&&n.apply(a,l)}},toArray:function(n){return n.toArray?n.toArray():bu.call(n)},isUndefined:function(n){return n===void 0},isNull:function(n){return n===null},isNaN:(function(n){function e(t){return n.apply(this,arguments)}return e.toString=function(){return n.toString()},e})(function(n){return isNaN(n)}),isArray:Array.isArray||function(n){return n.constructor===Array},isObject:function(n){return n===Object(n)},isNumber:function(n){return n===n+0},isString:function(n){return n===n+""},isBoolean:function(n){return n===!1||n===!0},isFunction:function(n){return n instanceof Function}},a7=[{litmus:Vr.isString,conversions:{THREE_CHAR_HEX:{read:function(n){var e=n.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return e===null?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:Nc},SIX_CHAR_HEX:{read:function(n){var e=n.match(/^#([A-F0-9]{6})$/i);return e===null?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:Nc},CSS_RGB:{read:function(n){var e=n.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return e===null?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:Nc},CSS_RGBA:{read:function(n){var e=n.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return e===null?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:Nc}}},{litmus:Vr.isNumber,conversions:{HEX:{read:function(n){return{space:"HEX",hex:n,conversionName:"HEX"}},write:function(n){return n.hex}}}},{litmus:Vr.isArray,conversions:{RGB_ARRAY:{read:function(n){return n.length!==3?!1:{space:"RGB",r:n[0],g:n[1],b:n[2]}},write:function(n){return[n.r,n.g,n.b]}},RGBA_ARRAY:{read:function(n){return n.length!==4?!1:{space:"RGB",r:n[0],g:n[1],b:n[2],a:n[3]}},write:function(n){return[n.r,n.g,n.b,n.a]}}}},{litmus:Vr.isObject,conversions:{RGBA_OBJ:{read:function(n){return Vr.isNumber(n.r)&&Vr.isNumber(n.g)&&Vr.isNumber(n.b)&&Vr.isNumber(n.a)?{space:"RGB",r:n.r,g:n.g,b:n.b,a:n.a}:!1},write:function(n){return{r:n.r,g:n.g,b:n.b,a:n.a}}},RGB_OBJ:{read:function(n){return Vr.isNumber(n.r)&&Vr.isNumber(n.g)&&Vr.isNumber(n.b)?{space:"RGB",r:n.r,g:n.g,b:n.b}:!1},write:function(n){return{r:n.r,g:n.g,b:n.b}}},HSVA_OBJ:{read:function(n){return Vr.isNumber(n.h)&&Vr.isNumber(n.s)&&Vr.isNumber(n.v)&&Vr.isNumber(n.a)?{space:"HSV",h:n.h,s:n.s,v:n.v,a:n.a}:!1},write:function(n){return{h:n.h,s:n.s,v:n.v,a:n.a}}},HSV_OBJ:{read:function(n){return Vr.isNumber(n.h)&&Vr.isNumber(n.s)&&Vr.isNumber(n.v)?{space:"HSV",h:n.h,s:n.s,v:n.v}:!1},write:function(n){return{h:n.h,s:n.s,v:n.v}}}}}],wu=void 0,dh=void 0,O0=function(){dh=!1;var n=arguments.length>1?Vr.toArray(arguments):arguments[0];return Vr.each(a7,function(e){if(e.litmus(n))return Vr.each(e.conversions,function(t,r){if(wu=t.read(n),dh===!1&&wu!==!1)return dh=wu,wu.conversionName=r,wu.conversion=t,Vr.BREAK}),Vr.BREAK}),dh},ty=void 0,Ih={hsv_to_rgb:function(n,e,t){var r=Math.floor(n/60)%6,a=n/60-Math.floor(n/60),l=t*(1-e),x=t*(1-a*e),_=t*(1-(1-a)*e),O=[[t,_,l],[x,t,l],[l,t,_],[l,x,t],[_,l,t],[t,l,x]][r];return{r:O[0]*255,g:O[1]*255,b:O[2]*255}},rgb_to_hsv:function(n,e,t){var r=Math.min(n,e,t),a=Math.max(n,e,t),l=a-r,x=void 0,_=void 0;if(a!==0)_=l/a;else return{h:NaN,s:0,v:0};return n===a?x=(e-t)/l:e===a?x=2+(t-n)/l:x=4+(n-e)/l,x/=6,x<0&&(x+=1),{h:x*360,s:_,v:a/255}},rgb_to_hex:function(n,e,t){var r=this.hex_with_component(0,2,n);return r=this.hex_with_component(r,1,e),r=this.hex_with_component(r,0,t),r},component_from_hex:function(n,e){return n>>e*8&255},hex_with_component:function(n,e,t){return t<<(ty=e*8)|n&~(255<<ty)}},i7=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},es=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},ts=(function(){function n(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}})(),al=function n(e,t,r){e===null&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,t);if(a===void 0){var l=Object.getPrototypeOf(e);return l===null?void 0:n(l,t,r)}else{if("value"in a)return a.value;var x=a.get;return x===void 0?void 0:x.call(r)}},ul=function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)},dl=function(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n},Zi=(function(){function n(){if(es(this,n),this.__state=O0.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return ts(n,[{key:"toString",value:function(){return Nc(this)}},{key:"toHexString",value:function(){return Nc(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),n})();function Em(n,e,t){Object.defineProperty(n,e,{get:function(){return this.__state.space==="RGB"?this.__state[e]:(Zi.recalculateRGB(this,e,t),this.__state[e])},set:function(r){this.__state.space!=="RGB"&&(Zi.recalculateRGB(this,e,t),this.__state.space="RGB"),this.__state[e]=r}})}function Lm(n,e){Object.defineProperty(n,e,{get:function(){return this.__state.space==="HSV"?this.__state[e]:(Zi.recalculateHSV(this),this.__state[e])},set:function(t){this.__state.space!=="HSV"&&(Zi.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=t}})}Zi.recalculateRGB=function(n,e,t){if(n.__state.space==="HEX")n.__state[e]=Ih.component_from_hex(n.__state.hex,t);else if(n.__state.space==="HSV")Vr.extend(n.__state,Ih.hsv_to_rgb(n.__state.h,n.__state.s,n.__state.v));else throw new Error("Corrupted color state")};Zi.recalculateHSV=function(n){var e=Ih.rgb_to_hsv(n.r,n.g,n.b);Vr.extend(n.__state,{s:e.s,v:e.v}),Vr.isNaN(e.h)?Vr.isUndefined(n.__state.h)&&(n.__state.h=0):n.__state.h=e.h};Zi.COMPONENTS=["r","g","b","h","s","v","hex","a"];Em(Zi.prototype,"r",2);Em(Zi.prototype,"g",1);Em(Zi.prototype,"b",0);Lm(Zi.prototype,"h");Lm(Zi.prototype,"s");Lm(Zi.prototype,"v");Object.defineProperty(Zi.prototype,"a",{get:function(){return this.__state.a},set:function(n){this.__state.a=n}});Object.defineProperty(Zi.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=Ih.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(n){this.__state.space="HEX",this.__state.hex=n}});var jl=(function(){function n(e,t){es(this,n),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return ts(n,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),n})(),o7={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},z2={};Vr.each(o7,function(n,e){Vr.each(n,function(t){z2[t]=e})});var s7=/(\d+(\.\d+)?)px/;function us(n){if(n==="0"||Vr.isUndefined(n))return 0;var e=n.match(s7);return Vr.isNull(e)?0:parseFloat(e[1])}var yr={makeSelectable:function(n,e){n===void 0||n.style===void 0||(n.onselectstart=e?function(){return!1}:function(){},n.style.MozUserSelect=e?"auto":"none",n.style.KhtmlUserSelect=e?"auto":"none",n.unselectable=e?"on":"off")},makeFullscreen:function(n,e,t){var r=t,a=e;Vr.isUndefined(a)&&(a=!0),Vr.isUndefined(r)&&(r=!0),n.style.position="absolute",a&&(n.style.left=0,n.style.right=0),r&&(n.style.top=0,n.style.bottom=0)},fakeEvent:function(n,e,t,r){var a=t||{},l=z2[e];if(!l)throw new Error("Event type "+e+" not supported.");var x=document.createEvent(l);switch(l){case"MouseEvents":{var _=a.x||a.clientX||0,O=a.y||a.clientY||0;x.initMouseEvent(e,a.bubbles||!1,a.cancelable||!0,window,a.clickCount||1,0,0,_,O,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var z=x.initKeyboardEvent||x.initKeyEvent;Vr.defaults(a,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),z(e,a.bubbles||!1,a.cancelable,window,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.keyCode,a.charCode);break}default:{x.initEvent(e,a.bubbles||!1,a.cancelable||!0);break}}Vr.defaults(x,r),n.dispatchEvent(x)},bind:function(n,e,t,r){var a=r||!1;return n.addEventListener?n.addEventListener(e,t,a):n.attachEvent&&n.attachEvent("on"+e,t),yr},unbind:function(n,e,t,r){var a=r||!1;return n.removeEventListener?n.removeEventListener(e,t,a):n.detachEvent&&n.detachEvent("on"+e,t),yr},addClass:function(n,e){if(n.className===void 0)n.className=e;else if(n.className!==e){var t=n.className.split(/ +/);t.indexOf(e)===-1&&(t.push(e),n.className=t.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return yr},removeClass:function(n,e){if(e)if(n.className===e)n.removeAttribute("class");else{var t=n.className.split(/ +/),r=t.indexOf(e);r!==-1&&(t.splice(r,1),n.className=t.join(" "))}else n.className=void 0;return yr},hasClass:function(n,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(n.className)||!1},getWidth:function(n){var e=getComputedStyle(n);return us(e["border-left-width"])+us(e["border-right-width"])+us(e["padding-left"])+us(e["padding-right"])+us(e.width)},getHeight:function(n){var e=getComputedStyle(n);return us(e["border-top-width"])+us(e["border-bottom-width"])+us(e["padding-top"])+us(e["padding-bottom"])+us(e.height)},getOffset:function(n){var e=n,t={left:0,top:0};if(e.offsetParent)do t.left+=e.offsetLeft,t.top+=e.offsetTop,e=e.offsetParent;while(e);return t},isActive:function(n){return n===document.activeElement&&(n.type||n.href)}},F2=(function(n){ul(e,n);function e(t,r){es(this,e);var a=dl(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),l=a;a.__prev=a.getValue(),a.__checkbox=document.createElement("input"),a.__checkbox.setAttribute("type","checkbox");function x(){l.setValue(!l.__prev)}return yr.bind(a.__checkbox,"change",x,!1),a.domElement.appendChild(a.__checkbox),a.updateDisplay(),a}return ts(e,[{key:"setValue",value:function(t){var r=al(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),r}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),al(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e})(jl),l7=(function(n){ul(e,n);function e(t,r,a){es(this,e);var l=dl(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),x=a,_=l;if(l.__select=document.createElement("select"),Vr.isArray(x)){var O={};Vr.each(x,function(z){O[z]=z}),x=O}return Vr.each(x,function(z,q){var oe=document.createElement("option");oe.innerHTML=q,oe.setAttribute("value",z),_.__select.appendChild(oe)}),l.updateDisplay(),yr.bind(l.__select,"change",function(){var z=this.options[this.selectedIndex].value;_.setValue(z)}),l.domElement.appendChild(l.__select),l}return ts(e,[{key:"setValue",value:function(t){var r=al(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),r}},{key:"updateDisplay",value:function(){return yr.isActive(this.__select)?this:(this.__select.value=this.getValue(),al(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e})(jl),c7=(function(n){ul(e,n);function e(t,r){es(this,e);var a=dl(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),l=a;function x(){l.setValue(l.__input.value)}function _(){l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}return a.__input=document.createElement("input"),a.__input.setAttribute("type","text"),yr.bind(a.__input,"keyup",x),yr.bind(a.__input,"change",x),yr.bind(a.__input,"blur",_),yr.bind(a.__input,"keydown",function(O){O.keyCode===13&&this.blur()}),a.updateDisplay(),a.domElement.appendChild(a.__input),a}return ts(e,[{key:"updateDisplay",value:function(){return yr.isActive(this.__input)||(this.__input.value=this.getValue()),al(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e})(jl);function ry(n){var e=n.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var U2=(function(n){ul(e,n);function e(t,r,a){es(this,e);var l=dl(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),x=a||{};return l.__min=x.min,l.__max=x.max,l.__step=x.step,Vr.isUndefined(l.__step)?l.initialValue===0?l.__impliedStep=1:l.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(l.initialValue))/Math.LN10))/10:l.__impliedStep=l.__step,l.__precision=ry(l.__impliedStep),l}return ts(e,[{key:"setValue",value:function(t){var r=t;return this.__min!==void 0&&r<this.__min?r=this.__min:this.__max!==void 0&&r>this.__max&&(r=this.__max),this.__step!==void 0&&r%this.__step!==0&&(r=Math.round(r/this.__step)*this.__step),al(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r)}},{key:"min",value:function(t){return this.__min=t,this}},{key:"max",value:function(t){return this.__max=t,this}},{key:"step",value:function(t){return this.__step=t,this.__impliedStep=t,this.__precision=ry(t),this}}]),e})(jl);function u7(n,e){var t=Math.pow(10,e);return Math.round(n*t)/t}var zh=(function(n){ul(e,n);function e(t,r,a){es(this,e);var l=dl(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,a));l.__truncationSuspended=!1;var x=l,_=void 0;function O(){var be=parseFloat(x.__input.value);Vr.isNaN(be)||x.setValue(be)}function z(){x.__onFinishChange&&x.__onFinishChange.call(x,x.getValue())}function q(){z()}function oe(be){var Pe=_-be.clientY;x.setValue(x.getValue()+Pe*x.__impliedStep),_=be.clientY}function ue(){yr.unbind(window,"mousemove",oe),yr.unbind(window,"mouseup",ue),z()}function _e(be){yr.bind(window,"mousemove",oe),yr.bind(window,"mouseup",ue),_=be.clientY}return l.__input=document.createElement("input"),l.__input.setAttribute("type","text"),yr.bind(l.__input,"change",O),yr.bind(l.__input,"blur",q),yr.bind(l.__input,"mousedown",_e),yr.bind(l.__input,"keydown",function(be){be.keyCode===13&&(x.__truncationSuspended=!0,this.blur(),x.__truncationSuspended=!1,z())}),l.updateDisplay(),l.domElement.appendChild(l.__input),l}return ts(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():u7(this.getValue(),this.__precision),al(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e})(U2);function ny(n,e,t,r,a){return r+(a-r)*((n-e)/(t-e))}var N0=(function(n){ul(e,n);function e(t,r,a,l,x){es(this,e);var _=dl(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,{min:a,max:l,step:x})),O=_;_.__background=document.createElement("div"),_.__foreground=document.createElement("div"),yr.bind(_.__background,"mousedown",z),yr.bind(_.__background,"touchstart",ue),yr.addClass(_.__background,"slider"),yr.addClass(_.__foreground,"slider-fg");function z(Pe){document.activeElement.blur(),yr.bind(window,"mousemove",q),yr.bind(window,"mouseup",oe),q(Pe)}function q(Pe){Pe.preventDefault();var Se=O.__background.getBoundingClientRect();return O.setValue(ny(Pe.clientX,Se.left,Se.right,O.__min,O.__max)),!1}function oe(){yr.unbind(window,"mousemove",q),yr.unbind(window,"mouseup",oe),O.__onFinishChange&&O.__onFinishChange.call(O,O.getValue())}function ue(Pe){Pe.touches.length===1&&(yr.bind(window,"touchmove",_e),yr.bind(window,"touchend",be),_e(Pe))}function _e(Pe){var Se=Pe.touches[0].clientX,Ee=O.__background.getBoundingClientRect();O.setValue(ny(Se,Ee.left,Ee.right,O.__min,O.__max))}function be(){yr.unbind(window,"touchmove",_e),yr.unbind(window,"touchend",be),O.__onFinishChange&&O.__onFinishChange.call(O,O.getValue())}return _.updateDisplay(),_.__background.appendChild(_.__foreground),_.domElement.appendChild(_.__background),_}return ts(e,[{key:"updateDisplay",value:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=t*100+"%",al(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e})(U2),B2=(function(n){ul(e,n);function e(t,r,a){es(this,e);var l=dl(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),x=l;return l.__button=document.createElement("div"),l.__button.innerHTML=a===void 0?"Fire":a,yr.bind(l.__button,"click",function(_){return _.preventDefault(),x.fire(),!1}),yr.addClass(l.__button,"button"),l.domElement.appendChild(l.__button),l}return ts(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e})(jl),D0=(function(n){ul(e,n);function e(t,r){es(this,e);var a=dl(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));a.__color=new Zi(a.getValue()),a.__temp=new Zi(0);var l=a;a.domElement=document.createElement("div"),yr.makeSelectable(a.domElement,!1),a.__selector=document.createElement("div"),a.__selector.className="selector",a.__saturation_field=document.createElement("div"),a.__saturation_field.className="saturation-field",a.__field_knob=document.createElement("div"),a.__field_knob.className="field-knob",a.__field_knob_border="2px solid ",a.__hue_knob=document.createElement("div"),a.__hue_knob.className="hue-knob",a.__hue_field=document.createElement("div"),a.__hue_field.className="hue-field",a.__input=document.createElement("input"),a.__input.type="text",a.__input_textShadow="0 1px 1px ",yr.bind(a.__input,"keydown",function(Pe){Pe.keyCode===13&&oe.call(this)}),yr.bind(a.__input,"blur",oe),yr.bind(a.__selector,"mousedown",function(){yr.addClass(this,"drag").bind(window,"mouseup",function(){yr.removeClass(l.__selector,"drag")})}),yr.bind(a.__selector,"touchstart",function(){yr.addClass(this,"drag").bind(window,"touchend",function(){yr.removeClass(l.__selector,"drag")})});var x=document.createElement("div");Vr.extend(a.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Vr.extend(a.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:a.__field_knob_border+(a.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Vr.extend(a.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Vr.extend(a.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Vr.extend(x.style,{width:"100%",height:"100%",background:"none"}),ay(x,"top","rgba(0,0,0,0)","#000"),Vr.extend(a.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),h7(a.__hue_field),Vr.extend(a.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:a.__input_textShadow+"rgba(0,0,0,0.7)"}),yr.bind(a.__saturation_field,"mousedown",_),yr.bind(a.__saturation_field,"touchstart",_),yr.bind(a.__field_knob,"mousedown",_),yr.bind(a.__field_knob,"touchstart",_),yr.bind(a.__hue_field,"mousedown",O),yr.bind(a.__hue_field,"touchstart",O);function _(Pe){_e(Pe),yr.bind(window,"mousemove",_e),yr.bind(window,"touchmove",_e),yr.bind(window,"mouseup",z),yr.bind(window,"touchend",z)}function O(Pe){be(Pe),yr.bind(window,"mousemove",be),yr.bind(window,"touchmove",be),yr.bind(window,"mouseup",q),yr.bind(window,"touchend",q)}function z(){yr.unbind(window,"mousemove",_e),yr.unbind(window,"touchmove",_e),yr.unbind(window,"mouseup",z),yr.unbind(window,"touchend",z),ue()}function q(){yr.unbind(window,"mousemove",be),yr.unbind(window,"touchmove",be),yr.unbind(window,"mouseup",q),yr.unbind(window,"touchend",q),ue()}function oe(){var Pe=O0(this.value);Pe!==!1?(l.__color.__state=Pe,l.setValue(l.__color.toOriginal())):this.value=l.__color.toString()}function ue(){l.__onFinishChange&&l.__onFinishChange.call(l,l.__color.toOriginal())}a.__saturation_field.appendChild(x),a.__selector.appendChild(a.__field_knob),a.__selector.appendChild(a.__saturation_field),a.__selector.appendChild(a.__hue_field),a.__hue_field.appendChild(a.__hue_knob),a.domElement.appendChild(a.__input),a.domElement.appendChild(a.__selector),a.updateDisplay();function _e(Pe){Pe.type.indexOf("touch")===-1&&Pe.preventDefault();var Se=l.__saturation_field.getBoundingClientRect(),Ee=Pe.touches&&Pe.touches[0]||Pe,Xe=Ee.clientX,qe=Ee.clientY,$e=(Xe-Se.left)/(Se.right-Se.left),ft=1-(qe-Se.top)/(Se.bottom-Se.top);return ft>1?ft=1:ft<0&&(ft=0),$e>1?$e=1:$e<0&&($e=0),l.__color.v=ft,l.__color.s=$e,l.setValue(l.__color.toOriginal()),!1}function be(Pe){Pe.type.indexOf("touch")===-1&&Pe.preventDefault();var Se=l.__hue_field.getBoundingClientRect(),Ee=Pe.touches&&Pe.touches[0]||Pe,Xe=Ee.clientY,qe=1-(Xe-Se.top)/(Se.bottom-Se.top);return qe>1?qe=1:qe<0&&(qe=0),l.__color.h=qe*360,l.setValue(l.__color.toOriginal()),!1}return a}return ts(e,[{key:"updateDisplay",value:function(){var t=O0(this.getValue());if(t!==!1){var r=!1;Vr.each(Zi.COMPONENTS,function(x){if(!Vr.isUndefined(t[x])&&!Vr.isUndefined(this.__color.__state[x])&&t[x]!==this.__color.__state[x])return r=!0,{}},this),r&&Vr.extend(this.__color.__state,t)}Vr.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var a=this.__color.v<.5||this.__color.s>.5?255:0,l=255-a;Vr.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+a+","+a+","+a+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,ay(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Vr.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+a+","+a+","+a+")",textShadow:this.__input_textShadow+"rgba("+l+","+l+","+l+",.7)"})}}]),e})(jl),d7=["-moz-","-o-","-webkit-","-ms-",""];function ay(n,e,t,r){n.style.background="",Vr.each(d7,function(a){n.style.cssText+="background: "+a+"linear-gradient("+e+", "+t+" 0%, "+r+" 100%); "})}function h7(n){n.style.background="",n.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",n.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var f7={load:function(n,e){var t=e||document,r=t.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=n,t.getElementsByTagName("head")[0].appendChild(r)},inject:function(n,e){var t=e||document,r=document.createElement("style");r.type="text/css",r.innerHTML=n;var a=t.getElementsByTagName("head")[0];try{a.appendChild(r)}catch{}}},p7=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,m7=function(n,e){var t=n[e];return Vr.isArray(arguments[2])||Vr.isObject(arguments[2])?new l7(n,e,arguments[2]):Vr.isNumber(t)?Vr.isNumber(arguments[2])&&Vr.isNumber(arguments[3])?Vr.isNumber(arguments[4])?new N0(n,e,arguments[2],arguments[3],arguments[4]):new N0(n,e,arguments[2],arguments[3]):Vr.isNumber(arguments[4])?new zh(n,e,{min:arguments[2],max:arguments[3],step:arguments[4]}):new zh(n,e,{min:arguments[2],max:arguments[3]}):Vr.isString(t)?new c7(n,e):Vr.isFunction(t)?new B2(n,e,""):Vr.isBoolean(t)?new F2(n,e):null};function g7(n){setTimeout(n,1e3/60)}var v7=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||g7,y7=(function(){function n(){es(this,n),this.backgroundElement=document.createElement("div"),Vr.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),yr.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Vr.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;yr.bind(this.backgroundElement,"click",function(){e.hide()})}return ts(n,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Vr.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var e=this,t=function r(){e.domElement.style.display="none",e.backgroundElement.style.display="none",yr.unbind(e.domElement,"webkitTransitionEnd",r),yr.unbind(e.domElement,"transitionend",r),yr.unbind(e.domElement,"oTransitionEnd",r)};yr.bind(this.domElement,"webkitTransitionEnd",t),yr.bind(this.domElement,"transitionend",t),yr.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-yr.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-yr.getHeight(this.domElement)/2+"px"}}]),n})(),x7=n7(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`);f7.inject(x7);var iy="dg",oy=72,sy=20,Xu="Default",Nu=(function(){try{return!!window.localStorage}catch{return!1}})(),Hu=void 0,ly=!0,Rc=void 0,Pp=!1,H2=[],ui=function n(e){var t=this,r=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),yr.addClass(this.domElement,iy),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],r=Vr.defaults(r,{closeOnTop:!1,autoPlace:!0,width:n.DEFAULT_WIDTH}),r=Vr.defaults(r,{resizable:r.autoPlace,hideable:r.autoPlace}),Vr.isUndefined(r.load)?r.load={preset:Xu}:r.preset&&(r.load.preset=r.preset),Vr.isUndefined(r.parent)&&r.hideable&&H2.push(this),r.resizable=Vr.isUndefined(r.parent)&&r.resizable,r.autoPlace&&Vr.isUndefined(r.scrollable)&&(r.scrollable=!0);var a=Nu&&localStorage.getItem(kc(this,"isLocal"))==="true",l=void 0,x=void 0;if(Object.defineProperties(this,{parent:{get:function(){return r.parent}},scrollable:{get:function(){return r.scrollable}},autoPlace:{get:function(){return r.autoPlace}},closeOnTop:{get:function(){return r.closeOnTop}},preset:{get:function(){return t.parent?t.getRoot().preset:r.load.preset},set:function(oe){t.parent?t.getRoot().preset=oe:r.load.preset=oe,M7(this),t.revert()}},width:{get:function(){return r.width},set:function(oe){r.width=oe,F0(t,oe)}},name:{get:function(){return r.name},set:function(oe){r.name=oe,x&&(x.innerHTML=r.name)}},closed:{get:function(){return r.closed},set:function(oe){r.closed=oe,r.closed?yr.addClass(t.__ul,n.CLASS_CLOSED):yr.removeClass(t.__ul,n.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=oe?n.TEXT_OPEN:n.TEXT_CLOSED)}},load:{get:function(){return r.load}},useLocalStorage:{get:function(){return a},set:function(oe){Nu&&(a=oe,oe?yr.bind(window,"unload",l):yr.unbind(window,"unload",l),localStorage.setItem(kc(t,"isLocal"),oe))}}}),Vr.isUndefined(r.parent)){if(this.closed=r.closed||!1,yr.addClass(this.domElement,n.CLASS_MAIN),yr.makeSelectable(this.domElement,!1),Nu&&a){t.useLocalStorage=!0;var _=localStorage.getItem(kc(this,"gui"));_&&(r.load=JSON.parse(_))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=n.TEXT_CLOSED,yr.addClass(this.__closeButton,n.CLASS_CLOSE_BUTTON),r.closeOnTop?(yr.addClass(this.__closeButton,n.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(yr.addClass(this.__closeButton,n.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),yr.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{r.closed===void 0&&(r.closed=!0);var O=document.createTextNode(r.name);yr.addClass(O,"controller-name"),x=Rm(t,O);var z=function(oe){return oe.preventDefault(),t.closed=!t.closed,!1};yr.addClass(this.__ul,n.CLASS_CLOSED),yr.addClass(x,"title"),yr.bind(x,"click",z),r.closed||(this.closed=!1)}r.autoPlace&&(Vr.isUndefined(r.parent)&&(ly&&(Rc=document.createElement("div"),yr.addClass(Rc,iy),yr.addClass(Rc,n.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(Rc),ly=!1),Rc.appendChild(this.domElement),yr.addClass(this.domElement,n.CLASS_AUTO_PLACE)),this.parent||F0(t,r.width)),this.__resizeHandler=function(){t.onResizeDebounced()},yr.bind(window,"resize",this.__resizeHandler),yr.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),yr.bind(this.__ul,"transitionend",this.__resizeHandler),yr.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),r.resizable&&w7(this),l=function(){Nu&&localStorage.getItem(kc(t,"isLocal"))==="true"&&localStorage.setItem(kc(t,"gui"),JSON.stringify(t.getSaveObject()))},this.saveToLocalStorageIfPossible=l;function q(){var oe=t.getRoot();oe.width+=1,Vr.defer(function(){oe.width-=1})}r.parent||q()};ui.toggleHide=function(){Pp=!Pp,Vr.each(H2,function(n){n.domElement.style.display=Pp?"none":""})};ui.CLASS_AUTO_PLACE="a";ui.CLASS_AUTO_PLACE_CONTAINER="ac";ui.CLASS_MAIN="main";ui.CLASS_CONTROLLER_ROW="cr";ui.CLASS_TOO_TALL="taller-than-window";ui.CLASS_CLOSED="closed";ui.CLASS_CLOSE_BUTTON="close-button";ui.CLASS_CLOSE_TOP="close-top";ui.CLASS_CLOSE_BOTTOM="close-bottom";ui.CLASS_DRAG="drag";ui.DEFAULT_WIDTH=245;ui.TEXT_CLOSED="Close Controls";ui.TEXT_OPEN="Open Controls";ui._keydownHandler=function(n){document.activeElement.type!=="text"&&(n.which===oy||n.keyCode===oy)&&ui.toggleHide()};yr.bind(window,"keydown",ui._keydownHandler,!1);Vr.extend(ui.prototype,{add:function(n,e){return Vu(this,n,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(n,e){return Vu(this,n,e,{color:!0})},remove:function(n){this.__ul.removeChild(n.__li),this.__controllers.splice(this.__controllers.indexOf(n),1);var e=this;Vr.defer(function(){e.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&Rc.removeChild(this.domElement);var n=this;Vr.each(this.__folders,function(e){n.removeFolder(e)}),yr.unbind(window,"keydown",ui._keydownHandler,!1),cy(this)},addFolder:function(n){if(this.__folders[n]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+n+'"');var e={name:n,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[n]&&(e.closed=this.load.folders[n].closed,e.load=this.load.folders[n]);var t=new ui(e);this.__folders[n]=t;var r=Rm(this,t.domElement);return yr.addClass(r,"folder"),t},removeFolder:function(n){this.__ul.removeChild(n.domElement.parentElement),delete this.__folders[n.name],this.load&&this.load.folders&&this.load.folders[n.name]&&delete this.load.folders[n.name],cy(n);var e=this;Vr.each(n.__folders,function(t){n.removeFolder(t)}),Vr.defer(function(){e.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var n=this.getRoot();if(n.scrollable){var e=yr.getOffset(n.__ul).top,t=0;Vr.each(n.__ul.childNodes,function(r){n.autoPlace&&r===n.__save_row||(t+=yr.getHeight(r))}),window.innerHeight-e-sy<t?(yr.addClass(n.domElement,ui.CLASS_TOO_TALL),n.__ul.style.height=window.innerHeight-e-sy+"px"):(yr.removeClass(n.domElement,ui.CLASS_TOO_TALL),n.__ul.style.height="auto")}n.__resize_handle&&Vr.defer(function(){n.__resize_handle.style.height=n.__ul.offsetHeight+"px"}),n.__closeButton&&(n.__closeButton.style.width=n.width+"px")},onResizeDebounced:Vr.debounce(function(){this.onResize()},50),remember:function(){if(Vr.isUndefined(Hu)&&(Hu=new y7,Hu.domElement.innerHTML=p7),this.parent)throw new Error("You can only call remember on a top level GUI.");var n=this;Vr.each(Array.prototype.slice.call(arguments),function(e){n.__rememberedObjects.length===0&&b7(n),n.__rememberedObjects.indexOf(e)===-1&&n.__rememberedObjects.push(e)}),this.autoPlace&&F0(this,this.width)},getRoot:function(){for(var n=this;n.parent;)n=n.parent;return n},getSaveObject:function(){var n=this.load;return n.closed=this.closed,this.__rememberedObjects.length>0&&(n.preset=this.preset,n.remembered||(n.remembered={}),n.remembered[this.preset]=hh(this)),n.folders={},Vr.each(this.__folders,function(e,t){n.folders[t]=e.getSaveObject()}),n},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=hh(this),I0(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(n){this.load.remembered||(this.load.remembered={},this.load.remembered[Xu]=hh(this,!0)),this.load.remembered[n]=hh(this),this.preset=n,z0(this,n,!0),this.saveToLocalStorageIfPossible()},revert:function(n){Vr.each(this.__controllers,function(e){this.getRoot().load.remembered?V2(n||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())},this),Vr.each(this.__folders,function(e){e.revert(e)}),n||I0(this.getRoot(),!1)},listen:function(n){var e=this.__listening.length===0;this.__listening.push(n),e&&G2(this.__listening)},updateDisplay:function(){Vr.each(this.__controllers,function(n){n.updateDisplay()}),Vr.each(this.__folders,function(n){n.updateDisplay()})}});function Rm(n,e,t){var r=document.createElement("li");return e&&r.appendChild(e),t?n.__ul.insertBefore(r,t):n.__ul.appendChild(r),n.onResize(),r}function cy(n){yr.unbind(window,"resize",n.__resizeHandler),n.saveToLocalStorageIfPossible&&yr.unbind(window,"unload",n.saveToLocalStorageIfPossible)}function I0(n,e){var t=n.__preset_select[n.__preset_select.selectedIndex];e?t.innerHTML=t.value+"*":t.innerHTML=t.value}function _7(n,e,t){if(t.__li=e,t.__gui=n,Vr.extend(t,{options:function(l){if(arguments.length>1){var x=t.__li.nextElementSibling;return t.remove(),Vu(n,t.object,t.property,{before:x,factoryArgs:[Vr.toArray(arguments)]})}if(Vr.isArray(l)||Vr.isObject(l)){var _=t.__li.nextElementSibling;return t.remove(),Vu(n,t.object,t.property,{before:_,factoryArgs:[l]})}},name:function(l){return t.__li.firstElementChild.firstElementChild.innerHTML=l,t},listen:function(){return t.__gui.listen(t),t},remove:function(){return t.__gui.remove(t),t}}),t instanceof N0){var r=new zh(t.object,t.property,{min:t.__min,max:t.__max,step:t.__step});Vr.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(l){var x=t[l],_=r[l];t[l]=r[l]=function(){var O=Array.prototype.slice.call(arguments);return _.apply(r,O),x.apply(t,O)}}),yr.addClass(e,"has-slider"),t.domElement.insertBefore(r.domElement,t.domElement.firstElementChild)}else if(t instanceof zh){var a=function(l){if(Vr.isNumber(t.__min)&&Vr.isNumber(t.__max)){var x=t.__li.firstElementChild.firstElementChild.innerHTML,_=t.__gui.__listening.indexOf(t)>-1;t.remove();var O=Vu(n,t.object,t.property,{before:t.__li.nextElementSibling,factoryArgs:[t.__min,t.__max,t.__step]});return O.name(x),_&&O.listen(),O}return l};t.min=Vr.compose(a,t.min),t.max=Vr.compose(a,t.max)}else t instanceof F2?(yr.bind(e,"click",function(){yr.fakeEvent(t.__checkbox,"click")}),yr.bind(t.__checkbox,"click",function(l){l.stopPropagation()})):t instanceof B2?(yr.bind(e,"click",function(){yr.fakeEvent(t.__button,"click")}),yr.bind(e,"mouseover",function(){yr.addClass(t.__button,"hover")}),yr.bind(e,"mouseout",function(){yr.removeClass(t.__button,"hover")})):t instanceof D0&&(yr.addClass(e,"color"),t.updateDisplay=Vr.compose(function(l){return e.style.borderLeftColor=t.__color.toString(),l},t.updateDisplay),t.updateDisplay());t.setValue=Vr.compose(function(l){return n.getRoot().__preset_select&&t.isModified()&&I0(n.getRoot(),!0),l},t.setValue)}function V2(n,e){var t=n.getRoot(),r=t.__rememberedObjects.indexOf(e.object);if(r!==-1){var a=t.__rememberedObjectIndecesToControllers[r];if(a===void 0&&(a={},t.__rememberedObjectIndecesToControllers[r]=a),a[e.property]=e,t.load&&t.load.remembered){var l=t.load.remembered,x=void 0;if(l[n.preset])x=l[n.preset];else if(l[Xu])x=l[Xu];else return;if(x[r]&&x[r][e.property]!==void 0){var _=x[r][e.property];e.initialValue=_,e.setValue(_)}}}}function Vu(n,e,t,r){if(e[t]===void 0)throw new Error('Object "'+e+'" has no property "'+t+'"');var a=void 0;if(r.color)a=new D0(e,t);else{var l=[e,t].concat(r.factoryArgs);a=m7.apply(n,l)}r.before instanceof jl&&(r.before=r.before.__li),V2(n,a),yr.addClass(a.domElement,"c");var x=document.createElement("span");yr.addClass(x,"property-name"),x.innerHTML=a.property;var _=document.createElement("div");_.appendChild(x),_.appendChild(a.domElement);var O=Rm(n,_,r.before);return yr.addClass(O,ui.CLASS_CONTROLLER_ROW),a instanceof D0?yr.addClass(O,"color"):yr.addClass(O,i7(a.getValue())),_7(n,O,a),n.__controllers.push(a),a}function kc(n,e){return document.location.href+"."+e}function z0(n,e,t){var r=document.createElement("option");r.innerHTML=e,r.value=e,n.__preset_select.appendChild(r),t&&(n.__preset_select.selectedIndex=n.__preset_select.length-1)}function uy(n,e){e.style.display=n.useLocalStorage?"block":"none"}function b7(n){var e=n.__save_row=document.createElement("li");yr.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),yr.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",yr.addClass(t,"button gears");var r=document.createElement("span");r.innerHTML="Save",yr.addClass(r,"button"),yr.addClass(r,"save");var a=document.createElement("span");a.innerHTML="New",yr.addClass(a,"button"),yr.addClass(a,"save-as");var l=document.createElement("span");l.innerHTML="Revert",yr.addClass(l,"button"),yr.addClass(l,"revert");var x=n.__preset_select=document.createElement("select");if(n.load&&n.load.remembered?Vr.each(n.load.remembered,function(oe,ue){z0(n,ue,ue===n.preset)}):z0(n,Xu,!1),yr.bind(x,"change",function(){for(var oe=0;oe<n.__preset_select.length;oe++)n.__preset_select[oe].innerHTML=n.__preset_select[oe].value;n.preset=this.value}),e.appendChild(x),e.appendChild(t),e.appendChild(r),e.appendChild(a),e.appendChild(l),Nu){var _=document.getElementById("dg-local-explain"),O=document.getElementById("dg-local-storage"),z=document.getElementById("dg-save-locally");z.style.display="block",localStorage.getItem(kc(n,"isLocal"))==="true"&&O.setAttribute("checked","checked"),uy(n,_),yr.bind(O,"change",function(){n.useLocalStorage=!n.useLocalStorage,uy(n,_)})}var q=document.getElementById("dg-new-constructor");yr.bind(q,"keydown",function(oe){oe.metaKey&&(oe.which===67||oe.keyCode===67)&&Hu.hide()}),yr.bind(t,"click",function(){q.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),Hu.show(),q.focus(),q.select()}),yr.bind(r,"click",function(){n.save()}),yr.bind(a,"click",function(){var oe=prompt("Enter a new preset name.");oe&&n.saveAs(oe)}),yr.bind(l,"click",function(){n.revert()})}function w7(n){var e=void 0;n.__resize_handle=document.createElement("div"),Vr.extend(n.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function t(l){return l.preventDefault(),n.width+=e-l.clientX,n.onResize(),e=l.clientX,!1}function r(){yr.removeClass(n.__closeButton,ui.CLASS_DRAG),yr.unbind(window,"mousemove",t),yr.unbind(window,"mouseup",r)}function a(l){return l.preventDefault(),e=l.clientX,yr.addClass(n.__closeButton,ui.CLASS_DRAG),yr.bind(window,"mousemove",t),yr.bind(window,"mouseup",r),!1}yr.bind(n.__resize_handle,"mousedown",a),yr.bind(n.__closeButton,"mousedown",a),n.domElement.insertBefore(n.__resize_handle,n.domElement.firstElementChild)}function F0(n,e){n.domElement.style.width=e+"px",n.__save_row&&n.autoPlace&&(n.__save_row.style.width=e+"px"),n.__closeButton&&(n.__closeButton.style.width=e+"px")}function hh(n,e){var t={};return Vr.each(n.__rememberedObjects,function(r,a){var l={},x=n.__rememberedObjectIndecesToControllers[a];Vr.each(x,function(_,O){l[O]=e?_.initialValue:_.getValue()}),t[a]=l}),t}function M7(n){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].value===n.preset&&(n.__preset_select.selectedIndex=e)}function G2(n){n.length!==0&&v7.call(window,function(){G2(n)}),Vr.each(n,function(e){e.updateDisplay()})}var j2=ui;function T7(n,e,t){const r=e.addFolder("Camera"),a={x:t.position.x,y:t.position.y,z:t.position.z},l={type:t instanceof Ro?"Perspective":"Orthographic"};r.add(l,"type",["Perspective","Orthographic"]).name("Camera Type").onChange(_=>{n.cameraType=_,n.updateCameraAndControls({})});function x(_,O,z){t.position.set(_,O,z),a.x=_,a.y=O,a.z=z}r.add(a,"x",-100,100).name("X Position").onChange(_=>x(_,a.y,a.z)),r.add(a,"y",-100,100).name("Y Position").onChange(_=>x(a.x,_,a.z)),r.add(a,"z",-100,100).name("Z Position").onChange(_=>x(a.x,a.y,_))}function A7(n,e){console.log("weas",n);const t=e.addFolder("Viewpoint"),r={Top:()=>{n.tjs.updateCameraAndControls({direction:[0,0,100]})},Bottom:()=>{n.tjs.updateCameraAndControls({direction:[0,0,-100]})},Left:()=>{n.tjs.updateCameraAndControls({direction:[-100,0,0]})},Right:()=>{n.tjs.updateCameraAndControls({direction:[100,0,0]})},Front:()=>{n.tjs.updateCameraAndControls({direction:[0,-100,0]})},Back:()=>{n.tjs.updateCameraAndControls({direction:[0,100,0]})}};for(const a in r)t.add(r,a).name(a)}const S7={_modelStyle:0,_colorBy:"Element",_colorType:"JMOL",_colorRamp:["red","blue"],_radiusType:"Covalent",_materialType:"Standard",_atomLabelType:"None",_showBondedAtoms:!1,_hideLongBonds:!0,_showHydrogenBonds:!1,_showCell:!0,_boundary:[[0,1],[0,1],[0,1]],_atomScale:.4,backgroundColor:"#ffffff",logLevel:"warn"},C7={controls:{enabled:!0,atomsControl:!0,colorControl:!0,cameraControls:!0},timeline:{enabled:!0},legend:{enabled:!1,position:"bottom-right"},buttons:{enabled:!0,fullscreen:!0,undo:!0,redo:!0,download:!0,measurement:!0},buttonStyle:{fontSize:"12px",color:"black",backgroundColor:"transparent",border:"none",padding:"1px",cursor:"pointer",borderRadius:"1px"}},E7={Ball:0,"Ball + Stick":1,Polyhedra:2,Stick:3,Line:4},L7={CPK:"CPK",VESTA:"VESTA",JMOL:"JMOL"},U0={Element:"Element",Index:"Index",Random:"Random",Uniform:"Uniform"},R7={Covalent:"Covalent",VDW:"VDW"};class k7{constructor(e,t){this.weas=e,this.guiConfig={...C7,...t},this.gui=new j2,this.gui.closed=!0,this.guiConfig.controls.enabled?this.initGUI():this.gui.hide(),this.guiConfig.buttons.enabled&&this.addButtons()}initGUI(){this.createGUIContainer(),this.guiConfig.controls.cameraControls&&this.addCameraControls()}createGUIContainer(){const e=document.createElement("div");e.style.position="absolute",e.style.top="10px",e.style.left="10px",this.weas.tjs.containerElement.appendChild(e),e.appendChild(this.gui.domElement);const t=r=>r.stopPropagation();["click","keydown","keyup","keypress"].forEach(r=>{e.addEventListener(r,t,!1)})}addCameraControls(){A7(this.weas,this.gui),T7(this.weas.tjs,this.gui,this.weas.tjs.camera)}addButtons(){const e=document.createElement("div");e.style.display="flex",e.style.position="absolute",e.style.backgroundColor="rgba(255, 255, 255, 0.8)",e.style.padding="10px",e.style.borderRadius="5px",e.style.right="5px",e.style.top="5px",e.style.gap="5px";const t=r=>r.stopPropagation();if(e.addEventListener("click",t),e.addEventListener("mousedown",t),e.addEventListener("mouseup",t),this.weas.tjs.containerElement.appendChild(e),this.guiConfig.buttons.fullscreen){const r=`
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512">
            <path d="M32 32C14.3 32 0 46.3 0 64v96c0 17.7 14.3 32 32 32s32-14.3 32-32V96h64c17.7 0 32-14.3 32-32s-14.3-32-32-32H32zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7 14.3 32 32 32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H64V352zM320 32c-17.7 0-32 14.3-32 32s14.3 32 32 32h64v64c0 17.7 14.3 32 32 32s32-14.3 32-32V64c0-17.7-14.3-32-32-32H320zM448 352c0-17.7-14.3-32-32-32s-32 14.3-32 32v64H320c-17.7 0-32 14.3-32 32s14.3 32 32 32h96c17.7 0 32-14.3 32-32V352z"/>
          </svg>
      `,a=`
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512">
            <path d="M160 64c0-17.7-14.3-32-32-32s-32 14.3-32 32v64H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96c17.7 0 32-14.3 32-32V64zM32 320c-17.7 0-32 14.3-32 32s14.3 32 32 32H96v64c0 17.7 14.3 32 32 32s32-14.3 32-32V352c0-17.7-14.3-32-32-32H32zM352 64c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7 14.3 32 32 32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V64zM320 320c-17.7 0-32 14.3-32 32v96c0 17.7 14.3 32 32 32s32-14.3 32-32V384h64c17.7 0 32-14.3 32-32s-14.3-32-32-32H320z"/>
          </svg>
      `,l=this.createButton(r,"fullscreen");e.appendChild(l),l.addEventListener("click",()=>{document.fullscreenElement?(document.exitFullscreen(),l.innerHTML=r):(this.weas.tjs.containerElement.requestFullscreen().catch(x=>{alert(`Error attempting to enable full-screen mode: ${x.message} (${x.name})`)}),l.innerHTML=a)})}if(this.guiConfig.buttons.undo){const r=this.createButton(`
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512">
            <path d="M125.7 160H176c17.7 0 32 14.3 32 32s-14.3 32-32 32H48c-17.7 0-32-14.3-32-32V64c0-17.7 14.3-32 32-32s32 14.3 32 32v51.2L97.6 97.6c87.5-87.5 229.3-87.5 316.8 0s87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3s-163.8-62.5-226.3 0L125.7 160z"/>
          </svg>
      `,"undo");e.appendChild(r),r.addEventListener("click",()=>{this.weas.ops.undo()})}if(this.guiConfig.buttons.redo){const r=this.createButton(`
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512">
            <path d="M386.3 160H336c-17.7 0-32 14.3-32 32s14.3 32 32 32H464c17.7 0 32-14.3 32-32V64c0-17.7-14.3-32-32-32s-32 14.3-32 32v51.2L414.4 97.6c-87.5-87.5-229.3-87.5-316.8 0s-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3s163.8-62.5 226.3 0L386.3 160z"/>
          </svg>
      `,"redo");e.appendChild(r),r.addEventListener("click",()=>{this.weas.ops.redo()})}if(this.guiConfig.buttons.download){const r=this.createButton(`
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512">
            <path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/>
          </svg>
      `,"download");e.appendChild(r),r.addEventListener("click",()=>{this.weas.tjs.downloadImage()})}if(this.guiConfig.buttons.measurement){const r=this.createButton(`
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512">
            <path d="M177.9 494.1c-18.7 18.7-49.1 18.7-67.9 0L17.9 401.9c-18.7-18.7-18.7-49.1 0-67.9l50.7-50.7 48 48c6.2 6.2 16.4 6.2 22.6 0s6.2-16.4 0-22.6l-48-48 41.4-41.4 48 48c6.2 6.2 16.4 6.2 22.6 0s6.2-16.4 0-22.6l-48-48 41.4-41.4 48 48c6.2 6.2 16.4 6.2 22.6 0s6.2-16.4 0-22.6l-48-48 41.4-41.4 48 48c6.2 6.2 16.4 6.2 22.6 0s6.2-16.4 0-22.6l-48-48 50.7-50.7c18.7-18.7 49.1-18.7 67.9 0l92.1 92.1c18.7 18.7 18.7 49.1 0 67.9L177.9 494.1z"/>
          </svg>
      `,"measurement");e.appendChild(r),r.addEventListener("click",()=>{this.weas.avr.Measurement.measure(this.weas.avr.selectedAtomsIndices)})}}createButton(e,t="button"){const r=document.createElement("button");return r.id=t,r.innerHTML=e,this.setStyle(r),r}setStyle(e){const t=this.guiConfig.buttonStyle||{};for(const[r,a]of Object.entries(t))e.style[r]=a}}class Vo{constructor(e){this.weas=e}execute(){throw new Error("Method 'execute()' must be implemented.")}undo(){throw new Error("Method 'undo()' must be implemented.")}redo(){this.execute()}adjust(e){throw new Error("Method 'adjust()' must be implemented.")}}function Wl(n,e){const t=n.domElement.querySelector(".title");t&&(t.textContent=e)}class Fh extends Vo{constructor({weas:e,vector:t=new st}){super(e),this.currentFrame=e.avr.currentFrame,this.selectedAtomsIndices=Array.from(e.avr.selectedAtomsIndices),this.selectedObjects=e.selectionManager.selectedObjects,Array.isArray(t)&&(t=new st(t[0],t[1],t[2])),this.vector=t.clone(),this.vectorGui={x:t.x,y:t.y,z:t.z}}execute(){console.log("execute translate"),this.weas.avr.currentFrame=this.currentFrame,this.weas.selectionManager.selectedObjects=this.selectedObjects,this.weas.avr.translateSelectedAtoms(this.vector,this.selectedAtomsIndices),this.weas.objectManager.translateSelectedObjects(this.vector)}undo(){console.log("undo translate"),this.weas.avr.currentFrame=this.currentFrame;const e=this.vector.clone().negate();this.weas.avr.translateSelectedAtoms(e,this.selectedAtomsIndices),this.weas.selectionManager.selectedObjects=this.selectedObjects,this.weas.objectManager.translateSelectedObjects(e)}adjust(){this.undo(),this.vector=new st(this.vectorGui.x,this.vectorGui.y,this.vectorGui.z),this.execute()}setupGUI(e){Wl(e,"Translate"),e.add(this.vectorGui,"x",-10,10).name("X-axis").onChange(t=>{this.adjust()}),e.add(this.vectorGui,"y",-10,10).name("Y-axis").onChange(t=>{this.adjust()}),e.add(this.vectorGui,"z",-10,10).name("Z-axis").onChange(t=>{this.adjust()})}}Aa(Fh,"description","Translate"),Aa(Fh,"category","Edit");class Uh extends Vo{constructor({weas:e,axis:t,angle:r}){super(e),this.currentFrame=e.avr.currentFrame,this.selectedAtomsIndices=Array.from(e.avr.selectedAtomsIndices),this.selectedObjects=e.selectionManager.selectedObjects,Array.isArray(t)&&(t=new st(t[0],t[1],t[2])),this.axis=t,this.angle=r,this.axisGui={x:t.x,y:t.y,z:t.z},this.angleGui=r}execute(){this.weas.avr.currentFrame=this.currentFrame,this.weas.selectionManager.selectedObjects=this.selectedObjects,this.weas.avr.rotateSelectedAtoms(this.axis,this.angle,this.selectedAtomsIndices),this.weas.objectManager.rotateSelectedObjects(this.axis,this.angle)}undo(){console.log("undo rotate"),this.weas.avr.currentFrame=this.currentFrame,this.weas.selectionManager.selectedObjects=this.selectedObjects,this.weas.avr.rotateSelectedAtoms(this.axis,-this.angle,this.selectedAtomsIndices),this.weas.objectManager.rotateSelectedObjects(this.axis,-this.angle)}adjust(){this.undo(),this.axis=new st(this.axisGui.x,this.axisGui.y,this.axisGui.z),this.angle=this.angleGui,this.execute()}setupGUI(e){Wl(e,"Rotate"),e.add(this,"angleGui",-360,360).name("Angle").onChange(()=>{this.adjust()}),e.add(this.axisGui,"x",-1,1).name("X-axis").onChange(()=>{this.adjust()}),e.add(this.axisGui,"y",-1,1).name("Y-axis").onChange(()=>{this.adjust()}),e.add(this.axisGui,"z",-1,1).name("Z-axis").onChange(()=>{this.adjust()})}}Aa(Uh,"description","Rotate"),Aa(Uh,"category","Edit");class Bh extends Vo{constructor({weas:e,scale:t=new st}){super(e),this.currentFrame=e.avr.currentFrame,this.selectedAtomsIndices=Array.from(e.avr.selectedAtomsIndices),this.selectedObjects=e.selectionManager.selectedObjects,Array.isArray(t)&&(t=new st(t[0],t[1],t[2])),this.scale=t.clone(),this.scaleGui={x:t.x,y:t.y,z:t.z}}execute(){console.log("execute scale"),this.weas.avr.currentFrame=this.currentFrame,this.weas.selectionManager.selectedObjects=this.selectedObjects,this.weas.objectManager.scaleSelectedObjects(this.scale)}undo(){console.log("undo scale"),this.weas.avr.currentFrame=this.currentFrame,this.weas.selectionManager.selectedObjects=this.selectedObjects;const e=new st(1/this.scale.x,1/this.scale.y,1/this.scale.z);this.weas.objectManager.scaleSelectedObjects(e)}adjust(){this.undo(),this.scale=new st(this.scaleGui.x,this.scaleGui.y,this.scaleGui.z),this.execute()}setupGUI(e){Wl(e,"Scale"),e.add(this.scaleGui,"x",.001,10).name("X-axis").onChange(t=>{this.adjust()}),e.add(this.scaleGui,"y",.001,10).name("Y-axis").onChange(t=>{this.adjust()}),e.add(this.scaleGui,"z",.001,10).name("Z-axis").onChange(t=>{this.adjust()})}}Aa(Bh,"description","Scale"),Aa(Bh,"category","Edit");const P7=Object.freeze(Object.defineProperty({__proto__:null,RotateOperation:Uh,ScaleOperation:Bh,TranslateOperation:Fh},Symbol.toStringTag,{value:"Module"}));class O7{constructor(e,t){this.weas=e,this.eventHandler=t,this.tjs=e.tjs,this.objectMode="edit",this.mode=null,this.init()}init(){this.translatePlane=new fs(new st(0,0,1),0),this.translateVector=new st,this.rotationMatrix=new jn,this.centroid=new st,this.centroidNDC=new Jr,this.initialAtomPositions=new Map,this.initialObjectState=new Map,this.cameraDirection=new st(0,0,-1)}attach(e){this.controls.attach(e)}detach(){this.controls.detach()}enterMode(e,t){this.mode=e,console.log("Enter mode: ",this.mode),this.cameraDirection=new st(0,0,-1),this.cameraDirection.applyQuaternion(this.tjs.camera.quaternion),this.mode==="translate"?this.translatePlane.normal.copy(this.cameraDirection):this.mode==="rotate"?this.getCentroidNDC():this.mode==="scale"&&this.getCentroidNDC(),this.initialMousePosition=t.clone(),this.storeInitialObjectState()}onMouseMove(e){this.mode==="translate"?this.translateSelectedObjects(e):this.mode==="rotate"?this.rotateSelectedObjects(e):this.mode==="scale"?this.scaleSelectedObjects(e):console.log("Invalid mode")}confirmOperation(){if(this.mode==="translate"){const e=this.getTranslateVector(this.eventHandler.currentMousePosition,this.initialMousePosition),t=new Fh({weas:this.weas,vector:e});this.weas.ops.execute(t,!1)}else if(this.mode==="rotate"){const e=this.getRotationAngle(this.eventHandler.currentMousePosition,this.initialMousePosition),t=new Uh({weas:this.weas,axis:this.cameraDirection,angle:e});this.weas.ops.execute(t,!1)}else if(this.mode==="scale"){const e=this.getScaleVector(this.eventHandler.currentMousePosition,this.initialMousePosition),t=new Bh({weas:this.weas,scale:e});this.weas.ops.execute(t,!1)}else console.log("Invalid mode");this.mode=null,this.initialAtomPositions.clear(),this.weas.avr.selectedAtomsIndices.length>0&&(this.weas.avr.drawModels(),this.weas.avr.selectedAtomsIndices=this.weas.avr.selectedAtomsIndices)}exitMode(){if(!this.mode)return;const e=this.mode;this.mode=null,console.log("Exit mode: ",e),this.weas.avr.resetSelectedAtomsPositions(this.initialAtomPositions),this.weas.ops.hideGUI(),this.weas.selectionManager.selectedObjects.forEach(t=>{const r=this.initialObjectState.get(t.uuid);t.position.copy(r.position),t.scale.copy(r.scale),t.rotation.copy(r.rotation)})}getCentroidNDC(){if(this.centroid=new st(0,0,0),this.weas.avr.selectedAtomsIndices.length>0)this.weas.avr.selectedAtomsIndices.forEach(t=>{this.centroid.add(new st(...this.weas.avr.atoms.positions[t]))}),this.centroid.divideScalar(this.weas.avr.selectedAtomsIndices.length);else if(this.weas.selectionManager.selectedObjects.length>0)this.weas.selectionManager.selectedObjects.forEach(t=>{this.centroid.add(t.position)}),this.centroid.divideScalar(this.weas.selectionManager.selectedObjects.length);else{console.log("No selected atoms or objects"),this.mode=null;return}const e=this.centroid.clone().project(this.tjs.camera);this.centroidNDC=new Jr(e.x,e.y)}storeInitialObjectState(){this.weas.avr.selectedAtomsIndices.forEach(e=>{const t=new jn;this.weas.avr.atomManager.meshes.atom.getMatrixAt(e,t);const r=new st;t.decompose(r,new Oi,new st),this.initialAtomPositions.set(e,r.clone())}),this.weas.selectionManager.selectedObjects.forEach(e=>{this.initialObjectState.set(e.uuid,{position:e.position.clone(),scale:e.scale.clone(),rotation:e.rotation.clone()})})}translateSelectedObjects(e){const t=this.getTranslateVector(this.eventHandler.currentMousePosition,this.eventHandler.previousMousePosition);this.weas.avr.translateSelectedAtoms(t),this.weas.objectManager.translateSelectedObjects(t)}getNDC(e){return new Jr((e.x-this.tjs.viewerRect.left)/this.tjs.viewerRect.width*2-1,-((e.y-this.tjs.viewerRect.top)/this.tjs.viewerRect.height)*2+1)}getTranslateVector(e,t){const r=this.getNDC(e),a=Kv(this.tjs.camera,r,this.translatePlane),l=this.getNDC(t),x=Kv(this.tjs.camera,l,this.translatePlane);return a.sub(x)}rotateSelectedObjects(e){const t=this.getRotationAngle(this.eventHandler.currentMousePosition,this.eventHandler.previousMousePosition);Math.abs(t)>1e-4&&(this.weas.avr.rotateSelectedAtoms(this.cameraDirection,t),this.weas.objectManager.rotateSelectedObjects(this.cameraDirection,t))}scaleSelectedObjects(e){const t=this.getScaleVector(this.eventHandler.currentMousePosition,this.eventHandler.previousMousePosition);t&&this.weas.objectManager.scaleSelectedObjects(t)}getScaleVector(e,t){const r=this.getNDC(t),a=this.getNDC(e);if(r.equals(a))return;const l=new Jr().subVectors(r,this.centroidNDC);let x=new Jr().subVectors(a,this.centroidNDC).length()/l.length();return new st(x,x,x)}getRotationAngle(e,t){const r=this.getNDC(t),a=this.getNDC(e);if(r.equals(a)){console.log("No mouse movement detected, skipping rotation.");return}const l=new Jr().subVectors(r,this.centroidNDC),x=new Jr().subVectors(a,this.centroidNDC);l.normalize(),x.normalize();let _=Math.acos(l.dot(x));return l.x*x.y-l.y*x.x<0&&(_=-_),_=zl.radToDeg(_),_}}class N7{constructor(e){this.weas=e,this.tjs=e.tjs,this.init(),this.transformControls=new O7(e,this),this.setupEventListeners()}init(){this.isMouseDown=!1,this.mouseDownPosition=new Jr,this.mouseUpPosition=new Jr,this.currentMousePosition=new Jr,this.previousMousePosition=new Jr,this.boxselect=!1,this.dragMode=null}setupEventListeners(){const e=this.weas.tjs.containerElement;e.addEventListener("pointerdown",this.onMouseDown.bind(this),!1),e.addEventListener("pointerup",this.onMouseUp.bind(this),!1),e.addEventListener("click",this.onMouseClick.bind(this),!1),e.addEventListener("mousemove",this.onMouseMove.bind(this),!1),e.setAttribute("tabindex","0"),e.addEventListener("keydown",this.onKeyDown.bind(this),!1)}onMouseDown(e){this.isMouseDown=!0,this.mouseDownPosition.set(e.clientX,e.clientY)}onMouseUp(e){this.isMouseDown=!1,this.mouseUpPosition.set(e.clientX,e.clientY)}onMouseMove(e){this.previousMousePosition.copy(this.currentMousePosition),this.currentMousePosition.set(e.clientX,e.clientY),this.transformControls.mode!==null?this.transformControls.onMouseMove(e):this.isMouseDown&&e.shiftKey&&this.weas.selectionManager.dragSelection(e)}onKeyDown(e){if(e.ctrlKey||e.metaKey)switch(e.key){case"z":this.weas.ops.undo();break;case"y":this.weas.ops.redo();break}else switch(e.key){case"Delete":case"x":this.weas.ops.object.DeleteOperation();break;case"Escape":this.transformControls.exitMode();break;case"o":this.weas.objectManager.enterMode("object");break;case"e":this.weas.objectManager.enterMode("edit");break;case"g":this.transformControls.enterMode("translate",this.currentMousePosition);break;case"s":this.transformControls.enterMode("scale",this.currentMousePosition);break;case"r":this.transformControls.enterMode("rotate",this.currentMousePosition);break;case"d":this.weas.ops.object.CopyOperation(),this.transformControls.enterMode("translate",this.currentMousePosition);break;case"c":this.weas.ops.atoms.ReplaceOperation();break;case"1":this.weas.tjs.updateCameraAndControls({direction:[0,-100,0]});break;case"2":this.weas.tjs.updateCameraAndControls({direction:[-100,0,0]});break;case"3":this.weas.tjs.updateCameraAndControls({direction:[0,0,100]});break;case"4":this.weas.tjs.updateCameraAndControls({direction:[0,100,0]});break;case"5":this.weas.tjs.updateCameraAndControls({direction:[100,0,0]});break;case"6":this.weas.tjs.updateCameraAndControls({direction:[0,0,-100]});break;case"F9":this.weas.ops.updateAdjustLastOperationGUI();break;case"l":this.weas.ops.updateAdjustLastOperationGUI();break;case"m":this.weas.avr.Measurement.measure(this.weas.avr.selectedAtomsIndices);break}}onMouseClick(e){if(this.transformControls.mode){this.transformControls.confirmOperation();return}this.weas.ops.hideGUI();const t=e.clientX-this.mouseDownPosition.x,r=e.clientY-this.mouseDownPosition.y;Math.sqrt(t*t+r*r)>5||this.weas.selectionManager.pickSelection(e)}dispatchAtomsUpdated(){this.weas.avr.trajectory.uuid=zl.generateUUID();const e=new CustomEvent("atomsUpdated",{detail:this.weas.avr.trajectory});this.tjs.containerElement.dispatchEvent(e)}dispatchViewerUpdated(e){const t=new CustomEvent("viewerUpdated",{detail:e});this.tjs.containerElement.dispatchEvent(t)}}class D7{constructor(e){this.weas=e,this.selectionManager=e.selectionManager,this.scene=e.tjs.scene}translateSelectedObjects(e,t=null){t===null&&(t=this.selectionManager.selectedObjects),t.forEach(r=>{const a=r.position.clone();r.position.copy(a.add(e))})}rotateSelectedObjects(e,t,r=null){r===null&&(r=this.selectionManager.selectedObjects),e=e.normalize(),t=zl.degToRad(t),r.forEach(a=>{a.rotateOnAxis(e,-t)})}deleteSelectedObjects(){this.selectionManager.selectedObjects.forEach(e=>{Po(this.scene,e)}),this.selectionManager.clearSelection()}scaleSelectedObjects(e,t=null){t===null&&(t=this.selectionManager.selectedObjects),t.forEach(r=>{r.scale.multiply(e)})}copySelectedObjects(){const e=[];return this.selectionManager.selectedObjects.forEach(t=>{const r=t.clone();r.position.add(new st(1,1,1)),this.scene.add(r),e.push(r)}),this.selectionManager.selectedObjects=e,e}enterMode(e){this.weas.activeObject!==null&&(this.weas.activeObject.userData.objectMode=e,e==="edit"?(this.weas.activeObject.userData.vertexPoints||I7(this.weas.activeObject),this.weas.activeObject.userData.vertexPoints.visible=!0):this.weas.activeObject.userData.vertexPoints&&(this.weas.activeObject.userData.vertexPoints.visible=!1))}}function dy(n,e=1.1){const t=new Gl({color:16776960,side:_o,transparent:!0,opacity:.8}),r=new Ci(n.geometry,t);r.scale.multiplyScalar(e),r.layers.set(1),n.add(r),n.userData.outlineMesh=r}function Op(n){console.log("removeOutline: ",n),n.userData.outlineMesh&&(n.remove(n.userData.outlineMesh),n.userData.outlineMesh=void 0)}function I7(n){console.log("initVertexIndicators: ",n);const e=n.geometry.attributes.position,t=e.count,r=new S2({vertexColors:!0,size:5,sizeAttenuation:!1}),a=new di;a.setAttribute("position",e);const l=new Float32Array(t*3);for(let _=0;_<t;_++)l[_*3]=0,l[_*3+1]=0,l[_*3+2]=0;a.setAttribute("color",new Xi(l,3));const x=new oS(a,r);n.add(x),x.layers.set(1),n.userData.vertexPoints=x}const Np=new Yh,Ec=new st,Lc=new st,Xo=new st,Ls=new st,ds=new st,Rs=new st,ks=new st,Mu=new st,Tu=new st,Au=new st,fh=new st,Su=new st,Cu=new st,Eu=new st,hy=new jn,z7=new Oi,F7=new st;class U7{constructor(e,t,r=Number.MAX_VALUE){this.camera=e,this.scene=t,this.startPoint=new st,this.endPoint=new st,this.collection=[],this.instances={},this.deep=r}select(e,t){return this.startPoint=e||this.startPoint,this.endPoint=t||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(Np,this.scene),this.collection}updateFrustum(e,t){if(e=e||this.startPoint,t=t||this.endPoint,e.x===t.x&&(t.x+=Number.EPSILON),e.y===t.y&&(t.y+=Number.EPSILON),this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),this.camera.isPerspectiveCamera){Lc.copy(e),Lc.x=Math.min(e.x,t.x),Lc.y=Math.max(e.y,t.y),t.x=Math.max(e.x,t.x),t.y=Math.min(e.y,t.y),Xo.setFromMatrixPosition(this.camera.matrixWorld),Ls.copy(Lc),ds.set(t.x,Lc.y,0),Rs.copy(t),ks.set(Lc.x,t.y,0),Ls.unproject(this.camera),ds.unproject(this.camera),Rs.unproject(this.camera),ks.unproject(this.camera),Su.copy(Ls).sub(Xo),Cu.copy(ds).sub(Xo),Eu.copy(Rs).sub(Xo),Su.normalize(),Cu.normalize(),Eu.normalize(),Su.multiplyScalar(this.deep),Cu.multiplyScalar(this.deep),Eu.multiplyScalar(this.deep),Su.add(Xo),Cu.add(Xo),Eu.add(Xo);const r=Np.planes;r[0].setFromCoplanarPoints(Xo,Ls,ds),r[1].setFromCoplanarPoints(Xo,ds,Rs),r[2].setFromCoplanarPoints(Rs,ks,Xo),r[3].setFromCoplanarPoints(ks,Ls,Xo),r[4].setFromCoplanarPoints(ds,Rs,ks),r[5].setFromCoplanarPoints(Eu,Cu,Su),r[5].normal.multiplyScalar(-1)}else if(this.camera.isOrthographicCamera){const r=Math.min(e.x,t.x),a=Math.max(e.y,t.y),l=Math.max(e.x,t.x),x=Math.min(e.y,t.y);Ls.set(r,a,-1),ds.set(l,a,-1),Rs.set(l,x,-1),ks.set(r,x,-1),Mu.set(r,a,1),Tu.set(l,a,1),Au.set(l,x,1),fh.set(r,x,1),Ls.unproject(this.camera),ds.unproject(this.camera),Rs.unproject(this.camera),ks.unproject(this.camera),Mu.unproject(this.camera),Tu.unproject(this.camera),Au.unproject(this.camera),fh.unproject(this.camera);const _=Np.planes;_[0].setFromCoplanarPoints(Ls,Mu,Tu),_[1].setFromCoplanarPoints(ds,Tu,Au),_[2].setFromCoplanarPoints(Au,fh,ks),_[3].setFromCoplanarPoints(fh,Mu,Ls),_[4].setFromCoplanarPoints(ds,Rs,ks),_[5].setFromCoplanarPoints(Au,Tu,Mu),_[5].normal.multiplyScalar(-1)}else console.error("THREE.SelectionBox: Unsupported camera type.")}searchChildInFrustum(e,t){if(t.isMesh||t.isLine||t.isPoints)if(t.isInstancedMesh){this.instances[t.uuid]=[];for(let r=0;r<t.count;r++)t.getMatrixAt(r,hy),hy.decompose(Ec,z7,F7),Ec.applyMatrix4(t.matrixWorld),e.containsPoint(Ec)&&this.instances[t.uuid].push(r)}else t.geometry.boundingSphere===null&&t.geometry.computeBoundingSphere(),Ec.copy(t.geometry.boundingSphere.center),Ec.applyMatrix4(t.matrixWorld),e.containsPoint(Ec)&&this.collection.push(t);if(t.children.length>0)for(let r=0;r<t.children.length;r++)this.searchChildInFrustum(e,t.children[r])}}class B7{constructor(e,t){this.element=document.createElement("div"),this.element.classList.add(t),this.element.style.pointerEvents="none",this.element.style.position="absolute",this.renderer=e,this.startPoint=new Jr,this.pointTopLeft=new Jr,this.pointBottomRight=new Jr,this.isDown=!1,this.enabled=!0,this.onPointerDown=(function(r){this.enabled!==!1&&(this.isDown=!0,this.onSelectStart(r))}).bind(this),this.onPointerMove=(function(r){r.shiftKey&&this.enabled!==!1&&this.isDown&&this.onSelectMove(r)}).bind(this),this.onPointerUp=(function(){this.enabled!==!1&&(this.isDown=!1,this.onSelectOver())}).bind(this),this.renderer.domElement.addEventListener("pointerdown",this.onPointerDown),this.renderer.domElement.addEventListener("pointermove",this.onPointerMove),this.renderer.domElement.addEventListener("pointerup",this.onPointerUp)}dispose(){this.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown),this.renderer.domElement.removeEventListener("pointermove",this.onPointerMove),this.renderer.domElement.removeEventListener("pointerup",this.onPointerUp)}onSelectStart(e){this.element.style.display="none",this.renderer.domElement.parentElement.appendChild(this.element);const t=this.renderer.domElement.parentElement.getBoundingClientRect();let r=e.clientX-t.left,a=e.clientY-t.top;this.element.style.left=r+"px",this.element.style.top=a+"px",this.element.style.width="0px",this.element.style.height="0px",this.startPoint.x=r,this.startPoint.y=a}onSelectMove(e){this.element.style.display="block";const t=this.renderer.domElement.parentElement.getBoundingClientRect();let r=e.clientX-t.left,a=e.clientY-t.top;this.pointBottomRight.x=Math.max(this.startPoint.x,r),this.pointBottomRight.y=Math.max(this.startPoint.y,a),this.pointTopLeft.x=Math.min(this.startPoint.x,r),this.pointTopLeft.y=Math.min(this.startPoint.y,a),this.element.style.left=this.pointTopLeft.x+"px",this.element.style.top=this.pointTopLeft.y+"px",this.element.style.width=this.pointBottomRight.x-this.pointTopLeft.x+"px",this.element.style.height=this.pointBottomRight.y-this.pointTopLeft.y+"px"}onSelectOver(){this.element.parentElement.removeChild(this.element)}}class H7{constructor(e){this.weas=e,this.tjs=e.tjs,this._selectedObjects=[],this.selectedInstances={},this.raycaster=new Sm,this.raycaster.layers.set(0),this.mouse=new Jr,this.init()}init(){this.selectionBox=new U7(this.tjs.camera,this.tjs.scene),this.helper=new B7(this.tjs.renderers.MainRenderer.renderer,"selectBox"),window.addEventListener("pointerdown",this.onMouseDown.bind(this),!1)}get selectedObjects(){return this._selectedObjects}set selectedObjects(e){e=e.filter(t=>!t.userData.notSelectable),this._selectedObjects=e,this.highlightSelectedObjects()}onMouseDown(e){let t=(e.clientX-this.tjs.viewerRect.left)/this.tjs.viewerRect.width*2-1,r=-((e.clientY-this.tjs.viewerRect.top)/this.tjs.viewerRect.height)*2+1;this.selectionBox.startPoint.set(t,r,.5),this.oldSelectedAtomsIndices=this.weas.avr.selectedAtomsIndices,this.oldSelectedObjects=this.selectedObjects}pickSelection(e){this.mouse.x=(e.clientX-this.tjs.viewerRect.left)/this.tjs.viewerRect.width*2-1,this.mouse.y=-((e.clientY-this.tjs.viewerRect.top)/this.tjs.viewerRect.height)*2+1,this.raycaster.setFromCamera(this.mouse,this.tjs.camera);const t=this.raycaster.intersectObjects(this.tjs.scene.children,!0);if(t.length===0){this.clearSelection();return}const r=t[0].object,a=t[0].face,l=t[0].point;if(this.weas.activeObject=r,!r.userData.notSelectable){if(r.userData.objectMode==="edit"){let x;if(r.isInstancedMesh)x={object:r,vertexId:t[0].instanceId};else if(r.isLineSegments){console.log("LineSegments selection not implemented");return}else{const _=V7(r,a,l);x={object:r,vertexId:_.vertexId,faceId:t[0].faceIndex}}this.selectedInstances[r.uuid]?this.selectedInstances[r.uuid].some(_=>_===x.vertexId)?this.selectedInstances[r.uuid]=this.selectedInstances[r.uuid].filter(_=>_!==x.vertexId):this.selectedInstances[r.uuid].push(x.vertexId):this.selectedInstances[r.uuid]=[x.vertexId],r.userData.type==="atom"&&(this.weas.avr.selectedAtomsIndices=[...this.selectedInstances[r.uuid]])}else this.selectedObjects.some(x=>x===r)?(console.log("Removing object from selection: ",r),Op(r),this.selectedObjects=this.selectedObjects.filter(x=>x!==r)):(console.log("Adding object to selection: ",r),this.selectedObjects.push(r),dy(r,1.1));this.highlightSelectedVertex()}}dragSelection(e){let t=(e.clientX-this.tjs.viewerRect.left)/this.tjs.viewerRect.width*2-1,r=-((e.clientY-this.tjs.viewerRect.top)/this.tjs.viewerRect.height)*2+1;if(this.selectionBox.endPoint.set(t,r,.5),this.selectionBox.select(),this.selectionBox.instances[this.weas.avr.atomManager.meshes.atom.uuid]){const a=this.selectionBox.instances[this.weas.avr.atomManager.meshes.atom.uuid];this.weas.avr.selectedAtomsIndices=[...new Set([...this.oldSelectedAtomsIndices,...a])]}this.selectedObjects=[...new Set([...this.oldSelectedObjects,...this.selectionBox.collection])]}clearSelection(){this.selectedObjects.forEach(e=>{Op(e)}),this.selectedObjects=[],this.selectedInstances={},this.weas.avr.selectedAtomsIndices=[],this.highlightSelectedVertex()}highlightSelectedVertex(){Object.keys(this.selectedInstances).forEach(e=>{const t=this.tjs.scene.getObjectByProperty("uuid",e);if(!t||!t.userData.vertexPoints)return;const r=t.userData.vertexPoints,a=this.selectedInstances[e],l=t.geometry.attributes.position.count,x=new Float32Array(l*3);for(let _=0;_<l;_++)x[_*3]=0,x[_*3+1]=0,x[_*3+2]=0;a.forEach(_=>{x[_*3]=1,x[_*3+1]=0,x[_*3+2]=0}),r.geometry.setAttribute("color",new Xi(x,3)),r.geometry.attributes.color.needsUpdate=!0,console.log("Colors updated for object:",e)})}highlightSelectedObjects(){this.selectedObjects.forEach(e=>{Op(e),dy(e,1.1)})}}function V7(n,e,t){const r=n.geometry.getAttribute("position"),a=new st,l=new st,x=new st;return a.fromBufferAttribute(r,e.a).applyMatrix4(n.matrixWorld),l.fromBufferAttribute(r,e.b).applyMatrix4(n.matrixWorld),x.fromBufferAttribute(r,e.c).applyMatrix4(n.matrixWorld),[{vertexId:e.a,distance:a.distanceTo(t)},{vertexId:e.b,distance:l.distanceTo(t)},{vertexId:e.c,distance:x.distanceTo(t)}].reduce((_,O)=>_.distance<O.distance?_:O)}class G7{constructor(e,t){this.weas=e,this.operations=j7(t),console.log("operations",this.operations),this.overlay=this.createOverlay(),this.bindEvents(),this.updateSearchResults("")}createOverlay(){const e=document.createElement("div");e.id="operation-search",e.className="search-overlay",e.style.display="none",e.style.position="absolute",e.style.top="20%",e.style.left="70%",e.style.width="300px",e.style.height="200px";const t=document.createElement("input");t.type="text",t.id="search-box",t.placeholder="Search operation...",t.addEventListener("input",a=>this.updateSearchResults(a.target.value));const r=document.createElement("ul");return r.id="search-results",e.appendChild(t),e.appendChild(r),this.weas.tjs.containerElement.appendChild(e),e}bindEvents(){const e=t=>t.stopPropagation();["click","keydown","keyup","keypress"].forEach(t=>{this.overlay.addEventListener(t,e,!1)}),this.weas.tjs.containerElement.addEventListener("keydown",t=>{t.ctrlKey&&t.key==="f"?(t.preventDefault(),this.show()):t.key==="Escape"&&this.hide()})}show(){this.overlay.style.display="block",this.overlay.querySelector("#search-box").focus()}hide(){this.overlay.style.display="none"}updateSearchResults(e){const t=this.overlay.querySelector("#search-results");t.innerHTML="";let r=this.operations;e&&(r=r.filter(a=>a.description&&a.description.toLowerCase().includes(e.toLowerCase()))),r=r.slice(0,10),r.forEach(a=>{if(!a.description)return;const l=document.createElement("li");l.tabIndex=0,l.textContent=`${a.category}: ${a.description}`,l.onclick=()=>this.execute(a),l.onkeydown=x=>{x.key==="Enter"&&this.execute(a)},t.appendChild(l)})}execute(e){console.log("Executing operation:",e.name);const t=new e({weas:this.weas});this.weas.ops.execute(t),this.hide(),this.weas.tjs.containerElement.focus()}}function j7(n){let e=[];return Object.keys(n).forEach(t=>{e=e.concat(Object.values(n[t]))}),e}class B0 extends Vo{constructor({weas:e,indices:t=null}){super(e),this.indices=t||Array.from(this.weas.avr.selectedAtomsIndices),this.initialAtoms=e.avr.atoms.copy(),this.initialObjectsState=this.weas.selectionManager.selectedObjects.map(r=>({object:r.clone(),parent:r.parent}))}execute(){this.indices.length>0&&this.weas.avr.deleteSelectedAtoms(this.indices),this.weas.objectManager.deleteSelectedObjects()}undo(){console.log("undo delete"),this.indices.length>0&&(this.weas.avr.atoms=this.initialAtoms.copy());const e=[];this.initialObjectsState.forEach(({object:t,parent:r})=>{r?r.add(t):this.weas.tjs.scene.add(t),e.push(t)}),this.weas.selectionManager.selectedObjects=e}}Aa(B0,"description","Delete"),Aa(B0,"category","Edit");class H0 extends Vo{constructor({weas:e,indices:t=null}){super(e),this.indices=t||Array.from(this.weas.avr.selectedAtomsIndices),this.initialAtoms=e.avr.atoms.copy(),this.newObjects=[]}execute(){this.indices.length>0&&this.weas.avr.copyAtoms(this.indices),this.newObjects=this.weas.objectManager.copySelectedObjects()}undo(){console.log("Undo copy operation."),this.indices.length>0&&(this.weas.avr.atoms=this.initialAtoms.copy()),this.newObjects.forEach(e=>{Po(this.weas.tjs.scene,e)})}redo(){this.execute()}setupGUI(e){}}Aa(H0,"description","Copy"),Aa(H0,"category","Edit");const W7=Object.freeze(Object.defineProperty({__proto__:null,CopyOperation:H0,DeleteOperation:B0},Symbol.toStringTag,{value:"Module"})),Y7=16777215,q7=new FS({color:Y7,specular:2236962,shininess:100,reflectivity:.9}),J7=new Dh({metalness:.1,roughness:.01,envMapIntensity:1}),X7=new Gl({color:new qn(16776960),transparent:!0,opacity:1}),hl={Phong:q7,Standard:J7,Basic:X7};function Yl(n,{position:e=[0,0,0],scale:t=[1,1,1],rotation:r=[0,0,0],color:a="#bd0d87",opacity:l=1,materialType:x="Standard"}){const _=hl[x].clone();_.color=new qn(a),_.transparent=!0,_.opacity=l,_.side=co;const O=new Ci(n,_);return O.position.set(...e),O.scale.set(...t),O.rotation.set(...r),O}function Z7(n){console.log("options",n);const e=new sl(n.size,n.size,n.size);return Yl(e,n)}function Q7(n){const e=new ll(n.radius,n.radius,n.depth,n.segments);return Yl(e,n)}function K7(n){const e=new Zh(n.radius,n.detail);return Yl(e,n)}function $7(n){const e=new qc(n.radius,n.height,n.segments);return Yl(e,n)}function e8(n){const e=new Wc(n.width,n.height,n.widthSegments,n.heightSegments);return Yl(e,n)}function t8(n){const e=new cl(n.radius,n.widthSegments,n.heightSegments);return Yl(e,n)}function r8(n){const e=new Dl(n.radius,n.tube,n.radialSegments,n.tubularSegments);return Yl(e,n)}function Th({position:n=[0,0,0],direction:e=[0,0,1],arrowLength:t=1,arrowRadius:r=.05,coneHeight:a=.2,coneRadius:l=.1,color:x="#bd0d87",opacity:_=1,materialType:O="Standard"}){const z=hl[O].clone();z.color=new qn(x),z.transparent=!0,z.opacity=_,z.side=co;const q=new gs;e=new st(...e);const oe=new ll(r,r,t-a,12),ue=new Ci(oe,z);ue.position.set(0,(t-a)/2,0),q.add(ue);const _e=new qc(l,a,12),be=new Ci(_e,z);be.position.set(0,t-a/2,0),q.add(be);const Pe=new st(0,1,0),Se=new Oi().setFromUnitVectors(Pe,e.clone().normalize());return q.applyQuaternion(Se),q.position.set(...n),q}class fl extends Vo{constructor(e,t,r){super(e),this.data=n8(t),this.drawFunction=r,this.object=null}execute(){const e=a8(this.data);this.object=this.drawFunction(e),this.weas.tjs.scene.add(this.object)}undo(){Po(this.weas.tjs.scene,this.object)}adjust(){this.undo(),this.execute()}setupGUI(e){Wl(e,this.constructor.description),e.add(this.data.position,"x",-10,10).name("X-axis").onChange(()=>this.adjust()),e.add(this.data.position,"y",-10,10).name("Y-axis").onChange(()=>this.adjust()),e.add(this.data.position,"z",-10,10).name("Z-axis").onChange(()=>this.adjust()),this.data.size!==void 0&&e.add(this.data,"size",.1,10).name("Size").onChange(()=>this.adjust()),this.data.radius!==void 0&&e.add(this.data,"radius",.1,10).name("Radius").onChange(()=>this.adjust()),this.data.depth!==void 0&&e.add(this.data,"depth",.1,10).name("Depth").onChange(()=>this.adjust()),this.data.segments!==void 0&&e.add(this.data,"segments",3,32).name("Segments").onChange(()=>this.adjust()),this.data.detail!==void 0&&e.add(this.data,"detail",0,5).name("Detail").onChange(()=>this.adjust()),this.data.direction!==void 0&&(e.add(this.data.direction,"x",-1,1).name("X-direction").onChange(()=>this.adjust()),e.add(this.data.direction,"y",-1,1).name("Y-direction").onChange(()=>this.adjust()),e.add(this.data.direction,"z",-1,1).name("Z-direction").onChange(()=>this.adjust())),this.data.length!==void 0&&e.add(this.data,"length",.1,10).name("Length").onChange(()=>this.adjust()),this.data.tube!==void 0&&e.add(this.data,"tube",.1,10).name("Tube").onChange(()=>this.adjust()),this.data.radialSegments!==void 0&&e.add(this.data,"radialSegments",3,32).name("Radial segments").onChange(()=>this.adjust()),this.data.tubularSegments!==void 0&&e.add(this.data,"tubularSegments",3,32).name("Tubular segments").onChange(()=>this.adjust()),this.data.widthSegments!==void 0&&e.add(this.data,"widthSegments",3,32).name("Width segments").onChange(()=>this.adjust()),this.data.heightSegments!==void 0&&e.add(this.data,"heightSegments",3,32).name("Height segments").onChange(()=>this.adjust()),this.data.scale!==void 0&&(e.add(this.data.scale,"x",.1,10).name("X-scale").onChange(()=>this.adjust()),e.add(this.data.scale,"y",.1,10).name("Y-scale").onChange(()=>this.adjust()),e.add(this.data.scale,"z",.1,10).name("Z-scale").onChange(()=>this.adjust())),e.addColor(this.data,"color").name("Color").onChange(()=>this.adjust())}}class V0 extends fl{constructor({weas:e,position:t={x:0,y:0,z:0},size:r=2,scale:a={x:1,y:1,z:1},rotation:l={x:0,y:0,z:0},color:x="#bd0d87",materialType:_="Standard"}){super(e,{position:t,size:r,scale:a,rotation:l,color:x,materialType:_},Z7)}}Aa(V0,"description","Add cube"),Aa(V0,"category","Mesh");class G0 extends fl{constructor({weas:e,position:t={x:0,y:0,z:0},size:r=2,scale:a={x:1,y:1,z:1},rotation:l={x:0,y:0,z:0},color:x="#bd0d87",materialType:_="Standard"}){super(e,{position:t,size:r,scale:a,rotation:l,color:x,materialType:_},e8)}}Aa(G0,"description","Add plane"),Aa(G0,"category","Mesh");class j0 extends fl{constructor({weas:e,position:t={x:0,y:0,z:0},radius:r=1,depth:a=2,segments:l=8,scale:x={x:1,y:1,z:1},rotation:_={x:0,y:0,z:0},color:O="#bd0d87",materialType:z="Standard"}){super(e,{position:t,radius:r,depth:a,segments:l,scale:x,rotation:_,color:O,materialType:z},Q7)}}Aa(j0,"description","Add cylinder"),Aa(j0,"category","Mesh");class W0 extends fl{constructor({weas:e,position:t={x:0,y:0,z:0},radius:r=1,detail:a=2,scale:l={x:1,y:1,z:1},rotation:x={x:0,y:0,z:0},color:_="#bd0d87",materialType:O="Standard"}){super(e,{position:t,radius:r,detail:a,scale:l,rotation:x,color:_,materialType:O},K7)}}Aa(W0,"description","Add icosahedron"),Aa(W0,"category","Mesh");class Y0 extends fl{constructor({weas:e,position:t={x:0,y:0,z:0},segments:r=8,radius:a=1,height:l=2,scale:x={x:1,y:1,z:1},rotation:_={x:0,y:0,z:0},color:O="#bd0d87",materialType:z="Standard"}){super(e,{position:t,segments:r,radius:a,height:l,scale:x,rotation:_,color:O,materialType:z},$7)}}Aa(Y0,"description","Add cone"),Aa(Y0,"category","Mesh");class q0 extends fl{constructor({weas:e,position:t={x:0,y:0,z:0},widthSegments:r=16,heightSegments:a=12,radius:l=1,scale:x={x:1,y:1,z:1},rotation:_={x:0,y:0,z:0},color:O="#bd0d87",materialType:z="Standard"}){super(e,{position:t,widthSegments:r,heightSegments:a,radius:l,scale:x,rotation:_,color:O,materialType:z},t8)}}Aa(q0,"description","Add sphere"),Aa(q0,"category","Mesh");class J0 extends fl{constructor({weas:e,position:t={x:0,y:0,z:0},radius:r=1,tube:a=.4,radialSegments:l=8,tubularSegments:x=24,scale:_={x:1,y:1,z:1},rotation:O={x:0,y:0,z:0},color:z="#bd0d87",materialType:q="Standard"}){super(e,{position:t,radius:r,tube:a,radialSegments:l,tubularSegments:x,scale:_,rotation:O,color:z,materialType:q},r8)}}Aa(J0,"description","Add torus"),Aa(J0,"category","Mesh");class X0 extends fl{constructor({weas:e,position:t={x:0,y:0,z:0},direction:r={x:0,y:0,z:1},arrowLength:a=1,arrowRadius:l=.05,coneHeight:x=.2,coneRadius:_=.1,color:O="#bd0d87",materialType:z="Standard"}){super(e,{position:t,direction:r,arrowLength:a,arrowRadius:l,coneHeight:x,color:O,coneRadius:_,materialType:z},Th)}}Aa(X0,"description","Add arrow"),Aa(X0,"category","Mesh");function n8(n){return n.position&&Array.isArray(n.position)&&(n.position={x:n.position[0],y:n.position[1],z:n.position[2]}),n.scale&&Array.isArray(n.scale)&&(n.scale={x:n.scale[0],y:n.scale[1],z:n.scale[2]}),n.rotation&&Array.isArray(n.rotation)&&(n.rotation={x:n.rotation[0],y:n.rotation[1],z:n.rotation[2]}),n.direction&&Array.isArray(n.direction)&&(n.direction={x:n.direction[0],y:n.direction[1],z:n.direction[2]}),n}function a8(n){const e={...n};return n.position&&!Array.isArray(n.position)&&(e.position=[n.position.x,n.position.y,n.position.z]),n.scale&&!Array.isArray(n.scale)&&(e.scale=[n.scale.x,n.scale.y,n.scale.z]),n.rotation&&!Array.isArray(n.rotation)&&(e.rotation=[n.rotation.x,n.rotation.y,n.rotation.z]),n.direction&&!Array.isArray(n.direction)&&(e.direction=[n.direction.x,n.direction.y,n.direction.z]),e}const i8=Object.freeze(Object.defineProperty({__proto__:null,AddArrowOperation:X0,AddConeOperation:Y0,AddCubeOperation:V0,AddCylinderOperation:j0,AddIcosahedronOperation:W0,AddPlaneOperation:G0,AddSphereOperation:q0,AddTorusOperation:J0},Symbol.toStringTag,{value:"Module"})),Hh={H:1,He:2,Li:3,Be:4,B:5,C:6,N:7,O:8,F:9,Ne:10,Na:11,Mg:12,Al:13,Si:14,P:15,S:16,Cl:17,Ar:18,K:19,Ca:20,Sc:21,Ti:22,V:23,Cr:24,Mn:25,Fe:26,Co:27,Ni:28,Cu:29,Zn:30,Ga:31,Ge:32,As:33,Se:34,Br:35,Kr:36,Rb:37,Sr:38,Y:39,Zr:40,Nb:41,Mo:42,Tc:43,Ru:44,Rh:45,Pd:46,Ag:47,Cd:48,In:49,Sn:50,Sb:51,Te:52,I:53,Xe:54,Cs:55,Ba:56,La:57,Ce:58,Pr:59,Nd:60,Pm:61,Sm:62,Eu:63,Gd:64,Tb:65,Dy:66,Ho:67,Er:68,Tm:69,Yb:70,Lu:71,Hf:72,Ta:73,W:74,Re:75,Os:76,Ir:77,Pt:78,Au:79,Hg:80,Tl:81,Pb:82,Bi:83,Po:84,At:85,Rn:86,Fr:87,Ra:88,Ac:89,Th:90,Pa:91,U:92,Np:93,Pu:94,Am:95,Cm:96,Bk:97,Cf:98,Es:99,Fm:100,Md:101,No:102,Lr:103,Rf:104,Db:105,Sg:106,Bh:107,Hs:108,Mt:109,Ds:110,Rg:111,Cn:112,Nh:113,Fl:114,Mc:115,Lv:116,Ts:117,Og:118},o8={H:16777215,He:14286847,Li:13402367,Be:12779264,B:16758197,C:13158600,N:255,O:16711680,F:16711935,Ne:11788530,Na:11230450,Mg:9109248,Al:12532282,Si:16761024,P:16744448,S:16777008,Cl:2096896,K:9388244,Ar:8442342,Ca:4062976,Sc:15132390,Ti:12567239,V:10921643,Cr:9083335,Mn:10255047,Fe:14706227,Ni:16765219,Co:16765219,Cu:13074483,Zn:8224944,Ga:12750735,Ge:6721423,As:12419299,Se:16752896,Br:10889513,Kr:6076625,Rb:7351984,Sr:65280,Y:9764863,Zr:9756896,Nb:7586505,Mo:5551541,Tc:3907230,Ru:2396047,Rh:687500,Pd:27013,Ag:12632256,Cd:16767375,In:10909043,Sn:6717568,Sb:10380213,Te:13924864,I:9699476,Xe:4366e3,Cs:5707663,Ba:51456,La:7394559,Ce:16777159,Pr:14286592,Nd:13106944,Pm:10747648,Sm:9240320,Eu:6422272,Gd:4587264,Tb:3211008,Dy:2093068,Ho:65290,Er:58997,Tm:54354,Yb:48952,Lu:43812,Hf:5096191,Ta:5089023,W:2200790,Re:2522539,Os:2516630,Ir:1528967,Pt:13684960,Au:16765219,Hg:12105936,Tl:10900557,Pb:5724513,Bi:10375093,Po:11230208,At:7688005,Rn:4358806,Fr:4325478,Ra:32e3,Ac:7384058,Th:41471,Pa:41471,U:36863,Np:33023,Pu:27647,Am:5528818,Cm:7888099,Bk:9064419,Cf:10565332,Es:11739092,Fm:11739066,Md:11739008,No:12386490,Lr:12452010,Rf:13697160,Db:14221422,Sg:14680143,Bh:15073336,Hs:15400998,Mt:15794194,Ds:16711906,Rg:16711804,Cn:16711772,Nh:16711749,Fl:16711723,Mc:16711709,Lv:16711697,Ts:16711685,Og:16711680},s8={H:.31,He:.28,Li:1.28,Be:.96,B:.84,C:.76,N:.71,O:.66,F:.57,Ne:.58,Na:1.66,Mg:1.41,Al:1.21,Si:1.11,P:1.07,S:1.05,Cl:1.02,Ar:1.06,K:2.03,Ca:1.76,Sc:1.7,Ti:1.6,V:1.53,Cr:1.39,Mn:1.39,Fe:1.32,Co:1.26,Ni:1.24,Cu:1.32,Zn:1.22,Ga:1.22,Ge:1.2,As:1.19,Se:1.2,Br:1.2,Kr:1.16,Rb:2.2,Sr:1.95,Y:1.9,Zr:1.75,Nb:1.64,Mo:1.54,Tc:1.47,Ru:1.46,Rh:1.42,Pd:1.39,Ag:1.45,Cd:1.44,In:1.42,Sn:1.39,Sb:1.39,Te:1.38,I:1.39,Xe:1.4,Cs:2.44,Ba:2.15,La:2.07,Ce:2.04,Pr:2.03,Nd:2.01,Pm:1.99,Sm:1.98,Eu:1.98,Gd:1.96,Tb:1.94,Dy:1.92,Ho:1.92,Er:1.89,Tm:1.9,Yb:1.87,Lu:1.87,Hf:1.75,Ta:1.7,W:1.62,Re:1.51,Os:1.44,Ir:1.41,Pt:1.36,Au:1.36,Hg:1.32,Tl:1.45,Pb:1.46,Bi:1.48,Po:1.4,At:1.5,Rn:1.5,Fr:2.6,Ra:2.21,Ac:2.15,Th:2.06,Pa:2,U:1.96,Np:1.9,Pu:1.87,Am:1.8,Cm:1.69},l8={X:NaN,H:1.2,He:1.4,Li:1.82,Be:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,Ne:1.54,Na:2.27,Mg:1.73,Al:1.84,Si:2.1,P:1.8,S:1.8,Cl:1.75,Ar:1.88,K:2.75,Ca:2.31,Sc:NaN,Ti:NaN,V:NaN,Cr:NaN,Mn:NaN,Fe:NaN,Co:NaN,Ni:1.63,Cu:1.4,Zn:1.39,Ga:1.87,Ge:2.11,As:1.85,Se:1.9,Br:1.85,Kr:2.02,Rb:3.03,Sr:2.49,Y:NaN,Zr:NaN,Nb:NaN,Mo:NaN,Tc:NaN,Ru:NaN,Rh:NaN,Pd:1.63,Ag:1.72,Cd:1.58,In:1.93,Sn:2.17,Sb:2.06,Te:2.06,I:1.98,Xe:2.16,Cs:3.43,Ba:2.49,La:NaN,Ce:NaN,Pr:NaN,Nd:NaN,Pm:NaN,Sm:NaN,Eu:NaN,Gd:NaN,Tb:NaN,Dy:NaN,Ho:NaN,Er:NaN,Tm:NaN,Yb:NaN,Lu:NaN,Hf:NaN,Ta:NaN,W:NaN,Re:NaN,Os:NaN,Ir:NaN,Pt:1.75,Au:1.66,Hg:1.55,Tl:1.96,Pb:2.02,Bi:2.07,Po:1.97,At:2.02,Rn:2.2,Fr:3.48,Ra:2.83,Ac:NaN,Th:NaN,Pa:NaN,U:1.86,Np:NaN,Pu:NaN,Am:NaN,Cm:NaN,Bk:NaN,Cf:NaN,Es:NaN,Fm:NaN,Md:NaN,No:NaN,Lr:NaN},Z0=["Ac","Zr","Pr","Mo","Li","Ba","Cd","Es","Al","Os","V","Sm","Dy","Ti","Pb","Ni","Sr","Na","Lu","Y","Tb","Au","Be","Sn","Xe","As","Cr","Ru","Re","Yb","I","Ag","Se","Th","In","Pu","Te","W","Ca","Co","Pd","Tl","B","Br","Rh","Pa","Tc","Zn","Eu","Ta","Cm","Nb","Hf","La","Ce","Cf","D","U","Mn","Si","Hg","Cu","Rb","K","Er","NH","Fe","Ge","Am","P","Tm","Gd","Ga","Pm","Bi","Mg","Sc","Kr","Sb","Ir","Po","Bk","F","Ho","Nd","Cs","Np","Pt"],c8={X:"#cc00cc",H:"#ffcccc",D:"#ccccff",He:"#fce9cf",Li:"#86e074",Be:"#5fd87b",B:"#20a20f",C:"#814929",N:"#b0bae6",O:"#ff0300",F:"#b0bae6",Ne:"#ff38b5",Na:"#fadd3d",Mg:"#fc7c16",Al:"#81b3d6",Si:"#1b3bfa",P:"#c19cc3",S:"#fffa00",Cl:"#32fc03",Ar:"#cffec5",K:"#a122f7",Ca:"#5b96be",Sc:"#b663ac",Ti:"#78caff",V:"#e61a00",Cr:"#00009e",Mn:"#a9099e",Fe:"#b57200",Co:"#0000af",Ni:"#b8bcbe",Cu:"#2247dd",Zn:"#8f9082",Ga:"#9fe474",Ge:"#7e6fa6",As:"#75d057",Se:"#9aef10",Br:"#7f3103",Kr:"#fac1f3",Rb:"#ff0099",Sr:"#00ff27",Y:"#67988e",Zr:"#00ff00",Nb:"#4cb376",Mo:"#b486b0",Tc:"#cdafcb",Ru:"#cfb8ae",Rh:"#ced2ab",Pd:"#c2c4b9",Ag:"#b8bcbe",Cd:"#f31fdc",In:"#d781bb",Sn:"#9b8fba",Sb:"#d88350",Te:"#ada252",I:"#8f1f8b",Xe:"#9ba1f8",Cs:"#0fffb9",Ba:"#1ef02d",La:"#5ac449",Ce:"#d1fd06",Pr:"#fde206",Nd:"#fc8e07",Pm:"#0000f5",Sm:"#fd067d",Eu:"#fb08d5",Gd:"#c004ff",Tb:"#7104fe",Dy:"#3106fd",Ho:"#0742fb",Er:"#49733b",Tm:"#0000e0",Yb:"#27fdf4",Lu:"#26fdb5",Hf:"#b4b459",Ta:"#b79b56",W:"#8e8a80",Re:"#b3b18e",Os:"#c9b179",Ir:"#c9cf73",Pt:"#ccc6bf",Au:"#feb338",Hg:"#d3b8cc",Tl:"#96896d",Pb:"#53535b",Bi:"#d230f8",Po:"#0000ff",At:"#0000ff",Rn:"#ffff00",Fr:"#000000",Ra:"#6eaa59",Ac:"#649e73",Th:"#26fe78",Pa:"#29fb35",U:"#7aa2aa",Np:"#4d4d4d",Pu:"#4d4d4d",Am:"#4d4d4d",XX:"#4d4d4d"},u8={None:"#ff0000",H:"#ffffff",He:"#d9ffff",Li:"#cc80ff",Be:"#c2ff00",B:"#ffb5b5",C:"#909090",N:"#3050f8",O:"#ff0d0d",F:"#90e050",Ne:"#b3e3f5",Na:"#ab5cf2",Mg:"#8aff00",Al:"#bfa6a6",Si:"#f0c8a0",P:"#ff8000",S:"#ffff30",Cl:"#1ff01f",Ar:"#80d1e3",K:"#8f40d4",Ca:"#3dff00",Sc:"#e6e6e6",Ti:"#bfc2c7",V:"#a6a6ab",Cr:"#8a99c7",Mn:"#9c7ac7",Fe:"#e06633",Co:"#f090a0",Ni:"#50d050",Cu:"#c88033",Zn:"#7d80b0",Ga:"#c28f8f",Ge:"#668f8f",As:"#bd80e3",Se:"#ffa100",Br:"#a62929",Kr:"#5cb8d1",Rb:"#702eb0",Sr:"#00ff00",Y:"#94ffff",Zr:"#94e0e0",Nb:"#73c2c9",Mo:"#54b5b5",Tc:"#3b9e9e",Ru:"#248f8f",Rh:"#0a7d8c",Pd:"#006985",Ag:"#c0c0c0",Cd:"#ffd98f",In:"#a67573",Sn:"#668080",Sb:"#9e63b5",Te:"#d47a00",I:"#940094",Xe:"#429eb0",Cs:"#57178f",Ba:"#00c900",La:"#70d4ff",Ce:"#ffffc7",Pr:"#d9ffc7",Nd:"#c7ffc7",Pm:"#a3ffc7",Sm:"#8fffc7",Eu:"#61ffc7",Gd:"#45ffc7",Tb:"#30ffc7",Dy:"#1fffc7",Ho:"#00ff9c",Er:"#00e675",Tm:"#00d452",Yb:"#00bf38",Lu:"#00ab24",Hf:"#4dc2ff",Ta:"#4da6ff",W:"#2194d6",Re:"#267dab",Os:"#266696",Ir:"#175487",Pt:"#d0d0e0",Au:"#ffd123",Hg:"#b8b8d0",Tl:"#a6544d",Pb:"#575961",Bi:"#9e4fb5",Po:"#ab5c00",At:"#754f45",Rn:"#428296",Fr:"#420066",Ra:"#007d00",Ac:"#70abfa",Th:"#00baff",Pa:"#00a1ff",U:"#008fff",Np:"#0080ff",Pu:"#006bff",Am:"#545cf2",Cm:"#785ce3",Bk:"#8a4fe3",Cf:"#a136d4",Es:"#b31fd4",Fm:"#b31fba",Md:"#b30da6",No:"#bd0d87",Lr:"#c70066",Rf:"#cc0059",Db:"#d1004f",Sg:"#d90045",Bh:"#e00038",Hs:"#e6002e",Mt:"#eb0026"},Qh={CPK:o8,VESTA:c8,JMOL:u8},fy={"Ac-O":[1,1,0],"Ac-F":[1,1,0],"Ac-Cl":[1,1,0],"Ac-Br":[1,1,0],"Ag-O":[1,1,0],"Ag-S":[1,1,0],"Ag-F":[1,1,0],"Ag-Cl":[1,1,0],"Ag-Br":[1,1,0],"Ag-I":[1,1,0],"Ag-Se":[1,1,0],"Ag-Te":[1,1,0],"Ag-N":[1,1,0],"Ag-P":[1,1,0],"Ag-As":[1,1,0],"Ag-H":[1,1,0],"Al-O":[1,1,0],"Al-S":[1,1,0],"Al-Se":[1,1,0],"Al-Te":[1,1,0],"Al-F":[1,1,0],"Al-Cl":[1,1,0],"Al-Br":[1,1,0],"Al-I":[1,1,0],"Al-N":[1,1,0],"Al-P":[1,1,0],"Al-As":[1,1,0],"Al-H":[1,1,0],"Am-O":[1,1,0],"Am-F":[1,1,0],"Am-Cl":[1,1,0],"Am-Br":[1,1,0],"As-S":[1,1,0],"As-Se":[1,1,0],"As-O":[1,1,0],"As-Te":[1,1,0],"As-F":[1,1,0],"As-Cl":[1,1,0],"As-Br":[1,1,0],"As-I":[1,1,0],"As-C":[1,1,0],"Au-Cl":[1,1,0],"Au-I":[1,1,0],"Au-O":[1,1,0],"Au-S":[1,1,0],"Au-F":[1,1,0],"Au-Br":[1,1,0],"Au-N":[1,1,0],"Au-Se":[1,1,0],"Au-Te":[1,1,0],"Au-P":[1,1,0],"Au-As":[1,1,0],"Au-H":[1,1,0],"B-O":[1,1,0],"B-S":[1,1,0],"B-Se":[1,1,0],"B-Te":[1,1,0],"B-F":[1,1,0],"B-Cl":[1,1,0],"B-Br":[1,1,0],"B-I":[1,1,0],"B-N":[1,1,0],"B-P":[1,1,0],"B-As":[1,1,0],"B-H":[1,1,0],"B-B":[1,1,0],"Ba-O":[1,1,0],"Ba-S":[1,1,0],"Ba-Se":[1,1,0],"Ba-Te":[1,1,0],"Ba-F":[1,1,0],"Ba-Cl":[1,1,0],"Ba-Br":[1,1,0],"Ba-I":[1,1,0],"Ba-N":[1,1,0],"Ba-P":[1,1,0],"Ba-As":[1,1,0],"Ba-H":[1,1,0],"Be-O":[1,1,0],"Be-S":[1,1,0],"Be-Se":[1,1,0],"Be-Te":[1,1,0],"Be-F":[1,1,0],"Be-Cl":[1,1,0],"Be-Br":[1,1,0],"Be-I":[1,1,0],"Be-N":[1,1,0],"Be-P":[1,1,0],"Be-As":[1,1,0],"Be-H":[1,1,0],"Bi-O":[1,1,0],"Bi-S":[1,1,0],"Bi-Se":[1,1,0],"Bi-F":[1,1,0],"Bi-Cl":[1,1,0],"Bi-Br":[1,1,0],"Bi-I":[1,1,0],"Bi-N":[1,1,0],"Bi-Te":[1,1,0],"Bi-P":[1,1,0],"Bi-As":[1,1,0],"Bi-H":[1,1,0],"Bk-O":[1,1,0],"Bk-F":[1,1,0],"Bk-Cl":[1,1,0],"Bk-Br":[1,1,0],"Br-O":[1,1,0],"Br-F":[1,1,0],"Br-Cl":[1,1,0],"C-Au":[1,1,0],"C-O":[2,1,0],"C-Cl":[2,1,0],"C-C":[2,0,0],"C-S":[2,0,0],"C-F":[2,1,0],"C-Br":[2,1,0],"C-N":[2,1,0],"C-Se":[2,1,0],"C-I":[2,1,0],"C-Te":[1,1,0],"C-P":[2,1,0],"C-Pt":[1,1,0],"C-H":[1,0,0],"Ca-O":[1,1,0],"Ca-S":[1,1,0],"Ca-Se":[1,1,0],"Ca-Te":[1,1,0],"Ca-F":[1,1,0],"Ca-Cl":[1,1,0],"Ca-Br":[1,1,0],"Ca-I":[1,1,0],"Ca-N":[1,1,0],"Ca-P":[1,1,0],"Ca-As":[1,1,0],"Ca-H":[1,1,0],"Cd-O":[1,1,0],"Cd-S":[1,1,0],"Cd-Se":[1,1,0],"Cd-Te":[1,1,0],"Cd-F":[1,1,0],"Cd-Cl":[1,1,0],"Cd-Br":[1,1,0],"Cd-I":[1,1,0],"Cd-N":[1,1,0],"Cd-P":[1,1,0],"Cd-As":[1,1,0],"Cd-H":[1,1,0],"Ce-O":[1,1,0],"Ce-S":[1,1,0],"Ce-F":[1,1,0],"Ce-Cl":[1,1,0],"Ce-Br":[1,1,0],"Ce-I":[1,1,0],"Ce-N":[1,1,0],"Ce-Se":[1,1,0],"Ce-Te":[1,1,0],"Ce-P":[1,1,0],"Ce-As":[1,1,0],"Ce-H":[1,1,0],"Cf-O":[1,1,0],"Cf-F":[1,1,0],"Cf-Cl":[1,1,0],"Cf-Br":[1,1,0],"Cl-H":[1,0,0],"Cl-O":[1,1,0],"Cl-F":[1,1,0],"Cl-Cl":[1,1,0],"Cm-O":[1,1,0],"Cm-F":[1,1,0],"Cm-Cl":[1,1,0],"Co-H":[1,1,0],"Co-O":[1,1,0],"Co-S":[1,1,0],"Co-F":[1,1,0],"Co-Cl":[1,1,0],"Co-N":[1,1,0],"Co-C":[1,1,0],"Co-Br":[1,1,0],"Co-I":[1,1,0],"Co-Se":[1,1,0],"Co-Te":[1,1,0],"Co-P":[1,1,0],"Co-As":[1,1,0],"Cr-O":[1,1,0],"Cr-F":[1,1,0],"Cr-Cl":[1,1,0],"Cr-Br":[1,1,0],"Cr-I":[1,1,0],"Cr-N":[1,1,0],"Cr-S":[1,1,0],"Cr-Se":[1,1,0],"Cr-Te":[1,1,0],"Cr-P":[1,1,0],"Cr-As":[1,1,0],"Cr-H":[1,1,0],"Cs-O":[1,1,0],"Cs-S":[1,1,0],"Cs-Se":[1,1,0],"Cs-Te":[1,1,0],"Cs-F":[1,1,0],"Cs-Cl":[1,1,0],"Cs-Br":[1,1,0],"Cs-I":[1,1,0],"Cs-N":[1,1,0],"Cs-P":[1,1,0],"Cs-As":[1,1,0],"Cs-H":[1,1,0],"Cu-O":[1,1,0],"Cu-S":[1,1,0],"Cu-Se":[1,1,0],"Cu-F":[1,1,0],"Cu-Cl":[1,1,0],"Cu-Br":[1,1,0],"Cu-I":[1,1,0],"Cu-N":[1,1,0],"Cu-P":[1,1,0],"Cu-As":[1,1,0],"Cu-C":[1,1,0],"Cu-Te":[1,1,0],"Cu-H":[1,1,0],"Dy-O":[1,1,0],"Dy-F":[1,1,0],"Dy-Cl":[1,1,0],"Dy-Br":[1,1,0],"Dy-I":[1,1,0],"Dy-S":[1,1,0],"Dy-Se":[1,1,0],"Dy-Te":[1,1,0],"Dy-N":[1,1,0],"Dy-P":[1,1,0],"Dy-As":[1,1,0],"Dy-H":[1,1,0],"Er-O":[1,1,0],"Er-S":[1,1,0],"Er-Se":[1,1,0],"Er-F":[1,1,0],"Er-Cl":[1,1,0],"Er-Br":[1,1,0],"Er-I":[1,1,0],"Er-Te":[1,1,0],"Er-N":[1,1,0],"Er-P":[1,1,0],"Er-As":[1,1,0],"Er-H":[1,1,0],"Es-O":[1,1,0],"Eu-O":[1,1,0],"Eu-S":[1,1,0],"Eu-F":[1,1,0],"Eu-Cl":[1,1,0],"Eu-Br":[1,1,0],"Eu-I":[1,1,0],"Eu-N":[1,1,0],"Eu-Se":[1,1,0],"Eu-Te":[1,1,0],"Eu-P":[1,1,0],"Eu-As":[1,1,0],"Eu-H":[1,1,0],"F-H":[1,0,0],"Fe-O":[1,1,0],"Fe-S":[1,1,0],"Fe-F":[1,1,0],"Fe-Cl":[1,1,0],"Fe-Br":[1,1,0],"Fe-I":[1,1,0],"Fe-N":[1,1,0],"Fe-C":[1,1,0],"Fe-Se":[1,1,0],"Fe-Te":[1,1,0],"Fe-P":[1,1,0],"Fe-As":[1,1,0],"Fe-H":[1,1,0],"Ga-Se":[1,1,0],"Ga-O":[1,1,0],"Ga-S":[1,1,0],"Ga-F":[1,1,0],"Ga-Cl":[1,1,0],"Ga-Br":[1,1,0],"Ga-I":[1,1,0],"Ga-Te":[1,1,0],"Ga-N":[1,1,0],"Ga-P":[1,1,0],"Ga-As":[1,1,0],"Ga-H":[1,1,0],"Gd-O":[1,1,0],"Gd-F":[1,1,0],"Gd-S":[1,1,0],"Gd-Cl":[1,1,0],"Gd-Br":[1,1,0],"Gd-I":[1,1,0],"Gd-Se":[1,1,0],"Gd-Te":[1,1,0],"Gd-N":[1,1,0],"Gd-P":[1,1,0],"Gd-As":[1,1,0],"Gd-H":[1,1,0],"Ge-O":[1,1,0],"Ge-S":[1,1,0],"Ge-Se":[1,1,0],"Ge-F":[1,1,0],"Ge-Cl":[1,1,0],"Ge-Br":[1,1,0],"Ge-I":[1,1,0],"Ge-Te":[1,1,0],"Ge-N":[1,1,0],"Ge-P":[1,1,0],"Ge-As":[1,1,0],"Ge-H":[1,1,0],"Ge-Ge":[1,1,0],"O-H":[1,0,0],"H-O":[0,0,1],"H-N":[0,0,1],"O-D":[1,0,0],"D-O":[0,0,0],"D-F":[1,0,0],"D-Cl":[1,0,0],"D-N":[1,0,0],"Hf-F":[1,1,0],"Hf-O":[1,1,0],"Hf-Cl":[1,1,0],"Hf-Br":[1,1,0],"Hf-S":[1,1,0],"Hf-Se":[1,1,0],"Hf-Te":[1,1,0],"Hf-I":[1,1,0],"Hf-N":[1,1,0],"Hf-P":[1,1,0],"Hf-As":[1,1,0],"Hf-H":[1,1,0],"Hg-O":[1,1,0],"Hg-F":[1,1,0],"Hg-Cl":[1,1,0],"Hg-S":[1,1,0],"Hg-Br":[1,1,0],"Hg-I":[1,1,0],"Hg-Se":[1,1,0],"Hg-Te":[1,1,0],"Hg-N":[1,1,0],"Hg-P":[1,1,0],"Hg-As":[1,1,0],"Hg-H":[1,1,0],"Hg-Hg":[1,1,0],"Ho-O":[1,1,0],"Ho-S":[1,1,0],"Ho-F":[1,1,0],"Ho-Cl":[1,1,0],"Ho-Br":[1,1,0],"Ho-I":[1,1,0],"Ho-Se":[1,1,0],"Ho-Te":[1,1,0],"Ho-N":[1,1,0],"Ho-P":[1,1,0],"Ho-As":[1,1,0],"Ho-H":[1,1,0],"I-I":[1,1,0],"I-F":[1,1,0],"I-Cl":[1,1,0],"I-O":[1,1,0],"In-Cl":[1,1,0],"In-O":[1,1,0],"In-S":[1,1,0],"In-F":[1,1,0],"In-Br":[1,1,0],"In-I":[1,1,0],"In-Co":[1,1,0],"In-Mn":[1,1,0],"In-Se":[1,1,0],"In-Te":[1,1,0],"In-N":[1,1,0],"In-P":[1,1,0],"In-As":[1,1,0],"In-H":[1,1,0],"Ir-O":[1,1,0],"Ir-F":[1,1,0],"Ir-Cl":[1,1,0],"Ir-S":[1,1,0],"Ir-Se":[1,1,0],"Ir-Te":[1,1,0],"Ir-Br":[1,1,0],"Ir-I":[1,1,0],"Ir-N":[1,1,0],"Ir-P":[1,1,0],"Ir-As":[1,1,0],"Ir-H":[1,1,0],"K-O":[1,1,0],"K-S":[1,1,0],"K-Se":[1,1,0],"K-Te":[1,1,0],"K-F":[1,1,0],"K-Cl":[1,1,0],"K-Br":[1,1,0],"K-I":[1,1,0],"K-N":[1,1,0],"K-P":[1,1,0],"K-As":[1,1,0],"K-H":[1,1,0],"Kr-F":[1,1,0],"La-O":[1,1,0],"La-S":[1,1,0],"La-Se":[1,1,0],"La-Te":[1,1,0],"La-F":[1,1,0],"La-Cl":[1,1,0],"La-Br":[1,1,0],"La-I":[1,1,0],"La-N":[1,1,0],"La-P":[1,1,0],"La-As":[1,1,0],"La-H":[1,1,0],"Li-O":[1,1,0],"Li-S":[1,1,0],"Li-Se":[1,1,0],"Li-Te":[1,1,0],"Li-F":[1,1,0],"Li-Cl":[1,1,0],"Li-Br":[1,1,0],"Li-I":[1,1,0],"Li-N":[1,1,0],"Lu-O":[1,1,0],"Lu-S":[1,1,0],"Lu-Se":[1,1,0],"Lu-Te":[1,1,0],"Lu-F":[1,1,0],"Lu-Cl":[1,1,0],"Lu-Br":[1,1,0],"Lu-I":[1,1,0],"Lu-N":[1,1,0],"Lu-P":[1,1,0],"Lu-As":[1,1,0],"Lu-H":[1,1,0],"Mg-O":[1,1,0],"Mg-S":[1,1,0],"Mg-Se":[1,1,0],"Mg-Te":[1,1,0],"Mg-F":[1,1,0],"Mg-Cl":[1,1,0],"Mg-Br":[1,1,0],"Mg-I":[1,1,0],"Mg-N":[1,1,0],"Mg-P":[1,1,0],"Mg-As":[1,1,0],"Mg-H":[1,1,0],"Mn-O":[1,1,0],"Mn-S":[1,1,0],"Mn-F":[1,1,0],"Mn-Cl":[1,1,0],"Mn-Br":[1,1,0],"Mn-I":[1,1,0],"Mn-N":[1,1,0],"Mn-Se":[1,1,0],"Mn-Te":[1,1,0],"Mn-P":[1,1,0],"Mn-As":[1,1,0],"Mn-H":[1,1,0],"Mo-S":[1,1,0],"Mo-Cl":[1,1,0],"Mo-O":[1,1,0],"Mo-F":[1,1,0],"Mo-Br":[1,1,0],"Mo-N":[1,1,0],"Mo-I":[1,1,0],"Mo-Se":[1,1,0],"Mo-Te":[1,1,0],"Mo-P":[1,1,0],"Mo-As":[1,1,0],"Mo-H":[1,1,0],"N-H":[1,0,0],"N-O":[1,1,0],"N-F":[1,1,0],"N-Cl":[1,1,0],"N-N":[1,1,0],"Na-O":[1,1,0],"Na-S":[1,1,0],"Na-Se":[1,1,0],"Na-Te":[1,1,0],"Na-F":[1,1,0],"Na-Cl":[1,1,0],"Na-Br":[1,1,0],"Na-I":[1,1,0],"Na-N":[1,1,0],"Na-P":[1,1,0],"Na-As":[1,1,0],"Na-H":[1,1,0],"Nb-O":[1,1,0],"Nb-F":[1,1,0],"Nb-Cl":[1,1,0],"Nb-Br":[1,1,0],"Nb-N":[1,1,0],"Nb-I":[1,1,0],"Nb-S":[1,1,0],"Nb-Se":[1,1,0],"Nb-Te":[1,1,0],"Nb-P":[1,1,0],"Nb-As":[1,1,0],"Nb-H":[1,1,0],"Nd-O":[1,1,0],"Nd-S":[1,1,0],"Nd-Se":[1,1,0],"Nd-Te":[1,1,0],"Nd-F":[1,1,0],"Nd-Cl":[1,1,0],"Nd-Br":[1,1,0],"Nd-I":[1,1,0],"Nd-N":[1,1,0],"NH-O":[1,1,0],"NH-F":[1,1,0],"NH-Cl":[1,1,0],"Ni-O":[1,1,0],"Ni-S":[1,1,0],"Ni-F":[1,1,0],"Ni-Cl":[1,1,0],"Ni-Br":[1,1,0],"Ni-I":[1,1,0],"Ni-N":[1,1,0],"Ni-Se":[1,1,0],"Ni-Te":[1,1,0],"Ni-P":[1,1,0],"Ni-As":[1,1,0],"Ni-H":[1,1,0],"Np-F":[1,1,0],"Np-Cl":[1,1,0],"Np-S":[1,1,0],"Np-Br":[1,1,0],"Np-I":[1,1,0],"Np-O":[1,1,0],"O-O":[1,0,0],"Os-O":[1,1,0],"Os-S":[1,1,0],"Os-F":[1,1,0],"Os-Cl":[1,1,0],"Os-Br":[1,1,0],"P-O":[1,1,0],"P-S":[1,1,0],"P-Se":[1,1,0],"P-F":[1,1,0],"P-Cl":[1,1,0],"P-Br":[1,1,0],"P-N":[1,1,0],"P-I":[1,1,0],"P-P":[1,1,0],"P-As":[1,1,0],"P-H":[1,1,0],"Pa-O":[1,1,0],"Pa-F":[1,1,0],"Pa-Cl":[1,1,0],"Pa-Br":[1,1,0],"Pb-O":[1,1,0],"Pb-S":[1,1,0],"Pb-Se":[1,1,0],"Pb-F":[1,1,0],"Pb-Cl":[1,1,0],"Pb-Br":[1,1,0],"Pb-I":[1,1,0],"Pb-N":[1,1,0],"Pb-Te":[1,1,0],"Pb-P":[1,1,0],"Pb-As":[1,1,0],"Pb-H":[1,1,0],"Pd-O":[1,1,0],"Pd-S":[1,1,0],"Pd-F":[1,1,0],"Pd-Cl":[1,1,0],"Pd-Br":[1,1,0],"Pd-I":[1,1,0],"Pd-N":[1,1,0],"Pd-C":[1,1,0],"Pd-Se":[1,1,0],"Pd-Te":[1,1,0],"Pd-P":[1,1,0],"Pd-As":[1,1,0],"Pd-H":[1,1,0],"Pm-F":[1,1,0],"Pm-Cl":[1,1,0],"Pm-Br":[1,1,0],"Po-O":[1,1,0],"Po-F":[1,1,0],"Pr-O":[1,1,0],"Pr-S":[1,1,0],"Pr-Se":[1,1,0],"Pr-Te":[1,1,0],"Pr-F":[1,1,0],"Pr-Cl":[1,1,0],"Pr-Br":[1,1,0],"Pr-I":[1,1,0],"Pr-N":[1,1,0],"Pr-P":[1,1,0],"Pr-As":[1,1,0],"Pr-H":[1,1,0],"Pt-O":[1,1,0],"Pt-S":[1,1,0],"Pt-F":[1,1,0],"Pt-Cl":[1,1,0],"Pt-Br":[1,1,0],"Pt-C":[1,1,0],"Pt-N":[1,1,0],"Pt-I":[1,1,0],"Pt-Se":[1,1,0],"Pt-Te":[1,1,0],"Pt-P":[1,1,0],"Pt-As":[1,1,0],"Pt-H":[1,1,0],"Pu-O":[1,1,0],"Pu-F":[1,1,0],"Pu-Cl":[1,1,0],"Pu-S":[1,1,0],"Pu-Br":[1,1,0],"Pu-I":[1,1,0],"Rb-O":[1,1,0],"Rb-S":[1,1,0],"Rb-Se":[1,1,0],"Rb-Te":[1,1,0],"Rb-F":[1,1,0],"Rb-Cl":[1,1,0],"Rb-Br":[1,1,0],"Rb-I":[1,1,0],"Rb-N":[1,1,0],"Rb-P":[1,1,0],"Rb-As":[1,1,0],"Rb-H":[1,1,0],"Re-Cl":[1,1,0],"Re-O":[1,1,0],"Re-F":[1,1,0],"Re-Br":[1,1,0],"Re-I":[1,1,0],"Re-S":[1,1,0],"Re-Se":[1,1,0],"Re-Te":[1,1,0],"Re-N":[1,1,0],"Re-P":[1,1,0],"Re-As":[1,1,0],"Re-H":[1,1,0],"Rh-O":[1,1,0],"Rh-F":[1,1,0],"Rh-Cl":[1,1,0],"Rh-Br":[1,1,0],"Rh-N":[1,1,0],"Rh-I":[1,1,0],"Rh-S":[1,1,0],"Rh-Se":[1,1,0],"Rh-Te":[1,1,0],"Rh-P":[1,1,0],"Rh-As":[1,1,0],"Rh-H":[1,1,0],"Ru-Se":[1,1,0],"Ru-F":[1,1,0],"Ru-O":[1,1,0],"Ru-S":[1,1,0],"Ru-Cl":[1,1,0],"Ru-N":[1,1,0],"Ru-Br":[1,1,0],"Ru-I":[1,1,0],"Ru-Te":[1,1,0],"Ru-P":[1,1,0],"Ru-As":[1,1,0],"Ru-H":[1,1,0],"S-O":[1,1,0],"S-S":[1,1,0],"S-N":[1,1,0],"S-F":[1,1,0],"S-Cl":[1,1,0],"S-Br":[1,1,0],"S-I":[1,1,0],"S-H":[1,1,0],"Sb-O":[1,1,0],"Sb-S":[1,1,0],"Sb-Se":[1,1,0],"Sb-F":[1,1,0],"Sb-Cl":[1,1,0],"Sb-Br":[1,1,0],"Sb-I":[1,1,0],"Sb-N":[1,1,0],"Sb-Te":[1,1,0],"Sb-P":[1,1,0],"Sb-As":[1,1,0],"Sb-H":[1,1,0],"Sc-O":[1,1,0],"Sc-S":[1,1,0],"Sc-Se":[1,1,0],"Sc-Te":[1,1,0],"Sc-F":[1,1,0],"Sc-Cl":[1,1,0],"Sc-Br":[1,1,0],"Sc-I":[1,1,0],"Sc-N":[1,1,0],"Sc-P":[1,1,0],"Sc-As":[1,1,0],"Sc-H":[1,1,0],"Se-S":[1,1,0],"Se-Se":[1,1,0],"Se-O":[1,1,0],"Se-F":[1,1,0],"Se-Cl":[1,1,0],"Se-Br":[1,1,0],"Se-N":[1,1,0],"Se-I":[1,1,0],"Se-H":[1,1,0],"Si-O":[1,1,0],"Si-S":[1,1,0],"Si-Se":[1,1,0],"Si-Te":[1,1,0],"Si-F":[1,1,0],"Si-Cl":[1,1,0],"Si-Br":[1,1,0],"Si-I":[1,1,0],"Si-C":[1,1,0],"Si-N":[1,1,0],"Si-P":[1,1,0],"Si-As":[1,1,0],"Si-H":[1,1,0],"Si-Si":[1,1,0],"Sm-O":[1,1,0],"Sm-N":[1,1,0],"Sm-S":[1,1,0],"Sm-Se":[1,1,0],"Sm-Te":[1,1,0],"Sm-F":[1,1,0],"Sm-Cl":[1,1,0],"Sm-Br":[1,1,0],"Sm-I":[1,1,0],"Sm-P":[1,1,0],"Sm-As":[1,1,0],"Sm-H":[1,1,0],"Sn-O":[1,1,0],"Sn-S":[1,1,0],"Sn-F":[1,1,0],"Sn-Cl":[1,1,0],"Sn-Br":[1,1,0],"Sn-I":[1,1,0],"Sn-N":[1,1,0],"Sn-Se":[1,1,0],"Sn-Te":[1,1,0],"Sn-P":[1,1,0],"Sn-As":[1,1,0],"Sn-H":[1,1,0],"Sr-O":[1,1,0],"Sr-S":[1,1,0],"Sr-Se":[1,1,0],"Sr-Te":[1,1,0],"Sr-F":[1,1,0],"Sr-Cl":[1,1,0],"Sr-Br":[1,1,0],"Sr-I":[1,1,0],"Sr-N":[1,1,0],"Sr-P":[1,1,0],"Sr-As":[1,1,0],"Sr-H":[1,1,0],"Ta-O":[1,1,0],"Ta-S":[1,1,0],"Ta-F":[1,1,0],"Ta-Cl":[1,1,0],"Ta-Br":[1,1,0],"Ta-I":[1,1,0],"Ta-Se":[1,1,0],"Ta-Te":[1,1,0],"Ta-N":[1,1,0],"Ta-P":[1,1,0],"Ta-As":[1,1,0],"Ta-H":[1,1,0],"Tb-O":[1,1,0],"Tb-S":[1,1,0],"Tb-Se":[1,1,0],"Tb-Te":[1,1,0],"Tb-F":[1,1,0],"Tb-Cl":[1,1,0],"Tb-Br":[1,1,0],"Tb-I":[1,1,0],"Tb-N":[1,1,0],"Tb-P":[1,1,0],"Tb-As":[1,1,0],"Tb-H":[1,1,0],"Tc-O":[1,1,0],"Tc-F":[1,1,0],"Tc-Cl":[1,1,0],"Te-O":[1,1,0],"Te-S":[1,1,0],"Te-F":[1,1,0],"Te-Cl":[1,1,0],"Te-Br":[1,1,0],"Te-I":[1,1,0],"Te-Se":[1,1,0],"Te-Te":[1,1,0],"Te-N":[1,1,0],"Te-P":[1,1,0],"Te-H":[1,1,0],"Th-O":[1,1,0],"Th-S":[1,1,0],"Th-Se":[1,1,0],"Th-Te":[1,1,0],"Th-F":[1,1,0],"Th-Cl":[1,1,0],"Th-Br":[1,1,0],"Th-I":[1,1,0],"Th-N":[1,1,0],"Th-P":[1,1,0],"Th-As":[1,1,0],"Th-H":[1,1,0],"Ti-F":[1,1,0],"Ti-Cl":[1,1,0],"Ti-Br":[1,1,0],"Ti-O":[1,1,0],"Ti-S":[1,1,0],"Ti-I":[1,1,0],"Ti-Se":[1,1,0],"Ti-Te":[1,1,0],"Ti-N":[1,1,0],"Ti-P":[1,1,0],"Ti-As":[1,1,0],"Ti-H":[1,1,0],"Tl-O":[1,1,0],"Tl-S":[1,1,0],"Tl-F":[1,1,0],"Tl-Cl":[1,1,0],"Tl-Br":[1,1,0],"Tl-I":[1,1,0],"Tl-Se":[1,1,0],"Tl-Te":[1,1,0],"Tl-N":[1,1,0],"Tl-P":[1,1,0],"Tl-As":[1,1,0],"Tl-H":[1,1,0],"Tm-O":[1,1,0],"Tm-S":[1,1,0],"Tm-Se":[1,1,0],"Tm-Te":[1,1,0],"Tm-F":[1,1,0],"Tm-Cl":[1,1,0],"Tm-Br":[1,1,0],"Tm-I":[1,1,0],"Tm-N":[1,1,0],"Tm-P":[1,1,0],"Tm-As":[1,1,0],"Tm-H":[1,1,0],"U-O":[1,1,0],"U-S":[1,1,0],"U-F":[1,1,0],"U-Cl":[1,1,0],"U-Br":[1,1,0],"U-I":[1,1,0],"U-N":[1,1,0],"U-Se":[1,1,0],"U-Te":[1,1,0],"U-P":[1,1,0],"U-As":[1,1,0],"U-H":[1,1,0],"V-O":[1,1,0],"V-Cl":[1,1,0],"V-S":[1,1,0],"V-F":[1,1,0],"V-Br":[1,1,0],"V-N":[1,1,0],"V-I":[1,1,0],"V-Se":[1,1,0],"V-Te":[1,1,0],"V-P":[1,1,0],"V-As":[1,1,0],"V-H":[1,1,0],"W-O":[1,1,0],"W-F":[1,1,0],"W-Cl":[1,1,0],"W-Br":[1,1,0],"W-I":[1,1,0],"W-S":[1,1,0],"W-Se":[1,1,0],"W-Te":[1,1,0],"W-N":[1,1,0],"W-P":[1,1,0],"W-As":[1,1,0],"W-H":[1,1,0],"Xe-O":[1,1,0],"Xe-F":[1,1,0],"Y-O":[1,1,0],"Y-S":[1,1,0],"Y-Se":[1,1,0],"Y-Te":[1,1,0],"Y-F":[1,1,0],"Y-Cl":[1,1,0],"Y-Br":[1,1,0],"Y-I":[1,1,0],"Y-N":[1,1,0],"Y-P":[1,1,0],"Y-As":[1,1,0],"Y-H":[1,1,0],"Yb-O":[1,1,0],"Yb-N":[1,1,0],"Yb-S":[1,1,0],"Yb-Se":[1,1,0],"Yb-Te":[1,1,0],"Yb-F":[1,1,0],"Yb-Cl":[1,1,0],"Yb-Br":[1,1,0],"Yb-I":[1,1,0],"Yb-P":[1,1,0],"Yb-As":[1,1,0],"Yb-H":[1,1,0],"Zn-O":[1,1,0],"Zn-S":[1,1,0],"Zn-Se":[1,1,0],"Zn-Te":[1,1,0],"Zn-F":[1,1,0],"Zn-Cl":[1,1,0],"Zn-Br":[1,1,0],"Zn-I":[1,1,0],"Zn-N":[1,1,0],"Zn-P":[1,1,0],"Zn-As":[1,1,0],"Zn-H":[1,1,0],"Zr-O":[1,1,0],"Zr-F":[1,1,0],"Zr-Cl":[1,1,0],"Zr-S":[1,1,0],"Zr-Se":[1,1,0],"Zr-Te":[1,1,0],"Zr-Br":[1,1,0],"Zr-I":[1,1,0],"Zr-N":[1,1,0],"Zr-P":[1,1,0],"Zr-As":[1,1,0],"Zr-H":[1,1,0]},W2={Covalent:s8,VDW:l8};class Vh extends Vo{constructor({weas:e,symbol:t="C",indices:r=null}){super(e),this.indices=r||Array.from(this.weas.avr.selectedAtomsIndices),this.symbol=t,this.initialAtoms=e.avr.atoms.copy()}execute(){this.weas.avr.replaceSelectedAtoms(this.symbol,this.indices)}undo(){console.log("undo replace"),this.weas.avr.atoms=this.initialAtoms.copy()}adjust(e){(e in Hh||e in this.weas.avr.atoms.species)&&(this.symbol=e,this.execute())}setupGUI(e){Wl(e,"Replace"),e.add(this,"symbol","H").name("Symbol").onChange(t=>{this.adjust(this.symbol)})}}Aa(Vh,"description","Replace atoms"),Aa(Vh,"category","Edit");class Gh extends Vo{constructor({weas:e,symbol:t="C",position:r={x:0,y:0,z:0}}){super(e),this.position=r,this.symbol=t,this.initialAtoms=e.avr.atoms.copy()}execute(){this.weas.avr.addAtom(this.symbol,this.position)}undo(){console.log("undo add atom"),this.weas.avr.atoms=this.initialAtoms.copy()}adjust(e,t){(e in Hh||e in this.weas.avr.atoms.species)&&(this.weas.avr.atoms=this.initialAtoms.copy(),this.symbol=e,this.position=t,this.execute())}setupGUI(e){Wl(e,"Add"),e.add(this,"symbol","C").name("Symbol").onChange(t=>{this.adjust(t,this.position)}),e.add(this.position,"x",-10,10).name("X-axis").onChange(t=>{this.adjust(this.symbol,{...this.position,x:t})}),e.add(this.position,"y",-10,10).name("Y-axis").onChange(t=>{this.adjust(this.symbol,{...this.position,y:t})}),e.add(this.position,"z",-10,10).name("Z-axis").onChange(t=>{this.adjust(this.symbol,{...this.position,z:t})})}}Aa(Gh,"description","Add atom"),Aa(Gh,"category","Edit");class Q0 extends Vo{constructor({weas:e,attribute:t="Symbol",color1:r="#ff0000",color2:a="#0000ff"}){super(e),this.attribute=t,this.color1=r,this.color2=a,this.previousAttribute=e.colorBy,this.previousColorRamp=e.colorRamp,this.attributeKeys=Object.keys(this.weas.avr.atoms.attributes.atom).concat(Object.keys(U0))}execute(){this.weas._colorRamp=[this.color1,this.color2],this.weas.colorBy=this.attribute,this.weas.drawModels()}undo(){console.log("undo color by attribute"),this.weas._colorRamp=this.previousColorRamp,this.weas.colorBy=this.previousAttribute,this.weas.drawModels()}adjust(){!(this.attribute in U0)&&!(this.attribute in this.weas.avr.atoms.attributes.atom)||this.execute()}setupGUI(e){Wl(e,"Color by attribute"),e.add({attribute:this.attribute},"attribute",this.attributeKeys).onChange(t=>{this.attribute=t,this.adjust()}),e.addColor(this,"color1").name("Color1").onChange(t=>{this.color1=t,this.adjust()}),e.addColor(this,"color2").name("Color2").onChange(t=>{this.color2=t,this.adjust()})}}Aa(Q0,"description","Color by attribute"),Aa(Q0,"category","Color");const d8=Object.freeze(Object.defineProperty({__proto__:null,AddAtomOperation:Gh,ColorByAttribute:Q0,ReplaceOperation:Vh},Symbol.toStringTag,{value:"Module"}));function h8(n,e){let t=new Sm,r=new st(.23184,.413,.879),a;const l=[];for(let x=0;x<n.length;x++)a=new st(...n[x]),t.set(a,r),t.intersectObject(e).length%2===1&&l.push(x);return l}class K0 extends Vo{constructor({weas:e}){super(e),this.previousSelectedAtomsIndices=[...e.avr.selectedAtomsIndices]}execute(){this.weas.avr.selectedAtomsIndices=[...Array(this.weas.avr.atoms.getAtomsCount()).keys()]}undo(){console.log("undo select all"),this.weas.avr.selectedAtomsIndices=this.previousSelectedAtomsIndices}}Aa(K0,"description","Select all"),Aa(K0,"category","Select");class $0 extends Vo{constructor({weas:e}){super(e),this.previousSelectedAtomsIndices=[...e.avr.selectedAtomsIndices]}execute(){this.weas.avr.selectedAtomsIndices=[...Array(this.weas.avr.atoms.getAtomsCount()).keys()].filter(e=>!this.previousSelectedAtomsIndices.includes(e))}undo(){console.log("undo invert selection"),this.weas.avr.selectedAtomsIndices=this.previousSelectedAtomsIndices}}Aa($0,"description","Invert selection"),Aa($0,"category","Select");class em extends Vo{constructor({weas:e}){super(e),this.previousSelectedAtomsIndices=[...e.avr.selectedAtomsIndices]}execute(){const e=[];console.time("inside selection");for(let t=0;t<this.weas.selectionManager.selectedObjects.length;t++){const r=this.weas.selectionManager.selectedObjects[t],a=h8(this.weas.avr.atoms.positions,r);e.push(...a)}console.timeEnd("inside selection"),this.weas.avr.selectedAtomsIndices=e}undo(){console.log("undo inside selection"),console.log("previousSelectedAtomsIndices: ",this.previousSelectedAtomsIndices),this.weas.avr.selectedAtomsIndices=this.previousSelectedAtomsIndices}}Aa(em,"description","Select inside"),Aa(em,"category","Select");const f8=Object.freeze(Object.defineProperty({__proto__:null,InsideSelection:em,InvertSelection:$0,SelectAll:K0},Symbol.toStringTag,{value:"Module"})),ph={object:W7,transform:P7,mesh:i8,atoms:d8,selection:f8};class p8{constructor(e){this.weas=e,this.operationSearchManager=new G7(e,ph),this.undoStack=[],this.redoStack=[],this.gui=new j2,this.gui.closed=!1,this.createGUIContainer(),this.generateOperator()}generateOperator(){for(const e in ph){this[e]={};for(const t in ph[e])this[e][t]=(r={})=>{r.weas=this.weas;const a=new ph[e][t](r);this.execute(a)}}}execute(e,t=!0){t&&e.execute(),this.undoStack.push(e),this.redoStack=[],this.updateAdjustLastOperationGUI(),this.weas.eventHandlers.dispatchAtomsUpdated()}undo(){if(console.log("undo"),console.log("undoStack: ",this.undoStack),this.undoStack.length>0){const e=this.undoStack.pop();e.undo(),this.redoStack.push(e),this.weas.eventHandlers.dispatchAtomsUpdated()}}redo(){if(console.log("redo"),console.log("redoStack: ",this.redoStack),this.redoStack.length>0){const e=this.redoStack.pop();e.redo(),this.undoStack.push(e),this.updateAdjustLastOperationGUI(),this.weas.eventHandlers.dispatchAtomsUpdated()}}createGUIContainer(){const e=document.createElement("div");Object.assign(e.style,{position:"absolute",bottom:"30px",left:"10px",display:"none"}),this.weas.tjs.containerElement.appendChild(e),e.appendChild(this.gui.domElement),this.preventEventPropagation(e),this.guiContainer=e,this.adjustLastOpFolder=this.gui.addFolder("Adjust Last Operation"),this.adjustLastOpFolder.open()}preventEventPropagation(e){const t=r=>r.stopPropagation();["click","keydown","keyup","keypress"].forEach(r=>{e.addEventListener(r,t,!1)})}hideGUI(){this.guiContainer.style.display="none"}updateAdjustLastOperationGUI(){if(this.undoStack.length>0){this.guiContainer.style.display="block";const e=this.undoStack[this.undoStack.length-1];for(;this.adjustLastOpFolder.__controllers.length>0;)this.adjustLastOpFolder.remove(this.adjustLastOpFolder.__controllers[0]);typeof e.setupGUI=="function"&&e.setupGUI(this.adjustLastOpFolder)}else this.guiContainer.style.display="none"}}let m8=class{constructor({type:n,shape:e,instances:t}){this.type=n,this.shape=e,this.instances=t}};class g8{constructor(e){this.viewer=e,this.scene=this.viewer.tjs.scene,this.settings=[],this.meshes=[]}fromSettings(e){this.settings=[],this.clearMeshes(),e.forEach(t=>{this.addSetting(t)})}addSetting({type:e,shape:t,instances:r}){const a=new m8({type:e,shape:t,instances:r});this.settings.push(a)}clearMeshes(){this.meshes.forEach(e=>{Po(this.scene,e)}),this.meshes=[]}drawMesh(){console.log("drawMesh"),this.clearMeshes(),this.settings.forEach(e=>{const t=this.getGeometry(e),r=e.materialType||"Standard",a=hl[r].clone();console.log("setting: ",e);const l=new Ul(t,a,e.instances.length);e.instances.forEach((x,_)=>{const O=new Ei,z=new st(...x.position);O.position.copy(z);const q=x.scale||[1,1,1];O.scale.set(...q);const oe=x.rotation||[0,0,0];O.rotation.set(...oe),O.updateMatrix(),l.setMatrixAt(_,O.matrix);const ue=x.color||"#bd0d87";l.setColorAt(_,new qn(ue))}),l.instanceMatrix.needsUpdate=!0,l.instanceColor.needsUpdate=!0,this.meshes.push(l),this.scene.add(l)}),this.viewer.tjs.render()}getGeometry(e){let t,r,a;switch(e.type){case"cube":r={width:1,height:1,depth:1},a={...r,...e.shape},t=new sl(a.width,a.height,a.depth);break;case"cylinder":r={radiusTop:1,radiusBottom:1,height:1,radialSegments:8,heightSegments:1,openEnded:!1},a={...r,...e.shape},t=new ll(a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.openEnded);break;case"icosahedron":r={radius:1,detail:0},a={...r,...e.shape},t=new Zh(a.radius,a.detail);break;case"cone":r={radius:1,height:1,radialSegments:8,heightSegments:1,openEnded:!1},a={...r,...e.shape},t=new qc(a.radius,a.height,a.radialSegments,a.heightSegments,a.openEnded);break;case"plane":r={width:1,height:1},a={...r,...e.shape},t=new Wc(a.width,a.height);break;case"sphere":r={radius:1,widthSegments:8,heightSegments:6,phiStart:0,phiLength:Math.PI*2,thetaStart:0,thetaLength:Math.PI},a={...r,...e.shape},t=new cl(a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength);break;case"torus":r={radius:1,tube:.4,radialSegments:8,tubularSegments:6,arc:Math.PI*2},a={...r,...e.shape},t=new Dl(a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc);break;default:console.error("Unknown setting type: ",type)}return t}}let v8=class{constructor({name:n,vertices:e,faces:t,color:r=[1,0,0,1],position:a=[0,0,0],materialType:l="Standard"}){this.name=n,this.vertices=e,this.faces=t,this.color=r,this.position=a,this.materialType=l}};class y8{constructor(e){this.viewer=e,this.scene=this.viewer.tjs.scene,this.settings=[],this.meshes=[]}fromSettings(e){this.settings=[],this.clearMeshes(),e.forEach(t=>{this.addSetting(t)})}addSetting({name:e,vertices:t,faces:r,color:a,position:l,materialType:x}){const _=new v8({name:e,vertices:t,faces:r,color:a,position:l,materialType:x});this.settings.push(_)}clearMeshes(){this.meshes.forEach(e=>{Po(this.scene,e)}),this.meshes=[]}drawMesh(){console.log("drawMesh"),this.clearMeshes(),this.settings.forEach(e=>{const t=e.materialType||"Standard",r=hl[t].clone();r.color.setRGB(e.color[0],e.color[1],e.color[2]),r.transparent=!0,r.opacity=e.color[3],r.side=co;const a=new di,l=new Float32Array(e.vertices);a.setAttribute("position",new Xi(l,3));const x=new Uint32Array(e.faces);a.setIndex(new Xi(x,1));const _=new Ci(a,r);_.position.set(e.position[0],e.position[1],e.position[2]),this.meshes.push(_),this.scene.add(_)}),this.viewer.tjs.render()}}class x8{constructor(e){this.viewer=e,this.cellMesh=null,this.cellVectors=null,this._showCell=e._showCell,this._showAxes=e._showAxes}get showCell(){return this._showCell}set showCell(e){this._showCell=e,this.cellMesh&&(this.cellMesh.visible=e),this.cellVectors&&(this.cellVectors.visible=e)}get showAxes(){return this._showAxes}set showAxes(e){this._showAxes=e,this.cellVectors&&(this.cellVectors.visible=e)}clear(){this.cellMesh&&(this.viewer.tjs.scene.remove(this.cellMesh),this.cellMesh.geometry.dispose(),this.cellMesh.material.dispose(),this.cellMesh=null),this.cellVectors&&(this.viewer.tjs.coordScene.remove(this.cellVectors),this.cellVectors=null)}draw(){this.clear(),this.viewer.originalCell.some(e=>e.every(t=>t===0))||(this.currentCell=this.viewer.originalCell.map(e=>e.slice()),this.cellMesh=this.drawUnitCell(),this.cellVectors=this.drawUnitCellVectors())}drawUnitCell(){const e=this.viewer.originalCell;if(!e||e.length!==3){console.warn("Invalid or missing unit cell data");return}const t=e,r=new jc({color:0}),a=[],l=new st(0,0,0),x=new st(...t[0]),_=new st(...t[1]),O=new st().addVectors(x,_),z=new st(...t[2]),q=new st().addVectors(x,z),oe=new st().addVectors(_,z),ue=new st().addVectors(O,z);a.push(l.clone(),x.clone(),x.clone(),O.clone(),O.clone(),_.clone(),_.clone(),l.clone()),a.push(z.clone(),q.clone(),q.clone(),ue.clone(),ue.clone(),oe.clone(),oe.clone(),z.clone()),a.push(l.clone(),z.clone(),x.clone(),q.clone(),_.clone(),oe.clone(),O.clone(),ue.clone());const _e=new di().setFromPoints(a),be=new zu(_e,r);return be.userData.type="cell",be.userData.uuid=this.viewer.uuid,be.userData.objectMode="edit",be.userData.notSelectable=!0,be.layers.set(1),this.viewer.tjs.scene.add(be),be.visible=this.showCell,be}drawUnitCellVectors(){const e=new st(0,0,0),t=this.viewer.originalCell;if(!t||t.length!==3){console.warn("Invalid or missing unit cell data for vectors");return}const r=new gs,a=3,l=.15,x=.8,_=.3,O=.3,z={a:16711680,b:65280,c:255},q=[new st(...t[0]).normalize(),new st(...t[1]).normalize(),new st(...t[2]).normalize()],oe=Th({position:e,direction:q[0],arrowLength:a,arrowRadius:l,coneHeight:x,coneRadius:_,color:z.a}),ue=Th({position:e,direction:q[1],arrowLength:a,arrowRadius:l,coneHeight:x,coneRadius:_,color:z.b}),_e=Th({position:e,direction:q[2],arrowLength:a,arrowRadius:l,coneHeight:x,coneRadius:_,color:z.c});r.add(oe),r.add(ue),r.add(_e);const be=a+.3,Pe=Dp(q[0].multiplyScalar(be),"a","black","80px"),Se=Dp(q[1].multiplyScalar(be),"b","black","80px"),Ee=Dp(q[2].multiplyScalar(be),"c","black","80px");r.add(Pe),r.add(Se),r.add(Ee);const Xe=new cl(O,16,16),qe=new Dh({color:"grey"}),$e=new Ci(Xe,qe);return r.add($e),this.viewer.tjs.coordScene.add(r),r.visible=this.showCell,r}updateCellMesh(e){if(!e||e.length!==3){console.warn("Invalid cell data for updating cell mesh");return}if(!this.cellMesh&&!this.currentCell)return;const t=1e-5;if(!e.every((r,a)=>r.every((l,x)=>Math.abs(l-this.currentCell[a][x])<t))){if(this.cellMesh){const r=e,a=new st(0,0,0),l=new st(...r[0]),x=new st(...r[1]),_=new st().addVectors(l,x),O=new st(...r[2]),z=new st().addVectors(l,O),q=new st().addVectors(x,O),oe=new st().addVectors(_,O),ue=[a.clone(),l.clone(),l.clone(),_.clone(),_.clone(),x.clone(),x.clone(),a.clone(),O.clone(),z.clone(),z.clone(),oe.clone(),oe.clone(),q.clone(),q.clone(),O.clone(),a.clone(),O.clone(),l.clone(),z.clone(),x.clone(),q.clone(),_.clone(),oe.clone()];this.cellMesh.geometry.setFromPoints(ue)}if(this.cellVectors){const r=[new st(...e[0]).normalize(),new st(...e[1]).normalize(),new st(...e[2]).normalize()],a=new st(0,1,0);for(let x=0;x<3;x++){const _=new Oi().setFromUnitVectors(a,r[x]);this.cellVectors.children[x].setRotationFromQuaternion(_)}const l=3.3;this.cellVectors.children[3].position.copy(r[0].multiplyScalar(l)),this.cellVectors.children[4].position.copy(r[1].multiplyScalar(l)),this.cellVectors.children[5].position.copy(r[2].multiplyScalar(l))}}}}function Dp(n,e,t,r){var a=document.createElement("canvas");a.width=120,a.height=120;var l=a.getContext("2d");l.font=r+" Arial",l.fillStyle=t,l.textAlign="center",l.fillText(e,a.width/2,a.height/2);var x=new _m(a),_=new Jh({map:x}),O=new xm(_);return O.position.copy(n),O.scale.set(1.5,1.5,1),O}function _8(n,e,t){let r=[],a;if(e==="Random")r=[],n.symbols.forEach((l,x)=>{a=new qn(Math.random()*16777215),r.push(a)});else if(e==="Uniform")r=[],n.symbols.forEach((l,x)=>{a=new qn(t.colorRamp[0]),r.push(a)});else if(e==="Index"){r=[];const l=n.symbols.map((x,_)=>_);return Ip(l,t.colorRamp)}else if(e in n.attributes.atom){const l=n.attributes.atom[e];if(l.length>0&&l[0].length){const x=l.map(_=>Math.sqrt(_.reduce((O,z)=>O+z**2,0)));return Ip(x,t.colorRamp)}return Ip(l,t.colorRamp)}return r}function Ip(n,e){const t=[],r=Math.min(...n),a=Math.max(...n)-r,l=e.length-1;return n.forEach(x=>{const _=(x-r)/a,O=Math.min(Math.floor(_*l),l-1),z=(_-O/l)*l,q=new qn(e[O]),oe=new qn(e[O+1]),ue=new qn(q.r,q.g,q.b).lerp(oe,z);t.push(ue)}),t}class py{constructor(e){if(!e)throw new Error("Element is required for Specie.");this.element=e}get element(){return this._element}set element(e){if(!Hh[e])throw new Error(`Element '${e}' is invalid.`);this._element=e}get number(){return Hh[this.element]}}class b8{constructor(e,t){this.symbol=e,this.position=[...t]}}class Ds{constructor({symbols:e=null,positions:t=null,cell:r=null,pbc:a=null,species:l=null,attributes:x=null}={}){if(this.uuid=null,this.symbols=e?[...e]:[],this.positions=t?[...t]:[],this.symbols.length!==this.positions.length)throw new Error("The length of symbols should be the same as positions.");if(this.setCell(r||[[0,0,0],[0,0,0],[0,0,0]]),this.setPBC(a||[!1,!1,!1]),this.isUndefinedCell()&&this.pbc.some(_=>_))throw new Error("Periodic boundary conditions (pbc) cannot be true when the cell dimensions are all zero.");this.setSpecies(l||{},this.symbols),this.setAttributes(x||{atom:{},specie:{}})}setSpecies(e,t=null){if(this.species={},typeof e!="object")throw new Error("Species should be a dictionary.");Object.entries(e).forEach(([r,a])=>{this.addSpecie(r,a)}),t&&new Set(t).forEach(r=>{this.species[r]||this.addSpecie(r)})}setAttributes(e){this.attributes={atom:{},specie:{},"inter-specie":{}};for(const t in e)for(const r in e[t])this.newAttribute(r,e[t][r],t)}newAttribute(e,t,r="atom"){if(r==="atom"){if(t.length!==this.positions.length)throw new Error("The number of values does not match the number of atoms.");this.attributes.atom[e]=JSON.parse(JSON.stringify(t))}else if(r==="specie"){for(const a of Object.keys(this.species))if(!(a in t))throw new Error(`Value for specie '${a}' is missing.`);this.attributes.specie[e]=JSON.parse(JSON.stringify(t))}else if(r==="inter-specie")this.attributes["inter-specie"][e]=JSON.parse(JSON.stringify(t));else throw new Error('Invalid domain. Must be either "atom", "specie", or "inter-specie".')}getAttribute(e,t="atom"){if(t==="atom"){if(e==="positions")return this.positions;if(e==="symbols")return this.symbols;if(e==="index")return Array.from({length:this.positions.length},(r,a)=>a);if(!this.attributes.atom[e])throw new Error(`Attribute '${e}' is not defined. The available attributes are: ${Object.keys(this.attributes.atom)}`);return this.attributes.atom[e]}else if(t==="specie"){if(!this.attributes.specie[e])throw new Error(`Attribute '${e}' is not defined. The available attributes are: ${Object.keys(this.attributes.specie)}`);return this.attributes.specie[e]}else if(t==="inter-specie"){if(!this.attributes[t][e])throw new Error(`Attribute '${e}' is not defined in inter-specie domain. The available attributes are: ${Object.keys(this.attributes[t])}`);return this.attributes[t][e]}else throw new Error('Invalid domain. Must be either "atom", "specie", or "inter-specie".')}setCell(e){if(e.length===9)this.cell=[[e[0],e[1],e[2]],[e[3],e[4],e[5]],[e[6],e[7],e[8]]];else if(e.length===6)this.cell=$v(e);else if(e.length===3)if(e[0].length===3)this.cell=e;else{const[t,r,a]=e;this.cell=$v([t,r,a,90,90,90])}else throw new Error("Invalid cell dimensions provided. Expected 3x3 matrix, 1x6, or 1x3 array.")}isUndefinedCell(){return this.cell.some(e=>e.every(t=>t===0))}getCellLengthsAndAngles(){const[e,t,r]=this.cell.map(_=>Math.sqrt(_[0]**2+_[1]**2+_[2]**2)),a=Math.acos((this.cell[1][0]*this.cell[2][0]+this.cell[1][1]*this.cell[2][1]+this.cell[1][2]*this.cell[2][2])/(t*r))*180/Math.PI,l=Math.acos((this.cell[0][0]*this.cell[2][0]+this.cell[0][1]*this.cell[2][1]+this.cell[0][2]*this.cell[2][2])/(e*r))*180/Math.PI,x=Math.acos((this.cell[0][0]*this.cell[1][0]+this.cell[0][1]*this.cell[1][1]+this.cell[0][2]*this.cell[1][2])/(e*t))*180/Math.PI;return[e,t,r,a,l,x]}setPBC(e){typeof e=="boolean"&&(e=[e,e,e]),this.pbc=e}addSpecie(e,t=null){if(this.species[e])throw new Error(`Specie '${e}' is already defined.`);t||(t=e),t instanceof py?this.species[e]=t:this.species[e]=new py(t)}getSymbols(){return this.symbols}getElements(){return this.symbols.map(e=>this.species[e].element)}addAtom(e){if(!this.species[e.symbol])throw new Error(`Specie '${e.symbol}' is not defined.`);this.positions.push(e.position),this.symbols.push(e.symbol)}removeAtom(e){this.positions.splice(e,1),this.symbols.splice(e,1);for(const t in this.attributes)for(const r in this.attributes.atom)this.attributes[t][r].splice(e,1)}getSpeciesCount(){return Object.keys(this.species).length}getAtomsCount(){return this.positions.length}add(e){for(const t in e.species)if(this.species[t]&&this.species[t].element!==e.species[t].element)throw new Error(`Specie '${t}' is defined in both Atoms objects with different elements.`);this.species={...this.species,...e.species},this.positions=[...this.positions,...e.positions],this.symbols=[...this.symbols,...e.symbols];for(const t in this.attributes.atom)this.attributes.atom[t]=[...this.attributes.atom[t],...e.attributes.atom[t]];for(const t in this.attributes.specie)this.attributes.specie[t]={...e.attributes.specie[t],...this.attributes.specie[t]}}multiply(e,t,r){if(this.isUndefinedCell())throw new Error("Cell matrix is not defined.");const a=new Ds;a.species={...this.species};const[[l,x,_],[O,z,q],[oe,ue,_e]]=this.cell;a.setCell([[l*e,x*e,_*e],[O*t,z*t,q*t],[oe*r,ue*r,_e*r]]);for(let be=0;be<e;be++)for(let Pe=0;Pe<t;Pe++)for(let Se=0;Se<r;Se++)for(let Ee=0;Ee<this.positions.length;Ee++){const[Xe,qe,$e]=this.positions[Ee],ft=Xe+be*this.cell[0][0]+Pe*this.cell[1][0]+Se*this.cell[2][0],gt=qe+be*this.cell[0][1]+Pe*this.cell[1][1]+Se*this.cell[2][1],pt=$e+be*this.cell[0][2]+Pe*this.cell[1][2]+Se*this.cell[2][2];a.symbols.push(this.symbols[Ee]),a.positions.push([ft,gt,pt])}for(const be in this.attributes.atom){const Pe=this.attributes.atom[be],Se=[];for(let Ee=0;Ee<e;Ee++)for(let Xe=0;Xe<t;Xe++)for(let qe=0;qe<r;qe++)for(let $e=0;$e<Pe.length;$e++)Se.push(Pe[$e]);a.newAttribute(be,Se,"atom")}for(const be in this.attributes.specie)a.newAttribute(be,JSON.parse(JSON.stringify(this.attributes.specie[be])),"specie");return a}translate(e){this.positions=this.positions.map(([t,r,a])=>[t+e[0],r+e[1],a+e[2]])}rotate(e,t,r=!1){const a=t*Math.PI/180,l=Math.sqrt(e[0]**2+e[1]**2+e[2]**2),[x,_,O]=[e[0]/l,e[1]/l,e[2]/l],z=Math.cos(a),q=Math.sin(a),oe=[z+x*x*(1-z),x*_*(1-z)-O*q,x*O*(1-z)+_*q,_*x*(1-z)+O*q,z+_*_*(1-z),_*O*(1-z)-x*q,O*x*(1-z)-_*q,O*_*(1-z)+x*q,z+O*O*(1-z)];for(let ue=0;ue<this.positions.length;ue++){const[_e,be,Pe]=this.positions[ue];this.positions[ue][0]=oe[0]*_e+oe[1]*be+oe[2]*Pe,this.positions[ue][1]=oe[3]*_e+oe[4]*be+oe[5]*Pe,this.positions[ue][2]=oe[6]*_e+oe[7]*be+oe[8]*Pe}if(r&&this.cell){const ue=Array(3).fill(0).map(()=>Array(3).fill(0));for(let _e=0;_e<3;_e++)for(let be=0;be<3;be++)ue[_e][be]=oe[0+be]*this.cell[_e][0]+oe[3+be]*this.cell[_e][1]+oe[6+be]*this.cell[_e][2];this.cell=ue}}center(e=0,t=[0,1,2],r=null){if(!this.cell)throw new Error("Cell is not defined.");let a=[0,0,0];for(let _=0;_<this.positions.length;_++)a[0]+=this.positions[_][0],a[1]+=this.positions[_][1],a[2]+=this.positions[_][2];a=a.map(_=>_/this.positions.length);let l=[0,0,0];if(r)l=r;else for(let _=0;_<3;_++)t.includes(_)&&(l[_]=(this.cell[0][_]+this.cell[1][_]+this.cell[2][_])/2);const x=l.map((_,O)=>_-a[O]);if(this.translate(x),e!==null)for(let _=0;_<3;_++)t.includes(_)&&(this.cell[_][_]+=2*e)}deleteAtoms(e){Array.isArray(e)||(e=[e]);const t=new Set(e);this.positions=this.positions.filter((a,l)=>!t.has(l)),this.symbols=this.symbols.filter((a,l)=>!t.has(l));for(const a in this.attributes)for(const l in this.attributes.atom)this.attributes[a][l]=this.attributes[a][l].filter((x,_)=>!t.has(_));const r=new Set(this.symbols);for(const a in this.species)if(!r.has(a)){delete this.species[a];for(const l in this.attributes.specie)delete this.attributes.specie[l][a]}}replaceAtoms(e,t,r=null){this.species[t]||this.addSpecie(t,r);for(const a of e)if(a>=0&&a<this.symbols.length)this.symbols[a]=t;else throw new Error("Index out of bounds.")}toDict(){const e={uuid:this.uuid,species:{},positions:[],cell:Array.from(this.cell||[]),pbc:Array.from(this.pbc),symbols:[]};for(const[t,r]of Object.entries(this.species))e.species[t]=r.element;return e.positions=this.positions.map(t=>[...t]),e.symbols=[...this.symbols],e}calculateFractionalCoordinates(){if(this.isUndefinedCell())throw new Error("Cell matrix is not defined.");let e=this.cell;e=e[0].map((r,a)=>e.map(l=>l[a]));const t=qS(e);return this.positions.map(r=>{const a=t[0][0]*r[0]+t[0][1]*r[1]+t[0][2]*r[2],l=t[1][0]*r[0]+t[1][1]*r[1]+t[1][2]*r[2],x=t[2][0]*r[0]+t[2][1]*r[1]+t[2][2]*r[2];return[a,l,x]})}getAtomsByIndices(e){const t={cell:JSON.parse(JSON.stringify(this.cell)),pbc:JSON.parse(JSON.stringify(this.pbc)),species:{},symbols:[],positions:[]},r={atom:{},specie:{}};for(const l in this.attributes)for(const x in this.attributes[l])r[l][x]=l==="atom"?[]:this.attributes[l][x];e.forEach(l=>{if(l<0||l>=this.positions.length)throw new Error("Index out of bounds.");t.symbols.push(this.symbols[l]),t.positions.push(this.positions[l]);for(const x in this.attributes.atom)r.atom[x].push(this.attributes.atom[x][l])}),new Set(t.symbols).forEach(l=>{t.species[l]=this.species[l].element});const a=new Ds(t);return a.attributes=r,a}getCenterOfGeometry(){const e=[0,0,0];for(let t=0;t<this.positions.length;t++)e[0]+=this.positions[t][0],e[1]+=this.positions[t][1],e[2]+=this.positions[t][2];return e[0]/=this.positions.length,e[1]/=this.positions.length,e[2]/=this.positions.length,e}copy(){const e=this.toDict(),t=new Ds(e),r={atom:{},specie:{},"inter-specie":{}};for(const a in this.attributes)for(const l in this.attributes[a])r[a][l]=JSON.parse(JSON.stringify(this.attributes[a][l]));return t.attributes=r,t}}let my=class{constructor({element:n,symbol:e,radius:t=2,color:r="#3d82ed"}){this.element=n,this.symbol=e,this.color=convertColor(r),this.radius=t}toDict(){return{element:this.element,symbol:this.symbol,color:this.color,radius:this.radius}}};class w8{constructor(e){this.viewer=e,this.scene=this.viewer.tjs.scene,this.settings={},this.meshes={},this.init()}init(){this.viewer.logger.debug("init atom settings"),this.settings={},Object.entries(this.viewer.originalAtoms.species).forEach(([e,t])=>{this.settings[e]=this.getDefaultSetting(e,t)})}getDefaultSetting(e,t){const r=Qh[this.viewer.colorType][t.element],a=W2[this.viewer.radiusType][t.element];return new my({element:t.element,symbol:e,radius:a,color:r})}fromSettings(e){this.settings={},this.clearMeshes(),Object.values(e).forEach(t=>{this.addSetting(t)})}addSetting({specie1:e,specie2:t,radius:r,min:a=0,max:l=3,color1:x="#3d82ed",color2:_="#3d82ed",order:O=1}){const z=new my({specie1:e,specie2:t,radius:r,min:a,max:l,color1:x,color2:_,order:O}),q=e+"-"+t;this.settings[q]=z}getBoundaryAtoms(){this.viewer.boundaryList=Y2(this.viewer.atoms,this.viewer._boundary),this.viewer.logger.debug("boundaryList: ",this.viewer.boundaryList),this.viewer.boundaryMap=T8(this.viewer.boundaryList),this.viewer.logger.debug("boundaryMap: ",this.viewer.boundaryMap)}}function M8(n,e){const t=new Ds;t.cell=n.cell,t.species=n.species;const r=e.map(a=>{const l=n.positions[a[0]],x=Bo(n.cell,[a[1][0],a[1][1],a[1][2]]);return l.map((_,O)=>_+x[O])});return t.positions=r,t.symbols=e.map(a=>n.symbols[a[0]]),t.uuid=n.uuid,t}function Y2(n,e=[[-.01,1.01],[-.01,1.01],[-.01,1.01]]){if(console.time("searchBoundary Time"),n.isUndefinedCell())return[];let t=n.positions,r=n.species;typeof e=="number"&&(e=[[-e,1+e],[-e,1+e],[-e,1+e]]),e=e.map(Pe=>Pe.map(Number));const a=e.map(Pe=>Math.floor(Pe[0])),l=e.map(Pe=>Math.ceil(Pe[1])),x=[a,l.map((Pe,Se)=>Pe)],_=x[0].reduce((Pe,Se,Ee)=>Pe*(x[1][Ee]-Se),1);t=n.calculateFractionalCoordinates();const O=t.length;let z=A8(t,_-1),q=0,oe=[],ue=[];for(let Pe=x[0][0];Pe<x[1][0];Pe++)for(let Se=x[0][1];Se<x[1][1];Se++)for(let Ee=x[0][2];Ee<x[1][2];Ee++){if(Pe===0&&Se===0&&Ee===0)continue;let Xe=q+O;for(let qe=q;qe<Xe;qe++)z[qe]=z[qe].map(($e,ft)=>$e+(ft===0?Pe:ft===1?Se:Ee)),oe.push([qe%O,[Pe,Se,Ee]]);ue=ue.concat(r),q=Xe}let _e=[];for(let Pe=0;Pe<z.length;Pe++)z[Pe][0]>e[0][0]&&z[Pe][0]<e[0][1]&&z[Pe][1]>e[1][0]&&z[Pe][1]<e[1][1]&&z[Pe][2]>e[2][0]&&z[Pe][2]<e[2][1]&&_e.push(Pe);let be=_e.map(Pe=>oe[Pe]);return console.timeEnd("searchBoundary Time"),be}function T8(n){const e={};return n.forEach((t,r)=>{const a=t[0],l=t[1];e[a]?e[a].push({index:r,offset:l}):e[a]=[{index:r,offset:l}]}),e}function A8(n,e){let t=[];for(let r=0;r<e;r++)for(let a=0;a<n.length;a++)t.push([...n[a]]);return t}function il(n){return Array.isArray(n)?n=new qn(...n):n=new qn(n),n}function gy({atoms:n,atomScales:e,settings:t,colors:r,materialType:a="Standard",data_type:l="atom"}){console.time("drawAtoms Time");let x=32,_=1;n.symbols.length>1e5?x=12:n.symbols.length>1e4?x=18:n.symbols.length>1e3?x=24:(n.symbols.length>100,x=32);const O=new cl(1,x,x),z=hl[a].clone(),q=new Ul(O,z,n.symbols.length);let oe=new st;const ue=new Oi;let _e=new st;const be=new jn;return n.symbols.forEach((Pe,Se)=>{oe=new st(...n.positions[Se]),Pe in t?_=t[Pe].radius:_=1,_e.set(_*e[Se],_*e[Se],_*e[Se]),be.compose(oe,ue,_e),q.setMatrixAt(Se,be),q.setColorAt(Se,r[Se])}),q.userData.type=l,q.userData.uuid=n.uuid,q.userData.objectMode="edit",q.instanceMatrix.needsUpdate=!0,q.instanceColor&&(q.instanceColor.needsUpdate=!0),console.timeEnd("drawAtoms Time"),q}let vy=class{constructor({element:n,symbol:e,radius:t=2,color:r="#3d82ed"}){this.element=n,this.symbol=e,this.color=il(r),this.radius=t}toDict(){return{element:this.element,symbol:this.symbol,color:this.color,radius:this.radius}}};class S8{constructor(e){this.viewer=e,this.scene=this.viewer.tjs.scene,this.settings={},this.meshes={},this.init()}init(){this.viewer.logger.debug("init atom settings"),this.settings={},Object.entries(this.viewer.originalAtoms.species).forEach(([e,t])=>{this.settings[e]=this.getDefaultSetting(e,t.element)}),this.updateAtomColors()}updateAtomColors(){const e=[];this.viewer.atoms.symbols.forEach((t,r)=>{const a=new qn(this.settings[t].color);e.push(a)}),this.viewer.atomColors=e,this.viewer.colorBy!=="Element"&&(this.viewer.atomColors=_8(this.viewer.atoms,this.viewer.colorBy,{colorType:this.viewer.colorType,colorRamp:this.viewer._colorRamp}))}getDefaultSetting(e,t){let r,a;return"color"in this.viewer.atoms.attributes.specie?r=this.viewer.atoms.attributes.specie.color[e]||"#3d82ed":r=Qh[this.viewer.colorType][t],"radii"in this.viewer.atoms.attributes.specie?a=this.viewer.atoms.attributes.specie.radii[e]||1:a=W2[this.viewer.radiusType][t]||1,new vy({element:t,symbol:e,radius:a,color:r})}fromSettings(e){this.settings={},this.clearMeshes(),Object.values(e).forEach(t=>{this.addSetting(t)})}addSetting({element:e,symbol:t,radius:r=2,color:a="#3d82ed"}){const l=new vy({element:e,symbol:t,radius:r,color:a});this.settings[t]=l}getMaxRadius(){return Math.max(...Object.values(this.settings).map(e=>e.radius))}getMinRadius(){return Math.min(...Object.values(this.settings).map(e=>e.radius))}clearMeshes(){Object.values(this.meshes).forEach(e=>{console.log("mesh: ",e),Po(this.scene,e)}),this.meshes={}}drawBalls(){this.updateAtomColors();const e=gy({scene:this.scene,atoms:this.viewer.atoms,atomScales:this.viewer.atomScales,settings:this.settings,colors:this.viewer.atomColors,materialType:this.viewer._materialType});if(this.scene.add(e),this.viewer.imageAtomsList=this.viewer.bondedAtoms.atoms.concat(this.viewer.boundaryList),this.viewer.imageAtomsList.length>0){const t=M8(this.viewer.atoms,this.viewer.imageAtomsList);let r=new Array(t.getAtomsCount()).fill(1);for(let x=0;x<t.getAtomsCount();x++)r[x]=this.viewer.atomScales[this.viewer.imageAtomsList[x][0]];const a=[];t.symbols.forEach((x,_)=>{const O=new qn(this.settings[x].color);a.push(O)});const l=gy({scene:this.scene,atoms:t,atomScales:r,settings:this.settings,colors:a,materialType:this.viewer._materialType,data_type:"image"});e.add(l),this.meshes.image=l}return this.meshes.atom=e,e}updateAtomMesh(e=null,t=null){var r=new jn;for(let a=0;a<t.positions.length;a++)this.meshes.atom.getMatrixAt(a,r),r.setPosition(new st(...t.positions[a])),this.meshes.atom.setMatrixAt(a,r),this.updateImageAtomsMesh(a);this.meshes.atom.instanceMatrix.needsUpdate=!0,this.meshes.image&&(this.meshes.image.instanceMatrix.needsUpdate=!0)}updateImageAtomsMesh(e){this.viewer.imageAtomsList.length>0&&this.viewer.boundaryMap[e]&&this.viewer.boundaryMap[e].forEach(t=>{const r=t.index,a=this.viewer.atoms.positions[e].map((x,_)=>x+Bo(this.viewer.atoms.cell,t.offset)[_]),l=new jn;this.meshes.image.getMatrixAt(r,l),l.setPosition(new st(...a)),this.meshes.image.setMatrixAt(r,l)})}updateAtomScale(e){e===void 0&&(e=this.viewer.atomScale);let t=this.meshes.atom;const r=this.viewer.selectedAtomsIndices.length>0?this.viewer.selectedAtomsIndices:[...Array(this.viewer.atoms.positions.length).keys()];if(this.updateMeshScale(t,r,this.viewer.atoms.symbols,e),t=this.meshes.image,t){const a=[],l=[];for(let x=0;x<this.viewer.imageAtomsList.length;x++)a.push(this.viewer.atoms.symbols[this.viewer.imageAtomsList[x][0]]),this.viewer.selectedAtomsIndices.includes(this.viewer.imageAtomsList[x][0])&&l.push(x);this.updateMeshScale(t,l,a,e)}this.viewer.tjs.render()}updateMeshScale(e,t,r,a){const l=new st,x=new Oi,_=new st;console.log("settings: ",this.settings),t.forEach(O=>{const z=new jn;console.log("symbols[i]: ",r[O]);const q=this.settings[r[O]].radius||1;e.getMatrixAt(O,z),z.decompose(l,x,_),_.set(q*a,q*a,q*a),z.compose(l,x,_),e.setMatrixAt(O,z)}),e.instanceMatrix.needsUpdate=!0}}class Lu{constructor(e,t,r){this.obj=e,this.left=null,this.right=null,this.parent=r,this.dimension=t}}class C8{constructor(e,t,r){var a=this;function l(_,O,z){var q=O%r.length,oe,ue;return _.length===0?null:_.length===1?new Lu(_[0],q,z):(_.sort(function(_e,be){return _e[r[q]]-be[r[q]]}),oe=Math.floor(_.length/2),ue=new Lu(_[oe],q,z),ue.left=l(_.slice(0,oe),O+1,ue),ue.right=l(_.slice(oe+1),O+1,ue),ue)}function x(_){a.root=_;function O(z){z.left&&(z.left.parent=z,O(z.left)),z.right&&(z.right.parent=z,O(z.right))}O(a.root)}Array.isArray(e)?this.root=l(e,0,null):x(e),this.toJSON=function(_){_||(_=this.root);var O=new Lu(_.obj,_.dimension,null);return _.left&&(O.left=a.toJSON(_.left)),_.right&&(O.right=a.toJSON(_.right)),O},this.insert=function(_){function O(ue,_e){if(ue===null)return _e;var be=r[ue.dimension];return _[be]<ue.obj[be]?O(ue.left,ue):O(ue.right,ue)}var z=O(this.root,null),q,oe;if(z===null){this.root=new Lu(_,0,null);return}q=new Lu(_,(z.dimension+1)%r.length,z),oe=r[z.dimension],_[oe]<z.obj[oe]?z.left=q:z.right=q},this.remove=function(_){var O;function z(oe){if(oe===null)return null;if(oe.obj===_)return oe;var ue=r[oe.dimension];return _[ue]<oe.obj[ue]?z(oe.left):z(oe.right)}function q(oe){var ue,_e,be;function Pe(Se,Ee){var Xe,qe,$e,ft,gt;return Se===null?null:(Xe=r[Ee],Se.dimension===Ee?Se.left!==null?Pe(Se.left,Ee):Se:(qe=Se.obj[Xe],$e=Pe(Se.left,Ee),ft=Pe(Se.right,Ee),gt=Se,$e!==null&&$e.obj[Xe]<qe&&(gt=$e),ft!==null&&ft.obj[Xe]<gt.obj[Xe]&&(gt=ft),gt))}if(oe.left===null&&oe.right===null){if(oe.parent===null){a.root=null;return}be=r[oe.parent.dimension],oe.obj[be]<oe.parent.obj[be]?oe.parent.left=null:oe.parent.right=null;return}oe.right!==null?(ue=Pe(oe.right,oe.dimension),_e=ue.obj,q(ue),oe.obj=_e):(ue=Pe(oe.left,oe.dimension),_e=ue.obj,q(ue),oe.right=oe.left,oe.left=null,oe.obj=_e)}O=z(a.root),O!==null&&q(O)},this.nearest=function(_,O,z){var q,oe,ue;ue=new E8(function(be){return-be[1]});function _e(be){var Pe,Se=r[be.dimension],Ee=t(_,be.obj),Xe={},qe,$e,ft;function gt(pt,Ht){ue.push([pt,Ht]),ue.size()>O&&ue.pop()}for(ft=0;ft<r.length;ft+=1)ft===be.dimension?Xe[r[ft]]=_[r[ft]]:Xe[r[ft]]=be.obj[r[ft]];if(qe=t(Xe,be.obj),be.right===null&&be.left===null){(ue.size()<O||Ee<ue.peek()[1])&&gt(be,Ee);return}be.right===null?Pe=be.left:be.left===null?Pe=be.right:_[Se]<be.obj[Se]?Pe=be.left:Pe=be.right,_e(Pe),(ue.size()<O||Ee<ue.peek()[1])&&gt(be,Ee),(ue.size()<O||Math.abs(qe)<ue.peek()[1])&&(Pe===be.left?$e=be.right:$e=be.left,$e!==null&&_e($e))}if(z)for(q=0;q<O;q+=1)ue.push([null,z]);for(a.root&&_e(a.root),oe=[],q=0;q<Math.min(O,ue.content.length);q+=1)ue.content[q][0]&&oe.push([ue.content[q][0].obj,ue.content[q][1]]);return oe},this.balanceFactor=function(){function _(z){return z===null?0:Math.max(_(z.left),_(z.right))+1}function O(z){return z===null?0:O(z.left)+O(z.right)+1}return _(a.root)/(Math.log(O(a.root))/Math.log(2))}}}class E8{constructor(e){this.content=[],this.scoreFunction=e}push(e){this.content.push(e),this.bubbleUp(this.content.length-1)}pop(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.sinkDown(0)),e}peek(){return this.content[0]}remove(e){for(var t=this.content.length,r=0;r<t;r++)if(this.content[r]==e){var a=this.content.pop();r!=t-1&&(this.content[r]=a,this.scoreFunction(a)<this.scoreFunction(e)?this.bubbleUp(r):this.sinkDown(r));return}throw new Error("Node not found.")}size(){return this.content.length}bubbleUp(e){for(var t=this.content[e];e>0;){var r=Math.floor((e+1)/2)-1,a=this.content[r];if(this.scoreFunction(t)<this.scoreFunction(a))this.content[r]=t,this.content[e]=a,e=r;else break}}sinkDown(e){for(var t=this.content.length,r=this.content[e],a=this.scoreFunction(r);;){var l=(e+1)*2,x=l-1,_=null;if(x<t){var O=this.content[x],z=this.scoreFunction(O);z<a&&(_=x)}if(l<t){var q=this.content[l],oe=this.scoreFunction(q);oe<(_==null?a:z)&&(_=l)}if(_!=null)this.content[e]=this.content[_],this.content[_]=r,e=_;else break}}}const L8=.1;let yy=class{constructor({specie1:n,specie2:e,min:t=0,max:r=3,color1:a="#3d82ed",color2:l="#3d82ed",radius:x=L8,order:_=1,type:O=0}){this.specie1=n,this.specie2=e,this.min=t,this.max=r,this.color1=il(a),this.color2=il(l),this.radius=x,this.order=_,this.type=O}toDict(){return{specie1:this.specie1,specie2:this.specie2,min:this.min,max:this.max,color1:this.color1,color2:this.color2,radius:this.radius,order:this.order,type:this.type}}};class R8{constructor(e,t=!0,r=!1){this.viewer=e,this.scene=this.viewer.tjs.scene,this.settings={},this.meshes={},this.hideLongBonds=t,this.showHydrogenBonds=r,this.showOutBoundaryBonds=!1,this.bondRadius=.1,this.init()}init(){this.viewer.logger.debug("init bond settings"),this.settings={},Object.entries(this.viewer.originalAtoms.species).forEach(([e,t])=>{Object.entries(this.viewer.originalAtoms.species).forEach(([r,a])=>{const l=t.element+"-"+a.element;if(fy[l]===void 0)return;const x=e+"-"+r;this.settings[x]=this.getDefaultSetting(e,t,r,a)})})}reset(){this.meshes={}}getDefaultSetting(e,t,r,a){let l=this.viewer.atomManager.settings[e].color,x=this.viewer.atomManager.settings[r].color;const _=this.viewer.atomManager.settings[e].radius,O=this.viewer.atomManager.settings[r].radius;let z=0,q=(_+O)*1.1;const oe=fy[t.element+"-"+a.element][2];return oe===1&&(z=q+.4,q=z+1,l="#808080",x="#808080"),new yy({specie1:e,specie2:r,min:z,max:q,color1:l,color2:x,type:oe})}fromSettings(e){this.settings={},this.clearMeshes(),Object.values(e).forEach(t=>{this.addSetting(t)})}addSetting({specie1:e,specie2:t,radius:r,min:a=0,max:l=3,color1:x="#3d82ed",color2:_="#3d82ed",order:O=1,type:z=0}){const q=new yy({specie1:e,specie2:t,radius:r,min:a,max:l,color1:x,color2:_,order:O,type:z}),oe=e+"-"+t;this.settings[oe]=q}buildBondDict(){const e={};Object.values(this.settings).forEach(t=>{const r=t.specie1,a=t.specie2,l=r+"-"+a;e[l]=t.toDict()}),this.viewer.logger.debug("cutoffDict: ",e),this.viewer.cutoffs=e}buildNeighborList(){this.buildBondDict(),this.viewer.neighbors=N8(this.viewer.originalAtoms,this.viewer.cutoffs),this.viewer.logger.debug("neighbors: ",this.viewer.neighbors)}clearMeshes(){Object.values(this.meshes).forEach(e=>{e&&Po(this.scene,e)}),this.meshes={}}drawBonds(){this.reset();const e=new gs,t=[];for(let z=0;z<this.viewer.modelSticks.length;z++)this.viewer.modelSticks[z]!==0&&t.push([z,[0,0,0]]);if(this.viewer.boundaryList.length>0)for(let z=0;z<this.viewer.boundaryList.length;z++)t.push(this.viewer.boundaryList[z]);this.bondList=P8(this.viewer.originalAtoms,t,this.viewer.neighbors.map,this.viewer._boundary,this.viewer.modelSticks,this.showOutBoundaryBonds),this.viewer.bondedAtoms.bonds.forEach(z=>{const q=this.viewer.originalAtoms.symbols[z[0]]+"-"+this.viewer.originalAtoms.symbols[z[1]];this.viewer.cutoffs[q]&&this.bondList.push(z)}),this.viewer.debug&&this.viewer.logger.debug("bondList: ",this.bondList),this.bondMap=O8(this.bondList,this.viewer.originalAtoms,this.settings,this.viewer.modelSticks);let r=null;this.viewer.colorBy!=="Element"&&(r=this.viewer.atomColors);const a=xy(this.viewer.originalAtoms,this.bondList,this.bondMap.sticks,this.viewer.cutoffs,this.bondRadius,this.viewer._materialType,r),{bondMesh:l,bondCap:x}=xy(this.viewer.originalAtoms,this.bondList,this.bondMap.stickCaps,this.viewer.cutoffs,this.bondRadius,this.viewer._materialType,r,!0);let _;this.showHydrogenBonds&&(_=_y(this.viewer.originalAtoms,this.bondList,this.bondMap.dashedLines,this.viewer.cutoffs,"dashed",r));const O=_y(this.viewer.originalAtoms,this.bondList,this.bondMap.solidLines,this.viewer.cutoffs,"solid",r);return this.meshes={stickBondMesh:a,stickCapBondMesh:l,stickCapBondCap:x,dashedBondLine:_,solidBondLine:O},Object.values(this.meshes).forEach(z=>{z&&e.add(z)}),e}updateBondMesh(e=null,t=null){this.updateBondStick(e,t,this.meshes.stickBondMesh,null,"sticks"),this.updateBondStick(e,t,this.meshes.stickCapBondMesh,this.meshes.stickCapBondCap,"stickCaps"),this.updateBondLine(e,t,this.meshes.dashedBondLine,"dashedLines"),this.updateBondLine(e,t,this.meshes.solidBondLine,"solidLines")}updateBondStick(e=null,t=null,r,a=null,l="sticks"){if(!r)return;t===null&&(t=this.viewer.originalAtoms);let x=[];if(e){const _=this.bondMap.bondMap[e];_&&_[l].forEach(O=>{x.push(O[0])})}else x=this.bondMap[l].map((_,O)=>O);x.forEach(_=>{const O=this.bondList[this.bondMap[l][_]],z=O[0],q=O[1],oe=O[2],ue=O[3];let _e=t.positions[z].map((pt,Ht)=>pt+Bo(t.cell,oe)[Ht]),be=t.positions[q].map((pt,Ht)=>pt+Bo(t.cell,ue)[Ht]);_e=new st(..._e),be=new st(...be);const Pe=new st().lerpVectors(_e,be,.25),Se=t.symbols[z]+"-"+t.symbols[q];if(!this.viewer.cutoffs[Se])return;const Ee=this.viewer.cutoffs[Se].max,Xe=Cm(_e,be),qe=q2(_e,be,this.bondRadius,Ee,this.hideLongBonds),$e=new jn().compose(Pe,Xe,qe);r.setMatrixAt(_*2,$e);const ft=new st().lerpVectors(_e,be,.75),gt=new jn().compose(ft,Xe,qe);if(r.setMatrixAt(_*2+1,gt),a){const pt=new st(this.bondRadius,this.bondRadius,this.bondRadius),Ht=new jn().compose(_e,new Oi,pt);a.setMatrixAt(_*2,Ht);const ur=new jn().compose(be,new Oi,pt);a.setMatrixAt(_*2+1,ur)}}),r.instanceMatrix.needsUpdate=!0,a&&(a.instanceMatrix.needsUpdate=!0)}updateBondLine(e=null,t=null,r,a="dashedLines"){if(!r)return;t===null&&(t=this.viewer.originalAtoms);let l=[];if(e){const O=this.bondMap.bondMap[e];O&&O[a].forEach(z=>{l.push(z[0])})}else l=this.bondMap[a].map((O,z)=>z);const x=r.geometry.attributes.position,_=x.array;l.forEach(O=>{const z=this.bondList[this.bondMap[a][O]],q=z[0],oe=z[1],ue=z[2],_e=z[3];let be=t.positions[q].map((Xe,qe)=>Xe+Bo(t.cell,ue)[qe]),Pe=t.positions[oe].map((Xe,qe)=>Xe+Bo(t.cell,_e)[qe]);const Se=t.symbols[q]+"-"+t.symbols[oe];if(!this.settings[Se])return;be=new st(...be),Pe=new st(...Pe);const Ee=be.distanceTo(Pe);Ee>this.settings[Se].max|Ee<this.settings[Se].min&&Pe.copy(be),_[O*6]=be.x,_[O*6+1]=be.y,_[O*6+2]=be.z,_[O*6+3]=Pe.x,_[O*6+4]=Pe.y,_[O*6+5]=Pe.z}),x.needsUpdate=!0,r.geometry.computeBoundingBox(),r.geometry.computeBoundingSphere()}}function xy(n,e,t,r,a=.1,l="standard",x=null,_=!1){console.time("drawBonds Time");const O=new ll(1,1,1,8,1),z=new cl(1,8,8),q=hl[l].clone(),oe=new Ul(O,q,t.length*2),ue=_?new Ul(z,q,t.length*2):null;for(let Pe=0;Pe<t.length;Pe++){const[Se,Ee,Xe,qe]=e[t[Pe]];var _e=n.positions[Se].map((Zt,Xt)=>Zt+Bo(n.cell,Xe)[Xt]);_e=new st(..._e);var be=n.positions[Ee].map((Zt,Xt)=>Zt+Bo(n.cell,qe)[Xt]);be=new st(...be);const $e=n.symbols[Se]+"-"+n.symbols[Ee],ft=x?x[Se]:r[$e].color1,gt=x?x[Ee]:r[$e].color2,pt=new st().lerpVectors(_e,be,.25),Ht=new st().lerpVectors(_e,be,.75),ur=Cm(_e,be),Ve=q2(_e,be,a),nt=new jn().compose(pt,ur,Ve);oe.setMatrixAt(Pe*2,nt),oe.setColorAt(Pe*2,ft);const nr=new jn().compose(Ht,ur,Ve);if(oe.setMatrixAt(Pe*2+1,nr),oe.setColorAt(Pe*2+1,gt),_){const Zt=new st(a,a,a),Xt=new jn().compose(_e,new Oi,Zt);ue.setMatrixAt(Pe*2,Xt),ue.setColorAt(Pe*2,ft);const Pr=new jn().compose(be,new Oi,Zt);ue.setMatrixAt(Pe*2+1,Pr),ue.setColorAt(Pe*2+1,gt)}}return oe.userData.type="bond",oe.userData.uuid=n.uuid,oe.userData.objectMode="edit",ue&&(ue.userData.type="bond",ue.userData.uuid=n.uuid,ue.userData.objectMode="edit"),console.timeEnd("drawBonds Time"),_?{bondMesh:oe,bondCap:ue}:oe}function _y(n,e,t,r,a="dashed",l=null){if(t===void 0||t.length===0)return null;console.time("draw lineBonds Time");const x=[],_=[];t.forEach(oe=>{const ue=e[oe],[_e,be,Pe,Se]=ue;var Ee=n.positions[_e].map((gt,pt)=>gt+Bo(n.cell,Pe)[pt]);Ee=new st(...Ee);var Xe=n.positions[be].map((gt,pt)=>gt+Bo(n.cell,Se)[pt]);Xe=new st(...Xe),x.push(Ee.x,Ee.y,Ee.z),x.push(Xe.x,Xe.y,Xe.z);const qe=n.symbols[_e]+"-"+n.symbols[be],$e=r[qe].color1,ft=r[qe].color2;_.push($e.r,$e.g,$e.b),_.push(ft.r,ft.g,ft.b)});const O=new di;O.setAttribute("position",new qa(x,3)),O.setAttribute("color",new qa(_,3));let z;a==="dashed"?z=new US({color:16777215,vertexColors:!0,dashSize:.1,gapSize:.1,linewidth:3}):z=new jc({color:16777215,vertexColors:!0,linewidth:3});const q=new zu(O,z);return q.computeLineDistances(),q.userData.type="bond",q.userData.uuid=n.uuid,q.userData.objectMode="edit",console.timeEnd("drawDashedBonds Time"),q}function q2(n,e,t,r=null,a=!0){const l=n.distanceTo(e);return a&&r!==null&&l>r&&(t=0),new st(t,l/2,t)}function k8(n,e,t,r){console.time("searchBondedAtoms Time");let a=[],l=[];return e.forEach(x=>{const _=x[0];if(r[_]===0||!Z0.includes(n[_]))return;const O=x[1],z=t.map[_];z!==void 0&&z.forEach(q=>{const oe=q[0],ue=q[1];if(r[oe]===0)return;const _e=[O[0]+ue[0],O[1]+ue[1],O[2]+ue[2]];if(_e[0]!=0||_e[1]!=0||_e[2]!=0){const be=[oe,_e];a.push(be),l.push([_,oe,O,_e]),l.push([oe,_,_e,O])}})}),console.timeEnd("searchBondedAtoms Time"),{atoms:a,bonds:l}}function P8(n,e,t,r,a,l=!1){console.time("buildBonds Time");const x=[];if(n.isUndefinedCell())for(let _=0;_<e.length;_++){const O=e[_][0],z=e[_][1],q=t[O];if(!(a[O]===0|q===void 0))for(let oe=0;oe<q.length;oe++){const ue=q[oe][0];if(a[ue]===0)continue;const _e=q[oe][1],be=z.map((Pe,Se)=>Pe+_e[Se]);x.push([O,ue,z,be])}}else{const _=n.calculateFractionalCoordinates();for(let O=0;O<e.length;O++){const z=e[O][0],q=e[O][1],oe=t[z];if(!(a[z]===0|oe===void 0))for(let ue=0;ue<oe.length;ue++){const _e=oe[ue][0];if(a[_e]===0)continue;const be=oe[ue][1],Pe=q.map((Ee,Xe)=>Ee+be[Xe]),Se=_[_e].map((Ee,Xe)=>Ee+Pe[Xe]);if(l){x.push([z,_e,q,Pe]);continue}else r[0][0]<=Se[0]&&Se[0]<=r[0][1]&&r[1][0]<=Se[1]&&Se[1]<=r[1][1]&&r[2][0]<=Se[2]&&Se[2]<=r[2][1]&&x.push([z,_e,q,Pe])}}}return console.timeEnd("buildBonds Time"),x}function O8(n,e,t,r){const a={},l={},x=[],_=[],O=[],z=[],q=[];for(let oe=0;oe<n.length;oe++){const ue=n[oe],[_e,be]=ue;a[_e]||(a[_e]={atomIndex:_e,sticks:[],stickCaps:[],dashedLines:[],solidLines:[],springs:[]}),a[be]||(a[be]={atomIndex:be,sticks:[],stickCaps:[],dashedLines:[],solidLines:[],springs:[]});const Pe=_e+"-"+ue[2].join("-");l[Pe]||(l[Pe]={atomIndex:_e,sticks:[],stickCaps:[],dashedLines:[],solidLines:[],springs:[]});const Se=be+"-"+ue[3].join("-");l[Se]||(l[Se]={atomIndex:be,sticks:[],stickCaps:[],dashedLines:[],solidLines:[],springs:[]});const Ee=e.symbols[_e]+"-"+e.symbols[be];let Xe;r[_e]<=2?Xe=t[Ee].type:Xe=r[_e],Xe===0?(x.push(oe),a[_e].sticks.push([x.length-1,!0]),a[be].sticks.push([x.length-1,!1]),l[Pe].sticks.push([x.length-1,!0]),l[Se].sticks.push([x.length-1,!1])):Xe===1?(O.push(oe),a[_e].dashedLines.push([O.length-1,!0]),a[be].dashedLines.push([O.length-1,!1]),l[Pe].dashedLines.push([O.length-1,!0]),l[Se].dashedLines.push([O.length-1,!1])):Xe===2?(q.push(oe),a[_e].springs.push([q.length-1,!0]),a[be].springs.push([q.length-1,!1]),l[Pe].springs.push([q.length-1,!0]),l[Se].springs.push([q.length-1,!1])):Xe===3?(_.push(oe),a[_e].stickCaps.push([_.length-1,!0]),a[be].stickCaps.push([_.length-1,!1]),l[Pe].stickCaps.push([_.length-1,!0]),l[Se].stickCaps.push([_.length-1,!1])):Xe===4&&(z.push(oe),a[_e].solidLines.push([z.length-1,!0]),a[be].solidLines.push([z.length-1,!1]),l[Pe].solidLines.push([z.length-1,!0]),l[Se].solidLines.push([z.length-1,!1]))}return{bondMap:a,bondMapWithOffset:l,sticks:x,stickCaps:_,dashedLines:O,solidLines:z,springs:q}}function N8(n,e,t=!1,r=!0){console.time("findNeighbors Time");let a=n.positions.map((_e,be)=>[be,[0,0,0]]),l;const x=Math.max(...Object.values(e).map(_e=>_e.max));if(r){const _e=n.getCellLengthsAndAngles(),be=[[-x/_e[0],1+x/_e[0]],[-x/_e[1],1+x/_e[1]],[-x/_e[2],1+x/_e[2]]];l=Y2(n,be)}a=a.concat(l);const _=[],O={};var z=function(_e,be){return Math.pow(_e.x-be.x,2)+Math.pow(_e.y-be.y,2)+Math.pow(_e.z-be.z,2)};const q=a.map(_e=>{const be=n.positions[_e[0]],Pe=Bo(n.cell,_e[1]);return[be[0]+Pe[0],be[1]+Pe[1],be[2]+Pe[2]]}),oe=q.map((_e,be)=>({x:_e[0],y:_e[1],z:_e[2],index:be})),ue=new C8(oe,z,["x","y","z"]);return a.forEach(([_e,be],Pe)=>{if(be[0]!=0||be[1]!=0||be[2]!=0)return;const Se=n.symbols[_e],Ee=q[Pe],Xe={x:q[Pe][0],y:q[Pe][1],z:q[Pe][2]};ue.nearest(Xe,24,x**2).forEach(qe=>{const $e=qe[0].index;if(Pe==$e)return;const ft=a[$e][0];if(!t&&_e==ft)return;const gt=Se+"-"+n.symbols[ft];if(!e[gt])return;const pt=q[$e],Ht=D8(Ee,pt);Ht<e[gt].max&&Ht>e[gt].min&&(_.push([_e,ft,a[$e][1]]),O[_e]?O[_e].push([ft,a[$e][1]]):O[_e]=[[ft,a[$e][1]]])})}),console.timeEnd("findNeighbors Time"),{list:_,map:O}}function D8(n,e){return Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)+Math.pow(n[2]-e[2],2))}const Ah=0,I8=1,z8=new st,by=new VS,zp=new fs,wy=new st,mh=new ko;class F8{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new My,this.unassigned=new My,this.vertices=[]}setFromPoints(e){if(e.length>=4){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.vertices.push(new U8(e[t]));this.compute()}return this}setFromObject(e){const t=[];return e.updateMatrixWorld(!0),e.traverse(function(r){const a=r.geometry;if(a!==void 0){const l=a.attributes.position;if(l!==void 0)for(let x=0,_=l.count;x<_;x++){const O=new st;O.fromBufferAttribute(l,x).applyMatrix4(r.matrixWorld),t.push(O)}}}),this.setFromPoints(t)}containsPoint(e){const t=this.faces;for(let r=0,a=t.length;r<a;r++)if(t[r].distanceToPoint(e)>this.tolerance)return!1;return!0}intersectRay(e,t){const r=this.faces;let a=-1/0,l=1/0;for(let x=0,_=r.length;x<_;x++){const O=r[x],z=O.distanceToPoint(e.origin),q=O.normal.dot(e.direction);if(z>0&&q>=0)return null;const oe=q!==0?-z/q:0;if(!(oe<=0)&&(q>0?l=Math.min(oe,l):a=Math.max(oe,a),a>l))return null}return a!==-1/0?e.at(a,t):e.at(l,t),t}intersectsRay(e){return this.intersectRay(e,z8)!==null}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(e,t){return e.face=t,t.outside===null?this.assigned.append(e):this.assigned.insertBefore(t.outside,e),t.outside=e,this}removeVertexFromFace(e,t){return e===t.outside&&(e.next!==null&&e.next.face===t?t.outside=e.next:t.outside=null),this.assigned.remove(e),this}removeAllVerticesFromFace(e){if(e.outside!==null){const t=e.outside;let r=e.outside;for(;r.next!==null&&r.next.face===e;)r=r.next;return this.assigned.removeSubList(t,r),t.prev=r.next=null,e.outside=null,t}}deleteFaceVertices(e,t){const r=this.removeAllVerticesFromFace(e);if(r!==void 0)if(t===void 0)this.unassigned.appendChain(r);else{let a=r;do{const l=a.next;t.distanceToPoint(a.point)>this.tolerance?this.addVertexToFace(a,t):this.unassigned.append(a),a=l}while(a!==null)}return this}resolveUnassignedPoints(e){if(this.unassigned.isEmpty()===!1){let t=this.unassigned.first();do{const r=t.next;let a=this.tolerance,l=null;for(let x=0;x<e.length;x++){const _=e[x];if(_.mark===Ah){const O=_.distanceToPoint(t.point);if(O>a&&(a=O,l=_),a>1e3*this.tolerance)break}}l!==null&&this.addVertexToFace(t,l),t=r}while(t!==null)}return this}computeExtremes(){const e=new st,t=new st,r=[],a=[];for(let l=0;l<3;l++)r[l]=a[l]=this.vertices[0];e.copy(this.vertices[0].point),t.copy(this.vertices[0].point);for(let l=0,x=this.vertices.length;l<x;l++){const _=this.vertices[l],O=_.point;for(let z=0;z<3;z++)O.getComponent(z)<e.getComponent(z)&&(e.setComponent(z,O.getComponent(z)),r[z]=_);for(let z=0;z<3;z++)O.getComponent(z)>t.getComponent(z)&&(t.setComponent(z,O.getComponent(z)),a[z]=_)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(e.x),Math.abs(t.x))+Math.max(Math.abs(e.y),Math.abs(t.y))+Math.max(Math.abs(e.z),Math.abs(t.z))),{min:r,max:a}}computeInitialHull(){const e=this.vertices,t=this.computeExtremes(),r=t.min,a=t.max;let l=0,x=0;for(let ue=0;ue<3;ue++){const _e=a[ue].point.getComponent(ue)-r[ue].point.getComponent(ue);_e>l&&(l=_e,x=ue)}const _=r[x],O=a[x];let z,q;l=0,by.set(_.point,O.point);for(let ue=0,_e=this.vertices.length;ue<_e;ue++){const be=e[ue];if(be!==_&&be!==O){by.closestPointToPoint(be.point,!0,wy);const Pe=wy.distanceToSquared(be.point);Pe>l&&(l=Pe,z=be)}}l=-1,zp.setFromCoplanarPoints(_.point,O.point,z.point);for(let ue=0,_e=this.vertices.length;ue<_e;ue++){const be=e[ue];if(be!==_&&be!==O&&be!==z){const Pe=Math.abs(zp.distanceToPoint(be.point));Pe>l&&(l=Pe,q=be)}}const oe=[];if(zp.distanceToPoint(q.point)<0){oe.push(Zo.create(_,O,z),Zo.create(q,O,_),Zo.create(q,z,O),Zo.create(q,_,z));for(let ue=0;ue<3;ue++){const _e=(ue+1)%3;oe[ue+1].getEdge(2).setTwin(oe[0].getEdge(_e)),oe[ue+1].getEdge(1).setTwin(oe[_e+1].getEdge(0))}}else{oe.push(Zo.create(_,z,O),Zo.create(q,_,O),Zo.create(q,O,z),Zo.create(q,z,_));for(let ue=0;ue<3;ue++){const _e=(ue+1)%3;oe[ue+1].getEdge(2).setTwin(oe[0].getEdge((3-ue)%3)),oe[ue+1].getEdge(0).setTwin(oe[_e+1].getEdge(1))}}for(let ue=0;ue<4;ue++)this.faces.push(oe[ue]);for(let ue=0,_e=e.length;ue<_e;ue++){const be=e[ue];if(be!==_&&be!==O&&be!==z&&be!==q){l=this.tolerance;let Pe=null;for(let Se=0;Se<4;Se++){const Ee=this.faces[Se].distanceToPoint(be.point);Ee>l&&(l=Ee,Pe=this.faces[Se])}Pe!==null&&this.addVertexToFace(be,Pe)}}return this}reindexFaces(){const e=[];for(let t=0;t<this.faces.length;t++){const r=this.faces[t];r.mark===Ah&&e.push(r)}return this.faces=e,this}nextVertexToAdd(){if(this.assigned.isEmpty()===!1){let e,t=0;const r=this.assigned.first().face;let a=r.outside;do{const l=r.distanceToPoint(a.point);l>t&&(t=l,e=a),a=a.next}while(a!==null&&a.face===r);return e}}computeHorizon(e,t,r,a){this.deleteFaceVertices(r),r.mark=I8;let l;t===null?l=t=r.getEdge(0):l=t.next;do{const x=l.twin,_=x.face;_.mark===Ah&&(_.distanceToPoint(e)>this.tolerance?this.computeHorizon(e,x,_,a):a.push(l)),l=l.next}while(l!==t);return this}addAdjoiningFace(e,t){const r=Zo.create(e,t.tail(),t.head());return this.faces.push(r),r.getEdge(-1).setTwin(t.twin),r.getEdge(0)}addNewFaces(e,t){this.newFaces=[];let r=null,a=null;for(let l=0;l<t.length;l++){const x=t[l],_=this.addAdjoiningFace(e,x);r===null?r=_:_.next.setTwin(a),this.newFaces.push(_.face),a=_}return r.next.setTwin(a),this}addVertexToHull(e){const t=[];return this.unassigned.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,t),this.addNewFaces(e,t),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let e;for(this.computeInitialHull();(e=this.nextVertexToAdd())!==void 0;)this.addVertexToHull(e);return this.reindexFaces(),this.cleanup(),this}}class Zo{constructor(){this.normal=new st,this.midpoint=new st,this.area=0,this.constant=0,this.outside=null,this.mark=Ah,this.edge=null}static create(e,t,r){const a=new Zo,l=new Fp(e,a),x=new Fp(t,a),_=new Fp(r,a);return l.next=_.prev=x,x.next=l.prev=_,_.next=x.prev=l,a.edge=l,a.compute()}getEdge(e){let t=this.edge;for(;e>0;)t=t.next,e--;for(;e<0;)t=t.prev,e++;return t}compute(){const e=this.edge.tail(),t=this.edge.head(),r=this.edge.next.head();return mh.set(e.point,t.point,r.point),mh.getNormal(this.normal),mh.getMidpoint(this.midpoint),this.area=mh.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(e){return this.normal.dot(e)-this.constant}}class Fp{constructor(e,t){this.vertex=e,this.prev=null,this.next=null,this.twin=null,this.face=t}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const e=this.head(),t=this.tail();return t!==null?t.point.distanceTo(e.point):-1}lengthSquared(){const e=this.head(),t=this.tail();return t!==null?t.point.distanceToSquared(e.point):-1}setTwin(e){return this.twin=e,e.twin=this,this}}class U8{constructor(e){this.point=e,this.prev=null,this.next=null,this.face=null}}class My{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(e,t){return t.prev=e.prev,t.next=e,t.prev===null?this.head=t:t.prev.next=t,e.prev=t,this}insertAfter(e,t){return t.prev=e,t.next=e.next,t.next===null?this.tail=t:t.next.prev=t,e.next=t,this}append(e){return this.head===null?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this}appendChain(e){for(this.head===null?this.head=e:this.tail.next=e,e.prev=this.tail;e.next!==null;)e=e.next;return this.tail=e,this}remove(e){return e.prev===null?this.head=e.next:e.prev.next=e.next,e.next===null?this.tail=e.prev:e.next.prev=e.prev,this}removeSubList(e,t){return e.prev===null?this.head=t.next:e.prev.next=t.next,t.next===null?this.tail=e.prev:t.next.prev=e.prev,this}isEmpty(){return this.head===null}}class B8 extends di{constructor(e=[]){super();const t=[],r=[],a=new F8().setFromPoints(e).faces;for(let l=0;l<a.length;l++){const x=a[l];let _=x.edge;do{const O=_.head().point;t.push(O.x,O.y,O.z),r.push(x.normal.x,x.normal.y,x.normal.z),_=_.next}while(_!==x.edge)}this.setAttribute("position",new qa(t,3)),this.setAttribute("normal",new qa(r,3))}}const H8=16777215;let Ty=class{constructor({symbol:n,color:e="#3d82ed",show_edge:t=!1}){this.symbol=n,this.color=il(e),this.show_edge=t}toDict(){return{symbol:this.symbol,color:this.color,show_edge:this.show_edge}}};class V8{constructor(e){this.viewer=e,this.scene=this.viewer.tjs.scene,this.settings=[],this.meshes=new gs,this.init()}init(){this.viewer.logger.debug("init PolyhedraManager"),this.settings=[],this.viewer.atoms,Object.entries(this.viewer.originalAtoms.species).forEach(([e,t])=>{if(!Z0.includes(t.element))return;const r=Qh[this.viewer.colorType][t.element],a=new Ty({symbol:e,color:r});this.settings.push(a)})}fromSettings(e){this.settings=[],this.clearMeshes(),e.forEach(t=>{this.addSetting(t)})}addSetting({symbol:e,color:t="#3d82ed",show_edge:r=!1}){const a=new Ty({symbol:e,color:t,show_edge:r});this.settings.push(a)}buildPolyhedraDict(){const e={};return this.settings.forEach(t=>{e[t.symbol]=t.toDict()}),e}clearMeshes(){Po(this.scene,this.meshes)}drawPolyhedras(){this.clearMeshes();const e=j8(this.viewer.bondManager.bondMap.bondMapWithOffset,this.viewer.atoms.symbols,Z0,this.viewer.modelPolyhedras);return this.viewer.logger.debug("polyhedras: ",e),G8(this.viewer.atoms,e,this.viewer.bondManager.bondList,this.viewer._colorType,this.viewer._materialType).forEach(t=>{this.meshes.add(t)}),this.meshes}updatePolyhedraMesh(e=null,t=null){}}function G8(n,e,t,r="CPK",a="standard"){const l=[];for(const O of Object.keys(e)){const z=e[O],q=[];let oe;for(const Ee of z.sticks){const Xe=t[Ee[0]];if(Ee[1])var x=n.positions[Xe[1]],_=Xe[3];else var x=n.positions[Xe[0]],_=Xe[2];oe=x.map(($e,ft)=>$e+Bo(n.cell,_)[ft]);const qe=new st(...oe);q.push(qe)}if(q.length<4){console.warn(`Skipping polyhedron with key "${O}" due to insufficient vertices.`);continue}let ue;try{ue=new B8(q)}catch(Ee){console.warn(`Skipping polyhedron with key "${O}" due to ConvexGeometry error:`,Ee);continue}const _e=n.symbols[z.atomIndex],be=Qh[r][_e]||H8,Pe=hl[a].clone();Pe.color=new qn(be),Pe.transparent=!0,Pe.opacity=.8;const Se=new Ci(ue,Pe);Se.userData.type="polyhedra",Se.userData.symbol=_e,Se.userData.uuid=n.uuid,Se.userData.objectMode="edit",Se.userData.notSelectable=!0,Se.layers.set(1),l.push(Se)}return l}function j8(n,e,t,r){const a={};return Object.keys(n).forEach(l=>{const x=n[l].atomIndex,_=n[l].sticks.length,O=e[x];r[x]&&_>=4&&t.includes(O)&&(a[l]=n[l])}),a}let W8=class{constructor({origins:n=[],texts:e=[],color:t="#3d82ed",fontSize:r=.05,shift:a=!1}){this.origins=n,this.texts=e,this.color=t,this.fontSize=r,this.shift=a}};class Y8{constructor(e){this.viewer=e,this.scene=this.viewer.tjs.scene,this.settings=[],this.labels=[]}fromSettings(e){this.settings=[],Ay(this.scene,this.labels),e.forEach(t=>{this.addSetting(t)})}addSetting({origins:e,texts:t,color:r="#3d82ed",fontSize:a=.05,shift:l=[0,0,0]}){if(typeof e=="string"&&!this.viewer.atoms.getAttribute(e))throw new Error(`Attribute '${e}' is not defined. The available attributes are: ${Object.keys(this.viewer.atoms.attributes.atom)}`);const x=new W8({origins:e,texts:t,color:r,fontSize:a,shift:l});this.settings.push(x)}clearLabels(){Ay(this.scene,this.labels)}drawAtomLabels(){console.log("drawAtomLabels:"),this.clearLabels(),this.settings.forEach(e=>{if(e.origins.length>1e3){console.warn("Too many labels, skipping...");return}let t,r;const a=e.selection||[...Array(this.viewer.atoms.getAtomsCount()).keys()];typeof e.origins=="string"?(t=this.viewer.atoms.getAttribute(e.origins),t=a.map(l=>t[l])):t=e.origins,typeof e.texts=="string"?(r=this.viewer.atoms.getAttribute(e.texts),r=a.map(l=>r[l])):r=e.texts,this.labels=q8(t,r,e.fontSize,e.color);for(let l=0;l<this.labels.length;l++)this.scene.add(this.labels[l])}),this.viewer.tjs.render()}updateLabel(e=null,t=null){}}function Ay(n,e){e.forEach(t=>{n.remove(t),t.remove()})}function q8(n,e,t,r){const a=[];for(let l=0;l<n.length;l++){const x=new st(...n[l]),_=Ou(x,e[l],"black");a.push(_)}return a}var J8=new Uint32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]);const X8=[[],[0,8,3],[0,1,9],[1,8,3,9,8,1],[1,2,10],[0,8,3,1,2,10],[9,2,10,0,2,9],[2,8,3,2,10,8,10,9,8],[3,11,2],[0,11,2,8,11,0],[1,9,0,2,3,11],[1,11,2,1,9,11,9,8,11],[3,10,1,11,10,3],[0,10,1,0,8,10,8,11,10],[3,9,0,3,11,9,11,10,9],[9,8,10,10,8,11],[4,7,8],[4,3,0,7,3,4],[0,1,9,8,4,7],[4,1,9,4,7,1,7,3,1],[1,2,10,8,4,7],[3,4,7,3,0,4,1,2,10],[9,2,10,9,0,2,8,4,7],[2,10,9,2,9,7,2,7,3,7,9,4],[8,4,7,3,11,2],[11,4,7,11,2,4,2,0,4],[9,0,1,8,4,7,2,3,11],[4,7,11,9,4,11,9,11,2,9,2,1],[3,10,1,3,11,10,7,8,4],[1,11,10,1,4,11,1,0,4,7,11,4],[4,7,8,9,0,11,9,11,10,11,0,3],[4,7,11,4,11,9,9,11,10],[9,5,4],[9,5,4,0,8,3],[0,5,4,1,5,0],[8,5,4,8,3,5,3,1,5],[1,2,10,9,5,4],[3,0,8,1,2,10,4,9,5],[5,2,10,5,4,2,4,0,2],[2,10,5,3,2,5,3,5,4,3,4,8],[9,5,4,2,3,11],[0,11,2,0,8,11,4,9,5],[0,5,4,0,1,5,2,3,11],[2,1,5,2,5,8,2,8,11,4,8,5],[10,3,11,10,1,3,9,5,4],[4,9,5,0,8,1,8,10,1,8,11,10],[5,4,0,5,0,11,5,11,10,11,0,3],[5,4,8,5,8,10,10,8,11],[9,7,8,5,7,9],[9,3,0,9,5,3,5,7,3],[0,7,8,0,1,7,1,5,7],[1,5,3,3,5,7],[9,7,8,9,5,7,10,1,2],[10,1,2,9,5,0,5,3,0,5,7,3],[8,0,2,8,2,5,8,5,7,10,5,2],[2,10,5,2,5,3,3,5,7],[7,9,5,7,8,9,3,11,2],[9,5,7,9,7,2,9,2,0,2,7,11],[2,3,11,0,1,8,1,7,8,1,5,7],[11,2,1,11,1,7,7,1,5],[9,5,8,8,5,7,10,1,3,10,3,11],[5,7,0,5,0,9,7,11,0,1,0,10,11,10,0],[11,10,0,11,0,3,10,5,0,8,0,7,5,7,0],[11,10,5,7,11,5],[10,6,5],[0,8,3,5,10,6],[9,0,1,5,10,6],[1,8,3,1,9,8,5,10,6],[1,6,5,2,6,1],[1,6,5,1,2,6,3,0,8],[9,6,5,9,0,6,0,2,6],[5,9,8,5,8,2,5,2,6,3,2,8],[2,3,11,10,6,5],[11,0,8,11,2,0,10,6,5],[0,1,9,2,3,11,5,10,6],[5,10,6,1,9,2,9,11,2,9,8,11],[6,3,11,6,5,3,5,1,3],[0,8,11,0,11,5,0,5,1,5,11,6],[3,11,6,0,3,6,0,6,5,0,5,9],[6,5,9,6,9,11,11,9,8],[5,10,6,4,7,8],[4,3,0,4,7,3,6,5,10],[1,9,0,5,10,6,8,4,7],[10,6,5,1,9,7,1,7,3,7,9,4],[6,1,2,6,5,1,4,7,8],[1,2,5,5,2,6,3,0,4,3,4,7],[8,4,7,9,0,5,0,6,5,0,2,6],[7,3,9,7,9,4,3,2,9,5,9,6,2,6,9],[3,11,2,7,8,4,10,6,5],[5,10,6,4,7,2,4,2,0,2,7,11],[0,1,9,4,7,8,2,3,11,5,10,6],[9,2,1,9,11,2,9,4,11,7,11,4,5,10,6],[8,4,7,3,11,5,3,5,1,5,11,6],[5,1,11,5,11,6,1,0,11,7,11,4,0,4,11],[0,5,9,0,6,5,0,3,6,11,6,3,8,4,7],[6,5,9,6,9,11,4,7,9,7,11,9],[10,4,9,6,4,10],[4,10,6,4,9,10,0,8,3],[10,0,1,10,6,0,6,4,0],[8,3,1,8,1,6,8,6,4,6,1,10],[1,4,9,1,2,4,2,6,4],[3,0,8,1,2,9,2,4,9,2,6,4],[0,2,4,4,2,6],[8,3,2,8,2,4,4,2,6],[10,4,9,10,6,4,11,2,3],[0,8,2,2,8,11,4,9,10,4,10,6],[3,11,2,0,1,6,0,6,4,6,1,10],[6,4,1,6,1,10,4,8,1,2,1,11,8,11,1],[9,6,4,9,3,6,9,1,3,11,6,3],[8,11,1,8,1,0,11,6,1,9,1,4,6,4,1],[3,11,6,3,6,0,0,6,4],[6,4,8,11,6,8],[7,10,6,7,8,10,8,9,10],[0,7,3,0,10,7,0,9,10,6,7,10],[10,6,7,1,10,7,1,7,8,1,8,0],[10,6,7,10,7,1,1,7,3],[1,2,6,1,6,8,1,8,9,8,6,7],[2,6,9,2,9,1,6,7,9,0,9,3,7,3,9],[7,8,0,7,0,6,6,0,2],[7,3,2,6,7,2],[2,3,11,10,6,8,10,8,9,8,6,7],[2,0,7,2,7,11,0,9,7,6,7,10,9,10,7],[1,8,0,1,7,8,1,10,7,6,7,10,2,3,11],[11,2,1,11,1,7,10,6,1,6,7,1],[8,9,6,8,6,7,9,1,6,11,6,3,1,3,6],[0,9,1,11,6,7],[7,8,0,7,0,6,3,11,0,11,6,0],[7,11,6],[7,6,11],[3,0,8,11,7,6],[0,1,9,11,7,6],[8,1,9,8,3,1,11,7,6],[10,1,2,6,11,7],[1,2,10,3,0,8,6,11,7],[2,9,0,2,10,9,6,11,7],[6,11,7,2,10,3,10,8,3,10,9,8],[7,2,3,6,2,7],[7,0,8,7,6,0,6,2,0],[2,7,6,2,3,7,0,1,9],[1,6,2,1,8,6,1,9,8,8,7,6],[10,7,6,10,1,7,1,3,7],[10,7,6,1,7,10,1,8,7,1,0,8],[0,3,7,0,7,10,0,10,9,6,10,7],[7,6,10,7,10,8,8,10,9],[6,8,4,11,8,6],[3,6,11,3,0,6,0,4,6],[8,6,11,8,4,6,9,0,1],[9,4,6,9,6,3,9,3,1,11,3,6],[6,8,4,6,11,8,2,10,1],[1,2,10,3,0,11,0,6,11,0,4,6],[4,11,8,4,6,11,0,2,9,2,10,9],[10,9,3,10,3,2,9,4,3,11,3,6,4,6,3],[8,2,3,8,4,2,4,6,2],[0,4,2,4,6,2],[1,9,0,2,3,4,2,4,6,4,3,8],[1,9,4,1,4,2,2,4,6],[8,1,3,8,6,1,8,4,6,6,10,1],[10,1,0,10,0,6,6,0,4],[4,6,3,4,3,8,6,10,3,0,3,9,10,9,3],[10,9,4,6,10,4],[4,9,5,7,6,11],[0,8,3,4,9,5,11,7,6],[5,0,1,5,4,0,7,6,11],[11,7,6,8,3,4,3,5,4,3,1,5],[9,5,4,10,1,2,7,6,11],[6,11,7,1,2,10,0,8,3,4,9,5],[7,6,11,5,4,10,4,2,10,4,0,2],[3,4,8,3,5,4,3,2,5,10,5,2,11,7,6],[7,2,3,7,6,2,5,4,9],[9,5,4,0,8,6,0,6,2,6,8,7],[3,6,2,3,7,6,1,5,0,5,4,0],[6,2,8,6,8,7,2,1,8,4,8,5,1,5,8],[9,5,4,10,1,6,1,7,6,1,3,7],[1,6,10,1,7,6,1,0,7,8,7,0,9,5,4],[4,0,10,4,10,5,0,3,10,6,10,7,3,7,10],[7,6,10,7,10,8,5,4,10,4,8,10],[6,9,5,6,11,9,11,8,9],[3,6,11,0,6,3,0,5,6,0,9,5],[0,11,8,0,5,11,0,1,5,5,6,11],[6,11,3,6,3,5,5,3,1],[1,2,10,9,5,11,9,11,8,11,5,6],[0,11,3,0,6,11,0,9,6,5,6,9,1,2,10],[11,8,5,11,5,6,8,0,5,10,5,2,0,2,5],[6,11,3,6,3,5,2,10,3,10,5,3],[5,8,9,5,2,8,5,6,2,3,8,2],[9,5,6,9,6,0,0,6,2],[1,5,8,1,8,0,5,6,8,3,8,2,6,2,8],[1,5,6,2,1,6],[1,3,6,1,6,10,3,8,6,5,6,9,8,9,6],[10,1,0,10,0,6,9,5,0,5,6,0],[0,3,8,5,6,10],[10,5,6],[11,5,10,7,5,11],[11,5,10,11,7,5,8,3,0],[5,11,7,5,10,11,1,9,0],[10,7,5,10,11,7,9,8,1,8,3,1],[11,1,2,11,7,1,7,5,1],[0,8,3,1,2,7,1,7,5,7,2,11],[9,7,5,9,2,7,9,0,2,2,11,7],[7,5,2,7,2,11,5,9,2,3,2,8,9,8,2],[2,5,10,2,3,5,3,7,5],[8,2,0,8,5,2,8,7,5,10,2,5],[9,0,1,5,10,3,5,3,7,3,10,2],[9,8,2,9,2,1,8,7,2,10,2,5,7,5,2],[1,3,5,3,7,5],[0,8,7,0,7,1,1,7,5],[9,0,3,9,3,5,5,3,7],[9,8,7,5,9,7],[5,8,4,5,10,8,10,11,8],[5,0,4,5,11,0,5,10,11,11,3,0],[0,1,9,8,4,10,8,10,11,10,4,5],[10,11,4,10,4,5,11,3,4,9,4,1,3,1,4],[2,5,1,2,8,5,2,11,8,4,5,8],[0,4,11,0,11,3,4,5,11,2,11,1,5,1,11],[0,2,5,0,5,9,2,11,5,4,5,8,11,8,5],[9,4,5,2,11,3],[2,5,10,3,5,2,3,4,5,3,8,4],[5,10,2,5,2,4,4,2,0],[3,10,2,3,5,10,3,8,5,4,5,8,0,1,9],[5,10,2,5,2,4,1,9,2,9,4,2],[8,4,5,8,5,3,3,5,1],[0,4,5,1,0,5],[8,4,5,8,5,3,9,0,5,0,3,5],[9,4,5],[4,11,7,4,9,11,9,10,11],[0,8,3,4,9,7,9,11,7,9,10,11],[1,10,11,1,11,4,1,4,0,7,4,11],[3,1,4,3,4,8,1,10,4,7,4,11,10,11,4],[4,11,7,9,11,4,9,2,11,9,1,2],[9,7,4,9,11,7,9,1,11,2,11,1,0,8,3],[11,7,4,11,4,2,2,4,0],[11,7,4,11,4,2,8,3,4,3,2,4],[2,9,10,2,7,9,2,3,7,7,4,9],[9,10,7,9,7,4,10,2,7,8,7,0,2,0,7],[3,7,10,3,10,2,7,4,10,1,10,0,4,0,10],[1,10,2,8,7,4],[4,9,1,4,1,7,7,1,3],[4,9,1,4,1,7,0,8,1,8,7,1],[4,0,3,7,4,3],[4,8,7],[9,10,8,10,11,8],[3,0,9,3,9,11,11,9,10],[0,1,10,0,10,8,8,10,11],[3,1,10,11,3,10],[1,2,11,1,11,9,9,11,8],[3,0,9,3,9,11,1,2,9,2,11,9],[0,2,11,8,0,11],[3,2,11],[2,3,8,2,8,10,10,8,9],[9,10,2,0,9,2],[2,3,8,2,8,10,0,1,8,1,10,8],[1,10,2],[1,3,8,9,1,8],[0,9,1],[0,3,8],[]],Up=[[0,0,0],[1,0,0],[1,1,0],[0,1,0],[0,0,1],[1,0,1],[1,1,1],[0,1,1]],Z8=[[0,1],[1,2],[3,2],[0,3],[4,5],[5,6],[7,6],[4,7],[0,4],[1,5],[2,6],[3,7]];function Q8(n,e,t,r,a=1){console.log("marchingCubes"),t||(t=[[0,0,0],n]);const l=[0,0,0],x=[0,0,0];for(let Ee=0;Ee<3;++Ee)l[Ee]=(t[1][Ee]-t[0][Ee])/n[Ee],x[Ee]=t[0][Ee];const _=[],O=[],z=[],q=new Array(8),oe=new Array(12),ue=[0,0,0],_e=[],be=new Map,Pe=r-Math.sign(r||1)*Number.MAX_VALUE;function Se(Ee,Xe,qe){if(Ee>=0&&Ee<n[0]&&Xe>=0&&Xe<n[1]&&qe>=0&&qe<n[2]){const $e=(Ee*n[1]+Xe)*n[2]+qe;return e[$e]}else return Pe}for(ue[0]=-a;ue[0]<n[0]+a;ue[0]+=a)for(ue[1]=-a;ue[1]<n[1]+a;ue[1]+=a)for(ue[2]=-a;ue[2]<n[2]+a;ue[2]+=a){let Ee=0;for(let $e=0;$e<8;++$e){const ft=Up[$e],gt=ue[0]+ft[0]*a,pt=ue[1]+ft[1]*a,Ht=ue[2]+ft[2]*a,ur=Se(gt,pt,Ht);q[$e]=ur,Ee|=ur>r?1<<$e:0}const Xe=J8[Ee];if(Xe===0)continue;for(let $e=0;$e<12;++$e){if(!(Xe&1<<$e))continue;const ft=`${ue[0]}_${ue[1]}_${ue[2]}_${$e}`;if(be.has(ft)){oe[$e]=be.get(ft).index;continue}oe[$e]=_.length;const gt=[0,0,0],pt=Z8[$e],Ht=Up[pt[0]],ur=Up[pt[1]],Ve=q[pt[0]],nt=q[pt[1]],nr=nt-Ve,Zt=Math.abs(nr)>1e-6?(r-Ve)/nr:0,Xt=[0,0,0];let Pr=!1;for(let cr=0;cr<3;++cr)Xt[cr]=ue[cr]+Ht[cr]*a+Zt*(ur[cr]-Ht[cr])*a,Xt[cr]<=0&&(Xt[cr]=0,Pr=!0),Xt[cr]>=n[cr]-1&&(Xt[cr]=n[cr]-1,Pr=!0),gt[cr]=l[cr]*Xt[cr]+x[cr];_.push(gt),_e.push(Pr),be.set(ft,{index:oe[$e],onBoundary:Pr})}const qe=X8[Ee];for(let $e=0;$e<qe.length;$e+=3){const ft=oe[qe[$e]],gt=oe[qe[$e+1]],pt=oe[qe[$e+2]];O.push(ft,gt,pt);const Ht=_e[ft]&&_e[gt]&&_e[pt];z.push(Ht?1:0)}}return{positions:_,cells:O,faceMaterials:z}}let K8=class{constructor({isovalue:n=null,color:e="#3d82ed",mode:t=1,step_size:r=1}){this.isovalue=n,this.color=il(e),this.mode=t,this.step_size=r}};class $8{constructor(e){this.viewer=e,this.scene=e.tjs.scene,this.settings={},this.guiFolder=null,this.meshes={}}createGui(){this.viewer.guiManager.gui&&!this.guiFolder&&(this.guiFolder=this.viewer.guiManager.gui.addFolder("Isosurface"))}removeGui(){this.guiFolder&&(this.viewer.guiManager.gui.removeFolder(this.guiFolder),this.guiFolder=null)}reset(){this.removeGui(),this.clearIossurfaces(),this.settings={}}fromSettings(e){this.settings={},this.removeGui(),this.createGui(),this.clearIossurfaces(),Object.entries(e).forEach(([t,r])=>{this.addSetting(t,r)})}addSetting(e,{isovalue:t=null,color:r="#3d82ed",mode:a=1,step_size:l=1}){if(t===null)if(this.viewer.volumetricData===null)t=0;else{const O=this.viewer.volumetricData.values.reduce((q,oe)=>Math.max(q,oe),-1/0),z=this.viewer.volumetricData.values.reduce((q,oe)=>Math.min(q,oe),1/0);t=(O+z)/2}const x=new K8({isovalue:t,color:r,mode:a,step_size:l});e===void 0&&(e="iso-"+Object.keys(this.settings).length),this.settings[e]=x,this.createGui();const _=this.guiFolder.addFolder(e);_.add(x,"isovalue",-1,1).name("Level").onChange(this.drawIsosurfaces.bind(this)),_.addColor(x,"color").name("Color").onChange(this.drawIsosurfaces.bind(this))}clearIossurfaces(){Object.values(this.meshes).forEach(e=>{Po(this.scene,e)})}drawIsosurfaces(){if(this.viewer.volumetricData===null){this.viewer.logger.debug("No volumetric data is set");return}this.viewer.logger.debug("drawIsosurfaces"),this.clearIossurfaces();const e=this.viewer.volumetricData,t=e.values,r=e.dims,a=e.cell,l=e.origin,x=[[a[0][0]/r[0],a[0][1]/r[0],a[0][2]/r[0]],[a[1][0]/r[1],a[1][1]/r[1],a[1][2]/r[1]],[a[2][0]/r[2],a[2][1]/r[2],a[2][2]/r[2]]];Object.entries(this.settings).forEach(([_,O])=>{this.viewer.logger.debug("setting: ",O);let z,q;if(O.mode===0){z=[-O.isovalue,O.isovalue];const _e=(16777215-parseInt(O.color.substring(1),16)).toString(16);q=[O.color,"#"+_e]}else z=[O.isovalue],q=[O.color];for(let _e=0;_e<z.length;_e++){const be=z[_e];this.viewer.logger.debug("isovalue: ",be),console.time("marchingCubes Time");var oe=Q8(r,t,null,be,O.step_size);console.timeEnd("marchingCubes Time"),oe.positions=oe.positions.map(function(Ee){var Xe=Ee[0]*x[0][0]+Ee[1]*x[1][0]+Ee[2]*x[2][0]+l[0],qe=Ee[0]*x[0][1]+Ee[1]*x[1][1]+Ee[2]*x[2][1]+l[1],$e=Ee[0]*x[0][2]+Ee[1]*x[1][2]+Ee[2]*x[2][2]+l[2];return[Xe,qe,$e]});let Pe=e9(oe.positions,oe.cells,oe.faceMaterials);const Se=[new Dh({color:q[_e],metalness:.1,roughness:.01,transparent:!0,opacity:.8,side:co}),new Dh({color:"#c2f542",metalness:.1,roughness:.01,transparent:!0,opacity:1,side:co})];var ue=new Ci(Pe,Se);ue.geometry.computeVertexNormals(),ue.material.flatShading=!1,ue.userData.type="isosurface",ue.userData.uuid=this.viewer.uuid,ue.userData.notSelectable=!0,ue.layers.set(1),this.scene.add(ue),this.meshes[_]=ue}}),this.viewer.tjs.render()}}function e9(n,e,t){var r=new di,a=[],l=[[],[]];n.forEach(function(O){a.push(O[0],O[1],O[2])}),r.setAttribute("position",new qa(a,3));for(let O=0;O<e.length;O+=3){const z=t[O/3];l[z].push(e[O],e[O+1],e[O+2])}var x=[],_=0;for(let O=0;O<=1;O++){const z=l[O],q=z.length;r.addGroup(_,q,O),x=x.concat(z),_+=q}return r.setIndex(x),r.computeVertexNormals(),r}class t9{constructor({method:e="miller",h:t=0,k:r=0,l:a=1,distance:l=0,selectedAtomIndices:x=[],colorMap:_="viridis",opacity:O=1,samplingDistance:z=.2}){this.method=e,this.h=t,this.k=r,this.l=a,this.distance=l,this.selectedAtomIndices=x,this.colorMap=_,this.opacity=O,this.samplingDistance=z}}class r9{constructor(e){this.viewer=e,this.scene=e.tjs.scene,this.settings={},this.guiFolder=null,this.slices={}}createGui(){this.viewer.guiManager.gui&&!this.guiFolder&&(this.guiFolder=this.viewer.guiManager.gui.addFolder("Slices"))}removeGui(){this.guiFolder&&(this.viewer.guiManager.gui.removeFolder(this.guiFolder),this.guiFolder=null)}reset(){this.removeGui(),this.clearSlices(),this.settings={}}fromSettings(e){this.settings={},this.removeGui(),this.createGui(),this.clearSlices(),Object.entries(e).forEach(([t,r])=>{this.addSetting(t,r)})}addSetting(e,{method:t="miller",h:r=0,k:a=0,l=1,distance:x=0,selectedAtomIndices:_=[],colorMap:O="viridis",opacity:z=1,samplingDistance:q=.2}){const oe=new t9({method:t,h:r,k:a,l,distance:x,selectedAtomIndices:_,colorMap:O,opacity:z,samplingDistance:q});e===void 0&&(e="slice-"+Object.keys(this.settings).length),this.settings[e]=oe,this.createGui();const ue=this.guiFolder.addFolder(e);ue.add(oe,"method",["miller","bestFit"]).name("Method").onChange(this.drawSlices.bind(this)),ue.add(oe,"samplingDistance",.1,5).name("Sampling Distance").onChange(this.drawSlices.bind(this)),oe.method==="miller"?(ue.add(oe,"h").name("Miller h").onChange(this.drawSlices.bind(this)),ue.add(oe,"k").name("Miller k").onChange(this.drawSlices.bind(this)),ue.add(oe,"l").name("Miller l").onChange(this.drawSlices.bind(this)),ue.add(oe,"distance").name("Distance").onChange(this.drawSlices.bind(this))):oe.method,ue.add(oe,"opacity",0,1).name("Opacity").onChange(this.drawSlices.bind(this))}clearSlices(){Object.values(this.slices).forEach(e=>{Po(this.scene,e)})}drawSlices(){if(this.viewer.volumetricData===null){this.viewer.logger.debug("No volumetric data is set");return}this.viewer.logger.debug("drawSlices"),console.log("drawSlices"),this.clearSlices();const e=this.viewer.volumetricData,t=e.values,r=e.dims,a=e.cell,l=new st(...e.origin);Object.entries(this.settings).forEach(([x,_])=>{let O,z;if(_.method==="miller")O=n9(_.h,_.k,_.l,a),z=O.clone().multiplyScalar(_.distance).add(l);else if(_.method==="bestFit"){const Ht=_.selectedAtomIndices.map(Ve=>new st(...this.viewer.atoms.positions[Ve])),ur=a9(Ht);O=ur.normal,z=ur.point}else{this.viewer.logger.error(`Unknown method: ${_.method}`);return}const q=_.samplingDistance||.5,oe=i9(t,r,a,l,O,z,q);if(!oe){this.viewer.logger.debug("Slice does not intersect the unit cell sufficiently");return}const{sliceData:ue,width:_e,height:be,minX:Pe,maxX:Se,minY:Ee,maxY:Xe,projectedPoints:qe}=oe,$e=Math.max(...ue.flat()),ft=Math.min(...ue.flat()),gt=l9(ue,ft,$e,_.colorMap),pt=c9(qe,O,z,gt,_.opacity,Pe,Se,Ee,Xe);pt.userData.type="slice",pt.userData.uuid=this.viewer.uuid,pt.userData.notSelectable=!0,pt.layers.set(1),this.scene.add(pt),this.slices[x]=pt}),this.viewer.tjs.render()}}function n9(n,e,t,r){const a=new st(...r[0]),l=new st(...r[1]),x=new st(...r[2]),_=a.dot(l.clone().cross(x)),O=l.clone().cross(x).multiplyScalar(2*Math.PI/_),z=x.clone().cross(a).multiplyScalar(2*Math.PI/_),q=a.clone().cross(l).multiplyScalar(2*Math.PI/_);return O.clone().multiplyScalar(n).add(z.clone().multiplyScalar(e)).add(q.clone().multiplyScalar(t)).normalize()}function a9(n){if(n.length<3)throw new Error("At least three points are required to define a plane.");const e=new st(0,0,0);n.forEach(_e=>{e.add(_e)}),e.divideScalar(n.length);let t=0,r=0,a=0,l=0,x=0,_=0;n.forEach(_e=>{const be=_e.x-e.x,Pe=_e.y-e.y,Se=_e.z-e.z;t+=be*be,r+=be*Pe,a+=be*Se,l+=Pe*Pe,x+=Pe*Se,_+=Se*Se});const O=[[t,r,a],[r,l,x],[a,x,_]],{eigenvalues:z,eigenvectors:q}=y9(O),oe=z.findIndex(_e=>_e===Math.min(...z)),ue=q[oe];return{normal:new st(...ue).normalize(),point:e}}function i9(n,e,t,r,a,l,x){const _=m9(t,r,a,l);if(_.length<3)return null;const O=J2(a),z=_.map(ft=>{const gt=ft.clone().sub(l),pt=gt.dot(O.u),Ht=gt.dot(O.v);return new Jr(pt,Ht)}),q=v9(z);let oe=1/0,ue=1/0,_e=-1/0,be=-1/0;q.forEach(ft=>{ft.x<oe&&(oe=ft.x),ft.y<ue&&(ue=ft.y),ft.x>_e&&(_e=ft.x),ft.y>be&&(be=ft.y)});const[Pe,Se,Ee]=e,Xe=Math.ceil((_e-oe)/x)+1,qe=Math.ceil((be-ue)/x)+1,$e=[];for(let ft=0;ft<qe;ft++){const gt=[];for(let pt=0;pt<Xe;pt++){const Ht=oe+pt*x,ur=ue+ft*x,Ve=new Jr(Ht,ur);let nt=0;if(g9(Ve,q)){const nr=l.clone().add(O.u.clone().multiplyScalar(Ht)).add(O.v.clone().multiplyScalar(ur)).clone().sub(r),Zt=o9(nr,t,e);nt=s9(n,Zt,e)}gt.push(nt)}$e.push(gt)}return{sliceData:$e,width:Xe,height:qe,minX:oe,maxX:_e,minY:ue,maxY:be,projectedPoints:q}}function o9(n,e,t){const r=new st(...e[0]),a=new st(...e[1]),l=new st(...e[2]),x=new ma;x.set(r.x,a.x,l.x,r.y,a.y,l.y,r.z,a.z,l.z);const _=x.clone().invert(),O=n.clone().applyMatrix3(_),z=O.x*t[0],q=O.y*t[1],oe=O.z*t[2];return{x:z,y:q,z:oe}}function s9(n,e,t){const{x:r,y:a,z:l}=e,x=Math.floor(r),_=x+1,O=Math.floor(a),z=O+1,q=Math.floor(l),oe=q+1,ue=r-x,_e=a-O,be=l-q,Pe=Ks(n,x,O,q,t),Se=Ks(n,_,O,q,t),Ee=Ks(n,x,z,q,t),Xe=Ks(n,x,O,oe,t),qe=Ks(n,_,O,oe,t),$e=Ks(n,x,z,oe,t),ft=Ks(n,_,z,q,t),gt=Ks(n,_,z,oe,t),pt=Pe*(1-ue)+Se*ue,Ht=Xe*(1-ue)+qe*ue,ur=Ee*(1-ue)+ft*ue,Ve=$e*(1-ue)+gt*ue,nt=pt*(1-_e)+ur*_e,nr=Ht*(1-_e)+Ve*_e;return nt*(1-be)+nr*be}function Ks(n,e,t,r,a){const[l,x,_]=a;if(e<0||e>=l||t<0||t>=x||r<0||r>=_)return 0;const O=(e*x+t)*_+r;return n[O]}function l9(n,e,t,r){const a=n[0].length,l=n.length,x=new Uint8Array(a*l*4),_=u9(r);let O=0;for(let q=0;q<l;q++)for(let oe=0;oe<a;oe++){const ue=(n[q][oe]-e)/(t-e),[_e,be,Pe]=_(ue);x[O++]=_e*255,x[O++]=be*255,x[O++]=Pe*255,x[O++]=255}const z=new A2(x,a,l,Uo);return z.needsUpdate=!0,z.minFilter=xo,z.magFilter=xo,z}function c9(n,e,t,r,a,l,x,_,O){const z=J2(e),q=new k2(n),oe=new Tm(q);oe.setAttribute("uv",new Xi(new Float32Array(oe.attributes.position.count*2),2));for(let Ee=0;Ee<oe.attributes.position.count;Ee++){const Xe=oe.attributes.position.getX(Ee),qe=oe.attributes.position.getY(Ee),$e=(Xe-l)/(x-l),ft=(qe-_)/(O-_);oe.attributes.uv.setXY(Ee,$e,ft)}const ue=new jn,_e=z.u,be=z.v,Pe=e;ue.makeBasis(_e,be,Pe),ue.setPosition(t),oe.applyMatrix4(ue);const Se=new Gl({map:r,side:co,transparent:a<1,opacity:a});return new Ci(oe,Se)}function u9(n){return n==="grayscale"?function(e){return[e,e,e]}:n==="viridis"?function(e){return e=Math.max(0,Math.min(1,e)),d9(e)}:function(e){return[e,e,e]}}function d9(n){const e=[[.267004,.004874,.329415],[.282327,.094955,.417331],[.253935,.265254,.529983],[.206756,.371758,.553117],[.163625,.471133,.558148],[.127568,.566949,.550556],[.134692,.658636,.517649],[.266941,.748751,.440573],[.477504,.821444,.318195],[.741388,.873449,.149561],[.993248,.906157,.143936]],t=e.length-1,r=Math.floor(n*t),a=n*t-r,l=e[r],x=e[Math.min(r+1,t)];return[l[0]+(x[0]-l[0])*a,l[1]+(x[1]-l[1])*a,l[2]+(x[2]-l[2])*a]}function h9(n,e){const t=new st(...n[0]),r=new st(...n[1]),a=new st(...n[2]),l=e.clone(),x=e.clone().add(t),_=e.clone().add(r),O=e.clone().add(a),z=e.clone().add(t).add(r),q=e.clone().add(t).add(a),oe=e.clone().add(r).add(a),ue=e.clone().add(t).add(r).add(a);return[l,x,_,O,z,q,oe,ue]}function f9(n){const[e,t,r,a,l,x,_,O]=n;return[[e,t],[e,r],[e,a],[t,l],[t,x],[r,l],[r,_],[a,x],[a,_],[l,O],[x,O],[_,O]]}function p9(n,e,t,r){const a=e.clone().sub(n),l=t.dot(a),x=t.dot(r.clone().sub(n));if(Math.abs(l)<1e-6)return Math.abs(x)<1e-6?[n.clone(),e.clone()]:null;{const _=x/l;return _<0||_>1?null:n.clone().add(a.multiplyScalar(_))}}function m9(n,e,t,r){const a=h9(n,e),l=f9(a),x=[];for(let z=0;z<l.length;z++){const[q,oe]=l[z],ue=p9(q,oe,t,r);ue&&(Array.isArray(ue)?x.push(...ue):x.push(ue))}const _=[],O=1e-6;return x.forEach(z=>{_.some(q=>q.distanceToSquared(z)<O*O)||_.push(z)}),_}function J2(n){let e=new st;Math.abs(n.z)>Math.abs(n.x)?e.set(1,0,0).cross(n).normalize():e.set(0,0,1).cross(n).normalize();const t=n.clone().cross(e).normalize();return{u:e,v:t}}function g9(n,e){let t=0;const r=e.length;for(let a=0;a<r;a++){const l=e[a],x=e[(a+1)%r];l.y<=n.y?x.y>n.y&&Sy(l,x,n)>0&&t++:x.y<=n.y&&Sy(l,x,n)<0&&t--}return t!==0}function Sy(n,e,t){return(e.x-n.x)*(t.y-n.y)-(t.x-n.x)*(e.y-n.y)}function v9(n){n.sort((r,a)=>r.x-a.x||r.y-a.y);const e=[];for(let r of n){for(;e.length>=2&&Cy(e[e.length-2],e[e.length-1],r)<=0;)e.pop();e.push(r)}const t=[];for(let r=n.length-1;r>=0;r--){const a=n[r];for(;t.length>=2&&Cy(t[t.length-2],t[t.length-1],a)<=0;)t.pop();t.push(a)}return e.pop(),t.pop(),e.concat(t)}function Cy(n,e,t){return(e.x-n.x)*(t.y-n.y)-(e.y-n.y)*(t.x-n.x)}function y9(n){let e=n.map(a=>a.slice());const t=e.length;let r=Array.from({length:t},(a,l)=>Array.from({length:t},(x,_)=>l===_?1:0));for(let a=0;a<100;a++){let l=0,x=0,_=0;for(let be=0;be<t;be++)for(let Pe=be+1;Pe<t;Pe++)Math.abs(e[be][Pe])>Math.abs(l)&&(l=e[be][Pe],x=be,_=Pe);if(Math.abs(l)<1e-10)break;const O=.5*Math.atan2(2*l,e[x][x]-e[_][_]),z=Math.cos(O),q=Math.sin(O),oe=z*z*e[x][x]-2*q*z*e[x][_]+q*q*e[_][_],ue=q*q*e[x][x]+2*q*z*e[x][_]+z*z*e[_][_],_e=0;for(let be=0;be<t;be++)if(be!==x&&be!==_){const Pe=z*e[x][be]-q*e[_][be],Se=q*e[x][be]+z*e[_][be];e[x][be]=Pe,e[be][x]=Pe,e[_][be]=Se,e[be][_]=Se}e[x][x]=oe,e[_][_]=ue,e[x][_]=_e,e[_][x]=_e;for(let be=0;be<t;be++){const Pe=z*r[be][x]-q*r[be][_],Se=q*r[be][x]+z*r[be][_];r[be][x]=Pe,r[be][_]=Se}}return{eigenvalues:e.map((a,l)=>a[l]),eigenvectors:r}}let x9=class{constructor({origins:n=[],vectors:e=[],factor:t=1,color:r="#3d82ed",radius:a=.05,centerOnAtoms:l=!1}){this.origins=n,this.vectors=e,this.color=il(r),this.radius=a,this.factor=t,this.centerOnAtoms=l}};class _9{constructor(e){this.viewer=e,this.scene=this.viewer.tjs.scene,this._show=!0,this.init()}get show(){return this._show}set show(e){this._show=e,Object.values(this.meshes).forEach(t=>{Object.values(t).forEach(r=>{r.visible=e})})}init(){if(this.settings={},this.meshes={},this.viewer.logger.debug("init VectorField"),this.viewer.atoms.attributes.atom.moment===void 0)return;let e=[],t=[],r=[],a=[];for(let l=0;l<this.viewer.atoms.getAtomsCount();l++)if(this.viewer.atoms.attributes.atom.moment[l]>0){const x=[0,0,this.viewer.atoms.attributes.atom.moment[l]*1.5],_=this.viewer.atoms.positions[l].map((O,z)=>O-x[z]/2);e.push(_),t.push(x)}else{const x=[0,0,this.viewer.atoms.attributes.atom.moment[l]*1.5],_=this.viewer.atoms.positions[l].map((O,z)=>O-x[z]/2);r.push(_),a.push(x)}this.addSetting("up",{origins:e,vectors:t,color:"#3d82ed"}),this.addSetting("down",{origins:r,vectors:a,color:"#ff0000"})}fromSettings(e){this.settings=[],this.clearMeshes(),Object.entries(e).forEach(([t,r])=>{this.addSetting(t,r)})}addSetting(e,{origins:t,vectors:r,factor:a=1,color:l="#3d82ed",radius:x=.05,centerOnAtoms:_=!1}){if(typeof t=="string"&&!this.viewer.atoms.getAttribute(t))throw new Error(`Attribute '${t}' is not defined. The available attributes are: ${Object.keys(this.viewer.atoms.attributes.atom)}`);const O=new x9({origins:t,vectors:r,factor:a,color:l,radius:x,centerOnAtoms:_});e===void 0&&(e="vf-"+Object.keys(this.settings).length),this.settings[e]=O}clearMeshes(){Object.values(this.meshes).forEach(e=>{Object.values(e).forEach(t=>{Po(this.scene,t)})}),this.meshes={}}getData(e){let t,r;return typeof e.origins=="string"?t=this.viewer.atoms.getAttribute(e.origins):t=e.origins,typeof e.vectors=="string"?r=this.viewer.atoms.getAttribute(e.vectors):r=e.vectors,[t,r]}drawVectorFields(){this.viewer.logger.debug("drawVectorFields"),this.clearMeshes(),Object.entries(this.settings).forEach(([e,t])=>{const[r,a]=this.getData(t),[l,x]=b9(a.length,t,t.color,"Standard");l.visible=this.show,x.visible=this.show,this.scene.add(l),this.scene.add(x),this.meshes[e]={shaft:l,head:x}}),this.updateArrowMesh()}updateArrowMesh(e=null,t=null){t===null&&(t=this.viewer.atoms),Object.entries(this.settings).forEach(([r,a])=>{const[l,x]=this.getData(a);let _=[];e?_=[e]:_=[...Array(l.length).keys()];const O=this.meshes[r].shaft,z=this.meshes[r].head;_.forEach(q=>{const oe=new st(...l[q]),ue=new st(...x[q]).multiplyScalar(a.factor),_e=oe.clone().add(ue),be=new st().lerpVectors(oe,_e,.5),Pe=Cm(oe,_e),Se=new st(a.radius,oe.distanceTo(_e),a.radius),Ee=new jn().compose(be,Pe,Se),Xe=new jn().compose(_e,Pe,new st(1,1,1));O.setMatrixAt(q,Ee),z.setMatrixAt(q,Xe)}),O.instanceMatrix.needsUpdate=!0,z.instanceMatrix.needsUpdate=!0})}}function b9(n,e,t="0x000000",r="Standard"){const a=new ll(1,1,1,8,1),l=hl[r].clone();l.color=new qn(t);const x=new qc(e.radius*2,6*e.radius,8);x.rotateX(Math.PI);const _=new Ul(a,l,n),O=new Ul(x,l,n);return t=new qn(t),_.userData.type="arrow",O.userData.type="arrow",[_,O]}let w9=class{constructor({indices:n=[],color:e="black",fontSize:t=16}){this.indices=n,this.color=e,this.fontSize=t}};class M9{constructor(e){this.viewer=e,this.scene=this.viewer.tjs.scene,this.settings={},this.meshes={}}reset(){this.settings={},Object.entries(this.meshes).forEach(([e,t])=>{console.log(e,t),t.forEach(r=>{console.log(r),this.scene.remove(r)})}),this.meshes={},this.viewer.tjs.render()}measure(e=null){if(e.length===0)this.reset();else{name=`measurement-${Object.keys(this.settings).length}`;const t=new w9({indices:e});this.settings[name]=t,this.drawMeasurement(t)}}drawMeasurement(e){const t=e.indices;t.length===1?this.showPosition(name,t):t.length===2?this.showDistance(name,t):t.length===3?this.showAngle(name,t):t.length===4?this.showDihedralAngle(name,t):console.log("Invalid number of atoms for measurement"),this.viewer.tjs.render()}showPosition(e,t){const r=t[0],a=this.viewer.atoms.positions[r],l=this.viewer.atoms.symbols[r];console.log(a,l);const x=`${l} [${a[0].toFixed(3)}, ${a[1].toFixed(3)}, ${a[2].toFixed(3)}]`,_=Ou(new st(...a).add(new st(1,0,0)),x,"black","18px");this.scene.add(_),this.meshes[e]=[_]}showDistance(e,t){const r=new st(...this.viewer.atoms.positions[t[0]]),a=new st(...this.viewer.atoms.positions[t[1]]),l=r.distanceTo(a),x=[r,a],_=new jc({color:255}),O=new di().setFromPoints(x),z=new zu(O,_);this.scene.add(z);const q=Ou(r.add(a).multiplyScalar(.5),l.toFixed(3),"black","18px");this.scene.add(q),this.meshes[e]=[z,q]}showAngle(e,t){const r=new st(...this.viewer.atoms.positions[t[0]]),a=new st(...this.viewer.atoms.positions[t[1]]),l=new st(...this.viewer.atoms.positions[t[2]]),x=r.clone().sub(a).normalize(),_=l.clone().sub(a).normalize(),O=x.angleTo(_)*180/Math.PI,z=new jc({color:255}),q=new di().setFromPoints([r,a]),oe=new zu(q,z);this.scene.add(oe);const ue=new di().setFromPoints([a,l]),_e=new zu(ue,z);this.scene.add(_e);const be=a.add(x.add(_).multiplyScalar(.3)),Pe=Ou(be,O.toFixed(3),"black","18px");this.scene.add(Pe),this.meshes[e]=[oe,_e,Pe]}showDihedralAngle(e,t){const r=new st(...this.viewer.atoms.positions[t[0]]),a=new st(...this.viewer.atoms.positions[t[1]]),l=new st(...this.viewer.atoms.positions[t[2]]),x=new st(...this.viewer.atoms.positions[t[3]]),_=r.clone().sub(a).normalize(),O=l.clone().sub(a).normalize(),z=x.clone().sub(l).normalize(),q=_.clone().cross(O).normalize(),oe=O.clone().cross(z).normalize(),ue=Math.acos(q.dot(oe)),_e=new di,be=[];be.push(r.x,r.y,r.z),be.push(a.x,a.y,a.z),be.push(l.x,l.y,l.z),be.push(a.x,a.y,a.z),be.push(l.x,l.y,l.z),be.push(x.x,x.y,x.z),_e.setAttribute("position",new qa(be,3)),_e.setIndex([0,1,2,3,4,5]);const Pe=new Gl({color:255,opacity:.9,side:co,transparent:!0}),Se=new Ci(_e,Pe);this.scene.add(Se);const Ee=a.add(l).multiplyScalar(.3).sub(q.add(oe).multiplyScalar(.3)),Xe=Ou(Ee,ue.toFixed(3),"black","18px");this.scene.add(Xe),this.meshes[e]=[Se,Xe]}}function T9(n,e=!1){const t=n[0].index!==null,r=new Set(Object.keys(n[0].attributes)),a=new Set(Object.keys(n[0].morphAttributes)),l={},x={},_=n[0].morphTargetsRelative,O=new di;let z=0;for(let q=0;q<n.length;++q){const oe=n[q];let ue=0;if(t!==(oe.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+q+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const _e in oe.attributes){if(!r.has(_e))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+q+'. All geometries must have compatible attributes; make sure "'+_e+'" attribute exists among all geometries, or in none of them.'),null;l[_e]===void 0&&(l[_e]=[]),l[_e].push(oe.attributes[_e]),ue++}if(ue!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+q+". Make sure all geometries have the same number of attributes."),null;if(_!==oe.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+q+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const _e in oe.morphAttributes){if(!a.has(_e))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+q+".  .morphAttributes must be consistent throughout all geometries."),null;x[_e]===void 0&&(x[_e]=[]),x[_e].push(oe.morphAttributes[_e])}if(e){let _e;if(t)_e=oe.index.count;else if(oe.attributes.position!==void 0)_e=oe.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+q+". The geometry must have either an index or a position attribute"),null;O.addGroup(z,_e,q),z+=_e}}if(t){let q=0;const oe=[];for(let ue=0;ue<n.length;++ue){const _e=n[ue].index;for(let be=0;be<_e.count;++be)oe.push(_e.getX(be)+q);q+=n[ue].attributes.position.count}O.setIndex(oe)}for(const q in l){const oe=Ey(l[q]);if(!oe)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+q+" attribute."),null;O.setAttribute(q,oe)}for(const q in x){const oe=x[q][0].length;if(oe===0)break;O.morphAttributes=O.morphAttributes||{},O.morphAttributes[q]=[];for(let ue=0;ue<oe;++ue){const _e=[];for(let Pe=0;Pe<x[q].length;++Pe)_e.push(x[q][Pe][ue]);const be=Ey(_e);if(!be)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+q+" morphAttribute."),null;O.morphAttributes[q].push(be)}}return O}function Ey(n){let e,t,r,a=-1,l=0;for(let z=0;z<n.length;++z){const q=n[z];if(e===void 0&&(e=q.array.constructor),e!==q.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=q.itemSize),t!==q.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=q.normalized),r!==q.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(a===-1&&(a=q.gpuType),a!==q.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;l+=q.count*t}const x=new e(l),_=new Xi(x,t,r);let O=0;for(let z=0;z<n.length;++z){const q=n[z];if(q.isInterleavedBufferAttribute){const oe=O/t;for(let ue=0,_e=q.count;ue<_e;ue++)for(let be=0;be<t;be++){const Pe=q.getComponent(ue,be);_.setComponent(ue+oe,be,Pe)}}else x.set(q.array,O);O+=q.count*t}return a!==void 0&&(_.gpuType=a),_}class Ly{constructor({indices:e,scale:t=1.1,type:r="sphere",color:a="yellow"}){this.indices=e,this.color=il(a),this.scale=t,this.type=r}toDict(){return{indices:this.indices,color:this.color,scale:this.scale,type:this.type}}}class A9{constructor(e){this.viewer=e,this.scene=this.viewer.tjs.scene,this.settings={},this.meshes={},this.init()}init(){this.viewer.logger.debug("init highlight settings"),this.settings={selection:new Ly({indices:[],scale:1.1,color:"#ffff00"})}}fromSettings(e){this.settings={},this.clearMeshes(),Object.entries(e).forEach(([t,r])=>{this.addSetting(t,r)})}addSetting(e,{indices:t,scale:r=1.1,type:a="sphere",color:l="#3d82ed"}){const x=new Ly({indices:t,scale:r,type:a,color:l});this.settings[e]=x}clearMeshes(){Object.values(this.meshes).forEach(e=>{e.parent&&e.parent.remove(e)}),this.meshes={}}drawHighlightAtoms(){this.clearMeshes();const e=new Gl({color:"yellow",opacity:.6,transparent:!0}),t=new cl(1,16,16);this.drawHighlightMesh("sphere",t,e);const r=e.clone();r.color="green";const a=new sl(2,2,2);this.drawHighlightMesh("box",a,r);const l=e.clone();l.color="black",l.opacity=1;const x=this.createCrossGeometry(1);this.drawHighlightMesh("cross",x,l)}drawHighlightMesh(e,t,r){const a=this.viewer.atomManager.meshes.atom,l=new Ul(t,r,a.count),x=new st,_=new Oi,O=new st,z=new jn,q=new jn;for(let oe=0;oe<a.count;oe++)a.getMatrixAt(oe,z),z.decompose(x,_,O),O.multiplyScalar(0),q.compose(x,_,O),l.setMatrixAt(oe,q);l.instanceMatrix.needsUpdate=!0,a.add(l),l.layers.set(1),this.meshes[e]=l,Object.values(this.settings).forEach(oe=>{this.updateHighlightAtomsMesh(oe)})}createCrossGeometry(e=1){const t=new Dl(e,.1,16,20),r=new Dl(e,.1,16,20);r.rotateX(Math.PI/2);const a=new Dl(e,.1,16,20);return a.rotateY(Math.PI/2),T9([t,r,a])}updateHighlightAtomsMesh({indices:e=[],factor:t=1.1,color:r="yellow",type:a="sphere"}){if(this.viewer.atoms.symbols.length>0&&this.meshes[a]){const l=new st,x=new Oi,_=new st;e.forEach(O=>{const z=new jn;this.viewer.atomManager.meshes.atom.getMatrixAt(O,z),z.decompose(l,x,_),_.multiplyScalar(t),z.compose(l,x,_),this.meshes[a].setMatrixAt(O,z),this.meshes[a].setColorAt(O,il(r))}),this.meshes[a].instanceMatrix.needsUpdate=!0}}}class S9{constructor(e,t){this.viewer=e,this.guiConfig=t,this.legendSprites=[],this.guiConfig.legend&&this.guiConfig.legend.enabled&&this.addLegend()}addLegend(){this.removeLegend();let e,t;const r=2,a=-2;switch(this.guiConfig.legend.position||"top-right"){case"top-left":e=-.9,t=.9;break;case"top-right":e=.7,t=.9;break;case"bottom-left":e=-.9,t=-.7;break;case"bottom-right":e=-5,t=-2;break;default:e=.7,t=.9;break}let l=0;const x=this.viewer.atomManager.getMaxRadius(),_=this.viewer.atomManager.getMinRadius();console.log("maxRadius: ",x),console.log("minRadius: ",_),Object.entries(this.viewer.atomManager.settings).forEach(([O,z])=>{const q=`${O}`,oe=E9(q,{fontsize:96,fontface:"Arial",textColor:{r:0,g:0,b:0,a:1},backgroundColor:{r:255,g:255,b:255,a:0},scale:1.5}),ue=typeof z.color=="string"?new qn(z.color):z.color,_e=Math.min(2,Math.max(1,z.radius));console.log("scale: ",_e);const be=C9(ue,{scale:_e}),Pe=t-l*a;be.position.set(e,Pe,-1),oe.position.set(e+r,Pe,-1),this.viewer.tjs.legendScene.add(be),this.viewer.tjs.legendScene.add(oe),this.legendSprites.push(be,oe),l+=1})}removeLegend(){this.legendSprites.length>0&&(this.legendSprites.forEach(e=>{this.viewer.tjs.legendScene.remove(e),e.material.map.dispose(),e.material.dispose()}),this.legendSprites=[])}updateLegend(){this.guiConfig.legend&&this.guiConfig.legend.enabled?this.addLegend():this.removeLegend()}}function C9(n,e={}){const t=e.radius||32,r=document.createElement("canvas"),a=t*2;r.width=a,r.height=a;const l=r.getContext("2d");l.beginPath(),l.arc(t,t,t-2,0,2*Math.PI,!1),l.fillStyle=`#${n.getHexString()}`,l.fill();const x=new _m(r);x.minFilter=xo,x.generateMipmaps=!1;const _=new Jh({map:x}),O=new xm(_),z=e.scale||.1;return O.scale.set(z,z,1),O}function E9(n,e={}){const t=e.fontface||"Arial",r=e.fontsize||96,a=e.borderThickness||0,l=e.borderColor||{r:0,g:0,b:0,a:1},x=e.backgroundColor||{r:255,g:255,b:255,a:0},_=e.textColor||{r:0,g:0,b:0,a:1},O=document.createElement("canvas"),z=O.getContext("2d");z.font=`${r}px ${t}`;const q=z.measureText(n).width,oe=r;O.width=q+a*2,O.height=oe+a*2,z.fillStyle=`rgba(${x.r},${x.g},${x.b},${x.a})`,z.fillRect(0,0,O.width,O.height),a>0&&(z.strokeStyle=`rgba(${l.r},${l.g},${l.b},${l.a})`,z.lineWidth=a,z.strokeRect(0,0,O.width,O.height)),z.fillStyle=`rgba(${_.r},${_.g},${_.b},${_.a})`,z.font=`${r}px ${t}`,z.textBaseline="top",z.fillText(n,a,a);const ue=new _m(O);ue.minFilter=xo,ue.generateMipmaps=!1;const _e=new Jh({map:ue}),be=new xm(_e),Pe=e.scale||1;return be.scale.set(Pe*O.width/O.height,Pe,1),be}class L9{constructor(e,t,r){this.viewer=e,this.gui=t,this.guiConfig=r,this.tempBoundary=[[0,0],[0,0],[0,0]],this.div=document.createElement("div"),this.viewer.tjs.containerElement.appendChild(this.div),this.viewer.tjs.containerElement.addEventListener("viewerUpdated",a=>{this.updateViewerControl(a.detail)}),this.guiConfig.controls.atomsControl&&this.addAtomsControl(),this.guiConfig.controls.colorControl&&this.addColorControl(),this.legend=new S9(this.viewer,this.guiConfig)}update(e){this.guiConfig.timeline.enabled&&e.length>1?(this.addTimeline(),this.timeline.max=e.length-1):this.removeTimeline()}addAtomsControl(){const e=this.gui.addFolder("Atoms");this.modelStyleController=e.add({modelStyle:this.viewer.modelStyle},"modelStyle",E7).onChange(t=>{this.viewer.modelStyle=t,this.viewer.drawModels()}).name("Model Style"),this.radiusTypeController=e.add(this.viewer,"radiusType",R7).name("Radius Type").onChange(t=>{this.viewer.radiusType=t,this.viewer.drawModels()}),this.atomLabelTypeController=e.add(this.viewer,"atomLabelType",["None","Symbol","Index"]).onChange(t=>{this.viewer.atomLabelType=t}).name("Atom Label"),this.materialTypeController=e.add(this.viewer,"materialType",["Standard","Phong","Basic"]).onChange(t=>{this.viewer.materialType=t,this.viewer.drawModels()}).name("Material Type"),this.atomScaleController=e.add(this.viewer,"atomScale",.1,2).name("Atom Scale").onChange(t=>{this.viewer.atomScale=t}),this.showCellController=e.add(this.viewer,"showCell").name("Unit Cell").onChange(t=>{this.viewer.showCell=t}),this.showBondedAtomsController=e.add(this.viewer,"showBondedAtoms").name("Bonded Atoms").onChange(t=>{this.viewer.showBondedAtoms=t,this.viewer.drawModels()}),this.legendToggleController=e.add(this.guiConfig.legend,"enabled").name("Show Legend").onChange(t=>{this.guiConfig.legend.enabled=t,this.updateLegend()}),this.addReplaceAtomControl(e),this.addAddAtomControl(e),this.addBoundaryControl(e)}addReplaceAtomControl(e){const t=e.addFolder("Replace Atom"),r={symbol:"C"};this.replaceAtomController=t.add(r,"symbol").name("New Element Symbol"),t.add({replaceSelectedAtoms:()=>{const a=r.symbol;if(this.viewer.selectedAtomsIndices&&this.viewer.selectedAtomsIndices.length>0){const l=new Vh(this.viewer.weas,a);this.viewer.weas.ops.execute(l),this.viewer.weas.eventHandlers.dispatchAtomsUpdated()}else alert("No atoms selected for replacement.")}},"replaceSelectedAtoms").name("Replace Selected Atoms")}addAddAtomControl(e){const t=e.addFolder("Add Atom"),r={symbol:"C"};this.addAtomController=t.add(r,"symbol").name("New Element Symbol"),t.add({addAtoms:()=>{const a=new Gh(this.viewer.weas,r.symbol);this.viewer.weas.ops.execute(a),this.viewer.weas.eventHandlers.dispatchAtomsUpdated()}},"addAtoms").name("Add Selected Atoms")}addBoundaryControl(e){const t=e.addFolder("Boundary");this.boundaryControllers=[[],[],[]],["X","Y","Z"].forEach((r,a)=>{this.boundaryControllers[a].push(t.add({[`min${r}`]:this.viewer.boundary[a][0]},`min${r}`,-10,10).onChange(l=>this.updateBoundaryValue(a,0,l)).name(`Min ${r}`)),this.boundaryControllers[a].push(t.add({[`max${r}`]:this.viewer.boundary[a][1]},`max${r}`,-10,10).onChange(l=>this.updateBoundaryValue(a,1,l)).name(`Max ${r}`))}),t.add({apply:()=>this.applyBoundaryChanges()},"apply").name("Apply Changes")}addColorControl(){const e=this.gui.addFolder("Color");e.addColor(this.viewer,"backgroundColor").onChange(t=>{this.viewer.tjs.scene.background=new qn(t)}).name("Background"),this.colorByController=e.add({colorBy:this.viewer.colorBy},"colorBy",U0).onChange(t=>{this.viewer.colorBy=t,this.viewer.drawModels()}).name("Color By"),this.colorTypeController=e.add({colorType:this.viewer.colorType},"colorType",L7).onChange(t=>{this.viewer.colorType=t,this.viewer.drawModels()}).name("Color Type")}addTimeline(){if(this.div.querySelector("#animation-controls"))return;const e=document.createElement("div");e.id="animation-controls",e.style.backgroundColor="transparent",e.innerHTML='<button id="play-pause-btn">Play</button><button id="reset-btn">Reset</button><input type="range" id="timeline" min="0" max="100" value="0"><span id="current-frame">0</span>',this.div.appendChild(e),this.playPauseBtn=this.div.querySelector("#play-pause-btn"),this.resetBtn=this.div.querySelector("#reset-btn"),this.timeline=this.div.querySelector("#timeline"),this.currentFrameDisplay=this.div.querySelector("#current-frame"),this.isPlaying=!1;const t=100;this.timeline.max=t,this.playPauseBtn.addEventListener("click",()=>{this.viewer.isPlaying=!this.viewer.isPlaying,this.playPauseBtn.textContent=this.viewer.isPlaying?"Pause":"Play",this.viewer.isPlaying&&this.viewer.play()}),this.resetBtn.addEventListener("click",()=>{this.viewer.currentFrame=0}),this.timeline.addEventListener("input",()=>{this.viewer.currentFrame=parseInt(this.timeline.value,10)})}removeTimeline(){const e=this.div.querySelector("#animation-controls");e&&e.remove()}updateBoundaryValue(e,t,r){this.tempBoundary[e][t]=parseFloat(r)}applyBoundaryChanges(){this.viewer.boundary=this.tempBoundary,this.viewer.drawModels()}addLegend(){this.removeLegend();const e=document.createElement("div");e.id="legend-container",e.style.position="absolute",e.style.backgroundColor="rgba(255, 255, 255, 0.8)",e.style.padding="10px",e.style.borderRadius="5px",e.style.zIndex="1000",this.setLegendPosition(e),console.log("settings: ",this.viewer.atomManager.settings),Object.entries(this.viewer.atomManager.settings).forEach(([t,r])=>{const a=document.createElement("div");a.style.display="flex",a.style.alignItems="center",a.style.marginBottom="5px";const l=document.createElement("canvas");l.width=20,l.height=20;const x=l.getContext("2d");x.fillStyle=`#${r.color.getHexString()}`;const _=r.radius*10;console.log("color: ",x.fillStyle),console.log("radius: ",_),x.beginPath(),x.arc(10,10,_,0,Math.PI*2),x.fill(),a.appendChild(l);const O=document.createElement("span");O.textContent=` ${t}`,O.style.marginLeft="5px",O.style.fontSize="14px",a.appendChild(O),e.appendChild(a)}),this.viewer.tjs.containerElement.appendChild(e)}removeLegend(){const e=this.viewer.tjs.containerElement.querySelector("#legend-container");e&&e.remove()}updateLegend(){this.legend.updateLegend()}setLegendPosition(e){const t=this.guiConfig.legend.position||"top-right";e.style.top=t.includes("top")?"10px":"",e.style.bottom=t.includes("bottom")?"10px":"",e.style.left=t.includes("left")?"10px":"",e.style.right=t.includes("right")?"10px":""}updateViewerControl(e){Object.entries(e).forEach(([t,r])=>{switch(t){case"modelStyle":this.updateModelStyle(r);break;case"radiusType":this.updateRadiusType(r);break;case"atomLabelType":break;case"materialType":break;case"atomScale":this.updateAtomScale(r);break}})}updateAtomScale(e){this.atomScaleController&&this.atomScaleController.getValue()!==e&&this.atomScaleController.setValue(e)}updateModelStyle(e){this.modelStyleController&&this.modelStyleController.getValue()!==e&&(this.modelStyleController.setValue(e),this.viewer.drawModels())}updateRadiusType(e){this.radiusTypeController&&this.radiusTypeController.getValue()!==e&&this.radiusTypeController.setValue(e)}}function Ry(n,e){return n.reduce((t,r,a)=>t+r*e[a],0)}function ky(n,e){return{real:n*Math.cos(e),imag:n*Math.sin(e),mult(t){return{real:this.real*t.real-this.imag*t.imag,imag:this.real*t.imag+this.imag*t.real}}}}class R9{constructor(e,t=null,r=null,a=!0){this.atoms=e,this.kpoint=t,this.eigenvectors=r,this.addatomphase=a,this.vibrations=[]}calculateVibrations(e=[1,1,1]){const[t,r,a]=e,l=this.atoms.calculateFractionalCoordinates(),x=this.atoms.positions.length;let _=[];this.addatomphase?_=l.map(O=>Ry(this.kpoint,O)):_=new Array(x).fill(0),console.log("atom_phase: ",_);for(let O=0;O<t;O++)for(let z=0;z<r;z++)for(let q=0;q<a;q++)for(let oe=0;oe<x;oe++){let ue=Ry(this.kpoint,[O,z,q])+_[oe],_e=ky(1,ue*2*Math.PI);this.vibrations.push(this.eigenvectors[oe].map(be=>_e.mult({real:be[0],imag:be[1]})))}}getTrajectory(e,t,r=null,a=null,l=null,x=[1,1,1],_=null){if(l&&(this.atoms=l),r&&(this.kpoint=r),a&&(this.eigenvectors=a),this.kpoint===null||this.eigenvectors===null)throw new Error("kpoint and eigenvectors must be provided");_!==null&&(this.addatomphase=_),this.calculateVibrations(x);const O=[];return Array.from({length:t},(z,q)=>2*Math.PI*(q/t)).forEach(z=>{const q=this.atoms.multiply(...x);let oe=ky(e,z);const ue=[];for(let _e=0;_e<q.positions.length;_e++){let be=this.vibrations[_e].map(Pe=>oe.mult(Pe).real);q.positions[_e]=q.positions[_e].map((Pe,Se)=>Pe+be[Se]/5),ue.push(be)}q.newAttribute("movement",ue),O.push(q)}),O}}class k9{constructor(e="warn"){this.level=e,this.levels={none:0,error:1,warn:2,info:3,debug:4},this.timers={}}getCallerInfo(){const e=new Error().stack.split(`
`)[4],t=e.match(/at (.*?) \((.*?):(\d+):(\d+)\)/)||e.match(/at (.*?):(\d+):(\d+)/);return t?`${t[1]}`:"Unknown location"}log(e,...t){this.levels[this.level]>=this.levels[e]&&console.log(`${e.toUpperCase()}: ${this.getCallerInfo()}:`,...t)}setLevel(e){this.levels[e]!==void 0&&(this.level=e)}debug(...e){this.log("debug",...e)}info(...e){this.log("info",...e)}warn(...e){this.log("warn",...e)}error(...e){this.log("error",...e)}time(e){this.levels[this.level]>=this.levels.info&&(this.timers[e]=Date.now())}timeEnd(e){if(this.levels[this.level]>=this.levels.info&&this.timers[e]!==void 0){const t=Date.now()-this.timers[e];console.info(`INFO: ${e}: ${t}ms`),delete this.timers[e]}}}class P9{constructor({weas:e,atoms:t=[new Ds],viewerConfig:r={}}){this.uuid=zl.generateUUID(),this.weas=e,this.tjs=e.tjs;const a={...S7,...r};this._ready=!1,this._modelStyle=a._modelStyle,this._colorBy=a._colorBy,this._colorType=a._colorType,this._colorRamp=a._colorRamp,this._radiusType=a._radiusType,this._materialType=a._materialType,this._atomLabelType=a._atomLabelType,this._showBondedAtoms=a._showBondedAtoms,this._showCell=a._showCell,this._boundary=a._boundary,this._atomScale=a._atomScale,this.backgroundColor=a.backgroundColor,this._selectedAtomsIndices=new Array,this.debug=a.debug,this._currentFrame=0,this.logger=new k9(a.logLevel||"warn"),this.trajectory=[new Ds],this.isPlaying=!1,this.frameDuration=100,this.atomManager=new S8(this),this.cellManager=new x8(this),this.highlightManager=new A9(this),this.guiManager=new L9(this,this.weas.guiManager.gui,this.weas.guiManager.guiConfig),this.bondManager=new R8(this,a._hideLongBonds,a._showHydrogenBonds),this.boundaryManager=new w8(this),this.polyhedraManager=new V8(this),this.isosurfaceManager=new $8(this),this.volumeSliceManager=new r9(this),this.ALManager=new Y8(this),this.Measurement=new M9(this),this.VFManager=new _9(this),this.animate=this.animate.bind(this),this._atoms=null,this._cell=null,this.init(t)}init(e){this.volumetricData=null,this.lastFrameTime=Date.now(),this.selectedAtomsLabelElement=document.createElement("div"),this.selectedAtomsLabelElement.id="selectedAtomSymbol",this.tjs.containerElement.appendChild(this.selectedAtomsLabelElement),this.updateAtoms(e),this.logger.debug("init AtomsViewer successfully")}reset(){this.volumetricData=null,this.atomLabels=[],this.atomArrows=null,this.atomColors=new Array,this._atomScales=new Array,this._modelSticks=new Array,this._modelPolyhedras=new Array,this.boundary=[[0,1],[0,1],[0,1]],this.boundaryList=null}play(){this.isPlaying=!0,this.animate(),this.guiManager.timeline&&(this.guiManager.playPauseBtn.textContent="Pause")}pause(){this.isPlaying=!1,this.guiManager.timeline&&(this.guiManager.playPauseBtn.textContent="Play")}animate(){const e=Date.now();this.isPlaying&&this.trajectory.length>0&&e-this.lastFrameTime>this.frameDuration&&(this.currentFrame=(this.currentFrame+1)%this.trajectory.length,this.lastFrameTime=e),this.isPlaying&&requestAnimationFrame(this.animate)}updateFrame(e){if(this.trajectory.length<=1)return;const t=this.trajectory[e%this.trajectory.length];this.guiManager.timeline&&(this.guiManager.timeline.value=e,this.guiManager.currentFrameDisplay.textContent=e),this.atomManager.updateAtomMesh(null,t),this.bondManager.updateBondMesh(null,t),this.VFManager.updateArrowMesh(null,t),this.cellManager.updateCellMesh(this.originalCell)}get currentFrame(){return this._currentFrame}set currentFrame(e){this.currentFrame!==e&&(this._currentFrame=e,this.lastFrameTime=Date.now(),this.updateFrame(e),this.tjs.render())}get originalCell(){return this._cell?this._cell:this.originalAtoms.cell}get originalAtoms(){return this._atoms?this._atoms:this.atoms}get atoms(){const e=this.trajectory[this.currentFrame];return e.uuid=this.uuid,e}set atoms(e){this.ready=!1,this.dispose(),this.reset(),this.updateAtoms(e)}updateAtoms(e){Array.isArray(e)&&e.length>1?this.trajectory=e:Array.isArray(e)&&e.length===1?this.trajectory=e:this.trajectory=[e],this._cell=null,this._atoms=null,this._currentFrame=0,this.selectedAtomsIndices=[],this.cellManager.cell=this.atoms.cell,this.atomManager.init(),this.highlightManager.init(),this.bondManager.init(),this.polyhedraManager.init(),this.VFManager.init(),this.isosurfaceManager.reset(),this.volumeSliceManager.reset(),this.Measurement.reset(),this.guiManager.update(this.trajectory),this.guiManager.updateLegend(),this.modelStyle=this._modelStyle,this.drawModels(),this.selectedAtomsIndices=[],this.tjs.updateCameraAndControls({direction:[0,0,100]}),this.logger.debug("Set atoms successfullly")}fromPhononMode({atoms:e,eigenvectors:t,amplitude:r=1,factor:a=1,nframes:l=30,kpoint:x=[0,0,0],repeat:_=[1,1,1],color:O="#ff0000",radius:z=.1}){this.logger.debug("--------------------------------------From Phonon Mode--------------------------------------");const q=new R9(e,x,t,!0).getTrajectory(r,l,null,null,null,_);this.atoms=q,this._cell=e.cell,this._atoms=e.multiply(..._),this._atoms.uuid=this.uuid,this.VFManager.addSetting("phonon",{origins:"positions",vectors:"movement",factor:a,color:O,radius:z}),this.bondManager.hideLongBonds=!1,this.drawModels(),this.play()}get ready(){return this._ready}set ready(e){this._ready=e,this.weas.eventHandlers.dispatchViewerUpdated({ready:e})}get modelStyle(){return this._modelStyle}set modelStyle(e){e=parseInt(e),this.logger.debug("updateModelStyle: ",e),this.updateModelStyles(e),this.weas.eventHandlers.dispatchViewerUpdated({modelStyle:e})}get radiusType(){return this._radiusType}set radiusType(e){this._radiusType!==e&&(this._radiusType=e,this.weas.eventHandlers.dispatchViewerUpdated({radiusType:e}),this.atomManager.init(),this.bondManager.init(),this.polyhedraManager.init())}get colorBy(){return this._colorBy}set colorBy(e){this._colorBy=e,this.guiManager.colorByController&&this.guiManager.colorByController.getValue()!==e&&this.guiManager.colorByController.setValue(e),this.weas.eventHandlers.dispatchViewerUpdated({colorBy:e}),this.atomManager.init(),this.bondManager.init(),this.polyhedraManager.init()}get colorType(){return this._colorType}set colorType(e){this._colorType=e,this.guiManager.colorTypeController&&this.guiManager.colorTypeController.getValue()!==e&&this.guiManager.colorTypeController.setValue(e),this.weas.eventHandlers.dispatchViewerUpdated({colorType:e}),this.atomManager.init(),this.guiManager.updateLegend(),this.bondManager.init(),this.polyhedraManager.init()}get materialType(){return this._materialType}set materialType(e){this._materialType=e,this.guiManager.materialTypeController&&this.guiManager.materialTypeController.getValue()!==e&&this.guiManager.materialTypeController.setValue(e),this.weas.eventHandlers.dispatchViewerUpdated({materialType:e})}get atomLabelType(){return this._atomLabelType}set atomLabelType(e){this.logger.debug("updateAtomLabelType: ",e),this._atomLabelType=e,e==="None"?this.ALManager.settings=[]:e.toUpperCase()==="SYMBOL"?this.ALManager.settings=[{origins:"positions",texts:"symbols"}]:e.toLocaleUpperCase()==="INDEX"&&(this.ALManager.settings=[{origins:"positions",texts:"index"}]),this.ALManager.drawAtomLabels(),this.guiManager.atomLabelTypeController&&this.guiManager.atomLabelTypeController.getValue()!==e&&this.guiManager.atomLabelTypeController.setValue(e),this.weas.eventHandlers.dispatchViewerUpdated({atomLabelType:e})}get boundary(){return this._boundary}set boundary(e){this._boundary=e;for(let t=0;t<3;t++)for(let r=0;r<2;r++)this.guiManager.boundaryControllers&&this.guiManager.boundaryControllers[t][r].getValue()!==e[t][r]&&this.guiManager.boundaryControllers[t][r].setValue(e[t][r]);this.weas.eventHandlers.dispatchViewerUpdated({boundary:e})}get showCell(){return this._showCell}set showCell(e){this._showCell=e,this.cellManager.showCell=e,this.guiManager.showCellController&&this.guiManager.showCellController.getValue()!==e&&this.guiManager.showCellController.setValue(e),this.weas.eventHandlers.dispatchViewerUpdated({showCell:e}),this.weas.tjs.render()}get showBondedAtoms(){return this._showBondedAtoms}set showBondedAtoms(e){this._showBondedAtoms=e,this.guiManager.showBondedAtomsController&&this.guiManager.showBondedAtomsController.getValue()!==e&&this.guiManager.showBondedAtomsController.setValue(e),this.weas.eventHandlers.dispatchViewerUpdated({showBondedAtoms:e})}get atomScale(){return this._atomScale}set atomScale(e){this._atomScale!==e&&(this._atomScale=e,this.weas.eventHandlers.dispatchViewerUpdated({atomScale:e}),this.atomManager.updateAtomScale(e))}get atomScales(){return this._atomScales}set atomScales(e){this._atomScales=e,this.weas.eventHandlers.dispatchViewerUpdated({atomScales:e})}get modelSticks(){return this._modelSticks}set modelSticks(e){this._modelSticks=e,this.weas.eventHandlers.dispatchViewerUpdated({modelSticks:e})}get modelPolyhedras(){return this._modelPolyhedras}set modelPolyhedras(e){this._modelPolyhedras=e,this.weas.eventHandlers.dispatchViewerUpdated({modelPolyhedras:e})}get selectedAtomsIndices(){return this._selectedAtomsIndices}set selectedAtomsIndices(e){if(JSON.stringify(this._selectedAtomsIndices)===JSON.stringify(e))return;this.highlightManager.settings.selection.indices=e;const t=e.filter(a=>!this._selectedAtomsIndices.includes(a)),r=this._selectedAtomsIndices.filter(a=>!e.includes(a));this._selectedAtomsIndices=e,this.weas.eventHandlers.dispatchViewerUpdated({selectedAtomsIndices:e}),this.highlightManager.updateHighlightAtomsMesh({indices:t,factor:1.1,type:"sphere"}),this.highlightManager.updateHighlightAtomsMesh({indices:r,factor:0,type:"sphere"}),this.ALManager.settings=[{origins:"positions",texts:this.selectedAtomsIndices,selection:this.selectedAtomsIndices}],this.ALManager.drawAtomLabels()}drawModels(){this.logger.debug("-----------------drawModels-----------------"),this.dispose(),this.cellManager.draw(),this.bondManager.buildNeighborList(),this.boundaryManager.getBoundaryAtoms();const e=this.atoms.positions.map((a,l)=>[l,[0,0,0]]).concat(this.boundaryList);this._showBondedAtoms?this.bondedAtoms=k8(this.atoms.getSymbols(),e,this.neighbors,this.modelSticks):this.bondedAtoms={atoms:[],bonds:[]},this.logger.debug("bondedAtoms: ",this.bondedAtoms),this.atomManager.meshes.atom=this.atomManager.drawBalls();const t=this.bondManager.drawBonds();this.atomManager.meshes.atom.add(t);const r=this.polyhedraManager.drawPolyhedras();this.atomManager.meshes.atom.add(r),this.isosurfaceManager.drawIsosurfaces(),this.volumeSliceManager.drawSlices(),this.VFManager.drawVectorFields(),this.highlightManager.drawHighlightAtoms(),this.ALManager.drawAtomLabels(),this.guiManager.updateLegend(),this.ready=!0,this.weas.tjs.render()}dispose(){this.atomManager.meshes.atom&&this.atomManager.meshes.atom.dispose(),this.atomManager.meshes.image&&this.atomManager.meshes.image.dispose(),D2(this.tjs.scene,this.uuid)}deleteSelectedAtoms(e=null){e===null&&(e=this.selectedAtomsIndices),this.atoms.deleteAtoms(e),this.atomScales=this.atomScales.filter((t,r)=>!e.includes(r)),this.modelSticks=this.modelSticks.filter((t,r)=>!e.includes(r)),this.modelPolyhedras=this.modelPolyhedras.filter((t,r)=>!e.includes(r)),this.selectedAtomsIndices=this.selectedAtomsIndices.filter(t=>!e.includes(t)),this.drawModels()}replaceSelectedAtoms(e,t=null){t===null&&(t=this.selectedAtomsIndices),this.atoms.replaceAtoms(Array.from(t),e),this.atomManager.init(),this.bondManager.init(),this.drawModels()}addAtom(e,t={x:0,y:0,z:0}){const r=new b8(e,[t.x,t.y,t.z]);this.atoms.species[e]||this.atoms.addSpecie(e),this.atoms.addAtom(r),this.atomScales=this.atomScales.concat([this.atomScale]),this.modelSticks=this.modelSticks.concat([0]),this.modelPolyhedras=this.modelPolyhedras.concat([0]),this.atomManager.init(),this.bondManager.init(),this.drawModels()}copyAtoms(e=null){e===null&&(e=this.selectedAtomsIndices);const t=this.atoms.getAtomsByIndices(e);this.logger.debug("copied_atoms: ",t),this.atoms.add(t),this.logger.debug("atoms: ",this.atoms),this.atomScales=this.atomScales.concat(e.map(r=>this.atomScales[r])),this.modelSticks=this.modelSticks.concat(e.map(r=>this.modelSticks[r])),this.modelPolyhedras=this.modelPolyhedras.concat(e.map(r=>this.modelPolyhedras[r])),this.drawModels(),this.selectedAtomsIndices=Array.from({length:t.getAtomsCount()},(r,a)=>a+this.atoms.getAtomsCount()-t.getAtomsCount())}setAtomPosition(e,t){const r=new jn;this.atomManager.meshes.atom.getMatrixAt(e,r),r.setPosition(t),this.atomManager.meshes.atom.setMatrixAt(e,r),this.atoms.positions[e]=[t.x,t.y,t.z],this.atomManager.updateImageAtomsMesh(e),this.bondManager.updateBondMesh(e)}resetSelectedAtomsPositions(e,t=null){t===null&&(t=this.selectedAtomsIndices),t.length!==0&&(t.forEach(r=>{const a=e.get(r);this.setAtomPosition(r,a)}),this.atomManager.meshes.atom.instanceMatrix.needsUpdate=!0)}translateSelectedAtoms(e,t=null){t===null&&(t=this.selectedAtomsIndices),t.length!==0&&(t.forEach(r=>{const a=new st(...this.atoms.positions[r]).clone().add(e);this.setAtomPosition(r,a)}),this.atomManager.meshes.atom.instanceMatrix.needsUpdate=!0,this.atomManager.meshes.image&&(this.atomManager.meshes.image.instanceMatrix.needsUpdate=!0),this.bondManager.bondMesh&&(this.bondManager.bondMesh.instanceMatrix.needsUpdate=!0))}rotateSelectedAtoms(e,t,r=null,a=null){e=e.normalize(),t=zl.degToRad(t);const l=new jn().makeRotationAxis(e,-t);r===null&&(r=this.selectedAtomsIndices),r.length!==0&&(a===null&&(a=new st(0,0,0),r.forEach(x=>{a.add(new st(...this.atoms.positions[x]))}),a.divideScalar(r.length)),r.forEach(x=>{const _=new st(...this.atoms.positions[x]);_.sub(a).applyMatrix4(l).add(a),this.setAtomPosition(x,_)}),this.atomManager.meshes.atom.instanceMatrix.needsUpdate=!0,this.atomManager.meshes.image&&(this.atomManager.meshes.image.instanceMatrix.needsUpdate=!0))}setAttribute(e,t,r="atom"){this.trajectory.forEach(a=>{a.newAttribute(e,t,r)})}updateModelStyles(e){this.selectedAtomsIndices.length>0?e===0?this.selectedAtomsIndices.forEach(t=>{this.atomScales[t]=1,this.modelSticks[t]=e,this.modelPolyhedras[t]=0}):e===1?this.selectedAtomsIndices.forEach(t=>{this.atomScales[t]=.4,this.modelSticks[t]=e,this.modelPolyhedras[t]=0}):e===2?this.selectedAtomsIndices.forEach(t=>{this.atomScales[t]=.4,this.modelSticks[t]=e,this.modelPolyhedras[t]=1}):e===3?this.selectedAtomsIndices.forEach(t=>{this.atomScales[t]=0,this.modelSticks[t]=e,this.modelPolyhedras[t]=0}):e===4&&this.selectedAtomsIndices.forEach(t=>{this.atomScales[t]=0,this.modelSticks[t]=e,this.modelPolyhedras[t]=0}):(this._modelStyle=e,this.modelSticks=new Array(this.atoms.getAtomsCount()).fill(0),this.modelPolyhedras=new Array(this.atoms.getAtomsCount()).fill(0),e===0?this.atomScales=new Array(this.atoms.getAtomsCount()).fill(1):e===1?(this.atomScales=new Array(this.atoms.getAtomsCount()).fill(.4),this.modelSticks=new Array(this.atoms.getAtomsCount()).fill(1)):e===2?(this.atomScales=new Array(this.atoms.getAtomsCount()).fill(.4),this.modelSticks=new Array(this.atoms.getAtomsCount()).fill(2),this.modelPolyhedras=new Array(this.atoms.getAtomsCount()).fill(1)):e===3?(this.atomScales=new Array(this.atoms.getAtomsCount()).fill(0),this.modelSticks=new Array(this.atoms.getAtomsCount()).fill(3)):e===4&&(this.atomScales=new Array(this.atoms.getAtomsCount()).fill(0),this.modelSticks=new Array(this.atoms.getAtomsCount()).fill(4)))}}class O9{constructor({domElement:e,atoms:t=[new Ds],viewerConfig:r={},guiConfig:a={}}){this.uuid=zl.generateUUID(),this.tjs=new t7(e),this.guiManager=new k7(this,a),this.eventHandlers=new N7(this),this.ops=new p8(this),this.selectionManager=new H7(this),this.objectManager=new D7(this),this.avr=new P9({weas:this,atoms:t,viewerConfig:r}),this.instancedMeshPrimitive=new g8(this),this.anyMesh=new y8(this),this.initialize()}initialize(){this.activeObject=null,this.render()}render(){this.tjs.render()}clear(){this.tjs.scene.clear()}}const N9={controls:{enabled:!1,atomsControl:!1,colorControl:!1,cameraControls:!1,buttons:!1},buttons:{enabled:!1,fullscreen:!0,undo:!1,redo:!1,download:!0,measurement:!1}},D9=({props:n,mode:e})=>{const[t,r]=Yn.useState(!1),a=Yn.useRef(null),l=Yn.useRef(null),{nx:x,ny:_,nz:O,cameraDirection:z,showCell:q,amplitude:oe,vectorLength:ue,showVectors:_e,speed:be,atomScale:Pe}=Yn.useContext(nm),Se=Yn.useRef(!0);Yn.useEffect(()=>{const[qe,$e]=e;if(!l.current){const ur=new O9({domElement:a.current,guiConfig:N9,viewerConfig:{backgroundColor:"#0000FF"}});ur.avr.modelStyle=1,ur.avr.bondedAtoms=!0,ur.avr.atomScale=Pe,ur.avr.bondManager.hideLongBonds=!1,l.current=ur}const ft=l.current;let gt,pt;Se.current||(gt=ft.avr.tjs.camera.position.clone(),pt=ft.avr.tjs.controls.target.clone());const Ht=new Ds({symbols:n.atom_types,positions:n.atom_pos_car,cell:n.lattice});ft.clear(),ft.avr.fromPhononMode({atoms:Ht,eigenvectors:n.vectors[qe][$e],amplitude:oe*5,factor:ue/(oe*5),nframes:10/be,kpoint:n.qpoints[qe],repeat:[x,_,O]}),ft.avr.boundary=[[-.01,1.01],[-.01,1.01],[-.01,1.01]],t?ft.avr.play():ft.avr.pause(),ft.avr.frameDuration=15/be,Se.current?(ft.avr.tjs.updateCameraAndControls({direction:z}),Se.current=!1):gt&&pt&&(ft.avr.tjs.camera.position.copy(gt),ft.avr.tjs.controls.target.copy(pt),ft.avr.tjs.controls.update()),ft.avr.showCell=q,ft.avr.VFManager.show=_e,ft.avr.atomScale=Pe;for(let ur=0;ur<ft.avr._atomScales.length;ur++)ft.avr._atomScales[ur]=Pe;ft.avr.drawModels(),ft.render()},[oe,e,n,be,q,_e,z,x,_,O,ue,Pe]);const Ee=Yn.useRef(z);Yn.useEffect(()=>{l.current&&(z[0]!==Ee.current[0]||z[1]!==Ee.current[1]||z[2]!==Ee.current[2])&&(l.current.avr.tjs.updateCameraAndControls({direction:z}),Ee.current=z)},[z]);const Xe=()=>{l.current&&(l.current.avr.isPlaying?(l.current.avr.pause(),r(!1)):(l.current.avr.play(),r(!0)))};return mn.jsxs(Ho,{children:[mn.jsx(Ho.Header,{children:"Drag to rotate, scroll to zoom"}),mn.jsxs(Ho.Body,{className:"p-0",children:[mn.jsx(I9,{children:mn.jsx("div",{className:"weas-container",ref:a,style:{width:"100%",height:"450px"}})}),mn.jsx(Ru,{className:"play-button",size:"sm",onClick:Xe,children:t?mn.jsx("i",{className:"bi bi-pause-fill"}):mn.jsx("i",{className:"bi bi-play-fill"})})]})]})},I9=({children:n})=>{const[e,t]=Yn.useState(!1),r=Yn.useRef(null);let a="mouse-interact-note";e&&(a+=" off");let l="";return e||(l+=" disable-mouse"),Yn.useEffect(()=>{const x=_=>{r.current&&!r.current.contains(_.target)&&t(!1)};return document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[]),mn.jsxs("div",{ref:r,onClick:()=>t(!0),children:[mn.jsx("div",{className:l,children:n}),mn.jsx("div",{className:a,onClick:()=>t(!0),children:"Click to interact"})]})},z9=()=>{const{nx:n,setNx:e,ny:t,setNy:r,nz:a,setNz:l,setCameraDirection:x,showCell:_,setShowCell:O,amplitude:z,setAmplitude:q,vectorLength:oe,setVectorLength:ue,showVectors:_e,setShowVectors:be,speed:Pe,setSpeed:Se,atomScale:Ee,setAtomScale:Xe}=Yn.useContext(nm),qe=Zt=>{Zt.preventDefault();const Xt=parseInt(Zt.target.cellRepetitionX.value),Pr=parseInt(Zt.target.cellRepetitionY.value),cr=parseInt(Zt.target.cellRepetitionZ.value);e(Xt),r(Pr),l(cr)},$e=Zt=>{switch(Zt.currentTarget.value){case"x":x([1,0,0]);break;case"y":x([0,1,0]);break;case"z":x([0,0,1]);break}},ft=Zt=>{O(Zt.target.checked)},gt=Zt=>{Zt.preventDefault();const Xt=Zt.currentTarget.querySelector("#amplitudeText");if(!Xt)throw new Error("Text input not found");const Pr=parseFloat(Xt.value);Ht(Pr)},pt=Zt=>{if(Zt.target.value===""||isNaN(parseFloat(Zt.target.value)))return;const Xt=parseFloat(Zt.target.value);Ht(Xt)},Ht=Zt=>{const Xt=Zt<0?0:Zt>1?1:Zt;q(Xt);const Pr=document.getElementById("amplitudeRange"),cr=document.getElementById("amplitudeText");Pr&&cr&&(Pr.value=String(Xt),cr.value=String(Xt))},ur=Zt=>{ue(parseFloat(Zt.target.value))},Ve=Zt=>{be(Zt.target.checked)},nt=Zt=>{Se(parseFloat(Zt.target.value))},nr=Zt=>{Xe(parseFloat(Zt.target.value))};return mn.jsxs(Ho,{children:[mn.jsx(Ho.Header,{children:"Settings"}),mn.jsxs(Ho.Body,{children:[mn.jsx(ti,{onSubmit:qe,children:mn.jsxs(ti.Group,{as:Os,className:"controls-group",children:[mn.jsx(ti.Label,{children:"Repetitions"}),mn.jsxs(yo,{xs:"9",id:"cellRepetitions",children:[mn.jsx(ti.Control,{id:"cellRepetitionX",defaultValue:n,type:"number",min:"1"}),mn.jsx(ti.Control,{id:"cellRepetitionY",defaultValue:t,type:"number",min:"1"}),mn.jsx(ti.Control,{id:"cellRepetitionZ",defaultValue:a,type:"number",min:"1"})]}),mn.jsx(yo,{xs:"3",children:mn.jsx(Ru,{type:"submit",size:"sm",children:mn.jsx("i",{className:"bi bi-repeat"})})})]})}),mn.jsxs(ti,{children:[mn.jsxs(ti.Group,{as:Os,id:"cameraControls",className:"controls-group",children:[mn.jsx(yo,{xs:"3",children:mn.jsx(ti.Label,{children:"Camera"})}),mn.jsxs(yo,{children:[mn.jsx(Ru,{size:"sm",variant:"secondary",value:"x",onClick:$e,children:"X"}),mn.jsx(Ru,{size:"sm",variant:"secondary",value:"y",onClick:$e,children:"Y"}),mn.jsx(Ru,{size:"sm",variant:"secondary",value:"z",onClick:$e,children:"Z"})]})]}),mn.jsxs(ti.Group,{as:Os,className:"controls-group",children:[mn.jsx(yo,{xs:"3",children:mn.jsx(ti.Label,{children:"Cell"})}),mn.jsx(yo,{xs:"1",children:mn.jsx(ti.Check,{label:"On",defaultChecked:_,onChange:ft})})]})]}),mn.jsx(ti,{id:"amplitudeControls",onSubmit:gt,children:mn.jsxs(ti.Group,{as:Os,className:"controls-group",children:[mn.jsx(ti.Label,{children:"Amplitude"}),mn.jsx(yo,{xs:"8",children:mn.jsx(ti.Range,{id:"amplitudeRange",min:"0.01",max:"1",step:"0.01",defaultValue:z,onChange:pt})}),mn.jsx(yo,{children:mn.jsx(ti.Control,{id:"amplitudeText",type:"number",min:"0.01",max:"1",step:"0.001",defaultValue:z})})]})}),mn.jsxs(ti,{children:[mn.jsxs(ti.Group,{as:Os,className:"controls-group",children:[mn.jsx(ti.Label,{children:"Vector length"}),mn.jsx(yo,{xs:"8",children:mn.jsx(ti.Range,{min:"0.1",max:"4",step:"0.1",defaultValue:oe,onChange:ur})}),mn.jsx(yo,{children:mn.jsx(ti.Check,{label:"On",defaultChecked:_e,onChange:Ve})})]}),mn.jsxs(ti.Group,{as:Os,className:"controls-group",children:[mn.jsx(ti.Label,{children:"Speed"}),mn.jsx(yo,{xs:"8",children:mn.jsx(ti.Range,{min:"0.1",max:"1",step:"0.01",defaultValue:Pe,onChange:nt})})]}),mn.jsxs(ti.Group,{as:Os,className:"controls-group",children:[mn.jsx(ti.Label,{children:"Atom scale"}),mn.jsx(yo,{xs:"8",children:mn.jsx(ti.Range,{min:"0.01",max:"2",step:"0.01",defaultValue:Ee,onChange:nr})})]})]})]})]})},F9=Yn.memo(z9),U9=({props:n})=>{const e=M5(n.repetitions),[t,r]=Yn.useState([0,0]),{fastMode:a=!0}=n,l=Yn.useCallback(_=>{const O=n.distances.indexOf(_.points[0].x),z=n.eigenvalues[O].indexOf(_.points[0].y);r([O,z])},[n]),x={distances:n.distances,highSymPoints:n.highsym_qpts,eigenvalues:n.eigenvalues,updateMode:l,plotlyLayoutFormat:n.plotlyLayoutFormat,plotlyTraceFormat:n.plotlyTraceFormat,plotlyHoverTraceFormat:n.plotlyHoverTraceFormat,plotlySelectedTraceFormat:n.plotlySelectedTraceFormat};return mn.jsx(nm.Provider,{value:e,children:mn.jsx(Py,{fluid:!0,children:mn.jsxs(Os,{className:"mb-xxl-4 g-2",children:[mn.jsx(yo,{lg:"3",className:"visualizer-panel",children:mn.jsx(F9,{})}),mn.jsx(yo,{lg:"4",className:"visualizer-panel",children:mn.jsx(D9,{props:n,mode:t})}),mn.jsx(yo,{lg:"5",className:"visualizer-panel",children:a?mn.jsx(D5,{...x}):mn.jsx(U5,{...x})})]})})})};function X2(n){if(Array.isArray(n))return n.map(r=>typeof r=="string"?X2(r):r);if(typeof n!="string")return n;Object.entries({GAMMA:"",DELTA:"",SIGMA:"",LAMBDA:""}).forEach(([r,a])=>{const l=new RegExp(r,"gi");n=n.replace(l,a)}),n=n.replace(/\bG\b/g,""),n=n.replace(/-/g,"");const t={0:"",1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:""};return n=n.replace(/_(\d)/g,(r,a)=>t[a]||"_"+a),n}function H9({params:n,loadedData:e}){const[t,r]=Yn.useState(null),[a,l]=Yn.useState(!1),[x,_]=Yn.useState(!0);Yn.useEffect(()=>{_(!0),p5(n.method,n.id).then(z=>{if(z){const oe=z.eigenvalues?.map(ue=>ue.map(_e=>_e*.12398));r({...z,eigenvalues:oe,highsym_qpts:z.highsym_qpts?.map(X2)})}else l(!0)}).finally(()=>_(!1))},[n,e]);let O;return console.log("pvd",t),a?null:(x?O=vi.jsx("div",{style:{width:"150px",padding:"40px",margin:"0 auto"},children:vi.jsx(v5,{})}):t&&(O=vi.jsx(U9,{props:{plotlyLayoutFormat:{xaxis:{title:{text:"q-path"},tickangle:0,automargin:!0},yaxis:{title:{text:"Energy [meV]"},automargin:!0}},...t}},JSON.stringify(t))),vi.jsxs("div",{children:[vi.jsxs("div",{style:{margin:"10px 0px",padding:"20px 0px 10px",borderBottom:"1px solid #c4c4c4"},children:[vi.jsx("div",{style:{fontSize:"24px"},children:"Vibrational properties"}),vi.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"2px",alignItems:"center"},children:[vi.jsx(m5,{citationLabels:["MBercxSupercon25"]}),vi.jsx(g5,{doi_id:"9w-az",label:"Data DOI"})]})]}),vi.jsx(Py,{fluid:!0,className:"section-container",children:vi.jsxs(Os,{children:[vi.jsx("div",{className:"subsection-title",children:"Interactive phonon visualization"}),O]})})]}))}export{H9 as default};
